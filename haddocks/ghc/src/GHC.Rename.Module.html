<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

Main pass of renamer
-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html"><span class="hs-identifier">GHC.Rename.Module</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcDecls"><span class="hs-identifier">rnSrcDecls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#addTcgDUs"><span class="hs-identifier">addTcgDUs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#findSplice"><span class="hs-identifier">findSplice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier">rnWarningTxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier">rnLWarningTxt</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#head"><span class="hs-identifier">head</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html"><span class="hs-identifier">GHC.Rename.Expr</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier">rnLExpr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html"><span class="hs-identifier">GHC.Rename.Splice</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#rnSpliceDecl"><span class="hs-identifier">rnSpliceDecl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#rnTopSpliceDecls"><span class="hs-identifier">rnTopSpliceDecls</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html"><span class="hs-identifier">GHC.Types.FieldLabel</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html"><span class="hs-identifier">GHC.Rename.HsType</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html"><span class="hs-identifier">GHC.Rename.Bind</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html"><span class="hs-identifier">GHC.Rename.Doc</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html"><span class="hs-identifier">GHC.Rename.Env</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html"><span class="hs-identifier">GHC.Rename.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier">mapFvRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNames"><span class="hs-identifier">bindLocalNames</span></a></span><span>
</span><span id="line-34"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkDupRdrNames"><span class="hs-identifier">checkDupRdrNames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier">bindLocalNamesFV</span></a></span><span>
</span><span id="line-35"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkShadowedRdrNames"><span class="hs-identifier">checkShadowedRdrNames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#warnUnusedTypePatterns"><span class="hs-identifier">warnUnusedTypePatterns</span></a></span><span>
</span><span id="line-36"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#newLocalBndrsRn"><span class="hs-identifier">newLocalBndrsRn</span></a></span><span>
</span><span id="line-37"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#noNestedForallsContextsErr"><span class="hs-identifier">noNestedForallsContextsErr</span></a></span><span>
</span><span id="line-38"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#addNoNestedForallsContextsErr"><span class="hs-identifier">addNoNestedForallsContextsErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkInferredVars"><span class="hs-identifier">checkInferredVars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html"><span class="hs-identifier">GHC.Rename.Unbound</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#mkUnboundName"><span class="hs-identifier">mkUnboundName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#notInScopeErr"><span class="hs-identifier">notInScopeErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#WhereLooking"><span class="hs-identifier">WhereLooking</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Unbound.html#WL_Global"><span class="hs-identifier">WL_Global</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html"><span class="hs-identifier">GHC.Rename.Names</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Annotation.html"><span class="hs-identifier">GHC.Tc.Gen.Annotation</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Annotation.html#annCtxt"><span class="hs-identifier">annCtxt</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#TypedThing"><span class="hs-identifier">TypedThing</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallTarget"><span class="hs-identifier">CCallTarget</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.html"><span class="hs-identifier">GHC.Unit</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html"><span class="hs-identifier">GHC.Unit.Module.Warnings</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#applicativeClassName"><span class="hs-identifier">applicativeClassName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#pureAName"><span class="hs-identifier">pureAName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#thenAName"><span class="hs-identifier">thenAName</span></a></span><span>
</span><span id="line-50"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#monadClassName"><span class="hs-identifier">monadClassName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier">returnMName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#thenMName"><span class="hs-identifier">thenMName</span></a></span><span>
</span><span id="line-51"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#semigroupClassName"><span class="hs-identifier">semigroupClassName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#sappendName"><span class="hs-identifier">sappendName</span></a></span><span>
</span><span id="line-52"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#monoidClassName"><span class="hs-identifier">monoidClassName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#mappendName"><span class="hs-identifier">mappendName</span></a></span><span>
</span><span id="line-53"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier">Arity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeOrKind"><span class="hs-identifier">TypeOrKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-identifier">lengthExceeds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#partitionWith"><span class="hs-identifier">partitionWith</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier">HscEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html#hsc_home_unit"><span class="hs-identifier">hsc_home_unit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#findDupsEq"><span class="hs-identifier">findDupsEq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#removeDupsOn"><span class="hs-identifier">removeDupsOn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html#equivClasses"><span class="hs-identifier">equivClasses</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Directed.html"><span class="hs-identifier">GHC.Data.Graph.Directed</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#SCC"><span class="hs-identifier">SCC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#flattenSCC"><span class="hs-identifier">flattenSCC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#flattenSCCs"><span class="hs-identifier">flattenSCCs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Directed.html#Node"><span class="hs-identifier">Node</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Directed.html#stronglyConnCompFromEdgedVerticesUniq"><span class="hs-identifier">stronglyConnCompFromEdgedVerticesUniq</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html"><span class="hs-identifier">GHC.Types.GREInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#ConLikeInfo"><span class="hs-identifier">ConLikeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#ConInfo"><span class="hs-identifier">ConInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#mkConInfo"><span class="hs-identifier">mkConInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#conInfoFields"><span class="hs-identifier">conInfoFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html"><span class="hs-identifier">GHC.Types.Unique.Set</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html"><span class="hs-identifier">GHC.Data.OrdList</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#isSrcStrict"><span class="hs-identifier">isSrcStrict</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">for_</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">mapAccumL</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#head"><span class="hs-identifier">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier">nonEmpty</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#difference"><span class="hs-identifier">difference</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier">fromList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#toList"><span class="hs-identifier">toList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#null"><span class="hs-identifier">null</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">{- | @rnSourceDecl@ &quot;renames&quot; declarations.
It simultaneously performs dependency analysis and precedence parsing.
It also does the following error checks:

* Checks that tyvars are used properly. This includes checking
  for undefined tyvars, and tyvars in contexts that are ambiguous.
  (Some of this checking has now been moved to module @TcMonoType@,
  since we don't have functional dependency information at this point.)

* Checks that all variable occurrences are defined.

* Checks the @(..)@ etc constraints in the export list.

Brings the binders of the group into scope in the appropriate places;
does NOT assume that anything is in scope already
-}</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcDecls"><span class="hs-identifier hs-type">rnSrcDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Rename a top-level HsGroup; used for normal source files *and* hs-boot files</span><span>
</span><span id="line-101"></span><span id="rnSrcDecls"><span class="annot"><span class="annottext">rnSrcDecls :: HsGroup GhcPs -&gt; RnM (TcGblEnv, HsGroup GhcRn)
</span><a href="GHC.Rename.Module.html#rnSrcDecls"><span class="hs-identifier hs-var hs-var">rnSrcDecls</span></a></span></span><span> </span><span id="local-6989586621683061774"><span class="annot"><span class="annottext">group :: HsGroup GhcPs
</span><a href="#local-6989586621683061774"><span class="hs-identifier hs-var">group</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hs_valds :: forall p. HsGroup p -&gt; HsValBinds p
</span><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061777"><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621683061777"><span class="hs-identifier hs-var">val_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>                            </span><span class="annot"><span class="annottext">hs_splcds :: forall p. HsGroup p -&gt; [LSpliceDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_splcds"><span class="hs-identifier hs-var">hs_splcds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061779"><span class="annot"><span class="annottext">[LSpliceDecl GhcPs]
</span><a href="#local-6989586621683061779"><span class="hs-identifier hs-var">splice_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>                            </span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061781"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683061781"><span class="hs-identifier hs-var">tycl_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>                            </span><span class="annot"><span class="annottext">hs_derivds :: forall p. HsGroup p -&gt; [LDerivDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_derivds"><span class="hs-identifier hs-var">hs_derivds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061783"><span class="annot"><span class="annottext">[LDerivDecl GhcPs]
</span><a href="#local-6989586621683061783"><span class="hs-identifier hs-var">deriv_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>                            </span><span class="annot"><span class="annottext">hs_fixds :: forall p. HsGroup p -&gt; [LFixitySig p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fixds"><span class="hs-identifier hs-var">hs_fixds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061785"><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621683061785"><span class="hs-identifier hs-var">fix_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>                            </span><span class="annot"><span class="annottext">hs_warnds :: forall p. HsGroup p -&gt; [LWarnDecls p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_warnds"><span class="hs-identifier hs-var">hs_warnds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061787"><span class="annot"><span class="annottext">[LWarnDecls GhcPs]
</span><a href="#local-6989586621683061787"><span class="hs-identifier hs-var">warn_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>                            </span><span class="annot"><span class="annottext">hs_annds :: forall p. HsGroup p -&gt; [LAnnDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_annds"><span class="hs-identifier hs-var">hs_annds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061789"><span class="annot"><span class="annottext">[LAnnDecl GhcPs]
</span><a href="#local-6989586621683061789"><span class="hs-identifier hs-var">ann_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>                            </span><span class="annot"><span class="annottext">hs_fords :: forall p. HsGroup p -&gt; [LForeignDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fords"><span class="hs-identifier hs-var">hs_fords</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061791"><span class="annot"><span class="annottext">[LForeignDecl GhcPs]
</span><a href="#local-6989586621683061791"><span class="hs-identifier hs-var">foreign_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>                            </span><span class="annot"><span class="annottext">hs_defds :: forall p. HsGroup p -&gt; [LDefaultDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_defds"><span class="hs-identifier hs-var">hs_defds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061793"><span class="annot"><span class="annottext">[LDefaultDecl GhcPs]
</span><a href="#local-6989586621683061793"><span class="hs-identifier hs-var">default_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>                            </span><span class="annot"><span class="annottext">hs_ruleds :: forall p. HsGroup p -&gt; [LRuleDecls p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_ruleds"><span class="hs-identifier hs-var">hs_ruleds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061795"><span class="annot"><span class="annottext">[LRuleDecls GhcPs]
</span><a href="#local-6989586621683061795"><span class="hs-identifier hs-var">rule_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>                            </span><span class="annot"><span class="annottext">hs_docs :: forall p. HsGroup p -&gt; [LDocDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_docs"><span class="hs-identifier hs-var">hs_docs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683061797"><span class="annot"><span class="annottext">[LDocDecl GhcPs]
</span><a href="#local-6989586621683061797"><span class="hs-identifier hs-var">docs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-113"></span><span>   </span><span class="hs-comment">-- (A) Process the top-level fixity declarations, creating a mapping from</span><span>
</span><span id="line-114"></span><span>   </span><span class="hs-comment">--     FastStrings to FixItems. Also checks for duplicates.</span><span>
</span><span id="line-115"></span><span>   </span><span class="hs-comment">--     See Note [Top-level fixity signatures in an HsGroup] in GHC.Hs.Decls</span><span>
</span><span id="line-116"></span><span>   </span><span id="local-6989586621683061798"><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-var">local_fix_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcPs] -&gt; RnM MiniFixityEnv
</span><a href="GHC.Rename.Bind.html#makeMiniFixityEnv"><span class="hs-identifier hs-var">makeMiniFixityEnv</span></a></span><span> </span><span class="annot"><span class="annottext">([LFixitySig GhcPs] -&gt; RnM MiniFixityEnv)
-&gt; [LFixitySig GhcPs] -&gt; RnM MiniFixityEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs -&gt; [LFixitySig GhcPs]
forall (p :: Pass). HsGroup (GhcPass p) -&gt; [LFixitySig (GhcPass p)]
</span><a href="GHC.Hs.Decls.html#hsGroupTopLevelFixitySigs"><span class="hs-identifier hs-var">hsGroupTopLevelFixitySigs</span></a></span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683061774"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>   </span><span class="hs-comment">-- (B) Bring top level binders (and their fixities) into scope,</span><span>
</span><span id="line-119"></span><span>   </span><span class="hs-comment">--     *except* for the value bindings, which get done in step (D)</span><span>
</span><span id="line-120"></span><span>   </span><span class="hs-comment">--     with collectHsIdBinders. However *do* include</span><span>
</span><span id="line-121"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span>   </span><span class="hs-comment">--        * Class ops, data constructors, and record fields,</span><span>
</span><span id="line-123"></span><span>   </span><span class="hs-comment">--          because they do not have value declarations.</span><span>
</span><span id="line-124"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span>   </span><span class="hs-comment">--        * For hs-boot files, include the value signatures</span><span>
</span><span id="line-126"></span><span>   </span><span class="hs-comment">--          Again, they have no value declarations</span><span>
</span><span id="line-127"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061801"><span class="annot"><a href="#local-6989586621683061801"><span class="hs-identifier hs-var">tc_envs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061802"><span class="annot"><a href="#local-6989586621683061802"><span class="hs-identifier hs-var">tc_bndrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#getLocalNonValBinders"><span class="hs-identifier hs-type">getLocalNonValBinders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061774"><span class="hs-identifier hs-type">group</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#restoreEnvs"><span class="hs-identifier hs-type">restoreEnvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061801"><span class="hs-identifier hs-type">tc_envs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#failIfErrsM"><span class="hs-identifier hs-type">failIfErrsM</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="hs-comment">-- No point in continuing if (say) we have duplicate declarations</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>   </span><span class="hs-comment">-- (D1) Bring pattern synonyms into scope.</span><span>
</span><span id="line-136"></span><span>   </span><span class="hs-comment">--      Need to do this before (D2) because rnTopBindsLHS</span><span>
</span><span id="line-137"></span><span>   </span><span class="hs-comment">--      looks up those pattern synonyms (#9889)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>   </span><span id="local-6989586621683061806"><span class="annot"><a href="#local-6989586621683061806"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#xopt_DuplicateRecordFields"><span class="hs-identifier hs-type">xopt_DuplicateRecordFields</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-140"></span><span>   </span><span id="local-6989586621683061810"><span class="annot"><a href="#local-6989586621683061810"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#xopt_FieldSelectors"><span class="hs-identifier hs-type">xopt_FieldSelectors</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-141"></span><span>   </span><span class="annot"><a href="GHC.Rename.Module.html#extendPatSynEnv"><span class="hs-identifier hs-type">extendPatSynEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061806"><span class="hs-identifier hs-type">dup_fields_ok</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061810"><span class="hs-identifier hs-type">has_sel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061777"><span class="hs-identifier hs-type">val_decls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683061813"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683061813"><span class="hs-identifier hs-var">pat_syn_bndrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>   </span><span class="hs-comment">-- (D2) Rename the left-hand sides of the value bindings.</span><span>
</span><span id="line-144"></span><span>   </span><span class="hs-comment">--     This depends on everything from (B) being in scope.</span><span>
</span><span id="line-145"></span><span>   </span><span class="hs-comment">--     It uses the fixity env from (A) to bind fixities for view patterns.</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>   </span><span class="hs-comment">-- We need to throw an error on such value bindings when in a boot file.</span><span>
</span><span id="line-148"></span><span>   </span><span id="local-6989586621683061814"><span class="annot"><a href="#local-6989586621683061814"><span class="hs-identifier hs-var">is_boot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn Bool
</span><a href="GHC.Tc.Utils.Monad.html#tcIsHsBootOrSig"><span class="hs-identifier hs-var">tcIsHsBootOrSig</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-149"></span><span>   </span><span id="local-6989586621683061816"><span class="annot"><a href="#local-6989586621683061816"><span class="hs-identifier hs-var">new_lhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683061814"><span class="hs-identifier hs-type">is_boot</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnTopBindsLHSBoot"><span class="hs-identifier hs-type">rnTopBindsLHSBoot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061777"><span class="hs-identifier hs-type">val_decls</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnTopBindsLHS"><span class="hs-identifier hs-type">rnTopBindsLHS</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061777"><span class="hs-identifier hs-type">val_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>   </span><span class="hs-comment">-- Bind the LHSes (and their fixities) in the global rdr environment</span><span>
</span><span id="line-154"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683061819"><span class="annot"><a href="#local-6989586621683061819"><span class="hs-identifier hs-var hs-var">id_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollectFlag GhcRn -&gt; HsValBindsLR GhcRn GhcPs -&gt; [IdP GhcRn]
forall (idL :: Pass) (idR :: Pass).
CollectPass (GhcPass idL) =&gt;
CollectFlag (GhcPass idL)
-&gt; HsValBindsLR (GhcPass idL) (GhcPass idR) -&gt; [IdP (GhcPass idL)]
</span><a href="GHC.Hs.Utils.html#collectHsIdBinders"><span class="hs-identifier hs-var">collectHsIdBinders</span></a></span><span> </span><span class="annot"><span class="annottext">CollectFlag GhcRn
forall p. CollectFlag p
</span><a href="GHC.Hs.Utils.html#CollNoDictBinders"><span class="hs-identifier hs-var">CollNoDictBinders</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBindsLR GhcRn GhcPs
</span><a href="#local-6989586621683061816"><span class="hs-identifier hs-var">new_lhs</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-155"></span><span>                    </span><span class="hs-comment">-- Excludes pattern-synonym binders</span><span>
</span><span id="line-156"></span><span>                    </span><span class="hs-comment">-- They are already in scope</span><span>
</span><span id="line-157"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnSrcDecls&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061819"><span class="hs-identifier hs-type">id_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-158"></span><span>   </span><span id="local-6989586621683061824"><span class="annot"><a href="#local-6989586621683061824"><span class="hs-identifier hs-var">tc_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-type">extendGlobalRdrEnvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#mkLocalVanillaGRE"><span class="hs-identifier hs-type">mkLocalVanillaGRE</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-type">NoParent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683061819"><span class="hs-identifier hs-type">id_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683061798"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-159"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#restoreEnvs"><span class="hs-identifier hs-type">restoreEnvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061824"><span class="hs-identifier hs-type">tc_envs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>   </span><span class="hs-comment">--  Now everything is in scope, as the remaining renaming assumes.</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>   </span><span class="hs-comment">-- (E) Rename type and class decls</span><span>
</span><span id="line-164"></span><span>   </span><span class="hs-comment">--     (note that value LHSes need to be in scope for default methods)</span><span>
</span><span id="line-165"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span>   </span><span class="hs-comment">-- You might think that we could build proper def/use information</span><span>
</span><span id="line-167"></span><span>   </span><span class="hs-comment">-- for type and class declarations, but they can be involved</span><span>
</span><span id="line-168"></span><span>   </span><span class="hs-comment">-- in mutual recursion across modules, and we only do the SCC</span><span>
</span><span id="line-169"></span><span>   </span><span class="hs-comment">-- analysis for them in the type checker.</span><span>
</span><span id="line-170"></span><span>   </span><span class="hs-comment">-- So we content ourselves with gathering uses only; that</span><span>
</span><span id="line-171"></span><span>   </span><span class="hs-comment">-- means we'll only report a declaration as unused if it isn't</span><span>
</span><span id="line-172"></span><span>   </span><span class="hs-comment">-- mentioned at all.  Ah well.</span><span>
</span><span id="line-173"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Start rnTyClDecls&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061781"><span class="hs-identifier hs-type">tycl_decls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-174"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061828"><span class="annot"><a href="#local-6989586621683061828"><span class="hs-identifier hs-var">rn_tycl_decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061829"><span class="annot"><a href="#local-6989586621683061829"><span class="hs-identifier hs-var">src_fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecls"><span class="hs-identifier hs-type">rnTyClDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061781"><span class="hs-identifier hs-type">tycl_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>   </span><span class="hs-comment">-- (F) Rename Value declarations right-hand sides</span><span>
</span><span id="line-177"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Start rnmono&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-178"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683061832"><span class="annot"><a href="#local-6989586621683061832"><span class="hs-identifier hs-var hs-var">val_bndr_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcRn]
[Name]
</span><a href="#local-6989586621683061819"><span class="hs-identifier hs-var">id_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683061813"><span class="hs-identifier hs-var">pat_syn_bndrs</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-179"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061835"><span class="annot"><a href="#local-6989586621683061835"><span class="hs-identifier hs-var">rn_val_decls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XValBindsLR"><span class="hs-identifier hs-type">XValBindsLR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#NValBinds"><span class="hs-identifier hs-type">NValBinds</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683061838"><span class="annot"><a href="#local-6989586621683061838"><span class="hs-identifier hs-var">sigs'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061839"><span class="annot"><a href="#local-6989586621683061839"><span class="hs-identifier hs-var">bind_dus</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683061814"><span class="hs-identifier hs-type">is_boot</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- For an hs-boot, use tc_bndrs (which collects how we're renamed</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- signatures), since val_bndr_set is empty (there are no x = ...</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- bindings in an hs-boot.)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnTopBindsBoot"><span class="hs-identifier hs-type">rnTopBindsBoot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061802"><span class="hs-identifier hs-type">tc_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061816"><span class="hs-identifier hs-type">new_lhs</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnValBindsRHS"><span class="hs-identifier hs-type">rnValBindsRHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Env.html#TopSigCtxt"><span class="hs-identifier hs-type">TopSigCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061832"><span class="hs-identifier hs-type">val_bndr_set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683061816"><span class="hs-identifier hs-type">new_lhs</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-185"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;finish rnmono&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061835"><span class="hs-identifier hs-type">rn_val_decls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>   </span><span class="hs-comment">-- (G) Rename Fixity and deprecations</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>   </span><span class="hs-comment">-- Rename fixity declarations and error if we try to</span><span>
</span><span id="line-190"></span><span>   </span><span class="hs-comment">-- fix something from another module (duplicates were checked in (A))</span><span>
</span><span id="line-191"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683061843"><span class="annot"><a href="#local-6989586621683061843"><span class="hs-identifier hs-var hs-var">all_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061802"><span class="hs-identifier hs-var">tc_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061832"><span class="hs-identifier hs-var">val_bndr_set</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-192"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnSrcDecls fixity&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-193"></span><span>     </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;all_bndrs:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061843"><span class="hs-identifier hs-type">all_bndrs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-194"></span><span>   </span><span id="local-6989586621683061847"><span class="annot"><a href="#local-6989586621683061847"><span class="hs-identifier hs-var">rn_fix_decls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Bind.html#rnSrcFixityDecl"><span class="hs-identifier hs-type">rnSrcFixityDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Env.html#TopSigCtxt"><span class="hs-identifier hs-type">TopSigCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061843"><span class="hs-identifier hs-type">all_bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>                        </span><span class="annot"><a href="#local-6989586621683061785"><span class="hs-identifier hs-type">fix_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>   </span><span class="hs-comment">-- Rename deprec decls;</span><span>
</span><span id="line-198"></span><span>   </span><span class="hs-comment">-- check for duplicates and ensure that deprecated things are defined locally</span><span>
</span><span id="line-199"></span><span>   </span><span class="hs-comment">-- at the moment, we don't keep these around past renaming</span><span>
</span><span id="line-200"></span><span>   </span><span id="local-6989586621683061850"><span class="annot"><a href="#local-6989586621683061850"><span class="hs-identifier hs-var">rn_decl_warns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcWarnDecls"><span class="hs-identifier hs-type">rnSrcWarnDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061843"><span class="hs-identifier hs-type">all_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061787"><span class="hs-identifier hs-type">warn_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>   </span><span class="hs-comment">-- (H) Rename Everything else</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061852"><span class="annot"><a href="#local-6989586621683061852"><span class="hs-identifier hs-var">rn_rule_decls</span></a></span></span><span class="hs-special">,</span><span>    </span><span id="local-6989586621683061853"><span class="annot"><a href="#local-6989586621683061853"><span class="hs-identifier hs-var">src_fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#setXOptM"><span class="hs-identifier hs-type">setXOptM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LangExt.ScopedTypeVariables</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-205"></span><span>                                   </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnHsRuleDecls"><span class="hs-identifier hs-type">rnHsRuleDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061795"><span class="hs-identifier hs-type">rule_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-206"></span><span>                           </span><span class="hs-comment">-- Inside RULES, scoped type variables are on</span><span>
</span><span id="line-207"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061858"><span class="annot"><a href="#local-6989586621683061858"><span class="hs-identifier hs-var">rn_foreign_decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061859"><span class="annot"><a href="#local-6989586621683061859"><span class="hs-identifier hs-var">src_fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnHsForeignDecl"><span class="hs-identifier hs-type">rnHsForeignDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061791"><span class="hs-identifier hs-type">foreign_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-208"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061861"><span class="annot"><a href="#local-6989586621683061861"><span class="hs-identifier hs-var">rn_ann_decls</span></a></span></span><span class="hs-special">,</span><span>     </span><span id="local-6989586621683061862"><span class="annot"><a href="#local-6989586621683061862"><span class="hs-identifier hs-var">src_fvs4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnAnnDecl"><span class="hs-identifier hs-type">rnAnnDecl</span></a></span><span>       </span><span class="annot"><a href="#local-6989586621683061789"><span class="hs-identifier hs-type">ann_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-209"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061864"><span class="annot"><a href="#local-6989586621683061864"><span class="hs-identifier hs-var">rn_default_decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061865"><span class="annot"><a href="#local-6989586621683061865"><span class="hs-identifier hs-var">src_fvs5</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnDefaultDecl"><span class="hs-identifier hs-type">rnDefaultDecl</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621683061793"><span class="hs-identifier hs-type">default_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061867"><span class="annot"><a href="#local-6989586621683061867"><span class="hs-identifier hs-var">rn_deriv_decls</span></a></span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621683061868"><span class="annot"><a href="#local-6989586621683061868"><span class="hs-identifier hs-var">src_fvs6</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcDerivDecl"><span class="hs-identifier hs-type">rnSrcDerivDecl</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621683061783"><span class="hs-identifier hs-type">deriv_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-211"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683061870"><span class="annot"><a href="#local-6989586621683061870"><span class="hs-identifier hs-var">rn_splice_decls</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621683061871"><span class="annot"><a href="#local-6989586621683061871"><span class="hs-identifier hs-var">src_fvs7</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Splice.html#rnSpliceDecl"><span class="hs-identifier hs-type">rnSpliceDecl</span></a></span><span>    </span><span class="annot"><a href="#local-6989586621683061779"><span class="hs-identifier hs-type">splice_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-212"></span><span>   </span><span id="local-6989586621683061872"><span class="annot"><a href="#local-6989586621683061872"><span class="hs-identifier hs-var">rn_docs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLDocDecl"><span class="hs-identifier hs-type">rnLDocDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061797"><span class="hs-identifier hs-type">docs</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>   </span><span class="hs-comment">-- Update the TcGblEnv with renamed COMPLETE pragmas from the current</span><span>
</span><span id="line-215"></span><span>   </span><span class="hs-comment">-- module, for pattern irrefutability checking in do notation.</span><span>
</span><span id="line-216"></span><span>   </span><span id="local-6989586621683061875"><span class="annot"><a href="#local-6989586621683061875"><span class="hs-identifier hs-var">last_tcg_env0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getGblEnv"><span class="hs-identifier hs-type">getGblEnv</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-217"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683061877"><span class="annot"><a href="#local-6989586621683061877"><span class="hs-identifier hs-var hs-var">last_tcg_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>            </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621683061875"><span class="hs-identifier hs-var">last_tcg_env0</span></a></span><span>
</span><span id="line-219"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_complete_matches"><span class="hs-identifier hs-var">tcg_complete_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_complete_matches"><span class="hs-identifier hs-var">tcg_complete_matches</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061875"><span class="hs-identifier hs-type">last_tcg_env0</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#localCompletePragmas"><span class="hs-identifier hs-type">localCompletePragmas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061838"><span class="hs-identifier hs-type">sigs'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>       </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-221"></span><span>   </span><span class="hs-comment">-- (I) Compute the results and return</span><span>
</span><span id="line-222"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span id="local-6989586621683061880"><span class="annot"><a href="#local-6989586621683061880"><span class="hs-identifier hs-var hs-var">rn_group</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hs_ext :: XCHsGroup GhcRn
</span><a href="Language.Haskell.Syntax.Decls.html#hs_ext"><span class="hs-identifier hs-var">hs_ext</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCHsGroup GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>                             </span><span class="annot"><span class="annottext">hs_valds :: HsValBinds GhcRn
</span><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcRn
</span><a href="#local-6989586621683061835"><span class="hs-identifier hs-var">rn_val_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>                             </span><span class="annot"><span class="annottext">hs_splcds :: [LSpliceDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_splcds"><span class="hs-identifier hs-var">hs_splcds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LSpliceDecl GhcRn]
[LocatedA (SpliceDecl GhcRn)]
</span><a href="#local-6989586621683061870"><span class="hs-identifier hs-var">rn_splice_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>                             </span><span class="annot"><span class="annottext">hs_tyclds :: [TyClGroup GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn]
</span><a href="#local-6989586621683061828"><span class="hs-identifier hs-var">rn_tycl_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>                             </span><span class="annot"><span class="annottext">hs_derivds :: [LDerivDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_derivds"><span class="hs-identifier hs-var">hs_derivds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LDerivDecl GhcRn]
[LocatedA (DerivDecl GhcRn)]
</span><a href="#local-6989586621683061867"><span class="hs-identifier hs-var">rn_deriv_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>                             </span><span class="annot"><span class="annottext">hs_fixds :: [LFixitySig GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fixds"><span class="hs-identifier hs-var">hs_fixds</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LFixitySig GhcRn]
[GenLocated SrcSpanAnnA (FixitySig GhcRn)]
</span><a href="#local-6989586621683061847"><span class="hs-identifier hs-var">rn_fix_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>                             </span><span class="annot"><span class="annottext">hs_warnds :: [LWarnDecls GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_warnds"><span class="hs-identifier hs-var">hs_warnds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- warns are returned in the tcg_env</span><span>
</span><span id="line-229"></span><span>                                             </span><span class="hs-comment">-- (see below) not in the HsGroup</span><span>
</span><span id="line-230"></span><span>                             </span><span class="annot"><span class="annottext">hs_fords :: [LForeignDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fords"><span class="hs-identifier hs-var">hs_fords</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LForeignDecl GhcRn]
[LocatedA (ForeignDecl GhcRn)]
</span><a href="#local-6989586621683061858"><span class="hs-identifier hs-var">rn_foreign_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>                             </span><span class="annot"><span class="annottext">hs_annds :: [LAnnDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_annds"><span class="hs-identifier hs-var">hs_annds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LAnnDecl GhcRn]
[LocatedA (AnnDecl GhcRn)]
</span><a href="#local-6989586621683061861"><span class="hs-identifier hs-var">rn_ann_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>                             </span><span class="annot"><span class="annottext">hs_defds :: [LDefaultDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_defds"><span class="hs-identifier hs-var">hs_defds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LDefaultDecl GhcRn]
[LocatedA (DefaultDecl GhcRn)]
</span><a href="#local-6989586621683061864"><span class="hs-identifier hs-var">rn_default_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>                             </span><span class="annot"><span class="annottext">hs_ruleds :: [LRuleDecls GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_ruleds"><span class="hs-identifier hs-var">hs_ruleds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LRuleDecls GhcRn]
[LocatedA (RuleDecls GhcRn)]
</span><a href="#local-6989586621683061852"><span class="hs-identifier hs-var">rn_rule_decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>                             </span><span class="annot"><span class="annottext">hs_docs :: [LDocDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_docs"><span class="hs-identifier hs-var">hs_docs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LDocDecl GhcRn]
[GenLocated SrcSpanAnnA (DocDecl GhcRn)]
</span><a href="#local-6989586621683061872"><span class="hs-identifier hs-var">rn_docs</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>        </span><span id="local-6989586621683061883"><span class="annot"><a href="#local-6989586621683061883"><span class="hs-identifier hs-var hs-var">tcf_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn] -&gt; [LForeignDecl GhcRn] -&gt; [Name]
</span><a href="GHC.Hs.Utils.html#hsTyClForeignBinders"><span class="hs-identifier hs-var">hsTyClForeignBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn]
</span><a href="#local-6989586621683061828"><span class="hs-identifier hs-var">rn_tycl_decls</span></a></span><span> </span><span class="annot"><span class="annottext">[LForeignDecl GhcRn]
[LocatedA (ForeignDecl GhcRn)]
</span><a href="#local-6989586621683061858"><span class="hs-identifier hs-var">rn_foreign_decls</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-237"></span><span>        </span><span id="local-6989586621683061885"><span class="annot"><a href="#local-6989586621683061885"><span class="hs-identifier hs-var hs-var">other_def</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; Maybe FreeVars
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683061883"><span class="hs-identifier hs-var">tcf_bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-238"></span><span>        </span><span id="local-6989586621683061887"><span class="annot"><a href="#local-6989586621683061887"><span class="hs-identifier hs-var hs-var">other_fvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FreeVars] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061829"><span class="hs-identifier hs-var">src_fvs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061853"><span class="hs-identifier hs-var">src_fvs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061859"><span class="hs-identifier hs-var">src_fvs3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061862"><span class="hs-identifier hs-var">src_fvs4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>                              </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061865"><span class="hs-identifier hs-var">src_fvs5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061868"><span class="hs-identifier hs-var">src_fvs6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061871"><span class="hs-identifier hs-var">src_fvs7</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-240"></span><span>                </span><span class="hs-comment">-- It is tiresome to gather the binders from type and class decls</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>        </span><span id="local-6989586621683061889"><span class="annot"><a href="#local-6989586621683061889"><span class="hs-identifier hs-var hs-var">src_dus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe FreeVars, FreeVars) -&gt; DefUses
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe FreeVars, FreeVars)
</span><a href="#local-6989586621683061885"><span class="hs-identifier hs-var">other_def</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses -&gt; DefUses -&gt; DefUses
</span><a href="GHC.Types.Name.Set.html#plusDU"><span class="hs-operator hs-var">`plusDU`</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621683061839"><span class="hs-identifier hs-var">bind_dus</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses -&gt; DefUses -&gt; DefUses
</span><a href="GHC.Types.Name.Set.html#plusDU"><span class="hs-operator hs-var">`plusDU`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; DefUses
</span><a href="GHC.Types.Name.Set.html#usesOnly"><span class="hs-identifier hs-var">usesOnly</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061887"><span class="hs-identifier hs-var">other_fvs</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-243"></span><span>                </span><span class="hs-comment">-- Instance decls may have occurrences of things bound in bind_dus</span><span>
</span><span id="line-244"></span><span>                </span><span class="hs-comment">-- so we must put other_fvs last</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621683061893"><span class="annot"><a href="#local-6989586621683061893"><span class="hs-identifier hs-var hs-var">final_tcg_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683061894"><span class="annot"><span class="annottext">tcg_env' :: TcGblEnv
</span><a href="#local-6989586621683061894"><span class="hs-identifier hs-var hs-var">tcg_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621683061877"><span class="hs-identifier hs-var">last_tcg_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; DefUses -&gt; TcGblEnv
</span><a href="GHC.Rename.Module.html#addTcgDUs"><span class="hs-operator hs-var">`addTcgDUs`</span></a></span><span> </span><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621683061889"><span class="hs-identifier hs-var">src_dus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- we return the deprecs in the env, not in the HsGroup above</span><span>
</span><span id="line-248"></span><span>                        </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621683061894"><span class="hs-identifier hs-var">tcg_env'</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_warns"><span class="hs-identifier hs-var">tcg_warns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#insertWarnDecls"><span class="hs-identifier hs-type">insertWarnDecls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#tcg_warns"><span class="hs-identifier hs-var">tcg_warns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061894"><span class="hs-identifier hs-type">tcg_env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683061850"><span class="hs-identifier hs-type">rn_decl_warns</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">;</span><span>
</span><span id="line-249"></span><span>       </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-250"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;finish rnSrc&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061880"><span class="hs-identifier hs-type">rn_group</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-251"></span><span>   </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;finish Dus&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061889"><span class="hs-identifier hs-type">src_dus</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-252"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683061893"><span class="hs-identifier hs-type">final_tcg_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683061880"><span class="hs-identifier hs-type">rn_group</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>                    </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="GHC.Rename.Module.html#addTcgDUs"><span class="hs-identifier hs-type">addTcgDUs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#DefUses"><span class="hs-identifier hs-type">DefUses</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- This function could be defined lower down in the module hierarchy,</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- but there doesn't seem anywhere very logical to put it.</span><span>
</span><span id="line-258"></span><span id="addTcgDUs"><span class="annot"><span class="annottext">addTcgDUs :: TcGblEnv -&gt; DefUses -&gt; TcGblEnv
</span><a href="GHC.Rename.Module.html#addTcgDUs"><span class="hs-identifier hs-var hs-var">addTcgDUs</span></a></span></span><span> </span><span id="local-6989586621683061897"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621683061897"><span class="hs-identifier hs-var">tcg_env</span></a></span></span><span> </span><span id="local-6989586621683061898"><span class="annot"><span class="annottext">DefUses
</span><a href="#local-6989586621683061898"><span class="hs-identifier hs-var">dus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621683061897"><span class="hs-identifier hs-var">tcg_env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061897"><span class="hs-identifier hs-type">tcg_env</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusDU"><span class="hs-operator hs-type">`plusDU`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061898"><span class="hs-identifier hs-type">dus</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621683060444"><span id="local-6989586621683060445"><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060445"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060445"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-261"></span><span id="rnList"><span class="annot"><span class="annottext">rnList :: forall a b.
(a -&gt; RnM (b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
</span><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-var hs-var">rnList</span></a></span></span><span> </span><span id="local-6989586621683061901"><span class="annot"><span class="annottext">a -&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683061901"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621683061902"><span class="annot"><span class="annottext">[LocatedA a]
</span><a href="#local-6989586621683061902"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocatedA a -&gt; RnM (LocatedA b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
forall (f :: * -&gt; *) a b.
Traversable f =&gt;
(a -&gt; RnM (b, FreeVars)) -&gt; f a -&gt; RnM (f b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; RnM (b, FreeVars))
-&gt; LocatedA a -&gt; RnM (LocatedA b, FreeVars)
forall a b c ann.
(a -&gt; TcM (b, c))
-&gt; GenLocated (EpAnn ann) a -&gt; TcM (GenLocated (EpAnn ann) b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-var">wrapLocFstMA</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683061901"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedA a]
</span><a href="#local-6989586621683061902"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">{-
*********************************************************
*                                                       *
        Source-code deprecations declarations
*                                                       *
*********************************************************

Check that the deprecated names are defined, are defined locally, and
that there are no duplicate deprecations.

It's only imported deprecations, dealt with in RnIfaces, that we
gather them together.
-}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- checks that the deprecations are defined locally, and that there are no duplicates</span><span>
</span><span id="line-278"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcWarnDecls"><span class="hs-identifier hs-type">rnSrcWarnDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LWarnDecls"><span class="hs-identifier hs-type">LWarnDecls</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#DeclWarnOccNames"><span class="hs-identifier hs-type">DeclWarnOccNames</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span id="rnSrcWarnDecls"><span class="annot"><span class="annottext">rnSrcWarnDecls :: FreeVars -&gt; [LWarnDecls GhcPs] -&gt; RnM (DeclWarnOccNames GhcRn)
</span><a href="GHC.Rename.Module.html#rnSrcWarnDecls"><span class="hs-identifier hs-var hs-var">rnSrcWarnDecls</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeclWarnOccNames GhcRn -&gt; RnM (DeclWarnOccNames GhcRn)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcWarnDecls"><span class="hs-identifier hs-var">rnSrcWarnDecls</span></a></span><span> </span><span id="local-6989586621683061905"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061905"><span class="hs-identifier hs-var">bndr_set</span></a></span></span><span> </span><span id="local-6989586621683061906"><span class="annot"><span class="annottext">[LWarnDecls GhcPs]
</span><a href="#local-6989586621683061906"><span class="hs-identifier hs-var">decls'</span></a></span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- check for duplicates</span><span>
</span><span id="line-284"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
 -&gt; TcRn ())
-&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683061908"><span class="annot"><span class="annottext">NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
</span><a href="#local-6989586621683061908"><span class="hs-identifier hs-var">dups</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683061910"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683061910"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683061911"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683061911"><span class="hs-identifier hs-var">rdr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061913"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061913"><span class="hs-identifier hs-var">lrdr'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FreeKiTyVars
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
 -&gt; GenLocated SrcSpanAnnN RdrName)
-&gt; NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
-&gt; NonEmpty (GenLocated SrcSpanAnnN RdrName)
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
-&gt; GenLocated SrcSpanAnnN RdrName
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
</span><a href="#local-6989586621683061908"><span class="hs-identifier hs-var">dups</span></a></span><span>
</span><span id="line-285"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683061910"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDuplicateWarningDecls"><span class="hs-identifier hs-var">TcRnDuplicateWarningDecls</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061913"><span class="hs-identifier hs-var">lrdr'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683061911"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>               </span><span class="annot"><span class="annottext">[NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
</span><a href="#local-6989586621683061918"><span class="hs-identifier hs-var">warn_rdr_dups</span></a></span><span>
</span><span id="line-287"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683061919"><span class="annot"><a href="#local-6989586621683061919"><span class="hs-identifier hs-var">pairs_s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (WarnDecl GhcPs)
 -&gt; RnM (DeclWarnOccNames GhcRn))
-&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [DeclWarnOccNames GhcRn]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WarnDecl GhcPs -&gt; RnM (DeclWarnOccNames GhcRn))
-&gt; GenLocated SrcSpanAnnA (WarnDecl GhcPs)
-&gt; RnM (DeclWarnOccNames GhcRn)
forall t a b. HasLoc t =&gt; (a -&gt; TcM b) -&gt; GenLocated t a -&gt; TcM b
</span><a href="GHC.Tc.Utils.Monad.html#addLocM"><span class="hs-identifier hs-var">addLocM</span></a></span><span> </span><span class="annot"><span class="annottext">WarnDecl GhcPs -&gt; RnM (DeclWarnOccNames GhcRn)
</span><a href="#local-6989586621683061921"><span class="hs-identifier hs-var">rn_deprec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
</span><a href="#local-6989586621683061922"><span class="hs-identifier hs-var">decls</span></a></span><span>
</span><span id="line-288"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><a href="#local-6989586621683061919"><span class="hs-identifier hs-type">pairs_s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-289"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>   </span><span id="local-6989586621683061922"><span class="annot"><span class="annottext">decls :: [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
</span><a href="#local-6989586621683061922"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (WarnDecls GhcPs)
 -&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)])
-&gt; [GenLocated SrcSpanAnnA (WarnDecls GhcPs)]
-&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarnDecls GhcPs -&gt; [LWarnDecl GhcPs]
WarnDecls GhcPs -&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
forall pass. WarnDecls pass -&gt; [LWarnDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#wd_warnings"><span class="hs-identifier hs-var">wd_warnings</span></a></span><span> </span><span class="annot"><span class="annottext">(WarnDecls GhcPs -&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)])
-&gt; (GenLocated SrcSpanAnnA (WarnDecls GhcPs) -&gt; WarnDecls GhcPs)
-&gt; GenLocated SrcSpanAnnA (WarnDecls GhcPs)
-&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (WarnDecls GhcPs) -&gt; WarnDecls GhcPs
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LWarnDecls GhcPs]
[GenLocated SrcSpanAnnA (WarnDecls GhcPs)]
</span><a href="#local-6989586621683061906"><span class="hs-identifier hs-var">decls'</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>   </span><span id="local-6989586621683061928"><span class="annot"><span class="annottext">sig_ctxt :: HsSigCtxt
</span><a href="#local-6989586621683061928"><span class="hs-identifier hs-var hs-var">sig_ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; HsSigCtxt
</span><a href="GHC.Rename.Env.html#TopSigCtxt"><span class="hs-identifier hs-var">TopSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683061905"><span class="hs-identifier hs-var">bndr_set</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>   </span><span id="local-6989586621683061921"><span class="annot"><span class="annottext">rn_deprec :: WarnDecl GhcPs -&gt; RnM (DeclWarnOccNames GhcRn)
</span><a href="#local-6989586621683061921"><span class="hs-identifier hs-var hs-var">rn_deprec</span></a></span></span><span> </span><span id="local-6989586621683061929"><span class="annot"><span class="annottext">w :: WarnDecl GhcPs
</span><a href="#local-6989586621683061929"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#Warning"><span class="hs-identifier hs-type">Warning</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061931"><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061931"><span class="hs-identifier hs-var">ns_spec</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(EpToken &quot;[&quot;, EpToken &quot;]&quot;)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683061932"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683061932"><span class="hs-identifier hs-var">rdr_names</span></a></span></span><span> </span><span id="local-6989586621683061933"><span class="annot"><span class="annottext">WarningTxt GhcPs
</span><a href="#local-6989586621683061933"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>       </span><span class="hs-comment">-- ensures that the names are defined locally</span><span>
</span><span id="line-296"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683061934"><span class="annot"><a href="#local-6989586621683061934"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) [(RdrName, Name)])
-&gt; FreeKiTyVars -&gt; IOEnv (Env TcGblEnv TcLclEnv) [(RdrName, Name)]
forall (m :: * -&gt; *) (f :: * -&gt; *) a b.
(Monad m, Traversable f) =&gt;
(a -&gt; m [b]) -&gt; f a -&gt; m [b]
</span><a href="GHC.Utils.Monad.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsSigCtxt
-&gt; SDoc
-&gt; NamespaceSpecifier
-&gt; RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [(RdrName, Name)]
</span><a href="GHC.Rename.Env.html#lookupLocalTcNames"><span class="hs-identifier hs-var">lookupLocalTcNames</span></a></span><span> </span><span class="annot"><span class="annottext">HsSigCtxt
</span><a href="#local-6989586621683061928"><span class="hs-identifier hs-var">sig_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683061937"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061931"><span class="hs-identifier hs-var">ns_spec</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) [(RdrName, Name)])
-&gt; (GenLocated SrcSpanAnnN RdrName -&gt; RdrName)
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [(RdrName, Name)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>                                </span><span class="annot"><span class="annottext">[LIdP GhcPs]
FreeKiTyVars
</span><a href="#local-6989586621683061932"><span class="hs-identifier hs-var">rdr_names</span></a></span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#unlessXOptM"><span class="hs-identifier hs-type">unlessXOptM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LangExt.ExplicitNamespaces</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683061931"><span class="hs-identifier hs-type">ns_spec</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="GHC.Hs.Binds.html#NoNamespaceSpecifier"><span class="hs-identifier hs-type">NoNamespaceSpecifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-300"></span><span>            </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnNamespacedWarningPragmaWithoutFlag"><span class="hs-identifier hs-type">TcRnNamespacedWarningPragmaWithoutFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061929"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>          </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683061945"><span class="annot"><a href="#local-6989586621683061945"><span class="hs-identifier hs-var">txt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier hs-type">rnWarningTxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061933"><span class="hs-identifier hs-type">txt</span></a></span><span>
</span><span id="line-302"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-type">nameOccName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061947"><span class="hs-identifier hs-type">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683061945"><span class="hs-identifier hs-type">txt'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061947"><span class="annot"><a href="#local-6989586621683061947"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683061934"><span class="hs-identifier hs-type">names</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">-- Use the OccName from the Name we looked up, rather than from the RdrName,</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">-- as we might hit multiple different NameSpaces when looking up</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-comment">-- (e.g. deprecating both a variable and a record field).</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>   </span><span id="local-6989586621683061937"><span class="annot"><span class="annottext">what :: SDoc
</span><a href="#local-6989586621683061937"><span class="hs-identifier hs-var hs-var">what</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deprecation&quot;</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>   </span><span id="local-6989586621683061918"><span class="annot"><span class="annottext">warn_rdr_dups :: [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
</span><a href="#local-6989586621683061918"><span class="hs-identifier hs-var hs-var">warn_rdr_dups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
-&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
</span><a href="#local-6989586621683061950"><span class="hs-identifier hs-var">find_dup_warning_names</span></a></span><span>
</span><span id="line-310"></span><span>                   </span><span class="annot"><span class="annottext">([(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
 -&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)])
-&gt; [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
-&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (WarnDecl GhcPs)
 -&gt; [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)])
-&gt; [GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
-&gt; [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#Warning"><span class="hs-identifier hs-type">Warning</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061951"><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061951"><span class="hs-identifier hs-var">ns_spec</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(EpToken &quot;[&quot;, EpToken &quot;]&quot;)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683061952"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683061952"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061951"><span class="hs-identifier hs-var">ns_spec</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName))
-&gt; FreeKiTyVars
-&gt; [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
FreeKiTyVars
</span><a href="#local-6989586621683061952"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (WarnDecl GhcPs)]
</span><a href="#local-6989586621683061922"><span class="hs-identifier hs-var">decls</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>   </span><span class="annot"><a href="#local-6989586621683061950"><span class="hs-identifier hs-type">find_dup_warning_names</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#NamespaceSpecifier"><span class="hs-identifier hs-type">NamespaceSpecifier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#NamespaceSpecifier"><span class="hs-identifier hs-type">NamespaceSpecifier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>   </span><span id="local-6989586621683061950"><span class="annot"><span class="annottext">find_dup_warning_names :: [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
-&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
</span><a href="#local-6989586621683061950"><span class="hs-identifier hs-var hs-var">find_dup_warning_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)
 -&gt; (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName) -&gt; Bool)
-&gt; [(NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
-&gt; [NonEmpty (NamespaceSpecifier, GenLocated SrcSpanAnnN RdrName)]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [NonEmpty a]
</span><a href="GHC.Data.List.SetOps.html#findDupsEq"><span class="hs-identifier hs-var">findDupsEq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061953"><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061953"><span class="hs-identifier hs-var">spec1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061954"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061954"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061955"><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061955"><span class="hs-identifier hs-var">spec2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061956"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061956"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>                              </span><span class="annot"><span class="annottext">NamespaceSpecifier -&gt; NamespaceSpecifier -&gt; Bool
</span><a href="GHC.Hs.Binds.html#overlappingNamespaceSpecifiers"><span class="hs-identifier hs-var">overlappingNamespaceSpecifiers</span></a></span><span> </span><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061953"><span class="hs-identifier hs-var">spec1</span></a></span><span> </span><span class="annot"><span class="annottext">NamespaceSpecifier
</span><a href="#local-6989586621683061955"><span class="hs-identifier hs-var">spec2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-315"></span><span>                              </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061954"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061956"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier hs-type">rnWarningTxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="rnWarningTxt"><span class="annot"><span class="annottext">rnWarningTxt :: WarningTxt GhcPs -&gt; RnM (WarningTxt GhcRn)
</span><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier hs-var hs-var">rnWarningTxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span id="local-6989586621683061961"><span class="annot"><span class="annottext">Maybe (LocatedE InWarningCategory)
</span><a href="#local-6989586621683061961"><span class="hs-identifier hs-var">mb_cat</span></a></span></span><span> </span><span id="local-6989586621683061962"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683061962"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621683061963"><span class="annot"><span class="annottext">[LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
</span><a href="#local-6989586621683061963"><span class="hs-identifier hs-var">wst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">Maybe (LocatedE InWarningCategory)
-&gt; (LocatedE InWarningCategory -&gt; TcRn ()) -&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedE InWarningCategory)
</span><a href="#local-6989586621683061961"><span class="hs-identifier hs-var">mb_cat</span></a></span><span> </span><span class="annot"><span class="annottext">((LocatedE InWarningCategory -&gt; TcRn ()) -&gt; TcRn ())
-&gt; (LocatedE InWarningCategory -&gt; TcRn ()) -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpaLocation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#InWarningCategory"><span class="hs-identifier hs-type">InWarningCategory</span></a></span><span> </span><span class="annot"><span class="annottext">EpToken &quot;in&quot;
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683061966"><span class="annot"><span class="annottext">EpaLocation
</span><a href="#local-6989586621683061966"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683061967"><span class="annot"><span class="annottext">WarningCategory
</span><a href="#local-6989586621683061967"><span class="hs-identifier hs-var">cat</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningCategory -&gt; Bool
</span><a href="GHC.Unit.Module.Warnings.html#validWarningCategory"><span class="hs-identifier hs-var">validWarningCategory</span></a></span><span> </span><span class="annot"><span class="annottext">WarningCategory
</span><a href="#local-6989586621683061967"><span class="hs-identifier hs-var">cat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpaLocation -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">EpaLocation
</span><a href="#local-6989586621683061966"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningCategory -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnInvalidWarningCategory"><span class="hs-identifier hs-var">TcRnInvalidWarningCategory</span></a></span><span> </span><span class="annot"><span class="annottext">WarningCategory
</span><a href="#local-6989586621683061967"><span class="hs-identifier hs-var">cat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621683061971"><span class="annot"><a href="#local-6989586621683061971"><span class="hs-identifier hs-var">wst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated
         EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn)))
-&gt; [LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [GenLocated EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WithHsDocIdentifiers StringLiteral GhcPs
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv) (WithHsDocIdentifiers StringLiteral GhcRn))
-&gt; LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; GenLocated EpaLocation a -&gt; f (GenLocated EpaLocation b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">WithHsDocIdentifiers StringLiteral GhcPs
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (WithHsDocIdentifiers StringLiteral GhcRn)
forall a.
WithHsDocIdentifiers a GhcPs -&gt; RnM (WithHsDocIdentifiers a GhcRn)
</span><a href="GHC.Rename.Doc.html#rnHsDoc"><span class="hs-identifier hs-var">rnHsDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
</span><a href="#local-6989586621683061963"><span class="hs-identifier hs-var">wst</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061961"><span class="hs-identifier hs-type">mb_cat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061962"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061971"><span class="hs-identifier hs-type">wst'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span class="annot"><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier hs-var">rnWarningTxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#DeprecatedTxt"><span class="hs-identifier hs-type">DeprecatedTxt</span></a></span><span> </span><span id="local-6989586621683061974"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683061974"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621683061975"><span class="annot"><span class="annottext">[LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
</span><a href="#local-6989586621683061975"><span class="hs-identifier hs-var">wst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621683061976"><span class="annot"><a href="#local-6989586621683061976"><span class="hs-identifier hs-var">wst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated
         EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn)))
-&gt; [LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [GenLocated EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WithHsDocIdentifiers StringLiteral GhcPs
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv) (WithHsDocIdentifiers StringLiteral GhcRn))
-&gt; LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated EpaLocation (WithHsDocIdentifiers StringLiteral GhcRn))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; GenLocated EpaLocation a -&gt; f (GenLocated EpaLocation b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">WithHsDocIdentifiers StringLiteral GhcPs
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (WithHsDocIdentifiers StringLiteral GhcRn)
forall a.
WithHsDocIdentifiers a GhcPs -&gt; RnM (WithHsDocIdentifiers a GhcRn)
</span><a href="GHC.Rename.Doc.html#rnHsDoc"><span class="hs-identifier hs-var">rnHsDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedE (WithHsDocIdentifiers StringLiteral GhcPs)]
</span><a href="#local-6989586621683061975"><span class="hs-identifier hs-var">wst</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#DeprecatedTxt"><span class="hs-identifier hs-type">DeprecatedTxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061974"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061976"><span class="hs-identifier hs-type">wst'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier hs-type">rnLWarningTxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#LWarningTxt"><span class="hs-identifier hs-type">LWarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#LWarningTxt"><span class="hs-identifier hs-type">LWarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span id="rnLWarningTxt"><span class="annot"><span class="annottext">rnLWarningTxt :: LWarningTxt GhcPs -&gt; RnM (LWarningTxt GhcRn)
</span><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier hs-var hs-var">rnLWarningTxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683061977"><span class="annot"><span class="annottext">SrcSpanAnnP
</span><a href="#local-6989586621683061977"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683061978"><span class="annot"><span class="annottext">WarningTxt GhcPs
</span><a href="#local-6989586621683061978"><span class="hs-identifier hs-var">warn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnP
-&gt; WarningTxt GhcRn -&gt; GenLocated SrcSpanAnnP (WarningTxt GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnP
</span><a href="#local-6989586621683061977"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(WarningTxt GhcRn -&gt; GenLocated SrcSpanAnnP (WarningTxt GhcRn))
-&gt; RnM (WarningTxt GhcRn)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnP (WarningTxt GhcRn))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcPs -&gt; RnM (WarningTxt GhcRn)
</span><a href="GHC.Rename.Module.html#rnWarningTxt"><span class="hs-identifier hs-var">rnWarningTxt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcPs
</span><a href="#local-6989586621683061978"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- look for duplicates among the OccNames;</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- we check that the names are defined above</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- invt: the lists returned by findDupsEq always have at least two elements</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Annotation declarations}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="GHC.Rename.Module.html#rnAnnDecl"><span class="hs-identifier hs-type">rnAnnDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnnDecl"><span class="hs-identifier hs-type">AnnDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnnDecl"><span class="hs-identifier hs-type">AnnDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span id="rnAnnDecl"><span class="annot"><span class="annottext">rnAnnDecl :: AnnDecl GhcPs -&gt; RnM (AnnDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnAnnDecl"><span class="hs-identifier hs-var hs-var">rnAnnDecl</span></a></span></span><span> </span><span id="local-6989586621683061979"><span class="annot"><span class="annottext">ann :: AnnDecl GhcPs
</span><a href="#local-6989586621683061979"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsAnnotation"><span class="hs-identifier hs-type">HsAnnotation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnPragma
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061981"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683061981"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683061982"><span class="annot"><span class="annottext">AnnProvenance GhcPs
</span><a href="#local-6989586621683061982"><span class="hs-identifier hs-var">provenance</span></a></span></span><span> </span><span id="local-6989586621683061983"><span class="annot"><span class="annottext">XRec GhcPs (HsExpr GhcPs)
</span><a href="#local-6989586621683061983"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
-&gt; RnM (AnnDecl GhcRn, FreeVars) -&gt; RnM (AnnDecl GhcRn, FreeVars)
forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnDecl GhcPs -&gt; SDoc
forall (p :: Pass).
OutputableBndrId p =&gt;
AnnDecl (GhcPass p) -&gt; SDoc
</span><a href="GHC.Tc.Gen.Annotation.html#annCtxt"><span class="hs-identifier hs-var">annCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDecl GhcPs
</span><a href="#local-6989586621683061979"><span class="hs-identifier hs-var">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RnM (AnnDecl GhcRn, FreeVars) -&gt; RnM (AnnDecl GhcRn, FreeVars))
-&gt; RnM (AnnDecl GhcRn, FreeVars) -&gt; RnM (AnnDecl GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061985"><span class="annot"><a href="#local-6989586621683061985"><span class="hs-identifier hs-var">provenance'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061986"><span class="annot"><a href="#local-6989586621683061986"><span class="hs-identifier hs-var">provenance_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AnnProvenance GhcPs -&gt; RnM (AnnProvenance GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnAnnProvenance"><span class="hs-identifier hs-var">rnAnnProvenance</span></a></span><span> </span><span class="annot"><span class="annottext">AnnProvenance GhcPs
</span><a href="#local-6989586621683061982"><span class="hs-identifier hs-var">provenance</span></a></span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683061988"><span class="annot"><a href="#local-6989586621683061988"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683061989"><span class="annot"><a href="#local-6989586621683061989"><span class="hs-identifier hs-var">expr_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#setStage"><span class="hs-identifier hs-type">setStage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.TH.html#Splice"><span class="hs-identifier hs-type">Splice</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.TH.html#Untyped"><span class="hs-identifier hs-type">Untyped</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-348"></span><span>                              </span><span class="annot"><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-type">rnLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061983"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-349"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsAnnotation"><span class="hs-identifier hs-type">HsAnnotation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-type">noAnn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683061981"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683061985"><span class="hs-identifier hs-type">provenance'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061988"><span class="hs-identifier hs-type">expr'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>                 </span><span class="annot"><a href="#local-6989586621683061986"><span class="hs-identifier hs-type">provenance_fvs</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061989"><span class="hs-identifier hs-type">expr_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="GHC.Rename.Module.html#rnAnnProvenance"><span class="hs-identifier hs-type">rnAnnProvenance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnnProvenance"><span class="hs-identifier hs-type">AnnProvenance</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-353"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnnProvenance"><span class="hs-identifier hs-type">AnnProvenance</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span id="rnAnnProvenance"><span class="annot"><span class="annottext">rnAnnProvenance :: AnnProvenance GhcPs -&gt; RnM (AnnProvenance GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnAnnProvenance"><span class="hs-identifier hs-var hs-var">rnAnnProvenance</span></a></span></span><span> </span><span id="local-6989586621683061995"><span class="annot"><span class="annottext">AnnProvenance GhcPs
</span><a href="#local-6989586621683061995"><span class="hs-identifier hs-var">provenance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621683061996"><span class="annot"><a href="#local-6989586621683061996"><span class="hs-identifier hs-var">provenance'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnProvenance GhcPs
</span><a href="#local-6989586621683061995"><span class="hs-identifier hs-var">provenance</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ValueAnnProvenance"><span class="hs-identifier hs-type">ValueAnnProvenance</span></a></span><span> </span><span id="local-6989586621683061998"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683061998"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn -&gt; AnnProvenance GhcRn
GenLocated SrcSpanAnnN Name -&gt; AnnProvenance GhcRn
forall pass. LIdP pass -&gt; AnnProvenance pass
</span><a href="Language.Haskell.Syntax.Decls.html#ValueAnnProvenance"><span class="hs-identifier hs-var">ValueAnnProvenance</span></a></span><span>
</span><span id="line-357"></span><span>                          </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN Name -&gt; AnnProvenance GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (AnnProvenance GhcRn)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopBndrRnN"><span class="hs-identifier hs-var">lookupLocatedTopBndrRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683061998"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TypeAnnProvenance"><span class="hs-identifier hs-type">TypeAnnProvenance</span></a></span><span> </span><span id="local-6989586621683062001"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062001"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn -&gt; AnnProvenance GhcRn
GenLocated SrcSpanAnnN Name -&gt; AnnProvenance GhcRn
forall pass. LIdP pass -&gt; AnnProvenance pass
</span><a href="Language.Haskell.Syntax.Decls.html#TypeAnnProvenance"><span class="hs-identifier hs-var">TypeAnnProvenance</span></a></span><span>
</span><span id="line-359"></span><span>                          </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN Name -&gt; AnnProvenance GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (AnnProvenance GhcRn)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062001"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">AnnProvenance GhcPs
</span><a href="Language.Haskell.Syntax.Decls.html#ModuleAnnProvenance"><span class="hs-identifier hs-var">ModuleAnnProvenance</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnnProvenance GhcRn
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (AnnProvenance GhcRn)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">AnnProvenance GhcRn
forall pass. AnnProvenance pass
</span><a href="Language.Haskell.Syntax.Decls.html#ModuleAnnProvenance"><span class="hs-identifier hs-var">ModuleAnnProvenance</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683061996"><span class="hs-identifier hs-type">provenance'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-type">emptyFVs</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-type">unitFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#annProvenanceName_maybe"><span class="hs-identifier hs-type">annProvenanceName_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061996"><span class="hs-identifier hs-type">provenance'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Default declarations}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="GHC.Rename.Module.html#rnDefaultDecl"><span class="hs-identifier hs-type">rnDefaultDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DefaultDecl"><span class="hs-identifier hs-type">DefaultDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DefaultDecl"><span class="hs-identifier hs-type">DefaultDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span id="rnDefaultDecl"><span class="annot"><span class="annottext">rnDefaultDecl :: DefaultDecl GhcPs -&gt; RnM (DefaultDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDefaultDecl"><span class="hs-identifier hs-var hs-var">rnDefaultDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DefaultDecl"><span class="hs-identifier hs-type">DefaultDecl</span></a></span><span> </span><span class="annot"><span class="annottext">XCDefaultDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062009"><span class="annot"><span class="annottext">Maybe (LIdP GhcPs)
</span><a href="#local-6989586621683062009"><span class="hs-identifier hs-var">mb_cls</span></a></span></span><span> </span><span id="local-6989586621683062010"><span class="annot"><span class="annottext">[LHsType GhcPs]
</span><a href="#local-6989586621683062010"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-374"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062011"><span class="annot"><a href="#local-6989586621683062011"><span class="hs-identifier hs-var">mb_cls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name))
-&gt; Maybe (GenLocated SrcSpanAnnN RdrName)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (Maybe (GenLocated SrcSpanAnnN Name))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name)
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; GenLocated SrcSpanAnnN a -&gt; f (GenLocated SrcSpanAnnN b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="GHC.Rename.Env.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (LIdP GhcPs)
Maybe (GenLocated SrcSpanAnnN RdrName)
</span><a href="#local-6989586621683062009"><span class="hs-identifier hs-var">mb_cls</span></a></span><span>
</span><span id="line-375"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062013"><span class="annot"><a href="#local-6989586621683062013"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062014"><span class="annot"><a href="#local-6989586621683062014"><span class="hs-identifier hs-var">ty_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnLHsTypes"><span class="hs-identifier hs-type">rnLHsTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062016"><span class="hs-identifier hs-type">doc_str</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062010"><span class="hs-identifier hs-type">tys</span></a></span><span>
</span><span id="line-376"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DefaultDecl"><span class="hs-identifier hs-type">DefaultDecl</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062011"><span class="hs-identifier hs-type">mb_cls'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062013"><span class="hs-identifier hs-type">tys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062014"><span class="hs-identifier hs-type">ty_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621683062016"><span class="annot"><span class="annottext">doc_str :: HsDocContext
</span><a href="#local-6989586621683062016"><span class="hs-identifier hs-var hs-var">doc_str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#DefaultDeclCtx"><span class="hs-identifier hs-var">DefaultDeclCtx</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Foreign declarations}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsForeignDecl"><span class="hs-identifier hs-type">rnHsForeignDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignDecl"><span class="hs-identifier hs-type">ForeignDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span id="rnHsForeignDecl"><span class="annot"><span class="annottext">rnHsForeignDecl :: ForeignDecl GhcPs -&gt; RnM (ForeignDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnHsForeignDecl"><span class="hs-identifier hs-var hs-var">rnHsForeignDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignImport"><span class="hs-identifier hs-type">ForeignImport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fd_name :: forall pass. ForeignDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_name"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062020"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062020"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fd_sig_ty :: forall pass. ForeignDecl pass -&gt; LHsSigType pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_sig_ty"><span class="hs-identifier hs-var">fd_sig_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062022"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062022"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fd_fi :: forall pass. ForeignDecl pass -&gt; ForeignImport pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_fi"><span class="hs-identifier hs-var">fd_fi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062024"><span class="annot"><span class="annottext">ForeignImport GhcPs
</span><a href="#local-6989586621683062024"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062025"><span class="annot"><a href="#local-6989586621683062025"><span class="hs-identifier hs-var">topEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">HscEnv</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRnIf TcGblEnv TcLclEnv HscEnv
forall gbl lcl. TcRnIf gbl lcl HscEnv
</span><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a></span><span>
</span><span id="line-391"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062027"><span class="annot"><a href="#local-6989586621683062027"><span class="hs-identifier hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html#lookupLocatedTopBndrRnN"><span class="hs-identifier hs-type">lookupLocatedTopBndrRnN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062020"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-392"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062028"><span class="annot"><a href="#local-6989586621683062028"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062029"><span class="annot"><a href="#local-6989586621683062029"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-type">rnHsSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ForeignDeclCtx"><span class="hs-identifier hs-type">ForeignDeclCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062020"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-type">TypeLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062022"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-comment">-- Mark any PackageTarget style imports as coming from the current package</span><span>
</span><span id="line-395"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062033"><span class="annot"><a href="#local-6989586621683062033"><span class="hs-identifier hs-var hs-var">home_unit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; HomeUnit
</span><a href="GHC.Driver.Env.html#hsc_home_unit"><span class="hs-identifier hs-var">hsc_home_unit</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621683062025"><span class="hs-identifier hs-var">topEnv</span></a></span><span>
</span><span id="line-396"></span><span>             </span><span id="local-6989586621683062034"><span class="annot"><a href="#local-6989586621683062034"><span class="hs-identifier hs-var hs-var">spec'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unit -&gt; ForeignImport GhcPs -&gt; ForeignImport GhcRn
</span><a href="GHC.Rename.Module.html#patchForeignImport"><span class="hs-identifier hs-var">patchForeignImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HomeUnit -&gt; Unit
</span><a href="GHC.Unit.Home.html#homeUnitAsUnit"><span class="hs-identifier hs-var">homeUnitAsUnit</span></a></span><span> </span><span class="annot"><span class="annottext">HomeUnit
</span><a href="#local-6989586621683062033"><span class="hs-identifier hs-var">home_unit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignImport GhcPs
</span><a href="#local-6989586621683062024"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignImport"><span class="hs-identifier hs-type">ForeignImport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_i_ext"><span class="hs-identifier hs-var">fd_i_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span>
</span><span id="line-399"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_name"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062027"><span class="hs-identifier hs-type">name'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_sig_ty"><span class="hs-identifier hs-var">fd_sig_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062028"><span class="hs-identifier hs-type">ty'</span></a></span><span>
</span><span id="line-400"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_fi"><span class="hs-identifier hs-var">fd_fi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062034"><span class="hs-identifier hs-type">spec'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062029"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsForeignDecl"><span class="hs-identifier hs-var">rnHsForeignDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignExport"><span class="hs-identifier hs-type">ForeignExport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fd_name :: forall pass. ForeignDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_name"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062039"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062039"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fd_sig_ty :: forall pass. ForeignDecl pass -&gt; LHsSigType pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_sig_ty"><span class="hs-identifier hs-var">fd_sig_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062040"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062040"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fd_fe :: forall pass. ForeignDecl pass -&gt; ForeignExport pass
</span><a href="Language.Haskell.Syntax.Decls.html#fd_fe"><span class="hs-identifier hs-var">fd_fe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062042"><span class="annot"><span class="annottext">ForeignExport GhcPs
</span><a href="#local-6989586621683062042"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062043"><span class="annot"><a href="#local-6989586621683062043"><span class="hs-identifier hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
forall ann.
GenLocated (EpAnn ann) RdrName
-&gt; TcRn (GenLocated (EpAnn ann) Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedOccRn"><span class="hs-identifier hs-var">lookupLocatedOccRn</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062039"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-404"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062045"><span class="annot"><a href="#local-6989586621683062045"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062046"><span class="annot"><a href="#local-6989586621683062046"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-type">rnHsSigType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#ForeignDeclCtx"><span class="hs-identifier hs-type">ForeignDeclCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062039"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-type">TypeLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062040"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-405"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignExport"><span class="hs-identifier hs-type">ForeignExport</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_e_ext"><span class="hs-identifier hs-var">fd_e_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span>
</span><span id="line-406"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_name"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062043"><span class="hs-identifier hs-type">name'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_sig_ty"><span class="hs-identifier hs-var">fd_sig_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062045"><span class="hs-identifier hs-type">ty'</span></a></span><span>
</span><span id="line-407"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fd_fe"><span class="hs-identifier hs-var">fd_fe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#CExport"><span class="hs-identifier hs-type">CExport</span></a></span><span> </span><span id="local-6989586621683062049"><span class="annot"><span class="annottext">XCExport GhcPs
</span><a href="#local-6989586621683062049"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683062050"><span class="annot"><span class="annottext">XRec GhcPs CExportSpec
</span><a href="#local-6989586621683062050"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XCExport GhcRn -&gt; XRec GhcRn CExportSpec -&gt; ForeignExport GhcRn
forall pass.
XCExport pass -&gt; XRec pass CExportSpec -&gt; ForeignExport pass
</span><a href="Language.Haskell.Syntax.Decls.html#CExport"><span class="hs-identifier hs-var">CExport</span></a></span><span> </span><span class="annot"><span class="annottext">XCExport GhcPs
XCExport GhcRn
</span><a href="#local-6989586621683062049"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs CExportSpec
XRec GhcRn CExportSpec
</span><a href="#local-6989586621683062050"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062042"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-408"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062046"><span class="hs-identifier hs-type">fvs</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-type">`addOneFV`</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062043"><span class="hs-identifier hs-type">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-comment">-- NB: a foreign export is an *occurrence site* for name, so</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-comment">--     we add it to the free-variable list.  It might, for example,</span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-comment">--     be imported from another module</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | For Windows DLLs we need to know what packages imported symbols are from</span><span>
</span><span id="line-414"></span><span class="hs-comment">--      to generate correct calls. Imported symbols are tagged with the current</span><span>
</span><span id="line-415"></span><span class="hs-comment">--      package, so if they get inlined across a package boundary we'll still</span><span>
</span><span id="line-416"></span><span class="hs-comment">--      know where they're from.</span><span>
</span><span id="line-417"></span><span class="hs-comment">--</span><span>
</span><span id="line-418"></span><span class="annot"><a href="GHC.Rename.Module.html#patchForeignImport"><span class="hs-identifier hs-type">patchForeignImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignImport"><span class="hs-identifier hs-type">ForeignImport</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForeignImport"><span class="hs-identifier hs-type">ForeignImport</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span id="patchForeignImport"><span class="annot"><span class="annottext">patchForeignImport :: Unit -&gt; ForeignImport GhcPs -&gt; ForeignImport GhcRn
</span><a href="GHC.Rename.Module.html#patchForeignImport"><span class="hs-identifier hs-var hs-var">patchForeignImport</span></a></span></span><span> </span><span id="local-6989586621683062052"><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062052"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#CImport"><span class="hs-identifier hs-type">CImport</span></a></span><span> </span><span id="local-6989586621683062054"><span class="annot"><span class="annottext">XCImport GhcPs
</span><a href="#local-6989586621683062054"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span id="local-6989586621683062055"><span class="annot"><span class="annottext">XRec GhcPs CCallConv
</span><a href="#local-6989586621683062055"><span class="hs-identifier hs-var">cconv</span></a></span></span><span> </span><span id="local-6989586621683062056"><span class="annot"><span class="annottext">XRec GhcPs Safety
</span><a href="#local-6989586621683062056"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621683062057"><span class="annot"><span class="annottext">Maybe Header
</span><a href="#local-6989586621683062057"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621683062058"><span class="annot"><span class="annottext">CImportSpec
</span><a href="#local-6989586621683062058"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCImport GhcRn
-&gt; XRec GhcRn CCallConv
-&gt; XRec GhcRn Safety
-&gt; Maybe Header
-&gt; CImportSpec
-&gt; ForeignImport GhcRn
forall pass.
XCImport pass
-&gt; XRec pass CCallConv
-&gt; XRec pass Safety
-&gt; Maybe Header
-&gt; CImportSpec
-&gt; ForeignImport pass
</span><a href="Language.Haskell.Syntax.Decls.html#CImport"><span class="hs-identifier hs-var">CImport</span></a></span><span> </span><span class="annot"><span class="annottext">XCImport GhcPs
XCImport GhcRn
</span><a href="#local-6989586621683062054"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs CCallConv
XRec GhcRn CCallConv
</span><a href="#local-6989586621683062055"><span class="hs-identifier hs-var">cconv</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs Safety
XRec GhcRn Safety
</span><a href="#local-6989586621683062056"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Header
</span><a href="#local-6989586621683062057"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unit -&gt; CImportSpec -&gt; CImportSpec
</span><a href="GHC.Rename.Module.html#patchCImportSpec"><span class="hs-identifier hs-var">patchCImportSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062052"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="annot"><span class="annottext">CImportSpec
</span><a href="#local-6989586621683062058"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><a href="GHC.Rename.Module.html#patchCImportSpec"><span class="hs-identifier hs-type">patchCImportSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#CImportSpec"><span class="hs-identifier hs-type">CImportSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#CImportSpec"><span class="hs-identifier hs-type">CImportSpec</span></a></span><span>
</span><span id="line-423"></span><span id="patchCImportSpec"><span class="annot"><span class="annottext">patchCImportSpec :: Unit -&gt; CImportSpec -&gt; CImportSpec
</span><a href="GHC.Rename.Module.html#patchCImportSpec"><span class="hs-identifier hs-var hs-var">patchCImportSpec</span></a></span></span><span> </span><span id="local-6989586621683062060"><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062060"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span id="local-6989586621683062061"><span class="annot"><span class="annottext">CImportSpec
</span><a href="#local-6989586621683062061"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-424"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CImportSpec
</span><a href="#local-6989586621683062061"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#CFunction"><span class="hs-identifier hs-type">CFunction</span></a></span><span> </span><span id="local-6989586621683062063"><span class="annot"><span class="annottext">CCallTarget
</span><a href="#local-6989586621683062063"><span class="hs-identifier hs-var">callTarget</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCallTarget -&gt; CImportSpec
</span><a href="Language.Haskell.Syntax.Decls.html#CFunction"><span class="hs-identifier hs-var">CFunction</span></a></span><span> </span><span class="annot"><span class="annottext">(CCallTarget -&gt; CImportSpec) -&gt; CCallTarget -&gt; CImportSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unit -&gt; CCallTarget -&gt; CCallTarget
</span><a href="GHC.Rename.Module.html#patchCCallTarget"><span class="hs-identifier hs-var">patchCCallTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062060"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="annot"><span class="annottext">CCallTarget
</span><a href="#local-6989586621683062063"><span class="hs-identifier hs-var">callTarget</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">CImportSpec
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CImportSpec
</span><a href="#local-6989586621683062061"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="GHC.Rename.Module.html#patchCCallTarget"><span class="hs-identifier hs-type">patchCCallTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallTarget"><span class="hs-identifier hs-type">CCallTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html#CCallTarget"><span class="hs-identifier hs-type">CCallTarget</span></a></span><span>
</span><span id="line-429"></span><span id="patchCCallTarget"><span class="annot"><span class="annottext">patchCCallTarget :: Unit -&gt; CCallTarget -&gt; CCallTarget
</span><a href="GHC.Rename.Module.html#patchCCallTarget"><span class="hs-identifier hs-var hs-var">patchCCallTarget</span></a></span></span><span> </span><span id="local-6989586621683062065"><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062065"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span id="local-6989586621683062066"><span class="annot"><span class="annottext">CCallTarget
</span><a href="#local-6989586621683062066"><span class="hs-identifier hs-var">callTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CCallTarget
</span><a href="#local-6989586621683062066"><span class="hs-identifier hs-var">callTarget</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><a href="GHC.Types.ForeignCall.html#StaticTarget"><span class="hs-identifier hs-type">StaticTarget</span></a></span><span> </span><span id="local-6989586621683062068"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683062068"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621683062069"><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062069"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Unit
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621683062070"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062070"><span class="hs-identifier hs-var">isFun</span></a></span></span><span>
</span><span id="line-432"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SourceText -&gt; CLabelString -&gt; Maybe Unit -&gt; Bool -&gt; CCallTarget
</span><a href="GHC.Types.ForeignCall.html#StaticTarget"><span class="hs-identifier hs-var">StaticTarget</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683062068"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062069"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unit -&gt; Maybe Unit
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621683062065"><span class="hs-keyword hs-var">unit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062070"><span class="hs-identifier hs-var">isFun</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><span class="annottext">CCallTarget
</span><span class="hs-identifier">_</span></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCallTarget
</span><a href="#local-6989586621683062066"><span class="hs-identifier hs-var">callTarget</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Instance declarations}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcInstDecl"><span class="hs-identifier hs-type">rnSrcInstDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InstDecl"><span class="hs-identifier hs-type">InstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InstDecl"><span class="hs-identifier hs-type">InstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span id="rnSrcInstDecl"><span class="annot"><span class="annottext">rnSrcInstDecl :: InstDecl GhcPs -&gt; RnM (InstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnSrcInstDecl"><span class="hs-identifier hs-var hs-var">rnSrcInstDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstD"><span class="hs-identifier hs-type">TyFamInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tfid_inst :: forall pass. InstDecl pass -&gt; TyFamInstDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#tfid_inst"><span class="hs-identifier hs-var">tfid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062074"><span class="annot"><span class="annottext">TyFamInstDecl GhcPs
</span><a href="#local-6989586621683062074"><span class="hs-identifier hs-var">tfi</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062075"><span class="annot"><a href="#local-6989586621683062075"><span class="hs-identifier hs-var">tfi'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062076"><span class="annot"><a href="#local-6989586621683062076"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
-&gt; TyFamInstDecl GhcPs -&gt; RnM (TyFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstDecl"><span class="hs-identifier hs-var">rnTyFamInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedTyFamInfo -&gt; AssocTyFamInfo
</span><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-var">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><a href="GHC.Rename.Module.html#NotClosedTyFam"><span class="hs-identifier hs-var">NotClosedTyFam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyFamInstDecl GhcPs
</span><a href="#local-6989586621683062074"><span class="hs-identifier hs-var">tfi</span></a></span><span>
</span><span id="line-446"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstD"><span class="hs-identifier hs-type">TyFamInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tfid_ext"><span class="hs-identifier hs-var">tfid_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tfid_inst"><span class="hs-identifier hs-var">tfid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062075"><span class="hs-identifier hs-type">tfi'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062076"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcInstDecl"><span class="hs-identifier hs-var">rnSrcInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstD"><span class="hs-identifier hs-type">DataFamInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dfid_inst :: forall pass. InstDecl pass -&gt; DataFamInstDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#dfid_inst"><span class="hs-identifier hs-var">dfid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062083"><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621683062083"><span class="hs-identifier hs-var">dfi</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062084"><span class="annot"><a href="#local-6989586621683062084"><span class="hs-identifier hs-var">dfi'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062085"><span class="annot"><a href="#local-6989586621683062085"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
-&gt; DataFamInstDecl GhcPs -&gt; RnM (DataFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDataFamInstDecl"><span class="hs-identifier hs-var">rnDataFamInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedTyFamInfo -&gt; AssocTyFamInfo
</span><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-var">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><a href="GHC.Rename.Module.html#NotClosedTyFam"><span class="hs-identifier hs-var">NotClosedTyFam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621683062083"><span class="hs-identifier hs-var">dfi</span></a></span><span>
</span><span id="line-450"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstD"><span class="hs-identifier hs-type">DataFamInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dfid_ext"><span class="hs-identifier hs-var">dfid_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dfid_inst"><span class="hs-identifier hs-var">dfid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062084"><span class="hs-identifier hs-type">dfi'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062085"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcInstDecl"><span class="hs-identifier hs-var">rnSrcInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstD"><span class="hs-identifier hs-type">ClsInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cid_inst :: forall pass. InstDecl pass -&gt; ClsInstDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#cid_inst"><span class="hs-identifier hs-var">cid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062090"><span class="annot"><span class="annottext">ClsInstDecl GhcPs
</span><a href="#local-6989586621683062090"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnSrcIstDecl {&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClsInstDecl GhcPs -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ClsInstDecl GhcPs
</span><a href="#local-6989586621683062090"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062091"><span class="annot"><a href="#local-6989586621683062091"><span class="hs-identifier hs-var">cid'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062092"><span class="annot"><a href="#local-6989586621683062092"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ClsInstDecl GhcPs -&gt; RnM (ClsInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnClsInstDecl"><span class="hs-identifier hs-var">rnClsInstDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ClsInstDecl GhcPs
</span><a href="#local-6989586621683062090"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-455"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnSrcIstDecl end }&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span>
</span><span id="line-456"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstD"><span class="hs-identifier hs-type">ClsInstD</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_d_ext"><span class="hs-identifier hs-var">cid_d_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_inst"><span class="hs-identifier hs-var">cid_inst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062091"><span class="hs-identifier hs-type">cid'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062092"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Warn about non-canonical typeclass instance declarations</span><span>
</span><span id="line-459"></span><span class="hs-comment">--</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- A &quot;non-canonical&quot; instance definition can occur for instances of a</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- class which redundantly defines an operation its superclass</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- provides as well (c.f. `return`/`pure`). In such cases, a canonical</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- instance is one where the subclass inherits its method</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- implementation from its superclass instance (usually the subclass</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- has a default method implementation to that effect). Consequently,</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- a non-canonical instance occurs when this is not the case.</span><span>
</span><span id="line-467"></span><span class="hs-comment">--</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- See also descriptions of 'checkCanonicalMonadInstances' and</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- 'checkCanonicalMonoidInstances'</span><span>
</span><span id="line-470"></span><span class="annot"><a href="GHC.Rename.Module.html#checkCanonicalInstances"><span class="hs-identifier hs-type">checkCanonicalInstances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span id="checkCanonicalInstances"><span class="annot"><span class="annottext">checkCanonicalInstances :: Name -&gt; LHsSigType GhcRn -&gt; LHsBinds GhcRn -&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#checkCanonicalInstances"><span class="hs-identifier hs-var hs-var">checkCanonicalInstances</span></a></span></span><span> </span><span id="local-6989586621683062096"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062096"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621683062097"><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621683062097"><span class="hs-identifier hs-var">poly_ty</span></a></span></span><span> </span><span id="local-6989586621683062098"><span class="annot"><span class="annottext">LHsBinds GhcRn
</span><a href="#local-6989586621683062098"><span class="hs-identifier hs-var">mbinds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">WarningFlag -&gt; TcRn () -&gt; TcRn ()
forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnNonCanonicalMonadInstances"><span class="hs-identifier hs-var">Opt_WarnNonCanonicalMonadInstances</span></a></span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRn ()
</span><a href="#local-6989586621683062101"><span class="hs-identifier hs-var">checkCanonicalMonadInstances</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">WarningFlag -&gt; TcRn () -&gt; TcRn ()
forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnNonCanonicalMonoidInstances"><span class="hs-identifier hs-var">Opt_WarnNonCanonicalMonoidInstances</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRn ()
</span><a href="#local-6989586621683062103"><span class="hs-identifier hs-var">checkCanonicalMonoidInstances</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-comment">-- Warn about unsound/non-canonical 'Applicative'/'Monad' instance</span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-comment">-- declarations. Specifically, the following conditions are verified:</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-comment">-- In 'Monad' instances declarations:</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-comment">--  * If 'return' is overridden it must be canonical (i.e. @return = pure@)</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-comment">--  * If '(&gt;&gt;)' is overridden it must be canonical (i.e. @(&gt;&gt;) = (*&gt;)@)</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- In 'Applicative' instance declarations:</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-comment">--  * Warn if 'pure' is defined backwards (i.e. @pure = return@).</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-comment">--  * Warn if '(*&gt;)' is defined backwards (i.e. @(*&gt;) = (&gt;&gt;)@).</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span>    </span><span id="local-6989586621683062101"><span class="annot"><span class="annottext">checkCanonicalMonadInstances :: TcRn ()
</span><a href="#local-6989586621683062101"><span class="hs-identifier hs-var hs-var">checkCanonicalMonadInstances</span></a></span></span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062096"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#applicativeClassName"><span class="hs-identifier hs-var">applicativeClassName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>          </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcRn
[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
</span><a href="#local-6989586621683062098"><span class="hs-identifier hs-var">mbinds</span></a></span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
 -&gt; TcRn ())
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062104"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062104"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683062105"><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062105"><span class="hs-identifier hs-var">mbind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; TcRn () -&gt; TcRn ()
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062104"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-495"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062105"><span class="hs-identifier hs-var">mbind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-496"></span><span>                  </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062109"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062109"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-497"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062111"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062111"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-498"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062109"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#pureAName"><span class="hs-identifier hs-var">pureAName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062111"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span>
</span><span id="line-499"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad -&gt; TcRn ()
</span><a href="#local-6989586621683062113"><span class="hs-identifier hs-var">addWarnNonCanonicalMonad</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_Pure"><span class="hs-identifier hs-var">NonCanonical_Pure</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062109"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenAName"><span class="hs-identifier hs-var">thenAName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062111"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenMName"><span class="hs-identifier hs-var">thenMName</span></a></span><span>
</span><span id="line-502"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad -&gt; TcRn ()
</span><a href="#local-6989586621683062113"><span class="hs-identifier hs-var">addWarnNonCanonicalMonad</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_ThenA"><span class="hs-identifier hs-var">NonCanonical_ThenA</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>                  </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062096"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#monadClassName"><span class="hs-identifier hs-var">monadClassName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>          </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcRn
[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
</span><a href="#local-6989586621683062098"><span class="hs-identifier hs-var">mbinds</span></a></span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
 -&gt; TcRn ())
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062116"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062116"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683062117"><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062117"><span class="hs-identifier hs-var">mbind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; TcRn () -&gt; TcRn ()
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062116"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-508"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062117"><span class="hs-identifier hs-var">mbind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>                  </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062118"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062118"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-510"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062119"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062119"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-511"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062118"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#returnMName"><span class="hs-identifier hs-var">returnMName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062119"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#pureAName"><span class="hs-identifier hs-var">pureAName</span></a></span><span>
</span><span id="line-512"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad -&gt; TcRn ()
</span><a href="#local-6989586621683062113"><span class="hs-identifier hs-var">addWarnNonCanonicalMonad</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_Return"><span class="hs-identifier hs-var">NonCanonical_Return</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062118"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenMName"><span class="hs-identifier hs-var">thenMName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062119"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#thenAName"><span class="hs-identifier hs-var">thenAName</span></a></span><span>
</span><span id="line-515"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad -&gt; TcRn ()
</span><a href="#local-6989586621683062113"><span class="hs-identifier hs-var">addWarnNonCanonicalMonad</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_ThenM"><span class="hs-identifier hs-var">NonCanonical_ThenM</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>                  </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-comment">-- Check whether Monoid(mappend) is defined in terms of</span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-comment">-- Semigroup((&lt;&gt;)) (and not the other way round). Specifically,</span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-comment">-- the following conditions are verified:</span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-comment">-- In 'Monoid' instances declarations:</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">--  * If 'mappend' is overridden it must be canonical</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-comment">--    (i.e. @mappend = (&lt;&gt;)@)</span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-comment">-- In 'Semigroup' instance declarations:</span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-comment">--  * Warn if '(&lt;&gt;)' is defined backwards (i.e. @(&lt;&gt;) = mappend@).</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-534"></span><span>    </span><span id="local-6989586621683062103"><span class="annot"><span class="annottext">checkCanonicalMonoidInstances :: TcRn ()
</span><a href="#local-6989586621683062103"><span class="hs-identifier hs-var hs-var">checkCanonicalMonoidInstances</span></a></span></span><span>
</span><span id="line-535"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062096"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#semigroupClassName"><span class="hs-identifier hs-var">semigroupClassName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-536"></span><span>          </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcRn
[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
</span><a href="#local-6989586621683062098"><span class="hs-identifier hs-var">mbinds</span></a></span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
 -&gt; TcRn ())
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062122"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062122"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683062123"><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062123"><span class="hs-identifier hs-var">mbind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; TcRn () -&gt; TcRn ()
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062122"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-537"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062123"><span class="hs-identifier hs-var">mbind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-538"></span><span>                  </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062124"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062124"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-539"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062125"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062125"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-540"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062124"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#sappendName"><span class="hs-identifier hs-var">sappendName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062125"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mappendName"><span class="hs-identifier hs-var">mappendName</span></a></span><span>
</span><span id="line-541"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monoid -&gt; TcRn ()
</span><a href="#local-6989586621683062126"><span class="hs-identifier hs-var">addWarnNonCanonicalMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monoid
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_Sappend"><span class="hs-identifier hs-var">NonCanonical_Sappend</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>                  </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062096"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#monoidClassName"><span class="hs-identifier hs-var">monoidClassName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-546"></span><span>          </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcRn
[GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn)]
</span><a href="#local-6989586621683062098"><span class="hs-identifier hs-var">mbinds</span></a></span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
 -&gt; TcRn ())
-&gt; (GenLocated SrcSpanAnnA (HsBindLR GhcRn GhcRn) -&gt; TcRn ())
-&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062128"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062128"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683062129"><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062129"><span class="hs-identifier hs-var">mbind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; TcRn () -&gt; TcRn ()
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062128"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-547"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><a href="#local-6989586621683062129"><span class="hs-identifier hs-var">mbind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-548"></span><span>                  </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062130"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062130"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-549"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062131"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062131"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-550"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062130"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mappendName"><span class="hs-identifier hs-var">mappendName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621683062131"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Maybe Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#sappendName"><span class="hs-identifier hs-var">sappendName</span></a></span><span>
</span><span id="line-551"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monoid -&gt; TcRn ()
</span><a href="#local-6989586621683062126"><span class="hs-identifier hs-var">addWarnNonCanonicalMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monoid
</span><a href="GHC.Tc.Errors.Types.html#NonCanonical_Mappend"><span class="hs-identifier hs-var">NonCanonical_Mappend</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>                  </span><span class="annot"><span class="annottext">HsBindLR GhcRn GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-comment">-- test whether MatchGroup represents a trivial \&quot;lhsName = rhsName\&quot;</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-comment">-- binding, and return @Just rhsName@ if this is the case</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="#local-6989586621683062112"><span class="hs-identifier hs-type">isAliasMG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621683062112"><span class="annot"><span class="annottext">isAliasMG :: MatchGroup GhcRn (LHsExpr GhcRn) -&gt; Maybe Name
</span><a href="#local-6989586621683062112"><span class="hs-identifier hs-var hs-var">isAliasMG</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#MG"><span class="hs-identifier hs-type">MG</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mg_alts :: forall p body. MatchGroup p body -&gt; XRec p [LMatch p body]
</span><a href="Language.Haskell.Syntax.Expr.html#mg_alts"><span class="hs-identifier hs-var">mg_alts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">m_pats :: forall p body. Match p body -&gt; XRec p [LPat p]
</span><a href="Language.Haskell.Syntax.Expr.html#m_pats"><span class="hs-identifier hs-var">m_pats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpaLocation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m_grhss :: forall p body. Match p body -&gt; GRHSs p body
</span><a href="Language.Haskell.Syntax.Expr.html#m_grhss"><span class="hs-identifier hs-var">m_grhss</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062138"><span class="annot"><span class="annottext">GRHSs GhcRn (GenLocated SrcSpanAnnA (HsExpr GhcRn))
</span><a href="#local-6989586621683062138"><span class="hs-identifier hs-var">grhss</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">XCGRHSs GhcRn (GenLocated SrcSpanAnnA (HsExpr GhcRn))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#GRHS"><span class="hs-identifier hs-type">GRHS</span></a></span><span> </span><span class="annot"><span class="annottext">XCGRHS GhcRn (GenLocated SrcSpanAnnA (HsExpr GhcRn))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621683062141"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062141"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621683062142"><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621683062142"><span class="hs-identifier hs-var">lbinds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GRHSs GhcRn (GenLocated SrcSpanAnnA (HsExpr GhcRn))
</span><a href="#local-6989586621683062138"><span class="hs-identifier hs-var">grhss</span></a></span><span>
</span><span id="line-563"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#EmptyLocalBinds"><span class="hs-identifier hs-type">EmptyLocalBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XEmptyLocalBinds GhcRn GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcRn
</span><a href="#local-6989586621683062142"><span class="hs-identifier hs-var">lbinds</span></a></span><span>
</span><span id="line-564"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062145"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621683062145"><span class="hs-identifier hs-var">lrhsName</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; HsExpr GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062141"><span class="hs-identifier hs-var">body</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683062145"><span class="hs-identifier hs-var">lrhsName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="#local-6989586621683062112"><span class="hs-identifier hs-var">isAliasMG</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621683062126"><span class="annot"><span class="annottext">addWarnNonCanonicalMonoid :: NonCanonical_Monoid -&gt; TcRn ()
</span><a href="#local-6989586621683062126"><span class="hs-identifier hs-var hs-var">addWarnNonCanonicalMonoid</span></a></span></span><span> </span><span id="local-6989586621683062146"><span class="annot"><span class="annottext">NonCanonical_Monoid
</span><a href="#local-6989586621683062146"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><span class="annottext">NonCanonicalDefinition -&gt; TcRn ()
</span><a href="#local-6989586621683062147"><span class="hs-identifier hs-var">addWarnNonCanonicalDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonCanonical_Monoid -&gt; NonCanonicalDefinition
</span><a href="GHC.Tc.Errors.Types.html#NonCanonicalMonoid"><span class="hs-identifier hs-var">NonCanonicalMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monoid
</span><a href="#local-6989586621683062146"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621683062113"><span class="annot"><span class="annottext">addWarnNonCanonicalMonad :: NonCanonical_Monad -&gt; TcRn ()
</span><a href="#local-6989586621683062113"><span class="hs-identifier hs-var hs-var">addWarnNonCanonicalMonad</span></a></span></span><span> </span><span id="local-6989586621683062149"><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="#local-6989586621683062149"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-571"></span><span>      </span><span class="annot"><span class="annottext">NonCanonicalDefinition -&gt; TcRn ()
</span><a href="#local-6989586621683062147"><span class="hs-identifier hs-var">addWarnNonCanonicalDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonCanonical_Monad -&gt; NonCanonicalDefinition
</span><a href="GHC.Tc.Errors.Types.html#NonCanonicalMonad"><span class="hs-identifier hs-var">NonCanonicalMonad</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonical_Monad
</span><a href="#local-6989586621683062149"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621683062147"><span class="annot"><span class="annottext">addWarnNonCanonicalDefinition :: NonCanonicalDefinition -&gt; TcRn ()
</span><a href="#local-6989586621683062147"><span class="hs-identifier hs-var hs-var">addWarnNonCanonicalDefinition</span></a></span></span><span> </span><span id="local-6989586621683062151"><span class="annot"><span class="annottext">NonCanonicalDefinition
</span><a href="#local-6989586621683062151"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addDiagnostic"><span class="hs-identifier hs-var">addDiagnostic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonCanonicalDefinition -&gt; LHsSigType GhcRn -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnNonCanonicalDefinition"><span class="hs-identifier hs-var">TcRnNonCanonicalDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">NonCanonicalDefinition
</span><a href="#local-6989586621683062151"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621683062097"><span class="hs-identifier hs-var">poly_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span class="annot"><a href="GHC.Rename.Module.html#rnClsInstDecl"><span class="hs-identifier hs-type">rnClsInstDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstDecl"><span class="hs-identifier hs-type">ClsInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstDecl"><span class="hs-identifier hs-type">ClsInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span id="rnClsInstDecl"><span class="annot"><span class="annottext">rnClsInstDecl :: ClsInstDecl GhcPs -&gt; RnM (ClsInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnClsInstDecl"><span class="hs-identifier hs-var hs-var">rnClsInstDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstDecl"><span class="hs-identifier hs-type">ClsInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cid_ext :: forall pass. ClsInstDecl pass -&gt; XCClsInstDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#cid_ext"><span class="hs-identifier hs-var">cid_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062156"><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683062156"><span class="hs-identifier hs-var">inst_warn_ps</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnClsInstDecl
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnSortKey DeclTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_poly_ty :: forall pass. ClsInstDecl pass -&gt; LHsSigType pass
</span><a href="Language.Haskell.Syntax.Decls.html#cid_poly_ty"><span class="hs-identifier hs-var">cid_poly_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062158"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062158"><span class="hs-identifier hs-var">inst_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_binds :: forall pass. ClsInstDecl pass -&gt; LHsBinds pass
</span><a href="Language.Haskell.Syntax.Decls.html#cid_binds"><span class="hs-identifier hs-var">cid_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062160"><span class="annot"><span class="annottext">LHsBinds GhcPs
</span><a href="#local-6989586621683062160"><span class="hs-identifier hs-var">mbinds</span></a></span></span><span>
</span><span id="line-579"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_sigs :: forall pass. ClsInstDecl pass -&gt; [LSig pass]
</span><a href="Language.Haskell.Syntax.Decls.html#cid_sigs"><span class="hs-identifier hs-var">cid_sigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062162"><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621683062162"><span class="hs-identifier hs-var">uprags</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_tyfam_insts :: forall pass. ClsInstDecl pass -&gt; [LTyFamInstDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#cid_tyfam_insts"><span class="hs-identifier hs-var">cid_tyfam_insts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062164"><span class="annot"><span class="annottext">[LTyFamInstDecl GhcPs]
</span><a href="#local-6989586621683062164"><span class="hs-identifier hs-var">ats</span></a></span></span><span>
</span><span id="line-580"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_overlap_mode :: forall pass. ClsInstDecl pass -&gt; Maybe (XRec pass OverlapMode)
</span><a href="Language.Haskell.Syntax.Decls.html#cid_overlap_mode"><span class="hs-identifier hs-var">cid_overlap_mode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062166"><span class="annot"><span class="annottext">Maybe (XRec GhcPs OverlapMode)
</span><a href="#local-6989586621683062166"><span class="hs-identifier hs-var">oflag</span></a></span></span><span>
</span><span id="line-581"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_datafam_insts :: forall pass. ClsInstDecl pass -&gt; [LDataFamInstDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#cid_datafam_insts"><span class="hs-identifier hs-var">cid_datafam_insts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062168"><span class="annot"><span class="annottext">[LDataFamInstDecl GhcPs]
</span><a href="#local-6989586621683062168"><span class="hs-identifier hs-var">adts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsSigType GhcPs -&gt; TcRn ()
</span><a href="GHC.Rename.Utils.html#checkInferredVars"><span class="hs-identifier hs-var">checkInferredVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062169"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062158"><span class="hs-identifier hs-var">inst_ty</span></a></span><span>
</span><span id="line-583"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062170"><span class="annot"><a href="#local-6989586621683062170"><span class="hs-identifier hs-var">inst_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062171"><span class="annot"><a href="#local-6989586621683062171"><span class="hs-identifier hs-var">inst_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; TypeOrKind
-&gt; LHsSigType GhcPs
-&gt; RnM (LHsSigType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062169"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrKind
</span><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062158"><span class="hs-identifier hs-var">inst_ty</span></a></span><span>
</span><span id="line-584"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062172"><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-var">ktv_names</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062173"><span class="annot"><a href="#local-6989586621683062173"><span class="hs-identifier hs-var">head_ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Type.html#splitLHsInstDeclTy"><span class="hs-identifier hs-type">splitLHsInstDeclTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062170"><span class="hs-identifier hs-type">inst_ty'</span></a></span><span>
</span><span id="line-585"></span><span>             </span><span class="hs-comment">-- Check if there are any nested `forall`s or contexts, which are</span><span>
</span><span id="line-586"></span><span>             </span><span class="hs-comment">-- illegal in the type of an instance declaration (see</span><span>
</span><span id="line-587"></span><span>             </span><span class="hs-comment">-- Note [No nested foralls or contexts in instance types] in</span><span>
</span><span id="line-588"></span><span>             </span><span class="hs-comment">-- GHC.Hs.Type)...</span><span>
</span><span id="line-589"></span><span>             </span><span id="local-6989586621683062175"><span class="annot"><a href="#local-6989586621683062175"><span class="hs-identifier hs-var hs-var">mb_nested_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NestedForallsContextsIn
-&gt; LHsType GhcRn -&gt; Maybe (SrcSpan, TcRnMessage)
</span><a href="GHC.Rename.Utils.html#noNestedForallsContextsErr"><span class="hs-identifier hs-var">noNestedForallsContextsErr</span></a></span><span>
</span><span id="line-590"></span><span>                               </span><span class="annot"><span class="annottext">NestedForallsContextsIn
</span><a href="GHC.Tc.Errors.Types.html#NFC_InstanceHead"><span class="hs-identifier hs-var">NFC_InstanceHead</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621683062173"><span class="hs-identifier hs-var">head_ty'</span></a></span><span>
</span><span id="line-591"></span><span>             </span><span class="hs-comment">-- ...then check if the instance head is actually headed by a</span><span>
</span><span id="line-592"></span><span>             </span><span class="hs-comment">-- class type constructor...</span><span>
</span><span id="line-593"></span><span>             </span><span id="local-6989586621683062177"><span class="annot"><a href="#local-6989586621683062177"><span class="hs-identifier hs-var hs-var">eith_cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn -&gt; Maybe (LocatedN (IdP GhcRn))
forall (p :: Pass).
(Anno (IdGhcP p) ~ SrcSpanAnnN) =&gt;
LHsType (GhcPass p) -&gt; Maybe (LocatedN (IdP (GhcPass p)))
</span><a href="GHC.Hs.Type.html#hsTyGetAppHead_maybe"><span class="hs-identifier hs-var">hsTyGetAppHead_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621683062173"><span class="hs-identifier hs-var">head_ty'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062179"><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621683062179"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Either (SrcSpan, TcRnMessage) Name
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
Name
</span><a href="#local-6989586621683062179"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-595"></span><span>               </span><span class="annot"><span class="annottext">Maybe (LocatedN (IdP GhcRn))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-596"></span><span>                  </span><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage) -&gt; Either (SrcSpan, TcRnMessage) Name
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-597"></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
GenLocated SrcSpanAnnA (HsType GhcRn)
</span><a href="#local-6989586621683062173"><span class="hs-identifier hs-var">head_ty'</span></a></span><span>
</span><span id="line-598"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IllegalInstanceReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalInstance"><span class="hs-identifier hs-var">TcRnIllegalInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(IllegalInstanceReason -&gt; TcRnMessage)
-&gt; IllegalInstanceReason -&gt; TcRnMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-599"></span><span>                       </span><span class="annot"><span class="annottext">TypedThing -&gt; IllegalClassInstanceReason -&gt; IllegalInstanceReason
</span><a href="GHC.Tc.Errors.Types.html#IllegalClassInstance"><span class="hs-identifier hs-var">IllegalClassInstance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsType GhcRn -&gt; TypedThing
</span><a href="GHC.Tc.Types.Origin.html#HsTypeRnThing"><span class="hs-identifier hs-var">HsTypeRnThing</span></a></span><span> </span><span class="annot"><span class="annottext">(HsType GhcRn -&gt; TypedThing) -&gt; HsType GhcRn -&gt; TypedThing
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; HsType GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
GenLocated SrcSpanAnnA (HsType GhcRn)
</span><a href="#local-6989586621683062173"><span class="hs-identifier hs-var">head_ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IllegalClassInstanceReason -&gt; IllegalInstanceReason)
-&gt; IllegalClassInstanceReason -&gt; IllegalInstanceReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-600"></span><span>                       </span><span class="annot"><span class="annottext">IllegalInstanceHeadReason -&gt; IllegalClassInstanceReason
</span><a href="GHC.Tc.Errors.Types.html#IllegalInstanceHead"><span class="hs-identifier hs-var">IllegalInstanceHead</span></a></span><span> </span><span class="annot"><span class="annottext">(IllegalInstanceHeadReason -&gt; IllegalClassInstanceReason)
-&gt; IllegalInstanceHeadReason -&gt; IllegalClassInstanceReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon -&gt; IllegalInstanceHeadReason
</span><a href="GHC.Tc.Errors.Types.html#InstHeadNonClass"><span class="hs-identifier hs-var">InstHeadNonClass</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-601"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>         </span><span class="hs-comment">-- ...finally, attempt to retrieve the class type constructor, failing</span><span>
</span><span id="line-603"></span><span>         </span><span class="hs-comment">-- with an error message if there isn't one. To avoid excessive</span><span>
</span><span id="line-604"></span><span>         </span><span class="hs-comment">-- amounts of error messages, we will only report one of the errors</span><span>
</span><span id="line-605"></span><span>         </span><span class="hs-comment">-- from mb_nested_msg or eith_cls at a time.</span><span>
</span><span id="line-606"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062186"><span class="annot"><a href="#local-6989586621683062186"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062175"><span class="hs-identifier hs-type">mb_nested_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062177"><span class="hs-identifier hs-type">eith_cls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-607"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (SrcSpan, TcRnMessage)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621683062187"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062187"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062187"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-608"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062188"><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage)
</span><a href="#local-6989586621683062188"><span class="hs-identifier hs-var">err1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either (SrcSpan, TcRnMessage) Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage) -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="#local-6989586621683062189"><span class="hs-identifier hs-var">bail_out</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage)
</span><a href="#local-6989586621683062188"><span class="hs-identifier hs-var">err1</span></a></span><span>
</span><span id="line-609"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (SrcSpan, TcRnMessage)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621683062190"><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage)
</span><a href="#local-6989586621683062190"><span class="hs-identifier hs-var">err2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage) -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="#local-6989586621683062189"><span class="hs-identifier hs-var">bail_out</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, TcRnMessage)
</span><a href="#local-6989586621683062190"><span class="hs-identifier hs-var">err2</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>          </span><span class="hs-comment">-- Rename the bindings</span><span>
</span><span id="line-612"></span><span>          </span><span class="hs-comment">-- The typechecker (not the renamer) checks that all</span><span>
</span><span id="line-613"></span><span>          </span><span class="hs-comment">-- the bindings are for the right class</span><span>
</span><span id="line-614"></span><span>          </span><span class="hs-comment">-- (Slightly strangely) when scoped type variables are on, the</span><span>
</span><span id="line-615"></span><span>          </span><span class="hs-comment">-- forall-d tyvars scope over the method bindings too</span><span>
</span><span id="line-616"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062191"><span class="annot"><a href="#local-6989586621683062191"><span class="hs-identifier hs-var">mbinds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062192"><span class="annot"><a href="#local-6989586621683062192"><span class="hs-identifier hs-var">uprags'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062193"><span class="annot"><a href="#local-6989586621683062193"><span class="hs-identifier hs-var">meth_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnMethodBinds"><span class="hs-identifier hs-type">rnMethodBinds</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621683062186"><span class="hs-identifier hs-type">cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-type">ktv_names</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062160"><span class="hs-identifier hs-type">mbinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062162"><span class="hs-identifier hs-type">uprags</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#checkCanonicalInstances"><span class="hs-identifier hs-type">checkCanonicalInstances</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062186"><span class="hs-identifier hs-type">cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062170"><span class="hs-identifier hs-type">inst_ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062191"><span class="hs-identifier hs-type">mbinds'</span></a></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>       </span><span class="hs-comment">-- Rename the associated types, and type signatures</span><span>
</span><span id="line-621"></span><span>       </span><span class="hs-comment">-- Both need to have the instance type variables in scope</span><span>
</span><span id="line-622"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnSrcInstDecl&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062170"><span class="hs-identifier hs-type">inst_ty'</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-type">ktv_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621683062196"><span class="annot"><a href="#local-6989586621683062196"><span class="hs-identifier hs-var">ats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062197"><span class="annot"><a href="#local-6989586621683062197"><span class="hs-identifier hs-var">adts'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062198"><span class="annot"><a href="#local-6989586621683062198"><span class="hs-identifier hs-var">more_fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier hs-type">bindLocalNamesFV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-type">ktv_names</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-625"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062199"><span class="annot"><a href="#local-6989586621683062199"><span class="hs-identifier hs-var">ats'</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621683062200"><span class="annot"><a href="#local-6989586621683062200"><span class="hs-identifier hs-var">at_fvs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnATInstDecls"><span class="hs-identifier hs-type">rnATInstDecls</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnTyFamInstDecl"><span class="hs-identifier hs-type">rnTyFamInstDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062186"><span class="hs-identifier hs-type">cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-type">ktv_names</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062164"><span class="hs-identifier hs-type">ats</span></a></span><span>
</span><span id="line-626"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062202"><span class="annot"><a href="#local-6989586621683062202"><span class="hs-identifier hs-var">adts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062203"><span class="annot"><a href="#local-6989586621683062203"><span class="hs-identifier hs-var">adt_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnATInstDecls"><span class="hs-identifier hs-type">rnATInstDecls</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnDataFamInstDecl"><span class="hs-identifier hs-type">rnDataFamInstDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062186"><span class="hs-identifier hs-type">cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062172"><span class="hs-identifier hs-type">ktv_names</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062168"><span class="hs-identifier hs-type">adts</span></a></span><span>
</span><span id="line-627"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062199"><span class="hs-identifier hs-type">ats'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062202"><span class="hs-identifier hs-type">adts'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062200"><span class="hs-identifier hs-type">at_fvs</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062203"><span class="hs-identifier hs-type">adt_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062204"><span class="annot"><a href="#local-6989586621683062204"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062193"><span class="hs-identifier hs-var">meth_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062198"><span class="hs-identifier hs-var">more_fvs</span></a></span><span>
</span><span id="line-630"></span><span>                                </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062171"><span class="hs-identifier hs-var">inst_fvs</span></a></span><span>
</span><span id="line-631"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062205"><span class="annot"><a href="#local-6989586621683062205"><span class="hs-identifier hs-var">inst_warn_rn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier hs-type">rnLWarningTxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062156"><span class="hs-identifier hs-type">inst_warn_ps</span></a></span><span>
</span><span id="line-632"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstDecl"><span class="hs-identifier hs-type">ClsInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_ext"><span class="hs-identifier hs-var">cid_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062205"><span class="hs-identifier hs-type">inst_warn_rn</span></a></span><span>
</span><span id="line-633"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_poly_ty"><span class="hs-identifier hs-var">cid_poly_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062170"><span class="hs-identifier hs-type">inst_ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_binds"><span class="hs-identifier hs-var">cid_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062191"><span class="hs-identifier hs-type">mbinds'</span></a></span><span>
</span><span id="line-634"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_sigs"><span class="hs-identifier hs-var">cid_sigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062192"><span class="hs-identifier hs-type">uprags'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_tyfam_insts"><span class="hs-identifier hs-var">cid_tyfam_insts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062196"><span class="hs-identifier hs-type">ats'</span></a></span><span>
</span><span id="line-635"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_overlap_mode"><span class="hs-identifier hs-var">cid_overlap_mode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062166"><span class="hs-identifier hs-type">oflag</span></a></span><span>
</span><span id="line-636"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#cid_datafam_insts"><span class="hs-identifier hs-var">cid_datafam_insts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062197"><span class="hs-identifier hs-type">adts'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-637"></span><span>                 </span><span class="annot"><a href="#local-6989586621683062204"><span class="hs-identifier hs-type">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-638"></span><span>             </span><span class="hs-comment">-- We return the renamed associated data type declarations so</span><span>
</span><span id="line-639"></span><span>             </span><span class="hs-comment">-- that they can be entered into the list of type declarations</span><span>
</span><span id="line-640"></span><span>             </span><span class="hs-comment">-- for the binding group, but we also keep a copy in the instance.</span><span>
</span><span id="line-641"></span><span>             </span><span class="hs-comment">-- The latter is needed for well-formedness checks in the type</span><span>
</span><span id="line-642"></span><span>             </span><span class="hs-comment">-- checker (eg, to ensure that all ATs of the instance actually</span><span>
</span><span id="line-643"></span><span>             </span><span class="hs-comment">-- receive a declaration).</span><span>
</span><span id="line-644"></span><span>             </span><span class="hs-comment">-- NB: Even the copies in the instance declaration carry copies of</span><span>
</span><span id="line-645"></span><span>             </span><span class="hs-comment">--     the instance context after renaming.  This is a bit</span><span>
</span><span id="line-646"></span><span>             </span><span class="hs-comment">--     strange, but should not matter (and it would be more work</span><span>
</span><span id="line-647"></span><span>             </span><span class="hs-comment">--     to remove the context).</span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621683062169"><span class="annot"><span class="annottext">ctxt :: HsDocContext
</span><a href="#local-6989586621683062169"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#GenericCtx"><span class="hs-identifier hs-var">GenericCtx</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; HsDocContext) -&gt; SDoc -&gt; HsDocContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;an instance declaration&quot;</span></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-comment">-- The instance is malformed. We'd still like to make *some* progress</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-comment">-- (rather than failing outright), so we report an error and continue for</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-comment">-- as long as we can. Importantly, this error should be thrown before we</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-comment">-- reach the typechecker, lest we encounter different errors that are</span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-comment">-- hopelessly confusing (such as the one in #16114).</span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621683062189"><span class="annot"><span class="annottext">bail_out :: (SrcSpan, TcRnMessage) -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="#local-6989586621683062189"><span class="hs-identifier hs-var hs-var">bail_out</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062210"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062210"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062211"><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683062211"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-657"></span><span>      </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062210"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; TcRnMessage -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnWithHsDocContext"><span class="hs-identifier hs-var">TcRnWithHsDocContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062169"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683062211"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-658"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name)
-&gt; Name -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Name
</span><a href="GHC.Builtin.Names.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabelString -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkTcOccFS"><span class="hs-identifier hs-var">mkTcOccFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CLabelString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;class&gt;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span id="local-6989586621683060657"><span id="local-6989586621683060659"><span class="annot"><a href="GHC.Rename.Module.html#rnFamEqn"><span class="hs-identifier hs-type">rnFamEqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-661"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-type">AssocTyFamInfo</span></a></span><span>
</span><span id="line-662"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060657"><span class="hs-identifier hs-type">rhs</span></a></span><span>
</span><span id="line-663"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683060657"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060659"><span class="hs-identifier hs-type">rhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060659"><span class="hs-identifier hs-type">rhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-665"></span><span id="rnFamEqn"><span class="annot"><span class="annottext">rnFamEqn :: forall rhs rhs'.
HsDocContext
-&gt; AssocTyFamInfo
-&gt; FamEqn GhcPs rhs
-&gt; (HsDocContext -&gt; rhs -&gt; RnM (rhs', FreeVars))
-&gt; RnM (FamEqn GhcRn rhs', FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamEqn"><span class="hs-identifier hs-var hs-var">rnFamEqn</span></a></span></span><span> </span><span id="local-6989586621683062242"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062242"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683062243"><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062243"><span class="hs-identifier hs-var">atfi</span></a></span></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">feqn_tycon :: forall pass rhs. FamEqn pass rhs -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_tycon"><span class="hs-identifier hs-var">feqn_tycon</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062246"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062246"><span class="hs-identifier hs-var">tycon</span></a></span></span><span>
</span><span id="line-667"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feqn_bndrs :: forall pass rhs. FamEqn pass rhs -&gt; HsOuterFamEqnTyVarBndrs pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_bndrs"><span class="hs-identifier hs-var">feqn_bndrs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062248"><span class="annot"><span class="annottext">HsOuterFamEqnTyVarBndrs GhcPs
</span><a href="#local-6989586621683062248"><span class="hs-identifier hs-var">outer_bndrs</span></a></span></span><span>
</span><span id="line-668"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feqn_pats :: forall pass rhs. FamEqn pass rhs -&gt; HsFamEqnPats pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_pats"><span class="hs-identifier hs-var">feqn_pats</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062250"><span class="annot"><span class="annottext">HsFamEqnPats GhcPs
</span><a href="#local-6989586621683062250"><span class="hs-identifier hs-var">pats</span></a></span></span><span>
</span><span id="line-669"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feqn_fixity :: forall pass rhs. FamEqn pass rhs -&gt; LexicalFixity
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_fixity"><span class="hs-identifier hs-var">feqn_fixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062252"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621683062252"><span class="hs-identifier hs-var">fixity</span></a></span></span><span>
</span><span id="line-670"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">feqn_rhs :: forall pass rhs. FamEqn pass rhs -&gt; rhs
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_rhs"><span class="hs-identifier hs-var">feqn_rhs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062254"><span class="annot"><span class="annottext">rhs
</span><a href="#local-6989586621683062254"><span class="hs-identifier hs-var">payload</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062255"><span class="annot"><span class="annottext">HsDocContext -&gt; rhs -&gt; RnM (rhs', FreeVars)
</span><a href="#local-6989586621683062255"><span class="hs-identifier hs-var">rn_payload</span></a></span></span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062256"><span class="annot"><a href="#local-6989586621683062256"><span class="hs-identifier hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupFamInstName"><span class="hs-identifier hs-var">lookupFamInstName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621683062258"><span class="hs-identifier hs-var">mb_cls</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062246"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>         </span><span class="hs-comment">-- all_imp_vars represent the implicitly bound type variables. This is</span><span>
</span><span id="line-674"></span><span>         </span><span class="hs-comment">-- empty if we have an explicit `forall` (see</span><span>
</span><span id="line-675"></span><span>         </span><span class="hs-comment">-- Note [forall-or-nothing rule] in GHC.Hs.Type), which means</span><span>
</span><span id="line-676"></span><span>         </span><span class="hs-comment">-- ignoring pat_kity_vars, the free variables mentioned in the type patterns</span><span>
</span><span id="line-677"></span><span>         </span><span class="hs-comment">-- on the LHS of the equation</span><span>
</span><span id="line-678"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-679"></span><span>         </span><span class="hs-comment">-- Some examples:</span><span>
</span><span id="line-680"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-681"></span><span>         </span><span class="hs-comment">-- @</span><span>
</span><span id="line-682"></span><span>         </span><span class="hs-comment">-- type family F a b</span><span>
</span><span id="line-683"></span><span>         </span><span class="hs-comment">-- type instance forall a b c. F [(a, b)] c = a -&gt; b -&gt; c</span><span>
</span><span id="line-684"></span><span>         </span><span class="hs-comment">--   -- all_imp_vars = []</span><span>
</span><span id="line-685"></span><span>         </span><span class="hs-comment">-- type instance F [(a, b)] c = a -&gt; b -&gt; c</span><span>
</span><span id="line-686"></span><span>         </span><span class="hs-comment">--   -- all_imp_vars = [a, b, c]</span><span>
</span><span id="line-687"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-688"></span><span>         </span><span class="hs-comment">-- type family G :: Maybe a</span><span>
</span><span id="line-689"></span><span>         </span><span class="hs-comment">-- type instance forall a. G = (Nothing :: Maybe a)</span><span>
</span><span id="line-690"></span><span>         </span><span class="hs-comment">--   -- all_imp_vars = []</span><span>
</span><span id="line-691"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-692"></span><span>         </span><span class="hs-comment">-- data family H :: k -&gt; Type</span><span>
</span><span id="line-693"></span><span>         </span><span class="hs-comment">-- data instance forall k. H :: k -&gt; Type where ...</span><span>
</span><span id="line-694"></span><span>         </span><span class="hs-comment">--   -- all_imp_vars = []</span><span>
</span><span id="line-695"></span><span>         </span><span class="hs-comment">-- data instance H :: k -&gt; Type where ...</span><span>
</span><span id="line-696"></span><span>         </span><span class="hs-comment">--   -- all_imp_vars = [k]</span><span>
</span><span id="line-697"></span><span>         </span><span class="hs-comment">-- @</span><span>
</span><span id="line-698"></span><span>         </span><span class="hs-comment">--</span><span>
</span><span id="line-699"></span><span>         </span><span class="hs-comment">-- For associated type family instances, exclude the type variables</span><span>
</span><span id="line-700"></span><span>         </span><span class="hs-comment">-- bound by the instance head with filterInScopeM (#19649).</span><span>
</span><span id="line-701"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062259"><span class="annot"><a href="#local-6989586621683062259"><span class="hs-identifier hs-var">all_imp_vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#filterInScopeM"><span class="hs-identifier hs-type">filterInScopeM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621683062261"><span class="hs-identifier hs-type">pat_kity_vars</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsOuterTyVarBndrs"><span class="hs-identifier hs-type">bindHsOuterTyVarBndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062242"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062258"><span class="hs-identifier hs-type">mb_cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062259"><span class="hs-identifier hs-type">all_imp_vars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062248"><span class="hs-identifier hs-type">outer_bndrs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683062263"><span class="annot"><span class="annottext">HsOuterTyVarBndrs () GhcRn
</span><a href="#local-6989586621683062263"><span class="hs-identifier hs-var">rn_outer_bndrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062264"><span class="annot"><a href="#local-6989586621683062264"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062265"><span class="annot"><a href="#local-6989586621683062265"><span class="hs-identifier hs-var">pat_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsFamEqnPats GhcPs -&gt; RnM ([LHsTypeArg GhcRn], FreeVars)
</span><a href="GHC.Rename.HsType.html#rnLHsTypeArgs"><span class="hs-identifier hs-var">rnLHsTypeArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#FamPatCtx"><span class="hs-identifier hs-var">FamPatCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062246"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsFamEqnPats GhcPs
</span><a href="#local-6989586621683062250"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-705"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062268"><span class="annot"><a href="#local-6989586621683062268"><span class="hs-identifier hs-var">payload'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062269"><span class="annot"><a href="#local-6989586621683062269"><span class="hs-identifier hs-var">rhs_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683062255"><span class="hs-identifier hs-type">rn_payload</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062242"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062254"><span class="hs-identifier hs-type">payload</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>          </span><span class="hs-comment">-- Report unused binders on the LHS</span><span>
</span><span id="line-708"></span><span>          </span><span class="hs-comment">-- See Note [Unused type variables in family instances]</span><span>
</span><span id="line-709"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- The SrcSpan that bindHsOuterFamEqnTyVarBndrs will attach to each</span><span>
</span><span id="line-710"></span><span>             </span><span class="hs-comment">-- implicitly bound type variable Name in outer_bndrs' will</span><span>
</span><span id="line-711"></span><span>             </span><span class="hs-comment">-- span the entire type family instance, which will be reflected in</span><span>
</span><span id="line-712"></span><span>             </span><span class="hs-comment">-- -Wunused-type-patterns warnings. We can be a little more precise</span><span>
</span><span id="line-713"></span><span>             </span><span class="hs-comment">-- than that by pointing to the LHS of the instance instead, which</span><span>
</span><span id="line-714"></span><span>             </span><span class="hs-comment">-- is what lhs_loc corresponds to.</span><span>
</span><span id="line-715"></span><span>             </span><span id="local-6989586621683062270"><span class="annot"><a href="#local-6989586621683062270"><span class="hs-identifier hs-var hs-var">rn_outer_bndrs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XHsOuterImplicit GhcRn -&gt; XHsOuterImplicit GhcRn)
-&gt; HsOuterTyVarBndrs () GhcRn -&gt; HsOuterTyVarBndrs () GhcRn
forall pass flag.
(XHsOuterImplicit pass -&gt; XHsOuterImplicit pass)
-&gt; HsOuterTyVarBndrs flag pass -&gt; HsOuterTyVarBndrs flag pass
</span><a href="Language.Haskell.Syntax.Type.html#mapHsOuterImplicit"><span class="hs-identifier hs-var">mapHsOuterImplicit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; [Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#setNameLoc"><span class="hs-operator hs-var">`setNameLoc`</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062273"><span class="hs-identifier hs-var">lhs_loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>                                                  </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs () GhcRn
</span><a href="#local-6989586621683062263"><span class="hs-identifier hs-var">rn_outer_bndrs</span></a></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span>             </span><span class="annot"><a href="#local-6989586621683062274"><span class="hs-identifier hs-type">groups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-719"></span><span>             </span><span id="local-6989586621683062274"><span class="annot"><a href="#local-6989586621683062274"><span class="hs-identifier hs-var hs-var">groups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; GenLocated SrcSpanAnnN RdrName -&gt; Ordering)
-&gt; FreeKiTyVars -&gt; [NonEmpty (GenLocated SrcSpanAnnN RdrName)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [NonEmpty a]
</span><a href="GHC.Data.List.SetOps.html#equivClasses"><span class="hs-identifier hs-var">equivClasses</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; GenLocated SrcSpanAnnN RdrName -&gt; Ordering
forall a l. Ord a =&gt; GenLocated l a -&gt; GenLocated l a -&gt; Ordering
</span><a href="GHC.Types.SrcLoc.html#cmpLocated"><span class="hs-identifier hs-var">cmpLocated</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062261"><span class="hs-identifier hs-var">pat_kity_vars</span></a></span><span>
</span><span id="line-720"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062276"><span class="annot"><a href="#local-6989586621683062276"><span class="hs-identifier hs-var">nms_dups</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Env.html#lookupOccRn"><span class="hs-identifier hs-type">lookupOccRn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-721"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621683062277"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062277"><span class="annot"><a href="#local-6989586621683062277"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683062274"><span class="hs-identifier hs-type">groups</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>             </span><span class="hs-comment">-- Add to the used variables</span><span>
</span><span id="line-723"></span><span>             </span><span class="hs-comment">--  a) any variables that appear *more than once* on the LHS</span><span>
</span><span id="line-724"></span><span>             </span><span class="hs-comment">--     e.g.   F a Int a = Bool</span><span>
</span><span id="line-725"></span><span>             </span><span class="hs-comment">--  b) for associated instances, the variables</span><span>
</span><span id="line-726"></span><span>             </span><span class="hs-comment">--     of the instance decl.  See</span><span>
</span><span id="line-727"></span><span>             </span><span class="hs-comment">--     Note [Unused type variables in family instances]</span><span>
</span><span id="line-728"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062278"><span class="annot"><a href="#local-6989586621683062278"><span class="hs-identifier hs-var hs-var">nms_used</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; [Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#extendNameSetList"><span class="hs-identifier hs-var">extendNameSetList</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062269"><span class="hs-identifier hs-var">rhs_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; FreeVars) -&gt; [Name] -&gt; FreeVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-729"></span><span>                           </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062276"><span class="hs-identifier hs-var">nms_dups</span></a></span><span> </span><span class="hs-comment">{- (a) -}</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062280"><span class="hs-identifier hs-var">inst_head_tvs</span></a></span><span> </span><span class="hs-comment">{- (b) -}</span><span>
</span><span id="line-730"></span><span>             </span><span id="local-6989586621683062281"><span class="annot"><a href="#local-6989586621683062281"><span class="hs-identifier hs-var hs-var">all_nms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs () GhcRn -&gt; [Name]
forall flag. HsOuterTyVarBndrs flag GhcRn -&gt; [Name]
</span><a href="GHC.Hs.Type.html#hsOuterTyVarNames"><span class="hs-identifier hs-var">hsOuterTyVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs () GhcRn
</span><a href="#local-6989586621683062270"><span class="hs-identifier hs-var">rn_outer_bndrs'</span></a></span><span>
</span><span id="line-731"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#warnUnusedTypePatterns"><span class="hs-identifier hs-type">warnUnusedTypePatterns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062281"><span class="hs-identifier hs-type">all_nms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062278"><span class="hs-identifier hs-type">nms_used</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span>         </span><span class="hs-comment">-- For associated family instances, if a type variable from the</span><span>
</span><span id="line-734"></span><span>         </span><span class="hs-comment">-- parent instance declaration is mentioned on the RHS of the</span><span>
</span><span id="line-735"></span><span>         </span><span class="hs-comment">-- associated family instance but not bound on the LHS, then reject</span><span>
</span><span id="line-736"></span><span>         </span><span class="hs-comment">-- that type variable as being out of scope.</span><span>
</span><span id="line-737"></span><span>         </span><span class="hs-comment">-- See Note [Renaming associated types].</span><span>
</span><span id="line-738"></span><span>         </span><span class="hs-comment">-- Per that Note, the LHS type variables consist of the variables</span><span>
</span><span id="line-739"></span><span>         </span><span class="hs-comment">-- mentioned in the instance's type patterns (pat_fvs)</span><span>
</span><span id="line-740"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062283"><span class="annot"><a href="#local-6989586621683062283"><span class="hs-identifier hs-var hs-var">improperly_scoped</span></a></span></span><span> </span><span id="local-6989586621683062284"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062284"><span class="hs-identifier hs-var">cls_tkv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-741"></span><span>                  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062284"><span class="hs-identifier hs-var">cls_tkv</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062269"><span class="hs-identifier hs-var">rhs_fvs</span></a></span><span>
</span><span id="line-742"></span><span>                    </span><span class="hs-comment">-- Mentioned on the RHS...</span><span>
</span><span id="line-743"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062284"><span class="hs-identifier hs-var">cls_tkv</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062265"><span class="hs-identifier hs-var">pat_fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>                    </span><span class="hs-comment">-- ...but not bound on the LHS.</span><span>
</span><span id="line-745"></span><span>             </span><span id="local-6989586621683062287"><span class="annot"><a href="#local-6989586621683062287"><span class="hs-identifier hs-var hs-var">bad_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621683062283"><span class="hs-identifier hs-var">improperly_scoped</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062280"><span class="hs-identifier hs-var">inst_head_tvs</span></a></span><span>
</span><span id="line-746"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062287"><span class="hs-identifier hs-type">bad_tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062288"><span class="annot"><span class="annottext">NonEmpty Name
</span><a href="#local-6989586621683062288"><span class="hs-identifier hs-var">ne_bad_tvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-747"></span><span>           </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-748"></span><span>           </span><span class="annot"><span class="annottext">IllegalInstanceReason -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalInstance"><span class="hs-identifier hs-var">TcRnIllegalInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(IllegalInstanceReason -&gt; TcRnMessage)
-&gt; IllegalInstanceReason -&gt; TcRnMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IllegalFamilyInstanceReason -&gt; IllegalInstanceReason
</span><a href="GHC.Tc.Errors.Types.html#IllegalFamilyInstance"><span class="hs-identifier hs-var">IllegalFamilyInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(IllegalFamilyInstanceReason -&gt; IllegalInstanceReason)
-&gt; IllegalFamilyInstanceReason -&gt; IllegalInstanceReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-749"></span><span>             </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type], TyVarSet)
-&gt; NonEmpty Name -&gt; IllegalFamilyInstanceReason
</span><a href="GHC.Tc.Errors.Types.html#FamInstRHSOutOfScopeTyVars"><span class="hs-identifier hs-var">FamInstRHSOutOfScopeTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type], TyVarSet)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Name
</span><a href="#local-6989586621683062288"><span class="hs-identifier hs-var">ne_bad_tvs</span></a></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062291"><span class="annot"><a href="#local-6989586621683062291"><span class="hs-identifier hs-var hs-var">eqn_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062269"><span class="hs-identifier hs-var">rhs_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062265"><span class="hs-identifier hs-var">pat_fvs</span></a></span><span>
</span><span id="line-752"></span><span>             </span><span class="hs-comment">-- See Note [Type family equations and occurrences]</span><span>
</span><span id="line-753"></span><span>             </span><span id="local-6989586621683062292"><span class="annot"><a href="#local-6989586621683062292"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062243"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-754"></span><span>                         </span><span class="annot"><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-type">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><a href="GHC.Rename.Module.html#ClosedTyFam"><span class="hs-identifier hs-var">ClosedTyFam</span></a></span><span>
</span><span id="line-755"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062291"><span class="hs-identifier hs-var">eqn_fvs</span></a></span><span>
</span><span id="line-756"></span><span>                         </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062291"><span class="hs-identifier hs-var">eqn_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#addOneFV"><span class="hs-operator hs-var">`addOneFV`</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683062256"><span class="hs-identifier hs-var">tycon'</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_ext"><span class="hs-identifier hs-var">feqn_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-type">noAnn</span></a></span><span>
</span><span id="line-759"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_tycon"><span class="hs-identifier hs-var">feqn_tycon</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062256"><span class="hs-identifier hs-type">tycon'</span></a></span><span>
</span><span id="line-760"></span><span>                          </span><span class="hs-comment">-- Note [Wildcards in family instances]</span><span>
</span><span id="line-761"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_bndrs"><span class="hs-identifier hs-var">feqn_bndrs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062270"><span class="hs-identifier hs-type">rn_outer_bndrs'</span></a></span><span>
</span><span id="line-762"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_pats"><span class="hs-identifier hs-var">feqn_pats</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062264"><span class="hs-identifier hs-type">pats'</span></a></span><span>
</span><span id="line-763"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_fixity"><span class="hs-identifier hs-var">feqn_fixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062252"><span class="hs-identifier hs-type">fixity</span></a></span><span>
</span><span id="line-764"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#feqn_rhs"><span class="hs-identifier hs-var">feqn_rhs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062268"><span class="hs-identifier hs-type">payload'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-765"></span><span>                 </span><span class="annot"><a href="#local-6989586621683062292"><span class="hs-identifier hs-type">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-767"></span><span>    </span><span class="hs-comment">-- The parent class, if we are dealing with an associated type family</span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-769"></span><span>    </span><span id="local-6989586621683062258"><span class="annot"><span class="annottext">mb_cls :: Maybe Name
</span><a href="#local-6989586621683062258"><span class="hs-identifier hs-var hs-var">mb_cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062243"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-770"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-type">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-771"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamDeflt"><span class="hs-identifier hs-type">AssocTyFamDeflt</span></a></span><span> </span><span id="local-6989586621683062296"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062296"><span class="hs-identifier hs-var">cls</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062296"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-772"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInst"><span class="hs-identifier hs-type">AssocTyFamInst</span></a></span><span> </span><span id="local-6989586621683062298"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062298"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062298"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span>    </span><span class="hs-comment">-- The type variables from the instance head, if we are dealing with an</span><span>
</span><span id="line-775"></span><span>    </span><span class="hs-comment">-- associated type family instance.</span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621683062280"><span class="annot"><span class="annottext">inst_head_tvs :: [Name]
</span><a href="#local-6989586621683062280"><span class="hs-identifier hs-var hs-var">inst_head_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062243"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-777"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-type">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamDeflt"><span class="hs-identifier hs-type">AssocTyFamDeflt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-779"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInst"><span class="hs-identifier hs-type">AssocTyFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062299"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062299"><span class="hs-identifier hs-var">inst_head_tvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062299"><span class="hs-identifier hs-var">inst_head_tvs</span></a></span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621683062261"><span class="annot"><span class="annottext">pat_kity_vars :: FreeKiTyVars
</span><a href="#local-6989586621683062261"><span class="hs-identifier hs-var hs-var">pat_kity_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsFamEqnPats GhcPs -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractHsTyArgRdrKiTyVars"><span class="hs-identifier hs-var">extractHsTyArgRdrKiTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsFamEqnPats GhcPs
</span><a href="#local-6989586621683062250"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-782"></span><span>             </span><span class="hs-comment">-- It is crucial that extractHsTyArgRdrKiTyVars return</span><span>
</span><span id="line-783"></span><span>             </span><span class="hs-comment">-- duplicate occurrences, since they're needed to help</span><span>
</span><span id="line-784"></span><span>             </span><span class="hs-comment">-- determine unused binders on the LHS.</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span>    </span><span class="hs-comment">-- The SrcSpan of the LHS of the instance. For example, lhs_loc would be</span><span>
</span><span id="line-787"></span><span>    </span><span class="hs-comment">-- the highlighted part in the example below:</span><span>
</span><span id="line-788"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-789"></span><span>    </span><span class="hs-comment">--   type instance F a b c = Either a b</span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-comment">--                   ^^^^^</span><span>
</span><span id="line-791"></span><span>    </span><span id="local-6989586621683062273"><span class="annot"><span class="annottext">lhs_loc :: SrcSpan
</span><a href="#local-6989586621683062273"><span class="hs-identifier hs-var hs-var">lhs_loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(HsArg
   GhcPs
   (GenLocated SrcSpanAnnA (HsType GhcPs))
   (GenLocated SrcSpanAnnA (HsType GhcPs))
 -&gt; SrcSpan)
-&gt; [HsArg
      GhcPs
      (GenLocated SrcSpanAnnA (HsType GhcPs))
      (GenLocated SrcSpanAnnA (HsType GhcPs))]
-&gt; [SrcSpan]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LHsTypeArg GhcPs -&gt; SrcSpan
HsArg
  GhcPs
  (GenLocated SrcSpanAnnA (HsType GhcPs))
  (GenLocated SrcSpanAnnA (HsType GhcPs))
-&gt; SrcSpan
</span><a href="GHC.Hs.Type.html#lhsTypeArgSrcSpan"><span class="hs-identifier hs-var">lhsTypeArgSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">HsFamEqnPats GhcPs
[HsArg
   GhcPs
   (GenLocated SrcSpanAnnA (HsType GhcPs))
   (GenLocated SrcSpanAnnA (HsType GhcPs))]
</span><a href="#local-6989586621683062250"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-792"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SrcSpan
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rnFamEqn.lhs_loc&quot;</span></span><span>
</span><span id="line-793"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621683062303"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062303"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062303"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621683062304"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062304"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683062305"><span class="annot"><span class="annottext">[SrcSpan]
</span><a href="#local-6989586621683062305"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683062304"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpan -&gt; SrcSpan
</span><a href="GHC.Types.SrcLoc.html#combineSrcSpans"><span class="hs-operator hs-var">`combineSrcSpans`</span></a></span><span> </span><span class="annot"><span class="annottext">[SrcSpan] -&gt; SrcSpan
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[SrcSpan]
</span><a href="#local-6989586621683062305"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyFamInstDecl"><span class="hs-identifier hs-type">rnTyFamInstDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-type">AssocTyFamInfo</span></a></span><span>
</span><span id="line-797"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstDecl"><span class="hs-identifier hs-type">TyFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-798"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstDecl"><span class="hs-identifier hs-type">TyFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span id="rnTyFamInstDecl"><span class="annot"><span class="annottext">rnTyFamInstDecl :: AssocTyFamInfo
-&gt; TyFamInstDecl GhcPs -&gt; RnM (TyFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstDecl"><span class="hs-identifier hs-var hs-var">rnTyFamInstDecl</span></a></span></span><span> </span><span id="local-6989586621683062308"><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062308"><span class="hs-identifier hs-var">atfi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstDecl"><span class="hs-identifier hs-type">TyFamInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tfid_xtn :: forall pass. TyFamInstDecl pass -&gt; XCTyFamInstDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#tfid_xtn"><span class="hs-identifier hs-var">tfid_xtn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062311"><span class="annot"><span class="annottext">XCTyFamInstDecl GhcPs
</span><a href="#local-6989586621683062311"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tfid_eqn :: forall pass. TyFamInstDecl pass -&gt; TyFamInstEqn pass
</span><a href="Language.Haskell.Syntax.Decls.html#tfid_eqn"><span class="hs-identifier hs-var">tfid_eqn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062313"><span class="annot"><span class="annottext">TyFamInstEqn GhcPs
</span><a href="#local-6989586621683062313"><span class="hs-identifier hs-var">eqn</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062314"><span class="annot"><a href="#local-6989586621683062314"><span class="hs-identifier hs-var">eqn'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062315"><span class="annot"><a href="#local-6989586621683062315"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
-&gt; TyFamInstEqn GhcPs -&gt; RnM (TyFamInstEqn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstEqn"><span class="hs-identifier hs-var">rnTyFamInstEqn</span></a></span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062308"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="annot"><span class="annottext">TyFamInstEqn GhcPs
</span><a href="#local-6989586621683062313"><span class="hs-identifier hs-var">eqn</span></a></span><span>
</span><span id="line-801"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstDecl"><span class="hs-identifier hs-type">TyFamInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tfid_xtn"><span class="hs-identifier hs-var">tfid_xtn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062311"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tfid_eqn"><span class="hs-identifier hs-var">tfid_eqn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062314"><span class="hs-identifier hs-type">eqn'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062315"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="hs-comment">-- | Tracks whether we are renaming:</span><span>
</span><span id="line-804"></span><span class="hs-comment">--</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- 1. A type family equation that is not associated</span><span>
</span><span id="line-806"></span><span class="hs-comment">--    with a parent type class ('NonAssocTyFamEqn'). Examples:</span><span>
</span><span id="line-807"></span><span class="hs-comment">--</span><span>
</span><span id="line-808"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-809"></span><span class="hs-comment">--    type family F a</span><span>
</span><span id="line-810"></span><span class="hs-comment">--    type instance F Int = Bool  -- NonAssocTyFamEqn NotClosed</span><span>
</span><span id="line-811"></span><span class="hs-comment">--</span><span>
</span><span id="line-812"></span><span class="hs-comment">--    type family G a where</span><span>
</span><span id="line-813"></span><span class="hs-comment">--       G Int = Bool             -- NonAssocTyFamEqn Closed</span><span>
</span><span id="line-814"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-815"></span><span class="hs-comment">--</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- 2. An associated type family default declaration ('AssocTyFamDeflt').</span><span>
</span><span id="line-817"></span><span class="hs-comment">--    Example:</span><span>
</span><span id="line-818"></span><span class="hs-comment">--</span><span>
</span><span id="line-819"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-820"></span><span class="hs-comment">--    class C a where</span><span>
</span><span id="line-821"></span><span class="hs-comment">--      type A a</span><span>
</span><span id="line-822"></span><span class="hs-comment">--      type instance A a = a -&gt; a  -- AssocTyFamDeflt C</span><span>
</span><span id="line-823"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-824"></span><span class="hs-comment">--</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- 3. An associated type family instance declaration ('AssocTyFamInst').</span><span>
</span><span id="line-826"></span><span class="hs-comment">--    Example:</span><span>
</span><span id="line-827"></span><span class="hs-comment">--</span><span>
</span><span id="line-828"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-829"></span><span class="hs-comment">--    instance C a =&gt; C [a] where</span><span>
</span><span id="line-830"></span><span class="hs-comment">--      type A [a] = Bool  -- AssocTyFamInst C [a]</span><span>
</span><span id="line-831"></span><span class="hs-comment">--    @</span><span>
</span><span id="line-832"></span><span class="hs-keyword">data</span><span> </span><span id="AssocTyFamInfo"><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-var">AssocTyFamInfo</span></a></span></span><span>
</span><span id="line-833"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NonAssocTyFamEqn"><span class="annot"><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-var">NonAssocTyFamEqn</span></a></span></span><span>
</span><span id="line-834"></span><span>      </span><span class="annot"><a href="GHC.Rename.Module.html#ClosedTyFamInfo"><span class="hs-identifier hs-type">ClosedTyFamInfo</span></a></span><span> </span><span class="hs-comment">-- Is this a closed type family?</span><span>
</span><span id="line-835"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AssocTyFamDeflt"><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamDeflt"><span class="hs-identifier hs-var">AssocTyFamDeflt</span></a></span></span><span>
</span><span id="line-836"></span><span>      </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>            </span><span class="hs-comment">-- Name of the parent class</span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AssocTyFamInst"><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInst"><span class="hs-identifier hs-var">AssocTyFamInst</span></a></span></span><span>
</span><span id="line-838"></span><span>      </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>            </span><span class="hs-comment">-- Name of the parent class</span><span>
</span><span id="line-839"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- Names of the tyvars of the parent instance decl</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span class="hs-comment">-- | Tracks whether we are renaming an equation in a closed type family</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- equation ('ClosedTyFam') or not ('NotClosedTyFam').</span><span>
</span><span id="line-843"></span><span class="hs-keyword">data</span><span> </span><span id="ClosedTyFamInfo"><span class="annot"><a href="GHC.Rename.Module.html#ClosedTyFamInfo"><span class="hs-identifier hs-var">ClosedTyFamInfo</span></a></span></span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NotClosedTyFam"><span class="annot"><a href="GHC.Rename.Module.html#NotClosedTyFam"><span class="hs-identifier hs-var">NotClosedTyFam</span></a></span></span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ClosedTyFam"><span class="annot"><a href="GHC.Rename.Module.html#ClosedTyFam"><span class="hs-identifier hs-var">ClosedTyFam</span></a></span></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyFamInstEqn"><span class="hs-identifier hs-type">rnTyFamInstEqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-type">AssocTyFamInfo</span></a></span><span>
</span><span id="line-848"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstEqn"><span class="hs-identifier hs-type">TyFamInstEqn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-849"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstEqn"><span class="hs-identifier hs-type">TyFamInstEqn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span id="rnTyFamInstEqn"><span class="annot"><span class="annottext">rnTyFamInstEqn :: AssocTyFamInfo
-&gt; TyFamInstEqn GhcPs -&gt; RnM (TyFamInstEqn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstEqn"><span class="hs-identifier hs-var hs-var">rnTyFamInstEqn</span></a></span></span><span> </span><span id="local-6989586621683062317"><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062317"><span class="hs-identifier hs-var">atfi</span></a></span></span><span> </span><span id="local-6989586621683062318"><span class="annot"><span class="annottext">eqn :: TyFamInstEqn GhcPs
</span><a href="#local-6989586621683062318"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">feqn_tycon :: forall pass rhs. FamEqn pass rhs -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_tycon"><span class="hs-identifier hs-var">feqn_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062319"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062319"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; AssocTyFamInfo
-&gt; FamEqn GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))
-&gt; (HsDocContext
    -&gt; GenLocated SrcSpanAnnA (HsType GhcPs)
    -&gt; RnM (GenLocated SrcSpanAnnA (HsType GhcRn), FreeVars))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (FamEqn GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars)
forall rhs rhs'.
HsDocContext
-&gt; AssocTyFamInfo
-&gt; FamEqn GhcPs rhs
-&gt; (HsDocContext -&gt; rhs -&gt; RnM (rhs', FreeVars))
-&gt; RnM (FamEqn GhcRn rhs', FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamEqn"><span class="hs-identifier hs-var">rnFamEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#TySynCtx"><span class="hs-identifier hs-var">TySynCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062319"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062317"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="annot"><span class="annottext">TyFamInstEqn GhcPs
FamEqn GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))
</span><a href="#local-6989586621683062318"><span class="hs-identifier hs-var">eqn</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
HsDocContext
-&gt; GenLocated SrcSpanAnnA (HsType GhcPs)
-&gt; RnM (GenLocated SrcSpanAnnA (HsType GhcRn), FreeVars)
</span><a href="GHC.Rename.Module.html#rnTySyn"><span class="hs-identifier hs-var">rnTySyn</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyFamDefltDecl"><span class="hs-identifier hs-type">rnTyFamDefltDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-855"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamDefltDecl"><span class="hs-identifier hs-type">TyFamDefltDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-856"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamDefltDecl"><span class="hs-identifier hs-type">TyFamDefltDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span id="rnTyFamDefltDecl"><span class="annot"><span class="annottext">rnTyFamDefltDecl :: Name -&gt; TyFamInstDecl GhcPs -&gt; RnM (TyFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamDefltDecl"><span class="hs-identifier hs-var hs-var">rnTyFamDefltDecl</span></a></span></span><span> </span><span id="local-6989586621683062324"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062324"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
-&gt; TyFamInstDecl GhcPs -&gt; RnM (TyFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstDecl"><span class="hs-identifier hs-var">rnTyFamInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; AssocTyFamInfo
</span><a href="GHC.Rename.Module.html#AssocTyFamDeflt"><span class="hs-identifier hs-var">AssocTyFamDeflt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062324"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="annot"><a href="GHC.Rename.Module.html#rnDataFamInstDecl"><span class="hs-identifier hs-type">rnDataFamInstDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-type">AssocTyFamInfo</span></a></span><span>
</span><span id="line-860"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-861"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span id="rnDataFamInstDecl"><span class="annot"><span class="annottext">rnDataFamInstDecl :: AssocTyFamInfo
-&gt; DataFamInstDecl GhcPs -&gt; RnM (DataFamInstDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDataFamInstDecl"><span class="hs-identifier hs-var hs-var">rnDataFamInstDecl</span></a></span></span><span> </span><span id="local-6989586621683062325"><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062325"><span class="hs-identifier hs-var">atfi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dfid_eqn :: forall pass. DataFamInstDecl pass -&gt; FamEqn pass (HsDataDefn pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dfid_eqn"><span class="hs-identifier hs-var">dfid_eqn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-863"></span><span>                    </span><span id="local-6989586621683062328"><span class="annot"><span class="annottext">eqn :: FamEqn GhcPs (HsDataDefn GhcPs)
</span><a href="#local-6989586621683062328"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamEqn"><span class="hs-identifier hs-type">FamEqn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">feqn_tycon :: forall pass rhs. FamEqn pass rhs -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_tycon"><span class="hs-identifier hs-var">feqn_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062329"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062329"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062330"><span class="annot"><a href="#local-6989586621683062330"><span class="hs-identifier hs-var">eqn'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062331"><span class="annot"><a href="#local-6989586621683062331"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-865"></span><span>           </span><span class="annot"><span class="annottext">HsDocContext
-&gt; AssocTyFamInfo
-&gt; FamEqn GhcPs (HsDataDefn GhcPs)
-&gt; (HsDocContext
    -&gt; HsDataDefn GhcPs -&gt; RnM (HsDataDefn GhcRn, FreeVars))
-&gt; RnM (FamEqn GhcRn (HsDataDefn GhcRn), FreeVars)
forall rhs rhs'.
HsDocContext
-&gt; AssocTyFamInfo
-&gt; FamEqn GhcPs rhs
-&gt; (HsDocContext -&gt; rhs -&gt; RnM (rhs', FreeVars))
-&gt; RnM (FamEqn GhcRn rhs', FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamEqn"><span class="hs-identifier hs-var">rnFamEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#TyDataCtx"><span class="hs-identifier hs-var">TyDataCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062329"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AssocTyFamInfo
</span><a href="#local-6989586621683062325"><span class="hs-identifier hs-var">atfi</span></a></span><span> </span><span class="annot"><span class="annottext">FamEqn GhcPs (HsDataDefn GhcPs)
</span><a href="#local-6989586621683062328"><span class="hs-identifier hs-var">eqn</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsDataDefn GhcPs -&gt; RnM (HsDataDefn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDataDefn"><span class="hs-identifier hs-var">rnDataDefn</span></a></span><span>
</span><span id="line-866"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dfid_eqn"><span class="hs-identifier hs-var">dfid_eqn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062330"><span class="hs-identifier hs-type">eqn'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062331"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-comment">-- Renaming of the associated types in instances.</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-comment">-- Rename associated type family decl in class</span><span>
</span><span id="line-871"></span><span class="annot"><a href="GHC.Rename.Module.html#rnATDecls"><span class="hs-identifier hs-type">rnATDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>      </span><span class="hs-comment">-- Class</span><span>
</span><span id="line-872"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Class variables. See Note [Class variables and filterInScope] in GHC.Rename.HsType</span><span>
</span><span id="line-873"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LFamilyDecl"><span class="hs-identifier hs-type">LFamilyDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-874"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LFamilyDecl"><span class="hs-identifier hs-type">LFamilyDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span id="rnATDecls"><span class="annot"><span class="annottext">rnATDecls :: Name
-&gt; [Name]
-&gt; [LFamilyDecl GhcPs]
-&gt; RnM ([LFamilyDecl GhcRn], FreeVars)
</span><a href="GHC.Rename.Module.html#rnATDecls"><span class="hs-identifier hs-var hs-var">rnATDecls</span></a></span></span><span> </span><span id="local-6989586621683062335"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062335"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621683062336"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062336"><span class="hs-identifier hs-var">cls_tvs</span></a></span></span><span> </span><span id="local-6989586621683062337"><span class="annot"><span class="annottext">[LFamilyDecl GhcPs]
</span><a href="#local-6989586621683062337"><span class="hs-identifier hs-var">at_decls</span></a></span></span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FamilyDecl GhcPs -&gt; RnM (FamilyDecl GhcRn, FreeVars))
-&gt; [LocatedA (FamilyDecl GhcPs)]
-&gt; RnM ([LocatedA (FamilyDecl GhcRn)], FreeVars)
forall a b.
(a -&gt; RnM (b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
</span><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-var">rnList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Name, [Name])
-&gt; FamilyDecl GhcPs -&gt; RnM (FamilyDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamDecl"><span class="hs-identifier hs-var">rnFamDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, [Name]) -&gt; Maybe (Name, [Name])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062335"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062336"><span class="hs-identifier hs-var">cls_tvs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LFamilyDecl GhcPs]
[LocatedA (FamilyDecl GhcPs)]
</span><a href="#local-6989586621683062337"><span class="hs-identifier hs-var">at_decls</span></a></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span id="local-6989586621683060656"><span class="annot"><a href="GHC.Rename.Module.html#rnATInstDecls"><span class="hs-identifier hs-type">rnATInstDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#AssocTyFamInfo"><span class="hs-identifier hs-type">AssocTyFamInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>           </span><span class="hs-comment">-- The function that renames</span><span>
</span><span id="line-879"></span><span>                  </span><span class="annot"><a href="#local-6989586621683060656"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>               </span><span class="hs-comment">-- an instance. rnTyFamInstDecl</span><span>
</span><span id="line-880"></span><span>                  </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060656"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- or rnDataFamInstDecl</span><span>
</span><span id="line-881"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>      </span><span class="hs-comment">-- Class</span><span>
</span><span id="line-882"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-883"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060656"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-884"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060656"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-885"></span><span class="hs-comment">-- Used for data and type family defaults in a class decl</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- and the family instance declarations in an instance</span><span>
</span><span id="line-887"></span><span class="hs-comment">--</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- NB: We allow duplicate associated-type decls;</span><span>
</span><span id="line-889"></span><span class="hs-comment">--     See Note [Associated type instances] in GHC.Tc.TyCl.Instance</span><span>
</span><span id="line-890"></span><span id="rnATInstDecls"><span class="annot"><span class="annottext">rnATInstDecls :: forall (decl :: * -&gt; *).
(AssocTyFamInfo -&gt; decl GhcPs -&gt; RnM (decl GhcRn, FreeVars))
-&gt; Name
-&gt; [Name]
-&gt; [LocatedA (decl GhcPs)]
-&gt; RnM ([LocatedA (decl GhcRn)], FreeVars)
</span><a href="GHC.Rename.Module.html#rnATInstDecls"><span class="hs-identifier hs-var hs-var">rnATInstDecls</span></a></span></span><span> </span><span id="local-6989586621683062339"><span class="annot"><span class="annottext">AssocTyFamInfo -&gt; decl GhcPs -&gt; RnM (decl GhcRn, FreeVars)
</span><a href="#local-6989586621683062339"><span class="hs-identifier hs-var">rnFun</span></a></span></span><span> </span><span id="local-6989586621683062340"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062340"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621683062341"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062341"><span class="hs-identifier hs-var">tv_ns</span></a></span></span><span> </span><span id="local-6989586621683062342"><span class="annot"><span class="annottext">[LocatedA (decl GhcPs)]
</span><a href="#local-6989586621683062342"><span class="hs-identifier hs-var">at_insts</span></a></span></span><span>
</span><span id="line-891"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(decl GhcPs -&gt; RnM (decl GhcRn, FreeVars))
-&gt; [LocatedA (decl GhcPs)]
-&gt; RnM ([LocatedA (decl GhcRn)], FreeVars)
forall a b.
(a -&gt; RnM (b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
</span><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-var">rnList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssocTyFamInfo -&gt; decl GhcPs -&gt; RnM (decl GhcRn, FreeVars)
</span><a href="#local-6989586621683062339"><span class="hs-identifier hs-var">rnFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; AssocTyFamInfo
</span><a href="GHC.Rename.Module.html#AssocTyFamInst"><span class="hs-identifier hs-var">AssocTyFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062340"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062341"><span class="hs-identifier hs-var">tv_ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedA (decl GhcPs)]
</span><a href="#local-6989586621683062342"><span class="hs-identifier hs-var">at_insts</span></a></span><span>
</span><span id="line-892"></span><span>    </span><span class="hs-comment">-- See Note [Renaming associated types]</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-comment">{- Note [Wildcards in family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Wild cards can be used in type/data family instance declarations to indicate
that the name of a type variable doesn't matter. Each wild card will be
replaced with a new unique type variable. For instance:

    type family F a b :: *
    type instance F Int _ = Int

is the same as

    type family F a b :: *
    type instance F Int b = Int

This is implemented as follows: Unnamed wildcards remain unchanged after
the renamer, and then given fresh meta-variables during typechecking, and
it is handled pretty much the same way as the ones in partial type signatures.
We however don't want to emit hole constraints on wildcards in family
instances, so we turn on PartialTypeSignatures and turn off warning flag to
let typechecker know this.
See related Note [Wildcards in visible kind application] in GHC.Tc.Gen.HsType

Note [Unused type variables in family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When the flag -fwarn-unused-type-patterns is on, the compiler reports
warnings about unused type variables in type-family instances. A
tpye variable is considered used (i.e. cannot be turned into a wildcard)
when

 * it occurs on the RHS of the family instance
   e.g.   type instance F a b = a    -- a is used on the RHS

 * it occurs multiple times in the patterns on the LHS
   e.g.   type instance F a a = Int  -- a appears more than once on LHS

 * it is one of the instance-decl variables, for associated types
   e.g.   instance C (a,b) where
            type T (a,b) = a
   Here the type pattern in the type instance must be the same as that
   for the class instance, so
            type T (a,_) = a
   would be rejected.  So we should not complain about an unused variable b

As usual, the warnings are not reported for type variables with names
beginning with an underscore.

Extra-constraints wild cards are not supported in type/data family
instance declarations.

Relevant tickets: #3699, #10586, #10982 and #11451.

Note [Renaming associated types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When renaming a type/data family instance, be it top-level or associated with
a class, we must check that all of the type variables mentioned on the RHS are
properly scoped. Specifically, the rule is this:

  Every variable mentioned on the RHS of a type instance declaration
  (whether associated or not) must be mentioned on the LHS

Here is a simple example of something we should reject:

  class C a b where
    type F a x
  instance C Int Bool where
    type F Int x = z

Here, `z` is mentioned on the RHS of the associated instance without being
mentioned on the LHS. The renamer will reject `z` as being out of scope without much fuss.

Things get slightly trickier when the instance header itself binds type
variables. Consider this example (adapted from #5515):

   instance C (p,q) z where
      type F (p,q) x = (x, z)

According to the rule above, this instance is improperly scoped. However, due
to the way GHC's renamer works, `z` is /technically/ in scope, as GHC will
always bring type variables from an instance header into scope over the
associated type family instances. As a result, the renamer won't simply reject
the `z` as being out of scope (like it would for the `type F Int x = z`
example) unless further action is taken. It is important to reject this sort of
thing in the renamer, because if it is allowed to make it through to the
typechecker, unexpected shenanigans can occur (see #18021 for examples).

To prevent these sorts of shenanigans, we reject programs like the one above
with an extra validity check in rnFamEqn. For each type variable bound in the
parent instance head, we check if it is mentioned on the RHS of the associated
family instance but not bound on the LHS. If any of the instance-head-bound
variables meet these criteria, we throw an error.
(See rnFamEqn.improperly_scoped for how this is implemented.)

Some additional wrinkles:

* This Note only applies to *instance* declarations.  In *class* declarations
  there is no RHS to worry about, and the class variables can all be in scope
  (#5862):

    class Category (x :: k -&gt; k -&gt; *) where
      type Ob x :: k -&gt; Constraint
      id :: Ob x a =&gt; x a a
      (.) :: (Ob x a, Ob x b, Ob x c) =&gt; x b c -&gt; x a b -&gt; x a c

  Here 'k' is in scope in the kind signature, just like 'x'.

* Although type family equations can bind type variables with explicit foralls,
  it need not be the case that all variables that appear on the RHS must be
  bound by a forall. For instance, the following is acceptable:

    class C4 a where
      type T4 a b
    instance C4 (Maybe a) where
      type forall b. T4 (Maybe a) b = Either a b

  Even though `a` is not bound by the forall, this is still accepted because `a`
  was previously bound by the `instance C4 (Maybe a)` part. (see #16116).

* In addition to the validity check in rnFamEqn.improperly_scoped, there is an
  additional check in GHC.Tc.Validity.checkFamPatBinders that checks each family
  instance equation for type variables used on the RHS but not bound on the
  LHS. This is not made redundant by rmFamEqn.improperly_scoped, as there are
  programs that each check will reject that the other check will not catch:

  - checkValidFamPats is used on all forms of family instances, whereas
    rmFamEqn.improperly_scoped only checks associated family instances. Since
    checkFamPatBinders occurs after typechecking, it can catch programs that
    introduce dodgy scoping by way of type synonyms (see #7536), which is
    impractical to accomplish in the renamer.
  - rnFamEqn.improperly_scoped catches some programs that, if allowed to escape
    the renamer, would accidentally be accepted by the typechecker. Here is one
    such program (#18021):

      class C5 a where
        data family D a

      instance forall a. C5 Int where
        data instance D Int = MkD a

    If this is not rejected in the renamer, the typechecker would treat this
    program as though the `a` were existentially quantified, like so:

      data instance D Int = forall a. MkD a

    This is likely not what the user intended!

    Here is another such program (#9574):

      class Funct f where
        type Codomain f
      instance Funct ('KProxy :: KProxy o) where
        type Codomain 'KProxy = NatTr (Proxy :: o -&gt; Type)

    Where:

      data Proxy (a :: k) = Proxy
      data KProxy (t :: Type) = KProxy
      data NatTr (c :: o -&gt; Type)

    Note that the `o` in the `Codomain 'KProxy` instance should be considered
    improperly scoped. It does not meet the criteria for being explicitly
    quantified, as it is not mentioned by name on the LHS.
    However, `o` /is/ bound by the instance header, so if this
    program is not rejected by the renamer, the typechecker would treat it as
    though you had written this:

      instance Funct ('KProxy :: KProxy o) where
        type Codomain ('KProxy @o) = NatTr (Proxy :: o -&gt; Type)

    Although this is a valid program, it's probably a stretch too far to turn
    `type Codomain 'KProxy = ...` into `type Codomain ('KProxy @o) = ...` here.
    If the user really wants the latter, it is simple enough to communicate
    their intent by mentioning `o` on the LHS by name.

* Historical note: Previously we had to add type variables from the outermost
  kind signature on the RHS to the scope of associated type family instance,
  i.e. GHC did implicit quantification over them. But now that we implement
  GHC Proposal #425 &quot;Invisible binders in type declarations&quot;
  we don't need to do this anymore.

Note [Type family equations and occurrences]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In most data/type family equations, the type family name used in the equation
is treated as an occurrence. For example:

  module A where
    type family F a

  module B () where
    import B (F)
    type instance F Int = Bool

We do not want to warn about `F` being unused in the module `B`, as the
instance constitutes a use site for `F`. The exception to this rule is closed
type families, whose equations constitute a definition, not occurrences. For
example:

  module C () where
    type family CF a where
      CF Char = Float

Here, we /do/ want to warn that `CF` is unused in the module `C`, as it is
defined but not used (#18470).

GHC accomplishes this in rnFamEqn when determining the set of free
variables to return at the end. If renaming a data family or open type family
equation, we add the name of the type family constructor to the set of returned
free variables to ensure that the name is marked as an occurrence. If renaming
a closed type family equation, we avoid adding the type family constructor name
to the free variables. This is quite simple, but it is not a perfect solution.
Consider this example:

  module X () where
    type family F a where
      F Int = Bool
      F Double = F Int

At present, GHC will treat any use of a type family constructor on the RHS of a
type family equation as an occurrence. Since `F` is used on the RHS of the
second equation of `F`, it is treated as an occurrence, causing `F` not to be
warned about. This is not ideal, since `F` isn't exported&#8212;it really /should/
cause a warning to be emitted. There is some discussion in #10089/#12920 about
how this limitation might be overcome, but until then, we stick to the
simplistic solution above, as it fixes the egregious bug in #18470.
-}</span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Stand-alone deriving declarations}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcDerivDecl"><span class="hs-identifier hs-type">rnSrcDerivDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivDecl"><span class="hs-identifier hs-type">DerivDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivDecl"><span class="hs-identifier hs-type">DerivDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1129"></span><span id="rnSrcDerivDecl"><span class="annot"><span class="annottext">rnSrcDerivDecl :: DerivDecl GhcPs -&gt; RnM (DerivDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnSrcDerivDecl"><span class="hs-identifier hs-var hs-var">rnSrcDerivDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivDecl"><span class="hs-identifier hs-type">DerivDecl</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062344"><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683062344"><span class="hs-identifier hs-var">inst_warn_ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062345"><span class="annot"><span class="annottext">AnnDerivDecl
</span><a href="#local-6989586621683062345"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062346"><span class="annot"><span class="annottext">LHsSigWcType GhcPs
</span><a href="#local-6989586621683062346"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621683062347"><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><a href="#local-6989586621683062347"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621683062348"><span class="annot"><span class="annottext">Maybe (XRec GhcPs OverlapMode)
</span><a href="#local-6989586621683062348"><span class="hs-identifier hs-var">overlap</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062349"><span class="annot"><a href="#local-6989586621683062349"><span class="hs-identifier hs-var">standalone_deriv_ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.StandaloneDeriving</span></span><span>
</span><span id="line-1131"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="annot"><a href="#local-6989586621683062349"><span class="hs-identifier hs-type">standalone_deriv_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnUnexpectedStandaloneDerivingDecl"><span class="hs-identifier hs-type">TcRnUnexpectedStandaloneDerivingDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkInferredVars"><span class="hs-identifier hs-type">checkInferredVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062353"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062354"><span class="hs-identifier hs-type">nowc_ty</span></a></span><span>
</span><span id="line-1133"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062355"><span class="annot"><a href="#local-6989586621683062355"><span class="hs-identifier hs-var">mds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062356"><span class="annot"><a href="#local-6989586621683062356"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062357"><span class="annot"><a href="#local-6989586621683062357"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnLDerivStrategy"><span class="hs-identifier hs-type">rnLDerivStrategy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062353"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062347"><span class="hs-identifier hs-type">mds</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnHsSigWcType"><span class="hs-identifier hs-type">rnHsSigWcType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062353"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062346"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-1134"></span><span>         </span><span class="hs-comment">-- Check if there are any nested `forall`s or contexts, which are</span><span>
</span><span id="line-1135"></span><span>         </span><span class="hs-comment">-- illegal in the type of an instance declaration (see</span><span>
</span><span id="line-1136"></span><span>         </span><span class="hs-comment">-- Note [No nested foralls or contexts in instance types] in</span><span>
</span><span id="line-1137"></span><span>         </span><span class="hs-comment">-- GHC.Hs.Type).</span><span>
</span><span id="line-1138"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#addNoNestedForallsContextsErr"><span class="hs-identifier hs-type">addNoNestedForallsContextsErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062353"><span class="hs-identifier hs-type">ctxt</span></a></span><span>
</span><span id="line-1139"></span><span>           </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#NFC_StandaloneDerivedInstanceHead"><span class="hs-identifier hs-type">NFC_StandaloneDerivedInstanceHead</span></a></span><span>
</span><span id="line-1140"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Type.html#getLHsInstDeclHead"><span class="hs-identifier hs-type">getLHsInstDeclHead</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Hs.Type.html#dropWildCards"><span class="hs-identifier hs-type">dropWildCards</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062356"><span class="hs-identifier hs-type">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062363"><span class="annot"><a href="#local-6989586621683062363"><span class="hs-identifier hs-var">inst_warn_rn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier hs-type">rnLWarningTxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062344"><span class="hs-identifier hs-type">inst_warn_ps</span></a></span><span>
</span><span id="line-1142"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivDecl"><span class="hs-identifier hs-type">DerivDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062363"><span class="hs-identifier hs-type">inst_warn_rn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062345"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062356"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062355"><span class="hs-identifier hs-type">mds'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062348"><span class="hs-identifier hs-type">overlap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062357"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1144"></span><span>    </span><span id="local-6989586621683062353"><span class="annot"><span class="annottext">ctxt :: HsDocContext
</span><a href="#local-6989586621683062353"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#DerivDeclCtx"><span class="hs-identifier hs-var">DerivDeclCtx</span></a></span><span>
</span><span id="line-1145"></span><span>    </span><span id="local-6989586621683062354"><span class="annot"><span class="annottext">nowc_ty :: LHsSigType GhcPs
</span><a href="#local-6989586621683062354"><span class="hs-identifier hs-var hs-var">nowc_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcPs -&gt; LHsSigType GhcPs
forall pass. LHsSigWcType pass -&gt; LHsSigType pass
</span><a href="GHC.Hs.Type.html#dropWildCards"><span class="hs-identifier hs-var">dropWildCards</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcPs
</span><a href="#local-6989586621683062346"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1146"></span><span>
</span><span id="line-1147"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Rules}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-1154"></span><span>
</span><span id="line-1155"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsRuleDecls"><span class="hs-identifier hs-type">rnHsRuleDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleDecls"><span class="hs-identifier hs-type">RuleDecls</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleDecls"><span class="hs-identifier hs-type">RuleDecls</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1156"></span><span id="rnHsRuleDecls"><span class="annot"><span class="annottext">rnHsRuleDecls :: RuleDecls GhcPs -&gt; RnM (RuleDecls GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnHsRuleDecls"><span class="hs-identifier hs-var hs-var">rnHsRuleDecls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsRules"><span class="hs-identifier hs-type">HsRules</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rds_ext :: forall pass. RuleDecls pass -&gt; XCRuleDecls pass
</span><a href="Language.Haskell.Syntax.Decls.html#rds_ext"><span class="hs-identifier hs-var">rds_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EpaLocation, EpToken &quot;#-}&quot;)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062367"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683062367"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rds_rules :: forall pass. RuleDecls pass -&gt; [LRuleDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#rds_rules"><span class="hs-identifier hs-var">rds_rules</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062369"><span class="annot"><span class="annottext">[LRuleDecl GhcPs]
</span><a href="#local-6989586621683062369"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1158"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062370"><span class="annot"><a href="#local-6989586621683062370"><span class="hs-identifier hs-var">rn_rules</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683062371"><span class="annot"><a href="#local-6989586621683062371"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(RuleDecl GhcPs -&gt; RnM (RuleDecl GhcRn, FreeVars))
-&gt; [LocatedA (RuleDecl GhcPs)]
-&gt; RnM ([LocatedA (RuleDecl GhcRn)], FreeVars)
forall a b.
(a -&gt; RnM (b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
</span><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-var">rnList</span></a></span><span> </span><span class="annot"><span class="annottext">RuleDecl GhcPs -&gt; RnM (RuleDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnHsRuleDecl"><span class="hs-identifier hs-var">rnHsRuleDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[LRuleDecl GhcPs]
[LocatedA (RuleDecl GhcPs)]
</span><a href="#local-6989586621683062369"><span class="hs-identifier hs-var">rules</span></a></span><span>
</span><span id="line-1159"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsRules"><span class="hs-identifier hs-type">HsRules</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rds_ext"><span class="hs-identifier hs-var">rds_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062367"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-1160"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rds_rules"><span class="hs-identifier hs-var">rds_rules</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062370"><span class="hs-identifier hs-type">rn_rules</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062371"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsRuleDecl"><span class="hs-identifier hs-type">rnHsRuleDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleDecl"><span class="hs-identifier hs-type">RuleDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span id="rnHsRuleDecl"><span class="annot"><span class="annottext">rnHsRuleDecl :: RuleDecl GhcPs -&gt; RnM (RuleDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnHsRuleDecl"><span class="hs-identifier hs-var hs-var">rnHsRuleDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsRule"><span class="hs-identifier hs-type">HsRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rd_ext :: forall pass. RuleDecl pass -&gt; XHsRule pass
</span><a href="Language.Haskell.Syntax.Decls.html#rd_ext"><span class="hs-identifier hs-var">rd_ext</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsRuleAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062375"><span class="annot"><span class="annottext">SourceText
</span><a href="#local-6989586621683062375"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_name :: forall pass. RuleDecl pass -&gt; XRec pass CLabelString
</span><a href="Language.Haskell.Syntax.Decls.html#rd_name"><span class="hs-identifier hs-var">rd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062377"><span class="annot"><span class="annottext">XRec GhcPs CLabelString
</span><a href="#local-6989586621683062377"><span class="hs-identifier hs-var">rule_name</span></a></span></span><span>
</span><span id="line-1165"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_act :: forall pass. RuleDecl pass -&gt; Activation
</span><a href="Language.Haskell.Syntax.Decls.html#rd_act"><span class="hs-identifier hs-var">rd_act</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062379"><span class="annot"><span class="annottext">Activation
</span><a href="#local-6989586621683062379"><span class="hs-identifier hs-var">act</span></a></span></span><span>
</span><span id="line-1166"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_tyvs :: forall pass.
RuleDecl pass -&gt; Maybe [LHsTyVarBndr () (NoGhcTc pass)]
</span><a href="Language.Haskell.Syntax.Decls.html#rd_tyvs"><span class="hs-identifier hs-var">rd_tyvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062381"><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () (NoGhcTc GhcPs)]
</span><a href="#local-6989586621683062381"><span class="hs-identifier hs-var">tyvs</span></a></span></span><span>
</span><span id="line-1167"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_tmvs :: forall pass. RuleDecl pass -&gt; [LRuleBndr pass]
</span><a href="Language.Haskell.Syntax.Decls.html#rd_tmvs"><span class="hs-identifier hs-var">rd_tmvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062383"><span class="annot"><span class="annottext">[LRuleBndr GhcPs]
</span><a href="#local-6989586621683062383"><span class="hs-identifier hs-var">tmvs</span></a></span></span><span>
</span><span id="line-1168"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_lhs :: forall pass. RuleDecl pass -&gt; XRec pass (HsExpr pass)
</span><a href="Language.Haskell.Syntax.Decls.html#rd_lhs"><span class="hs-identifier hs-var">rd_lhs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062385"><span class="annot"><span class="annottext">XRec GhcPs (HsExpr GhcPs)
</span><a href="#local-6989586621683062385"><span class="hs-identifier hs-var">lhs</span></a></span></span><span>
</span><span id="line-1169"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rd_rhs :: forall pass. RuleDecl pass -&gt; XRec pass (HsExpr pass)
</span><a href="Language.Haskell.Syntax.Decls.html#rd_rhs"><span class="hs-identifier hs-var">rd_rhs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062387"><span class="annot"><span class="annottext">XRec GhcPs (HsExpr GhcPs)
</span><a href="#local-6989586621683062387"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062388"><span class="annot"><span class="annottext">rdr_names_w_loc :: FreeKiTyVars
</span><a href="#local-6989586621683062388"><span class="hs-identifier hs-var hs-var hs-var">rdr_names_w_loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated EpAnnCO (RuleBndr GhcPs)
 -&gt; GenLocated SrcSpanAnnN RdrName)
-&gt; [GenLocated EpAnnCO (RuleBndr GhcPs)] -&gt; FreeKiTyVars
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleBndr GhcPs -&gt; GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062389"><span class="hs-identifier hs-var">get_var</span></a></span><span> </span><span class="annot"><span class="annottext">(RuleBndr GhcPs -&gt; GenLocated SrcSpanAnnN RdrName)
-&gt; (GenLocated EpAnnCO (RuleBndr GhcPs) -&gt; RuleBndr GhcPs)
-&gt; GenLocated EpAnnCO (RuleBndr GhcPs)
-&gt; GenLocated SrcSpanAnnN RdrName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated EpAnnCO (RuleBndr GhcPs) -&gt; RuleBndr GhcPs
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LRuleBndr GhcPs]
[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062383"><span class="hs-identifier hs-var">tmvs</span></a></span><span>
</span><span id="line-1171"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars -&gt; TcRn ()
</span><a href="GHC.Rename.Utils.html#checkDupRdrNames"><span class="hs-identifier hs-var">checkDupRdrNames</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062388"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a></span><span>
</span><span id="line-1172"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars -&gt; TcRn ()
</span><a href="GHC.Rename.Utils.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062388"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a></span><span>
</span><span id="line-1173"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062390"><span class="annot"><a href="#local-6989586621683062390"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars -&gt; IOEnv (Env TcGblEnv TcLclEnv) [Name]
</span><a href="GHC.Rename.Utils.html#newLocalBndrsRn"><span class="hs-identifier hs-var">newLocalBndrsRn</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062388"><span class="hs-identifier hs-var">rdr_names_w_loc</span></a></span><span>
</span><span id="line-1174"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062391"><span class="annot"><a href="#local-6989586621683062391"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CLabelString -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#RuleCtx"><span class="hs-identifier hs-var">RuleCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated EpAnnCO CLabelString -&gt; CLabelString
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs CLabelString
GenLocated EpAnnCO CLabelString
</span><a href="#local-6989586621683062377"><span class="hs-identifier hs-var">rule_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1175"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#bindRuleTyVars"><span class="hs-identifier hs-type">bindRuleTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062391"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062381"><span class="hs-identifier hs-type">tyvs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062394"><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn]
</span><a href="#local-6989586621683062394"><span class="hs-identifier hs-var">tyvs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1176"></span><span>         </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
-&gt; [LRuleBndr GhcPs]
-&gt; [Name]
-&gt; ([LRuleBndr GhcRn] -&gt; RnM (RuleDecl GhcRn, FreeVars))
-&gt; RnM (RuleDecl GhcRn, FreeVars)
forall ty_bndrs a.
HsDocContext
-&gt; Maybe ty_bndrs
-&gt; [LRuleBndr GhcPs]
-&gt; [Name]
-&gt; ([LRuleBndr GhcRn] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Module.html#bindRuleTmVars"><span class="hs-identifier hs-var">bindRuleTmVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062391"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn]
Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
</span><a href="#local-6989586621683062394"><span class="hs-identifier hs-var">tyvs'</span></a></span><span> </span><span class="annot"><span class="annottext">[LRuleBndr GhcPs]
</span><a href="#local-6989586621683062383"><span class="hs-identifier hs-var">tmvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062390"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">(([LRuleBndr GhcRn] -&gt; RnM (RuleDecl GhcRn, FreeVars))
 -&gt; RnM (RuleDecl GhcRn, FreeVars))
-&gt; ([LRuleBndr GhcRn] -&gt; RnM (RuleDecl GhcRn, FreeVars))
-&gt; RnM (RuleDecl GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062396"><span class="annot"><span class="annottext">[LRuleBndr GhcRn]
</span><a href="#local-6989586621683062396"><span class="hs-identifier hs-var">tmvs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1177"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062397"><span class="annot"><a href="#local-6989586621683062397"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062398"><span class="annot"><a href="#local-6989586621683062398"><span class="hs-identifier hs-var">fv_lhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XRec GhcPs (HsExpr GhcPs) -&gt; TcM (LHsExpr GhcRn, FreeVars)
</span><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-var">rnLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs (HsExpr GhcPs)
</span><a href="#local-6989586621683062385"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1178"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062399"><span class="annot"><a href="#local-6989586621683062399"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062400"><span class="annot"><a href="#local-6989586621683062400"><span class="hs-identifier hs-var">fv_rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Expr.html#rnLExpr"><span class="hs-identifier hs-type">rnLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062387"><span class="hs-identifier hs-type">rhs</span></a></span><span>
</span><span id="line-1179"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#checkValidRule"><span class="hs-identifier hs-type">checkValidRule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062377"><span class="hs-identifier hs-type">rule_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062390"><span class="hs-identifier hs-type">names</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062397"><span class="hs-identifier hs-type">lhs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062398"><span class="hs-identifier hs-type">fv_lhs'</span></a></span><span>
</span><span id="line-1180"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsRule"><span class="hs-identifier hs-type">HsRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_ext"><span class="hs-identifier hs-var">rd_ext</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Decls.html#HsRuleRn"><span class="hs-identifier hs-type">HsRuleRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062398"><span class="hs-identifier hs-type">fv_lhs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062400"><span class="hs-identifier hs-type">fv_rhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062375"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1181"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_name"><span class="hs-identifier hs-var">rd_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062377"><span class="hs-identifier hs-type">rule_name</span></a></span><span>
</span><span id="line-1182"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_act"><span class="hs-identifier hs-var">rd_act</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062379"><span class="hs-identifier hs-type">act</span></a></span><span>
</span><span id="line-1183"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_tyvs"><span class="hs-identifier hs-var">rd_tyvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062394"><span class="hs-identifier hs-type">tyvs'</span></a></span><span>
</span><span id="line-1184"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_tmvs"><span class="hs-identifier hs-var">rd_tmvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062396"><span class="hs-identifier hs-type">tmvs'</span></a></span><span>
</span><span id="line-1185"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_lhs"><span class="hs-identifier hs-var">rd_lhs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062397"><span class="hs-identifier hs-type">lhs'</span></a></span><span>
</span><span id="line-1186"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#rd_rhs"><span class="hs-identifier hs-var">rd_rhs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062399"><span class="hs-identifier hs-type">rhs'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062398"><span class="hs-identifier hs-type">fv_lhs'</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062400"><span class="hs-identifier hs-type">fv_rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1188"></span><span>    </span><span class="annot"><a href="#local-6989586621683062389"><span class="hs-identifier hs-type">get_var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleBndr"><span class="hs-identifier hs-type">RuleBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-1189"></span><span>    </span><span id="local-6989586621683062389"><span class="annot"><span class="annottext">get_var :: RuleBndr GhcPs -&gt; GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062389"><span class="hs-identifier hs-var hs-var">get_var</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleBndrSig"><span class="hs-identifier hs-type">RuleBndrSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRuleBndrSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062404"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062404"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsPatSigType GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062404"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1190"></span><span>    </span><span class="annot"><a href="#local-6989586621683062389"><span class="hs-identifier hs-var">get_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleBndr"><span class="hs-identifier hs-type">RuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">XCRuleBndr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062406"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062406"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062406"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1191"></span><span>
</span><span id="line-1192"></span><span id="local-6989586621683060743"><span id="local-6989586621683060744"><span class="annot"><a href="GHC.Rename.Module.html#bindRuleTmVars"><span class="hs-identifier hs-type">bindRuleTmVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621683060743"><span class="hs-identifier hs-type">ty_bndrs</span></a></span><span>
</span><span id="line-1193"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRuleBndr"><span class="hs-identifier hs-type">LRuleBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1194"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRuleBndr"><span class="hs-identifier hs-type">LRuleBndr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060744"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060744"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1196"></span><span id="bindRuleTmVars"><span class="annot"><span class="annottext">bindRuleTmVars :: forall ty_bndrs a.
HsDocContext
-&gt; Maybe ty_bndrs
-&gt; [LRuleBndr GhcPs]
-&gt; [Name]
-&gt; ([LRuleBndr GhcRn] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Module.html#bindRuleTmVars"><span class="hs-identifier hs-var hs-var">bindRuleTmVars</span></a></span></span><span> </span><span id="local-6989586621683062421"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062421"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683062422"><span class="annot"><span class="annottext">Maybe ty_bndrs
</span><a href="#local-6989586621683062422"><span class="hs-identifier hs-var">tyvs</span></a></span></span><span> </span><span id="local-6989586621683062423"><span class="annot"><span class="annottext">[LRuleBndr GhcPs]
</span><a href="#local-6989586621683062423"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621683062424"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062424"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621683062425"><span class="annot"><span class="annottext">[LRuleBndr GhcRn] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062425"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1197"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
-&gt; [Name]
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[LRuleBndr GhcPs]
[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062423"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062424"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">(([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
 -&gt; RnM (a, FreeVars))
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062427"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062427"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1198"></span><span>    </span><span class="annot"><span class="annottext">[Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
forall a. [Name] -&gt; RnM (a, FreeVars) -&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062424"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LRuleBndr GhcRn] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062425"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">[LRuleBndr GhcRn]
[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062427"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1200"></span><span>    </span><span id="local-6989586621683062426"><span class="annot"><span class="annottext">go :: [GenLocated EpAnnCO (RuleBndr GhcPs)]
-&gt; [Name]
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062426"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062428"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062428"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleBndr"><span class="hs-identifier hs-type">RuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">XCRuleBndr GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062429"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683062429"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683062430"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062430"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062431"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062431"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683062432"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062432"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062433"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062433"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1201"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
-&gt; [Name]
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062430"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062432"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">(([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
 -&gt; RnM (a, FreeVars))
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062434"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062434"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1202"></span><span>        </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062433"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpAnnCO -&gt; RuleBndr GhcRn -&gt; GenLocated EpAnnCO (RuleBndr GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062428"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XCRuleBndr GhcRn -&gt; LIdP GhcRn -&gt; RuleBndr GhcRn
forall pass. XCRuleBndr pass -&gt; LIdP pass -&gt; RuleBndr pass
</span><a href="Language.Haskell.Syntax.Decls.html#RuleBndr"><span class="hs-identifier hs-var">RuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">XCRuleBndr GhcRn
AnnTyVarBndr
forall a. NoAnn a =&gt; a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; Name -&gt; GenLocated SrcSpanAnnN Name
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683062429"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062431"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenLocated EpAnnCO (RuleBndr GhcRn)
-&gt; [GenLocated EpAnnCO (RuleBndr GhcRn)]
-&gt; [GenLocated EpAnnCO (RuleBndr GhcRn)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062434"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span>    </span><span class="annot"><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062435"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062435"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleBndrSig"><span class="hs-identifier hs-type">RuleBndrSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRuleBndrSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062436"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683062436"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062437"><span class="annot"><span class="annottext">HsPatSigType GhcPs
</span><a href="#local-6989586621683062437"><span class="hs-identifier hs-var">bsig</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683062438"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062438"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1205"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621683062439"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062439"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683062440"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062440"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062441"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062441"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1206"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsPatSigTypeScoping
-&gt; HsDocContext
-&gt; HsPatSigType GhcPs
-&gt; (HsPatSigType GhcRn -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
forall a.
HsPatSigTypeScoping
-&gt; HsDocContext
-&gt; HsPatSigType GhcPs
-&gt; (HsPatSigType GhcRn -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsPatSigType"><span class="hs-identifier hs-var">rnHsPatSigType</span></a></span><span> </span><span class="annot"><span class="annottext">HsPatSigTypeScoping
</span><a href="#local-6989586621683062443"><span class="hs-identifier hs-var">bind_free_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062421"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">HsPatSigType GhcPs
</span><a href="#local-6989586621683062437"><span class="hs-identifier hs-var">bsig</span></a></span><span> </span><span class="annot"><span class="annottext">((HsPatSigType GhcRn -&gt; RnM (a, FreeVars)) -&gt; RnM (a, FreeVars))
-&gt; (HsPatSigType GhcRn -&gt; RnM (a, FreeVars)) -&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062444"><span class="annot"><span class="annottext">HsPatSigType GhcRn
</span><a href="#local-6989586621683062444"><span class="hs-identifier hs-var">bsig'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1207"></span><span>        </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
-&gt; [Name]
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062438"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062440"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">(([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
 -&gt; RnM (a, FreeVars))
-&gt; ([GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars))
-&gt; RnM (a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062445"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062445"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1208"></span><span>        </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062441"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpAnnCO -&gt; RuleBndr GhcRn -&gt; GenLocated EpAnnCO (RuleBndr GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062435"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XRuleBndrSig GhcRn
-&gt; LIdP GhcRn -&gt; HsPatSigType GhcRn -&gt; RuleBndr GhcRn
forall pass.
XRuleBndrSig pass
-&gt; LIdP pass -&gt; HsPatSigType pass -&gt; RuleBndr pass
</span><a href="Language.Haskell.Syntax.Decls.html#RuleBndrSig"><span class="hs-identifier hs-var">RuleBndrSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRuleBndrSig GhcRn
AnnTyVarBndr
forall a. NoAnn a =&gt; a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; Name -&gt; GenLocated SrcSpanAnnN Name
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683062436"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062439"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsPatSigType GhcRn
</span><a href="#local-6989586621683062444"><span class="hs-identifier hs-var">bsig'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenLocated EpAnnCO (RuleBndr GhcRn)
-&gt; [GenLocated EpAnnCO (RuleBndr GhcRn)]
-&gt; [GenLocated EpAnnCO (RuleBndr GhcRn)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)]
</span><a href="#local-6989586621683062445"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span>
</span><span id="line-1210"></span><span>    </span><span class="annot"><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621683062446"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062446"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><a href="#local-6989586621683062446"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1211"></span><span>    </span><span class="annot"><a href="#local-6989586621683062426"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683062447"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062447"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621683062448"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062448"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcRn)] -&gt; RnM (a, FreeVars)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; RnM (a, FreeVars)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bindRuleVars&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (RuleBndr GhcPs)]
</span><a href="#local-6989586621683062447"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062448"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span>    </span><span id="local-6989586621683062443"><span class="annot"><span class="annottext">bind_free_tvs :: HsPatSigTypeScoping
</span><a href="#local-6989586621683062443"><span class="hs-identifier hs-var hs-var">bind_free_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ty_bndrs
</span><a href="#local-6989586621683062422"><span class="hs-identifier hs-var">tyvs</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe ty_bndrs
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsPatSigTypeScoping
</span><a href="GHC.Rename.HsType.html#AlwaysBind"><span class="hs-identifier hs-var">AlwaysBind</span></a></span><span>
</span><span id="line-1214"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ty_bndrs
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsPatSigTypeScoping
</span><a href="GHC.Rename.HsType.html#NeverBind"><span class="hs-identifier hs-var">NeverBind</span></a></span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span id="local-6989586621683060742"><span class="annot"><a href="GHC.Rename.Module.html#bindRuleTyVars"><span class="hs-identifier hs-type">bindRuleTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1217"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060742"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060742"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1219"></span><span id="bindRuleTyVars"><span class="annot"><span class="annottext">bindRuleTyVars :: forall b.
HsDocContext
-&gt; Maybe [LHsTyVarBndr () GhcPs]
-&gt; (Maybe [LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars))
-&gt; RnM (b, FreeVars)
</span><a href="GHC.Rename.Module.html#bindRuleTyVars"><span class="hs-identifier hs-var hs-var">bindRuleTyVars</span></a></span></span><span> </span><span id="local-6989586621683062453"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062453"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062454"><span class="annot"><span class="annottext">[LHsTyVarBndr () GhcPs]
</span><a href="#local-6989586621683062454"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062455"><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683062455"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1220"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; WarnUnusedForalls
-&gt; Maybe (ZonkAny 5)
-&gt; [LHsTyVarBndr () GhcPs]
-&gt; ([LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars))
-&gt; RnM (b, FreeVars)
forall flag a b.
OutputableBndrFlag flag 'Renamed =&gt;
HsDocContext
-&gt; WarnUnusedForalls
-&gt; Maybe a
-&gt; [LHsTyVarBndr flag GhcPs]
-&gt; ([LHsTyVarBndr flag GhcRn] -&gt; RnM (b, FreeVars))
-&gt; RnM (b, FreeVars)
</span><a href="GHC.Rename.HsType.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062453"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">WarnUnusedForalls
</span><a href="GHC.Rename.HsType.html#WarnUnusedForalls"><span class="hs-identifier hs-var">WarnUnusedForalls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ZonkAny 5)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[LHsTyVarBndr () GhcPs]
</span><a href="#local-6989586621683062454"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars)
Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
-&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683062455"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
 -&gt; RnM (b, FreeVars))
-&gt; ([GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
    -&gt; Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)])
-&gt; [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
-&gt; RnM (b, FreeVars)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
-&gt; Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span class="annot"><a href="GHC.Rename.Module.html#bindRuleTyVars"><span class="hs-identifier hs-var">bindRuleTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcPs]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062458"><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683062458"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn] -&gt; RnM (b, FreeVars)
</span><a href="#local-6989586621683062458"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [LHsTyVarBndr () GhcRn]
Maybe [GenLocated SrcSpanAnnA (HsTyVarBndr () GhcRn)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span class="hs-comment">{-
Note [Rule LHS validity checking]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Check the shape of a rewrite rule LHS.  Currently we only allow
LHSs of the form @(f e1 .. en)@, where @f@ is not one of the
@forall@'d variables.

We used restrict the form of the 'ei' to prevent you writing rules
with LHSs with a complicated desugaring (and hence unlikely to match);
(e.g. a case expression is not allowed: too elaborate.)

But there are legitimate non-trivial args ei, like sections and
lambdas.  So it seems simpler not to check at all, and that is why
check_e is commented out.

Note [Parens on the LHS of a RULE]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You may think that no one would write

   {-# RULES &quot;foo&quot; (f True) = blah #-}

with the LHS wrapped in parens. But Template Haskell does (#24621)!
So we should accommodate them.
-}</span><span>
</span><span id="line-1247"></span><span>
</span><span id="line-1248"></span><span class="annot"><a href="GHC.Rename.Module.html#checkValidRule"><span class="hs-identifier hs-type">checkValidRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span id="checkValidRule"><span class="annot"><span class="annottext">checkValidRule :: CLabelString -&gt; [Name] -&gt; LHsExpr GhcRn -&gt; FreeVars -&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#checkValidRule"><span class="hs-identifier hs-var hs-var">checkValidRule</span></a></span></span><span> </span><span id="local-6989586621683062460"><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062460"><span class="hs-identifier hs-var">rule_name</span></a></span></span><span> </span><span id="local-6989586621683062461"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062461"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621683062462"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062462"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span> </span><span id="local-6989586621683062463"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062463"><span class="hs-identifier hs-var">fv_lhs'</span></a></span></span><span>
</span><span id="line-1250"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span>       </span><span class="hs-comment">-- Check for the form of the LHS</span><span>
</span><span id="line-1251"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; LHsExpr GhcRn -&gt; Maybe (HsExpr GhcRn)
</span><a href="GHC.Rename.Module.html#validRuleLhs"><span class="hs-identifier hs-var">validRuleLhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062461"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062462"><span class="hs-identifier hs-var">lhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1252"></span><span>                </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062465"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062465"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabelString -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn -&gt; TcRnMessage
</span><a href="GHC.Rename.Module.html#badRuleLhsErr"><span class="hs-identifier hs-var">badRuleLhsErr</span></a></span><span> </span><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062460"><span class="hs-identifier hs-var">rule_name</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062462"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062465"><span class="hs-identifier hs-var">bad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span>                </span><span class="hs-comment">-- Check that LHS vars are all bound</span><span>
</span><span id="line-1256"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062468"><span class="annot"><span class="annottext">bad_vars :: [Name]
</span><a href="#local-6989586621683062468"><span class="hs-identifier hs-var hs-var">bad_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062469"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683062469"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062469"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062461"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062469"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062463"><span class="hs-identifier hs-var">fv_lhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1257"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; TcRn ()) -&gt; [Name] -&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ())
-&gt; (Name -&gt; TcRnMessage) -&gt; Name -&gt; TcRn ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CLabelString -&gt; Name -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnUnusedVariableInRuleDecl"><span class="hs-identifier hs-var">TcRnUnusedVariableInRuleDecl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062460"><span class="hs-identifier hs-var">rule_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062468"><span class="hs-identifier hs-var">bad_vars</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span class="annot"><a href="GHC.Rename.Module.html#validRuleLhs"><span class="hs-identifier hs-type">validRuleLhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span class="hs-comment">-- Nothing =&gt; OK</span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- Just e  =&gt; Not ok, and e is the offending sub-expression</span><span>
</span><span id="line-1262"></span><span id="validRuleLhs"><span class="annot"><span class="annottext">validRuleLhs :: [Name] -&gt; LHsExpr GhcRn -&gt; Maybe (HsExpr GhcRn)
</span><a href="GHC.Rename.Module.html#validRuleLhs"><span class="hs-identifier hs-var hs-var">validRuleLhs</span></a></span></span><span> </span><span id="local-6989586621683062471"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062471"><span class="hs-identifier hs-var">foralls</span></a></span></span><span> </span><span id="local-6989586621683062472"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062472"><span class="hs-identifier hs-var">lhs</span></a></span></span><span>
</span><span id="line-1263"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var">checkl</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062472"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1264"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1265"></span><span>    </span><span id="local-6989586621683062473"><span class="annot"><span class="annottext">checkl :: GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var hs-var">checkl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcRn -&gt; Maybe (HsExpr GhcRn))
-&gt; (GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; HsExpr GhcRn)
-&gt; GenLocated SrcSpanAnnA (HsExpr GhcRn)
-&gt; Maybe (HsExpr GhcRn)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; HsExpr GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span>
</span><span id="line-1266"></span><span>
</span><span id="line-1267"></span><span>    </span><span id="local-6989586621683062474"><span class="annot"><span class="annottext">check :: HsExpr GhcRn -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062474"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062476"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062476"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621683062477"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062477"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621683062478"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062478"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var">checkl</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062477"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
-&gt; Maybe (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall {p} {a}. p -&gt; Maybe a
</span><a href="#local-6989586621683062480"><span class="hs-identifier hs-var">checkl_e</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062476"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1268"></span><span>                                                      </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
-&gt; Maybe (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall {p} {a}. p -&gt; Maybe a
</span><a href="#local-6989586621683062480"><span class="hs-identifier hs-var">checkl_e</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062478"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1269"></span><span>    </span><span class="annot"><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062482"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062482"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621683062483"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062483"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var">checkl</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062482"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
-&gt; Maybe (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
forall {p} {a}. p -&gt; Maybe a
</span><a href="#local-6989586621683062480"><span class="hs-identifier hs-var">checkl_e</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062483"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1270"></span><span>    </span><span class="annot"><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062485"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062485"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcRn)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var">checkl</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062485"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1271"></span><span>    </span><span class="annot"><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062486"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621683062486"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1272"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683062486"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062471"><span class="hs-identifier hs-var">foralls</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcRn)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1273"></span><span>    </span><span class="hs-comment">-- See Note [Parens on the LHS of a RULE]</span><span>
</span><span id="line-1274"></span><span>    </span><span class="annot"><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062489"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062489"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcRn) -&gt; Maybe (HsExpr GhcRn)
</span><a href="#local-6989586621683062473"><span class="hs-identifier hs-var">checkl</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
GenLocated SrcSpanAnnA (HsExpr GhcRn)
</span><a href="#local-6989586621683062489"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1275"></span><span>    </span><span class="annot"><a href="#local-6989586621683062474"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span id="local-6989586621683062490"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062490"><span class="hs-identifier hs-var">other</span></a></span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn -&gt; Maybe (HsExpr GhcRn)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062490"><span class="hs-identifier hs-var">other</span></a></span><span>  </span><span class="hs-comment">-- Failure</span><span>
</span><span id="line-1276"></span><span>
</span><span id="line-1277"></span><span>        </span><span class="hs-comment">-- Check an argument</span><span>
</span><span id="line-1278"></span><span>    </span><span id="local-6989586621683062480"><span class="annot"><span class="annottext">checkl_e :: p -&gt; Maybe a
</span><a href="#local-6989586621683062480"><span class="hs-identifier hs-var hs-var">checkl_e</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1279"></span><span>    </span><span class="hs-comment">-- Was (check_e e); see Note [Rule LHS validity checking]</span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span class="hs-comment">{-      Commented out; see Note [Rule LHS validity checking] above
    check_e (HsVar v)     = Nothing
    check_e (HsPar e)     = checkl_e e
    check_e (HsLit e)     = Nothing
    check_e (HsOverLit e) = Nothing

    check_e (OpApp e1 op _ e2)   = checkl_e e1 `mplus` checkl_e op `mplus` checkl_e e2
    check_e (HsApp e1 e2)        = checkl_e e1 `mplus` checkl_e e2
    check_e (NegApp e _)         = checkl_e e
    check_e (ExplicitList _ es)  = checkl_es es
    check_e other                = Just other   -- Fails

    checkl_es es = foldr (mplus . checkl_e) Nothing es
-}</span><span>
</span><span id="line-1295"></span><span>
</span><span id="line-1296"></span><span>
</span><span id="line-1297"></span><span class="annot"><a href="GHC.Rename.Module.html#badRuleLhsErr"><span class="hs-identifier hs-type">badRuleLhsErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-1298"></span><span id="badRuleLhsErr"><span class="annot"><span class="annottext">badRuleLhsErr :: CLabelString -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn -&gt; TcRnMessage
</span><a href="GHC.Rename.Module.html#badRuleLhsErr"><span class="hs-identifier hs-var hs-var">badRuleLhsErr</span></a></span></span><span> </span><span id="local-6989586621683062491"><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062491"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621683062492"><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062492"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621683062493"><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062493"><span class="hs-identifier hs-var">bad_e</span></a></span></span><span>
</span><span id="line-1299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleLhsErrReason
-&gt; CLabelString -&gt; LHsExpr GhcRn -&gt; HsExpr GhcRn -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalRuleLhs"><span class="hs-identifier hs-var">TcRnIllegalRuleLhs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleLhsErrReason
</span><a href="#local-6989586621683062495"><span class="hs-identifier hs-var">errReason</span></a></span><span> </span><span class="annot"><span class="annottext">CLabelString
</span><a href="#local-6989586621683062491"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcRn
</span><a href="#local-6989586621683062492"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062493"><span class="hs-identifier hs-var">bad_e</span></a></span><span>
</span><span id="line-1300"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1301"></span><span>    </span><span id="local-6989586621683062495"><span class="annot"><span class="annottext">errReason :: RuleLhsErrReason
</span><a href="#local-6989586621683062495"><span class="hs-identifier hs-var hs-var">errReason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><a href="#local-6989586621683062493"><span class="hs-identifier hs-var">bad_e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1302"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUnboundVar"><span class="hs-identifier hs-type">HsUnboundVar</span></a></span><span> </span><span class="annot"><span class="annottext">XUnboundVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062497"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683062497"><span class="hs-identifier hs-var">uv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1303"></span><span>        </span><span class="annot"><span class="annottext">RdrName -&gt; NotInScopeError -&gt; RuleLhsErrReason
</span><a href="GHC.Tc.Errors.Types.html#UnboundVariable"><span class="hs-identifier hs-var">UnboundVariable</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683062497"><span class="hs-identifier hs-var">uv</span></a></span><span> </span><span class="annot"><span class="annottext">(NotInScopeError -&gt; RuleLhsErrReason)
-&gt; NotInScopeError -&gt; RuleLhsErrReason
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WhereLooking -&gt; RdrName -&gt; NotInScopeError
</span><a href="GHC.Rename.Unbound.html#notInScopeErr"><span class="hs-identifier hs-var">notInScopeErr</span></a></span><span> </span><span class="annot"><span class="annottext">WhereLooking
</span><a href="GHC.Rename.Unbound.html#WL_Global"><span class="hs-identifier hs-var">WL_Global</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683062497"><span class="hs-identifier hs-var">uv</span></a></span><span>
</span><span id="line-1304"></span><span>      </span><span class="annot"><span class="annottext">HsExpr GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleLhsErrReason
</span><a href="GHC.Tc.Errors.Types.html#IllegalExpression"><span class="hs-identifier hs-var">IllegalExpression</span></a></span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span class="annot"><span class="hs-comment">{- **************************************************************
         *                                                      *
      Renaming type, class, instance and role declarations
*                                                               *
*****************************************************************

@rnTyDecl@ uses the `global name function' to create a new type
declaration in which local names have been replaced by their original
names, reporting any unknown names.

Renaming type variables is a pain. Because they now contain uniques,
it is necessary to pass in an association list which maps a parsed
tyvar to its @Name@ representation.
In some cases (type signatures of values),
it is even necessary to go over the type first
in order to get the set of tyvars used by it, make an assoc list,
and then go over it again to rename the tyvars!
However, we can also do some scoping checks at the same time.

Note [Dependency analysis of type, class, and instance decls]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A TyClGroup represents a strongly connected components of
type/class/instance decls, together with the role annotations for the
type/class declarations.  The renamer uses strongly connected
component analysis to build these groups.  We do this for a number of
reasons:

* Improve kind error messages. Consider

     data T f a = MkT f a
     data S f a = MkS f (T f a)

  This has a kind error, but the error message is better if you
  check T first, (fixing its kind) and *then* S.  If you do kind
  inference together, you might get an error reported in S, which
  is jolly confusing.  See #4875


* Increase kind polymorphism.  See GHC.Tc.TyCl
  Note [Grouping of type and class declarations]

Why do the instance declarations participate?  At least two reasons

* Consider (#11348)

     type family F a
     type instance F Int = Bool

     data R = MkR (F Int)

     type Foo = 'MkR 'True

  For Foo to kind-check we need to know that (F Int) ~ Bool.  But we won't
  know that unless we've looked at the type instance declaration for F
  before kind-checking Foo.

* Another example is this (#3990).

     data family Complex a
     data instance Complex Double = CD {-# UNPACK #-} !Double
                                       {-# UNPACK #-} !Double

     data T = T {-# UNPACK #-} !(Complex Double)

  Here, to generate the right kind of unpacked implementation for T,
  we must have access to the 'data instance' declaration.

* Things become more complicated when we introduce transitive
  dependencies through imported definitions, like in this scenario:

      A.hs
        type family Closed (t :: Type) :: Type where
          Closed t = Open t

        type family Open (t :: Type) :: Type

      B.hs
        data Q where
          Q :: Closed Bool -&gt; Q

        type instance Open Int = Bool

        type S = 'Q 'True

  Somehow, we must ensure that the instance Open Int = Bool is checked before
  the type synonym S. While we know that S depends upon 'Q depends upon Closed,
  we have no idea that Closed depends upon Open!

  To accommodate for these situations, we ensure that an instance is checked
  before every @TyClDecl@ on which it does not depend. That's to say, instances
  are checked as early as possible in @tcTyAndClassDecls@.

------------------------------------
So much for WHY.  What about HOW?  It's pretty easy:

(1) Rename the type/class, instance, and role declarations
    individually

(2) Do strongly-connected component analysis of the type/class decls,
    We'll make a TyClGroup for each SCC

    In this step we treat a reference to a (promoted) data constructor
    K as a dependency on its parent type.  Thus
        data T = K1 | K2
        data S = MkS (Proxy 'K1)
    Here S depends on 'K1 and hence on its parent T.

    In this step we ignore instances; see
    Note [No dependencies on data instances]

(3) Attach roles to the appropriate SCC

(4) Attach instances to the appropriate SCC.
    We add an instance decl to SCC when:
      all its free types/classes are bound in this SCC or earlier ones

(5) We make an initial TyClGroup, with empty group_tyclds, for any
    (orphan) instances that affect only imported types/classes

Steps (3) and (4) are done by the (mapAccumL mk_group) call.

Note [No dependencies on data instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider this
   data family D a
   data instance D Int = D1
   data S = MkS (Proxy 'D1)

Here the declaration of S depends on the /data instance/ declaration
for 'D Int'.  That makes things a lot more complicated, especially
if the data instance is an associated type of an enclosing class instance.
(And the class instance might have several associated type instances
with different dependency structure!)

Ugh.  For now we simply don't allow promotion of data constructors for
data instances.  See Note [AFamDataCon: not promoting data family
constructors] in GHC.Tc.Utils.Env
-}</span></span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span>
</span><span id="line-1446"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecls"><span class="hs-identifier hs-type">rnTyClDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1447"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span class="hs-comment">-- Rename the declarations and do dependency analysis on them</span><span>
</span><span id="line-1449"></span><span id="rnTyClDecls"><span class="annot"><span class="annottext">rnTyClDecls :: [TyClGroup GhcPs] -&gt; RnM ([TyClGroup GhcRn], FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyClDecls"><span class="hs-identifier hs-var hs-var">rnTyClDecls</span></a></span></span><span> </span><span id="local-6989586621683062500"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683062500"><span class="hs-identifier hs-var">tycl_ds</span></a></span></span><span>
</span><span id="line-1450"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Rename the type/class, instance, and role declarations</span><span>
</span><span id="line-1451"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062501"><span class="annot"><a href="#local-6989586621683062501"><span class="hs-identifier hs-var">tycls_w_fvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (TyClDecl GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars))
-&gt; [GenLocated SrcSpanAnnA (TyClDecl GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyClDecl GhcPs -&gt; TcM (TyClDecl GhcRn, FreeVars))
-&gt; GenLocated SrcSpanAnnA (TyClDecl GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
forall a b c ann.
(a -&gt; TcM (b, c))
-&gt; GenLocated (EpAnn ann) a -&gt; TcM (GenLocated (EpAnn ann) b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-var">wrapLocFstMA</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs -&gt; TcM (TyClDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-var">rnTyClDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyClGroup GhcPs] -&gt; [LTyClDecl GhcPs]
forall pass. [TyClGroup pass] -&gt; [LTyClDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tyClGroupTyClDecls"><span class="hs-identifier hs-var">tyClGroupTyClDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683062500"><span class="hs-identifier hs-var">tycl_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1452"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062504"><span class="annot"><a href="#local-6989586621683062504"><span class="hs-identifier hs-var hs-var">tc_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars) -&gt; Name)
-&gt; [(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyClDecl GhcRn -&gt; IdP GhcRn
TyClDecl GhcRn -&gt; Name
forall (p :: Pass).
(Anno (IdGhcP p) ~ SrcSpanAnnN) =&gt;
TyClDecl (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#tcdName"><span class="hs-identifier hs-var">tcdName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyClDecl GhcRn -&gt; Name)
-&gt; ((GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
    -&gt; TyClDecl GhcRn)
-&gt; (GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
-&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; TyClDecl GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; TyClDecl GhcRn)
-&gt; ((GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
    -&gt; GenLocated SrcSpanAnnA (TyClDecl GhcRn))
-&gt; (GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
-&gt; TyClDecl GhcRn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
-&gt; GenLocated SrcSpanAnnA (TyClDecl GhcRn)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062501"><span class="hs-identifier hs-var">tycls_w_fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnTyClDecls&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1454"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tyClGroupTyClDecls:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062501"><span class="hs-identifier hs-type">tycls_w_fvs</span></a></span><span>
</span><span id="line-1455"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tc_names:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062504"><span class="hs-identifier hs-type">tc_names</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1456"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062507"><span class="annot"><a href="#local-6989586621683062507"><span class="hs-identifier hs-var">kisigs_w_fvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnStandaloneKindSignatures"><span class="hs-identifier hs-type">rnStandaloneKindSignatures</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062504"><span class="hs-identifier hs-type">tc_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tyClGroupKindSigs"><span class="hs-identifier hs-type">tyClGroupKindSigs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062500"><span class="hs-identifier hs-type">tycl_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1457"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062510"><span class="annot"><a href="#local-6989586621683062510"><span class="hs-identifier hs-var">instds_w_fvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-type">wrapLocFstMA</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnSrcInstDecl"><span class="hs-identifier hs-type">rnSrcInstDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tyClGroupInstDecls"><span class="hs-identifier hs-type">tyClGroupInstDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062500"><span class="hs-identifier hs-type">tycl_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1458"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062512"><span class="annot"><a href="#local-6989586621683062512"><span class="hs-identifier hs-var">role_annots</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnRoleAnnots"><span class="hs-identifier hs-type">rnRoleAnnots</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062504"><span class="hs-identifier hs-type">tc_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tyClGroupRoleDecls"><span class="hs-identifier hs-type">tyClGroupRoleDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062500"><span class="hs-identifier hs-type">tycl_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1459"></span><span>
</span><span id="line-1460"></span><span>       </span><span class="hs-comment">-- Do SCC analysis on the type/class decls</span><span>
</span><span id="line-1461"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062515"><span class="annot"><a href="#local-6989586621683062515"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-type">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-1462"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnTyClDecls SCC analysis&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1463"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rdr_env:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062515"><span class="hs-identifier hs-type">rdr_env</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1464"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062517"><span class="annot"><a href="#local-6989586621683062517"><span class="hs-identifier hs-var hs-var">tycl_sccs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
-&gt; KindSig_FV_Env
-&gt; [(LTyClDecl GhcRn, FreeVars)]
-&gt; [SCC (LTyClDecl GhcRn)]
</span><a href="GHC.Rename.Module.html#depAnalTyClDecls"><span class="hs-identifier hs-var">depAnalTyClDecls</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062515"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">KindSig_FV_Env
</span><a href="#local-6989586621683062519"><span class="hs-identifier hs-var">kisig_fv_env</span></a></span><span> </span><span class="annot"><span class="annottext">[(LTyClDecl GhcRn, FreeVars)]
[(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062501"><span class="hs-identifier hs-var">tycls_w_fvs</span></a></span><span>
</span><span id="line-1465"></span><span>             </span><span id="local-6989586621683062520"><span class="annot"><a href="#local-6989586621683062520"><span class="hs-identifier hs-var hs-var">role_annot_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcRn] -&gt; RoleAnnotEnv
</span><a href="GHC.Tc.Types.html#mkRoleAnnotEnv"><span class="hs-identifier hs-var">mkRoleAnnotEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcRn]
[GenLocated SrcSpanAnnA (RoleAnnotDecl GhcRn)]
</span><a href="#local-6989586621683062512"><span class="hs-identifier hs-var">role_annots</span></a></span><span>
</span><span id="line-1466"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683062522"><span class="annot"><a href="#local-6989586621683062522"><span class="hs-identifier hs-var">kisig_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062519"><span class="annot"><a href="#local-6989586621683062519"><span class="hs-identifier hs-var">kisig_fv_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#mkKindSig_fv_env"><span class="hs-identifier hs-type">mkKindSig_fv_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062507"><span class="hs-identifier hs-type">kisigs_w_fvs</span></a></span><span>
</span><span id="line-1467"></span><span>
</span><span id="line-1468"></span><span>             </span><span id="local-6989586621683062524"><span class="annot"><a href="#local-6989586621683062524"><span class="hs-identifier hs-var hs-var">inst_ds_map</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
-&gt; FreeVars -&gt; InstDeclFreeVarsMap -&gt; InstDeclFreeVarsMap
</span><a href="GHC.Rename.Module.html#mkInstDeclFreeVarsMap"><span class="hs-identifier hs-var">mkInstDeclFreeVarsMap</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062515"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062504"><span class="hs-identifier hs-var">tc_names</span></a></span><span> </span><span class="annot"><span class="annottext">InstDeclFreeVarsMap
[(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062510"><span class="hs-identifier hs-var">instds_w_fvs</span></a></span><span>
</span><span id="line-1469"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683062526"><span class="annot"><a href="#local-6989586621683062526"><span class="hs-identifier hs-var">init_inst_ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062527"><span class="annot"><a href="#local-6989586621683062527"><span class="hs-identifier hs-var">rest_inst_ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#getInsts"><span class="hs-identifier hs-type">getInsts</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621683062524"><span class="hs-identifier hs-type">inst_ds_map</span></a></span><span>
</span><span id="line-1470"></span><span>
</span><span id="line-1471"></span><span>             </span><span id="local-6989586621683062529"><span class="annot"><a href="#local-6989586621683062529"><span class="hs-identifier hs-var hs-var">first_group</span></a></span></span><span>
</span><span id="line-1472"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (InstDecl GhcRn)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[LInstDecl GhcRn]
[GenLocated SrcSpanAnnA (InstDecl GhcRn)]
</span><a href="#local-6989586621683062526"><span class="hs-identifier hs-var">init_inst_ds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1473"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup GhcRn
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-1474"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1475"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1476"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1477"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LInstDecl GhcRn]
</span><a href="#local-6989586621683062526"><span class="hs-identifier hs-var">init_inst_ds</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-1478"></span><span>
</span><span id="line-1479"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683062537"><span class="annot"><a href="#local-6989586621683062537"><span class="hs-identifier hs-var">final_inst_ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062538"><span class="annot"><a href="#local-6989586621683062538"><span class="hs-identifier hs-var">groups</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapAccumL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062539"><span class="hs-identifier hs-type">mk_group</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062520"><span class="hs-identifier hs-type">role_annot_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062522"><span class="hs-identifier hs-type">kisig_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062527"><span class="hs-identifier hs-type">rest_inst_ds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062517"><span class="hs-identifier hs-type">tycl_sccs</span></a></span><span>
</span><span id="line-1481"></span><span>
</span><span id="line-1482"></span><span>             </span><span id="local-6989586621683062540"><span class="annot"><a href="#local-6989586621683062540"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
 -&gt; FreeVars -&gt; FreeVars)
-&gt; FreeVars
-&gt; [(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
-&gt; FreeVars
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars -&gt; FreeVars -&gt; FreeVars)
-&gt; ((GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
    -&gt; FreeVars)
-&gt; (GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)
-&gt; FreeVars
-&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars) -&gt; FreeVars
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062501"><span class="hs-identifier hs-var">tycls_w_fvs</span></a></span><span>  </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span>
</span><span id="line-1483"></span><span>                       </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
 -&gt; FreeVars -&gt; FreeVars)
-&gt; FreeVars
-&gt; [(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
-&gt; FreeVars
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars -&gt; FreeVars -&gt; FreeVars)
-&gt; ((GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
    -&gt; FreeVars)
-&gt; (GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
-&gt; FreeVars
-&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars) -&gt; FreeVars
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062510"><span class="hs-identifier hs-var">instds_w_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span>
</span><span id="line-1484"></span><span>                       </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
 -&gt; FreeVars -&gt; FreeVars)
-&gt; FreeVars
-&gt; [(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)]
-&gt; FreeVars
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVars -&gt; FreeVars -&gt; FreeVars)
-&gt; ((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
    -&gt; FreeVars)
-&gt; (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; FreeVars
-&gt; FreeVars
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; FreeVars
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)]
</span><a href="#local-6989586621683062507"><span class="hs-identifier hs-var">kisigs_w_fvs</span></a></span><span>
</span><span id="line-1485"></span><span>
</span><span id="line-1486"></span><span>             </span><span id="local-6989586621683062542"><span class="annot"><a href="#local-6989586621683062542"><span class="hs-identifier hs-var hs-var">all_groups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn]
</span><a href="#local-6989586621683062529"><span class="hs-identifier hs-var">first_group</span></a></span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn] -&gt; [TyClGroup GhcRn] -&gt; [TyClGroup GhcRn]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcRn]
</span><a href="#local-6989586621683062538"><span class="hs-identifier hs-var">groups</span></a></span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683062537"><span class="hs-identifier hs-type">final_inst_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1489"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062510"><span class="hs-identifier hs-type">instds_w_fvs</span></a></span><span>
</span><span id="line-1490"></span><span>                     </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062524"><span class="hs-identifier hs-type">inst_ds_map</span></a></span><span>
</span><span id="line-1491"></span><span>                     </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#flattenSCCs"><span class="hs-identifier hs-type">flattenSCCs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062517"><span class="hs-identifier hs-type">tycl_sccs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1492"></span><span>                     </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062537"><span class="hs-identifier hs-type">final_inst_ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1493"></span><span>
</span><span id="line-1494"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnTycl dependency analysis made groups&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062542"><span class="hs-identifier hs-type">all_groups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1495"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062542"><span class="hs-identifier hs-type">all_groups</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062540"><span class="hs-identifier hs-type">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1496"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1497"></span><span>    </span><span class="annot"><a href="#local-6989586621683062539"><span class="hs-identifier hs-type">mk_group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RoleAnnotEnv"><span class="hs-identifier hs-type">RoleAnnotEnv</span></a></span><span>
</span><span id="line-1498"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#KindSigEnv"><span class="hs-identifier hs-type">KindSigEnv</span></a></span><span>
</span><span id="line-1499"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-type">InstDeclFreeVarsMap</span></a></span><span>
</span><span id="line-1500"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#SCC"><span class="hs-identifier hs-type">SCC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-type">InstDeclFreeVarsMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1502"></span><span>    </span><span id="local-6989586621683062539"><span class="annot"><span class="annottext">mk_group :: RoleAnnotEnv
-&gt; KindSigEnv
-&gt; InstDeclFreeVarsMap
-&gt; SCC (LTyClDecl GhcRn)
-&gt; (InstDeclFreeVarsMap, TyClGroup GhcRn)
</span><a href="#local-6989586621683062539"><span class="hs-identifier hs-var hs-var">mk_group</span></a></span></span><span> </span><span id="local-6989586621683062544"><span class="annot"><span class="annottext">RoleAnnotEnv
</span><a href="#local-6989586621683062544"><span class="hs-identifier hs-var">role_env</span></a></span></span><span> </span><span id="local-6989586621683062545"><span class="annot"><span class="annottext">KindSigEnv
</span><a href="#local-6989586621683062545"><span class="hs-identifier hs-var">kisig_env</span></a></span></span><span> </span><span id="local-6989586621683062546"><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062546"><span class="hs-identifier hs-var">inst_map</span></a></span></span><span> </span><span id="local-6989586621683062547"><span class="annot"><span class="annottext">SCC (LTyClDecl GhcRn)
</span><a href="#local-6989586621683062547"><span class="hs-identifier hs-var">scc</span></a></span></span><span>
</span><span id="line-1503"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062548"><span class="hs-identifier hs-var">inst_map'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyClGroup GhcRn
</span><a href="#local-6989586621683062549"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1504"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1505"></span><span>        </span><span id="local-6989586621683062550"><span class="annot"><span class="annottext">tycl_ds :: [GenLocated SrcSpanAnnA (TyClDecl GhcRn)]
</span><a href="#local-6989586621683062550"><span class="hs-identifier hs-var hs-var">tycl_ds</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SCC (GenLocated SrcSpanAnnA (TyClDecl GhcRn))
-&gt; [GenLocated SrcSpanAnnA (TyClDecl GhcRn)]
forall vertex. SCC vertex -&gt; [vertex]
</span><a href="../../containers-0.7-5a8f/src/Data.Graph.html#flattenSCC"><span class="hs-identifier hs-var">flattenSCC</span></a></span><span> </span><span class="annot"><span class="annottext">SCC (LTyClDecl GhcRn)
SCC (GenLocated SrcSpanAnnA (TyClDecl GhcRn))
</span><a href="#local-6989586621683062547"><span class="hs-identifier hs-var">scc</span></a></span><span>
</span><span id="line-1506"></span><span>        </span><span id="local-6989586621683062551"><span class="annot"><span class="annottext">bndrs :: [Name]
</span><a href="#local-6989586621683062551"><span class="hs-identifier hs-var hs-var">bndrs</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; Name)
-&gt; [GenLocated SrcSpanAnnA (TyClDecl GhcRn)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyClDecl GhcRn -&gt; IdP GhcRn
TyClDecl GhcRn -&gt; Name
forall (p :: Pass).
(Anno (IdGhcP p) ~ SrcSpanAnnN) =&gt;
TyClDecl (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#tcdName"><span class="hs-identifier hs-var">tcdName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyClDecl GhcRn -&gt; Name)
-&gt; (GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; TyClDecl GhcRn)
-&gt; GenLocated SrcSpanAnnA (TyClDecl GhcRn)
-&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; TyClDecl GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (TyClDecl GhcRn)]
</span><a href="#local-6989586621683062550"><span class="hs-identifier hs-var">tycl_ds</span></a></span><span>
</span><span id="line-1507"></span><span>        </span><span id="local-6989586621683062552"><span class="annot"><span class="annottext">roles :: [LRoleAnnotDecl GhcRn]
</span><a href="#local-6989586621683062552"><span class="hs-identifier hs-var hs-var">roles</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; RoleAnnotEnv -&gt; [LRoleAnnotDecl GhcRn]
</span><a href="GHC.Tc.Types.html#getRoleAnnots"><span class="hs-identifier hs-var">getRoleAnnots</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062551"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">RoleAnnotEnv
</span><a href="#local-6989586621683062544"><span class="hs-identifier hs-var">role_env</span></a></span><span>
</span><span id="line-1508"></span><span>        </span><span id="local-6989586621683062554"><span class="annot"><span class="annottext">kisigs :: [LStandaloneKindSig GhcRn]
</span><a href="#local-6989586621683062554"><span class="hs-identifier hs-var hs-var">kisigs</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; KindSigEnv -&gt; [LStandaloneKindSig GhcRn]
</span><a href="GHC.Rename.Module.html#getKindSigs"><span class="hs-identifier hs-var">getKindSigs</span></a></span><span>   </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062551"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">KindSigEnv
</span><a href="#local-6989586621683062545"><span class="hs-identifier hs-var">kisig_env</span></a></span><span>
</span><span id="line-1509"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683062556"><span class="annot"><span class="annottext">[LInstDecl GhcRn]
</span><a href="#local-6989586621683062556"><span class="hs-identifier hs-var">inst_ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062548"><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062548"><span class="hs-identifier hs-var">inst_map'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
-&gt; InstDeclFreeVarsMap -&gt; ([LInstDecl GhcRn], InstDeclFreeVarsMap)
</span><a href="GHC.Rename.Module.html#getInsts"><span class="hs-identifier hs-var">getInsts</span></a></span><span>      </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062551"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062546"><span class="hs-identifier hs-var">inst_map</span></a></span><span>
</span><span id="line-1510"></span><span>        </span><span id="local-6989586621683062549"><span class="annot"><span class="annottext">group :: TyClGroup GhcRn
</span><a href="#local-6989586621683062549"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup GhcRn
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-1511"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LTyClDecl GhcRn]
[GenLocated SrcSpanAnnA (TyClDecl GhcRn)]
</span><a href="#local-6989586621683062550"><span class="hs-identifier hs-var">tycl_ds</span></a></span><span>
</span><span id="line-1512"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LStandaloneKindSig GhcRn]
</span><a href="#local-6989586621683062554"><span class="hs-identifier hs-var">kisigs</span></a></span><span>
</span><span id="line-1513"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcRn]
</span><a href="#local-6989586621683062552"><span class="hs-identifier hs-var">roles</span></a></span><span>
</span><span id="line-1514"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl GhcRn]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LInstDecl GhcRn]
</span><a href="#local-6989586621683062556"><span class="hs-identifier hs-var">inst_ds</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1515"></span><span>
</span><span id="line-1516"></span><span class="annot"><span class="hs-comment">-- | Free variables of standalone kind signatures.</span></span><span>
</span><span id="line-1517"></span><span class="hs-keyword">newtype</span><span> </span><span id="KindSig_FV_Env"><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-var">KindSig_FV_Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KindSig_FV_Env"><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-var">KindSig_FV_Env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1518"></span><span>
</span><span id="line-1519"></span><span class="annot"><a href="GHC.Rename.Module.html#lookupKindSig_FV_Env"><span class="hs-identifier hs-type">lookupKindSig_FV_Env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-type">KindSig_FV_Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span>
</span><span id="line-1520"></span><span id="lookupKindSig_FV_Env"><span class="annot"><span class="annottext">lookupKindSig_FV_Env :: KindSig_FV_Env -&gt; Name -&gt; FreeVars
</span><a href="GHC.Rename.Module.html#lookupKindSig_FV_Env"><span class="hs-identifier hs-var hs-var">lookupKindSig_FV_Env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-type">KindSig_FV_Env</span></a></span><span> </span><span id="local-6989586621683062559"><span class="annot"><span class="annottext">NameEnv FreeVars
</span><a href="#local-6989586621683062559"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683062560"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062560"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-1521"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Maybe FreeVars -&gt; FreeVars
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameEnv FreeVars -&gt; Name -&gt; Maybe FreeVars
forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv FreeVars
</span><a href="#local-6989586621683062559"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062560"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1522"></span><span>
</span><span id="line-1523"></span><span class="annot"><span class="hs-comment">-- | Standalone kind signatures.</span></span><span>
</span><span id="line-1524"></span><span class="hs-keyword">type</span><span> </span><span id="KindSigEnv"><span class="annot"><a href="GHC.Rename.Module.html#KindSigEnv"><span class="hs-identifier hs-var">KindSigEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span class="annot"><a href="GHC.Rename.Module.html#mkKindSig_fv_env"><span class="hs-identifier hs-type">mkKindSig_fv_env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#KindSigEnv"><span class="hs-identifier hs-type">KindSigEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-type">KindSig_FV_Env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1527"></span><span id="mkKindSig_fv_env"><span class="annot"><span class="annottext">mkKindSig_fv_env :: [(LStandaloneKindSig GhcRn, FreeVars)]
-&gt; (KindSigEnv, KindSig_FV_Env)
</span><a href="GHC.Rename.Module.html#mkKindSig_fv_env"><span class="hs-identifier hs-var hs-var">mkKindSig_fv_env</span></a></span></span><span> </span><span id="local-6989586621683062562"><span class="annot"><span class="annottext">[(LStandaloneKindSig GhcRn, FreeVars)]
</span><a href="#local-6989586621683062562"><span class="hs-identifier hs-var">kisigs_w_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KindSigEnv
NameEnv (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
</span><a href="#local-6989586621683062563"><span class="hs-identifier hs-var">kisig_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KindSig_FV_Env
</span><a href="#local-6989586621683062564"><span class="hs-identifier hs-var">kisig_fv_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1528"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1529"></span><span>    </span><span id="local-6989586621683062563"><span class="annot"><span class="annottext">kisig_env :: NameEnv (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
</span><a href="#local-6989586621683062563"><span class="hs-identifier hs-var hs-var">kisig_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
 -&gt; GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
-&gt; NameEnv
     (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; NameEnv (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
forall elt1 elt2. (elt1 -&gt; elt2) -&gt; NameEnv elt1 -&gt; NameEnv elt2
</span><a href="GHC.Types.Name.Env.html#mapNameEnv"><span class="hs-identifier hs-var">mapNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">NameEnv (LStandaloneKindSig GhcRn, FreeVars)
NameEnv
  (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
</span><a href="#local-6989586621683062566"><span class="hs-identifier hs-var">compound_env</span></a></span><span>
</span><span id="line-1530"></span><span>    </span><span id="local-6989586621683062564"><span class="annot"><span class="annottext">kisig_fv_env :: KindSig_FV_Env
</span><a href="#local-6989586621683062564"><span class="hs-identifier hs-var hs-var">kisig_fv_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameEnv FreeVars -&gt; KindSig_FV_Env
</span><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-var">KindSig_FV_Env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
 -&gt; FreeVars)
-&gt; NameEnv
     (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; NameEnv FreeVars
forall elt1 elt2. (elt1 -&gt; elt2) -&gt; NameEnv elt1 -&gt; NameEnv elt2
</span><a href="GHC.Types.Name.Env.html#mapNameEnv"><span class="hs-identifier hs-var">mapNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; FreeVars
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">NameEnv (LStandaloneKindSig GhcRn, FreeVars)
NameEnv
  (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
</span><a href="#local-6989586621683062566"><span class="hs-identifier hs-var">compound_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1531"></span><span>    </span><span id="local-6989586621683062566"><span class="annot"><span class="annottext">NameEnv (LStandaloneKindSig GhcRn, FreeVars)
</span><a href="#local-6989586621683062566"><span class="hs-identifier hs-var">compound_env</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
 -&gt; Name)
-&gt; [(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)]
-&gt; NameEnv
     (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
forall a. (a -&gt; Name) -&gt; [a] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#mkNameEnvWith"><span class="hs-identifier hs-var">mkNameEnvWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StandaloneKindSig GhcRn -&gt; IdP GhcRn
StandaloneKindSig GhcRn -&gt; Name
forall (p :: Pass).
StandaloneKindSig (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#standaloneKindSigName"><span class="hs-identifier hs-var">standaloneKindSigName</span></a></span><span> </span><span class="annot"><span class="annottext">(StandaloneKindSig GhcRn -&gt; Name)
-&gt; ((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
    -&gt; StandaloneKindSig GhcRn)
-&gt; (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)
-&gt; StandaloneKindSig GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)
 -&gt; StandaloneKindSig GhcRn)
-&gt; ((GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
    -&gt; GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
-&gt; (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; StandaloneKindSig GhcRn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
-&gt; GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LStandaloneKindSig GhcRn, FreeVars)]
[(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)]
</span><a href="#local-6989586621683062562"><span class="hs-identifier hs-var">kisigs_w_fvs</span></a></span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="annot"><a href="GHC.Rename.Module.html#getKindSigs"><span class="hs-identifier hs-type">getKindSigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#KindSigEnv"><span class="hs-identifier hs-type">KindSigEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1535"></span><span id="getKindSigs"><span class="annot"><span class="annottext">getKindSigs :: [Name] -&gt; KindSigEnv -&gt; [LStandaloneKindSig GhcRn]
</span><a href="GHC.Rename.Module.html#getKindSigs"><span class="hs-identifier hs-var hs-var">getKindSigs</span></a></span></span><span> </span><span id="local-6989586621683062569"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062569"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621683062570"><span class="annot"><span class="annottext">KindSigEnv
</span><a href="#local-6989586621683062570"><span class="hs-identifier hs-var">kisig_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)))
-&gt; [Name] -&gt; [GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameEnv (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
-&gt; Name -&gt; Maybe (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">KindSigEnv
NameEnv (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn))
</span><a href="#local-6989586621683062570"><span class="hs-identifier hs-var">kisig_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062569"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-1536"></span><span>
</span><span id="line-1537"></span><span class="annot"><a href="GHC.Rename.Module.html#rnStandaloneKindSignatures"><span class="hs-identifier hs-type">rnStandaloneKindSignatures</span></a></span><span>
</span><span id="line-1538"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>  </span><span class="hs-comment">-- names of types and classes in the current TyClGroup</span><span>
</span><span id="line-1539"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1540"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1541"></span><span id="rnStandaloneKindSignatures"><span class="annot"><span class="annottext">rnStandaloneKindSignatures :: FreeVars
-&gt; [LStandaloneKindSig GhcPs]
-&gt; RnM [(LStandaloneKindSig GhcRn, FreeVars)]
</span><a href="GHC.Rename.Module.html#rnStandaloneKindSignatures"><span class="hs-identifier hs-var hs-var">rnStandaloneKindSignatures</span></a></span></span><span> </span><span id="local-6989586621683062571"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062571"><span class="hs-identifier hs-var">tc_names</span></a></span></span><span> </span><span id="local-6989586621683062572"><span class="annot"><span class="annottext">[LStandaloneKindSig GhcPs]
</span><a href="#local-6989586621683062572"><span class="hs-identifier hs-var">kisigs</span></a></span></span><span>
</span><span id="line-1542"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062573"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)]
</span><a href="#local-6989586621683062573"><span class="hs-identifier hs-var hs-var">no_dups</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062574"><span class="annot"><span class="annottext">[NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))]
</span><a href="#local-6989586621683062574"><span class="hs-identifier hs-var hs-var">dup_kisigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs) -&gt; RdrName)
-&gt; [GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)]
-&gt; ([GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)],
    [NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))])
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDupsOn"><span class="hs-identifier hs-var">removeDupsOn</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs) -&gt; RdrName
GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs) -&gt; IdGhcP 'Parsed
forall {l} {p :: Pass}.
GenLocated l (StandaloneKindSig (GhcPass p)) -&gt; IdGhcP p
</span><a href="#local-6989586621683062575"><span class="hs-identifier hs-var">get_name</span></a></span><span> </span><span class="annot"><span class="annottext">[LStandaloneKindSig GhcPs]
[GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)]
</span><a href="#local-6989586621683062572"><span class="hs-identifier hs-var">kisigs</span></a></span><span>
</span><span id="line-1543"></span><span>             </span><span id="local-6989586621683062575"><span class="annot"><span class="annottext">get_name :: GenLocated l (StandaloneKindSig (GhcPass p)) -&gt; IdGhcP p
</span><a href="#local-6989586621683062575"><span class="hs-identifier hs-var hs-var hs-var">get_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StandaloneKindSig (GhcPass p) -&gt; IdP (GhcPass p)
StandaloneKindSig (GhcPass p) -&gt; IdGhcP p
forall (p :: Pass).
StandaloneKindSig (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#standaloneKindSigName"><span class="hs-identifier hs-var">standaloneKindSigName</span></a></span><span> </span><span class="annot"><span class="annottext">(StandaloneKindSig (GhcPass p) -&gt; IdGhcP p)
-&gt; (GenLocated l (StandaloneKindSig (GhcPass p))
    -&gt; StandaloneKindSig (GhcPass p))
-&gt; GenLocated l (StandaloneKindSig (GhcPass p))
-&gt; IdGhcP p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated l (StandaloneKindSig (GhcPass p))
-&gt; StandaloneKindSig (GhcPass p)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span>
</span><span id="line-1544"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))
 -&gt; TcRn ())
-&gt; [NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))]
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LStandaloneKindSig GhcPs) -&gt; TcRn ()
NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))
-&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#dupKindSig_Err"><span class="hs-identifier hs-var">dupKindSig_Err</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty (GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs))]
</span><a href="#local-6989586621683062574"><span class="hs-identifier hs-var">dup_kisigs</span></a></span><span>
</span><span id="line-1545"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars))
-&gt; [GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StandaloneKindSig GhcPs
 -&gt; TcM (StandaloneKindSig GhcRn, FreeVars))
-&gt; GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (StandaloneKindSig GhcRn), FreeVars)
forall a b c ann.
(a -&gt; TcM (b, c))
-&gt; GenLocated (EpAnn ann) a -&gt; TcM (GenLocated (EpAnn ann) b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-var">wrapLocFstMA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars
-&gt; StandaloneKindSig GhcPs
-&gt; TcM (StandaloneKindSig GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnStandaloneKindSignature"><span class="hs-identifier hs-var">rnStandaloneKindSignature</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062571"><span class="hs-identifier hs-var">tc_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (StandaloneKindSig GhcPs)]
</span><a href="#local-6989586621683062573"><span class="hs-identifier hs-var">no_dups</span></a></span><span>
</span><span id="line-1546"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1547"></span><span>
</span><span id="line-1548"></span><span class="annot"><a href="GHC.Rename.Module.html#rnStandaloneKindSignature"><span class="hs-identifier hs-type">rnStandaloneKindSignature</span></a></span><span>
</span><span id="line-1549"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>  </span><span class="hs-comment">-- names of types and classes in the current TyClGroup</span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#StandaloneKindSig"><span class="hs-identifier hs-type">StandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-1551"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#StandaloneKindSig"><span class="hs-identifier hs-type">StandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1552"></span><span id="rnStandaloneKindSignature"><span class="annot"><span class="annottext">rnStandaloneKindSignature :: FreeVars
-&gt; StandaloneKindSig GhcPs
-&gt; TcM (StandaloneKindSig GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnStandaloneKindSignature"><span class="hs-identifier hs-var hs-var">rnStandaloneKindSignature</span></a></span></span><span> </span><span id="local-6989586621683062578"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062578"><span class="hs-identifier hs-var">tc_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#StandaloneKindSig"><span class="hs-identifier hs-type">StandaloneKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">XStandaloneKindSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062580"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062580"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621683062581"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062581"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062582"><span class="annot"><a href="#local-6989586621683062582"><span class="hs-identifier hs-var">standalone_ki_sig_ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.StandaloneKindSignatures</span></span><span>
</span><span id="line-1554"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="annot"><a href="#local-6989586621683062582"><span class="hs-identifier hs-type">standalone_ki_sig_ok</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnUnexpectedStandaloneKindSig"><span class="hs-identifier hs-type">TcRnUnexpectedStandaloneKindSig</span></a></span><span>
</span><span id="line-1555"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062585"><span class="annot"><a href="#local-6989586621683062585"><span class="hs-identifier hs-var">new_v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html#lookupSigCtxtOccRn"><span class="hs-identifier hs-type">lookupSigCtxtOccRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Env.html#TopSigCtxt"><span class="hs-identifier hs-type">TopSigCtxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062578"><span class="hs-identifier hs-type">tc_names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;standalone kind signature&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062580"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-1556"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062587"><span class="annot"><a href="#local-6989586621683062587"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#StandaloneKindSigCtx"><span class="hs-identifier hs-var">StandaloneKindSigCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062580"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1557"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062589"><span class="annot"><a href="#local-6989586621683062589"><span class="hs-identifier hs-var">new_ki</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062590"><span class="annot"><a href="#local-6989586621683062590"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-type">rnHsSigType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062587"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#KindLevel"><span class="hs-identifier hs-type">KindLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062581"><span class="hs-identifier hs-type">ki</span></a></span><span>
</span><span id="line-1558"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#StandaloneKindSig"><span class="hs-identifier hs-type">StandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062585"><span class="hs-identifier hs-type">new_v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062589"><span class="hs-identifier hs-type">new_ki</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062590"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1559"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span class="annot"><a href="GHC.Rename.Module.html#depAnalTyClDecls"><span class="hs-identifier hs-type">depAnalTyClDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span>
</span><span id="line-1562"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#KindSig_FV_Env"><span class="hs-identifier hs-type">KindSig_FV_Env</span></a></span><span>
</span><span id="line-1563"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1564"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Graph.html#SCC"><span class="hs-identifier hs-type">SCC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1565"></span><span class="hs-comment">-- See Note [Dependency analysis of type, class, and instance decls]</span><span>
</span><span id="line-1566"></span><span id="depAnalTyClDecls"><span class="annot"><span class="annottext">depAnalTyClDecls :: GlobalRdrEnv
-&gt; KindSig_FV_Env
-&gt; [(LTyClDecl GhcRn, FreeVars)]
-&gt; [SCC (LTyClDecl GhcRn)]
</span><a href="GHC.Rename.Module.html#depAnalTyClDecls"><span class="hs-identifier hs-var hs-var">depAnalTyClDecls</span></a></span></span><span> </span><span id="local-6989586621683062592"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062592"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683062593"><span class="annot"><span class="annottext">KindSig_FV_Env
</span><a href="#local-6989586621683062593"><span class="hs-identifier hs-var">kisig_fv_env</span></a></span></span><span> </span><span id="local-6989586621683062594"><span class="annot"><span class="annottext">[(LTyClDecl GhcRn, FreeVars)]
</span><a href="#local-6989586621683062594"><span class="hs-identifier hs-var">ds_w_fvs</span></a></span></span><span>
</span><span id="line-1567"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node Name (GenLocated SrcSpanAnnA (TyClDecl GhcRn))]
-&gt; [SCC (GenLocated SrcSpanAnnA (TyClDecl GhcRn))]
forall key payload.
Uniquable key =&gt;
[Node key payload] -&gt; [SCC payload]
</span><a href="GHC.Data.Graph.Directed.html#stronglyConnCompFromEdgedVerticesUniq"><span class="hs-identifier hs-var">stronglyConnCompFromEdgedVerticesUniq</span></a></span><span> </span><span class="annot"><span class="annottext">[Node Name (LTyClDecl GhcRn)]
[Node Name (GenLocated SrcSpanAnnA (TyClDecl GhcRn))]
</span><a href="#local-6989586621683062595"><span class="hs-identifier hs-var">edges</span></a></span><span>
</span><span id="line-1568"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1569"></span><span>    </span><span class="annot"><a href="#local-6989586621683062595"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Data.Graph.Directed.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1570"></span><span>    </span><span id="local-6989586621683062595"><span class="annot"><span class="annottext">edges :: [Node Name (LTyClDecl GhcRn)]
</span><a href="#local-6989586621683062595"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn)
-&gt; Name
-&gt; [Name]
-&gt; Node Name (GenLocated SrcSpanAnnA (TyClDecl GhcRn))
forall key payload. payload -&gt; key -&gt; [key] -&gt; Node key payload
</span><a href="GHC.Data.Graph.Directed.html#DigraphNode"><span class="hs-identifier hs-var">DigraphNode</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn)
</span><a href="#local-6989586621683062597"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
Name
</span><a href="#local-6989586621683062598"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; [Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Name
</span><a href="GHC.Rename.Module.html#getParent"><span class="hs-identifier hs-var">getParent</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062592"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; [Name]
forall elt. UniqSet elt -&gt; [elt]
</span><a href="GHC.Types.Unique.Set.html#nonDetEltsUniqSet"><span class="hs-identifier hs-var">nonDetEltsUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062601"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062597"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn)
</span><a href="#local-6989586621683062597"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062602"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062602"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(LTyClDecl GhcRn, FreeVars)]
[(GenLocated SrcSpanAnnA (TyClDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062594"><span class="hs-identifier hs-var">ds_w_fvs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1572"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062598"><span class="annot"><span class="annottext">name :: IdP GhcRn
</span><a href="#local-6989586621683062598"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcRn -&gt; IdP GhcRn
forall (p :: Pass).
(Anno (IdGhcP p) ~ SrcSpanAnnN) =&gt;
TyClDecl (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#tcdName"><span class="hs-identifier hs-var">tcdName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn) -&gt; TyClDecl GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (TyClDecl GhcRn)
</span><a href="#local-6989586621683062597"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>                  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062603"><span class="annot"><span class="annottext">kisig_fvs :: FreeVars
</span><a href="#local-6989586621683062603"><span class="hs-identifier hs-var hs-var">kisig_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KindSig_FV_Env -&gt; Name -&gt; FreeVars
</span><a href="GHC.Rename.Module.html#lookupKindSig_FV_Env"><span class="hs-identifier hs-var">lookupKindSig_FV_Env</span></a></span><span> </span><span class="annot"><span class="annottext">KindSig_FV_Env
</span><a href="#local-6989586621683062593"><span class="hs-identifier hs-var">kisig_fv_env</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
Name
</span><a href="#local-6989586621683062598"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1574"></span><span>                  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062601"><span class="annot"><span class="annottext">deps :: FreeVars
</span><a href="#local-6989586621683062601"><span class="hs-identifier hs-var hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062602"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062603"><span class="hs-identifier hs-var">kisig_fvs</span></a></span><span>
</span><span id="line-1575"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-1576"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1577"></span><span>            </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here as</span><span>
</span><span id="line-1578"></span><span>            </span><span class="hs-comment">-- stronglyConnCompFromEdgedVertices is still deterministic</span><span>
</span><span id="line-1579"></span><span>            </span><span class="hs-comment">-- even if the edges are in nondeterministic order as explained</span><span>
</span><span id="line-1580"></span><span>            </span><span class="hs-comment">-- in Note [Deterministic SCC] in GHC.Data.Graph.Directed.</span><span>
</span><span id="line-1581"></span><span>
</span><span id="line-1582"></span><span class="annot"><a href="GHC.Rename.Module.html#toParents"><span class="hs-identifier hs-type">toParents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1583"></span><span id="toParents"><span class="annot"><span class="annottext">toParents :: GlobalRdrEnv -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Rename.Module.html#toParents"><span class="hs-identifier hs-var hs-var">toParents</span></a></span></span><span> </span><span id="local-6989586621683062605"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062605"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683062606"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062606"><span class="hs-identifier hs-var">ns</span></a></span></span><span>
</span><span id="line-1584"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; FreeVars -&gt; FreeVars) -&gt; FreeVars -&gt; FreeVars -&gt; FreeVars
forall elt a. (elt -&gt; a -&gt; a) -&gt; a -&gt; UniqSet elt -&gt; a
</span><a href="GHC.Types.Unique.Set.html#nonDetStrictFoldUniqSet"><span class="hs-identifier hs-var">nonDetStrictFoldUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars -&gt; FreeVars
</span><a href="#local-6989586621683062608"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062606"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-1585"></span><span>  </span><span class="hs-comment">-- It's OK to use a non-deterministic fold because we immediately forget the</span><span>
</span><span id="line-1586"></span><span>  </span><span class="hs-comment">-- ordering by creating a set</span><span>
</span><span id="line-1587"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1588"></span><span>    </span><span id="local-6989586621683062608"><span class="annot"><span class="annottext">add :: Name -&gt; FreeVars -&gt; FreeVars
</span><a href="#local-6989586621683062608"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621683062609"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062609"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683062610"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062610"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#extendNameSet"><span class="hs-identifier hs-var">extendNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062610"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Name
</span><a href="GHC.Rename.Module.html#getParent"><span class="hs-identifier hs-var">getParent</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062605"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062609"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span class="annot"><a href="GHC.Rename.Module.html#getParent"><span class="hs-identifier hs-type">getParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-1591"></span><span id="getParent"><span class="annot"><span class="annottext">getParent :: GlobalRdrEnv -&gt; Name -&gt; Name
</span><a href="GHC.Rename.Module.html#getParent"><span class="hs-identifier hs-var hs-var">getParent</span></a></span></span><span> </span><span id="local-6989586621683062612"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062612"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683062613"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062613"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1592"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe (GlobalRdrEltX GREInfo)
forall info.
Outputable info =&gt;
GlobalRdrEnvX info -&gt; Name -&gt; Maybe (GlobalRdrEltX info)
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062612"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062613"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1593"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062615"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683062615"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Parent
forall info. GlobalRdrEltX info -&gt; Parent
</span><a href="GHC.Types.Name.Reader.html#greParent"><span class="hs-identifier hs-var">greParent</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683062615"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1594"></span><span>                    </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ParentIs"><span class="hs-identifier hs-type">ParentIs</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">par_is :: Parent -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#par_is"><span class="hs-identifier hs-var">par_is</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062619"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062619"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062619"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1595"></span><span>                    </span><span class="annot"><span class="annottext">Parent
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062613"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1596"></span><span>      </span><span class="annot"><span class="annottext">Maybe (GlobalRdrEltX GREInfo)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683062613"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1597"></span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="annot"><span class="hs-comment">{- ******************************************************
*                                                       *
       Role annotations
*                                                       *
****************************************************** -}</span></span><span>
</span><span id="line-1604"></span><span>
</span><span id="line-1605"></span><span class="hs-comment">-- | Renames role annotations, returning them as the values in a NameEnv</span><span>
</span><span id="line-1606"></span><span class="hs-comment">-- and checks for duplicate role annotations.</span><span>
</span><span id="line-1607"></span><span class="hs-comment">-- It is quite convenient to do both of these in the same place.</span><span>
</span><span id="line-1608"></span><span class="hs-comment">-- See also Note [Role annotations in the renamer]</span><span>
</span><span id="line-1609"></span><span class="annot"><a href="GHC.Rename.Module.html#rnRoleAnnots"><span class="hs-identifier hs-type">rnRoleAnnots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1610"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRoleAnnotDecl"><span class="hs-identifier hs-type">LRoleAnnotDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1611"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRoleAnnotDecl"><span class="hs-identifier hs-type">LRoleAnnotDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1612"></span><span id="rnRoleAnnots"><span class="annot"><span class="annottext">rnRoleAnnots :: FreeVars -&gt; [LRoleAnnotDecl GhcPs] -&gt; RnM [LRoleAnnotDecl GhcRn]
</span><a href="GHC.Rename.Module.html#rnRoleAnnots"><span class="hs-identifier hs-var hs-var">rnRoleAnnots</span></a></span></span><span> </span><span id="local-6989586621683062620"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062620"><span class="hs-identifier hs-var">tc_names</span></a></span></span><span> </span><span id="local-6989586621683062621"><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcPs]
</span><a href="#local-6989586621683062621"><span class="hs-identifier hs-var">role_annots</span></a></span></span><span>
</span><span id="line-1613"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- Check for duplicates *before* renaming, to avoid</span><span>
</span><span id="line-1614"></span><span>          </span><span class="hs-comment">-- lumping together all the unboundNames</span><span>
</span><span id="line-1615"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062622"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)]
</span><a href="#local-6989586621683062622"><span class="hs-identifier hs-var hs-var">no_dups</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062623"><span class="annot"><span class="annottext">[NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs))]
</span><a href="#local-6989586621683062623"><span class="hs-identifier hs-var hs-var">dup_annots</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs) -&gt; RdrName)
-&gt; [GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)]
-&gt; ([GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)],
    [NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs))])
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDupsOn"><span class="hs-identifier hs-var">removeDupsOn</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs) -&gt; RdrName
GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs) -&gt; IdGhcP 'Parsed
forall {l} {p :: Pass}.
GenLocated l (RoleAnnotDecl (GhcPass p)) -&gt; IdGhcP p
</span><a href="#local-6989586621683062624"><span class="hs-identifier hs-var">get_name</span></a></span><span> </span><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcPs]
[GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)]
</span><a href="#local-6989586621683062621"><span class="hs-identifier hs-var">role_annots</span></a></span><span>
</span><span id="line-1616"></span><span>             </span><span id="local-6989586621683062624"><span class="annot"><span class="annottext">get_name :: GenLocated l (RoleAnnotDecl (GhcPass p)) -&gt; IdGhcP p
</span><a href="#local-6989586621683062624"><span class="hs-identifier hs-var hs-var hs-var">get_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RoleAnnotDecl (GhcPass p) -&gt; IdP (GhcPass p)
RoleAnnotDecl (GhcPass p) -&gt; IdGhcP p
forall (p :: Pass). RoleAnnotDecl (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.Decls.html#roleAnnotDeclName"><span class="hs-identifier hs-var">roleAnnotDeclName</span></a></span><span> </span><span class="annot"><span class="annottext">(RoleAnnotDecl (GhcPass p) -&gt; IdGhcP p)
-&gt; (GenLocated l (RoleAnnotDecl (GhcPass p))
    -&gt; RoleAnnotDecl (GhcPass p))
-&gt; GenLocated l (RoleAnnotDecl (GhcPass p))
-&gt; IdGhcP p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated l (RoleAnnotDecl (GhcPass p))
-&gt; RoleAnnotDecl (GhcPass p)
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span>
</span><span id="line-1617"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs))
 -&gt; TcRn ())
-&gt; [NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs))]
-&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LRoleAnnotDecl GhcPs) -&gt; TcRn ()
NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)) -&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#dupRoleAnnotErr"><span class="hs-identifier hs-var">dupRoleAnnotErr</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs))]
</span><a href="#local-6989586621683062623"><span class="hs-identifier hs-var">dup_annots</span></a></span><span>
</span><span id="line-1618"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcRn)))
-&gt; [GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [GenLocated SrcSpanAnnA (RoleAnnotDecl GhcRn)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RoleAnnotDecl GhcPs -&gt; TcM (RoleAnnotDecl GhcRn))
-&gt; GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (RoleAnnotDecl GhcRn))
forall a b ann.
(a -&gt; TcM b)
-&gt; GenLocated (EpAnn ann) a -&gt; TcRn (GenLocated (EpAnn ann) b)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocMA"><span class="hs-identifier hs-var">wrapLocMA</span></a></span><span> </span><span class="annot"><span class="annottext">RoleAnnotDecl GhcPs -&gt; TcM (RoleAnnotDecl GhcRn)
</span><a href="#local-6989586621683062628"><span class="hs-identifier hs-var">rn_role_annot1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (RoleAnnotDecl GhcPs)]
</span><a href="#local-6989586621683062622"><span class="hs-identifier hs-var">no_dups</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1619"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1620"></span><span>    </span><span id="local-6989586621683062628"><span class="annot"><span class="annottext">rn_role_annot1 :: RoleAnnotDecl GhcPs -&gt; TcM (RoleAnnotDecl GhcRn)
</span><a href="#local-6989586621683062628"><span class="hs-identifier hs-var hs-var">rn_role_annot1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RoleAnnotDecl"><span class="hs-identifier hs-type">RoleAnnotDecl</span></a></span><span> </span><span class="annot"><span class="annottext">XCRoleAnnotDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062630"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062630"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621683062631"><span class="annot"><span class="annottext">[XRec GhcPs (Maybe Role)]
</span><a href="#local-6989586621683062631"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1621"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>  </span><span class="hs-comment">-- the name is an *occurrence*, but look it up only in the</span><span>
</span><span id="line-1622"></span><span>              </span><span class="hs-comment">-- decls defined in this group (see #10263)</span><span>
</span><span id="line-1623"></span><span>             </span><span id="local-6989586621683062632"><span class="annot"><a href="#local-6989586621683062632"><span class="hs-identifier hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsSigCtxt
-&gt; SDoc
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
forall ann.
HsSigCtxt
-&gt; SDoc
-&gt; GenLocated (EpAnn ann) RdrName
-&gt; RnM (GenLocated (EpAnn ann) Name)
</span><a href="GHC.Rename.Env.html#lookupSigCtxtOccRn"><span class="hs-identifier hs-var">lookupSigCtxtOccRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeVars -&gt; HsSigCtxt
</span><a href="GHC.Rename.Env.html#RoleAnnotCtxt"><span class="hs-identifier hs-var">RoleAnnotCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062620"><span class="hs-identifier hs-var">tc_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;role annotation&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>                                          </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062630"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1626"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RoleAnnotDecl"><span class="hs-identifier hs-type">RoleAnnotDecl</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062632"><span class="hs-identifier hs-type">tycon'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062631"><span class="hs-identifier hs-type">roles</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span class="annot"><a href="GHC.Rename.Module.html#dupRoleAnnotErr"><span class="hs-identifier hs-type">dupRoleAnnotErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRoleAnnotDecl"><span class="hs-identifier hs-type">LRoleAnnotDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1629"></span><span id="dupRoleAnnotErr"><span class="annot"><span class="annottext">dupRoleAnnotErr :: NonEmpty (LRoleAnnotDecl GhcPs) -&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#dupRoleAnnotErr"><span class="hs-identifier hs-var hs-var">dupRoleAnnotErr</span></a></span></span><span> </span><span id="local-6989586621683062634"><span class="annot"><span class="annottext">list :: NonEmpty (LRoleAnnotDecl GhcPs)
</span><a href="#local-6989586621683062634"><span class="hs-identifier hs-var">list</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062635"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062635"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">RoleAnnotDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[LRoleAnnotDecl GhcPs]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062635"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (LRoleAnnotDecl GhcPs) -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDuplicateRoleAnnot"><span class="hs-identifier hs-var">TcRnDuplicateRoleAnnot</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LRoleAnnotDecl GhcPs)
</span><a href="#local-6989586621683062634"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span class="annot"><a href="GHC.Rename.Module.html#dupKindSig_Err"><span class="hs-identifier hs-type">dupKindSig_Err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1633"></span><span id="dupKindSig_Err"><span class="annot"><span class="annottext">dupKindSig_Err :: NonEmpty (LStandaloneKindSig GhcPs) -&gt; TcRn ()
</span><a href="GHC.Rename.Module.html#dupKindSig_Err"><span class="hs-identifier hs-var hs-var">dupKindSig_Err</span></a></span></span><span> </span><span id="local-6989586621683062637"><span class="annot"><span class="annottext">list :: NonEmpty (LStandaloneKindSig GhcPs)
</span><a href="#local-6989586621683062637"><span class="hs-identifier hs-var">list</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062638"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062638"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">StandaloneKindSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[LStandaloneKindSig GhcPs]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683062638"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (LStandaloneKindSig GhcPs) -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDuplicateKindSig"><span class="hs-identifier hs-var">TcRnDuplicateKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LStandaloneKindSig GhcPs)
</span><a href="#local-6989586621683062637"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1635"></span><span>
</span><span id="line-1636"></span><span class="hs-comment">{- Note [Role annotations in the renamer]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We must ensure that a type's role annotation is put in the same group as the
proper type declaration. This is because role annotations are needed during
type-checking when creating the type's TyCon. So, rnRoleAnnots builds a
NameEnv (LRoleAnnotDecl Name) that maps a name to a role annotation for that
type, if any. Then, this map can be used to add the role annotations to the
groups after dependency analysis.

This process checks for duplicate role annotations, where we must be careful
to do the check *before* renaming to avoid calling all unbound names duplicates
of one another.

The renaming process, as usual, might identify and report errors for unbound
names. This is done by using lookupSigCtxtOccRn in rnRoleAnnots (using
lookupGlobalOccRn led to #8485).
-}</span><span>
</span><span id="line-1653"></span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="annot"><span class="hs-comment">{- ******************************************************
*                                                       *
       Dependency info for instances
*                                                       *
****************************************************** -}</span></span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span class="hs-comment">----------------------------------------------------------</span><span>
</span><span id="line-1662"></span><span class="hs-comment">-- | 'InstDeclFreeVarsMap is an association of an</span><span>
</span><span id="line-1663"></span><span class="hs-comment">--   @InstDecl@ with @FreeVars@. The @FreeVars@ are</span><span>
</span><span id="line-1664"></span><span class="hs-comment">--   the tycon names that are both</span><span>
</span><span id="line-1665"></span><span class="hs-comment">--     a) free in the instance declaration</span><span>
</span><span id="line-1666"></span><span class="hs-comment">--     b) bound by this group of type/class/instance decls</span><span>
</span><span id="line-1667"></span><span class="hs-keyword">type</span><span> </span><span id="InstDeclFreeVarsMap"><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-var">InstDeclFreeVarsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1668"></span><span>
</span><span id="line-1669"></span><span class="hs-comment">-- | Construct an @InstDeclFreeVarsMap@ by eliminating any @Name@s from the</span><span>
</span><span id="line-1670"></span><span class="hs-comment">--   @FreeVars@ which are *not* the binders of a @TyClDecl@.</span><span>
</span><span id="line-1671"></span><span class="annot"><a href="GHC.Rename.Module.html#mkInstDeclFreeVarsMap"><span class="hs-identifier hs-type">mkInstDeclFreeVarsMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span>
</span><span id="line-1672"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1673"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1674"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-type">InstDeclFreeVarsMap</span></a></span><span>
</span><span id="line-1675"></span><span id="mkInstDeclFreeVarsMap"><span class="annot"><span class="annottext">mkInstDeclFreeVarsMap :: GlobalRdrEnv
-&gt; FreeVars -&gt; InstDeclFreeVarsMap -&gt; InstDeclFreeVarsMap
</span><a href="GHC.Rename.Module.html#mkInstDeclFreeVarsMap"><span class="hs-identifier hs-var hs-var">mkInstDeclFreeVarsMap</span></a></span></span><span> </span><span id="local-6989586621683062640"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062640"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683062641"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062641"><span class="hs-identifier hs-var">tycl_bndrs</span></a></span></span><span> </span><span id="local-6989586621683062642"><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062642"><span class="hs-identifier hs-var">inst_ds_fvs</span></a></span></span><span>
</span><span id="line-1676"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LInstDecl GhcRn
GenLocated SrcSpanAnnA (InstDecl GhcRn)
</span><a href="#local-6989586621683062643"><span class="hs-identifier hs-var">inst_decl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Rename.Module.html#toParents"><span class="hs-identifier hs-var">toParents</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683062640"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062644"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#intersectFVs"><span class="hs-operator hs-var">`intersectFVs`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062641"><span class="hs-identifier hs-var">tycl_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062643"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (InstDecl GhcRn)
</span><a href="#local-6989586621683062643"><span class="hs-identifier hs-var">inst_decl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062644"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062644"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InstDeclFreeVarsMap
[(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062642"><span class="hs-identifier hs-var">inst_ds_fvs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1678"></span><span>
</span><span id="line-1679"></span><span class="hs-comment">-- | Get the @LInstDecl@s which have empty @FreeVars@ sets, and the</span><span>
</span><span id="line-1680"></span><span class="hs-comment">--   @InstDeclFreeVarsMap@ with these entries removed.</span><span>
</span><span id="line-1681"></span><span class="hs-comment">-- We call (getInsts tcs instd_map) when we've completed the declarations</span><span>
</span><span id="line-1682"></span><span class="hs-comment">-- for 'tcs'.  The call returns (inst_decls, instd_map'), where</span><span>
</span><span id="line-1683"></span><span class="hs-comment">--   inst_decls are the instance declarations all of</span><span>
</span><span id="line-1684"></span><span class="hs-comment">--              whose free vars are now defined</span><span>
</span><span id="line-1685"></span><span class="hs-comment">--   instd_map' is the inst-decl map with 'tcs' removed from</span><span>
</span><span id="line-1686"></span><span class="hs-comment">--               the free-var set</span><span>
</span><span id="line-1687"></span><span class="annot"><a href="GHC.Rename.Module.html#getInsts"><span class="hs-identifier hs-type">getInsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-type">InstDeclFreeVarsMap</span></a></span><span>
</span><span id="line-1688"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#InstDeclFreeVarsMap"><span class="hs-identifier hs-type">InstDeclFreeVarsMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1689"></span><span id="getInsts"><span class="annot"><span class="annottext">getInsts :: [Name]
-&gt; InstDeclFreeVarsMap -&gt; ([LInstDecl GhcRn], InstDeclFreeVarsMap)
</span><a href="GHC.Rename.Module.html#getInsts"><span class="hs-identifier hs-var hs-var">getInsts</span></a></span></span><span> </span><span id="local-6989586621683062646"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062646"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621683062647"><span class="annot"><span class="annottext">InstDeclFreeVarsMap
</span><a href="#local-6989586621683062647"><span class="hs-identifier hs-var">inst_decl_map</span></a></span></span><span>
</span><span id="line-1690"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
 -&gt; Either
      (GenLocated SrcSpanAnnA (InstDecl GhcRn))
      (GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars))
-&gt; [(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
-&gt; ([GenLocated SrcSpanAnnA (InstDecl GhcRn)],
    [(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)])
forall a b c. (a -&gt; Either b c) -&gt; [a] -&gt; ([b], [c])
</span><a href="GHC.Utils.Misc.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(LInstDecl GhcRn, FreeVars)
-&gt; Either (LInstDecl GhcRn) (LInstDecl GhcRn, FreeVars)
(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
-&gt; Either
     (GenLocated SrcSpanAnnA (InstDecl GhcRn))
     (GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
</span><a href="#local-6989586621683062648"><span class="hs-identifier hs-var">pick_me</span></a></span><span> </span><span class="annot"><span class="annottext">InstDeclFreeVarsMap
[(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)]
</span><a href="#local-6989586621683062647"><span class="hs-identifier hs-var">inst_decl_map</span></a></span><span>
</span><span id="line-1691"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1692"></span><span>    </span><span class="annot"><a href="#local-6989586621683062648"><span class="hs-identifier hs-type">pick_me</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1693"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>    </span><span id="local-6989586621683062648"><span class="annot"><span class="annottext">pick_me :: (LInstDecl GhcRn, FreeVars)
-&gt; Either (LInstDecl GhcRn) (LInstDecl GhcRn, FreeVars)
</span><a href="#local-6989586621683062648"><span class="hs-identifier hs-var hs-var">pick_me</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062649"><span class="annot"><span class="annottext">LInstDecl GhcRn
</span><a href="#local-6989586621683062649"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062650"><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062650"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1695"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#isEmptyNameSet"><span class="hs-identifier hs-var">isEmptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062652"><span class="hs-identifier hs-var">depleted_fvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (InstDecl GhcRn)
-&gt; Either
     (GenLocated SrcSpanAnnA (InstDecl GhcRn))
     (GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">LInstDecl GhcRn
GenLocated SrcSpanAnnA (InstDecl GhcRn)
</span><a href="#local-6989586621683062649"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1696"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
-&gt; Either
     (GenLocated SrcSpanAnnA (InstDecl GhcRn))
     (GenLocated SrcSpanAnnA (InstDecl GhcRn), FreeVars)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LInstDecl GhcRn
GenLocated SrcSpanAnnA (InstDecl GhcRn)
</span><a href="#local-6989586621683062649"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062652"><span class="hs-identifier hs-var">depleted_fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1698"></span><span>        </span><span id="local-6989586621683062652"><span class="annot"><span class="annottext">depleted_fvs :: FreeVars
</span><a href="#local-6989586621683062652"><span class="hs-identifier hs-var hs-var">depleted_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#delFVs"><span class="hs-identifier hs-var">delFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683062646"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062650"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1699"></span><span>
</span><span id="line-1700"></span><span class="annot"><span class="hs-comment">{- ******************************************************
*                                                       *
         Renaming a type or class declaration
*                                                       *
****************************************************** -}</span></span><span>
</span><span id="line-1705"></span><span>
</span><span id="line-1706"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-type">rnTyClDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClDecl"><span class="hs-identifier hs-type">TyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-1707"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClDecl"><span class="hs-identifier hs-type">TyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1708"></span><span>
</span><span id="line-1709"></span><span class="hs-comment">-- All flavours of top-level type family declarations (&quot;type family&quot;, &quot;newtype</span><span>
</span><span id="line-1710"></span><span class="hs-comment">-- family&quot;, and &quot;data family&quot;)</span><span>
</span><span id="line-1711"></span><span id="rnTyClDecl"><span class="annot"><span class="annottext">rnTyClDecl :: TyClDecl GhcPs -&gt; TcM (TyClDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-var hs-var">rnTyClDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamDecl"><span class="hs-identifier hs-type">FamDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdFam :: forall pass. TyClDecl pass -&gt; FamilyDecl pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdFam"><span class="hs-identifier hs-var">tcdFam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062656"><span class="annot"><span class="annottext">FamilyDecl GhcPs
</span><a href="#local-6989586621683062656"><span class="hs-identifier hs-var">fam</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062657"><span class="annot"><a href="#local-6989586621683062657"><span class="hs-identifier hs-var">fam'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062658"><span class="annot"><a href="#local-6989586621683062658"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, [Name])
-&gt; FamilyDecl GhcPs -&gt; RnM (FamilyDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamDecl"><span class="hs-identifier hs-var">rnFamDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Name, [Name])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">FamilyDecl GhcPs
</span><a href="#local-6989586621683062656"><span class="hs-identifier hs-var">fam</span></a></span><span>
</span><span id="line-1713"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamDecl"><span class="hs-identifier hs-type">FamDecl</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062657"><span class="hs-identifier hs-type">fam'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062658"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1714"></span><span>
</span><span id="line-1715"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-var">rnTyClDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SynDecl"><span class="hs-identifier hs-type">SynDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdLName :: forall pass. TyClDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062661"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062661"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdTyVars :: forall pass. TyClDecl pass -&gt; LHsQTyVars pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062663"><span class="annot"><span class="annottext">LHsQTyVars GhcPs
</span><a href="#local-6989586621683062663"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1716"></span><span>                      </span><span class="annot"><span class="annottext">tcdFixity :: forall pass. TyClDecl pass -&gt; LexicalFixity
</span><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062665"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621683062665"><span class="hs-identifier hs-var">fixity</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdRhs :: forall pass. TyClDecl pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdRhs"><span class="hs-identifier hs-var">tcdRhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062667"><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062667"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1717"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062668"><span class="annot"><a href="#local-6989586621683062668"><span class="hs-identifier hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062661"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1718"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062669"><span class="annot"><a href="#local-6989586621683062669"><span class="hs-identifier hs-var hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractHsTyRdrTyVarsKindVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVarsKindVars</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062667"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1719"></span><span>             </span><span id="local-6989586621683062671"><span class="annot"><a href="#local-6989586621683062671"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#TySynCtx"><span class="hs-identifier hs-var">TySynCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062661"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1720"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rntycl-ty&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062661"><span class="hs-identifier hs-type">tycon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062669"><span class="hs-identifier hs-type">kvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1721"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsQTyVars"><span class="hs-identifier hs-type">bindHsQTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062671"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683062669"><span class="hs-identifier hs-type">kvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062663"><span class="hs-identifier hs-type">tyvars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062673"><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062673"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span> </span><span id="local-6989586621683062674"><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062674"><span class="hs-identifier hs-var">free_rhs_kvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1722"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName -&gt; TcRn ())
-&gt; FreeKiTyVars -&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; TcRn ()
</span><a href="#local-6989586621683062675"><span class="hs-identifier hs-var">warn_implicit_kvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreeKiTyVars -&gt; FreeKiTyVars
forall a l. Eq a =&gt; [GenLocated l a] -&gt; [GenLocated l a]
</span><a href="GHC.Rename.HsType.html#nubL"><span class="hs-identifier hs-var">nubL</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062674"><span class="hs-identifier hs-var">free_rhs_kvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062677"><span class="annot"><a href="#local-6989586621683062677"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062678"><span class="annot"><a href="#local-6989586621683062678"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTySyn"><span class="hs-identifier hs-var">rnTySyn</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062671"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062667"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1724"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SynDecl"><span class="hs-identifier hs-type">SynDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062668"><span class="hs-identifier hs-type">tycon'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062673"><span class="hs-identifier hs-type">tyvars'</span></a></span><span>
</span><span id="line-1725"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062665"><span class="hs-identifier hs-type">fixity</span></a></span><span>
</span><span id="line-1726"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdRhs"><span class="hs-identifier hs-var">tcdRhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062677"><span class="hs-identifier hs-type">rhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdSExt"><span class="hs-identifier hs-var">tcdSExt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062678"><span class="hs-identifier hs-type">fvs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062678"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1727"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1728"></span><span>    </span><span class="annot"><a href="#local-6989586621683062675"><span class="hs-identifier hs-type">warn_implicit_kvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1729"></span><span>    </span><span id="local-6989586621683062675"><span class="annot"><span class="annottext">warn_implicit_kvs :: GenLocated SrcSpanAnnN RdrName -&gt; TcRn ()
</span><a href="#local-6989586621683062675"><span class="hs-identifier hs-var hs-var">warn_implicit_kvs</span></a></span></span><span> </span><span id="local-6989586621683062680"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062680"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1730"></span><span>      </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addDiagnosticAt"><span class="hs-identifier hs-var">addDiagnosticAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062680"><span class="hs-identifier hs-var">kv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnImplicitRhsQuantification"><span class="hs-identifier hs-var">TcRnImplicitRhsQuantification</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062680"><span class="hs-identifier hs-var">kv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>
</span><span id="line-1732"></span><span class="hs-comment">-- &quot;data&quot;, &quot;newtype&quot; declarations</span><span>
</span><span id="line-1733"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-var">rnTyClDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataDecl"><span class="hs-identifier hs-type">DataDecl</span></a></span><span>
</span><span id="line-1734"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdLName :: forall pass. TyClDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062684"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062684"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdTyVars :: forall pass. TyClDecl pass -&gt; LHsQTyVars pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062685"><span class="annot"><span class="annottext">LHsQTyVars GhcPs
</span><a href="#local-6989586621683062685"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1735"></span><span>      </span><span class="annot"><span class="annottext">tcdFixity :: forall pass. TyClDecl pass -&gt; LexicalFixity
</span><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062686"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621683062686"><span class="hs-identifier hs-var">fixity</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1736"></span><span>      </span><span class="annot"><span class="annottext">tcdDataDefn :: forall pass. TyClDecl pass -&gt; HsDataDefn pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdDataDefn"><span class="hs-identifier hs-var">tcdDataDefn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062688"><span class="annot"><span class="annottext">defn :: HsDataDefn GhcPs
</span><a href="#local-6989586621683062688"><span class="hs-identifier hs-var">defn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dd_cons :: forall pass. HsDataDefn pass -&gt; DataDefnCons (LConDecl pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_cons"><span class="hs-identifier hs-var">dd_cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062691"><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
</span><a href="#local-6989586621683062691"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dd_kindSig :: forall pass. HsDataDefn pass -&gt; Maybe (LHsKind pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_kindSig"><span class="hs-identifier hs-var">dd_kindSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062693"><span class="annot"><span class="annottext">Maybe (LHsType GhcPs)
</span><a href="#local-6989586621683062693"><span class="hs-identifier hs-var">kind_sig</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062694"><span class="annot"><a href="#local-6989586621683062694"><span class="hs-identifier hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062684"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1738"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062695"><span class="annot"><a href="#local-6989586621683062695"><span class="hs-identifier hs-var hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractDataDefnKindVars"><span class="hs-identifier hs-var">extractDataDefnKindVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621683062688"><span class="hs-identifier hs-var">defn</span></a></span><span>
</span><span id="line-1739"></span><span>             </span><span id="local-6989586621683062697"><span class="annot"><a href="#local-6989586621683062697"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#TyDataCtx"><span class="hs-identifier hs-var">TyDataCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062684"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1740"></span><span>             </span><span id="local-6989586621683062698"><span class="annot"><a href="#local-6989586621683062698"><span class="hs-identifier hs-var hs-var">new_or_data</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs)) -&gt; NewOrData
forall a. DataDefnCons a -&gt; NewOrData
</span><a href="Language.Haskell.Syntax.Decls.html#dataDefnConsNewOrData"><span class="hs-identifier hs-var">dataDefnConsNewOrData</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs))
</span><a href="#local-6989586621683062691"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-1741"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rntycl-data&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062684"><span class="hs-identifier hs-type">tycon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062695"><span class="hs-identifier hs-type">kvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsQTyVars"><span class="hs-identifier hs-type">bindHsQTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062697"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683062695"><span class="hs-identifier hs-type">kvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062685"><span class="hs-identifier hs-type">tyvars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062700"><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062700"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span> </span><span id="local-6989586621683062701"><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683062701"><span class="hs-identifier hs-var">free_rhs_kvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1743"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062702"><span class="annot"><a href="#local-6989586621683062702"><span class="hs-identifier hs-var">defn'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062703"><span class="annot"><a href="#local-6989586621683062703"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsDataDefn GhcPs -&gt; RnM (HsDataDefn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDataDefn"><span class="hs-identifier hs-var">rnDataDefn</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062697"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621683062688"><span class="hs-identifier hs-var">defn</span></a></span><span>
</span><span id="line-1744"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062704"><span class="annot"><a href="#local-6989586621683062704"><span class="hs-identifier hs-var">cusk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#data_decl_has_cusk"><span class="hs-identifier hs-type">data_decl_has_cusk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062700"><span class="hs-identifier hs-type">tyvars'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062698"><span class="hs-identifier hs-type">new_or_data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683062701"><span class="hs-identifier hs-type">free_rhs_kvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062693"><span class="hs-identifier hs-type">kind_sig</span></a></span><span>
</span><span id="line-1745"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062706"><span class="annot"><a href="#local-6989586621683062706"><span class="hs-identifier hs-var hs-var">rn_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Decls.html#DataDeclRn"><span class="hs-identifier hs-type">DataDeclRn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdDataCusk :: Bool
</span><a href="GHC.Hs.Decls.html#tcdDataCusk"><span class="hs-identifier hs-var">tcdDataCusk</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062704"><span class="hs-identifier hs-var">cusk</span></a></span><span>
</span><span id="line-1746"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdFVs :: FreeVars
</span><a href="GHC.Hs.Decls.html#tcdFVs"><span class="hs-identifier hs-var">tcdFVs</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062703"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1747"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rndata&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062684"><span class="hs-identifier hs-type">tycon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062704"><span class="hs-identifier hs-type">cusk</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062701"><span class="hs-identifier hs-type">free_rhs_kvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1748"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataDecl"><span class="hs-identifier hs-type">DataDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062694"><span class="hs-identifier hs-type">tycon'</span></a></span><span>
</span><span id="line-1749"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062700"><span class="hs-identifier hs-type">tyvars'</span></a></span><span>
</span><span id="line-1750"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062686"><span class="hs-identifier hs-type">fixity</span></a></span><span>
</span><span id="line-1751"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdDataDefn"><span class="hs-identifier hs-var">tcdDataDefn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062702"><span class="hs-identifier hs-type">defn'</span></a></span><span>
</span><span id="line-1752"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdDExt"><span class="hs-identifier hs-var">tcdDExt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062706"><span class="hs-identifier hs-type">rn_info</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062703"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1753"></span><span>
</span><span id="line-1754"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTyClDecl"><span class="hs-identifier hs-var">rnTyClDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClassDecl"><span class="hs-identifier hs-type">ClassDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdCtxt :: forall pass. TyClDecl pass -&gt; Maybe (LHsContext pass)
</span><a href="Language.Haskell.Syntax.Decls.html#tcdCtxt"><span class="hs-identifier hs-var">tcdCtxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062713"><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683062713"><span class="hs-identifier hs-var">context</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdLName :: forall pass. TyClDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062714"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062714"><span class="hs-identifier hs-var">lcls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1755"></span><span>                        </span><span class="annot"><span class="annottext">tcdTyVars :: forall pass. TyClDecl pass -&gt; LHsQTyVars pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062715"><span class="annot"><span class="annottext">LHsQTyVars GhcPs
</span><a href="#local-6989586621683062715"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdFixity :: forall pass. TyClDecl pass -&gt; LexicalFixity
</span><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062716"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621683062716"><span class="hs-identifier hs-var">fixity</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1756"></span><span>                        </span><span class="annot"><span class="annottext">tcdFDs :: forall pass. TyClDecl pass -&gt; [LHsFunDep pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tcdFDs"><span class="hs-identifier hs-var">tcdFDs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062718"><span class="annot"><span class="annottext">[LHsFunDep GhcPs]
</span><a href="#local-6989586621683062718"><span class="hs-identifier hs-var">fds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdSigs :: forall pass. TyClDecl pass -&gt; [LSig pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tcdSigs"><span class="hs-identifier hs-var">tcdSigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062720"><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621683062720"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1757"></span><span>                        </span><span class="annot"><span class="annottext">tcdMeths :: forall pass. TyClDecl pass -&gt; LHsBinds pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdMeths"><span class="hs-identifier hs-var">tcdMeths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062722"><span class="annot"><span class="annottext">LHsBinds GhcPs
</span><a href="#local-6989586621683062722"><span class="hs-identifier hs-var">mbinds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdATs :: forall pass. TyClDecl pass -&gt; [LFamilyDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tcdATs"><span class="hs-identifier hs-var">tcdATs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062724"><span class="annot"><span class="annottext">[LFamilyDecl GhcPs]
</span><a href="#local-6989586621683062724"><span class="hs-identifier hs-var">ats</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcdATDefs :: forall pass. TyClDecl pass -&gt; [LTyFamDefltDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tcdATDefs"><span class="hs-identifier hs-var">tcdATDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062726"><span class="annot"><span class="annottext">[LTyFamInstDecl GhcPs]
</span><a href="#local-6989586621683062726"><span class="hs-identifier hs-var">at_defs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1758"></span><span>                        </span><span class="annot"><span class="annottext">tcdDocs :: forall pass. TyClDecl pass -&gt; [LDocDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tcdDocs"><span class="hs-identifier hs-var">tcdDocs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062728"><span class="annot"><span class="annottext">[LDocDecl GhcPs]
</span><a href="#local-6989586621683062728"><span class="hs-identifier hs-var">docs</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1759"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062729"><span class="annot"><a href="#local-6989586621683062729"><span class="hs-identifier hs-var">lcls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062714"><span class="hs-identifier hs-var">lcls</span></a></span><span>
</span><span id="line-1760"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062730"><span class="annot"><a href="#local-6989586621683062730"><span class="hs-identifier hs-var hs-var">cls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683062729"><span class="hs-identifier hs-var">lcls'</span></a></span><span>
</span><span id="line-1761"></span><span>              </span><span id="local-6989586621683062731"><span class="annot"><a href="#local-6989586621683062731"><span class="hs-identifier hs-var hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- No scoped kind vars except those in</span><span>
</span><span id="line-1762"></span><span>                        </span><span class="hs-comment">-- kind signatures on the tyvars</span><span>
</span><span id="line-1763"></span><span>
</span><span id="line-1764"></span><span>        </span><span class="hs-comment">-- Tyvars scope over superclass context and method signatures</span><span>
</span><span id="line-1765"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621683062732"><span class="annot"><a href="#local-6989586621683062732"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062733"><span class="annot"><a href="#local-6989586621683062733"><span class="hs-identifier hs-var">context'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062734"><span class="annot"><a href="#local-6989586621683062734"><span class="hs-identifier hs-var">fds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062735"><span class="annot"><a href="#local-6989586621683062735"><span class="hs-identifier hs-var">ats'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062736"><span class="annot"><a href="#local-6989586621683062736"><span class="hs-identifier hs-var">stuff_fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1766"></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsQTyVars"><span class="hs-identifier hs-type">bindHsQTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062737"><span class="hs-identifier hs-type">cls_doc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683062731"><span class="hs-identifier hs-type">kvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062715"><span class="hs-identifier hs-type">tyvars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062738"><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062738"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1767"></span><span>                  </span><span class="hs-comment">-- Checks for distinct tyvars</span><span>
</span><span id="line-1768"></span><span>             </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062739"><span class="annot"><a href="#local-6989586621683062739"><span class="hs-identifier hs-var">context'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062740"><span class="annot"><a href="#local-6989586621683062740"><span class="hs-identifier hs-var">cxt_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe (LHsContext GhcPs)
-&gt; RnM (Maybe (LHsContext GhcRn), FreeVars)
</span><a href="GHC.Rename.HsType.html#rnMaybeContext"><span class="hs-identifier hs-var">rnMaybeContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062737"><span class="hs-identifier hs-var">cls_doc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683062713"><span class="hs-identifier hs-var">context</span></a></span><span>
</span><span id="line-1769"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062742"><span class="annot"><a href="#local-6989586621683062742"><span class="hs-identifier hs-var">fds'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnFds"><span class="hs-identifier hs-type">rnFds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062718"><span class="hs-identifier hs-type">fds</span></a></span><span>
</span><span id="line-1770"></span><span>                         </span><span class="hs-comment">-- The fundeps have no free variables</span><span>
</span><span id="line-1771"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062744"><span class="annot"><a href="#local-6989586621683062744"><span class="hs-identifier hs-var">ats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062745"><span class="annot"><a href="#local-6989586621683062745"><span class="hs-identifier hs-var">fv_ats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnATDecls"><span class="hs-identifier hs-type">rnATDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062730"><span class="hs-identifier hs-type">cls'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Type.html#hsAllLTyVarNames"><span class="hs-identifier hs-type">hsAllLTyVarNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062738"><span class="hs-identifier hs-type">tyvars'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062724"><span class="hs-identifier hs-type">ats</span></a></span><span>
</span><span id="line-1772"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062747"><span class="annot"><a href="#local-6989586621683062747"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062740"><span class="hs-identifier hs-var">cxt_fvs</span></a></span><span>     </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span>
</span><span id="line-1773"></span><span>                         </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062745"><span class="hs-identifier hs-var">fv_ats</span></a></span><span>
</span><span id="line-1774"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062738"><span class="hs-identifier hs-type">tyvars'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062739"><span class="hs-identifier hs-type">context'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062742"><span class="hs-identifier hs-type">fds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062744"><span class="hs-identifier hs-type">ats'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062747"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1775"></span><span>
</span><span id="line-1776"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062748"><span class="annot"><a href="#local-6989586621683062748"><span class="hs-identifier hs-var">at_defs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062749"><span class="annot"><a href="#local-6989586621683062749"><span class="hs-identifier hs-var">fv_at_defs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-type">rnList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#rnTyFamDefltDecl"><span class="hs-identifier hs-type">rnTyFamDefltDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062730"><span class="hs-identifier hs-type">cls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062726"><span class="hs-identifier hs-type">at_defs</span></a></span><span>
</span><span id="line-1777"></span><span>
</span><span id="line-1778"></span><span>        </span><span class="hs-comment">-- No need to check for duplicate associated type decls</span><span>
</span><span id="line-1779"></span><span>        </span><span class="hs-comment">-- since that is done by GHC.Rename.Names.extendGlobalRdrEnvRn</span><span>
</span><span id="line-1780"></span><span>
</span><span id="line-1781"></span><span>        </span><span class="hs-comment">-- Check the signatures</span><span>
</span><span id="line-1782"></span><span>        </span><span class="hs-comment">-- First process the class op sigs (op_sigs), then the fixity sigs (non_op_sigs).</span><span>
</span><span id="line-1783"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062750"><span class="annot"><a href="#local-6989586621683062750"><span class="hs-identifier hs-var hs-var">sig_rdr_names_w_locs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1784"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062751"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ClassOpSig"><span class="hs-identifier hs-type">ClassOpSig</span></a></span><span> </span><span class="annot"><span class="annottext">XClassOpSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621683062753"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683062753"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LSig GhcPs]
[GenLocated SrcSpanAnnA (Sig GhcPs)]
</span><a href="#local-6989586621683062720"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-1785"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062751"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062751"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
FreeKiTyVars
</span><a href="#local-6989586621683062753"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1786"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#checkDupRdrNames"><span class="hs-identifier hs-type">checkDupRdrNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062750"><span class="hs-identifier hs-type">sig_rdr_names_w_locs</span></a></span><span>
</span><span id="line-1787"></span><span>                </span><span class="hs-comment">-- Typechecker is responsible for checking that we only</span><span>
</span><span id="line-1788"></span><span>                </span><span class="hs-comment">-- give default-method bindings for things in this class.</span><span>
</span><span id="line-1789"></span><span>                </span><span class="hs-comment">-- The renamer *could* check this for class decls, but can't</span><span>
</span><span id="line-1790"></span><span>                </span><span class="hs-comment">-- for instance decls.</span><span>
</span><span id="line-1791"></span><span>
</span><span id="line-1792"></span><span>        </span><span class="hs-comment">-- The newLocals call is tiresome: given a generic class decl</span><span>
</span><span id="line-1793"></span><span>        </span><span class="hs-comment">--      class C a where</span><span>
</span><span id="line-1794"></span><span>        </span><span class="hs-comment">--        op :: a -&gt; a</span><span>
</span><span id="line-1795"></span><span>        </span><span class="hs-comment">--        op {| x+y |} (Inl a) = ...</span><span>
</span><span id="line-1796"></span><span>        </span><span class="hs-comment">--        op {| x+y |} (Inr b) = ...</span><span>
</span><span id="line-1797"></span><span>        </span><span class="hs-comment">--        op {| a*b |} (a*b)   = ...</span><span>
</span><span id="line-1798"></span><span>        </span><span class="hs-comment">-- we want to name both &quot;x&quot; tyvars with the same unique, so that they are</span><span>
</span><span id="line-1799"></span><span>        </span><span class="hs-comment">-- easy to group together in the typechecker.</span><span>
</span><span id="line-1800"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062754"><span class="annot"><a href="#local-6989586621683062754"><span class="hs-identifier hs-var">mbinds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062755"><span class="annot"><a href="#local-6989586621683062755"><span class="hs-identifier hs-var">sigs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062756"><span class="annot"><a href="#local-6989586621683062756"><span class="hs-identifier hs-var">meth_fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1801"></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Bind.html#rnMethodBinds"><span class="hs-identifier hs-type">rnMethodBinds</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621683062730"><span class="hs-identifier hs-type">cls'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Type.html#hsAllLTyVarNames"><span class="hs-identifier hs-type">hsAllLTyVarNames</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062732"><span class="hs-identifier hs-type">tyvars'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062722"><span class="hs-identifier hs-type">mbinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062720"><span class="hs-identifier hs-type">sigs</span></a></span><span>
</span><span id="line-1802"></span><span>                </span><span class="hs-comment">-- No need to check for duplicate method signatures</span><span>
</span><span id="line-1803"></span><span>                </span><span class="hs-comment">-- since that is done by GHC.Rename.Names.extendGlobalRdrEnvRn</span><span>
</span><span id="line-1804"></span><span>                </span><span class="hs-comment">-- and the methods are already in scope</span><span>
</span><span id="line-1805"></span><span>
</span><span id="line-1806"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062757"><span class="annot"><a href="#local-6989586621683062757"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062756"><span class="hs-identifier hs-var">meth_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062736"><span class="hs-identifier hs-var">stuff_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062749"><span class="hs-identifier hs-var">fv_at_defs</span></a></span><span>
</span><span id="line-1807"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062758"><span class="annot"><a href="#local-6989586621683062758"><span class="hs-identifier hs-var">docs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLDocDecl"><span class="hs-identifier hs-type">rnLDocDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062728"><span class="hs-identifier hs-type">docs</span></a></span><span>
</span><span id="line-1808"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClassDecl"><span class="hs-identifier hs-type">ClassDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdCtxt"><span class="hs-identifier hs-var">tcdCtxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062733"><span class="hs-identifier hs-type">context'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdLName"><span class="hs-identifier hs-var">tcdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062729"><span class="hs-identifier hs-type">lcls'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1809"></span><span>                              </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdTyVars"><span class="hs-identifier hs-var">tcdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062732"><span class="hs-identifier hs-type">tyvars'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdFixity"><span class="hs-identifier hs-var">tcdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062716"><span class="hs-identifier hs-type">fixity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1810"></span><span>                              </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdFDs"><span class="hs-identifier hs-var">tcdFDs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062734"><span class="hs-identifier hs-type">fds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdSigs"><span class="hs-identifier hs-var">tcdSigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062755"><span class="hs-identifier hs-type">sigs'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1811"></span><span>                              </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdMeths"><span class="hs-identifier hs-var">tcdMeths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062754"><span class="hs-identifier hs-type">mbinds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdATs"><span class="hs-identifier hs-var">tcdATs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062735"><span class="hs-identifier hs-type">ats'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdATDefs"><span class="hs-identifier hs-var">tcdATDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062748"><span class="hs-identifier hs-type">at_defs'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1812"></span><span>                              </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdDocs"><span class="hs-identifier hs-var">tcdDocs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062758"><span class="hs-identifier hs-type">docs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#tcdCExt"><span class="hs-identifier hs-var">tcdCExt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062757"><span class="hs-identifier hs-type">all_fvs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-1813"></span><span>                  </span><span class="annot"><a href="#local-6989586621683062757"><span class="hs-identifier hs-type">all_fvs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1814"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1815"></span><span>    </span><span id="local-6989586621683062737"><span class="annot"><span class="annottext">cls_doc :: HsDocContext
</span><a href="#local-6989586621683062737"><span class="hs-identifier hs-var hs-var">cls_doc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#ClassDeclCtx"><span class="hs-identifier hs-var">ClassDeclCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062714"><span class="hs-identifier hs-var">lcls</span></a></span><span>
</span><span id="line-1816"></span><span>
</span><span id="line-1817"></span><span class="hs-comment">-- Does the data type declaration include a CUSK?</span><span>
</span><span id="line-1818"></span><span id="local-6989586621683060868"><span id="local-6989586621683060869"><span class="annot"><a href="GHC.Rename.Module.html#data_decl_has_cusk"><span class="hs-identifier hs-type">data_decl_has_cusk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060868"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060869"><span class="hs-identifier hs-type">p'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-1819"></span><span id="data_decl_has_cusk"><span class="annot"><span class="annottext">data_decl_has_cusk :: forall (p :: Pass) (p' :: Pass).
LHsQTyVars (GhcPass p)
-&gt; NewOrData -&gt; Bool -&gt; Maybe (LHsKind (GhcPass p')) -&gt; TcRn Bool
</span><a href="GHC.Rename.Module.html#data_decl_has_cusk"><span class="hs-identifier hs-var hs-var">data_decl_has_cusk</span></a></span></span><span> </span><span id="local-6989586621683062763"><span class="annot"><span class="annottext">LHsQTyVars (GhcPass p)
</span><a href="#local-6989586621683062763"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span id="local-6989586621683062764"><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621683062764"><span class="hs-identifier hs-var">new_or_data</span></a></span></span><span> </span><span id="local-6989586621683062765"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062765"><span class="hs-identifier hs-var">no_rhs_kvs</span></a></span></span><span> </span><span id="local-6989586621683062766"><span class="annot"><span class="annottext">Maybe (LHsKind (GhcPass p'))
</span><a href="#local-6989586621683062766"><span class="hs-identifier hs-var">kind_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1820"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [Unlifted Newtypes and CUSKs], and for a broader</span><span>
</span><span id="line-1821"></span><span>    </span><span class="hs-comment">-- picture, see Note [Implementation of UnliftedNewtypes].</span><span>
</span><span id="line-1822"></span><span>  </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062767"><span class="annot"><a href="#local-6989586621683062767"><span class="hs-identifier hs-var">unlifted_newtypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.UnliftedNewtypes</span></span><span>
</span><span id="line-1823"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062769"><span class="annot"><a href="#local-6989586621683062769"><span class="hs-identifier hs-var hs-var">non_cusk_newtype</span></a></span></span><span>
</span><span id="line-1824"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.Syntax.Decls.html#NewType"><span class="hs-identifier hs-var">NewType</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621683062764"><span class="hs-identifier hs-var">new_or_data</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1825"></span><span>              </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062767"><span class="hs-identifier hs-var">unlifted_newtypes</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (HsType (GhcPass p'))) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsKind (GhcPass p'))
Maybe (GenLocated SrcSpanAnnA (HsType (GhcPass p')))
</span><a href="#local-6989586621683062766"><span class="hs-identifier hs-var">kind_sig</span></a></span><span>
</span><span id="line-1826"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1827"></span><span>    </span><span class="hs-comment">-- See Note [CUSKs: complete user-supplied kind signatures] in GHC.Hs.Decls</span><span>
</span><span id="line-1828"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Hs.Type.html#hsTvbAllKinded"><span class="hs-identifier hs-type">hsTvbAllKinded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062763"><span class="hs-identifier hs-type">tyvars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621683062765"><span class="hs-identifier hs-type">no_rhs_kvs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621683062769"><span class="hs-identifier hs-type">non_cusk_newtype</span></a></span><span>
</span><span id="line-1829"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1830"></span><span>
</span><span id="line-1831"></span><span class="hs-comment">{- Note [Unlifted Newtypes and CUSKs]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When unlifted newtypes are enabled, a newtype must have a kind signature
in order to be considered have a CUSK. This is because the flow of
kind inference works differently. Consider:

  newtype Foo = FooC Int

When UnliftedNewtypes is disabled, we decide that Foo has kind
`TYPE 'LiftedRep` without looking inside the data constructor. So, we
can say that Foo has a CUSK. However, when UnliftedNewtypes is enabled,
we fill in the kind of Foo as a metavar that gets solved by unification
with the kind of the field inside FooC (that is, Int, whose kind is
`TYPE 'LiftedRep`). But since we have to look inside the data constructors
to figure out the kind signature of Foo, it does not have a CUSK.

See Note [Implementation of UnliftedNewtypes] for where this fits in to
the broader picture of UnliftedNewtypes.
-}</span><span>
</span><span id="line-1850"></span><span>
</span><span id="line-1851"></span><span class="hs-comment">-- &quot;type&quot; and &quot;type instance&quot; declarations</span><span>
</span><span id="line-1852"></span><span class="annot"><a href="GHC.Rename.Module.html#rnTySyn"><span class="hs-identifier hs-type">rnTySyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1853"></span><span id="rnTySyn"><span class="annot"><span class="annottext">rnTySyn :: HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTySyn"><span class="hs-identifier hs-var hs-var">rnTySyn</span></a></span></span><span> </span><span id="local-6989586621683062772"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062772"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683062773"><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062773"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062772"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062773"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1854"></span><span>
</span><span id="line-1855"></span><span class="annot"><a href="GHC.Rename.Module.html#rnDataDefn"><span class="hs-identifier hs-type">rnDataDefn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-1856"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1857"></span><span id="rnDataDefn"><span class="annot"><span class="annottext">rnDataDefn :: HsDocContext
-&gt; HsDataDefn GhcPs -&gt; RnM (HsDataDefn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnDataDefn"><span class="hs-identifier hs-var hs-var">rnDataDefn</span></a></span></span><span> </span><span id="local-6989586621683062775"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062775"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dd_cType :: forall pass. HsDataDefn pass -&gt; Maybe (XRec pass CType)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_cType"><span class="hs-identifier hs-var">dd_cType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062777"><span class="annot"><span class="annottext">Maybe (XRec GhcPs CType)
</span><a href="#local-6989586621683062777"><span class="hs-identifier hs-var">cType</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dd_ctxt :: forall pass. HsDataDefn pass -&gt; Maybe (LHsContext pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_ctxt"><span class="hs-identifier hs-var">dd_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062779"><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683062779"><span class="hs-identifier hs-var">context</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dd_cons :: forall pass. HsDataDefn pass -&gt; DataDefnCons (LConDecl pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_cons"><span class="hs-identifier hs-var">dd_cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062780"><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
</span><a href="#local-6989586621683062780"><span class="hs-identifier hs-var">condecls</span></a></span></span><span>
</span><span id="line-1858"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dd_kindSig :: forall pass. HsDataDefn pass -&gt; Maybe (LHsKind pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dd_kindSig"><span class="hs-identifier hs-var">dd_kindSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062781"><span class="annot"><span class="annottext">Maybe (LHsType GhcPs)
</span><a href="#local-6989586621683062781"><span class="hs-identifier hs-var">m_sig</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dd_derivs :: forall pass. HsDataDefn pass -&gt; HsDeriving pass
</span><a href="Language.Haskell.Syntax.Decls.html#dd_derivs"><span class="hs-identifier hs-var">dd_derivs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062783"><span class="annot"><span class="annottext">HsDeriving GhcPs
</span><a href="#local-6989586621683062783"><span class="hs-identifier hs-var">derivs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1859"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- DatatypeContexts (i.e., stupid contexts) can't be combined with</span><span>
</span><span id="line-1860"></span><span>          </span><span class="hs-comment">-- GADT syntax. See Note [The stupid context] in GHC.Core.DataCon.</span><span>
</span><span id="line-1861"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#checkTc"><span class="hs-identifier hs-var">checkTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062785"><span class="hs-identifier hs-var">h98_style</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcPs)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs) -&gt; [LHsType GhcPs]
forall (p :: Pass).
Maybe (LHsContext (GhcPass p)) -&gt; HsContext (GhcPass p)
</span><a href="GHC.Hs.Type.html#fromMaybeContext"><span class="hs-identifier hs-var">fromMaybeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683062779"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1862"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocContext -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnStupidThetaInGadt"><span class="hs-identifier hs-var">TcRnStupidThetaInGadt</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062775"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1863"></span><span>
</span><span id="line-1864"></span><span>        </span><span class="hs-comment">-- Check restrictions on &quot;type data&quot; declarations.</span><span>
</span><span id="line-1865"></span><span>        </span><span class="hs-comment">-- See Note [Type data declarations].</span><span>
</span><span id="line-1866"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs)) -&gt; Bool
forall a. DataDefnCons a -&gt; Bool
</span><a href="Language.Haskell.Syntax.Decls.html#isTypeDataDefnCons"><span class="hs-identifier hs-var">isTypeDataDefnCons</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs))
</span><a href="#local-6989586621683062780"><span class="hs-identifier hs-var">condecls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRn ()
</span><a href="#local-6989586621683062790"><span class="hs-identifier hs-var">check_type_data</span></a></span><span>
</span><span id="line-1867"></span><span>
</span><span id="line-1868"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062791"><span class="annot"><a href="#local-6989586621683062791"><span class="hs-identifier hs-var">m_sig'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062792"><span class="annot"><a href="#local-6989586621683062792"><span class="hs-identifier hs-var">sig_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsType GhcPs)
</span><a href="#local-6989586621683062781"><span class="hs-identifier hs-var">m_sig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1869"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062793"><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062793"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsType GhcRn)
 -&gt; Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)))
-&gt; (GenLocated SrcSpanAnnA (HsType GhcRn), FreeVars)
-&gt; (Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn)
-&gt; Maybe (GenLocated SrcSpanAnnA (HsType GhcRn))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsType GhcRn), FreeVars)
 -&gt; (Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars))
-&gt; RnM (GenLocated SrcSpanAnnA (HsType GhcRn), FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062775"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062793"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-1870"></span><span>             </span><span class="annot"><span class="annottext">Maybe (LHsType GhcPs)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (Maybe (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (HsType GhcRn))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1871"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062795"><span class="annot"><a href="#local-6989586621683062795"><span class="hs-identifier hs-var">context'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062796"><span class="annot"><a href="#local-6989586621683062796"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnMaybeContext"><span class="hs-identifier hs-type">rnMaybeContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062775"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062779"><span class="hs-identifier hs-type">context</span></a></span><span>
</span><span id="line-1872"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062797"><span class="annot"><a href="#local-6989586621683062797"><span class="hs-identifier hs-var">derivs'</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621683062798"><span class="annot"><a href="#local-6989586621683062798"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683062799"><span class="hs-identifier hs-type">rn_derivs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062783"><span class="hs-identifier hs-type">derivs</span></a></span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span>        </span><span class="hs-comment">-- For the constructor declarations, drop the LocalRdrEnv</span><span>
</span><span id="line-1875"></span><span>        </span><span class="hs-comment">-- in the GADT case, where the type variables in the declaration</span><span>
</span><span id="line-1876"></span><span>        </span><span class="hs-comment">-- do not scope over the constructor signatures</span><span>
</span><span id="line-1877"></span><span>        </span><span class="hs-comment">-- data T a where { T1 :: forall b. b-&gt; b }</span><span>
</span><span id="line-1878"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062800"><span class="annot"><a href="#local-6989586621683062800"><span class="hs-identifier hs-var hs-var">zap_lcl_env</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683062785"><span class="hs-identifier hs-var">h98_style</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062801"><span class="annot"><span class="annottext">RnM (DataDefnCons (LConDecl GhcRn), FreeVars)
</span><a href="#local-6989586621683062801"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RnM (DataDefnCons (LConDecl GhcRn), FreeVars)
</span><a href="#local-6989586621683062801"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1879"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
-&gt; RnM (DataDefnCons (LConDecl GhcRn), FreeVars)
-&gt; RnM (DataDefnCons (LConDecl GhcRn), FreeVars)
forall a. LocalRdrEnv -&gt; RnM a -&gt; RnM a
</span><a href="GHC.Tc.Utils.Monad.html#setLocalRdrEnv"><span class="hs-identifier hs-var">setLocalRdrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#emptyLocalRdrEnv"><span class="hs-identifier hs-var">emptyLocalRdrEnv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1880"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062804"><span class="annot"><a href="#local-6989586621683062804"><span class="hs-identifier hs-var">condecls'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062805"><span class="annot"><a href="#local-6989586621683062805"><span class="hs-identifier hs-var">con_fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683062800"><span class="hs-identifier hs-type">zap_lcl_env</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnConDecls"><span class="hs-identifier hs-type">rnConDecls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062780"><span class="hs-identifier hs-type">condecls</span></a></span><span>
</span><span id="line-1881"></span><span>           </span><span class="hs-comment">-- No need to check for duplicate constructor decls</span><span>
</span><span id="line-1882"></span><span>           </span><span class="hs-comment">-- since that is done by GHC.Rename.Names.extendGlobalRdrEnvRn</span><span>
</span><span id="line-1883"></span><span>
</span><span id="line-1884"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062807"><span class="annot"><a href="#local-6989586621683062807"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062796"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062798"><span class="hs-identifier hs-var">fvs3</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span>
</span><span id="line-1885"></span><span>                        </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062805"><span class="hs-identifier hs-var">con_fvs</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683062792"><span class="hs-identifier hs-var">sig_fvs</span></a></span><span>
</span><span id="line-1886"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_ext"><span class="hs-identifier hs-var">dd_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-type">noAnn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_cType"><span class="hs-identifier hs-var">dd_cType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062777"><span class="hs-identifier hs-type">cType</span></a></span><span>
</span><span id="line-1887"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_ctxt"><span class="hs-identifier hs-var">dd_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062795"><span class="hs-identifier hs-type">context'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_kindSig"><span class="hs-identifier hs-var">dd_kindSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062791"><span class="hs-identifier hs-type">m_sig'</span></a></span><span>
</span><span id="line-1888"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_cons"><span class="hs-identifier hs-var">dd_cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062804"><span class="hs-identifier hs-type">condecls'</span></a></span><span>
</span><span id="line-1889"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#dd_derivs"><span class="hs-identifier hs-var">dd_derivs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062797"><span class="hs-identifier hs-type">derivs'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1890"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062807"><span class="hs-identifier hs-type">all_fvs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1891"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1892"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1893"></span><span>    </span><span id="local-6989586621683062785"><span class="annot"><span class="annottext">h98_style :: Bool
</span><a href="#local-6989586621683062785"><span class="hs-identifier hs-var hs-var">h98_style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs)) -&gt; Bool
forall (f :: * -&gt; *) l pass.
Foldable f =&gt;
f (GenLocated l (ConDecl pass)) -&gt; Bool
</span><a href="GHC.Hs.Decls.html#anyLConIsGadt"><span class="hs-identifier hs-var">anyLConIsGadt</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs))
</span><a href="#local-6989586621683062780"><span class="hs-identifier hs-var">condecls</span></a></span><span>  </span><span class="hs-comment">-- Note [Stupid theta]</span><span>
</span><span id="line-1894"></span><span>
</span><span id="line-1895"></span><span>    </span><span id="local-6989586621683062799"><span class="annot"><span class="annottext">rn_derivs :: [GenLocated EpAnnCO (HsDerivingClause GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     ([GenLocated EpAnnCO (HsDerivingClause GhcRn)], FreeVars)
</span><a href="#local-6989586621683062799"><span class="hs-identifier hs-var hs-var">rn_derivs</span></a></span></span><span> </span><span id="local-6989586621683062810"><span class="annot"><span class="annottext">[GenLocated EpAnnCO (HsDerivingClause GhcPs)]
</span><a href="#local-6989586621683062810"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-1896"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062811"><span class="annot"><a href="#local-6989586621683062811"><span class="hs-identifier hs-var">deriv_strats_ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.DerivingStrategies</span></span><span>
</span><span id="line-1897"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#failIfTc"><span class="hs-identifier hs-type">failIfTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-identifier hs-type">lengthExceeds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062810"><span class="hs-identifier hs-type">ds</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621683062811"><span class="hs-identifier hs-type">deriv_strats_ok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>               </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnIllegalMultipleDerivClauses"><span class="hs-identifier hs-type">TcRnIllegalMultipleDerivClauses</span></a></span><span>
</span><span id="line-1899"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062815"><span class="annot"><a href="#local-6989586621683062815"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062816"><span class="annot"><a href="#local-6989586621683062816"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-type">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#rnLHsDerivingClause"><span class="hs-identifier hs-type">rnLHsDerivingClause</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062775"><span class="hs-identifier hs-type">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683062810"><span class="hs-identifier hs-type">ds</span></a></span><span>
</span><span id="line-1900"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062815"><span class="hs-identifier hs-type">ds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062816"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1901"></span><span>
</span><span id="line-1902"></span><span>    </span><span class="hs-comment">-- Given a &quot;type data&quot; declaration, check that the TypeData extension</span><span>
</span><span id="line-1903"></span><span>    </span><span class="hs-comment">-- is enabled and check restrictions (R1), (R2), (R3) and (R5)</span><span>
</span><span id="line-1904"></span><span>    </span><span class="hs-comment">-- on the declaration.  See Note [Type data declarations].</span><span>
</span><span id="line-1905"></span><span>    </span><span id="local-6989586621683062790"><span class="annot"><span class="annottext">check_type_data :: TcRn ()
</span><a href="#local-6989586621683062790"><span class="hs-identifier hs-var hs-var">check_type_data</span></a></span></span><span>
</span><span id="line-1906"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn () -&gt; TcRn ()
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#unlessXOptM"><span class="hs-identifier hs-var">unlessXOptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.TypeData</span></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalTypeData"><span class="hs-identifier hs-var">TcRnIllegalTypeData</span></a></span><span>
</span><span id="line-1907"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcPs)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs) -&gt; [LHsType GhcPs]
forall (p :: Pass).
Maybe (LHsContext (GhcPass p)) -&gt; HsContext (GhcPass p)
</span><a href="GHC.Hs.Type.html#fromMaybeContext"><span class="hs-identifier hs-var">fromMaybeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683062779"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1908"></span><span>               </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnTypeDataForbids"><span class="hs-identifier hs-var">TcRnTypeDataForbids</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids
</span><a href="GHC.Tc.Errors.Types.html#TypeDataForbidsDatatypeContexts"><span class="hs-identifier hs-var">TypeDataForbidsDatatypeContexts</span></a></span><span>
</span><span id="line-1909"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (ConDecl GhcPs) -&gt; TcRn ())
-&gt; DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs)) -&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConDecl GhcPs -&gt; TcRn ())
-&gt; GenLocated SrcSpanAnnA (ConDecl GhcPs) -&gt; TcRn ()
forall t a b. HasLoc t =&gt; (a -&gt; TcM b) -&gt; GenLocated t a -&gt; TcM b
</span><a href="GHC.Tc.Utils.Monad.html#addLocM"><span class="hs-identifier hs-var">addLocM</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl GhcPs -&gt; TcRn ()
</span><a href="#local-6989586621683062823"><span class="hs-identifier hs-var">check_type_data_condecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDefnCons (LConDecl GhcPs)
DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs))
</span><a href="#local-6989586621683062780"><span class="hs-identifier hs-var">condecls</span></a></span><span>
</span><span id="line-1910"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated EpAnnCO (HsDerivingClause GhcPs)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">HsDeriving GhcPs
[GenLocated EpAnnCO (HsDerivingClause GhcPs)]
</span><a href="#local-6989586621683062783"><span class="hs-identifier hs-var">derivs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1911"></span><span>               </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnTypeDataForbids"><span class="hs-identifier hs-var">TcRnTypeDataForbids</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids
</span><a href="GHC.Tc.Errors.Types.html#TypeDataForbidsDerivingClauses"><span class="hs-identifier hs-var">TypeDataForbidsDerivingClauses</span></a></span><span>
</span><span id="line-1912"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-1913"></span><span>
</span><span id="line-1914"></span><span>    </span><span class="hs-comment">-- Check restrictions (R2) and (R3) on a &quot;type data&quot; constructor.</span><span>
</span><span id="line-1915"></span><span>    </span><span class="hs-comment">-- See Note [Type data declarations].</span><span>
</span><span id="line-1916"></span><span>    </span><span class="annot"><a href="#local-6989586621683062823"><span class="hs-identifier hs-type">check_type_data_condecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDecl"><span class="hs-identifier hs-type">ConDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1917"></span><span>    </span><span id="local-6989586621683062823"><span class="annot"><span class="annottext">check_type_data_condecl :: ConDecl GhcPs -&gt; TcRn ()
</span><a href="#local-6989586621683062823"><span class="hs-identifier hs-var hs-var">check_type_data_condecl</span></a></span></span><span> </span><span id="local-6989586621683062825"><span class="annot"><span class="annottext">ConDecl GhcPs
</span><a href="#local-6989586621683062825"><span class="hs-identifier hs-var">condecl</span></a></span></span><span>
</span><span id="line-1918"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-1919"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConDecl GhcPs -&gt; Bool
forall {pass} {l}.
(XRec pass [XRec pass (ConDeclField pass)]
 ~ GenLocated l [XRec pass (ConDeclField pass)]) =&gt;
ConDecl pass -&gt; Bool
</span><a href="#local-6989586621683062826"><span class="hs-identifier hs-var">has_labelled_fields</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl GhcPs
</span><a href="#local-6989586621683062825"><span class="hs-identifier hs-var">condecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1920"></span><span>               </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnTypeDataForbids"><span class="hs-identifier hs-var">TcRnTypeDataForbids</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids
</span><a href="GHC.Tc.Errors.Types.html#TypeDataForbidsLabelledFields"><span class="hs-identifier hs-var">TypeDataForbidsLabelledFields</span></a></span><span>
</span><span id="line-1921"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConDecl GhcPs -&gt; Bool
forall {p :: Pass}. ConDecl (GhcPass p) -&gt; Bool
</span><a href="#local-6989586621683062828"><span class="hs-identifier hs-var">has_strictness_flags</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl GhcPs
</span><a href="#local-6989586621683062825"><span class="hs-identifier hs-var">condecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1922"></span><span>               </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnTypeDataForbids"><span class="hs-identifier hs-var">TcRnTypeDataForbids</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDataForbids
</span><a href="GHC.Tc.Errors.Types.html#TypeDataForbidsStrictnessAnnotations"><span class="hs-identifier hs-var">TypeDataForbidsStrictnessAnnotations</span></a></span><span>
</span><span id="line-1923"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-1924"></span><span>
</span><span id="line-1925"></span><span>    </span><span id="local-6989586621683062826"><span class="annot"><span class="annottext">has_labelled_fields :: ConDecl pass -&gt; Bool
</span><a href="#local-6989586621683062826"><span class="hs-identifier hs-var hs-var">has_labelled_fields</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclGADT"><span class="hs-identifier hs-type">ConDeclGADT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_g_args :: forall pass. ConDecl pass -&gt; HsConDeclGADTDetails pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_g_args"><span class="hs-identifier hs-var">con_g_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RecConGADT"><span class="hs-identifier hs-type">RecConGADT</span></a></span><span> </span><span class="annot"><span class="annottext">XRecConGADT pass
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XRec pass [XRec pass (ConDeclField pass)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1926"></span><span>    </span><span class="annot"><a href="#local-6989586621683062826"><span class="hs-identifier hs-var">has_labelled_fields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclH98"><span class="hs-identifier hs-type">ConDeclH98</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_args :: forall pass. ConDecl pass -&gt; HsConDeclH98Details pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span id="local-6989586621683062839"><span class="annot"><span class="annottext">XRec pass [XRec pass (ConDeclField pass)]
</span><a href="#local-6989586621683062839"><span class="hs-identifier hs-var">rec</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[XRec pass (ConDeclField pass)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated l [XRec pass (ConDeclField pass)]
-&gt; [XRec pass (ConDeclField pass)]
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec pass [XRec pass (ConDeclField pass)]
GenLocated l [XRec pass (ConDeclField pass)]
</span><a href="#local-6989586621683062839"><span class="hs-identifier hs-var">rec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1928"></span><span>    </span><span class="annot"><a href="#local-6989586621683062826"><span class="hs-identifier hs-var">has_labelled_fields</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl pass
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1929"></span><span>
</span><span id="line-1930"></span><span>    </span><span id="local-6989586621683062828"><span class="annot"><span class="annottext">has_strictness_flags :: ConDecl (GhcPass p) -&gt; Bool
</span><a href="#local-6989586621683062828"><span class="hs-identifier hs-var hs-var">has_strictness_flags</span></a></span></span><span> </span><span id="local-6989586621683062841"><span class="annot"><span class="annottext">ConDecl (GhcPass p)
</span><a href="#local-6989586621683062841"><span class="hs-identifier hs-var">condecl</span></a></span></span><span>
</span><span id="line-1931"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsScaled (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
 -&gt; Bool)
-&gt; [HsScaled
      (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))]
-&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsSrcBang -&gt; Bool
</span><a href="#local-6989586621683062843"><span class="hs-identifier hs-var">is_strict</span></a></span><span> </span><span class="annot"><span class="annottext">(HsSrcBang -&gt; Bool)
-&gt; (HsScaled
      (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
    -&gt; HsSrcBang)
-&gt; HsScaled
     (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LHsType (GhcPass p) -&gt; HsSrcBang
GenLocated SrcSpanAnnA (HsType (GhcPass p)) -&gt; HsSrcBang
forall (p :: Pass). LHsType (GhcPass p) -&gt; HsSrcBang
</span><a href="GHC.Hs.Type.html#getBangStrictness"><span class="hs-identifier hs-var">getBangStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsType (GhcPass p)) -&gt; HsSrcBang)
-&gt; (HsScaled
      (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
    -&gt; GenLocated SrcSpanAnnA (HsType (GhcPass p)))
-&gt; HsScaled
     (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
-&gt; HsSrcBang
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsScaled (GhcPass p) (GenLocated SrcSpanAnnA (HsType (GhcPass p)))
-&gt; GenLocated SrcSpanAnnA (HsType (GhcPass p))
forall pass a. HsScaled pass a -&gt; a
</span><a href="Language.Haskell.Syntax.Type.html#hsScaledThing"><span class="hs-identifier hs-var">hsScaledThing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConDecl (GhcPass p) -&gt; [HsScaled (GhcPass p) (LHsType (GhcPass p))]
forall {pass}.
ConDecl pass -&gt; [HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062846"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl (GhcPass p)
</span><a href="#local-6989586621683062841"><span class="hs-identifier hs-var">condecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1932"></span><span>
</span><span id="line-1933"></span><span>    </span><span id="local-6989586621683062843"><span class="annot"><span class="annottext">is_strict :: HsSrcBang -&gt; Bool
</span><a href="#local-6989586621683062843"><span class="hs-identifier hs-var hs-var">is_strict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#HsSrcBang"><span class="hs-identifier hs-type">HsSrcBang</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#HsBang"><span class="hs-identifier hs-type">HsBang</span></a></span><span> </span><span class="annot"><span class="annottext">SrcUnpackedness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062849"><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683062849"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcStrictness -&gt; Bool
</span><a href="GHC.Core.DataCon.html#isSrcStrict"><span class="hs-identifier hs-var">isSrcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">SrcStrictness
</span><a href="#local-6989586621683062849"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1934"></span><span>
</span><span id="line-1935"></span><span>    </span><span id="local-6989586621683062846"><span class="annot"><span class="annottext">con_args :: ConDecl pass -&gt; [HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062846"><span class="hs-identifier hs-var hs-var">con_args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclGADT"><span class="hs-identifier hs-type">ConDeclGADT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_g_args :: forall pass. ConDecl pass -&gt; HsConDeclGADTDetails pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_g_args"><span class="hs-identifier hs-var">con_g_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#PrefixConGADT"><span class="hs-identifier hs-type">PrefixConGADT</span></a></span><span> </span><span class="annot"><span class="annottext">XPrefixConGADT pass
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062851"><span class="annot"><span class="annottext">[HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062851"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062851"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1936"></span><span>    </span><span class="annot"><a href="#local-6989586621683062846"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclH98"><span class="hs-identifier hs-type">ConDeclH98</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_args :: forall pass. ConDecl pass -&gt; HsConDeclH98Details pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#PrefixCon"><span class="hs-identifier hs-type">PrefixCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Void]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062853"><span class="annot"><span class="annottext">[HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062853"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsScaled pass (XRec pass (BangType pass))]
</span><a href="#local-6989586621683062853"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1937"></span><span>    </span><span class="annot"><a href="#local-6989586621683062846"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclH98"><span class="hs-identifier hs-type">ConDeclH98</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_args :: forall pass. ConDecl pass -&gt; HsConDeclH98Details pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#InfixCon"><span class="hs-identifier hs-type">InfixCon</span></a></span><span> </span><span id="local-6989586621683062855"><span class="annot"><span class="annottext">HsScaled pass (XRec pass (BangType pass))
</span><a href="#local-6989586621683062855"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621683062856"><span class="annot"><span class="annottext">HsScaled pass (XRec pass (BangType pass))
</span><a href="#local-6989586621683062856"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HsScaled pass (XRec pass (BangType pass))
</span><a href="#local-6989586621683062855"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HsScaled pass (XRec pass (BangType pass))
</span><a href="#local-6989586621683062856"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1938"></span><span>    </span><span class="annot"><a href="#local-6989586621683062846"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl pass
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1939"></span><span>
</span><span id="line-1940"></span><span class="hs-comment">{-
Note [Type data declarations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
With the TypeData extension (GHC proposal #106), one can write `type data`
declarations, like

    type data Nat = Zero | Succ Nat

or equivalently in GADT style:

    type data Nat where
        Zero :: Nat
        Succ :: Nat -&gt; Nat

This defines the constructors `Zero` and `Succ` in the TcCls namespace
(type constructors and classes) instead of the Data namespace (data
constructors).  This contrasts with the DataKinds extension, which
allows constructors defined in the Data namespace to be promoted to the
TcCls namespace at the point of use in a type.

Type data declarations have the syntax of `data` declarations (but not
`newtype` declarations), either ordinary algebraic data types or GADTs,
preceded by `type`, with the following restrictions:

(R0) 'data' decls only, not 'newtype' decls.  This is checked by
     the parser.

(R1) There are no data type contexts (even with the DatatypeContexts
     extension).

(R2) There are no labelled fields.  Perhaps these could be supported
     using type families, but they are omitted for now.

(R3) There are no strictness flags, because they don't make sense at
     the type level.

(R4) The types of the constructors contain no constraints.

(R5) There are no deriving clauses.

The data constructors of a `type data` declaration obey the following
Core invariant:

(I1) The data constructors of a `type data` declaration may be mentioned in
     /types/, but never in /terms/ or the /pattern of a case alternative/.

Wrinkles:

(W0) Wrappers.  The data constructor of a `type data` declaration has a worker
     (like every data constructor) but does /not/ have a wrapper.  Wrappers
     only make sense for value-level data constructors. Indeed, the worker Id
     is never used (invariant (I1)), so it barely makes sense to talk about
     the worker. A `type data` constructor only shows up in types, where it
     appears as a TyCon, specifically a PromotedDataCon -- no Id in sight.
     See #24620 for an example of what happens if you accidentally include
     a wrapper.

     See `wrapped_reqd` in GHC.Types.Id.Make.mkDataConRep` for the place where
     this check is implemented.

     This specifically includes `type data` declarations implemented as GADTs,
     such as this example from #22948:

        type data T a where
          A :: T Int
          B :: T a

     If `T` were an ordinary `data` declaration, then `A` would have a wrapper
     to account for the GADT-like equality in its return type. Because `T` is
     declared as a `type data` declaration, however, the wrapper is omitted.

(W1) To prevent users from conjuring up `type data` values at the term level,
     we disallow using the tagToEnum# function on a type headed by a `type
     data` type. For instance, GHC will reject this code:

       type data Letter = A | B | C

       f :: Letter
       f = tagToEnum# 0#

     See `GHC.Tc.Gen.App.checkTagToEnum`, specifically `check_enumeration`.

(W2) Although `type data` data constructors do not exist at the value level,
     it is still possible to match on a value whose type is headed by a `type data`
     type constructor, such as this example from #22964:

       type data T a where
         A :: T Int
         B :: T a

       f :: T a -&gt; ()
       f x = case x of {}

     And yet we must guarantee invariant (I1). This has three consequences:

     (W2a) During checking the coverage of `f`'s pattern matches, we treat `T`
           as if it were an empty data type so that GHC does not warn the user
           to match against `A` or `B`. (Otherwise, you end up with the bug
           reported in #22964.)  See GHC.HsToCore.Pmc.Solver.vanillaCompleteMatchTC.

     (W2b) In `GHC.Core.Utils.refineDataAlt`, do /not/ fill in the DEFAULT case
           with the data constructor, else (I1) is violated. See GHC.Core.Utils
           Note [Refine DEFAULT case alternatives] Exception 2

     (W2c) In `GHC.Core.Opt.ConstantFold.caseRules`, we do not want to transform
              case dataToTagLarge# x of t -&gt; blah
           into
              case x of { A -&gt; ...; B -&gt; .. }
           because again that conjures up the type-level-only data constructors
           `A` and `B` in a pattern, violating (I1) (#23023).
           So we check for &quot;type data&quot; TyCons before applying this
           transformation.  (In practice, this doesn't matter because
           we also refuse to solve DataToTag instances at types
           corresponding to type data declarations.  See rule C1 from
           Note [DataToTag overview] in GHC.Tc.Instance.Class.)

The main parts of the implementation are:

* The parser recognizes `type data` (but not `type newtype`); this ensures (R0).

* During the initial construction of the AST,
  GHC.Parser.PostProcess.checkNewOrData sets the `Bool` argument of the
  `DataTypeCons` inside a `HsDataDefn` to mark a `type data` declaration.
  It also puts the the constructor names (`Zero` and `Succ` in our
  example) in the TcCls namespace.

* GHC.Rename.Module.rnDataDefn calls `check_type_data` on these
  declarations, which checks that the TypeData extension is enabled and
  checks restrictions (R1), (R2), (R3) and (R5).  They could equally
  well be checked in the typechecker, but we err on the side of catching
  imposters early.

* GHC.Tc.TyCl.checkValidDataCon checks restriction (R4) on these declarations.

* When beginning to type check a mutually recursive group of declarations,
  the `type data` constructors (`Zero` and `Succ` in our example) are
  added to the type-checker environment as `APromotionErr TyConPE` by
  GHC.Tc.TyCl.mkPromotionErrorEnv, so they cannot be used within the
  recursive group.  This mirrors the DataKinds behaviour described
  at Note [Recursion and promoting data constructors] in GHC.Tc.TyCl.
  For example, this is rejected:

    type data T f = K (f (K Int)) -- illegal: tycon K is recursively defined

* The `type data` data type, such as `Nat` in our example, is represented
  by a `TyCon` that is an `AlgTyCon`, but its `AlgTyConRhs` has the
  `is_type_data` field set.

* The constructors of the data type, `Zero` and `Succ` in our example,
  are each represented by a `DataCon` as usual.  That `DataCon`'s
  `dcPromotedField` is a `TyCon` (for `Zero`, say) that you can use
  in a type.

* After a `type data` declaration has been type-checked, the
  type-checker environment entry (a `TyThing`) for each constructor
  (`Zero` and `Succ` in our example) is
  - just an `ATyCon` for the promoted type constructor,
  - not the bundle (`ADataCon` for the data con, `AnId` for the work id,
    wrap id) required for a normal data constructor
  See GHC.Types.TyThing.implicitTyConThings.

* GHC.Core.TyCon.isDataKindsPromotedDataCon ignores promoted constructors
  from `type data`, which do not use the distinguishing quote mark added
  to constructors promoted by DataKinds.

* GHC.Core.TyCon.isDataTyCon ignores types coming from a `type data`
  declaration (by checking the `is_type_data` field), so that these do
  not contribute executable code such as constructor wrappers.

* The `is_type_data` field is copied into a Boolean argument
  of the `IfDataTyCon` constructor of `IfaceConDecls` by
  GHC.Iface.Make.tyConToIfaceDecl.

* The Template Haskell `Dec` type has an constructor `TypeDataD` for
  `type data` declarations.  When these are converted back to Hs types
  in a splice, the constructors are placed in the TcCls namespace.

-}</span><span>
</span><span id="line-2118"></span><span>
</span><span id="line-2119"></span><span class="annot"><a href="GHC.Rename.Module.html#rnLHsDerivingClause"><span class="hs-identifier hs-type">rnLHsDerivingClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDerivingClause"><span class="hs-identifier hs-type">LHsDerivingClause</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2120"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDerivingClause"><span class="hs-identifier hs-type">LHsDerivingClause</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2121"></span><span id="rnLHsDerivingClause"><span class="annot"><span class="annottext">rnLHsDerivingClause :: HsDocContext
-&gt; LHsDerivingClause GhcPs
-&gt; RnM (LHsDerivingClause GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnLHsDerivingClause"><span class="hs-identifier hs-var hs-var">rnLHsDerivingClause</span></a></span></span><span> </span><span id="local-6989586621683062857"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062857"><span class="hs-identifier hs-var">doc</span></a></span></span><span>
</span><span id="line-2122"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062858"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062858"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDerivingClause"><span class="hs-identifier hs-type">HsDerivingClause</span></a></span><span>
</span><span id="line-2123"></span><span>                              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">deriv_clause_ext :: forall pass. HsDerivingClause pass -&gt; XCHsDerivingClause pass
</span><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_ext"><span class="hs-identifier hs-var">deriv_clause_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062861"><span class="annot"><span class="annottext">XCHsDerivingClause GhcPs
</span><a href="#local-6989586621683062861"><span class="hs-identifier hs-var">noExtField</span></a></span></span><span>
</span><span id="line-2124"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">deriv_clause_strategy :: forall pass. HsDerivingClause pass -&gt; Maybe (LDerivStrategy pass)
</span><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_strategy"><span class="hs-identifier hs-var">deriv_clause_strategy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062863"><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><a href="#local-6989586621683062863"><span class="hs-identifier hs-var">dcs</span></a></span></span><span>
</span><span id="line-2125"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">deriv_clause_tys :: forall pass. HsDerivingClause pass -&gt; LDerivClauseTys pass
</span><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_tys"><span class="hs-identifier hs-var">deriv_clause_tys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062865"><span class="annot"><span class="annottext">LDerivClauseTys GhcPs
</span><a href="#local-6989586621683062865"><span class="hs-identifier hs-var">dct</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2126"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062866"><span class="annot"><a href="#local-6989586621683062866"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062867"><span class="annot"><a href="#local-6989586621683062867"><span class="hs-identifier hs-var">dct'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062868"><span class="annot"><a href="#local-6989586621683062868"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2127"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe (LDerivStrategy GhcPs)
-&gt; RnM (LDerivClauseTys GhcRn, FreeVars)
-&gt; RnM
     (Maybe (LDerivStrategy GhcRn), LDerivClauseTys GhcRn, FreeVars)
forall a.
HsDocContext
-&gt; Maybe (LDerivStrategy GhcPs)
-&gt; RnM (a, FreeVars)
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
</span><a href="GHC.Rename.Module.html#rnLDerivStrategy"><span class="hs-identifier hs-var">rnLDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062857"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><a href="#local-6989586621683062863"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM (LDerivClauseTys GhcRn, FreeVars)
 -&gt; RnM
      (Maybe (LDerivStrategy GhcRn), LDerivClauseTys GhcRn, FreeVars))
-&gt; RnM (LDerivClauseTys GhcRn, FreeVars)
-&gt; RnM
     (Maybe (LDerivStrategy GhcRn), LDerivClauseTys GhcRn, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LDerivClauseTys GhcPs -&gt; RnM (LDerivClauseTys GhcRn, FreeVars)
</span><a href="#local-6989586621683062869"><span class="hs-identifier hs-var">rn_deriv_clause_tys</span></a></span><span> </span><span class="annot"><span class="annottext">LDerivClauseTys GhcPs
</span><a href="#local-6989586621683062865"><span class="hs-identifier hs-var">dct</span></a></span><span>
</span><span id="line-2128"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062858"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDerivingClause"><span class="hs-identifier hs-type">HsDerivingClause</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_ext"><span class="hs-identifier hs-var">deriv_clause_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062861"><span class="hs-identifier hs-type">noExtField</span></a></span><span>
</span><span id="line-2129"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_strategy"><span class="hs-identifier hs-var">deriv_clause_strategy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062866"><span class="hs-identifier hs-type">dcs'</span></a></span><span>
</span><span id="line-2130"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#deriv_clause_tys"><span class="hs-identifier hs-var">deriv_clause_tys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062867"><span class="hs-identifier hs-type">dct'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2131"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062868"><span class="hs-identifier hs-type">fvs</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2133"></span><span>    </span><span class="annot"><a href="#local-6989586621683062869"><span class="hs-identifier hs-type">rn_deriv_clause_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LDerivClauseTys"><span class="hs-identifier hs-type">LDerivClauseTys</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2134"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LDerivClauseTys"><span class="hs-identifier hs-type">LDerivClauseTys</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2135"></span><span>    </span><span id="local-6989586621683062869"><span class="annot"><span class="annottext">rn_deriv_clause_tys :: LDerivClauseTys GhcPs -&gt; RnM (LDerivClauseTys GhcRn, FreeVars)
</span><a href="#local-6989586621683062869"><span class="hs-identifier hs-var hs-var">rn_deriv_clause_tys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062870"><span class="annot"><span class="annottext">SrcSpanAnnC
</span><a href="#local-6989586621683062870"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683062871"><span class="annot"><span class="annottext">DerivClauseTys GhcPs
</span><a href="#local-6989586621683062871"><span class="hs-identifier hs-var">dct</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DerivClauseTys GhcPs
</span><a href="#local-6989586621683062871"><span class="hs-identifier hs-var">dct</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2136"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DctSingle"><span class="hs-identifier hs-type">DctSingle</span></a></span><span> </span><span id="local-6989586621683062873"><span class="annot"><span class="annottext">XDctSingle GhcPs
</span><a href="#local-6989586621683062873"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683062874"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062874"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2137"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683062875"><span class="annot"><a href="#local-6989586621683062875"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062876"><span class="annot"><a href="#local-6989586621683062876"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs -&gt; RnM (LHsSigType GhcRn, FreeVars)
</span><a href="#local-6989586621683062877"><span class="hs-identifier hs-var">rn_clause_pred</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062874"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2138"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062870"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DctSingle"><span class="hs-identifier hs-type">DctSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062873"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062875"><span class="hs-identifier hs-type">ty'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062876"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2139"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DctMulti"><span class="hs-identifier hs-type">DctMulti</span></a></span><span> </span><span id="local-6989586621683062879"><span class="annot"><span class="annottext">XDctMulti GhcPs
</span><a href="#local-6989586621683062879"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683062880"><span class="annot"><span class="annottext">[LHsSigType GhcPs]
</span><a href="#local-6989586621683062880"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2140"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683062881"><span class="annot"><a href="#local-6989586621683062881"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062882"><span class="annot"><a href="#local-6989586621683062882"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsSigType GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated SrcSpanAnnA (HsSigType GhcRn), FreeVars))
-&gt; [GenLocated SrcSpanAnnA (HsSigType GhcPs)]
-&gt; RnM ([GenLocated SrcSpanAnnA (HsSigType GhcRn)], FreeVars)
forall (f :: * -&gt; *) a b.
Traversable f =&gt;
(a -&gt; RnM (b, FreeVars)) -&gt; f a -&gt; RnM (f b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs -&gt; RnM (LHsSigType GhcRn, FreeVars)
GenLocated SrcSpanAnnA (HsSigType GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (GenLocated SrcSpanAnnA (HsSigType GhcRn), FreeVars)
</span><a href="#local-6989586621683062877"><span class="hs-identifier hs-var">rn_clause_pred</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsSigType GhcPs]
[GenLocated SrcSpanAnnA (HsSigType GhcPs)]
</span><a href="#local-6989586621683062880"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2141"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062870"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DctMulti"><span class="hs-identifier hs-type">DctMulti</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062879"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062881"><span class="hs-identifier hs-type">tys'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062882"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2142"></span><span>
</span><span id="line-2143"></span><span>    </span><span class="annot"><a href="#local-6989586621683062877"><span class="hs-identifier hs-type">rn_clause_pred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2144"></span><span>    </span><span id="local-6989586621683062877"><span class="annot"><span class="annottext">rn_clause_pred :: LHsSigType GhcPs -&gt; RnM (LHsSigType GhcRn, FreeVars)
</span><a href="#local-6989586621683062877"><span class="hs-identifier hs-var hs-var">rn_clause_pred</span></a></span></span><span> </span><span id="local-6989586621683062883"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062883"><span class="hs-identifier hs-var">pred_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2145"></span><span>      </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsSigType GhcPs -&gt; TcRn ()
</span><a href="GHC.Rename.Utils.html#checkInferredVars"><span class="hs-identifier hs-var">checkInferredVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062857"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062883"><span class="hs-identifier hs-var">pred_ty</span></a></span><span>
</span><span id="line-2146"></span><span>      </span><span id="local-6989586621683062884"><span class="annot"><a href="#local-6989586621683062884"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683062885"><span class="annot"><a href="#local-6989586621683062885"><span class="hs-identifier hs-var">pred_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; TypeOrKind
-&gt; LHsSigType GhcPs
-&gt; RnM (LHsSigType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062857"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrKind
</span><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062883"><span class="hs-identifier hs-var">pred_ty</span></a></span><span>
</span><span id="line-2147"></span><span>      </span><span class="hs-comment">-- Check if there are any nested `forall`s, which are illegal in a</span><span>
</span><span id="line-2148"></span><span>      </span><span class="hs-comment">-- `deriving` clause.</span><span>
</span><span id="line-2149"></span><span>      </span><span class="hs-comment">-- See Note [No nested foralls or contexts in instance types]</span><span>
</span><span id="line-2150"></span><span>      </span><span class="hs-comment">-- (Wrinkle: Derived instances) in GHC.Hs.Type.</span><span>
</span><span id="line-2151"></span><span>      </span><span class="annot"><a href="GHC.Rename.Utils.html#addNoNestedForallsContextsErr"><span class="hs-identifier hs-type">addNoNestedForallsContextsErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062857"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#NFC_DerivedClassType"><span class="hs-identifier hs-type">NFC_DerivedClassType</span></a></span><span>
</span><span id="line-2152"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Type.html#getLHsInstDeclHead"><span class="hs-identifier hs-type">getLHsInstDeclHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062885"><span class="hs-identifier hs-type">pred_ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2153"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621683062884"><span class="hs-identifier hs-type">ret</span></a></span><span>
</span><span id="line-2154"></span><span>
</span><span id="line-2155"></span><span class="annot"><a href="GHC.Rename.Module.html#rnLDerivStrategy"><span class="hs-identifier hs-type">rnLDerivStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683060720"><span class="annot"><a href="#local-6989586621683060720"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-2156"></span><span>                    </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-2157"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LDerivStrategy"><span class="hs-identifier hs-type">LDerivStrategy</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2158"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060720"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2159"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LDerivStrategy"><span class="hs-identifier hs-type">LDerivStrategy</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683060720"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2160"></span><span id="rnLDerivStrategy"><span class="annot"><span class="annottext">rnLDerivStrategy :: forall a.
HsDocContext
-&gt; Maybe (LDerivStrategy GhcPs)
-&gt; RnM (a, FreeVars)
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
</span><a href="GHC.Rename.Module.html#rnLDerivStrategy"><span class="hs-identifier hs-var hs-var">rnLDerivStrategy</span></a></span></span><span> </span><span id="local-6989586621683062895"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062895"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683062896"><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><a href="#local-6989586621683062896"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621683062897"><span class="annot"><span class="annottext">RnM (a, FreeVars)
</span><a href="#local-6989586621683062897"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-2161"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><a href="#local-6989586621683062896"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2162"></span><span>      </span><span class="annot"><span class="annottext">Maybe (LDerivStrategy GhcPs)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated EpAnnCO (DerivStrategy GhcRn))
-&gt; RnM
     (Maybe (GenLocated EpAnnCO (DerivStrategy GhcRn)), a, FreeVars)
forall ds. ds -&gt; RnM (ds, a, FreeVars)
</span><a href="#local-6989586621683062898"><span class="hs-identifier hs-var">boring_case</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated EpAnnCO (DerivStrategy GhcRn))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2163"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062899"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062899"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683062900"><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062900"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2164"></span><span>        </span><span class="annot"><span class="annottext">EpAnnCO
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062899"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
 -&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars))
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
-&gt; RnM (Maybe (LDerivStrategy GhcRn), a, FreeVars)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2165"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621683062901"><span class="annot"><a href="#local-6989586621683062901"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062902"><span class="annot"><a href="#local-6989586621683062902"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062903"><span class="annot"><a href="#local-6989586621683062903"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs -&gt; RnM (DerivStrategy GhcRn, a, FreeVars)
</span><a href="#local-6989586621683062904"><span class="hs-identifier hs-var">rn_deriv_strat</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062900"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2166"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062899"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062901"><span class="hs-identifier hs-type">ds'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062902"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062903"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2168"></span><span>    </span><span class="annot"><a href="#local-6989586621683062904"><span class="hs-identifier hs-type">rn_deriv_strat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivStrategy"><span class="hs-identifier hs-type">DerivStrategy</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2169"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivStrategy"><span class="hs-identifier hs-type">DerivStrategy</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683060720"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2170"></span><span>    </span><span id="local-6989586621683062904"><span class="annot"><span class="annottext">rn_deriv_strat :: DerivStrategy GhcPs -&gt; RnM (DerivStrategy GhcRn, a, FreeVars)
</span><a href="#local-6989586621683062904"><span class="hs-identifier hs-var hs-var">rn_deriv_strat</span></a></span></span><span> </span><span id="local-6989586621683062905"><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062905"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2171"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621683062906"><span class="hs-identifier hs-type">extNeeded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LangExt.Extension</span></span><span>
</span><span id="line-2172"></span><span>          </span><span id="local-6989586621683062906"><span class="annot"><span class="annottext">extNeeded :: Extension
</span><a href="#local-6989586621683062906"><span class="hs-identifier hs-var hs-var hs-var">extNeeded</span></a></span></span><span>
</span><span id="line-2173"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ViaStrategy"><span class="hs-identifier hs-type">ViaStrategy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062905"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2174"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.DerivingVia</span></span><span>
</span><span id="line-2175"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2176"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.DerivingStrategies</span></span><span>
</span><span id="line-2177"></span><span>
</span><span id="line-2178"></span><span>      </span><span class="annot"><span class="annottext">Extension -&gt; TcRn () -&gt; TcRn ()
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#unlessXOptM"><span class="hs-identifier hs-var">unlessXOptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><a href="#local-6989586621683062906"><span class="hs-identifier hs-var">extNeeded</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2179"></span><span>        </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalDerivStrategy"><span class="hs-identifier hs-var">TcRnIllegalDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062905"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2180"></span><span>
</span><span id="line-2181"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcPs
</span><a href="#local-6989586621683062905"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2182"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#StockStrategy"><span class="hs-identifier hs-type">StockStrategy</span></a></span><span>    </span><span class="annot"><span class="annottext">XStockStrategy GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcRn -&gt; RnM (DerivStrategy GhcRn, a, FreeVars)
forall ds. ds -&gt; RnM (ds, a, FreeVars)
</span><a href="#local-6989586621683062898"><span class="hs-identifier hs-var">boring_case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XStockStrategy GhcRn -&gt; DerivStrategy GhcRn
forall pass. XStockStrategy pass -&gt; DerivStrategy pass
</span><a href="Language.Haskell.Syntax.Decls.html#StockStrategy"><span class="hs-identifier hs-var">StockStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">XStockStrategy GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2183"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnyclassStrategy"><span class="hs-identifier hs-type">AnyclassStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">XAnyClassStrategy GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcRn -&gt; RnM (DerivStrategy GhcRn, a, FreeVars)
forall ds. ds -&gt; RnM (ds, a, FreeVars)
</span><a href="#local-6989586621683062898"><span class="hs-identifier hs-var">boring_case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XAnyClassStrategy GhcRn -&gt; DerivStrategy GhcRn
forall pass. XAnyClassStrategy pass -&gt; DerivStrategy pass
</span><a href="Language.Haskell.Syntax.Decls.html#AnyclassStrategy"><span class="hs-identifier hs-var">AnyclassStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">XAnyClassStrategy GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2184"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#NewtypeStrategy"><span class="hs-identifier hs-type">NewtypeStrategy</span></a></span><span>  </span><span class="annot"><span class="annottext">XNewtypeStrategy GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DerivStrategy GhcRn -&gt; RnM (DerivStrategy GhcRn, a, FreeVars)
forall ds. ds -&gt; RnM (ds, a, FreeVars)
</span><a href="#local-6989586621683062898"><span class="hs-identifier hs-var">boring_case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XNewtypeStrategy GhcRn -&gt; DerivStrategy GhcRn
forall pass. XNewtypeStrategy pass -&gt; DerivStrategy pass
</span><a href="Language.Haskell.Syntax.Decls.html#NewtypeStrategy"><span class="hs-identifier hs-var">NewtypeStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">XNewtypeStrategy GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2185"></span><span>        </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ViaStrategy"><span class="hs-identifier hs-type">ViaStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Decls.html#XViaStrategyPs"><span class="hs-identifier hs-type">XViaStrategyPs</span></a></span><span> </span><span class="annot"><span class="annottext">EpToken &quot;via&quot;
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062914"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062914"><span class="hs-identifier hs-var">via_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2186"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsSigType GhcPs -&gt; TcRn ()
</span><a href="GHC.Rename.Utils.html#checkInferredVars"><span class="hs-identifier hs-var">checkInferredVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062895"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062914"><span class="hs-identifier hs-var">via_ty</span></a></span><span>
</span><span id="line-2187"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683062915"><span class="annot"><a href="#local-6989586621683062915"><span class="hs-identifier hs-var">via_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062916"><span class="annot"><a href="#local-6989586621683062916"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; TypeOrKind
-&gt; LHsSigType GhcPs
-&gt; RnM (LHsSigType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062895"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">TypeOrKind
</span><a href="GHC.Types.Basic.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621683062914"><span class="hs-identifier hs-var">via_ty</span></a></span><span>
</span><span id="line-2188"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSig"><span class="hs-identifier hs-type">HsSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#sig_bndrs"><span class="hs-identifier hs-var">sig_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062919"><span class="annot"><a href="#local-6989586621683062919"><span class="hs-identifier hs-var">via_outer_bndrs</span></a></span></span><span>
</span><span id="line-2189"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#sig_body"><span class="hs-identifier hs-var">sig_body</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062921"><span class="annot"><a href="#local-6989586621683062921"><span class="hs-identifier hs-var">via_body</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062915"><span class="hs-identifier hs-type">via_ty'</span></a></span><span>
</span><span id="line-2190"></span><span>                 </span><span id="local-6989586621683062922"><span class="annot"><a href="#local-6989586621683062922"><span class="hs-identifier hs-var hs-var">via_tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs Specificity GhcRn -&gt; [Name]
forall flag. HsOuterTyVarBndrs flag GhcRn -&gt; [Name]
</span><a href="GHC.Hs.Type.html#hsOuterTyVarNames"><span class="hs-identifier hs-var">hsOuterTyVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs Specificity GhcRn
</span><a href="#local-6989586621683062919"><span class="hs-identifier hs-var">via_outer_bndrs</span></a></span><span>
</span><span id="line-2191"></span><span>             </span><span class="hs-comment">-- Check if there are any nested `forall`s, which are illegal in a</span><span>
</span><span id="line-2192"></span><span>             </span><span class="hs-comment">-- `via` type.</span><span>
</span><span id="line-2193"></span><span>             </span><span class="hs-comment">-- See Note [No nested foralls or contexts in instance types]</span><span>
</span><span id="line-2194"></span><span>             </span><span class="hs-comment">-- (Wrinkle: Derived instances) in GHC.Hs.Type.</span><span>
</span><span id="line-2195"></span><span>             </span><span class="annot"><a href="GHC.Rename.Utils.html#addNoNestedForallsContextsErr"><span class="hs-identifier hs-type">addNoNestedForallsContextsErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062895"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-2196"></span><span>               </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#NFC_ViaType"><span class="hs-identifier hs-type">NFC_ViaType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062921"><span class="hs-identifier hs-type">via_body</span></a></span><span>
</span><span id="line-2197"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683062924"><span class="annot"><a href="#local-6989586621683062924"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062925"><span class="annot"><a href="#local-6989586621683062925"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#bindLocalNamesFV"><span class="hs-identifier hs-type">bindLocalNamesFV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062922"><span class="hs-identifier hs-type">via_tvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062897"><span class="hs-identifier hs-type">thing_inside</span></a></span><span>
</span><span id="line-2198"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ViaStrategy"><span class="hs-identifier hs-type">ViaStrategy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062915"><span class="hs-identifier hs-type">via_ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062924"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062916"><span class="hs-identifier hs-type">fvs1</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062925"><span class="hs-identifier hs-type">fvs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2199"></span><span>
</span><span id="line-2200"></span><span>    </span><span id="local-6989586621683060947"><span class="annot"><a href="#local-6989586621683062898"><span class="hs-identifier hs-type">boring_case</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621683060947"><span class="hs-identifier hs-type">ds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683060947"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683060720"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-2201"></span><span>    </span><span id="local-6989586621683062898"><span class="annot"><span class="annottext">boring_case :: forall ds. ds -&gt; RnM (ds, a, FreeVars)
</span><a href="#local-6989586621683062898"><span class="hs-identifier hs-var hs-var">boring_case</span></a></span></span><span> </span><span id="local-6989586621683062928"><span class="annot"><span class="annottext">ds
</span><a href="#local-6989586621683062928"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2202"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621683062929"><span class="annot"><a href="#local-6989586621683062929"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062930"><span class="annot"><a href="#local-6989586621683062930"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM (a, FreeVars)
</span><a href="#local-6989586621683062897"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-2203"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062928"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062929"><span class="hs-identifier hs-type">thing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062930"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2204"></span><span>
</span><span id="line-2205"></span><span class="annot"><a href="GHC.Rename.Module.html#rnFamDecl"><span class="hs-identifier hs-type">rnFamDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2206"></span><span>                        </span><span class="hs-comment">-- Just (cls, cls_tvs) =&gt; this FamilyDecl is nested</span><span>
</span><span id="line-2207"></span><span>                        </span><span class="hs-comment">--             inside an *class decl* for cls</span><span>
</span><span id="line-2208"></span><span>                        </span><span class="hs-comment">--             used for associated types</span><span>
</span><span id="line-2209"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyDecl"><span class="hs-identifier hs-type">FamilyDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2210"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyDecl"><span class="hs-identifier hs-type">FamilyDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2211"></span><span id="rnFamDecl"><span class="annot"><span class="annottext">rnFamDecl :: Maybe (Name, [Name])
-&gt; FamilyDecl GhcPs -&gt; RnM (FamilyDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamDecl"><span class="hs-identifier hs-var hs-var">rnFamDecl</span></a></span></span><span> </span><span id="local-6989586621683062931"><span class="annot"><span class="annottext">Maybe (Name, [Name])
</span><a href="#local-6989586621683062931"><span class="hs-identifier hs-var">mb_cls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyDecl"><span class="hs-identifier hs-type">FamilyDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdLName :: forall pass. FamilyDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#fdLName"><span class="hs-identifier hs-var">fdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062934"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683062934"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdTyVars :: forall pass. FamilyDecl pass -&gt; LHsQTyVars pass
</span><a href="Language.Haskell.Syntax.Decls.html#fdTyVars"><span class="hs-identifier hs-var">fdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062936"><span class="annot"><span class="annottext">LHsQTyVars GhcPs
</span><a href="#local-6989586621683062936"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span>
</span><span id="line-2212"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdTopLevel :: forall pass. FamilyDecl pass -&gt; TopLevelFlag
</span><a href="Language.Haskell.Syntax.Decls.html#fdTopLevel"><span class="hs-identifier hs-var">fdTopLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062938"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621683062938"><span class="hs-identifier hs-var">toplevel</span></a></span></span><span>
</span><span id="line-2213"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdFixity :: forall pass. FamilyDecl pass -&gt; LexicalFixity
</span><a href="Language.Haskell.Syntax.Decls.html#fdFixity"><span class="hs-identifier hs-var">fdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062940"><span class="annot"><span class="annottext">LexicalFixity
</span><a href="#local-6989586621683062940"><span class="hs-identifier hs-var">fixity</span></a></span></span><span>
</span><span id="line-2214"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdInfo :: forall pass. FamilyDecl pass -&gt; FamilyInfo pass
</span><a href="Language.Haskell.Syntax.Decls.html#fdInfo"><span class="hs-identifier hs-var">fdInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062942"><span class="annot"><span class="annottext">FamilyInfo GhcPs
</span><a href="#local-6989586621683062942"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdResultSig :: forall pass. FamilyDecl pass -&gt; LFamilyResultSig pass
</span><a href="Language.Haskell.Syntax.Decls.html#fdResultSig"><span class="hs-identifier hs-var">fdResultSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062944"><span class="annot"><span class="annottext">LFamilyResultSig GhcPs
</span><a href="#local-6989586621683062944"><span class="hs-identifier hs-var">res_sig</span></a></span></span><span>
</span><span id="line-2215"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdInjectivityAnn :: forall pass. FamilyDecl pass -&gt; Maybe (LInjectivityAnn pass)
</span><a href="Language.Haskell.Syntax.Decls.html#fdInjectivityAnn"><span class="hs-identifier hs-var">fdInjectivityAnn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683062946"><span class="annot"><span class="annottext">Maybe (LInjectivityAnn GhcPs)
</span><a href="#local-6989586621683062946"><span class="hs-identifier hs-var">injectivity</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2216"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683062947"><span class="annot"><a href="#local-6989586621683062947"><span class="hs-identifier hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062934"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-2217"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621683062948"><span class="annot"><a href="#local-6989586621683062948"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062949"><span class="annot"><a href="#local-6989586621683062949"><span class="hs-identifier hs-var">res_sig'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062950"><span class="annot"><a href="#local-6989586621683062950"><span class="hs-identifier hs-var">injectivity'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062951"><span class="annot"><a href="#local-6989586621683062951"><span class="hs-identifier hs-var">fv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2218"></span><span>            </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsQTyVars"><span class="hs-identifier hs-type">bindHsQTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062952"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062931"><span class="hs-identifier hs-type">mb_cls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062953"><span class="hs-identifier hs-type">kvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062936"><span class="hs-identifier hs-type">tyvars</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062954"><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062954"><span class="hs-identifier hs-var">tyvars'</span></a></span></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2219"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683062955"><span class="annot"><span class="annottext">rn_sig :: FamilyResultSig GhcPs -&gt; RnM (FamilyResultSig GhcRn, FreeVars)
</span><a href="#local-6989586621683062955"><span class="hs-identifier hs-var hs-var hs-var">rn_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; FamilyResultSig GhcPs -&gt; RnM (FamilyResultSig GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamResultSig"><span class="hs-identifier hs-var">rnFamResultSig</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062952"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-2220"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062957"><span class="annot"><a href="#local-6989586621683062957"><span class="hs-identifier hs-var">res_sig'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062958"><span class="annot"><a href="#local-6989586621683062958"><span class="hs-identifier hs-var">fv_kind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FamilyResultSig GhcPs -&gt; RnM (FamilyResultSig GhcRn, FreeVars))
-&gt; GenLocated EpAnnCO (FamilyResultSig GhcPs)
-&gt; TcM (GenLocated EpAnnCO (FamilyResultSig GhcRn), FreeVars)
forall a b c ann.
(a -&gt; TcM (b, c))
-&gt; GenLocated (EpAnn ann) a -&gt; TcM (GenLocated (EpAnn ann) b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-var">wrapLocFstMA</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig GhcPs -&gt; RnM (FamilyResultSig GhcRn, FreeVars)
</span><a href="#local-6989586621683062955"><span class="hs-identifier hs-var">rn_sig</span></a></span><span> </span><span class="annot"><span class="annottext">LFamilyResultSig GhcPs
GenLocated EpAnnCO (FamilyResultSig GhcPs)
</span><a href="#local-6989586621683062944"><span class="hs-identifier hs-var">res_sig</span></a></span><span>
</span><span id="line-2221"></span><span>               </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683062959"><span class="annot"><a href="#local-6989586621683062959"><span class="hs-identifier hs-var">injectivity'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Module.html#rnInjectivityAnn"><span class="hs-identifier hs-type">rnInjectivityAnn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062954"><span class="hs-identifier hs-type">tyvars'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062957"><span class="hs-identifier hs-type">res_sig'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2222"></span><span>                                          </span><span class="annot"><a href="#local-6989586621683062946"><span class="hs-identifier hs-type">injectivity</span></a></span><span>
</span><span id="line-2223"></span><span>               </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683062954"><span class="hs-identifier hs-type">tyvars'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062957"><span class="hs-identifier hs-type">res_sig'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062959"><span class="hs-identifier hs-type">injectivity'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062958"><span class="hs-identifier hs-type">fv_kind</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2224"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062961"><span class="annot"><a href="#local-6989586621683062961"><span class="hs-identifier hs-var">info'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062962"><span class="annot"><a href="#local-6989586621683062962"><span class="hs-identifier hs-var">fv2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683062963"><span class="hs-identifier hs-type">rn_info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062942"><span class="hs-identifier hs-type">info</span></a></span><span>
</span><span id="line-2225"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyDecl"><span class="hs-identifier hs-type">FamilyDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdExt"><span class="hs-identifier hs-var">fdExt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-type">noAnn</span></a></span><span>
</span><span id="line-2226"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdLName"><span class="hs-identifier hs-var">fdLName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062947"><span class="hs-identifier hs-type">tycon'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdTyVars"><span class="hs-identifier hs-var">fdTyVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062948"><span class="hs-identifier hs-type">tyvars'</span></a></span><span>
</span><span id="line-2227"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdTopLevel"><span class="hs-identifier hs-var">fdTopLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062938"><span class="hs-identifier hs-type">toplevel</span></a></span><span>
</span><span id="line-2228"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdFixity"><span class="hs-identifier hs-var">fdFixity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062940"><span class="hs-identifier hs-type">fixity</span></a></span><span>
</span><span id="line-2229"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdInfo"><span class="hs-identifier hs-var">fdInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062961"><span class="hs-identifier hs-type">info'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdResultSig"><span class="hs-identifier hs-var">fdResultSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062949"><span class="hs-identifier hs-type">res_sig'</span></a></span><span>
</span><span id="line-2230"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#fdInjectivityAnn"><span class="hs-identifier hs-var">fdInjectivityAnn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683062950"><span class="hs-identifier hs-type">injectivity'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2231"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062951"><span class="hs-identifier hs-type">fv1</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062962"><span class="hs-identifier hs-type">fv2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2233"></span><span>     </span><span id="local-6989586621683062952"><span class="annot"><span class="annottext">doc :: HsDocContext
</span><a href="#local-6989586621683062952"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#TyFamilyCtx"><span class="hs-identifier hs-var">TyFamilyCtx</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683062934"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-2234"></span><span>     </span><span id="local-6989586621683062953"><span class="annot"><span class="annottext">kvs :: FreeKiTyVars
</span><a href="#local-6989586621683062953"><span class="hs-identifier hs-var hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LFamilyResultSig GhcPs -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractRdrKindSigVars"><span class="hs-identifier hs-var">extractRdrKindSigVars</span></a></span><span> </span><span class="annot"><span class="annottext">LFamilyResultSig GhcPs
</span><a href="#local-6989586621683062944"><span class="hs-identifier hs-var">res_sig</span></a></span><span>
</span><span id="line-2235"></span><span>
</span><span id="line-2236"></span><span>     </span><span class="hs-comment">----------------------</span><span>
</span><span id="line-2237"></span><span>     </span><span class="annot"><a href="#local-6989586621683062963"><span class="hs-identifier hs-type">rn_info</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyInfo"><span class="hs-identifier hs-type">FamilyInfo</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyInfo"><span class="hs-identifier hs-type">FamilyInfo</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2238"></span><span>     </span><span id="local-6989586621683062963"><span class="annot"><span class="annottext">rn_info :: FamilyInfo GhcPs -&gt; RnM (FamilyInfo GhcRn, FreeVars)
</span><a href="#local-6989586621683062963"><span class="hs-identifier hs-var hs-var">rn_info</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClosedTypeFamily"><span class="hs-identifier hs-type">ClosedTypeFamily</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683062968"><span class="annot"><span class="annottext">[LTyFamInstEqn GhcPs]
</span><a href="#local-6989586621683062968"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2239"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062969"><span class="annot"><a href="#local-6989586621683062969"><span class="hs-identifier hs-var">eqns'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062970"><span class="annot"><a href="#local-6989586621683062970"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2240"></span><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FamEqn GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (FamEqn GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars))
-&gt; [LocatedA
      (FamEqn GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs)))]
-&gt; RnM
     ([LocatedA (FamEqn GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)))],
      FreeVars)
forall a b.
(a -&gt; RnM (b, FreeVars))
-&gt; [LocatedA a] -&gt; RnM ([LocatedA b], FreeVars)
</span><a href="GHC.Rename.Module.html#rnList"><span class="hs-identifier hs-var">rnList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssocTyFamInfo
-&gt; TyFamInstEqn GhcPs -&gt; RnM (TyFamInstEqn GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnTyFamInstEqn"><span class="hs-identifier hs-var">rnTyFamInstEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedTyFamInfo -&gt; AssocTyFamInfo
</span><a href="GHC.Rename.Module.html#NonAssocTyFamEqn"><span class="hs-identifier hs-var">NonAssocTyFamEqn</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedTyFamInfo
</span><a href="GHC.Rename.Module.html#ClosedTyFam"><span class="hs-identifier hs-var">ClosedTyFam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LTyFamInstEqn GhcPs]
[LocatedA (FamEqn GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs)))]
</span><a href="#local-6989586621683062968"><span class="hs-identifier hs-var">eqns</span></a></span><span>
</span><span id="line-2241"></span><span>                                          </span><span class="hs-comment">-- no class context</span><span>
</span><span id="line-2242"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClosedTypeFamily"><span class="hs-identifier hs-type">ClosedTypeFamily</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683062969"><span class="hs-identifier hs-type">eqns'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062970"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2243"></span><span>     </span><span class="annot"><a href="#local-6989586621683062963"><span class="hs-identifier hs-var">rn_info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClosedTypeFamily"><span class="hs-identifier hs-type">ClosedTypeFamily</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [LTyFamInstEqn GhcPs]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-2244"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FamilyInfo GhcRn, FreeVars) -&gt; RnM (FamilyInfo GhcRn, FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [LTyFamInstEqn GhcRn] -&gt; FamilyInfo GhcRn
forall pass. Maybe [LTyFamInstEqn pass] -&gt; FamilyInfo pass
</span><a href="Language.Haskell.Syntax.Decls.html#ClosedTypeFamily"><span class="hs-identifier hs-var">ClosedTypeFamily</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [LTyFamInstEqn GhcRn]
Maybe
  [LocatedA (FamEqn GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)))]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2245"></span><span>     </span><span class="annot"><a href="#local-6989586621683062963"><span class="hs-identifier hs-var">rn_info</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyInfo GhcPs
</span><a href="Language.Haskell.Syntax.Decls.html#OpenTypeFamily"><span class="hs-identifier hs-var">OpenTypeFamily</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FamilyInfo GhcRn, FreeVars) -&gt; RnM (FamilyInfo GhcRn, FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamilyInfo GhcRn
forall pass. FamilyInfo pass
</span><a href="Language.Haskell.Syntax.Decls.html#OpenTypeFamily"><span class="hs-identifier hs-var">OpenTypeFamily</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2246"></span><span>     </span><span class="annot"><a href="#local-6989586621683062963"><span class="hs-identifier hs-var">rn_info</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyInfo GhcPs
</span><a href="Language.Haskell.Syntax.Decls.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FamilyInfo GhcRn, FreeVars) -&gt; RnM (FamilyInfo GhcRn, FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamilyInfo GhcRn
forall pass. FamilyInfo pass
</span><a href="Language.Haskell.Syntax.Decls.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2247"></span><span>
</span><span id="line-2248"></span><span class="annot"><a href="GHC.Rename.Module.html#rnFamResultSig"><span class="hs-identifier hs-type">rnFamResultSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-2249"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyResultSig"><span class="hs-identifier hs-type">FamilyResultSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2250"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FamilyResultSig"><span class="hs-identifier hs-type">FamilyResultSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2251"></span><span id="rnFamResultSig"><span class="annot"><span class="annottext">rnFamResultSig :: HsDocContext
-&gt; FamilyResultSig GhcPs -&gt; RnM (FamilyResultSig GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnFamResultSig"><span class="hs-identifier hs-var hs-var">rnFamResultSig</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#NoSig"><span class="hs-identifier hs-type">NoSig</span></a></span><span> </span><span class="annot"><span class="annottext">XNoSig GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2252"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FamilyResultSig GhcRn, FreeVars)
-&gt; RnM (FamilyResultSig GhcRn, FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XNoSig GhcRn -&gt; FamilyResultSig GhcRn
forall pass. XNoSig pass -&gt; FamilyResultSig pass
</span><a href="Language.Haskell.Syntax.Decls.html#NoSig"><span class="hs-identifier hs-var">NoSig</span></a></span><span> </span><span class="annot"><span class="annottext">XNoSig GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2253"></span><span class="annot"><a href="GHC.Rename.Module.html#rnFamResultSig"><span class="hs-identifier hs-var">rnFamResultSig</span></a></span><span> </span><span id="local-6989586621683062974"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062974"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#KindSig"><span class="hs-identifier hs-type">KindSig</span></a></span><span> </span><span class="annot"><span class="annottext">XCKindSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062976"><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062976"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2254"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683062977"><span class="annot"><a href="#local-6989586621683062977"><span class="hs-identifier hs-var">rndKind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683062978"><span class="annot"><a href="#local-6989586621683062978"><span class="hs-identifier hs-var">ftvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext -&gt; LHsType GhcPs -&gt; RnM (LHsType GhcRn, FreeVars)
</span><a href="GHC.Rename.HsType.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062974"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683062976"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-2255"></span><span>        </span><span class="hs-special">;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#KindSig"><span class="hs-identifier hs-type">KindSig</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062977"><span class="hs-identifier hs-type">rndKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683062978"><span class="hs-identifier hs-type">ftvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2256"></span><span class="annot"><a href="GHC.Rename.Module.html#rnFamResultSig"><span class="hs-identifier hs-var">rnFamResultSig</span></a></span><span> </span><span id="local-6989586621683062979"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683062979"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyVarSig"><span class="hs-identifier hs-type">TyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">XTyVarSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062981"><span class="annot"><span class="annottext">LHsTyVarBndr () GhcPs
</span><a href="#local-6989586621683062981"><span class="hs-identifier hs-var">tvbndr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2257"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- `TyVarSig` tells us that user named the result of a type family by</span><span>
</span><span id="line-2258"></span><span>          </span><span class="hs-comment">-- writing `= tyvar` or `= (tyvar :: kind)`. In such case we want to</span><span>
</span><span id="line-2259"></span><span>          </span><span class="hs-comment">-- be sure that the supplied result name is not identical to an</span><span>
</span><span id="line-2260"></span><span>          </span><span class="hs-comment">-- already in-scope type variable from an enclosing class.</span><span>
</span><span id="line-2261"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-2262"></span><span>          </span><span class="hs-comment">--  Example of disallowed declaration:</span><span>
</span><span id="line-2263"></span><span>          </span><span class="hs-comment">--         class C a b where</span><span>
</span><span id="line-2264"></span><span>          </span><span class="hs-comment">--            type F b = a | a -&gt; b</span><span>
</span><span id="line-2265"></span><span>          </span><span id="local-6989586621683062982"><span class="annot"><a href="#local-6989586621683062982"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RnM LocalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a></span><span>
</span><span id="line-2266"></span><span>
</span><span id="line-2267"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Hs.Type.html#hsBndrVar"><span class="hs-identifier hs-type">hsBndrVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062981"><span class="hs-identifier hs-type">tvbndr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2268"></span><span>          </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsBndrWildCard"><span class="hs-identifier hs-type">HsBndrWildCard</span></a></span><span> </span><span class="annot"><span class="annottext">XBndrWildCard GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2269"></span><span>            </span><span class="hs-comment">-- See Note [Wildcard binders in disallowed contexts] in GHC.Hs.Type</span><span>
</span><span id="line-2270"></span><span>            </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsTyVarBndr () GhcPs) -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcPs
GenLocated SrcSpanAnnA (HsTyVarBndr () GhcPs)
</span><a href="#local-6989586621683062981"><span class="hs-identifier hs-var">tvbndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2271"></span><span>              </span><span class="annot"><span class="annottext">Maybe Name -&gt; BadAnonWildcardContext -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIllegalWildcardInType"><span class="hs-identifier hs-var">TcRnIllegalWildcardInType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">BadAnonWildcardContext
</span><a href="GHC.Tc.Errors.Types.html#WildcardBndrInTyFamResultVar"><span class="hs-identifier hs-var">WildcardBndrInTyFamResultVar</span></a></span><span>
</span><span id="line-2272"></span><span>          </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsBndrVar"><span class="hs-identifier hs-type">HsBndrVar</span></a></span><span> </span><span class="annot"><span class="annottext">XBndrVar GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062989"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683062989"><span class="hs-identifier hs-var">resName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2273"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683062989"><span class="hs-identifier hs-var">resName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; LocalRdrEnv -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#elemLocalRdrEnv"><span class="hs-operator hs-var">`elemLocalRdrEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv
</span><a href="#local-6989586621683062982"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2274"></span><span>            </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsTyVarBndr () GhcPs) -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcPs
GenLocated SrcSpanAnnA (HsTyVarBndr () GhcPs)
</span><a href="#local-6989586621683062981"><span class="hs-identifier hs-var">tvbndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2275"></span><span>              </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnShadowedTyVarNameInFamResult"><span class="hs-identifier hs-var">TcRnShadowedTyVarNameInFamResult</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
RdrName
</span><a href="#local-6989586621683062989"><span class="hs-identifier hs-var">resName</span></a></span><span>
</span><span id="line-2276"></span><span>
</span><span id="line-2277"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindLHsTyVarBndr"><span class="hs-identifier hs-type">bindLHsTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062979"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-comment">-- This might be a lie, but it's used for</span><span>
</span><span id="line-2278"></span><span>                                      </span><span class="hs-comment">-- scoping checks that are irrelevant here</span><span>
</span><span id="line-2279"></span><span>                          </span><span class="annot"><a href="#local-6989586621683062981"><span class="hs-identifier hs-type">tvbndr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683062993"><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn
</span><a href="#local-6989586621683062993"><span class="hs-identifier hs-var">tvbndr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2280"></span><span>         </span><span class="annot"><span class="annottext">(FamilyResultSig GhcRn, FreeVars)
-&gt; RnM (FamilyResultSig GhcRn, FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XTyVarSig GhcRn -&gt; LHsTyVarBndr () GhcRn -&gt; FamilyResultSig GhcRn
forall pass.
XTyVarSig pass -&gt; LHsTyVarBndr () pass -&gt; FamilyResultSig pass
</span><a href="Language.Haskell.Syntax.Decls.html#TyVarSig"><span class="hs-identifier hs-var">TyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">XTyVarSig GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn
</span><a href="#local-6989586621683062993"><span class="hs-identifier hs-var">tvbndr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; (Name -&gt; FreeVars) -&gt; Maybe Name -&gt; FreeVars
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn -&gt; Maybe (IdP GhcRn)
forall flag (p :: Pass).
LHsTyVarBndr flag (GhcPass p) -&gt; Maybe (IdP (GhcPass p))
</span><a href="GHC.Hs.Type.html#hsLTyVarName"><span class="hs-identifier hs-var">hsLTyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn
</span><a href="#local-6989586621683062993"><span class="hs-identifier hs-var">tvbndr'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2281"></span><span>
</span><span id="line-2282"></span><span class="hs-comment">-- Note [Renaming injectivity annotation]</span><span>
</span><span id="line-2283"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-2284"></span><span class="hs-comment">--</span><span>
</span><span id="line-2285"></span><span class="hs-comment">-- During renaming of injectivity annotation we have to make several checks to</span><span>
</span><span id="line-2286"></span><span class="hs-comment">-- make sure that it is well-formed.  At the moment injectivity annotation</span><span>
</span><span id="line-2287"></span><span class="hs-comment">-- consists of a single injectivity condition, so the terms &quot;injectivity</span><span>
</span><span id="line-2288"></span><span class="hs-comment">-- annotation&quot; and &quot;injectivity condition&quot; might be used interchangeably.  See</span><span>
</span><span id="line-2289"></span><span class="hs-comment">-- Note [Injectivity annotation] for a detailed discussion of currently allowed</span><span>
</span><span id="line-2290"></span><span class="hs-comment">-- injectivity annotations.</span><span>
</span><span id="line-2291"></span><span class="hs-comment">--</span><span>
</span><span id="line-2292"></span><span class="hs-comment">-- Checking LHS is simple because the only type variable allowed on the LHS of</span><span>
</span><span id="line-2293"></span><span class="hs-comment">-- injectivity condition is the variable naming the result in type family head.</span><span>
</span><span id="line-2294"></span><span class="hs-comment">-- Example of disallowed annotation:</span><span>
</span><span id="line-2295"></span><span class="hs-comment">--</span><span>
</span><span id="line-2296"></span><span class="hs-comment">--     type family Foo a b = r | b -&gt; a</span><span>
</span><span id="line-2297"></span><span class="hs-comment">--</span><span>
</span><span id="line-2298"></span><span class="hs-comment">-- Verifying RHS of injectivity consists of checking that:</span><span>
</span><span id="line-2299"></span><span class="hs-comment">--</span><span>
</span><span id="line-2300"></span><span class="hs-comment">--  1. only variables defined in type family head appear on the RHS (kind</span><span>
</span><span id="line-2301"></span><span class="hs-comment">--     variables are also allowed).  Example of disallowed annotation:</span><span>
</span><span id="line-2302"></span><span class="hs-comment">--</span><span>
</span><span id="line-2303"></span><span class="hs-comment">--        type family Foo a = r | r -&gt; b</span><span>
</span><span id="line-2304"></span><span class="hs-comment">--</span><span>
</span><span id="line-2305"></span><span class="hs-comment">--  2. for associated types the result variable does not shadow any of type</span><span>
</span><span id="line-2306"></span><span class="hs-comment">--     class variables. Example of disallowed annotation:</span><span>
</span><span id="line-2307"></span><span class="hs-comment">--</span><span>
</span><span id="line-2308"></span><span class="hs-comment">--        class Foo a b where</span><span>
</span><span id="line-2309"></span><span class="hs-comment">--           type F a = b | b -&gt; a</span><span>
</span><span id="line-2310"></span><span class="hs-comment">--</span><span>
</span><span id="line-2311"></span><span class="hs-comment">-- Breaking any of these assumptions results in an error.</span><span>
</span><span id="line-2312"></span><span>
</span><span id="line-2313"></span><span class="hs-comment">-- | Rename injectivity annotation. Note that injectivity annotation is just the</span><span>
</span><span id="line-2314"></span><span class="hs-comment">-- part after the &quot;|&quot;.  Everything that appears before it is renamed in</span><span>
</span><span id="line-2315"></span><span class="hs-comment">-- rnFamDecl.</span><span>
</span><span id="line-2316"></span><span class="annot"><a href="GHC.Rename.Module.html#rnInjectivityAnn"><span class="hs-identifier hs-type">rnInjectivityAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>           </span><span class="hs-comment">-- ^ Type variables declared in</span><span>
</span><span id="line-2317"></span><span>                                               </span><span class="hs-comment">--   type family head</span><span>
</span><span id="line-2318"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LFamilyResultSig"><span class="hs-identifier hs-type">LFamilyResultSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Result signature</span></span><span>
</span><span id="line-2319"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInjectivityAnn"><span class="hs-identifier hs-type">LInjectivityAnn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Injectivity annotation</span></span><span>
</span><span id="line-2320"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInjectivityAnn"><span class="hs-identifier hs-type">LInjectivityAnn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2321"></span><span id="rnInjectivityAnn"><span class="annot"><span class="annottext">rnInjectivityAnn :: LHsQTyVars GhcRn
-&gt; LFamilyResultSig GhcRn
-&gt; LInjectivityAnn GhcPs
-&gt; RnM (LInjectivityAnn GhcRn)
</span><a href="GHC.Rename.Module.html#rnInjectivityAnn"><span class="hs-identifier hs-var hs-var">rnInjectivityAnn</span></a></span></span><span> </span><span id="local-6989586621683062995"><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062995"><span class="hs-identifier hs-var">tvBndrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyVarSig"><span class="hs-identifier hs-type">TyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">XTyVarSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683062996"><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn
</span><a href="#local-6989586621683062996"><span class="hs-identifier hs-var">resTv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2322"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683062997"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062997"><span class="hs-identifier hs-var">srcSpan</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InjectivityAnn"><span class="hs-identifier hs-type">InjectivityAnn</span></a></span><span> </span><span id="local-6989586621683062999"><span class="annot"><span class="annottext">XCInjectivityAnn GhcPs
</span><a href="#local-6989586621683062999"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683063000"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683063000"><span class="hs-identifier hs-var">injFrom</span></a></span></span><span> </span><span id="local-6989586621683063001"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683063001"><span class="hs-identifier hs-var">injTo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2323"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2324"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063002"><span class="annot"><a href="#local-6989586621683063002"><span class="hs-identifier hs-var">injDecl'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InjectivityAnn"><span class="hs-identifier hs-type">InjectivityAnn</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063003"><span class="annot"><a href="#local-6989586621683063003"><span class="hs-identifier hs-var">injFrom'</span></a></span></span><span> </span><span id="local-6989586621683063004"><span class="annot"><a href="#local-6989586621683063004"><span class="hs-identifier hs-var">injTo'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063005"><span class="annot"><a href="#local-6989586621683063005"><span class="hs-identifier hs-var">noRnErrors</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2325"></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv
  (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool)
forall a. TcRn a -&gt; TcRn (a, Bool)
</span><a href="GHC.Tc.Utils.Monad.html#askNoErrs"><span class="hs-identifier hs-var">askNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv
   (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
 -&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2326"></span><span>             </span><span class="annot"><span class="annottext">[Name]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
forall a. [Name] -&gt; RnM a -&gt; RnM a
</span><a href="GHC.Rename.Utils.html#bindLocalNames"><span class="hs-identifier hs-var">bindLocalNames</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; [Name]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn -&gt; Maybe (IdP GhcRn)
forall flag (p :: Pass).
LHsTyVarBndr flag (GhcPass p) -&gt; Maybe (IdP (GhcPass p))
</span><a href="GHC.Hs.Type.html#hsLTyVarName"><span class="hs-identifier hs-var">hsLTyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">LHsTyVarBndr () GhcRn
</span><a href="#local-6989586621683062996"><span class="hs-identifier hs-var">resTv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IOEnv
   (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv)
      (GenLocated EpAnnCO (InjectivityAnn GhcRn)))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2327"></span><span>             </span><span class="hs-comment">-- The return type variable scopes over the injectivity annotation</span><span>
</span><span id="line-2328"></span><span>             </span><span class="hs-comment">-- e.g.   type family F a = (r::*) | r -&gt; a</span><span>
</span><span id="line-2329"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683063007"><span class="annot"><a href="#local-6989586621683063007"><span class="hs-identifier hs-var">injFrom'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.HsType.html#rnLTyVar"><span class="hs-identifier hs-var">rnLTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683063000"><span class="hs-identifier hs-var">injFrom</span></a></span><span>
</span><span id="line-2330"></span><span>                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063009"><span class="annot"><a href="#local-6989586621683063009"><span class="hs-identifier hs-var">injTo'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnLTyVar"><span class="hs-identifier hs-type">rnLTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063001"><span class="hs-identifier hs-type">injTo</span></a></span><span>
</span><span id="line-2331"></span><span>                </span><span class="hs-comment">-- Note: srcSpan is unchanged, but typechecker gets</span><span>
</span><span id="line-2332"></span><span>                </span><span class="hs-comment">-- confused, l2l call makes it happy</span><span>
</span><span id="line-2333"></span><span>                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-type">l2l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062997"><span class="hs-identifier hs-type">srcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InjectivityAnn"><span class="hs-identifier hs-type">InjectivityAnn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062999"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063007"><span class="hs-identifier hs-type">injFrom'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063009"><span class="hs-identifier hs-type">injTo'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2334"></span><span>
</span><span id="line-2335"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063011"><span class="annot"><a href="#local-6989586621683063011"><span class="hs-identifier hs-var hs-var">tvNames</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Set Name
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Set Name) -&gt; [Name] -&gt; Set Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsQTyVars GhcRn -&gt; [Name]
</span><a href="GHC.Hs.Type.html#hsAllLTyVarNames"><span class="hs-identifier hs-var">hsAllLTyVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><a href="#local-6989586621683062995"><span class="hs-identifier hs-var">tvBndrs</span></a></span><span>
</span><span id="line-2336"></span><span>
</span><span id="line-2337"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Hs.Type.html#hsLTyVarName"><span class="hs-identifier hs-type">hsLTyVarName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683062996"><span class="hs-identifier hs-type">resTv</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe (IdP GhcRn)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2338"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683063012"><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621683063012"><span class="hs-identifier hs-var">resName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2339"></span><span>
</span><span id="line-2340"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [Renaming injectivity annotation]</span><span>
</span><span id="line-2341"></span><span>         </span><span id="local-6989586621683063013"><span class="annot"><span class="annottext">lhsValid :: Bool
</span><a href="#local-6989586621683063013"><span class="hs-identifier hs-var hs-var hs-var">lhsValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Ordering
</span><a href="GHC.Types.Name.html#stableNameCmp"><span class="hs-identifier hs-var">stableNameCmp</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
Name
</span><a href="#local-6989586621683063012"><span class="hs-identifier hs-var">resName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683063003"><span class="hs-identifier hs-var">injFrom'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2342"></span><span>         </span><span id="local-6989586621683063015"><span class="annot"><span class="annottext">rhsValid :: Set Name
</span><a href="#local-6989586621683063015"><span class="hs-identifier hs-var hs-var hs-var">rhsValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Set Name
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN Name -&gt; Name)
-&gt; [GenLocated SrcSpanAnnN Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name -&gt; Name
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[LIdP GhcRn]
[GenLocated SrcSpanAnnN Name]
</span><a href="#local-6989586621683063004"><span class="hs-identifier hs-var">injTo'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621683063011"><span class="hs-identifier hs-var">tvNames</span></a></span><span>
</span><span id="line-2343"></span><span>
</span><span id="line-2344"></span><span>   </span><span class="hs-comment">-- if renaming of type variables ended with errors (eg. there were</span><span>
</span><span id="line-2345"></span><span>   </span><span class="hs-comment">-- not-in-scope variables) don't check the validity of injectivity</span><span>
</span><span id="line-2346"></span><span>   </span><span class="hs-comment">-- annotation. This gives better error messages.</span><span>
</span><span id="line-2347"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683063005"><span class="hs-identifier hs-var">noRnErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683063013"><span class="hs-identifier hs-var">lhsValid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2348"></span><span>        </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683063000"><span class="hs-identifier hs-var">injFrom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2349"></span><span>          </span><span class="annot"><span class="annottext">IdP GhcRn -&gt; LIdP GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIncorrectTyVarOnLhsOfInjCond"><span class="hs-identifier hs-var">TcRnIncorrectTyVarOnLhsOfInjCond</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
</span><a href="#local-6989586621683063012"><span class="hs-identifier hs-var">resName</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683063000"><span class="hs-identifier hs-var">injFrom</span></a></span><span>
</span><span id="line-2350"></span><span>
</span><span id="line-2351"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683063005"><span class="hs-identifier hs-var">noRnErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621683063015"><span class="hs-identifier hs-var">rhsValid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2352"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063017"><span class="annot"><span class="annottext">errorVars :: [Name]
</span><a href="#local-6989586621683063017"><span class="hs-identifier hs-var hs-var">errorVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Name]
forall a. Set a -&gt; [a]
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621683063015"><span class="hs-identifier hs-var">rhsValid</span></a></span><span>
</span><span id="line-2353"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpAnnCO -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683062997"><span class="hs-identifier hs-var">srcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRnMessage -&gt; TcRn ()) -&gt; TcRnMessage -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2354"></span><span>              </span><span class="annot"><span class="annottext">[Name] -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnUnknownTyVarsOnRhsOfInjCond"><span class="hs-identifier hs-var">TcRnUnknownTyVarsOnRhsOfInjCond</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683063017"><span class="hs-identifier hs-var">errorVars</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2355"></span><span>
</span><span id="line-2356"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683063002"><span class="hs-identifier hs-type">injDecl'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2357"></span><span>
</span><span id="line-2358"></span><span class="hs-comment">-- We can only hit this case when the user writes injectivity annotation without</span><span>
</span><span id="line-2359"></span><span class="hs-comment">-- naming the result:</span><span>
</span><span id="line-2360"></span><span class="hs-comment">--</span><span>
</span><span id="line-2361"></span><span class="hs-comment">--   type family F a | result -&gt; a</span><span>
</span><span id="line-2362"></span><span class="hs-comment">--   type family F a :: * | result -&gt; a</span><span>
</span><span id="line-2363"></span><span class="hs-comment">--</span><span>
</span><span id="line-2364"></span><span class="hs-comment">-- So we rename injectivity annotation like we normally would except that</span><span>
</span><span id="line-2365"></span><span class="hs-comment">-- this time we expect &quot;result&quot; to be reported not in scope by rnLTyVar.</span><span>
</span><span id="line-2366"></span><span class="annot"><a href="GHC.Rename.Module.html#rnInjectivityAnn"><span class="hs-identifier hs-var">rnInjectivityAnn</span></a></span><span> </span><span class="annot"><span class="annottext">LHsQTyVars GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LFamilyResultSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063019"><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683063019"><span class="hs-identifier hs-var">srcSpan</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InjectivityAnn"><span class="hs-identifier hs-type">InjectivityAnn</span></a></span><span> </span><span id="local-6989586621683063020"><span class="annot"><span class="annottext">XCInjectivityAnn GhcPs
</span><a href="#local-6989586621683063020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683063021"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683063021"><span class="hs-identifier hs-var">injFrom</span></a></span></span><span> </span><span id="local-6989586621683063022"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683063022"><span class="hs-identifier hs-var">injTo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2367"></span><span>   </span><span class="annot"><span class="annottext">EpAnnCO
-&gt; RnM (LInjectivityAnn GhcRn) -&gt; RnM (LInjectivityAnn GhcRn)
forall ann a. EpAnn ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><a href="#local-6989586621683063019"><span class="hs-identifier hs-var">srcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM (LInjectivityAnn GhcRn) -&gt; RnM (LInjectivityAnn GhcRn))
-&gt; RnM (LInjectivityAnn GhcRn) -&gt; RnM (LInjectivityAnn GhcRn)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2368"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621683063023"><span class="annot"><a href="#local-6989586621683063023"><span class="hs-identifier hs-var">injDecl'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv
  (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool)
forall a. TcRn a -&gt; TcRn (a, Bool)
</span><a href="GHC.Tc.Utils.Monad.html#askNoErrs"><span class="hs-identifier hs-var">askNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">(IOEnv
   (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
 -&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated EpAnnCO (InjectivityAnn GhcRn))
-&gt; TcRn (GenLocated EpAnnCO (InjectivityAnn GhcRn), Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2369"></span><span>     </span><span id="local-6989586621683063024"><span class="annot"><a href="#local-6989586621683063024"><span class="hs-identifier hs-var">injFrom'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.HsType.html#rnLTyVar"><span class="hs-identifier hs-var">rnLTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683063021"><span class="hs-identifier hs-var">injFrom</span></a></span><span>
</span><span id="line-2370"></span><span>     </span><span id="local-6989586621683063025"><span class="annot"><a href="#local-6989586621683063025"><span class="hs-identifier hs-var">injTo'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnLTyVar"><span class="hs-identifier hs-type">rnLTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063022"><span class="hs-identifier hs-type">injTo</span></a></span><span>
</span><span id="line-2371"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063019"><span class="hs-identifier hs-type">srcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InjectivityAnn"><span class="hs-identifier hs-type">InjectivityAnn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063020"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063024"><span class="hs-identifier hs-type">injFrom'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063025"><span class="hs-identifier hs-type">injTo'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2372"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621683063023"><span class="hs-identifier hs-type">injDecl'</span></a></span><span>
</span><span id="line-2373"></span><span>
</span><span id="line-2374"></span><span class="hs-comment">{-
Note [Stupid theta]
~~~~~~~~~~~~~~~~~~~
#3850 complains about a regression wrt 6.10 for
     data Show a =&gt; T a
There is no reason not to allow the stupid theta if there are no data
constructors.  It's still stupid, but does no harm, and I don't want
to cause programs to break unnecessarily (notably HList).  So if there
are no data constructors we allow h98_style = True
-}</span><span>
</span><span id="line-2384"></span><span>
</span><span id="line-2385"></span><span>
</span><span id="line-2386"></span><span class="annot"><span class="hs-comment">{- *****************************************************
*                                                      *
     Support code for type/data declarations
*                                                      *
***************************************************** -}</span></span><span>
</span><span id="line-2391"></span><span>
</span><span id="line-2392"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2393"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDecls"><span class="hs-identifier hs-type">rnConDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataDefnCons"><span class="hs-identifier hs-type">DataDefnCons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataDefnCons"><span class="hs-identifier hs-type">DataDefnCons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LConDecl"><span class="hs-identifier hs-type">LConDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2394"></span><span id="rnConDecls"><span class="annot"><span class="annottext">rnConDecls :: DataDefnCons (LConDecl GhcPs)
-&gt; RnM (DataDefnCons (LConDecl GhcRn), FreeVars)
</span><a href="GHC.Rename.Module.html#rnConDecls"><span class="hs-identifier hs-var hs-var">rnConDecls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (ConDecl GhcPs)
 -&gt; RnM (GenLocated SrcSpanAnnA (ConDecl GhcRn), FreeVars))
-&gt; DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcPs))
-&gt; RnM
     (DataDefnCons (GenLocated SrcSpanAnnA (ConDecl GhcRn)), FreeVars)
forall (f :: * -&gt; *) a b.
Traversable f =&gt;
(a -&gt; RnM (b, FreeVars)) -&gt; f a -&gt; RnM (f b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConDecl GhcPs -&gt; TcM (ConDecl GhcRn, FreeVars))
-&gt; GenLocated SrcSpanAnnA (ConDecl GhcPs)
-&gt; RnM (GenLocated SrcSpanAnnA (ConDecl GhcRn), FreeVars)
forall a b c ann.
(a -&gt; TcM (b, c))
-&gt; GenLocated (EpAnn ann) a -&gt; TcM (GenLocated (EpAnn ann) b, c)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocFstMA"><span class="hs-identifier hs-var">wrapLocFstMA</span></a></span><span> </span><span class="annot"><span class="annottext">ConDecl GhcPs -&gt; TcM (ConDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnConDecl"><span class="hs-identifier hs-var">rnConDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2395"></span><span>
</span><span id="line-2396"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDecl"><span class="hs-identifier hs-type">rnConDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDecl"><span class="hs-identifier hs-type">ConDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDecl"><span class="hs-identifier hs-type">ConDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2397"></span><span id="rnConDecl"><span class="annot"><span class="annottext">rnConDecl :: ConDecl GhcPs -&gt; TcM (ConDecl GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnConDecl"><span class="hs-identifier hs-var hs-var">rnConDecl</span></a></span></span><span> </span><span id="local-6989586621683063027"><span class="annot"><span class="annottext">decl :: ConDecl GhcPs
</span><a href="#local-6989586621683063027"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclH98"><span class="hs-identifier hs-type">ConDeclH98</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_name :: forall pass. ConDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_name"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063029"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683063029"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_ex_tvs :: forall pass. ConDecl pass -&gt; [LHsTyVarBndr Specificity pass]
</span><a href="Language.Haskell.Syntax.Decls.html#con_ex_tvs"><span class="hs-identifier hs-var">con_ex_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063031"><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcPs]
</span><a href="#local-6989586621683063031"><span class="hs-identifier hs-var">ex_tvs</span></a></span></span><span>
</span><span id="line-2398"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_mb_cxt :: forall pass. ConDecl pass -&gt; Maybe (LHsContext pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_mb_cxt"><span class="hs-identifier hs-var">con_mb_cxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063033"><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063033"><span class="hs-identifier hs-var">mcxt</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_args :: forall pass. ConDecl pass -&gt; HsConDeclH98Details pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063034"><span class="annot"><span class="annottext">HsConDeclH98Details GhcPs
</span><a href="#local-6989586621683063034"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-2399"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_doc :: forall pass. ConDecl pass -&gt; Maybe (LHsDoc pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_doc"><span class="hs-identifier hs-var">con_doc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063036"><span class="annot"><span class="annottext">Maybe (LHsDoc GhcPs)
</span><a href="#local-6989586621683063036"><span class="hs-identifier hs-var">mb_doc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_forall :: forall pass. ConDecl pass -&gt; Bool
</span><a href="Language.Haskell.Syntax.Decls.html#con_forall"><span class="hs-identifier hs-var">con_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063038"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683063038"><span class="hs-identifier hs-var">forall_</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2400"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; TcRn ()) -&gt; GenLocated SrcSpanAnnN RdrName -&gt; TcRn ()
forall t a b. HasLoc t =&gt; (a -&gt; TcM b) -&gt; GenLocated t a -&gt; TcM b
</span><a href="GHC.Tc.Utils.Monad.html#addLocM"><span class="hs-identifier hs-var">addLocM</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; TcRn ()
</span><a href="GHC.Rename.Names.html#checkConName"><span class="hs-identifier hs-var">checkConName</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683063029"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-2401"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063040"><span class="annot"><a href="#local-6989586621683063040"><span class="hs-identifier hs-var">new_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-type">lookupLocatedTopConstructorRnN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063029"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-2402"></span><span>
</span><span id="line-2403"></span><span>        </span><span class="hs-comment">-- We bind no implicit binders here; this is just like</span><span>
</span><span id="line-2404"></span><span>        </span><span class="hs-comment">-- a nested HsForAllTy.  E.g. consider</span><span>
</span><span id="line-2405"></span><span>        </span><span class="hs-comment">--         data T a = forall (b::k). MkT (...)</span><span>
</span><span id="line-2406"></span><span>        </span><span class="hs-comment">-- The 'k' will already be in scope from the bindHsQTyVars</span><span>
</span><span id="line-2407"></span><span>        </span><span class="hs-comment">-- for the data decl itself. So we'll get</span><span>
</span><span id="line-2408"></span><span>        </span><span class="hs-comment">--         data T {k} a = ...</span><span>
</span><span id="line-2409"></span><span>        </span><span class="hs-comment">-- And indeed we may later discover (a::k).  But that's the</span><span>
</span><span id="line-2410"></span><span>        </span><span class="hs-comment">-- scoping we get.  So no implicit binders at the existential forall</span><span>
</span><span id="line-2411"></span><span>
</span><span id="line-2412"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063041"><span class="annot"><a href="#local-6989586621683063041"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN Name] -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621683063040"><span class="hs-identifier hs-var">new_name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2413"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-type">bindLHsTyVarBndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063041"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#WarnUnusedForalls"><span class="hs-identifier hs-type">WarnUnusedForalls</span></a></span><span>
</span><span id="line-2414"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683063031"><span class="hs-identifier hs-type">ex_tvs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683063043"><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcRn]
</span><a href="#local-6989586621683063043"><span class="hs-identifier hs-var">new_ex_tvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2415"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063044"><span class="annot"><a href="#local-6989586621683063044"><span class="hs-identifier hs-var">new_context</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063045"><span class="annot"><a href="#local-6989586621683063045"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe (LHsContext GhcPs)
-&gt; RnM (Maybe (LHsContext GhcRn), FreeVars)
</span><a href="GHC.Rename.Module.html#rnMbContext"><span class="hs-identifier hs-var">rnMbContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063041"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063033"><span class="hs-identifier hs-var">mcxt</span></a></span><span>
</span><span id="line-2416"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063047"><span class="annot"><a href="#local-6989586621683063047"><span class="hs-identifier hs-var">new_args</span></a></span></span><span class="hs-special">,</span><span>    </span><span id="local-6989586621683063048"><span class="annot"><a href="#local-6989586621683063048"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclH98Details"><span class="hs-identifier hs-type">rnConDeclH98Details</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063040"><span class="hs-identifier hs-type">new_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063041"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063034"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2417"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063050"><span class="annot"><a href="#local-6989586621683063050"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683063045"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683063048"><span class="hs-identifier hs-var">fvs2</span></a></span><span>
</span><span id="line-2418"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnConDecl (ConDeclH98)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063029"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-2419"></span><span>             </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;ex_tvs:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063031"><span class="hs-identifier hs-type">ex_tvs</span></a></span><span>
</span><span id="line-2420"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;new_ex_dqtvs':&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063043"><span class="hs-identifier hs-type">new_ex_tvs</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2421"></span><span>
</span><span id="line-2422"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063051"><span class="annot"><a href="#local-6989586621683063051"><span class="hs-identifier hs-var">mb_doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063036"><span class="hs-identifier hs-type">mb_doc</span></a></span><span>
</span><span id="line-2423"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683063027"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_ext"><span class="hs-identifier hs-var">con_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span>
</span><span id="line-2424"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_name"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063040"><span class="hs-identifier hs-type">new_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_ex_tvs"><span class="hs-identifier hs-var">con_ex_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063043"><span class="hs-identifier hs-type">new_ex_tvs</span></a></span><span>
</span><span id="line-2425"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_mb_cxt"><span class="hs-identifier hs-var">con_mb_cxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063044"><span class="hs-identifier hs-type">new_context</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063047"><span class="hs-identifier hs-type">new_args</span></a></span><span>
</span><span id="line-2426"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_doc"><span class="hs-identifier hs-var">con_doc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063051"><span class="hs-identifier hs-type">mb_doc'</span></a></span><span>
</span><span id="line-2427"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_forall"><span class="hs-identifier hs-var">con_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063038"><span class="hs-identifier hs-type">forall_</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Remove when #18311 is fixed</span><span>
</span><span id="line-2428"></span><span>                  </span><span class="annot"><a href="#local-6989586621683063050"><span class="hs-identifier hs-type">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-2429"></span><span>
</span><span id="line-2430"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDecl"><span class="hs-identifier hs-var">rnConDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclGADT"><span class="hs-identifier hs-type">ConDeclGADT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_names :: forall pass. ConDecl pass -&gt; NonEmpty (LIdP pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_names"><span class="hs-identifier hs-var">con_names</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063055"><span class="annot"><span class="annottext">NonEmpty (LIdP GhcPs)
</span><a href="#local-6989586621683063055"><span class="hs-identifier hs-var">names</span></a></span></span><span>
</span><span id="line-2431"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_bndrs :: forall pass. ConDecl pass -&gt; XRec pass (HsOuterSigTyVarBndrs pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_bndrs"><span class="hs-identifier hs-var">con_bndrs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063057"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063057"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683063058"><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcPs
</span><a href="#local-6989586621683063058"><span class="hs-identifier hs-var">outer_bndrs</span></a></span></span><span>
</span><span id="line-2432"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_mb_cxt :: forall pass. ConDecl pass -&gt; Maybe (LHsContext pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_mb_cxt"><span class="hs-identifier hs-var">con_mb_cxt</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063059"><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063059"><span class="hs-identifier hs-var">mcxt</span></a></span></span><span>
</span><span id="line-2433"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_g_args :: forall pass. ConDecl pass -&gt; HsConDeclGADTDetails pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_g_args"><span class="hs-identifier hs-var">con_g_args</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063060"><span class="annot"><span class="annottext">HsConDeclGADTDetails GhcPs
</span><a href="#local-6989586621683063060"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-2434"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_res_ty :: forall pass. ConDecl pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_res_ty"><span class="hs-identifier hs-var">con_res_ty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063062"><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683063062"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-2435"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_doc :: forall pass. ConDecl pass -&gt; Maybe (LHsDoc pass)
</span><a href="Language.Haskell.Syntax.Decls.html#con_doc"><span class="hs-identifier hs-var">con_doc</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063063"><span class="annot"><span class="annottext">Maybe (LHsDoc GhcPs)
</span><a href="#local-6989586621683063063"><span class="hs-identifier hs-var">mb_doc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2436"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName -&gt; TcRn ())
-&gt; NonEmpty (GenLocated SrcSpanAnnN RdrName) -&gt; TcRn ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RdrName -&gt; TcRn ()) -&gt; GenLocated SrcSpanAnnN RdrName -&gt; TcRn ()
forall t a b. HasLoc t =&gt; (a -&gt; TcM b) -&gt; GenLocated t a -&gt; TcM b
</span><a href="GHC.Tc.Utils.Monad.html#addLocM"><span class="hs-identifier hs-var">addLocM</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; TcRn ()
</span><a href="GHC.Rename.Names.html#checkConName"><span class="hs-identifier hs-var">checkConName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (LIdP GhcPs)
NonEmpty (GenLocated SrcSpanAnnN RdrName)
</span><a href="#local-6989586621683063055"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-2437"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063064"><span class="annot"><a href="#local-6989586621683063064"><span class="hs-identifier hs-var">new_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name))
-&gt; NonEmpty (GenLocated SrcSpanAnnN RdrName)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (NonEmpty (GenLocated SrcSpanAnnN Name))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupLocatedTopConstructorRnN"><span class="hs-identifier hs-var">lookupLocatedTopConstructorRnN</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (LIdP GhcPs)
NonEmpty (GenLocated SrcSpanAnnN RdrName)
</span><a href="#local-6989586621683063055"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-2438"></span><span>
</span><span id="line-2439"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- We must ensure that we extract the free tkvs in left-to-right</span><span>
</span><span id="line-2440"></span><span>              </span><span class="hs-comment">-- order of their appearance in the constructor type.</span><span>
</span><span id="line-2441"></span><span>              </span><span class="hs-comment">-- That order governs the order the implicitly-quantified type</span><span>
</span><span id="line-2442"></span><span>              </span><span class="hs-comment">-- variable, and hence the order needed for visible type application</span><span>
</span><span id="line-2443"></span><span>              </span><span class="hs-comment">-- See #14808.</span><span>
</span><span id="line-2444"></span><span>              </span><span id="local-6989586621683063065"><span class="annot"><a href="#local-6989586621683063065"><span class="hs-identifier hs-var hs-var">implicit_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2445"></span><span>                </span><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcPs -&gt; FreeKiTyVars -&gt; FreeKiTyVars
forall flag.
HsOuterTyVarBndrs flag GhcPs -&gt; FreeKiTyVars -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractHsOuterTvBndrs"><span class="hs-identifier hs-var">extractHsOuterTvBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcPs
</span><a href="#local-6989586621683063058"><span class="hs-identifier hs-var">outer_bndrs</span></a></span><span>           </span><span class="annot"><span class="annottext">(FreeKiTyVars -&gt; FreeKiTyVars) -&gt; FreeKiTyVars -&gt; FreeKiTyVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2446"></span><span>                </span><span class="annot"><span class="annottext">[LHsType GhcPs] -&gt; FreeKiTyVars -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractHsTysRdrTyVars"><span class="hs-identifier hs-var">extractHsTysRdrTyVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs) -&gt; [LHsType GhcPs]
forall (p :: Pass).
Maybe (LHsContext (GhcPass p)) -&gt; HsContext (GhcPass p)
</span><a href="GHC.Hs.Decls.html#hsConDeclTheta"><span class="hs-identifier hs-var">hsConDeclTheta</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063059"><span class="hs-identifier hs-var">mcxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FreeKiTyVars -&gt; FreeKiTyVars) -&gt; FreeKiTyVars -&gt; FreeKiTyVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2447"></span><span>                </span><span class="annot"><span class="annottext">HsConDeclGADTDetails GhcPs -&gt; FreeKiTyVars -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractConDeclGADTDetailsTyVars"><span class="hs-identifier hs-var">extractConDeclGADTDetailsTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">HsConDeclGADTDetails GhcPs
</span><a href="#local-6989586621683063060"><span class="hs-identifier hs-var">args</span></a></span><span>        </span><span class="annot"><span class="annottext">(FreeKiTyVars -&gt; FreeKiTyVars) -&gt; FreeKiTyVars -&gt; FreeKiTyVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2448"></span><span>                </span><span class="annot"><span class="annottext">[LHsType GhcPs] -&gt; FreeKiTyVars -&gt; FreeKiTyVars
</span><a href="GHC.Rename.HsType.html#extractHsTysRdrTyVars"><span class="hs-identifier hs-var">extractHsTysRdrTyVars</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsType GhcPs
</span><a href="#local-6989586621683063062"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2449"></span><span>
</span><span id="line-2450"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063070"><span class="annot"><a href="#local-6989586621683063070"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN Name] -&gt; HsDocContext
</span><a href="GHC.Tc.Errors.Types.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (GenLocated SrcSpanAnnN Name)
-&gt; [GenLocated SrcSpanAnnN Name]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (GenLocated SrcSpanAnnN Name)
</span><a href="#local-6989586621683063064"><span class="hs-identifier hs-var">new_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2451"></span><span>
</span><span id="line-2452"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#bindHsOuterTyVarBndrs"><span class="hs-identifier hs-type">bindHsOuterTyVarBndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063070"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683063065"><span class="hs-identifier hs-type">implicit_bndrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063058"><span class="hs-identifier hs-type">outer_bndrs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683063071"><span class="annot"><span class="annottext">HsOuterTyVarBndrs Specificity GhcRn
</span><a href="#local-6989586621683063071"><span class="hs-identifier hs-var">outer_bndrs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2453"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063072"><span class="annot"><a href="#local-6989586621683063072"><span class="hs-identifier hs-var">new_cxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063073"><span class="annot"><a href="#local-6989586621683063073"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe (LHsContext GhcPs)
-&gt; RnM (Maybe (LHsContext GhcRn), FreeVars)
</span><a href="GHC.Rename.Module.html#rnMbContext"><span class="hs-identifier hs-var">rnMbContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063070"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063059"><span class="hs-identifier hs-var">mcxt</span></a></span><span>
</span><span id="line-2454"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063074"><span class="annot"><a href="#local-6989586621683063074"><span class="hs-identifier hs-var">new_args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063075"><span class="annot"><a href="#local-6989586621683063075"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclGADTDetails"><span class="hs-identifier hs-type">rnConDeclGADTDetails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#head"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063064"><span class="hs-identifier hs-type">new_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063070"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063060"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-2455"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063077"><span class="annot"><a href="#local-6989586621683063077"><span class="hs-identifier hs-var">new_res_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063078"><span class="annot"><a href="#local-6989586621683063078"><span class="hs-identifier hs-var">fvs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnLHsType"><span class="hs-identifier hs-type">rnLHsType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063070"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063062"><span class="hs-identifier hs-type">res_ty</span></a></span><span>
</span><span id="line-2456"></span><span>
</span><span id="line-2457"></span><span>         </span><span class="hs-comment">-- Ensure that there are no nested `forall`s or contexts, per</span><span>
</span><span id="line-2458"></span><span>         </span><span class="hs-comment">-- Note [GADT abstract syntax] (Wrinkle: No nested foralls or contexts)</span><span>
</span><span id="line-2459"></span><span>         </span><span class="hs-comment">-- in GHC.Hs.Type.</span><span>
</span><span id="line-2460"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#addNoNestedForallsContextsErr"><span class="hs-identifier hs-type">addNoNestedForallsContextsErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063070"><span class="hs-identifier hs-type">ctxt</span></a></span><span>
</span><span id="line-2461"></span><span>           </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#NFC_GadtConSig"><span class="hs-identifier hs-type">NFC_GadtConSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063077"><span class="hs-identifier hs-type">new_res_ty</span></a></span><span>
</span><span id="line-2462"></span><span>
</span><span id="line-2463"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063080"><span class="annot"><a href="#local-6989586621683063080"><span class="hs-identifier hs-var hs-var">all_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683063073"><span class="hs-identifier hs-var">fvs1</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683063075"><span class="hs-identifier hs-var">fvs2</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars -&gt; FreeVars -&gt; FreeVars
</span><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-var">`plusFV`</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="#local-6989586621683063078"><span class="hs-identifier hs-var">fvs3</span></a></span><span>
</span><span id="line-2464"></span><span>
</span><span id="line-2465"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnConDecl (ConDeclGADT)&quot;</span></span><span>
</span><span id="line-2466"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063055"><span class="hs-identifier hs-type">names</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063071"><span class="hs-identifier hs-type">outer_bndrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2467"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063081"><span class="annot"><a href="#local-6989586621683063081"><span class="hs-identifier hs-var">new_mb_doc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063063"><span class="hs-identifier hs-type">mb_doc</span></a></span><span>
</span><span id="line-2468"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclGADT"><span class="hs-identifier hs-type">ConDeclGADT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_g_ext"><span class="hs-identifier hs-var">con_g_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_names"><span class="hs-identifier hs-var">con_names</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063064"><span class="hs-identifier hs-type">new_names</span></a></span><span>
</span><span id="line-2469"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_bndrs"><span class="hs-identifier hs-var">con_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063057"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063071"><span class="hs-identifier hs-type">outer_bndrs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_mb_cxt"><span class="hs-identifier hs-var">con_mb_cxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063072"><span class="hs-identifier hs-type">new_cxt</span></a></span><span>
</span><span id="line-2470"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_g_args"><span class="hs-identifier hs-var">con_g_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063074"><span class="hs-identifier hs-type">new_args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_res_ty"><span class="hs-identifier hs-var">con_res_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063077"><span class="hs-identifier hs-type">new_res_ty</span></a></span><span>
</span><span id="line-2471"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#con_doc"><span class="hs-identifier hs-var">con_doc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063081"><span class="hs-identifier hs-type">new_mb_doc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2472"></span><span>                  </span><span class="annot"><a href="#local-6989586621683063080"><span class="hs-identifier hs-type">all_fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2473"></span><span>
</span><span id="line-2474"></span><span class="annot"><a href="GHC.Rename.Module.html#rnMbContext"><span class="hs-identifier hs-type">rnMbContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2475"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2476"></span><span id="rnMbContext"><span class="annot"><span class="annottext">rnMbContext :: HsDocContext
-&gt; Maybe (LHsContext GhcPs)
-&gt; RnM (Maybe (LHsContext GhcRn), FreeVars)
</span><a href="GHC.Rename.Module.html#rnMbContext"><span class="hs-identifier hs-var hs-var">rnMbContext</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe
   (GenLocated SrcSpanAnnC [GenLocated SrcSpanAnnA (HsType GhcRn)]),
 FreeVars)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (Maybe
        (GenLocated SrcSpanAnnC [GenLocated SrcSpanAnnA (HsType GhcRn)]),
      FreeVars)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe
  (GenLocated SrcSpanAnnC [GenLocated SrcSpanAnnA (HsType GhcRn)])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FreeVars
</span><a href="GHC.Types.Name.Set.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2477"></span><span class="annot"><a href="GHC.Rename.Module.html#rnMbContext"><span class="hs-identifier hs-var">rnMbContext</span></a></span><span> </span><span id="local-6989586621683063083"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063083"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683063084"><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063084"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063085"><span class="annot"><a href="#local-6989586621683063085"><span class="hs-identifier hs-var">ctx'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683063086"><span class="annot"><a href="#local-6989586621683063086"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; Maybe (LHsContext GhcPs)
-&gt; RnM (Maybe (LHsContext GhcRn), FreeVars)
</span><a href="GHC.Rename.HsType.html#rnMaybeContext"><span class="hs-identifier hs-var">rnMaybeContext</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063083"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcPs)
</span><a href="#local-6989586621683063084"><span class="hs-identifier hs-var">cxt</span></a></span><span>
</span><span id="line-2478"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683063085"><span class="hs-identifier hs-type">ctx'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621683063086"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2479"></span><span>
</span><span id="line-2480"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclH98Details"><span class="hs-identifier hs-type">rnConDeclH98Details</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2481"></span><span>      </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-2482"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-2483"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsConDeclH98Details"><span class="hs-identifier hs-type">HsConDeclH98Details</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2484"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsConDeclH98Details"><span class="hs-identifier hs-type">HsConDeclH98Details</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2485"></span><span id="rnConDeclH98Details"><span class="annot"><span class="annottext">rnConDeclH98Details :: Name
-&gt; HsDocContext
-&gt; HsConDeclH98Details GhcPs
-&gt; RnM (HsConDeclH98Details GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnConDeclH98Details"><span class="hs-identifier hs-var hs-var">rnConDeclH98Details</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063087"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063087"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#PrefixCon"><span class="hs-identifier hs-type">PrefixCon</span></a></span><span> </span><span class="annot"><span class="annottext">[Void]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063088"><span class="annot"><span class="annottext">[HsScaled GhcPs (LHsType GhcPs)]
</span><a href="#local-6989586621683063088"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2486"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063089"><span class="annot"><a href="#local-6989586621683063089"><span class="hs-identifier hs-var">new_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063090"><span class="annot"><a href="#local-6989586621683063090"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))
 -&gt; RnM
      (HsScaled GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars))
-&gt; [HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))]
-&gt; RnM
     ([HsScaled GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn))],
      FreeVars)
forall (f :: * -&gt; *) a b.
Traversable f =&gt;
(a -&gt; RnM (b, FreeVars)) -&gt; f a -&gt; RnM (f b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsScaled GhcPs (LHsType GhcPs)
-&gt; RnM (HsScaled GhcRn (LHsType GhcRn), FreeVars)
</span><a href="GHC.Rename.HsType.html#rnScaledLHsType"><span class="hs-identifier hs-var">rnScaledLHsType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063087"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HsScaled GhcPs (LHsType GhcPs)]
[HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))]
</span><a href="#local-6989586621683063088"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2487"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#PrefixCon"><span class="hs-identifier hs-type">PrefixCon</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#noTypeArgs"><span class="hs-identifier hs-type">noTypeArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063089"><span class="hs-identifier hs-type">new_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063090"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2488"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclH98Details"><span class="hs-identifier hs-var">rnConDeclH98Details</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063093"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063093"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#InfixCon"><span class="hs-identifier hs-type">InfixCon</span></a></span><span> </span><span id="local-6989586621683063094"><span class="annot"><span class="annottext">HsScaled GhcPs (LHsType GhcPs)
</span><a href="#local-6989586621683063094"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621683063095"><span class="annot"><span class="annottext">HsScaled GhcPs (LHsType GhcPs)
</span><a href="#local-6989586621683063095"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2489"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063096"><span class="annot"><a href="#local-6989586621683063096"><span class="hs-identifier hs-var">new_ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063097"><span class="annot"><a href="#local-6989586621683063097"><span class="hs-identifier hs-var">fvs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsScaled GhcPs (LHsType GhcPs)
-&gt; RnM (HsScaled GhcRn (LHsType GhcRn), FreeVars)
</span><a href="GHC.Rename.HsType.html#rnScaledLHsType"><span class="hs-identifier hs-var">rnScaledLHsType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063093"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">HsScaled GhcPs (LHsType GhcPs)
</span><a href="#local-6989586621683063094"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2490"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063098"><span class="annot"><a href="#local-6989586621683063098"><span class="hs-identifier hs-var">new_ty2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063099"><span class="annot"><a href="#local-6989586621683063099"><span class="hs-identifier hs-var">fvs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnScaledLHsType"><span class="hs-identifier hs-type">rnScaledLHsType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063093"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063095"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-2491"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#InfixCon"><span class="hs-identifier hs-type">InfixCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063096"><span class="hs-identifier hs-type">new_ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063098"><span class="hs-identifier hs-type">new_ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063097"><span class="hs-identifier hs-type">fvs1</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusFV"><span class="hs-operator hs-type">`plusFV`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063099"><span class="hs-identifier hs-type">fvs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2492"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclH98Details"><span class="hs-identifier hs-var">rnConDeclH98Details</span></a></span><span> </span><span id="local-6989586621683063100"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063100"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683063101"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063101"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span id="local-6989586621683063102"><span class="annot"><span class="annottext">XRec GhcPs [XRec GhcPs (ConDeclField GhcPs)]
</span><a href="#local-6989586621683063102"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2493"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063103"><span class="annot"><a href="#local-6989586621683063103"><span class="hs-identifier hs-var">new_flds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063104"><span class="annot"><a href="#local-6989586621683063104"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; HsDocContext
-&gt; GenLocated SrcSpanAnnL [XRec GhcPs (ConDeclField GhcPs)]
-&gt; RnM (LocatedL [LConDeclField GhcRn], FreeVars)
</span><a href="GHC.Rename.Module.html#rnRecConDeclFields"><span class="hs-identifier hs-var">rnRecConDeclFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063100"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063101"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [XRec GhcPs (ConDeclField GhcPs)]
GenLocated SrcSpanAnnL [XRec GhcPs (ConDeclField GhcPs)]
</span><a href="#local-6989586621683063102"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-2494"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063103"><span class="hs-identifier hs-type">new_flds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063104"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2495"></span><span>
</span><span id="line-2496"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclGADTDetails"><span class="hs-identifier hs-type">rnConDeclGADTDetails</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2497"></span><span>      </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-2498"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-2499"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsConDeclGADTDetails"><span class="hs-identifier hs-type">HsConDeclGADTDetails</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2500"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsConDeclGADTDetails"><span class="hs-identifier hs-type">HsConDeclGADTDetails</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2501"></span><span id="rnConDeclGADTDetails"><span class="annot"><span class="annottext">rnConDeclGADTDetails :: Name
-&gt; HsDocContext
-&gt; HsConDeclGADTDetails GhcPs
-&gt; RnM (HsConDeclGADTDetails GhcRn, FreeVars)
</span><a href="GHC.Rename.Module.html#rnConDeclGADTDetails"><span class="hs-identifier hs-var hs-var">rnConDeclGADTDetails</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063106"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063106"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#PrefixConGADT"><span class="hs-identifier hs-type">PrefixConGADT</span></a></span><span> </span><span class="annot"><span class="annottext">XPrefixConGADT GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063107"><span class="annot"><span class="annottext">[HsScaled GhcPs (LHsType GhcPs)]
</span><a href="#local-6989586621683063107"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2502"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063108"><span class="annot"><a href="#local-6989586621683063108"><span class="hs-identifier hs-var">new_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063109"><span class="annot"><a href="#local-6989586621683063109"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))
 -&gt; RnM
      (HsScaled GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn)), FreeVars))
-&gt; [HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))]
-&gt; RnM
     ([HsScaled GhcRn (GenLocated SrcSpanAnnA (HsType GhcRn))],
      FreeVars)
forall (f :: * -&gt; *) a b.
Traversable f =&gt;
(a -&gt; RnM (b, FreeVars)) -&gt; f a -&gt; RnM (f b, FreeVars)
</span><a href="GHC.Rename.Utils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocContext
-&gt; HsScaled GhcPs (LHsType GhcPs)
-&gt; RnM (HsScaled GhcRn (LHsType GhcRn), FreeVars)
</span><a href="GHC.Rename.HsType.html#rnScaledLHsType"><span class="hs-identifier hs-var">rnScaledLHsType</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063106"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HsScaled GhcPs (LHsType GhcPs)]
[HsScaled GhcPs (GenLocated SrcSpanAnnA (HsType GhcPs))]
</span><a href="#local-6989586621683063107"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2503"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#PrefixConGADT"><span class="hs-identifier hs-type">PrefixConGADT</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063108"><span class="hs-identifier hs-type">new_tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063109"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2504"></span><span class="annot"><a href="GHC.Rename.Module.html#rnConDeclGADTDetails"><span class="hs-identifier hs-var">rnConDeclGADTDetails</span></a></span><span> </span><span id="local-6989586621683063110"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063110"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683063111"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063111"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RecConGADT"><span class="hs-identifier hs-type">RecConGADT</span></a></span><span> </span><span class="annot"><span class="annottext">XRecConGADT GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063112"><span class="annot"><span class="annottext">XRec GhcPs [XRec GhcPs (ConDeclField GhcPs)]
</span><a href="#local-6989586621683063112"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2505"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063113"><span class="annot"><a href="#local-6989586621683063113"><span class="hs-identifier hs-var">new_flds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063114"><span class="annot"><a href="#local-6989586621683063114"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; HsDocContext
-&gt; GenLocated SrcSpanAnnL [XRec GhcPs (ConDeclField GhcPs)]
-&gt; RnM (LocatedL [LConDeclField GhcRn], FreeVars)
</span><a href="GHC.Rename.Module.html#rnRecConDeclFields"><span class="hs-identifier hs-var">rnRecConDeclFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063110"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063111"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [XRec GhcPs (ConDeclField GhcPs)]
GenLocated SrcSpanAnnL [XRec GhcPs (ConDeclField GhcPs)]
</span><a href="#local-6989586621683063112"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-2506"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RecConGADT"><span class="hs-identifier hs-type">RecConGADT</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063113"><span class="hs-identifier hs-type">new_flds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063114"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2507"></span><span>
</span><span id="line-2508"></span><span class="annot"><a href="GHC.Rename.Module.html#rnRecConDeclFields"><span class="hs-identifier hs-type">rnRecConDeclFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2509"></span><span>     </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-2510"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a></span><span>
</span><span id="line-2511"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedL"><span class="hs-identifier hs-type">LocatedL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2512"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedL"><span class="hs-identifier hs-type">LocatedL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2513"></span><span id="rnRecConDeclFields"><span class="annot"><span class="annottext">rnRecConDeclFields :: Name
-&gt; HsDocContext
-&gt; GenLocated SrcSpanAnnL [XRec GhcPs (ConDeclField GhcPs)]
-&gt; RnM (LocatedL [LConDeclField GhcRn], FreeVars)
</span><a href="GHC.Rename.Module.html#rnRecConDeclFields"><span class="hs-identifier hs-var hs-var">rnRecConDeclFields</span></a></span></span><span> </span><span id="local-6989586621683063115"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063115"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683063116"><span class="annot"><span class="annottext">HsDocContext
</span><a href="#local-6989586621683063116"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063117"><span class="annot"><span class="annottext">SrcSpanAnnL
</span><a href="#local-6989586621683063117"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683063118"><span class="annot"><span class="annottext">[XRec GhcPs (ConDeclField GhcPs)]
</span><a href="#local-6989586621683063118"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2514"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683063119"><span class="annot"><a href="#local-6989586621683063119"><span class="hs-identifier hs-var">fls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; RnM [FieldLabel]
Name -&gt; RnM [FieldLabel]
</span><a href="GHC.Rename.Env.html#lookupConstructorFields"><span class="hs-identifier hs-var">lookupConstructorFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683063115"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-2515"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063121"><span class="annot"><a href="#local-6989586621683063121"><span class="hs-identifier hs-var">new_fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063122"><span class="annot"><a href="#local-6989586621683063122"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.HsType.html#rnConDeclFields"><span class="hs-identifier hs-type">rnConDeclFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063116"><span class="hs-identifier hs-type">doc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063119"><span class="hs-identifier hs-type">fls</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063118"><span class="hs-identifier hs-type">fields</span></a></span><span>
</span><span id="line-2516"></span><span>                </span><span class="hs-comment">-- No need to check for duplicate fields</span><span>
</span><span id="line-2517"></span><span>                </span><span class="hs-comment">-- since that is done by GHC.Rename.Names.extendGlobalRdrEnvRn</span><span>
</span><span id="line-2518"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063117"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063121"><span class="hs-identifier hs-type">new_fields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063122"><span class="hs-identifier hs-type">fvs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2519"></span><span>
</span><span id="line-2520"></span><span class="hs-comment">-------------------------------------------------</span><span>
</span><span id="line-2521"></span><span>
</span><span id="line-2522"></span><span class="hs-comment">-- | Brings pattern synonym names and also pattern synonym selectors</span><span>
</span><span id="line-2523"></span><span class="hs-comment">-- from record pattern synonyms into scope.</span><span>
</span><span id="line-2524"></span><span id="local-6989586621683060412"><span class="annot"><a href="GHC.Rename.Module.html#extendPatSynEnv"><span class="hs-identifier hs-type">extendPatSynEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a></span><span>
</span><span id="line-2525"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.LclEnv.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683060412"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2526"></span><span id="extendPatSynEnv"><span class="annot"><span class="annottext">extendPatSynEnv :: forall a.
DuplicateRecordFields
-&gt; FieldSelectors
-&gt; HsValBinds GhcPs
-&gt; MiniFixityEnv
-&gt; ([Name] -&gt; TcRnIf TcGblEnv TcLclEnv a)
-&gt; TcRnIf TcGblEnv TcLclEnv a
</span><a href="GHC.Rename.Module.html#extendPatSynEnv"><span class="hs-identifier hs-var hs-var">extendPatSynEnv</span></a></span></span><span> </span><span id="local-6989586621683063151"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621683063151"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621683063152"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621683063152"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span id="local-6989586621683063153"><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621683063153"><span class="hs-identifier hs-var">val_decls</span></a></span></span><span> </span><span id="local-6989586621683063154"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621683063154"><span class="hs-identifier hs-var">local_fix_env</span></a></span></span><span> </span><span id="local-6989586621683063155"><span class="annot"><span class="annottext">[Name] -&gt; TcRnIf TcGblEnv TcLclEnv a
</span><a href="#local-6989586621683063155"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-2527"></span><span>     </span><span id="local-6989586621683063156"><span class="annot"><a href="#local-6989586621683063156"><span class="hs-identifier hs-var">names_with_fls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcPs -&gt; TcM [(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063157"><span class="hs-identifier hs-var">new_ps</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621683063153"><span class="hs-identifier hs-var">val_decls</span></a></span><span>
</span><span id="line-2528"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063158"><span class="annot"><a href="#local-6989586621683063158"><span class="hs-identifier hs-var hs-var">pat_syn_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Name]] -&gt; [Name]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConLikeName -&gt; Name
</span><a href="GHC.Types.GREInfo.html#conLikeName_Name"><span class="hs-identifier hs-var">conLikeName_Name</span></a></span><span> </span><span class="annot"><span class="annottext">ConLikeName
</span><a href="#local-6989586621683063160"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(FieldLabel -&gt; Name) -&gt; [FieldLabel] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; Name
</span><a href="GHC.Types.FieldLabel.html#flSelector"><span class="hs-identifier hs-var">flSelector</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683063162"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-2529"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063160"><span class="annot"><span class="annottext">ConLikeName
</span><a href="#local-6989586621683063160"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063163"><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621683063163"><span class="hs-identifier hs-var">con_info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063156"><span class="hs-identifier hs-var">names_with_fls</span></a></span><span>
</span><span id="line-2530"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063162"><span class="annot"><span class="annottext">flds :: [FieldLabel]
</span><a href="#local-6989586621683063162"><span class="hs-identifier hs-var hs-var">flds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConInfo -&gt; [FieldLabel]
</span><a href="GHC.Types.GREInfo.html#conInfoFields"><span class="hs-identifier hs-var">conInfoFields</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621683063163"><span class="hs-identifier hs-var">con_info</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2531"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063164"><span class="annot"><a href="#local-6989586621683063164"><span class="hs-identifier hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">((ConLikeName, ConInfo) -&gt; GlobalRdrEltX GREInfo)
-&gt; [(ConLikeName, ConInfo)] -&gt; [GlobalRdrEltX GREInfo]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parent -&gt; (ConLikeName, ConInfo) -&gt; GlobalRdrEltX GREInfo
</span><a href="GHC.Types.Name.Reader.html#mkLocalConLikeGRE"><span class="hs-identifier hs-var">mkLocalConLikeGRE</span></a></span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063156"><span class="hs-identifier hs-var">names_with_fls</span></a></span><span>
</span><span id="line-2532"></span><span>              </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Parent -&gt; [(ConLikeName, ConInfo)] -&gt; [GlobalRdrEltX GREInfo]
</span><a href="GHC.Types.Name.Reader.html#mkLocalFieldGREs"><span class="hs-identifier hs-var">mkLocalFieldGREs</span></a></span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span> </span><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063156"><span class="hs-identifier hs-var">names_with_fls</span></a></span><span>
</span><span id="line-2533"></span><span>      </span><span class="hs-comment">-- Recall Note [Parents] in GHC.Types.Name.Reader:</span><span>
</span><span id="line-2534"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-2535"></span><span>      </span><span class="hs-comment">-- pattern synonym constructors and their record fields have no parent</span><span>
</span><span id="line-2536"></span><span>      </span><span class="hs-comment">-- in the module in which they are defined.</span><span>
</span><span id="line-2537"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063167"><span class="annot"><a href="#local-6989586621683063167"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683063168"><span class="annot"><a href="#local-6989586621683063168"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-type">extendGlobalRdrEnvRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063164"><span class="hs-identifier hs-type">gres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063154"><span class="hs-identifier hs-type">local_fix_env</span></a></span><span>
</span><span id="line-2538"></span><span>   </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#restoreEnvs"><span class="hs-identifier hs-type">restoreEnvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683063167"><span class="hs-identifier hs-type">gbl_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063168"><span class="hs-identifier hs-type">lcl_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683063155"><span class="hs-identifier hs-type">thing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063158"><span class="hs-identifier hs-type">pat_syn_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2539"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2540"></span><span>
</span><span id="line-2541"></span><span>    </span><span class="annot"><a href="#local-6989586621683063157"><span class="hs-identifier hs-type">new_ps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#ConLikeName"><span class="hs-identifier hs-type">ConLikeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#ConInfo"><span class="hs-identifier hs-type">ConInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2542"></span><span>    </span><span id="local-6989586621683063157"><span class="annot"><span class="annottext">new_ps :: HsValBinds GhcPs -&gt; TcM [(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063157"><span class="hs-identifier hs-var hs-var">new_ps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XValBinds GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063170"><span class="annot"><span class="annottext">LHsBinds GhcPs
</span><a href="#local-6989586621683063170"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="annot"><span class="annottext">[LSig GhcPs]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)
 -&gt; [(ConLikeName, ConInfo)] -&gt; TcM [(ConLikeName, ConInfo)])
-&gt; [(ConLikeName, ConInfo)]
-&gt; [GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
-&gt; TcM [(ConLikeName, ConInfo)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldrM</span></span><span> </span><span class="annot"><span class="annottext">LHsBindLR GhcPs GhcPs
-&gt; [(ConLikeName, ConInfo)] -&gt; TcM [(ConLikeName, ConInfo)]
GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)
-&gt; [(ConLikeName, ConInfo)] -&gt; TcM [(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063172"><span class="hs-identifier hs-var">new_ps'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcPs
[GenLocated SrcSpanAnnA (HsBindLR GhcPs GhcPs)]
</span><a href="#local-6989586621683063170"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-2543"></span><span>    </span><span class="annot"><a href="#local-6989586621683063157"><span class="hs-identifier hs-var">new_ps</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TcM [(ConLikeName, ConInfo)]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new_ps&quot;</span></span><span>
</span><span id="line-2544"></span><span>
</span><span id="line-2545"></span><span>    </span><span class="annot"><a href="#local-6989586621683063172"><span class="hs-identifier hs-type">new_ps'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBindLR"><span class="hs-identifier hs-type">LHsBindLR</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-2546"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#ConLikeName"><span class="hs-identifier hs-type">ConLikeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#ConInfo"><span class="hs-identifier hs-type">ConInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2547"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#ConLikeName"><span class="hs-identifier hs-type">ConLikeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.GREInfo.html#ConInfo"><span class="hs-identifier hs-type">ConInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2548"></span><span>    </span><span id="local-6989586621683063172"><span class="annot"><span class="annottext">new_ps' :: LHsBindLR GhcPs GhcPs
-&gt; [(ConLikeName, ConInfo)] -&gt; TcM [(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063172"><span class="hs-identifier hs-var hs-var">new_ps'</span></a></span></span><span> </span><span id="local-6989586621683063173"><span class="annot"><span class="annottext">LHsBindLR GhcPs GhcPs
</span><a href="#local-6989586621683063173"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621683063174"><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063174"><span class="hs-identifier hs-var">names</span></a></span></span><span>
</span><span id="line-2549"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063175"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063175"><span class="hs-identifier hs-var">bind_loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a></span><span> </span><span class="annot"><span class="annottext">XPatSynBind GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PSB"><span class="hs-identifier hs-type">PSB</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psb_id :: forall idL idR. PatSynBind idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#psb_id"><span class="hs-identifier hs-var">psb_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063179"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063179"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-2550"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">psb_args :: forall idL idR. PatSynBind idL idR -&gt; HsPatSynDetails idR
</span><a href="Language.Haskell.Syntax.Binds.html#psb_args"><span class="hs-identifier hs-var">psb_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span id="local-6989586621683063181"><span class="annot"><span class="annottext">[RecordPatSynField GhcPs]
</span><a href="#local-6989586621683063181"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsBindLR GhcPs GhcPs
</span><a href="#local-6989586621683063173"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-2551"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2552"></span><span>          </span><span id="local-6989586621683063182"><span class="annot"><a href="#local-6989586621683063182"><span class="hs-identifier hs-var">bnd_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; RdrName -&gt; GenLocated SrcSpanAnnN RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpanAnnN
forall a b. (HasLoc a, HasAnnotation b) =&gt; a -&gt; b
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063175"><span class="hs-identifier hs-var">bind_loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063179"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2553"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063184"><span class="annot"><a href="#local-6989586621683063184"><span class="hs-identifier hs-var hs-var">field_occs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RecordPatSynField GhcPs
 -&gt; GenLocated SrcSpanAnnA (FieldOcc GhcPs))
-&gt; [RecordPatSynField GhcPs]
-&gt; [GenLocated SrcSpanAnnA (FieldOcc GhcPs)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683063185"><span class="annot"><span class="annottext">FieldOcc GhcPs
</span><a href="#local-6989586621683063185"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; FieldOcc GhcPs -&gt; GenLocated SrcSpanAnnA (FieldOcc GhcPs)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpanAnnA
forall e. HasAnnotation e =&gt; SrcSpan -&gt; e
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcSpan -&gt; SrcSpanAnnA) -&gt; SrcSpan -&gt; SrcSpanAnnA
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldOcc GhcPs -&gt; LIdP GhcPs
forall pass. FieldOcc pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Type.html#foLabel"><span class="hs-identifier hs-var">foLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FieldOcc GhcPs
</span><a href="#local-6989586621683063185"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FieldOcc GhcPs
</span><a href="#local-6989586621683063185"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FieldOcc GhcPs -&gt; GenLocated SrcSpanAnnA (FieldOcc GhcPs))
-&gt; (RecordPatSynField GhcPs -&gt; FieldOcc GhcPs)
-&gt; RecordPatSynField GhcPs
-&gt; GenLocated SrcSpanAnnA (FieldOcc GhcPs)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RecordPatSynField GhcPs -&gt; FieldOcc GhcPs
forall pass. RecordPatSynField pass -&gt; FieldOcc pass
</span><a href="Language.Haskell.Syntax.Binds.html#recordPatSynField"><span class="hs-identifier hs-var">recordPatSynField</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RecordPatSynField GhcPs]
</span><a href="#local-6989586621683063181"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-2554"></span><span>          </span><span id="local-6989586621683063189"><span class="annot"><a href="#local-6989586621683063189"><span class="hs-identifier hs-var">flds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Names.html#newRecordFieldLabel"><span class="hs-identifier hs-type">newRecordFieldLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063151"><span class="hs-identifier hs-type">dup_fields_ok</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063152"><span class="hs-identifier hs-type">has_sel</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683063182"><span class="hs-identifier hs-type">bnd_name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063184"><span class="hs-identifier hs-type">field_occs</span></a></span><span>
</span><span id="line-2555"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063191"><span class="annot"><a href="#local-6989586621683063191"><span class="hs-identifier hs-var hs-var">con_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLikeInfo -&gt; Int -&gt; [FieldLabel] -&gt; ConInfo
</span><a href="GHC.Types.GREInfo.html#mkConInfo"><span class="hs-identifier hs-var">mkConInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ConLikeInfo
</span><a href="GHC.Types.GREInfo.html#ConIsPatSyn"><span class="hs-identifier hs-var">ConIsPatSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([RecordPatSynField GhcPs] -&gt; Int)
-&gt; HsConDetails (ZonkAny 1) (ZonkAny 0) [RecordPatSynField GhcPs]
-&gt; Int
forall rec tyarg arg.
(rec -&gt; Int) -&gt; HsConDetails tyarg arg rec -&gt; Int
</span><a href="GHC.Rename.Module.html#conDetailsArity"><span class="hs-identifier hs-var">conDetailsArity</span></a></span><span> </span><span class="annot"><span class="annottext">[RecordPatSynField GhcPs] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RecordPatSynField GhcPs]
-&gt; HsConDetails (ZonkAny 1) (ZonkAny 0) [RecordPatSynField GhcPs]
forall tyarg arg rec. rec -&gt; HsConDetails tyarg arg rec
</span><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a></span><span> </span><span class="annot"><span class="annottext">[RecordPatSynField GhcPs]
</span><a href="#local-6989586621683063181"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621683063189"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-2556"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#PatSynName"><span class="hs-identifier hs-type">PatSynName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063182"><span class="hs-identifier hs-type">bnd_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063191"><span class="hs-identifier hs-type">con_info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063174"><span class="hs-identifier hs-type">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2557"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063196"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063196"><span class="hs-identifier hs-var">bind_loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a></span><span> </span><span class="annot"><span class="annottext">XPatSynBind GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PSB"><span class="hs-identifier hs-type">PSB</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psb_id :: forall idL idR. PatSynBind idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#psb_id"><span class="hs-identifier hs-var">psb_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063197"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063197"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">psb_args :: forall idL idR. PatSynBind idL idR -&gt; HsPatSynDetails idR
</span><a href="Language.Haskell.Syntax.Binds.html#psb_args"><span class="hs-identifier hs-var">psb_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063198"><span class="annot"><span class="annottext">HsConDetails Void (LIdP GhcPs) [RecordPatSynField GhcPs]
</span><a href="#local-6989586621683063198"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsBindLR GhcPs GhcPs
</span><a href="#local-6989586621683063173"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-2558"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2559"></span><span>        </span><span id="local-6989586621683063199"><span class="annot"><a href="#local-6989586621683063199"><span class="hs-identifier hs-var">bnd_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; RdrName -&gt; GenLocated SrcSpanAnnN RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpanAnnN
forall a b. (HasLoc a, HasAnnotation b) =&gt; a -&gt; b
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063196"><span class="hs-identifier hs-var">bind_loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063197"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2560"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683063200"><span class="annot"><a href="#local-6989586621683063200"><span class="hs-identifier hs-var hs-var">con_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLikeInfo -&gt; Int -&gt; [FieldLabel] -&gt; ConInfo
</span><a href="GHC.Types.GREInfo.html#mkConInfo"><span class="hs-identifier hs-var">mkConInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ConLikeInfo
</span><a href="GHC.Types.GREInfo.html#ConIsPatSyn"><span class="hs-identifier hs-var">ConIsPatSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([RecordPatSynField GhcPs] -&gt; Int)
-&gt; HsConDetails
     Void (GenLocated SrcSpanAnnN RdrName) [RecordPatSynField GhcPs]
-&gt; Int
forall rec tyarg arg.
(rec -&gt; Int) -&gt; HsConDetails tyarg arg rec -&gt; Int
</span><a href="GHC.Rename.Module.html#conDetailsArity"><span class="hs-identifier hs-var">conDetailsArity</span></a></span><span> </span><span class="annot"><span class="annottext">[RecordPatSynField GhcPs] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">HsConDetails Void (LIdP GhcPs) [RecordPatSynField GhcPs]
HsConDetails
  Void (GenLocated SrcSpanAnnN RdrName) [RecordPatSynField GhcPs]
</span><a href="#local-6989586621683063198"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2561"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.GREInfo.html#PatSynName"><span class="hs-identifier hs-type">PatSynName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063199"><span class="hs-identifier hs-type">bnd_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683063200"><span class="hs-identifier hs-type">con_info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063174"><span class="hs-identifier hs-type">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2562"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2563"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)] -&gt; TcM [(ConLikeName, ConInfo)]
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[(ConLikeName, ConInfo)]
</span><a href="#local-6989586621683063174"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-2564"></span><span>
</span><span id="line-2565"></span><span id="local-6989586621683061044"><span id="local-6989586621683061045"><span id="local-6989586621683061046"><span class="annot"><a href="GHC.Rename.Module.html#conDetailsArity"><span class="hs-identifier hs-type">conDetailsArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683061044"><span class="hs-identifier hs-type">rec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsConDetails"><span class="hs-identifier hs-type">HsConDetails</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061045"><span class="hs-identifier hs-type">tyarg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061046"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061044"><span class="hs-identifier hs-type">rec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span></span></span></span><span>
</span><span id="line-2566"></span><span id="conDetailsArity"><span class="annot"><span class="annottext">conDetailsArity :: forall rec tyarg arg.
(rec -&gt; Int) -&gt; HsConDetails tyarg arg rec -&gt; Int
</span><a href="GHC.Rename.Module.html#conDetailsArity"><span class="hs-identifier hs-var hs-var">conDetailsArity</span></a></span></span><span> </span><span id="local-6989586621683063202"><span class="annot"><span class="annottext">rec -&gt; Int
</span><a href="#local-6989586621683063202"><span class="hs-identifier hs-var">recToArity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2567"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#PrefixCon"><span class="hs-identifier hs-type">PrefixCon</span></a></span><span> </span><span class="annot"><span class="annottext">[tyarg]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063203"><span class="annot"><span class="annottext">[arg]
</span><a href="#local-6989586621683063203"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[arg] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[arg]
</span><a href="#local-6989586621683063203"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2568"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span id="local-6989586621683063204"><span class="annot"><span class="annottext">rec
</span><a href="#local-6989586621683063204"><span class="hs-identifier hs-var">rec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">rec -&gt; Int
</span><a href="#local-6989586621683063202"><span class="hs-identifier hs-var">recToArity</span></a></span><span> </span><span class="annot"><span class="annottext">rec
</span><a href="#local-6989586621683063204"><span class="hs-identifier hs-var">rec</span></a></span><span>
</span><span id="line-2569"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#InfixCon"><span class="hs-identifier hs-type">InfixCon</span></a></span><span> </span><span class="annot"><span class="annottext">arg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">arg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2570"></span><span>
</span><span id="line-2571"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
\subsection{Support code to rename types}
*                                                      *
*********************************************************
-}</span><span>
</span><span id="line-2578"></span><span>
</span><span id="line-2579"></span><span class="annot"><a href="GHC.Rename.Module.html#rnFds"><span class="hs-identifier hs-type">rnFds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsFunDep"><span class="hs-identifier hs-type">LHsFunDep</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsFunDep"><span class="hs-identifier hs-type">LHsFunDep</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2580"></span><span id="rnFds"><span class="annot"><span class="annottext">rnFds :: [LHsFunDep GhcPs] -&gt; RnM [LHsFunDep GhcRn]
</span><a href="GHC.Rename.Module.html#rnFds"><span class="hs-identifier hs-var hs-var">rnFds</span></a></span></span><span> </span><span id="local-6989586621683063205"><span class="annot"><span class="annottext">[LHsFunDep GhcPs]
</span><a href="#local-6989586621683063205"><span class="hs-identifier hs-var">fds</span></a></span></span><span>
</span><span id="line-2581"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (FunDep GhcPs)
 -&gt; IOEnv
      (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnA (FunDep GhcRn)))
-&gt; [GenLocated SrcSpanAnnA (FunDep GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) [GenLocated SrcSpanAnnA (FunDep GhcRn)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunDep GhcPs -&gt; TcM (FunDep GhcRn))
-&gt; GenLocated SrcSpanAnnA (FunDep GhcPs)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnA (FunDep GhcRn))
forall a b ann.
(a -&gt; TcM b)
-&gt; GenLocated (EpAnn ann) a -&gt; TcRn (GenLocated (EpAnn ann) b)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocMA"><span class="hs-identifier hs-var">wrapLocMA</span></a></span><span> </span><span class="annot"><span class="annottext">FunDep GhcPs -&gt; TcM (FunDep GhcRn)
</span><a href="#local-6989586621683063206"><span class="hs-identifier hs-var">rn_fds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsFunDep GhcPs]
[GenLocated SrcSpanAnnA (FunDep GhcPs)]
</span><a href="#local-6989586621683063205"><span class="hs-identifier hs-var">fds</span></a></span><span>
</span><span id="line-2582"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2583"></span><span>    </span><span class="annot"><a href="#local-6989586621683063206"><span class="hs-identifier hs-type">rn_fds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FunDep"><span class="hs-identifier hs-type">FunDep</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FunDep"><span class="hs-identifier hs-type">FunDep</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2584"></span><span>    </span><span id="local-6989586621683063206"><span class="annot"><span class="annottext">rn_fds :: FunDep GhcPs -&gt; TcM (FunDep GhcRn)
</span><a href="#local-6989586621683063206"><span class="hs-identifier hs-var hs-var">rn_fds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FunDep"><span class="hs-identifier hs-type">FunDep</span></a></span><span> </span><span id="local-6989586621683063208"><span class="annot"><span class="annottext">XCFunDep GhcPs
</span><a href="#local-6989586621683063208"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683063209"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683063209"><span class="hs-identifier hs-var">tys1</span></a></span></span><span> </span><span id="local-6989586621683063210"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621683063210"><span class="hs-identifier hs-var">tys2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2585"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683063211"><span class="annot"><a href="#local-6989586621683063211"><span class="hs-identifier hs-var">tys1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [GenLocated SrcSpanAnnN Name]
</span><a href="GHC.Rename.Module.html#rnHsTyVars"><span class="hs-identifier hs-var">rnHsTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
FreeKiTyVars
</span><a href="#local-6989586621683063209"><span class="hs-identifier hs-var">tys1</span></a></span><span>
</span><span id="line-2586"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683063213"><span class="annot"><a href="#local-6989586621683063213"><span class="hs-identifier hs-var">tys2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#rnHsTyVars"><span class="hs-identifier hs-type">rnHsTyVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063210"><span class="hs-identifier hs-type">tys2</span></a></span><span>
</span><span id="line-2587"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#FunDep"><span class="hs-identifier hs-type">FunDep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063208"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063211"><span class="hs-identifier hs-type">tys1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063213"><span class="hs-identifier hs-type">tys2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2588"></span><span>
</span><span id="line-2589"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsTyVars"><span class="hs-identifier hs-type">rnHsTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2590"></span><span id="rnHsTyVars"><span class="annot"><span class="annottext">rnHsTyVars :: FreeKiTyVars
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [GenLocated SrcSpanAnnN Name]
</span><a href="GHC.Rename.Module.html#rnHsTyVars"><span class="hs-identifier hs-var hs-var">rnHsTyVars</span></a></span></span><span> </span><span id="local-6989586621683063214"><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683063214"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnN RdrName
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name))
-&gt; FreeKiTyVars
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [GenLocated SrcSpanAnnN Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Module.html#rnHsTyVar"><span class="hs-identifier hs-var">rnHsTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">FreeKiTyVars
</span><a href="#local-6989586621683063214"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-2591"></span><span>
</span><span id="line-2592"></span><span class="annot"><a href="GHC.Rename.Module.html#rnHsTyVar"><span class="hs-identifier hs-type">rnHsTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2593"></span><span id="rnHsTyVar"><span class="annot"><span class="annottext">rnHsTyVar :: GenLocated SrcSpanAnnN RdrName
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Module.html#rnHsTyVar"><span class="hs-identifier hs-var hs-var">rnHsTyVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063216"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683063216"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683063217"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063217"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2594"></span><span>  </span><span id="local-6989586621683063218"><span class="annot"><a href="#local-6989586621683063218"><span class="hs-identifier hs-var">tyvar'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) Name
</span><a href="GHC.Rename.Env.html#lookupOccRn"><span class="hs-identifier hs-var">lookupOccRn</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683063217"><span class="hs-identifier hs-var">tyvar</span></a></span><span>
</span><span id="line-2595"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063216"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063218"><span class="hs-identifier hs-type">tyvar'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2596"></span><span>
</span><span id="line-2597"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
        findSplice
*                                                      *
*********************************************************

This code marches down the declarations, looking for the first
Template Haskell splice.  As it does so it
        a) groups the declarations into a HsGroup
        b) runs any top-level quasi-quotes
-}</span><span>
</span><span id="line-2609"></span><span>
</span><span id="line-2610"></span><span class="annot"><a href="GHC.Rename.Module.html#findSplice"><span class="hs-identifier hs-type">findSplice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2611"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceDecl"><span class="hs-identifier hs-type">SpliceDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2612"></span><span id="findSplice"><span class="annot"><span class="annottext">findSplice :: [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#findSplice"><span class="hs-identifier hs-var hs-var">findSplice</span></a></span></span><span> </span><span id="local-6989586621683063219"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063219"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
forall (p :: Pass). HsGroup (GhcPass p)
</span><a href="GHC.Hs.Decls.html#emptyRdrGroup"><span class="hs-identifier hs-var">emptyRdrGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063219"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2613"></span><span>
</span><span id="line-2614"></span><span class="annot"><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-type">addl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2615"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceDecl"><span class="hs-identifier hs-type">SpliceDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2616"></span><span class="hs-comment">-- This stuff reverses the declarations (again) but it doesn't matter</span><span>
</span><span id="line-2617"></span><span id="addl"><span class="annot"><span class="annottext">addl :: HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var hs-var">addl</span></a></span></span><span> </span><span id="local-6989586621683063222"><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063222"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsGroup GhcPs,
 Maybe (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)]))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (HsGroup GhcPs,
      Maybe (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)]))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063222"><span class="hs-identifier hs-var">gp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-2618"></span><span class="annot"><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span id="local-6989586621683063223"><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063223"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683063224"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063224"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683063225"><span class="annot"><span class="annottext">HsDecl GhcPs
</span><a href="#local-6989586621683063225"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683063226"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063226"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; SrcSpanAnnA
-&gt; HsDecl GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063223"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063224"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsDecl GhcPs
</span><a href="#local-6989586621683063225"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063226"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2619"></span><span>
</span><span id="line-2620"></span><span>
</span><span id="line-2621"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-type">add</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#SrcSpanAnnA"><span class="hs-identifier hs-type">SrcSpanAnnA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDecl"><span class="hs-identifier hs-type">HsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2622"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceDecl"><span class="hs-identifier hs-type">SpliceDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LHsDecl"><span class="hs-identifier hs-type">LHsDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2623"></span><span>
</span><span id="line-2624"></span><span class="hs-comment">-- #10047: Declaration QuasiQuoters are expanded immediately, without</span><span>
</span><span id="line-2625"></span><span class="hs-comment">--         causing a group split</span><span>
</span><span id="line-2626"></span><span id="add"><span class="annot"><span class="annottext">add :: HsGroup GhcPs
-&gt; SrcSpanAnnA
-&gt; HsDecl GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621683063228"><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063228"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceD"><span class="hs-identifier hs-type">SpliceD</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceDecl"><span class="hs-identifier hs-type">SpliceDecl</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063231"><span class="annot"><span class="annottext">qq :: HsUntypedSplice GhcPs
</span><a href="#local-6989586621683063231"><span class="hs-identifier hs-var">qq</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsQuasiQuote"><span class="hs-identifier hs-type">HsQuasiQuote</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SpliceDecoration
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063233"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063233"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2627"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063234"><span class="annot"><a href="#local-6989586621683063234"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsUntypedSplice GhcPs -&gt; RnM ([LHsDecl GhcPs], FreeVars)
</span><a href="GHC.Rename.Splice.html#rnTopSpliceDecls"><span class="hs-identifier hs-var">rnTopSpliceDecls</span></a></span><span> </span><span class="annot"><span class="annottext">HsUntypedSplice GhcPs
</span><a href="#local-6989586621683063231"><span class="hs-identifier hs-var">qq</span></a></span><span>
</span><span id="line-2628"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-type">addl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063228"><span class="hs-identifier hs-type">gp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683063234"><span class="hs-identifier hs-type">ds'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621683063233"><span class="hs-identifier hs-type">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2629"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-2630"></span><span>
</span><span id="line-2631"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063235"><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063235"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span id="local-6989586621683063236"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063236"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceD"><span class="hs-identifier hs-type">SpliceD</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063237"><span class="annot"><span class="annottext">splice :: SpliceDecl GhcPs
</span><a href="#local-6989586621683063237"><span class="hs-identifier hs-var">splice</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SpliceDecl"><span class="hs-identifier hs-type">SpliceDecl</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs (HsUntypedSplice GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063238"><span class="annot"><span class="annottext">SpliceDecoration
</span><a href="#local-6989586621683063238"><span class="hs-identifier hs-var">flag</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063239"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063239"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2632"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- We've found a top-level splice.  If it is an *implicit* one</span><span>
</span><span id="line-2633"></span><span>         </span><span class="hs-comment">-- (i.e. a naked top level expression), throw an error if</span><span>
</span><span id="line-2634"></span><span>         </span><span class="hs-comment">-- TemplateHaskell is not enabled.</span><span>
</span><span id="line-2635"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SpliceDecoration
</span><a href="#local-6989586621683063238"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2636"></span><span>           </span><span class="annot"><span class="annottext">SpliceDecoration
</span><a href="Language.Haskell.Syntax.Decls.html#DollarSplice"><span class="hs-identifier hs-var">DollarSplice</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2637"></span><span>           </span><span class="annot"><span class="annottext">SpliceDecoration
</span><a href="Language.Haskell.Syntax.Decls.html#BareSplice"><span class="hs-identifier hs-var">BareSplice</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; TcRn () -&gt; TcRn ()
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#unlessXOptM"><span class="hs-identifier hs-var">unlessXOptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.TemplateHaskell</span></span><span>
</span><span id="line-2638"></span><span>                            </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRn () -&gt; TcRn ()
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063236"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2639"></span><span>                            </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621683063244"><span class="hs-identifier hs-var">badImplicitSplice</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2640"></span><span>
</span><span id="line-2641"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(HsGroup GhcPs,
 Maybe (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)]))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (HsGroup GhcPs,
      Maybe (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)]))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063235"><span class="hs-identifier hs-var">gp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
-&gt; Maybe
     (SpliceDecl GhcPs, [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpliceDecl GhcPs
</span><a href="#local-6989586621683063237"><span class="hs-identifier hs-var">splice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
[GenLocated SrcSpanAnnA (HsDecl GhcPs)]
</span><a href="#local-6989586621683063239"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2642"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2643"></span><span>    </span><span class="annot"><a href="#local-6989586621683063244"><span class="hs-identifier hs-type">badImplicitSplice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-2644"></span><span>    </span><span id="local-6989586621683063244"><span class="annot"><span class="annottext">badImplicitSplice :: TcRnMessage
</span><a href="#local-6989586621683063244"><span class="hs-identifier hs-var hs-var">badImplicitSplice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">THError -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnTHError"><span class="hs-identifier hs-var">TcRnTHError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">THSyntaxError -&gt; THError
</span><a href="GHC.Tc.Errors.Types.html#THSyntaxError"><span class="hs-identifier hs-var">THSyntaxError</span></a></span><span> </span><span class="annot"><span class="annottext">THSyntaxError
</span><a href="GHC.Tc.Errors.Types.html#BadImplicitSplice"><span class="hs-identifier hs-var">BadImplicitSplice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2645"></span><span>
</span><span id="line-2646"></span><span class="hs-comment">-- Class declarations: added to the TyClGroup</span><span>
</span><span id="line-2647"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063248"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063248"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063249"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683063249"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063250"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063250"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClD"><span class="hs-identifier hs-type">TyClD</span></a></span><span> </span><span class="annot"><span class="annottext">XTyClD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063252"><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621683063252"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063253"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063253"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2648"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063248"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_tycld"><span class="hs-identifier hs-type">add_tycld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063250"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063252"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063249"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063253"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2649"></span><span>
</span><span id="line-2650"></span><span class="hs-comment">-- Signatures: fixity sigs go a different place than all others</span><span>
</span><span id="line-2651"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063255"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063255"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_fixds :: forall p. HsGroup p -&gt; [LFixitySig p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fixds"><span class="hs-identifier hs-var">hs_fixds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063256"><span class="annot"><span class="annottext">[LFixitySig GhcPs]
</span><a href="#local-6989586621683063256"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063257"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063257"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SigD"><span class="hs-identifier hs-type">SigD</span></a></span><span> </span><span class="annot"><span class="annottext">XSigD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FixSig"><span class="hs-identifier hs-type">FixSig</span></a></span><span> </span><span class="annot"><span class="annottext">XFixSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063260"><span class="annot"><span class="annottext">FixitySig GhcPs
</span><a href="#local-6989586621683063260"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063261"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063261"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2652"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063255"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_fixds"><span class="hs-identifier hs-var">hs_fixds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063257"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063260"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063256"><span class="hs-identifier hs-type">ts</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063261"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2653"></span><span>
</span><span id="line-2654"></span><span class="hs-comment">-- Standalone kind signatures: added to the TyClGroup</span><span>
</span><span id="line-2655"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063262"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063262"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063263"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683063263"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063264"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063264"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#KindSigD"><span class="hs-identifier hs-type">KindSigD</span></a></span><span> </span><span class="annot"><span class="annottext">XKindSigD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063266"><span class="annot"><span class="annottext">StandaloneKindSig GhcPs
</span><a href="#local-6989586621683063266"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063267"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063267"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2656"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063262"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_kisig"><span class="hs-identifier hs-type">add_kisig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063264"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063266"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063263"><span class="hs-identifier hs-type">ts</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063267"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2657"></span><span>
</span><span id="line-2658"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063269"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063269"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_valds :: forall p. HsGroup p -&gt; HsValBinds p
</span><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063270"><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621683063270"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063271"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063271"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#SigD"><span class="hs-identifier hs-type">SigD</span></a></span><span> </span><span class="annot"><span class="annottext">XSigD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063272"><span class="annot"><span class="annottext">Sig GhcPs
</span><a href="#local-6989586621683063272"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063273"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063273"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2659"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063269"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_sig"><span class="hs-identifier hs-type">add_sig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063271"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063272"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063270"><span class="hs-identifier hs-type">ts</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063273"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2660"></span><span>
</span><span id="line-2661"></span><span class="hs-comment">-- Value declarations: use add_bind</span><span>
</span><span id="line-2662"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063275"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063275"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_valds :: forall p. HsGroup p -&gt; HsValBinds p
</span><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063276"><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621683063276"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063277"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063277"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ValD"><span class="hs-identifier hs-type">ValD</span></a></span><span> </span><span class="annot"><span class="annottext">XValD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063279"><span class="annot"><span class="annottext">HsBindLR GhcPs GhcPs
</span><a href="#local-6989586621683063279"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063280"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063280"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2663"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063275"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_bind"><span class="hs-identifier hs-type">add_bind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063277"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063279"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063276"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063280"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2664"></span><span>
</span><span id="line-2665"></span><span class="hs-comment">-- Role annotations: added to the TyClGroup</span><span>
</span><span id="line-2666"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063282"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063282"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063283"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683063283"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063284"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063284"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RoleAnnotD"><span class="hs-identifier hs-type">RoleAnnotD</span></a></span><span> </span><span class="annot"><span class="annottext">XRoleAnnotD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063286"><span class="annot"><span class="annottext">RoleAnnotDecl GhcPs
</span><a href="#local-6989586621683063286"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063287"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063287"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2667"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063282"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_role_annot"><span class="hs-identifier hs-type">add_role_annot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063284"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063286"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063283"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063287"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2668"></span><span>
</span><span id="line-2669"></span><span class="hs-comment">-- NB instance declarations go into TyClGroups. We throw them into the first</span><span>
</span><span id="line-2670"></span><span class="hs-comment">-- group, just as we do for the TyClD case. The renamer will go on to group</span><span>
</span><span id="line-2671"></span><span class="hs-comment">-- and order them later.</span><span>
</span><span id="line-2672"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063289"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063289"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063290"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621683063290"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683063291"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063291"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#InstD"><span class="hs-identifier hs-type">InstD</span></a></span><span> </span><span class="annot"><span class="annottext">XInstD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063293"><span class="annot"><span class="annottext">InstDecl GhcPs
</span><a href="#local-6989586621683063293"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063294"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063294"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2673"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063289"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html#add_instd"><span class="hs-identifier hs-type">add_instd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063291"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063293"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683063290"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063294"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2674"></span><span>
</span><span id="line-2675"></span><span class="hs-comment">-- The rest are routine</span><span>
</span><span id="line-2676"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063296"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063296"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_derivds :: forall p. HsGroup p -&gt; [LDerivDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_derivds"><span class="hs-identifier hs-var">hs_derivds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063297"><span class="annot"><span class="annottext">[LDerivDecl GhcPs]
</span><a href="#local-6989586621683063297"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683063298"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063298"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DerivD"><span class="hs-identifier hs-type">DerivD</span></a></span><span> </span><span class="annot"><span class="annottext">XDerivD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063300"><span class="annot"><span class="annottext">DerivDecl GhcPs
</span><a href="#local-6989586621683063300"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063301"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063301"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2677"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063296"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_derivds"><span class="hs-identifier hs-var">hs_derivds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063298"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063300"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063297"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063301"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2678"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063302"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063302"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_defds :: forall p. HsGroup p -&gt; [LDefaultDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_defds"><span class="hs-identifier hs-var">hs_defds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063303"><span class="annot"><span class="annottext">[LDefaultDecl GhcPs]
</span><a href="#local-6989586621683063303"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683063304"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063304"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DefD"><span class="hs-identifier hs-type">DefD</span></a></span><span> </span><span class="annot"><span class="annottext">XDefD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063306"><span class="annot"><span class="annottext">DefaultDecl GhcPs
</span><a href="#local-6989586621683063306"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063307"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063307"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2679"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063302"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_defds"><span class="hs-identifier hs-var">hs_defds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063304"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063306"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063303"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063307"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2680"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063308"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063308"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_fords :: forall p. HsGroup p -&gt; [LForeignDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fords"><span class="hs-identifier hs-var">hs_fords</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063309"><span class="annot"><span class="annottext">[LForeignDecl GhcPs]
</span><a href="#local-6989586621683063309"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063310"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063310"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ForD"><span class="hs-identifier hs-type">ForD</span></a></span><span> </span><span class="annot"><span class="annottext">XForD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063312"><span class="annot"><span class="annottext">ForeignDecl GhcPs
</span><a href="#local-6989586621683063312"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063313"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063313"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2681"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063308"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_fords"><span class="hs-identifier hs-var">hs_fords</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063310"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063312"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063309"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063313"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2682"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063314"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063314"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_warnds :: forall p. HsGroup p -&gt; [LWarnDecls p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_warnds"><span class="hs-identifier hs-var">hs_warnds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063315"><span class="annot"><span class="annottext">[LWarnDecls GhcPs]
</span><a href="#local-6989586621683063315"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683063316"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063316"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#WarningD"><span class="hs-identifier hs-type">WarningD</span></a></span><span> </span><span class="annot"><span class="annottext">XWarningD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063318"><span class="annot"><span class="annottext">WarnDecls GhcPs
</span><a href="#local-6989586621683063318"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063319"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063319"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2683"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063314"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_warnds"><span class="hs-identifier hs-var">hs_warnds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063316"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063318"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063315"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063319"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2684"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063320"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063320"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_annds :: forall p. HsGroup p -&gt; [LAnnDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_annds"><span class="hs-identifier hs-var">hs_annds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063321"><span class="annot"><span class="annottext">[LAnnDecl GhcPs]
</span><a href="#local-6989586621683063321"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063322"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063322"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#AnnD"><span class="hs-identifier hs-type">AnnD</span></a></span><span> </span><span class="annot"><span class="annottext">XAnnD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063324"><span class="annot"><span class="annottext">AnnDecl GhcPs
</span><a href="#local-6989586621683063324"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063325"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063325"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2685"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063320"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_annds"><span class="hs-identifier hs-var">hs_annds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063322"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063324"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063321"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063325"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2686"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063326"><span class="annot"><span class="annottext">gp :: HsGroup GhcPs
</span><a href="#local-6989586621683063326"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">hs_ruleds :: forall p. HsGroup p -&gt; [LRuleDecls p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_ruleds"><span class="hs-identifier hs-var">hs_ruleds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063327"><span class="annot"><span class="annottext">[LRuleDecls GhcPs]
</span><a href="#local-6989586621683063327"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063328"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063328"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RuleD"><span class="hs-identifier hs-type">RuleD</span></a></span><span> </span><span class="annot"><span class="annottext">XRuleD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063330"><span class="annot"><span class="annottext">RuleDecls GhcPs
</span><a href="#local-6989586621683063330"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063331"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063331"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2687"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063326"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_ruleds"><span class="hs-identifier hs-var">hs_ruleds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063328"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063330"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063327"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063331"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2688"></span><span class="annot"><a href="GHC.Rename.Module.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621683063332"><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063332"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span id="local-6989586621683063333"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683063333"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DocD"><span class="hs-identifier hs-type">DocD</span></a></span><span> </span><span class="annot"><span class="annottext">XDocD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683063335"><span class="annot"><span class="annottext">DocDecl GhcPs
</span><a href="#local-6989586621683063335"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683063336"><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063336"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-2689"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsGroup GhcPs
-&gt; [LHsDecl GhcPs]
-&gt; RnM (HsGroup GhcPs, Maybe (SpliceDecl GhcPs, [LHsDecl GhcPs]))
</span><a href="GHC.Rename.Module.html#addl"><span class="hs-identifier hs-var">addl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsGroup GhcPs
</span><a href="#local-6989586621683063332"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_docs"><span class="hs-identifier hs-var">hs_docs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063333"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063335"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#hs_docs"><span class="hs-identifier hs-var">hs_docs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063332"><span class="hs-identifier hs-type">gp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[LHsDecl GhcPs]
</span><a href="#local-6989586621683063336"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-2690"></span><span>
</span><span id="line-2691"></span><span id="local-6989586621683061064"><span class="annot"><a href="GHC.Rename.Module.html#add_tycld"><span class="hs-identifier hs-type">add_tycld</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061064"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061064"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2692"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061064"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2693"></span><span id="add_tycld"><span class="annot"><span class="annottext">add_tycld :: forall (p :: Pass).
LTyClDecl (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
</span><a href="GHC.Rename.Module.html#add_tycld"><span class="hs-identifier hs-var hs-var">add_tycld</span></a></span></span><span> </span><span id="local-6989586621683063337"><span class="annot"><span class="annottext">LTyClDecl (GhcPass p)
</span><a href="#local-6989586621683063337"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup (GhcPass p)
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup (GhcPass p)
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-2694"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LTyClDecl (GhcPass p)
</span><a href="#local-6989586621683063337"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2695"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2696"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2697"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2698"></span><span>                                  </span><span class="hs-special">}</span><span>
</span><span id="line-2699"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-2700"></span><span class="annot"><a href="GHC.Rename.Module.html#add_tycld"><span class="hs-identifier hs-var">add_tycld</span></a></span><span> </span><span id="local-6989586621683063338"><span class="annot"><span class="annottext">LTyClDecl (GhcPass p)
</span><a href="#local-6989586621683063338"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063339"><span class="annot"><span class="annottext">ds :: TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063339"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: forall pass. TyClGroup pass -&gt; [LTyClDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063340"><span class="annot"><span class="annottext">[LTyClDecl (GhcPass p)]
</span><a href="#local-6989586621683063340"><span class="hs-identifier hs-var">tyclds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683063341"><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063341"><span class="hs-identifier hs-var">dss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2701"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063339"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063338"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063340"><span class="hs-identifier hs-type">tyclds</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063341"><span class="hs-identifier hs-var">dss</span></a></span><span>
</span><span id="line-2702"></span><span>
</span><span id="line-2703"></span><span id="local-6989586621683061076"><span class="annot"><a href="GHC.Rename.Module.html#add_instd"><span class="hs-identifier hs-type">add_instd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061076"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061076"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2704"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061076"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2705"></span><span id="add_instd"><span class="annot"><span class="annottext">add_instd :: forall (p :: Pass).
LInstDecl (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
</span><a href="GHC.Rename.Module.html#add_instd"><span class="hs-identifier hs-var hs-var">add_instd</span></a></span></span><span> </span><span id="local-6989586621683063342"><span class="annot"><span class="annottext">LInstDecl (GhcPass p)
</span><a href="#local-6989586621683063342"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup (GhcPass p)
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup (GhcPass p)
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-2706"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2707"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2708"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2709"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LInstDecl (GhcPass p)
</span><a href="#local-6989586621683063342"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2710"></span><span>                                  </span><span class="hs-special">}</span><span>
</span><span id="line-2711"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-2712"></span><span class="annot"><a href="GHC.Rename.Module.html#add_instd"><span class="hs-identifier hs-var">add_instd</span></a></span><span> </span><span id="local-6989586621683063343"><span class="annot"><span class="annottext">LInstDecl (GhcPass p)
</span><a href="#local-6989586621683063343"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063344"><span class="annot"><span class="annottext">ds :: TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063344"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_instds :: forall pass. TyClGroup pass -&gt; [LInstDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063345"><span class="annot"><span class="annottext">[LInstDecl (GhcPass p)]
</span><a href="#local-6989586621683063345"><span class="hs-identifier hs-var">instds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683063346"><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063346"><span class="hs-identifier hs-var">dss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2713"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063344"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063343"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063345"><span class="hs-identifier hs-type">instds</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063346"><span class="hs-identifier hs-var">dss</span></a></span><span>
</span><span id="line-2714"></span><span>
</span><span id="line-2715"></span><span id="local-6989586621683061074"><span class="annot"><a href="GHC.Rename.Module.html#add_role_annot"><span class="hs-identifier hs-type">add_role_annot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LRoleAnnotDecl"><span class="hs-identifier hs-type">LRoleAnnotDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061074"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061074"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2716"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061074"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2717"></span><span id="add_role_annot"><span class="annot"><span class="annottext">add_role_annot :: forall (p :: Pass).
LRoleAnnotDecl (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
</span><a href="GHC.Rename.Module.html#add_role_annot"><span class="hs-identifier hs-var hs-var">add_role_annot</span></a></span></span><span> </span><span id="local-6989586621683063347"><span class="annot"><span class="annottext">LRoleAnnotDecl (GhcPass p)
</span><a href="#local-6989586621683063347"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup (GhcPass p)
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup (GhcPass p)
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-2718"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2719"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2720"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LRoleAnnotDecl (GhcPass p)
</span><a href="#local-6989586621683063347"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2721"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2722"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-2723"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-2724"></span><span class="annot"><a href="GHC.Rename.Module.html#add_role_annot"><span class="hs-identifier hs-var">add_role_annot</span></a></span><span> </span><span id="local-6989586621683063348"><span class="annot"><span class="annottext">LRoleAnnotDecl (GhcPass p)
</span><a href="#local-6989586621683063348"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063349"><span class="annot"><span class="annottext">tycls :: TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063349"><span class="hs-identifier hs-var">tycls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_roles :: forall pass. TyClGroup pass -&gt; [LRoleAnnotDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063350"><span class="annot"><span class="annottext">[LRoleAnnotDecl (GhcPass p)]
</span><a href="#local-6989586621683063350"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683063351"><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063351"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2725"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063349"><span class="hs-identifier hs-var">tycls</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063348"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063350"><span class="hs-identifier hs-type">roles</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063351"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2726"></span><span>
</span><span id="line-2727"></span><span id="local-6989586621683061068"><span class="annot"><a href="GHC.Rename.Module.html#add_kisig"><span class="hs-identifier hs-type">add_kisig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LStandaloneKindSig"><span class="hs-identifier hs-type">LStandaloneKindSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061068"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2728"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061068"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061068"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2729"></span><span id="add_kisig"><span class="annot"><span class="annottext">add_kisig :: forall (p :: Pass).
LStandaloneKindSig (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
</span><a href="GHC.Rename.Module.html#add_kisig"><span class="hs-identifier hs-var hs-var">add_kisig</span></a></span></span><span> </span><span id="local-6989586621683063352"><span class="annot"><span class="annottext">LStandaloneKindSig (GhcPass p)
</span><a href="#local-6989586621683063352"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_ext :: XCTyClGroup (GhcPass p)
</span><a href="Language.Haskell.Syntax.Decls.html#group_ext"><span class="hs-identifier hs-var">group_ext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCTyClGroup (GhcPass p)
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span>
</span><span id="line-2730"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_tyclds :: [LTyClDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_tyclds"><span class="hs-identifier hs-var">group_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2731"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: [LStandaloneKindSig (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LStandaloneKindSig (GhcPass p)
</span><a href="#local-6989586621683063352"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2732"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_roles :: [LRoleAnnotDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_roles"><span class="hs-identifier hs-var">group_roles</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2733"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">group_instds :: [LInstDecl (GhcPass p)]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2734"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-2735"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-2736"></span><span class="annot"><a href="GHC.Rename.Module.html#add_kisig"><span class="hs-identifier hs-var">add_kisig</span></a></span><span> </span><span id="local-6989586621683063353"><span class="annot"><span class="annottext">LStandaloneKindSig (GhcPass p)
</span><a href="#local-6989586621683063353"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683063354"><span class="annot"><span class="annottext">tycls :: TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063354"><span class="hs-identifier hs-var">tycls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyClGroup"><span class="hs-identifier hs-type">TyClGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">group_kisigs :: forall pass. TyClGroup pass -&gt; [LStandaloneKindSig pass]
</span><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683063355"><span class="annot"><span class="annottext">[LStandaloneKindSig (GhcPass p)]
</span><a href="#local-6989586621683063355"><span class="hs-identifier hs-var">kisigs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621683063356"><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063356"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2737"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
</span><a href="#local-6989586621683063354"><span class="hs-identifier hs-var">tycls</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#group_kisigs"><span class="hs-identifier hs-var">group_kisigs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683063353"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683063355"><span class="hs-identifier hs-type">kisigs</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TyClGroup (GhcPass p)
-&gt; [TyClGroup (GhcPass p)] -&gt; [TyClGroup (GhcPass p)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TyClGroup (GhcPass p)]
</span><a href="#local-6989586621683063356"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2738"></span><span>
</span><span id="line-2739"></span><span id="local-6989586621683061071"><span class="annot"><a href="GHC.Rename.Module.html#add_bind"><span class="hs-identifier hs-type">add_bind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061071"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2740"></span><span id="add_bind"><span class="annot"><span class="annottext">add_bind :: forall a. LHsBind a -&gt; HsValBinds a -&gt; HsValBinds a
</span><a href="GHC.Rename.Module.html#add_bind"><span class="hs-identifier hs-var hs-var">add_bind</span></a></span></span><span> </span><span id="local-6989586621683063359"><span class="annot"><span class="annottext">LHsBind a
</span><a href="#local-6989586621683063359"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span id="local-6989586621683063360"><span class="annot"><span class="annottext">XValBinds a a
</span><a href="#local-6989586621683063360"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683063361"><span class="annot"><span class="annottext">LHsBindsLR a a
</span><a href="#local-6989586621683063361"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621683063362"><span class="annot"><span class="annottext">[LSig a]
</span><a href="#local-6989586621683063362"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XValBinds a a -&gt; LHsBindsLR a a -&gt; [LSig a] -&gt; HsValBindsLR a a
forall idL idR.
XValBinds idL idR
-&gt; LHsBindsLR idL idR -&gt; [LSig idR] -&gt; HsValBindsLR idL idR
</span><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XValBinds a a
</span><a href="#local-6989586621683063360"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsBindsLR a a
</span><a href="#local-6989586621683063361"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBindsLR a a -&gt; LHsBindsLR a a -&gt; LHsBindsLR a a
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsBind a
</span><a href="#local-6989586621683063359"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LSig a]
</span><a href="#local-6989586621683063362"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-2741"></span><span class="annot"><a href="GHC.Rename.Module.html#add_bind"><span class="hs-identifier hs-var">add_bind</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBind a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XValBindsLR"><span class="hs-identifier hs-type">XValBindsLR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; HsValBindsLR a a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.Rename.Module.add_bind&quot;</span></span><span>
</span><span id="line-2742"></span><span>
</span><span id="line-2743"></span><span id="local-6989586621683061069"><span class="annot"><a href="GHC.Rename.Module.html#add_sig"><span class="hs-identifier hs-type">add_sig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061069"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061069"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683061069"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-2744"></span><span id="add_sig"><span class="annot"><span class="annottext">add_sig :: forall (a :: Pass).
LSig (GhcPass a)
-&gt; HsValBinds (GhcPass a) -&gt; HsValBinds (GhcPass a)
</span><a href="GHC.Rename.Module.html#add_sig"><span class="hs-identifier hs-var hs-var">add_sig</span></a></span></span><span> </span><span id="local-6989586621683063365"><span class="annot"><span class="annottext">LSig (GhcPass a)
</span><a href="#local-6989586621683063365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span id="local-6989586621683063366"><span class="annot"><span class="annottext">XValBinds (GhcPass a) (GhcPass a)
</span><a href="#local-6989586621683063366"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621683063367"><span class="annot"><span class="annottext">LHsBindsLR (GhcPass a) (GhcPass a)
</span><a href="#local-6989586621683063367"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621683063368"><span class="annot"><span class="annottext">[LSig (GhcPass a)]
</span><a href="#local-6989586621683063368"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XValBinds (GhcPass a) (GhcPass a)
-&gt; LHsBindsLR (GhcPass a) (GhcPass a)
-&gt; [LSig (GhcPass a)]
-&gt; HsValBindsLR (GhcPass a) (GhcPass a)
forall idL idR.
XValBinds idL idR
-&gt; LHsBindsLR idL idR -&gt; [LSig idR] -&gt; HsValBindsLR idL idR
</span><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-var">ValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XValBinds (GhcPass a) (GhcPass a)
</span><a href="#local-6989586621683063366"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBindsLR (GhcPass a) (GhcPass a)
</span><a href="#local-6989586621683063367"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LSig (GhcPass a)
GenLocated SrcSpanAnnA (Sig (GhcPass a))
</span><a href="#local-6989586621683063365"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Sig (GhcPass a))
-&gt; [GenLocated SrcSpanAnnA (Sig (GhcPass a))]
-&gt; [GenLocated SrcSpanAnnA (Sig (GhcPass a))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LSig (GhcPass a)]
[GenLocated SrcSpanAnnA (Sig (GhcPass a))]
</span><a href="#local-6989586621683063368"><span class="hs-identifier hs-var">sigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2745"></span><span class="annot"><a href="GHC.Rename.Module.html#add_sig"><span class="hs-identifier hs-var">add_sig</span></a></span><span> </span><span class="annot"><span class="annottext">LSig (GhcPass a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XValBindsLR"><span class="hs-identifier hs-type">XValBindsLR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; HsValBindsLR (GhcPass a) (GhcPass a)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.Rename.Module.add_sig&quot;</span></span><span>
</span><span id="line-2746"></span></pre></body></html>