<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span>     </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfType"><span class="hs-identifier">shallowTyCoVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier">shallowTyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier">tyCoVarsOfType</span></a></span><span class="hs-special">,</span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier">tyCoVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier">tyCoVarsOfTypeDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesDSet"><span class="hs-identifier">tyCoVarsOfTypesDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier">tyCoFVsBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier">tyCoFVsVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndrs"><span class="hs-identifier">tyCoFVsVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier">tyCoFVsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier">tyCoVarsOfTypeList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier">tyCoFVsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesList"><span class="hs-identifier">tyCoVarsOfTypesList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deepTcvFolder"><span class="hs-identifier">deepTcvFolder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier">shallowTyCoVarsOfTyVarEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCoVarEnv"><span class="hs-identifier">shallowTyCoVarsOfCoVarEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCo"><span class="hs-identifier">shallowTyCoVarsOfCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier">shallowTyCoVarsOfCos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier">tyCoVarsOfCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCos"><span class="hs-identifier">tyCoVarsOfCos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfMCo"><span class="hs-identifier">tyCoVarsOfMCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfType"><span class="hs-identifier">coVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfTypes"><span class="hs-identifier">coVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCo"><span class="hs-identifier">coVarsOfCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCos"><span class="hs-identifier">coVarsOfCos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoDSet"><span class="hs-identifier">tyCoVarsOfCoDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier">tyCoFVsOfCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier">tyCoFVsOfCos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoList"><span class="hs-identifier">tyCoVarsOfCoList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCoDSet"><span class="hs-identifier">coVarsOfCoDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCosDSet"><span class="hs-identifier">coVarsOfCosDSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almostDevoidCoVarOfCo"><span class="hs-identifier">almostDevoidCoVarOfCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>        </span><span class="hs-comment">-- Injective free vars</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier">injectiveVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfTypes"><span class="hs-identifier">injectiveVarsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#isInjectiveInType"><span class="hs-identifier">isInjectiveInType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfType"><span class="hs-identifier">invisibleVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfTypes"><span class="hs-identifier">invisibleVarsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>        </span><span class="hs-comment">-- Any and No Free vars</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfType"><span class="hs-identifier">anyFreeVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfTypes"><span class="hs-identifier">anyFreeVarsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfCo"><span class="hs-identifier">anyFreeVarsOfCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier">noFreeVarsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfTypes"><span class="hs-identifier">noFreeVarsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfCo"><span class="hs-identifier">noFreeVarsOfCo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Free type constructors</span></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyConsOfType"><span class="hs-identifier">tyConsOfType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyConsOfTypes"><span class="hs-identifier">tyConsOfTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Free vars with visible/invisible separate</span></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#visVarsOfTypes"><span class="hs-identifier">visVarsOfTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#visVarsOfType"><span class="hs-identifier">visVarsOfType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Occurrence-check expansion</span></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier">occCheckExpand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Well-scoped free variables</span></span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier">scopedSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Closing over kinds</span></span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier">closeOverKindsDSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsList"><span class="hs-identifier">closeOverKindsList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier">closeOverKinds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Raw materials</span></span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="hs-identifier">Endo</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier">runTyCoVars</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier">partitionInvisibleTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier">coreView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier">rewriterView</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier">coercionLKind</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier">funTyFlagTyCon</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DM</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Any</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html"><span class="hs-identifier">GHC.Core.Coercion.Axiom</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiomRule"><span class="hs-identifier">CoAxiomRule</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BuiltInFamRewrite"><span class="hs-identifier">BuiltInFamRewrite</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier">coAxiomTyCon</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html"><span class="hs-identifier">GHC.Utils.FV</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html"><span class="hs-identifier">GHC.Types.Unique.Set</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html"><span class="hs-identifier">GHC.Data.Pair</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                 Free variables of types and coercions
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">{- Note [Shallow and deep free variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Definitions

* Shallow free variables of a type: the variables
  affected by substitution. Specifically, the (TyVarTy tv)
  and (CoVar cv) that appear
    - In the type and coercions appearing in the type
    - In shallow free variables of the kind of a Forall binder
  but NOT in the kind of the /occurrences/ of a type variable.

* Deep free variables of a type: shallow free variables, plus
  the deep free variables of the kinds of those variables.
  That is,  deepFVs( t ) = closeOverKinds( shallowFVs( t ) )

Examples:

  Type                     Shallow     Deep
  ---------------------------------
  (a : (k:Type))           {a}        {a,k}
  forall (a:(k:Type)). a   {k}        {k}
  (a:k-&gt;Type) (b:k)        {a,b}      {a,b,k}
-}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">{- Note [Free variables of types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The family of functions tyCoVarsOfType, tyCoVarsOfTypes etc, returns
a VarSet that is closed over the types of its variables.  More precisely,
  if    S = tyCoVarsOfType( t )
  and   (a:k) is in S
  then  tyCoVarsOftype( k ) is a subset of S

Example: The tyCoVars of this ((a:* -&gt; k) Int) is {a, k}.

We could /not/ close over the kinds of the variable occurrences, and
instead do so at call sites, but it seems that we always want to do
so, so it's easiest to do it here.

It turns out that getting the free variables of types is performance critical,
so we profiled several versions, exploring different implementation strategies.

1. Baseline version: uses FV naively. Essentially:

   tyCoVarsOfType ty = fvVarSet $ tyCoFVsOfType ty

   This is not nice, because FV introduces some overhead to implement
   determinism, and through its &quot;interesting var&quot; function, neither of which
   we need here, so they are a complete waste.

2. UnionVarSet version: instead of reusing the FV-based code, we simply used
   VarSets directly, trying to avoid the overhead of FV. E.g.:

   -- FV version:
   tyCoFVsOfType (AppTy fun arg)    a b c = (tyCoFVsOfType fun `unionFV` tyCoFVsOfType arg) a b c

   -- UnionVarSet version:
   tyCoVarsOfType (AppTy fun arg)    = (tyCoVarsOfType fun `unionVarSet` tyCoVarsOfType arg)

   This looks deceptively similar, but while FV internally builds a list- and
   set-generating function, the VarSet functions manipulate sets directly, and
   the latter performs a lot worse than the naive FV version.

3. Accumulator-style VarSet version: this is what we use now. We do use VarSet
   as our data structure, but delegate the actual work to a new
   ty_co_vars_of_...  family of functions, which use accumulator style and the
   &quot;in-scope set&quot; filter found in the internals of FV, but without the
   determinism overhead.

See #14880.

Note [Closing over free variable kinds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tyCoVarsOfType and tyCoFVsOfType, while traversing a type, will also close over
free variable kinds. In previous GHC versions, this happened naively: whenever
we would encounter an occurrence of a free type variable, we would close over
its kind. This, however is wrong for two reasons (see #14880):

1. Efficiency. If we have Proxy (a::k) -&gt; Proxy (a::k) -&gt; Proxy (a::k), then
   we don't want to have to traverse k more than once.

2. Correctness. Imagine we have forall k. b -&gt; k, where b has
   kind k, for some k bound in an outer scope. If we look at b's kind inside
   the forall, we'll collect that k is free and then remove k from the set of
   free variables. This is plain wrong. We must instead compute that b is free
   and then conclude that b's kind is free.

An obvious first approach is to move the closing-over-kinds from the
occurrences of a type variable to after finding the free vars - however, this
turns out to introduce performance regressions, and isn't even entirely
correct.

In fact, it isn't even important *when* we close over kinds; what matters is
that we handle each type var exactly once, and that we do it in the right
context.

So the next approach we tried was to use the &quot;in-scope set&quot; part of FV or the
equivalent argument in the accumulator-style `ty_co_vars_of_type` function, to
say &quot;don't bother with variables we have already closed over&quot;. This should work
fine in theory, but the code is complicated and doesn't perform well.

But there is a simpler way, which is implemented here. Consider the two points
above:

1. Efficiency: we now have an accumulator, so the second time we encounter 'a',
   we'll ignore it, certainly not looking at its kind - this is why
   pre-checking set membership before inserting ends up not only being faster,
   but also being correct.

2. Correctness: we have an &quot;in-scope set&quot; (I think we should call it it a
  &quot;bound-var set&quot;), specifying variables that are bound by a forall in the type
  we are traversing; we simply ignore these variables, certainly not looking at
  their kind.

So now consider:

    forall k. b -&gt; k

where b :: k-&gt;Type is free; but of course, it's a different k! When looking at
b -&gt; k we'll have k in the bound-var set. So we'll ignore the k. But suppose
this is our first encounter with b; we want the free vars of its kind. But we
want to behave as if we took the free vars of its kind at the end; that is,
with no bound vars in scope.

So the solution is easy. The old code was this:

  ty_co_vars_of_type (TyVarTy v) is acc
    | v `elemVarSet` is  = acc
    | v `elemVarSet` acc = acc
    | otherwise          = ty_co_vars_of_type (tyVarKind v) is (extendVarSet acc v)

Now all we need to do is take the free vars of tyVarKind v *with an empty
bound-var set*, thus:

ty_co_vars_of_type (TyVarTy v) is acc
  | v `elemVarSet` is  = acc
  | v `elemVarSet` acc = acc
  | otherwise          = ty_co_vars_of_type (tyVarKind v) emptyVarSet (extendVarSet acc v)
                                                          ^^^^^^^^^^^

And that's it. This works because a variable is either bound or free. If it is bound,
then we won't look at it at all. If it is free, then all the variables free in its
kind are free -- regardless of whether some local variable has the same Unique.
So if we're looking at a variable occurrence at all, then all variables in its
kind are free.

Note [Free vars and synonyms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When finding free variables we generally do not expand synonyms.  So given
   type T a = Int
the type (T [b]) will return `b` as a free variable, even though expanding the
synonym would get rid of it.  Expanding synonyms might lead to types that look
ill-scoped; an alternative we have not explored.

But see `occCheckExpand` in this module for a function that does, selectively,
expand synonyms to reduce free-var occurences.
-}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          Endo for free variables
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">{- Note [Accumulating parameter free variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We can use foldType to build an accumulating-parameter version of a
free-var finder, thus:

    fvs :: Type -&gt; TyCoVarSet
    fvs ty = appEndo (foldType folder ty) emptyVarSet

Recall that
    foldType :: TyCoFolder env a -&gt; env -&gt; Type -&gt; a

    newtype Endo a = Endo (a -&gt; a)   -- In Data.Monoid
    instance Monoid a =&gt; Monoid (Endo a) where
       (Endo f) `mappend` (Endo g) = Endo (f.g)

    appEndo :: Endo a -&gt; a -&gt; a
    appEndo (Endo f) x = f x

So `mappend` for Endos is just function composition.

It's very important that, after optimisation, we end up with
* an arity-three function
* that is strict in the accumulator

   fvs env (TyVarTy v) acc
      | v `elemVarSet` env = acc
      | v `elemVarSet` acc = acc
      | otherwise          = acc `extendVarSet` v
   fvs env (AppTy t1 t2)   = fvs env t1 (fvs env t2 acc)
   ...

The &quot;strict in the accumulator&quot; part is to ensure that in the
AppTy equation we don't build a thunk for (fvs env t2 acc).

The optimiser does do all this, but not very robustly. It depends
critically on the basic arity-2 function not being exported, so that
all its calls are visibly to three arguments. This analysis is
done by the Call Arity pass.

TL;DR: check this regularly!
-}</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-type">runTyCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-295"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-pragma hs-type">runTyCoVars</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-296"></span><span id="runTyCoVars"><span class="annot"><span class="annottext">runTyCoVars :: Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var hs-var">runTyCoVars</span></a></span></span><span> </span><span id="local-6989586621682560645"><span class="annot"><span class="annottext">Endo VarSet
</span><a href="#local-6989586621682560645"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet -&gt; VarSet
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">Endo VarSet
</span><a href="#local-6989586621682560645"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          Deep free variables
          See Note [Shallow and deep free variables]
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-type">tyCoVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- The &quot;deep&quot; TyCoVars of the the type</span><span>
</span><span id="line-307"></span><span id="tyCoVarsOfType"><span class="annot"><span class="annottext">tyCoVarsOfType :: Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var hs-var">tyCoVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682560648"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560648"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_ty"><span class="hs-identifier hs-var">deep_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560648"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- Alternative:</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   tyCoVarsOfType ty = closeOverKinds (shallowTyCoVarsOfType ty)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-type">tyCoVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- The &quot;deep&quot; TyCoVars of the the type</span><span>
</span><span id="line-313"></span><span id="tyCoVarsOfTypes"><span class="annot"><span class="annottext">tyCoVarsOfTypes :: [Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682560650"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560650"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_tys"><span class="hs-identifier hs-var">deep_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560650"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- Alternative:</span><span>
</span><span id="line-315"></span><span class="hs-comment">--   tyCoVarsOfTypes tys = closeOverKinds (shallowTyCoVarsOfTypes tys)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-type">tyCoVarsOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- The &quot;deep&quot; TyCoVars of the the coercion</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-320"></span><span id="tyCoVarsOfCo"><span class="annot"><span class="annottext">tyCoVarsOfCo :: Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var hs-var">tyCoVarsOfCo</span></a></span></span><span> </span><span id="local-6989586621682560652"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560652"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_co"><span class="hs-identifier hs-var">deep_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560652"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfMCo"><span class="hs-identifier hs-type">tyCoVarsOfMCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCoercion"><span class="hs-identifier hs-type">MCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-323"></span><span id="tyCoVarsOfMCo"><span class="annot"><span class="annottext">tyCoVarsOfMCo :: MCoercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfMCo"><span class="hs-identifier hs-var hs-var">tyCoVarsOfMCo</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-324"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfMCo"><span class="hs-identifier hs-var">tyCoVarsOfMCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682560656"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560656"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560656"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCos"><span class="hs-identifier hs-type">tyCoVarsOfCos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-327"></span><span id="tyCoVarsOfCos"><span class="annot"><span class="annottext">tyCoVarsOfCos :: [Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCos"><span class="hs-identifier hs-var hs-var">tyCoVarsOfCos</span></a></span></span><span> </span><span id="local-6989586621682560657"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560657"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cos"><span class="hs-identifier hs-var">deep_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560657"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_ty"><span class="hs-identifier hs-type">deep_ty</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-330"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_tys"><span class="hs-identifier hs-type">deep_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-331"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_co"><span class="hs-identifier hs-type">deep_co</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-332"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_cos"><span class="hs-identifier hs-type">deep_cos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-333"></span><span class="hs-special">(</span><span id="deep_ty"><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_ty"><span class="hs-identifier hs-var">deep_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_tys"><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_tys"><span class="hs-identifier hs-var">deep_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_co"><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_co"><span class="hs-identifier hs-var">deep_co</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_cos"><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cos"><span class="hs-identifier hs-var">deep_cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
-&gt; VarSet
-&gt; (Type -&gt; Endo VarSet, [Type] -&gt; Endo VarSet,
    Coercion -&gt; Endo VarSet, [Coercion] -&gt; Endo VarSet)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#deepTcvFolder"><span class="hs-identifier hs-var">deepTcvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deepTcvFolder"><span class="hs-identifier hs-type">deepTcvFolder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span id="deepTcvFolder"><span class="annot"><span class="annottext">deepTcvFolder :: TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#deepTcvFolder"><span class="hs-identifier hs-var hs-var">deepTcvFolder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcf_view :: Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#tcf_view"><span class="hs-identifier hs-var">tcf_view</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#noView"><span class="hs-identifier hs-var">noView</span></a></span><span>  </span><span class="hs-comment">-- See Note [Free vars and synonyms]</span><span>
</span><span id="line-337"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tyvar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tyvar"><span class="hs-identifier hs-var">tcf_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560665"><span class="hs-identifier hs-var">do_tcv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_covar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_covar"><span class="hs-identifier hs-var">tcf_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560665"><span class="hs-identifier hs-var">do_tcv</span></a></span><span>
</span><span id="line-338"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_hole :: VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_hole"><span class="hs-identifier hs-var">tcf_hole</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="#local-6989586621682560668"><span class="hs-identifier hs-var">do_hole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tycobinder :: VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tycobinder"><span class="hs-identifier hs-var">tcf_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
forall {p}. VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560670"><span class="hs-identifier hs-var">do_bndr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621682560665"><span class="annot"><span class="annottext">do_tcv :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560665"><span class="hs-identifier hs-var hs-var">do_tcv</span></a></span></span><span> </span><span id="local-6989586621682560671"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560671"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560672"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560672"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; Endo VarSet
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621682560674"><span class="hs-identifier hs-var">do_it</span></a></span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>        </span><span id="local-6989586621682560674"><span class="annot"><span class="annottext">do_it :: VarSet -&gt; VarSet
</span><a href="#local-6989586621682560674"><span class="hs-identifier hs-var hs-var">do_it</span></a></span></span><span> </span><span id="local-6989586621682560675"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560675"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560672"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560671"><span class="hs-identifier hs-var">is</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560675"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-343"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560672"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560675"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560675"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-344"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet -&gt; VarSet
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_ty"><span class="hs-identifier hs-var">deep_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560672"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; VarSet -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-345"></span><span>                                         </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560675"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560672"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621682560670"><span class="annot"><span class="annottext">do_bndr :: VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560670"><span class="hs-identifier hs-var hs-var">do_bndr</span></a></span></span><span> </span><span id="local-6989586621682560679"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560679"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560680"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560680"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560679"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560680"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621682560668"><span class="annot"><span class="annottext">do_hole :: VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="#local-6989586621682560668"><span class="hs-identifier hs-var hs-var">do_hole</span></a></span></span><span> </span><span id="local-6989586621682560681"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560681"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560682"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560682"><span class="hs-identifier hs-var">hole</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560665"><span class="hs-identifier hs-var">do_tcv</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560681"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560682"><span class="hs-identifier hs-var">hole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                       </span><span class="hs-comment">-- See Note [CoercionHoles and coercion free variables]</span><span>
</span><span id="line-350"></span><span>                       </span><span class="hs-comment">-- in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          Shallow free variables
          See Note [Shallow and deep free variables]
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfType"><span class="hs-identifier hs-type">shallowTyCoVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-362"></span><span id="shallowTyCoVarsOfType"><span class="annot"><span class="annottext">shallowTyCoVarsOfType :: Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfType"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682560684"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560684"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_ty"><span class="hs-identifier hs-var">shallow_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560684"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-type">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-365"></span><span id="shallowTyCoVarsOfTypes"><span class="annot"><span class="annottext">shallowTyCoVarsOfTypes :: [Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682560686"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560686"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_tys"><span class="hs-identifier hs-var">shallow_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560686"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCo"><span class="hs-identifier hs-type">shallowTyCoVarsOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-368"></span><span id="shallowTyCoVarsOfCo"><span class="annot"><span class="annottext">shallowTyCoVarsOfCo :: Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCo"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfCo</span></a></span></span><span> </span><span id="local-6989586621682560688"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560688"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_co"><span class="hs-identifier hs-var">shallow_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560688"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier hs-type">shallowTyCoVarsOfCos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-371"></span><span id="shallowTyCoVarsOfCos"><span class="annot"><span class="annottext">shallowTyCoVarsOfCos :: [Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfCos</span></a></span></span><span> </span><span id="local-6989586621682560690"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560690"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_cos"><span class="hs-identifier hs-var">shallow_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560690"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- | Returns free variables of types, including kind variables as</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- a non-deterministic set. For type synonyms it does /not/ expand the</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- synonym.</span><span>
</span><span id="line-376"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier hs-type">shallowTyCoVarsOfTyVarEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TyVarEnv"><span class="hs-identifier hs-type">TyVarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-378"></span><span id="shallowTyCoVarsOfTyVarEnv"><span class="annot"><span class="annottext">shallowTyCoVarsOfTyVarEnv :: TyVarEnv Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfTyVarEnv</span></a></span></span><span> </span><span id="local-6989586621682560692"><span class="annot"><span class="annottext">TyVarEnv Type
</span><a href="#local-6989586621682560692"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVarEnv Type -&gt; [Type]
forall {k} (key :: k) elt. UniqFM key elt -&gt; [elt]
</span><a href="GHC.Types.Unique.FM.html#nonDetEltsUFM"><span class="hs-identifier hs-var">nonDetEltsUFM</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarEnv Type
</span><a href="#local-6989586621682560692"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here because we immediately</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-comment">-- forget the ordering by returning a set</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCoVarEnv"><span class="hs-identifier hs-type">shallowTyCoVarsOfCoVarEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#CoVarEnv"><span class="hs-identifier hs-type">CoVarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-383"></span><span id="shallowTyCoVarsOfCoVarEnv"><span class="annot"><span class="annottext">shallowTyCoVarsOfCoVarEnv :: CoVarEnv Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCoVarEnv"><span class="hs-identifier hs-var hs-var">shallowTyCoVarsOfCoVarEnv</span></a></span></span><span> </span><span id="local-6989586621682560694"><span class="annot"><span class="annottext">CoVarEnv Coercion
</span><a href="#local-6989586621682560694"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier hs-var">shallowTyCoVarsOfCos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoVarEnv Coercion -&gt; [Coercion]
forall {k} (key :: k) elt. UniqFM key elt -&gt; [elt]
</span><a href="GHC.Types.Unique.FM.html#nonDetEltsUFM"><span class="hs-identifier hs-var">nonDetEltsUFM</span></a></span><span> </span><span class="annot"><span class="annottext">CoVarEnv Coercion
</span><a href="#local-6989586621682560694"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here because we immediately</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-comment">-- forget the ordering by returning a set</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallow_ty"><span class="hs-identifier hs-type">shallow_ty</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-388"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallow_tys"><span class="hs-identifier hs-type">shallow_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-389"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallow_co"><span class="hs-identifier hs-type">shallow_co</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-390"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallow_cos"><span class="hs-identifier hs-type">shallow_cos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-391"></span><span class="hs-special">(</span><span id="shallow_ty"><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_ty"><span class="hs-identifier hs-var">shallow_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="shallow_tys"><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_tys"><span class="hs-identifier hs-var">shallow_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="shallow_co"><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_co"><span class="hs-identifier hs-var">shallow_co</span></a></span></span><span class="hs-special">,</span><span> </span><span id="shallow_cos"><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallow_cos"><span class="hs-identifier hs-var">shallow_cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
-&gt; VarSet
-&gt; (Type -&gt; Endo VarSet, [Type] -&gt; Endo VarSet,
    Coercion -&gt; Endo VarSet, [Coercion] -&gt; Endo VarSet)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#shallowTcvFolder"><span class="hs-identifier hs-var">shallowTcvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#shallowTcvFolder"><span class="hs-identifier hs-type">shallowTcvFolder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span id="shallowTcvFolder"><span class="annot"><span class="annottext">shallowTcvFolder :: TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#shallowTcvFolder"><span class="hs-identifier hs-var hs-var">shallowTcvFolder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcf_view :: Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#tcf_view"><span class="hs-identifier hs-var">tcf_view</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#noView"><span class="hs-identifier hs-var">noView</span></a></span><span>  </span><span class="hs-comment">-- See Note [Free vars and synonyms]</span><span>
</span><span id="line-395"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tyvar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tyvar"><span class="hs-identifier hs-var">tcf_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560697"><span class="hs-identifier hs-var">do_tcv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_covar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_covar"><span class="hs-identifier hs-var">tcf_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560697"><span class="hs-identifier hs-var">do_tcv</span></a></span><span>
</span><span id="line-396"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_hole :: VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_hole"><span class="hs-identifier hs-var">tcf_hole</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; CoercionHole -&gt; Endo VarSet
forall {a} {p} {p}. Monoid a =&gt; p -&gt; p -&gt; a
</span><a href="#local-6989586621682560698"><span class="hs-identifier hs-var">do_hole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tycobinder :: VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tycobinder"><span class="hs-identifier hs-var">tcf_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
forall {p}. VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560699"><span class="hs-identifier hs-var">do_bndr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621682560697"><span class="annot"><span class="annottext">do_tcv :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560697"><span class="hs-identifier hs-var hs-var">do_tcv</span></a></span></span><span> </span><span id="local-6989586621682560700"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560700"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560701"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560701"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; Endo VarSet
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621682560702"><span class="hs-identifier hs-var">do_it</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>        </span><span id="local-6989586621682560702"><span class="annot"><span class="annottext">do_it :: VarSet -&gt; VarSet
</span><a href="#local-6989586621682560702"><span class="hs-identifier hs-var hs-var">do_it</span></a></span></span><span> </span><span id="local-6989586621682560703"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560703"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560701"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560700"><span class="hs-identifier hs-var">is</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560703"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-401"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560701"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560703"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560703"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-402"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560703"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560701"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621682560699"><span class="annot"><span class="annottext">do_bndr :: VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560699"><span class="hs-identifier hs-var hs-var">do_bndr</span></a></span></span><span> </span><span id="local-6989586621682560704"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560704"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560705"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560705"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560704"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560705"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621682560698"><span class="annot"><span class="annottext">do_hole :: p -&gt; p -&gt; a
</span><a href="#local-6989586621682560698"><span class="hs-identifier hs-var hs-var">do_hole</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>   </span><span class="hs-comment">-- Ignore coercion holes</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          Free coercion variables
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">{- Note [Finding free coercion variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Here we are only interested in the free /coercion/ variables.
We can achieve this through a slightly different TyCo folder.

Notice that we look deeply, into kinds.

See #14880.
-}</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- See Note [Finding free coercion variables]</span><span>
</span><span id="line-426"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfType"><span class="hs-identifier hs-type">coVarsOfType</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-427"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfTypes"><span class="hs-identifier hs-type">coVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-428"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCo"><span class="hs-identifier hs-type">coVarsOfCo</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-429"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCos"><span class="hs-identifier hs-type">coVarsOfCos</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span id="coVarsOfType"><span class="annot"><span class="annottext">coVarsOfType :: Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfType"><span class="hs-identifier hs-var hs-var">coVarsOfType</span></a></span></span><span>  </span><span id="local-6989586621682560712"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560712"><span class="hs-identifier hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_ty"><span class="hs-identifier hs-var">deep_cv_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560712"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span id="coVarsOfTypes"><span class="annot"><span class="annottext">coVarsOfTypes :: [Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfTypes"><span class="hs-identifier hs-var hs-var">coVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682560714"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560714"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_tys"><span class="hs-identifier hs-var">deep_cv_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560714"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span id="coVarsOfCo"><span class="annot"><span class="annottext">coVarsOfCo :: Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfCo"><span class="hs-identifier hs-var hs-var">coVarsOfCo</span></a></span></span><span>    </span><span id="local-6989586621682560716"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560716"><span class="hs-identifier hs-var">co</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_co"><span class="hs-identifier hs-var">deep_cv_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560716"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="coVarsOfCos"><span class="annot"><span class="annottext">coVarsOfCos :: [Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfCos"><span class="hs-identifier hs-var hs-var">coVarsOfCos</span></a></span></span><span>   </span><span id="local-6989586621682560718"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560718"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#runTyCoVars"><span class="hs-identifier hs-var">runTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_cos"><span class="hs-identifier hs-var">deep_cv_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560718"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_cv_ty"><span class="hs-identifier hs-type">deep_cv_ty</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-437"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_cv_tys"><span class="hs-identifier hs-type">deep_cv_tys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-438"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_cv_co"><span class="hs-identifier hs-type">deep_cv_co</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-439"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deep_cv_cos"><span class="hs-identifier hs-type">deep_cv_cos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span>
</span><span id="line-440"></span><span class="hs-special">(</span><span id="deep_cv_ty"><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_ty"><span class="hs-identifier hs-var">deep_cv_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_cv_tys"><span class="annot"><span class="annottext">[Type] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_tys"><span class="hs-identifier hs-var">deep_cv_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_cv_co"><span class="annot"><span class="annottext">Coercion -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_co"><span class="hs-identifier hs-var">deep_cv_co</span></a></span></span><span class="hs-special">,</span><span> </span><span id="deep_cv_cos"><span class="annot"><span class="annottext">[Coercion] -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_cos"><span class="hs-identifier hs-var">deep_cv_cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
-&gt; VarSet
-&gt; (Type -&gt; Endo VarSet, [Type] -&gt; Endo VarSet,
    Coercion -&gt; Endo VarSet, [Coercion] -&gt; Endo VarSet)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#deepCoVarFolder"><span class="hs-identifier hs-var">deepCoVarFolder</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#deepCoVarFolder"><span class="hs-identifier hs-type">deepCoVarFolder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#CoVarSet"><span class="hs-identifier hs-type">CoVarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span id="deepCoVarFolder"><span class="annot"><span class="annottext">deepCoVarFolder :: TyCoFolder VarSet (Endo VarSet)
</span><a href="GHC.Core.TyCo.FVs.html#deepCoVarFolder"><span class="hs-identifier hs-var hs-var">deepCoVarFolder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcf_view :: Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#tcf_view"><span class="hs-identifier hs-var">tcf_view</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#noView"><span class="hs-identifier hs-var">noView</span></a></span><span>
</span><span id="line-444"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tyvar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tyvar"><span class="hs-identifier hs-var">tcf_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
forall {a} {p} {p}. Monoid a =&gt; p -&gt; p -&gt; a
</span><a href="#local-6989586621682560722"><span class="hs-identifier hs-var">do_tyvar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_covar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_covar"><span class="hs-identifier hs-var">tcf_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560723"><span class="hs-identifier hs-var">do_covar</span></a></span><span>
</span><span id="line-445"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_hole :: VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_hole"><span class="hs-identifier hs-var">tcf_hole</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="#local-6989586621682560724"><span class="hs-identifier hs-var">do_hole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tycobinder :: VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tycobinder"><span class="hs-identifier hs-var">tcf_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
forall {p}. VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560725"><span class="hs-identifier hs-var">do_bndr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-447"></span><span>    </span><span id="local-6989586621682560722"><span class="annot"><span class="annottext">do_tyvar :: p -&gt; p -&gt; a
</span><a href="#local-6989586621682560722"><span class="hs-identifier hs-var hs-var">do_tyvar</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-comment">-- This do_tyvar means we won't see any CoVars in this</span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-comment">-- TyVar's kind.   This may be wrong; but it's the way it's</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-comment">-- always been.  And its awkward to change, because</span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-comment">-- the tyvar won't end up in the accumulator, so</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-comment">-- we'd look repeatedly.  Blargh.</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621682560723"><span class="annot"><span class="annottext">do_covar :: VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560723"><span class="hs-identifier hs-var hs-var">do_covar</span></a></span></span><span> </span><span id="local-6989586621682560730"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560730"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560731"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560731"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; Endo VarSet
forall a. (a -&gt; a) -&gt; Endo a
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621682560732"><span class="hs-identifier hs-var">do_it</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>        </span><span id="local-6989586621682560732"><span class="annot"><span class="annottext">do_it :: VarSet -&gt; VarSet
</span><a href="#local-6989586621682560732"><span class="hs-identifier hs-var hs-var">do_it</span></a></span></span><span> </span><span id="local-6989586621682560733"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560733"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560731"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560730"><span class="hs-identifier hs-var">is</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560733"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-457"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560731"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560733"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560733"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-458"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet -&gt; VarSet
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_cv_ty"><span class="hs-identifier hs-var">deep_cv_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560731"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; VarSet -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-459"></span><span>                                         </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560733"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560731"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621682560725"><span class="annot"><span class="annottext">do_bndr :: VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682560725"><span class="hs-identifier hs-var hs-var">do_bndr</span></a></span></span><span> </span><span id="local-6989586621682560734"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560734"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560735"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560735"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560734"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560735"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621682560724"><span class="annot"><span class="annottext">do_hole :: VarSet -&gt; CoercionHole -&gt; Endo VarSet
</span><a href="#local-6989586621682560724"><span class="hs-identifier hs-var hs-var">do_hole</span></a></span></span><span> </span><span id="local-6989586621682560736"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560736"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682560737"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560737"><span class="hs-identifier hs-var">hole</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Endo VarSet
</span><a href="#local-6989586621682560723"><span class="hs-identifier hs-var">do_covar</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560736"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560737"><span class="hs-identifier hs-var">hole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                       </span><span class="hs-comment">-- See Note [CoercionHoles and coercion free variables]</span><span>
</span><span id="line-464"></span><span>                       </span><span class="hs-comment">-- in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">------- Same again, but for DCoVarSet ----------</span><span>
</span><span id="line-467"></span><span class="hs-comment">--    But this time the free vars are shallow</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCosDSet"><span class="hs-identifier hs-type">coVarsOfCosDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DCoVarSet"><span class="hs-identifier hs-type">DCoVarSet</span></a></span><span>
</span><span id="line-470"></span><span id="coVarsOfCosDSet"><span class="annot"><span class="annottext">coVarsOfCosDSet :: [Coercion] -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfCosDSet"><span class="hs-identifier hs-var hs-var">coVarsOfCosDSet</span></a></span></span><span> </span><span id="local-6989586621682560738"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560738"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun -&gt; FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSetSome"><span class="hs-identifier hs-var">fvDVarSetSome</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560738"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#coVarsOfCoDSet"><span class="hs-identifier hs-type">coVarsOfCoDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DCoVarSet"><span class="hs-identifier hs-type">DCoVarSet</span></a></span><span>
</span><span id="line-473"></span><span id="coVarsOfCoDSet"><span class="annot"><span class="annottext">coVarsOfCoDSet :: Coercion -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#coVarsOfCoDSet"><span class="hs-identifier hs-var hs-var">coVarsOfCoDSet</span></a></span></span><span> </span><span id="local-6989586621682560741"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560741"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun -&gt; FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSetSome"><span class="hs-identifier hs-var">fvDVarSetSome</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560741"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          Closing over kinds
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">------------- Closing over kinds -----------------</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier hs-type">closeOverKinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- For each element of the input set,</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- add the deep free variables of its kind</span><span>
</span><span id="line-487"></span><span id="closeOverKinds"><span class="annot"><span class="annottext">closeOverKinds :: VarSet -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKinds"><span class="hs-identifier hs-var hs-var">closeOverKinds</span></a></span></span><span> </span><span id="local-6989586621682560742"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560742"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; VarSet -&gt; VarSet) -&gt; VarSet -&gt; VarSet -&gt; VarSet
forall a. (Var -&gt; a -&gt; a) -&gt; a -&gt; VarSet -&gt; a
</span><a href="GHC.Types.Var.Set.html#nonDetStrictFoldVarSet"><span class="hs-identifier hs-var">nonDetStrictFoldVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; VarSet
</span><a href="#local-6989586621682560744"><span class="hs-identifier hs-var">do_one</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560742"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560742"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621682560744"><span class="annot"><span class="annottext">do_one :: Var -&gt; VarSet -&gt; VarSet
</span><a href="#local-6989586621682560744"><span class="hs-identifier hs-var hs-var">do_one</span></a></span></span><span> </span><span id="local-6989586621682560745"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560745"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682560746"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560746"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endo VarSet -&gt; VarSet -&gt; VarSet
forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Endo VarSet
</span><a href="GHC.Core.TyCo.FVs.html#deep_ty"><span class="hs-identifier hs-var">deep_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560745"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560746"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">{- --------------- Alternative version 1 (using FV) ------------
closeOverKinds = fvVarSet . closeOverKindsFV . nonDetEltsUniqSet
-}</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">{- ---------------- Alternative version 2 -------------

-- | Add the kind variables free in the kinds of the tyvars in the given set.
-- Returns a non-deterministic set.
closeOverKinds :: TyCoVarSet -&gt; TyCoVarSet
closeOverKinds vs
   = go vs vs
  where
    go :: VarSet   -- Work list
       -&gt; VarSet   -- Accumulator, always a superset of wl
       -&gt; VarSet
    go wl acc
      | isEmptyVarSet wl = acc
      | otherwise        = go wl_kvs (acc `unionVarSet` wl_kvs)
      where
        k v inner_acc = ty_co_vars_of_type (varType v) acc inner_acc
        wl_kvs = nonDetFoldVarSet k emptyVarSet wl
        -- wl_kvs = union of shallow free vars of the kinds of wl
        --          but don't bother to collect vars in acc

-}</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">{- ---------------- Alternative version 3 -------------
-- | Add the kind variables free in the kinds of the tyvars in the given set.
-- Returns a non-deterministic set.
closeOverKinds :: TyVarSet -&gt; TyVarSet
closeOverKinds vs = close_over_kinds vs emptyVarSet


close_over_kinds :: TyVarSet  -- Work list
                 -&gt; TyVarSet  -- Accumulator
                 -&gt; TyVarSet
-- Precondition: in any call (close_over_kinds wl acc)
--  for every tv in acc, the shallow kind-vars of tv
--  are either in the work list wl, or in acc
-- Postcondition: result is the deep free vars of (wl `union` acc)
close_over_kinds wl acc
  = nonDetFoldVarSet do_one acc wl
  where
    do_one :: Var -&gt; TyVarSet -&gt; TyVarSet
    -- (do_one v acc) adds v and its deep free-vars to acc
    do_one v acc | v `elemVarSet` acc
                 = acc
                 | otherwise
                 = close_over_kinds (shallowTyCoVarsOfType (varType v)) $
                   acc `extendVarSet` v
-}</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
          The FV versions return deterministic results
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-comment">-- | Given a list of tyvars returns a deterministic FV computation that</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- returns the given tyvars with the kind variables free in the kinds of the</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- given tyvars.</span><span>
</span><span id="line-553"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsFV"><span class="hs-identifier hs-type">closeOverKindsFV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-554"></span><span id="closeOverKindsFV"><span class="annot"><span class="annottext">closeOverKindsFV :: [Var] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKindsFV"><span class="hs-identifier hs-var hs-var">closeOverKindsFV</span></a></span></span><span> </span><span id="local-6989586621682560749"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560749"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><span class="annottext">(Var -&gt; FV) -&gt; [Var] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FV) -&gt; (Var -&gt; Type) -&gt; Var -&gt; FV
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560749"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FV
</span><a href="GHC.Utils.FV.html#mkFVs"><span class="hs-identifier hs-var">mkFVs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560749"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">-- | Add the kind variables free in the kinds of the tyvars in the given set.</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- Returns a deterministically ordered list.</span><span>
</span><span id="line-559"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsList"><span class="hs-identifier hs-type">closeOverKindsList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span id="closeOverKindsList"><span class="annot"><span class="annottext">closeOverKindsList :: [Var] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKindsList"><span class="hs-identifier hs-var hs-var">closeOverKindsList</span></a></span></span><span> </span><span id="local-6989586621682560755"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560755"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; [Var]
</span><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier hs-var">fvVarList</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; [Var]) -&gt; FV -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKindsFV"><span class="hs-identifier hs-var">closeOverKindsFV</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560755"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">-- | Add the kind variables free in the kinds of the tyvars in the given set.</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- Returns a deterministic set.</span><span>
</span><span id="line-564"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier hs-type">closeOverKindsDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyVarSet"><span class="hs-identifier hs-type">DTyVarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyVarSet"><span class="hs-identifier hs-type">DTyVarSet</span></a></span><span>
</span><span id="line-565"></span><span id="closeOverKindsDSet"><span class="annot"><span class="annottext">closeOverKindsDSet :: DCoVarSet -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKindsDSet"><span class="hs-identifier hs-var hs-var">closeOverKindsDSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSet"><span class="hs-identifier hs-var">fvDVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; DCoVarSet) -&gt; (DCoVarSet -&gt; FV) -&gt; DCoVarSet -&gt; DCoVarSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#closeOverKindsFV"><span class="hs-identifier hs-var">closeOverKindsFV</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; FV) -&gt; (DCoVarSet -&gt; [Var]) -&gt; DCoVarSet -&gt; FV
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DCoVarSet -&gt; [Var]
</span><a href="GHC.Types.Var.Set.html#dVarSetElems"><span class="hs-identifier hs-var">dVarSetElems</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | `tyCoFVsOfType` that returns free variables of a type in a deterministic</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- set. For explanation of why using `VarSet` is not deterministic see</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- Note [Deterministic FV] in &quot;GHC.Utils.FV&quot;.</span><span>
</span><span id="line-570"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier hs-type">tyCoVarsOfTypeDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyCoVarSet"><span class="hs-identifier hs-type">DTyCoVarSet</span></a></span><span>
</span><span id="line-571"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-572"></span><span id="tyCoVarsOfTypeDSet"><span class="annot"><span class="annottext">tyCoVarsOfTypeDSet :: Type -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeDSet"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypeDSet</span></a></span></span><span> </span><span id="local-6989586621682560761"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560761"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSet"><span class="hs-identifier hs-var">fvDVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; DCoVarSet) -&gt; FV -&gt; DCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560761"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-comment">-- | `tyCoFVsOfType` that returns free variables of a type in deterministic</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- order. For explanation of why using `VarSet` is not deterministic see</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- Note [Deterministic FV] in &quot;GHC.Utils.FV&quot;.</span><span>
</span><span id="line-577"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-type">tyCoVarsOfTypeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-579"></span><span id="tyCoVarsOfTypeList"><span class="annot"><span class="annottext">tyCoVarsOfTypeList :: Type -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypeList</span></a></span></span><span> </span><span id="local-6989586621682560763"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560763"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; [Var]
</span><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier hs-var">fvVarList</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; [Var]) -&gt; FV -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560763"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-comment">-- | Returns free variables of types, including kind variables as</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- a deterministic set. For type synonyms it does /not/ expand the</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- synonym.</span><span>
</span><span id="line-584"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesDSet"><span class="hs-identifier hs-type">tyCoVarsOfTypesDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyCoVarSet"><span class="hs-identifier hs-type">DTyCoVarSet</span></a></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-586"></span><span id="tyCoVarsOfTypesDSet"><span class="annot"><span class="annottext">tyCoVarsOfTypesDSet :: [Type] -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesDSet"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypesDSet</span></a></span></span><span> </span><span id="local-6989586621682560764"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560764"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSet"><span class="hs-identifier hs-var">fvDVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; DCoVarSet) -&gt; FV -&gt; DCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560764"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-comment">-- | Returns free variables of types, including kind variables as</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- a deterministically ordered list. For type synonyms it does /not/ expand the</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- synonym.</span><span>
</span><span id="line-591"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesList"><span class="hs-identifier hs-type">tyCoVarsOfTypesList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-593"></span><span id="tyCoVarsOfTypesList"><span class="annot"><span class="annottext">tyCoVarsOfTypesList :: [Type] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesList"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypesList</span></a></span></span><span> </span><span id="local-6989586621682560765"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560765"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; [Var]
</span><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier hs-var">fvVarList</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; [Var]) -&gt; FV -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560765"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">-- | The worker for `tyCoFVsOfType` and `tyCoFVsOfTypeList`.</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- The previous implementation used `unionVarSet` which is O(n+m) and can</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- make the function quadratic.</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- It's exported, so that it can be composed with</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- other functions that compute free variables.</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- See Note [FV naming conventions] in &quot;GHC.Utils.FV&quot;.</span><span>
</span><span id="line-601"></span><span class="hs-comment">--</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- Eta-expanded because that makes it run faster (apparently)</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- See Note [FV eta expansion] in &quot;GHC.Utils.FV&quot; for explanation.</span><span>
</span><span id="line-604"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-type">tyCoFVsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-605"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-606"></span><span id="tyCoFVsOfType"><span class="annot"><span class="annottext">tyCoFVsOfType :: Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var hs-var">tyCoFVsOfType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682560768"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>        </span><span id="local-6989586621682560769"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560769"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560770"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560770"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682560771"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560771"><span class="hs-identifier hs-var">acc_list</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682560772"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560771"><span class="hs-identifier hs-var">acc_list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560770"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560771"><span class="hs-identifier hs-var">acc_list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560771"><span class="hs-identifier hs-var">acc_list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560769"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-611"></span><span>                               </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>   </span><span class="hs-comment">-- See Note [Closing over free variable kinds]</span><span>
</span><span id="line-612"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560771"><span class="hs-identifier hs-var">acc_list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560772"><span class="hs-identifier hs-var">acc_set</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560768"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560775"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560775"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621682560776"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560776"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560777"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560777"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560778"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560778"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560775"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560776"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560777"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560778"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-614"></span><span>                                                    </span><span class="hs-comment">-- See Note [Free vars and synonyms]</span><span>
</span><span id="line-615"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span id="local-6989586621682560780"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560780"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560781"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560781"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560782"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560782"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560780"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560781"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560782"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-616"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682560785"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560785"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682560786"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560786"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621682560787"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560788"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560788"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560789"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560789"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560785"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560786"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560788"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560789"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-617"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560791"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560791"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682560792"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560792"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682560793"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560793"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682560794"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560794"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560795"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560795"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560796"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560796"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560791"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560792"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560793"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560794"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560795"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560796"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-618"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682560798"><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621682560798"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682560799"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560799"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560800"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560800"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560801"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560801"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560802"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560802"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier hs-var">tyCoFVsBndr</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621682560798"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560799"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560800"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560801"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560802"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-619"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682560804"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560804"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682560805"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560805"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682560806"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560806"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560807"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560807"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560808"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560808"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560804"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560805"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560806"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560807"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560808"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-620"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682560810"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560810"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621682560811"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560811"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682560812"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560812"><span class="hs-identifier hs-var">bound_vars</span></a></span></span><span> </span><span id="local-6989586621682560813"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560813"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560810"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560811"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560812"><span class="hs-identifier hs-var">bound_vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560813"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier hs-type">tyCoFVsBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#ForAllTyBinder"><span class="hs-identifier hs-type">ForAllTyBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-623"></span><span class="hs-comment">-- Free vars of (forall b. &lt;thing with fvs&gt;)</span><span>
</span><span id="line-624"></span><span id="tyCoFVsBndr"><span class="annot"><span class="annottext">tyCoFVsBndr :: ForAllTyBinder -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier hs-var hs-var">tyCoFVsBndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682560815"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560815"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560816"><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560816"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier hs-var">tyCoFVsVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560815"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560816"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndrs"><span class="hs-identifier hs-type">tyCoFVsVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-627"></span><span id="tyCoFVsVarBndrs"><span class="annot"><span class="annottext">tyCoFVsVarBndrs :: [Var] -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndrs"><span class="hs-identifier hs-var hs-var">tyCoFVsVarBndrs</span></a></span></span><span> </span><span id="local-6989586621682560817"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560817"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621682560818"><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560818"><span class="hs-identifier hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; FV -&gt; FV) -&gt; FV -&gt; [Var] -&gt; FV
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier hs-var">tyCoFVsVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560818"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682560817"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier hs-type">tyCoFVsVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-630"></span><span id="tyCoFVsVarBndr"><span class="annot"><span class="annottext">tyCoFVsVarBndr :: Var -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier hs-var hs-var">tyCoFVsVarBndr</span></a></span></span><span> </span><span id="local-6989586621682560820"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560820"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682560821"><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560821"><span class="hs-identifier hs-var">fvs</span></a></span></span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560820"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Free vars of its type/kind</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#delFV"><span class="hs-identifier hs-var">delFV</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560820"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="#local-6989586621682560821"><span class="hs-identifier hs-var">fvs</span></a></span><span>       </span><span class="hs-comment">-- Delete it from the thing-inside</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-type">tyCoFVsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-636"></span><span id="tyCoFVsOfTypes"><span class="annot"><span class="annottext">tyCoFVsOfTypes :: [Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var hs-var">tyCoFVsOfTypes</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682560823"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560823"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682560824"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560824"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560825"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560825"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560826"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560826"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560827"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560827"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560823"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682560824"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560825"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560826"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560827"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-637"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621682560828"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560828"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560829"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560829"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560830"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560830"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560828"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560829"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560830"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="annot"><span class="hs-comment">-- | Get a deterministic set of the vars free in a coercion</span></span><span>
</span><span id="line-640"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoDSet"><span class="hs-identifier hs-type">tyCoVarsOfCoDSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#DTyCoVarSet"><span class="hs-identifier hs-type">DTyCoVarSet</span></a></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-642"></span><span id="tyCoVarsOfCoDSet"><span class="annot"><span class="annottext">tyCoVarsOfCoDSet :: Coercion -&gt; DCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoDSet"><span class="hs-identifier hs-var hs-var">tyCoVarsOfCoDSet</span></a></span></span><span> </span><span id="local-6989586621682560831"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560831"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; DCoVarSet
</span><a href="GHC.Utils.FV.html#fvDVarSet"><span class="hs-identifier hs-var">fvDVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; DCoVarSet) -&gt; FV -&gt; DCoVarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560831"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoList"><span class="hs-identifier hs-type">tyCoVarsOfCoList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-646"></span><span id="tyCoVarsOfCoList"><span class="annot"><span class="annottext">tyCoVarsOfCoList :: Coercion -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCoList"><span class="hs-identifier hs-var hs-var">tyCoVarsOfCoList</span></a></span></span><span> </span><span id="local-6989586621682560832"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560832"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; [Var]
</span><a href="GHC.Utils.FV.html#fvVarList"><span class="hs-identifier hs-var">fvVarList</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; [Var]) -&gt; FV -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560832"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfMCo"><span class="hs-identifier hs-type">tyCoFVsOfMCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCoercion"><span class="hs-identifier hs-type">MCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-649"></span><span id="tyCoFVsOfMCo"><span class="annot"><span class="annottext">tyCoFVsOfMCo :: MCoercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfMCo"><span class="hs-identifier hs-var hs-var">tyCoFVsOfMCo</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-650"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfMCo"><span class="hs-identifier hs-var">tyCoFVsOfMCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682560834"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560834"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560834"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-type">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-653"></span><span class="hs-comment">-- Extracts type and coercion variables from a coercion</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- See Note [Free variables of types]</span><span>
</span><span id="line-655"></span><span id="tyCoFVsOfCo"><span class="annot"><span class="annottext">tyCoFVsOfCo :: Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var hs-var">tyCoFVsOfCo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682560836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560836"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560837"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560837"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560838"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560838"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560839"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560839"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560836"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560837"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560838"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560839"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-657"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560841"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560841"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682560842"><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682560842"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560843"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560843"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560844"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560844"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560845"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560845"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560841"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfMCo"><span class="hs-identifier hs-var">tyCoFVsOfMCo</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682560842"><span class="hs-identifier hs-var">mco</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560843"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560844"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560845"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-659"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560847"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560847"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560848"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560848"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560849"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560849"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560850"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560850"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560847"><span class="hs-identifier hs-var">cos</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560848"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560849"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560850"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-660"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682560852"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560852"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682560853"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560853"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560854"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560854"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560855"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560855"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560856"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560856"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560852"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560853"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560854"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560855"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560856"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-662"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: Coercion -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560859"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560859"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560861"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560861"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560863"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560863"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560864"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560864"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560865"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560865"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560866"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560866"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsVarBndr"><span class="hs-identifier hs-var">tyCoFVsVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560859"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560863"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560861"><span class="hs-identifier hs-var">kind_co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560864"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560865"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560866"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-664"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_mult :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560869"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560869"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_arg :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560871"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560871"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_res :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560873"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560873"><span class="hs-identifier hs-var">co2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560874"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560874"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560875"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560875"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560876"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560876"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560871"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560873"><span class="hs-identifier hs-var">co2</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560869"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560874"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560875"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560876"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-666"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682560878"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560878"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560879"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560879"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560880"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560880"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560881"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560881"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCoVar"><span class="hs-identifier hs-var">tyCoFVsOfCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560878"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560879"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560880"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560881"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-668"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682560884"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560884"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560885"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560885"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560886"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560886"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560887"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560887"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCoVar"><span class="hs-identifier hs-var">tyCoFVsOfCoVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560884"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560885"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560886"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560887"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-comment">-- See Note [CoercionHoles and coercion free variables]</span><span>
</span><span id="line-671"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560889"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560889"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621682560890"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560890"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560891"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560891"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560892"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560892"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560889"><span class="hs-identifier hs-var">cs</span></a></span><span>  </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560890"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560891"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560892"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_lty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560895"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560895"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560897"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560897"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: Coercion -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560899"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560899"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560900"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560900"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560901"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560901"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560902"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560902"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560899"><span class="hs-identifier hs-var">deps</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560895"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-674"></span><span>                      </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560897"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560900"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560901"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560902"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-675"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682560904"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560904"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span id="local-6989586621682560905"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560905"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560906"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560906"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560907"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560907"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560904"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560905"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560906"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560907"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-676"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682560909"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560909"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682560910"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560910"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621682560911"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560911"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560912"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560912"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560913"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560913"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560909"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560910"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560911"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560912"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560913"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-677"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560915"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560915"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>        </span><span id="local-6989586621682560916"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560916"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560917"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560917"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560918"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560918"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560915"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560916"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560917"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560918"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-678"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560920"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560920"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>         </span><span id="local-6989586621682560921"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560921"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560922"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560922"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560923"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560923"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560920"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560921"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560922"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560923"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-679"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682560925"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560925"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682560926"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560926"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621682560927"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560927"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560928"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560928"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560929"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560929"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560925"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560926"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560927"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560928"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560929"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-680"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682560931"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560931"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>         </span><span id="local-6989586621682560932"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560932"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560933"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560933"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560934"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560934"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560931"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560932"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560933"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560934"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-681"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682560936"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560936"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span id="local-6989586621682560937"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560937"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560938"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560938"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560939"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560939"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560936"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560937"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560938"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560939"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCoVar"><span class="hs-identifier hs-type">tyCoFVsOfCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-684"></span><span id="tyCoFVsOfCoVar"><span class="annot"><span class="annottext">tyCoFVsOfCoVar :: Var -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCoVar"><span class="hs-identifier hs-var hs-var">tyCoFVsOfCoVar</span></a></span></span><span> </span><span id="local-6989586621682560941"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560941"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621682560942"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560942"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560943"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560943"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560944"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560944"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FV
</span><a href="GHC.Utils.FV.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560941"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560941"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560942"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560943"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560944"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-type">tyCoFVsOfCos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-688"></span><span id="tyCoFVsOfCos"><span class="annot"><span class="annottext">tyCoFVsOfCos :: [Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var hs-var">tyCoFVsOfCos</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621682560946"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560946"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560947"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560947"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560948"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560948"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560946"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560947"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560948"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-689"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682560949"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560949"><span class="hs-identifier hs-var">co</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682560950"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560950"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560951"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560951"><span class="hs-identifier hs-var">fv_cand</span></a></span></span><span> </span><span id="local-6989586621682560952"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560952"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682560953"><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560953"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560949"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCos"><span class="hs-identifier hs-var">tyCoFVsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560950"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682560951"><span class="hs-identifier hs-var">fv_cand</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682560952"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">([Var], VarSet)
</span><a href="#local-6989586621682560953"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-comment">----- Whether a covar is /Almost Devoid/ in a type or coercion ----</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">-- | Given a covar and a coercion, returns True if covar is almost devoid in</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- the coercion. That is, covar can only appear in Refl and GRefl.</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- See (FC6) in Note [ForAllCo] in &quot;GHC.Core.TyCo.Rep&quot;</span><span>
</span><span id="line-697"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almostDevoidCoVarOfCo"><span class="hs-identifier hs-type">almostDevoidCoVarOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-698"></span><span id="almostDevoidCoVarOfCo"><span class="annot"><span class="annottext">almostDevoidCoVarOfCo :: Var -&gt; Coercion -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#almostDevoidCoVarOfCo"><span class="hs-identifier hs-var hs-var">almostDevoidCoVarOfCo</span></a></span></span><span> </span><span id="local-6989586621682560954"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560954"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span id="local-6989586621682560955"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560955"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560955"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560954"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-type">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-702"></span><span id="almost_devoid_co_var_of_co"><span class="annot"><span class="annottext">almost_devoid_co_var_of_co :: Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var hs-var">almost_devoid_co_var_of_co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="hs-comment">-- covar is allowed in Refl and</span><span>
</span><span id="line-703"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-comment">-- GRefl, so we don't look into</span><span>
</span><span id="line-704"></span><span>                                                </span><span class="hs-comment">-- the coercions</span><span>
</span><span id="line-705"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560957"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560957"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560958"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560958"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560957"><span class="hs-identifier hs-var">cos</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560958"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-707"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682560960"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560960"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682560961"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560961"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560962"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560962"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560960"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560962"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-709"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560961"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560962"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-710"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: Coercion -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560964"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560964"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560965"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560965"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560966"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560966"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560967"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560967"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560965"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560967"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-712"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560964"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560967"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560966"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560967"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_mult :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560969"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560969"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_arg :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560970"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560970"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_res :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560971"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560971"><span class="hs-identifier hs-var">co2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560972"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560972"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560969"><span class="hs-identifier hs-var">w</span></a></span><span>   </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560972"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560970"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560972"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-716"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560971"><span class="hs-identifier hs-var">co2</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560972"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-717"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682560973"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560973"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560974"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560974"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560973"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560974"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-718"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682560976"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560976"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682560977"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560977"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682560976"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560977"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-719"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560978"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560978"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560979"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560979"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560978"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560979"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-721"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_lty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560980"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560980"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560981"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560981"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: Coercion -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682560982"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560982"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560983"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560983"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Coercion] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682560982"><span class="hs-identifier hs-var">deps</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560983"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-723"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560980"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560983"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-724"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682560981"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560983"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-725"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682560985"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560985"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560986"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560986"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560985"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560986"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-727"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682560987"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560987"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682560988"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560988"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560989"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560989"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560987"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560989"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560988"><span class="hs-identifier hs-var">co2</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560989"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-730"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560990"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560990"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560991"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560991"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560990"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560991"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-732"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682560992"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560992"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560993"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560993"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560992"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560993"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-734"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682560994"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560994"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682560995"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560995"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560996"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560996"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560994"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560996"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-736"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560995"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560996"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-737"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682560997"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560997"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682560998"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560998"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560997"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682560998"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-739"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682560999"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560999"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561000"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561000"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682560999"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561000"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-type">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-743"></span><span id="almost_devoid_co_var_of_cos"><span class="annot"><span class="annottext">almost_devoid_co_var_of_cos :: [Coercion] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var hs-var">almost_devoid_co_var_of_cos</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-744"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561001"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561001"><span class="hs-identifier hs-var">co</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682561002"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561002"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561003"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561003"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-745"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561001"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561003"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-746"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_cos"><span class="hs-identifier hs-var">almost_devoid_co_var_of_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561002"><span class="hs-identifier hs-var">cos</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561003"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-type">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-749"></span><span id="almost_devoid_co_var_of_type"><span class="annot"><span class="annottext">almost_devoid_co_var_of_type :: Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var hs-var">almost_devoid_co_var_of_type</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-750"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561004"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561004"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561005"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561005"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_types"><span class="hs-identifier hs-var">almost_devoid_co_var_of_types</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561004"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561005"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-752"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-753"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561007"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561007"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682561008"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561008"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561009"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561009"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561007"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561009"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-755"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561008"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561009"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-756"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561010"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561010"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561011"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561011"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682561012"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561012"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561013"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561013"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561010"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561013"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561011"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561013"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-759"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561012"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561013"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-760"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561014"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561014"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561015"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561015"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561016"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561016"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561014"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561016"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-762"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561014"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561016"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561015"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561016"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561017"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561017"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561018"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561018"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561019"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561019"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-764"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561017"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561019"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-765"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561018"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561019"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-766"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682561020"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561020"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561021"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561021"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_co"><span class="hs-identifier hs-var">almost_devoid_co_var_of_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561020"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561021"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_types"><span class="hs-identifier hs-type">almost_devoid_co_var_of_types</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-770"></span><span id="almost_devoid_co_var_of_types"><span class="annot"><span class="annottext">almost_devoid_co_var_of_types :: [Type] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_types"><span class="hs-identifier hs-var hs-var">almost_devoid_co_var_of_types</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-771"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_types"><span class="hs-identifier hs-var">almost_devoid_co_var_of_types</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561022"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561022"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682561023"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561023"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561024"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561024"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-772"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_type"><span class="hs-identifier hs-var">almost_devoid_co_var_of_type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561022"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561024"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; InterestingVarFun
</span><a href="GHC.Core.TyCo.FVs.html#almost_devoid_co_var_of_types"><span class="hs-identifier hs-var">almost_devoid_co_var_of_types</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561023"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561024"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Free tyvars, but with visible/invisible info
%*                                                                      *
%************************************************************************

-}</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- | Retrieve the free variables in this type, splitting them based</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- on whether they are used visibly or invisibly. Invisible ones come</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- first.</span><span>
</span><span id="line-788"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#visVarsOfType"><span class="hs-identifier hs-type">visVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-789"></span><span id="visVarsOfType"><span class="annot"><span class="annottext">visVarsOfType :: Type -&gt; Pair VarSet
</span><a href="GHC.Core.TyCo.FVs.html#visVarsOfType"><span class="hs-identifier hs-var hs-var">visVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682561025"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561025"><span class="hs-identifier hs-var">orig_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Pair VarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561027"><span class="hs-identifier hs-var">invis_vars</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561028"><span class="hs-identifier hs-var">vis_vars</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682561029"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561029"><span class="hs-identifier hs-var">invis_vars1</span></a></span></span><span> </span><span id="local-6989586621682561028"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561028"><span class="hs-identifier hs-var">vis_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561025"><span class="hs-identifier hs-var">orig_ty</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span id="local-6989586621682561027"><span class="annot"><span class="annottext">invis_vars :: VarSet
</span><a href="#local-6989586621682561027"><span class="hs-identifier hs-var hs-var">invis_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561029"><span class="hs-identifier hs-var">invis_vars1</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#minusVarSet"><span class="hs-operator hs-var">`minusVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561028"><span class="hs-identifier hs-var">vis_vars</span></a></span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>    </span><span id="local-6989586621682561030"><span class="annot"><span class="annottext">go :: Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682561045"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561045"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Pair VarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; VarSet) -&gt; Type -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561045"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unitVarSet"><span class="hs-identifier hs-var">unitVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561045"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561047"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561047"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682561048"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561048"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561047"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561048"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561049"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561049"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561050"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561050"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Pair VarSet
</span><a href="#local-6989586621682561051"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561049"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561050"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-797"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561052"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561052"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561053"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561053"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682561054"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561054"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561052"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561053"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561054"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-798"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561055"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561055"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561056"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561056"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561055"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; Pair VarSet -&gt; Pair VarSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561056"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span>
</span><span id="line-800"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; Pair VarSet
</span><a href="#local-6989586621682561059"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; VarSet) -&gt; Type -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561055"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pair VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-802"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561060"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561060"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561061"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561061"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561060"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Pair VarSet
</span><a href="#local-6989586621682561059"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561061"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>    </span><span class="annot"><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682561062"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561062"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Pair VarSet
</span><a href="#local-6989586621682561059"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; Pair VarSet) -&gt; VarSet -&gt; Pair VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561062"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span>    </span><span id="local-6989586621682561059"><span class="annot"><span class="annottext">invisible :: VarSet -&gt; Pair VarSet
</span><a href="#local-6989586621682561059"><span class="hs-identifier hs-var hs-var">invisible</span></a></span></span><span> </span><span id="local-6989586621682561063"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561063"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Pair VarSet
forall a. a -&gt; a -&gt; Pair a
</span><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561063"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span>    </span><span id="local-6989586621682561051"><span class="annot"><span class="annottext">go_tc :: TyCon -&gt; [Type] -&gt; Pair VarSet
</span><a href="#local-6989586621682561051"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621682561064"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561064"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561065"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561065"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561066"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561066"><span class="hs-identifier hs-var">invis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561067"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561067"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561064"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561065"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-808"></span><span>                   </span><span class="annot"><span class="annottext">VarSet -&gt; Pair VarSet
</span><a href="#local-6989586621682561059"><span class="hs-identifier hs-var">invisible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561066"><span class="hs-identifier hs-var">invis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pair VarSet -&gt; Pair VarSet -&gt; Pair VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Pair VarSet) -&gt; [Type] -&gt; Pair VarSet
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="#local-6989586621682561030"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561067"><span class="hs-identifier hs-var">vis</span></a></span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#visVarsOfTypes"><span class="hs-identifier hs-type">visVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span>
</span><span id="line-811"></span><span id="visVarsOfTypes"><span class="annot"><span class="annottext">visVarsOfTypes :: [Type] -&gt; Pair VarSet
</span><a href="GHC.Core.TyCo.FVs.html#visVarsOfTypes"><span class="hs-identifier hs-var hs-var">visVarsOfTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Pair VarSet) -&gt; [Type] -&gt; Pair VarSet
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pair VarSet
</span><a href="GHC.Core.TyCo.FVs.html#visVarsOfType"><span class="hs-identifier hs-var">visVarsOfType</span></a></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Injective free vars
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#isInjectiveInType"><span class="hs-identifier hs-type">isInjectiveInType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-821"></span><span class="hs-comment">-- True &lt;=&gt; tv /definitely/ appears injectively in ty</span><span>
</span><span id="line-822"></span><span class="hs-comment">-- A bit more efficient that (tv `elemVarSet` injectiveTyVarsOfType ty)</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- Ignore occurrence in coercions, and even in injective positions of</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- type families.</span><span>
</span><span id="line-825"></span><span id="isInjectiveInType"><span class="annot"><span class="annottext">isInjectiveInType :: Var -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#isInjectiveInType"><span class="hs-identifier hs-var hs-var">isInjectiveInType</span></a></span></span><span> </span><span id="local-6989586621682561069"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561069"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682561070"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561070"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561070"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-828"></span><span>    </span><span id="local-6989586621682561071"><span class="annot"><span class="annottext">go :: Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682561072"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561072"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561073"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561073"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier hs-var">rewriterView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561072"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561073"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682561074"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561074"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561074"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561069"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-830"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561075"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561075"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682561076"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561076"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561075"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561076"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561077"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561077"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561078"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561078"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682561079"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561079"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561077"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561078"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561079"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561080"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561080"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561081"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561081"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621682561082"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561080"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561081"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561083"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561083"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561084"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561084"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561083"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>                                          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561069"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InterestingVarFun
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561083"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561084"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561085"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561085"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561085"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span class="annot"><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>    </span><span id="local-6989586621682561082"><span class="annot"><span class="annottext">go_tc :: TyCon -&gt; [Type] -&gt; Bool
</span><a href="#local-6989586621682561082"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621682561086"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561086"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561087"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561087"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561086"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-840"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="#local-6989586621682561071"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561087"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- | Returns the free variables of a 'Type' that are in injective positions.</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- Specifically, it finds the free variables while:</span><span>
</span><span id="line-844"></span><span class="hs-comment">--</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- * Expanding type synonyms</span><span>
</span><span id="line-846"></span><span class="hs-comment">--</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- * Ignoring the coercion in @(ty |&gt; co)@</span><span>
</span><span id="line-848"></span><span class="hs-comment">--</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- * Ignoring the non-injective fields of a 'TyConApp'</span><span>
</span><span id="line-850"></span><span class="hs-comment">--</span><span>
</span><span id="line-851"></span><span class="hs-comment">--</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- For example, if @F@ is a non-injective type family, then:</span><span>
</span><span id="line-853"></span><span class="hs-comment">--</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- injectiveTyVarsOf( Either c (Maybe (a, F b c)) ) = {a,c}</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-857"></span><span class="hs-comment">--</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- If @'injectiveVarsOfType' ty = itvs@, then knowing @ty@ fixes @itvs@.</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- More formally, if</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- @a@ is in @'injectiveVarsOfType' ty@</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- and  @S1(ty) ~ S2(ty)@,</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- then @S1(a)  ~ S2(a)@,</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- where @S1@ and @S2@ are arbitrary substitutions.</span><span>
</span><span id="line-864"></span><span class="hs-comment">--</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- See @Note [When does a tycon application need an explicit kind signature?]@.</span><span>
</span><span id="line-866"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-type">injectiveVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>   </span><span class="hs-comment">-- ^ Should we look under injective type families?</span><span>
</span><span id="line-867"></span><span>                              </span><span class="hs-comment">-- See Note [Coverage condition for injective type families]</span><span>
</span><span id="line-868"></span><span>                              </span><span class="hs-comment">-- in &quot;GHC.Tc.Instance.Family&quot;.</span><span>
</span><span id="line-869"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-870"></span><span id="injectiveVarsOfType"><span class="annot"><span class="annottext">injectiveVarsOfType :: Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var hs-var">injectiveVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682561090"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682561090"><span class="hs-identifier hs-var">look_under_tfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-872"></span><span>    </span><span id="local-6989586621682561091"><span class="annot"><span class="annottext">go :: Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682561092"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561092"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561093"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561093"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#rewriterView"><span class="hs-identifier hs-var">rewriterView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561092"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561093"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-873"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682561094"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561094"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV
</span><a href="GHC.Utils.FV.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561094"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561095"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561095"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682561096"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561096"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561095"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561096"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561097"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561097"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561098"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561098"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682561099"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561099"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561097"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561098"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561099"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561100"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561100"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561101"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561101"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; FV
</span><a href="#local-6989586621682561102"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561100"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561101"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561103"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561103"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561104"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561104"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561103"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#delFV"><span class="hs-identifier hs-var">delFV</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561103"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561104"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561105"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561105"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561105"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-880"></span><span>    </span><span class="annot"><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span>    </span><span id="local-6989586621682561102"><span class="annot"><span class="annottext">go_tc :: TyCon -&gt; [Type] -&gt; FV
</span><a href="#local-6989586621682561102"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621682561106"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561106"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561107"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561107"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-883"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561106"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-884"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682561090"><span class="hs-identifier hs-var">look_under_tfs</span></a></span><span>
</span><span id="line-885"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#Injective"><span class="hs-identifier hs-type">Injective</span></a></span><span> </span><span id="local-6989586621682561109"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621682561109"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Injectivity
</span><a href="GHC.Core.TyCon.html#tyConInjectivityInfo"><span class="hs-identifier hs-var">tyConInjectivityInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561106"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-886"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FV) -&gt; [Type] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; FV) -&gt; [Type] -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-887"></span><span>              </span><span class="annot"><span class="annottext">[Bool] -&gt; [Type] -&gt; [Type]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621682561109"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561107"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-888"></span><span>                         </span><span class="hs-comment">-- Oversaturated arguments to a tycon are</span><span>
</span><span id="line-889"></span><span>                         </span><span class="hs-comment">-- always injective, hence the repeat True</span><span>
</span><span id="line-890"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-comment">-- No injectivity info for this type family</span><span>
</span><span id="line-891"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-comment">-- Data type, injective in all positions</span><span>
</span><span id="line-894"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FV) -&gt; [Type] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561091"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561107"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="hs-comment">-- | Returns the free variables of a 'Type' that are in injective positions.</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- Specifically, it finds the free variables while:</span><span>
</span><span id="line-898"></span><span class="hs-comment">--</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- * Expanding type synonyms</span><span>
</span><span id="line-900"></span><span class="hs-comment">--</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- * Ignoring the coercion in @(ty |&gt; co)@</span><span>
</span><span id="line-902"></span><span class="hs-comment">--</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- * Ignoring the non-injective fields of a 'TyConApp'</span><span>
</span><span id="line-904"></span><span class="hs-comment">--</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- See @Note [When does a tycon application need an explicit kind signature?]@.</span><span>
</span><span id="line-906"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfTypes"><span class="hs-identifier hs-type">injectiveVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ look under injective type families?</span><span>
</span><span id="line-907"></span><span>                             </span><span class="hs-comment">-- See Note [Coverage condition for injective type families]</span><span>
</span><span id="line-908"></span><span>                             </span><span class="hs-comment">-- in &quot;GHC.Tc.Instance.Family&quot;.</span><span>
</span><span id="line-909"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-910"></span><span id="injectiveVarsOfTypes"><span class="annot"><span class="annottext">injectiveVarsOfTypes :: Bool -&gt; [Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfTypes"><span class="hs-identifier hs-var hs-var">injectiveVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682561113"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682561113"><span class="hs-identifier hs-var">look_under_tfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FV) -&gt; [Type] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#injectiveVarsOfType"><span class="hs-identifier hs-var">injectiveVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682561113"><span class="hs-identifier hs-var">look_under_tfs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Invisible vars
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- | Returns the set of variables that are used invisibly anywhere within</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- the given type. A variable will be included even if it is used both visibly</span><span>
</span><span id="line-922"></span><span class="hs-comment">-- and invisibly. An invisible use site includes:</span><span>
</span><span id="line-923"></span><span class="hs-comment">--   * In the kind of a variable</span><span>
</span><span id="line-924"></span><span class="hs-comment">--   * In the kind of a bound variable in a forall</span><span>
</span><span id="line-925"></span><span class="hs-comment">--   * In a coercion</span><span>
</span><span id="line-926"></span><span class="hs-comment">--   * In a Specified or Inferred argument to a function</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- See Note [VarBndrs, ForAllTyBinders, TyConBinders, and visibility] in &quot;GHC.Core.TyCo.Rep&quot;</span><span>
</span><span id="line-928"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfType"><span class="hs-identifier hs-type">invisibleVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-929"></span><span id="invisibleVarsOfType"><span class="annot"><span class="annottext">invisibleVarsOfType :: Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfType"><span class="hs-identifier hs-var hs-var">invisibleVarsOfType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-930"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-931"></span><span>    </span><span id="local-6989586621682561114"><span class="annot"><span class="annottext">go :: Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682561115"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561115"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561116"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561116"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561115"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-932"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561116"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-933"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682561117"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561117"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561117"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561118"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561118"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682561119"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561119"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561118"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561119"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-935"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561120"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561120"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561121"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561121"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682561122"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561122"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561120"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561121"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561122"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-936"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561123"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561123"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561124"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561124"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfTypes"><span class="hs-identifier hs-var">tyCoFVsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561125"><span class="hs-identifier hs-var">invisibles</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span>
</span><span id="line-937"></span><span>                            </span><span class="annot"><span class="annottext">[Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfTypes"><span class="hs-identifier hs-var">invisibleVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561126"><span class="hs-identifier hs-var">visibles</span></a></span><span>
</span><span id="line-938"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561125"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561125"><span class="hs-identifier hs-var">invisibles</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561126"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561126"><span class="hs-identifier hs-var">visibles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; ([Type], [Type])
</span><a href="GHC.Core.Type.html#partitionInvisibleTypes"><span class="hs-identifier hs-var">partitionInvisibleTypes</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561123"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561124"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-939"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span id="local-6989586621682561127"><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621682561127"><span class="hs-identifier hs-var">tvb</span></a></span></span><span> </span><span id="local-6989586621682561128"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561128"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder -&gt; FV -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsBndr"><span class="hs-identifier hs-var">tyCoFVsBndr</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><a href="#local-6989586621682561127"><span class="hs-identifier hs-var">tvb</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; FV) -&gt; FV -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561128"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-940"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
</span><a href="GHC.Utils.FV.html#emptyFV"><span class="hs-identifier hs-var">emptyFV</span></a></span><span>
</span><span id="line-941"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561129"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561129"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561130"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561130"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561130"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
</span><a href="GHC.Utils.FV.html#unionFV"><span class="hs-operator hs-var">`unionFV`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561129"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-942"></span><span>    </span><span class="annot"><a href="#local-6989586621682561114"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682561131"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561131"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#tyCoFVsOfCo"><span class="hs-identifier hs-var">tyCoFVsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561131"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="annot"><span class="hs-comment">-- | Like 'invisibleVarsOfType', but for many types.</span></span><span>
</span><span id="line-945"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfTypes"><span class="hs-identifier hs-type">invisibleVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.FV.html#FV"><span class="hs-identifier hs-type">FV</span></a></span><span>
</span><span id="line-946"></span><span id="invisibleVarsOfTypes"><span class="annot"><span class="annottext">invisibleVarsOfTypes :: [Type] -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfTypes"><span class="hs-identifier hs-var hs-var">invisibleVarsOfTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FV) -&gt; [Type] -&gt; FV
forall a. (a -&gt; FV) -&gt; [a] -&gt; FV
</span><a href="GHC.Utils.FV.html#mapUnionFV"><span class="hs-identifier hs-var">mapUnionFV</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FV
</span><a href="GHC.Core.TyCo.FVs.html#invisibleVarsOfType"><span class="hs-identifier hs-var">invisibleVarsOfType</span></a></span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Any free vars
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-pragma hs-type">afvFolder</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>   </span><span class="hs-comment">-- so that specialization to (const True) works</span><span>
</span><span id="line-956"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-type">afvFolder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DM.Any</span></span><span>
</span><span id="line-957"></span><span class="hs-comment">-- 'afvFolder' is short for &quot;any-free-var folder&quot;, good for checking</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- if any free var of a type satisfies a predicate `check_fv`</span><span>
</span><span id="line-959"></span><span id="afvFolder"><span class="annot"><span class="annottext">afvFolder :: InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var hs-var">afvFolder</span></a></span></span><span> </span><span id="local-6989586621682561133"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561133"><span class="hs-identifier hs-var">check_fv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoFolder"><span class="hs-identifier hs-type">TyCoFolder</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcf_view :: Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#tcf_view"><span class="hs-identifier hs-var">tcf_view</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Rep.html#noView"><span class="hs-identifier hs-var">noView</span></a></span><span>  </span><span class="hs-comment">-- See Note [Free vars and synonyms]</span><span>
</span><span id="line-960"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tyvar :: VarSet -&gt; Var -&gt; Any
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tyvar"><span class="hs-identifier hs-var">tcf_tyvar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Any
</span><a href="#local-6989586621682561134"><span class="hs-identifier hs-var">do_tcv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_covar :: VarSet -&gt; Var -&gt; Any
</span><a href="GHC.Core.TyCo.Rep.html#tcf_covar"><span class="hs-identifier hs-var">tcf_covar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; Any
</span><a href="#local-6989586621682561134"><span class="hs-identifier hs-var">do_tcv</span></a></span><span>
</span><span id="line-961"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_hole :: VarSet -&gt; CoercionHole -&gt; Any
</span><a href="GHC.Core.TyCo.Rep.html#tcf_hole"><span class="hs-identifier hs-var">tcf_hole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; CoercionHole -&gt; Any
forall {p} {p}. p -&gt; p -&gt; Any
</span><a href="#local-6989586621682561135"><span class="hs-identifier hs-var">do_hole</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcf_tycobinder :: VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
</span><a href="GHC.Core.TyCo.Rep.html#tcf_tycobinder"><span class="hs-identifier hs-var">tcf_tycobinder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; ForAllTyFlag -&gt; VarSet
forall {p}. VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682561136"><span class="hs-identifier hs-var">do_bndr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-963"></span><span>    </span><span id="local-6989586621682561134"><span class="annot"><span class="annottext">do_tcv :: VarSet -&gt; Var -&gt; Any
</span><a href="#local-6989586621682561134"><span class="hs-identifier hs-var hs-var">do_tcv</span></a></span></span><span> </span><span id="local-6989586621682561137"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561137"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682561138"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561138"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561138"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561137"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561133"><span class="hs-identifier hs-var">check_fv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561138"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>    </span><span id="local-6989586621682561135"><span class="annot"><span class="annottext">do_hole :: p -&gt; p -&gt; Any
</span><a href="#local-6989586621682561135"><span class="hs-identifier hs-var hs-var">do_hole</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>    </span><span class="hs-comment">-- I'm unsure; probably never happens</span><span>
</span><span id="line-965"></span><span>    </span><span id="local-6989586621682561136"><span class="annot"><span class="annottext">do_bndr :: VarSet -&gt; Var -&gt; p -&gt; VarSet
</span><a href="#local-6989586621682561136"><span class="hs-identifier hs-var hs-var">do_bndr</span></a></span></span><span> </span><span id="local-6989586621682561140"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561140"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621682561141"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561141"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561140"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561141"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfType"><span class="hs-identifier hs-type">anyFreeVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-968"></span><span id="anyFreeVarsOfType"><span class="annot"><span class="annottext">anyFreeVarsOfType :: InterestingVarFun -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfType"><span class="hs-identifier hs-var hs-var">anyFreeVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682561142"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561142"><span class="hs-identifier hs-var">check_fv</span></a></span></span><span> </span><span id="local-6989586621682561143"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561143"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><a href="#local-6989586621682561145"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561143"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561145"><span class="annot"><span class="annottext">Type -&gt; Any
</span><a href="#local-6989586621682561145"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561142"><span class="hs-identifier hs-var">check_fv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-970"></span><span>
</span><span id="line-971"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfTypes"><span class="hs-identifier hs-type">anyFreeVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-972"></span><span id="anyFreeVarsOfTypes"><span class="annot"><span class="annottext">anyFreeVarsOfTypes :: InterestingVarFun -&gt; [Type] -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfTypes"><span class="hs-identifier hs-var hs-var">anyFreeVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682561146"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561146"><span class="hs-identifier hs-var">check_fv</span></a></span></span><span> </span><span id="local-6989586621682561147"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561147"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><a href="#local-6989586621682561148"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561147"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561148"><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><a href="#local-6989586621682561148"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561146"><span class="hs-identifier hs-var">check_fv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-974"></span><span>
</span><span id="line-975"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfCo"><span class="hs-identifier hs-type">anyFreeVarsOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-976"></span><span id="anyFreeVarsOfCo"><span class="annot"><span class="annottext">anyFreeVarsOfCo :: InterestingVarFun -&gt; Coercion -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#anyFreeVarsOfCo"><span class="hs-identifier hs-var hs-var">anyFreeVarsOfCo</span></a></span></span><span> </span><span id="local-6989586621682561149"><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561149"><span class="hs-identifier hs-var">check_fv</span></a></span></span><span> </span><span id="local-6989586621682561150"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561150"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><a href="#local-6989586621682561151"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561150"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561151"><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><a href="#local-6989586621682561151"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="annot"><span class="annottext">InterestingVarFun
</span><a href="#local-6989586621682561149"><span class="hs-identifier hs-var">check_fv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-type">noFreeVarsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-980"></span><span id="noFreeVarsOfType"><span class="annot"><span class="annottext">noFreeVarsOfType :: Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var hs-var">noFreeVarsOfType</span></a></span></span><span> </span><span id="local-6989586621682561152"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561152"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><a href="#local-6989586621682561153"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561152"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561153"><span class="annot"><span class="annottext">Type -&gt; Any
</span><a href="#local-6989586621682561153"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; InterestingVarFun
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfTypes"><span class="hs-identifier hs-type">noFreeVarsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-984"></span><span id="noFreeVarsOfTypes"><span class="annot"><span class="annottext">noFreeVarsOfTypes :: [Type] -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfTypes"><span class="hs-identifier hs-var hs-var">noFreeVarsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682561156"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561156"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><a href="#local-6989586621682561157"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561156"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561157"><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><a href="#local-6989586621682561157"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; InterestingVarFun
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfCo"><span class="hs-identifier hs-type">noFreeVarsOfCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-988"></span><span id="noFreeVarsOfCo"><span class="annot"><span class="annottext">noFreeVarsOfCo :: Coercion -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfCo"><span class="hs-identifier hs-var hs-var">noFreeVarsOfCo</span></a></span></span><span> </span><span id="local-6989586621682561159"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561159"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Any -&gt; Bool
</span><span class="hs-identifier hs-var">DM.getAny</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><a href="#local-6989586621682561160"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561159"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561160"><span class="annot"><span class="annottext">Coercion -&gt; Any
</span><a href="#local-6989586621682561160"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCoFolder VarSet Any
-&gt; VarSet
-&gt; (Type -&gt; Any, [Type] -&gt; Any, Coercion -&gt; Any, [Coercion] -&gt; Any)
forall a env.
Monoid a =&gt;
TyCoFolder env a
-&gt; env -&gt; (Type -&gt; a, [Type] -&gt; a, Coercion -&gt; a, [Coercion] -&gt; a)
</span><a href="GHC.Core.TyCo.Rep.html#foldTyCo"><span class="hs-identifier hs-var">foldTyCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterestingVarFun -&gt; TyCoFolder VarSet Any
</span><a href="GHC.Core.TyCo.FVs.html#afvFolder"><span class="hs-identifier hs-var">afvFolder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; InterestingVarFun
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-990"></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 scopedSort
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="hs-comment">{- Note [ScopedSort]
~~~~~~~~~~~~~~~~~~~~
Consider

  foo :: Proxy a -&gt; Proxy (b :: k) -&gt; Proxy (a :: k2) -&gt; ()

This function type is implicitly generalised over [a, b, k, k2]. These
variables will be Specified; that is, they will be available for visible
type application. This is because they are written in the type signature
by the user.

However, we must ask: what order will they appear in? In cases without
dependency, this is easy: we just use the lexical left-to-right ordering
of first occurrence. With dependency, we cannot get off the hook so
easily.

We thus state:

 * These variables appear in the order as given by ScopedSort, where
   the input to ScopedSort is the left-to-right order of first occurrence.

Note that this applies only to *implicit* quantification, without a
`forall`. If the user writes a `forall`, then we just use the order given.

ScopedSort is defined thusly (as proposed in #15743):
  * Work left-to-right through the input list, with a cursor.
  * If variable v at the cursor is depended on by any earlier variable w,
    move v immediately before the leftmost such w.

INVARIANT: The prefix of variables before the cursor form a valid telescope.

Note that ScopedSort makes sense only after type inference is done and all
types/kinds are fully settled and zonked.

-}</span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- | Do a topological sort on a list of tyvars,</span><span>
</span><span id="line-1035"></span><span class="hs-comment">--   so that binders occur before occurrences</span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- E.g. given  [ a::k, k::*, b::k ]</span><span>
</span><span id="line-1037"></span><span class="hs-comment">-- it'll return a well-scoped list [ k::*, a::k, b::k ]</span><span>
</span><span id="line-1038"></span><span class="hs-comment">--</span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- This is a deterministic sorting operation</span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- (that is, doesn't depend on Uniques).</span><span>
</span><span id="line-1041"></span><span class="hs-comment">--</span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- It is also meant to be stable: that is, variables should not</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- be reordered unnecessarily. This is specified in Note [ScopedSort]</span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- See also Note [Ordering of implicit variables] in &quot;GHC.Rename.HsType&quot;</span><span>
</span><span id="line-1045"></span><span>
</span><span id="line-1046"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-type">scopedSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1047"></span><span id="scopedSort"><span class="annot"><span class="annottext">scopedSort :: [Var] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var hs-var">scopedSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [VarSet] -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621682561162"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1048"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1049"></span><span>    </span><span class="annot"><a href="#local-6989586621682561162"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- already sorted, in reverse order</span><span>
</span><span id="line-1050"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- each set contains all the variables which must be placed</span><span>
</span><span id="line-1051"></span><span>                       </span><span class="hs-comment">-- before the tv corresponding to the set; they are accumulations</span><span>
</span><span id="line-1052"></span><span>                       </span><span class="hs-comment">-- of the fvs in the sorted tvs' kinds</span><span>
</span><span id="line-1053"></span><span>
</span><span id="line-1054"></span><span>                       </span><span class="hs-comment">-- This list is in 1-to-1 correspondence with the sorted tyvars</span><span>
</span><span id="line-1055"></span><span>                       </span><span class="hs-comment">-- INVARIANT:</span><span>
</span><span id="line-1056"></span><span>                       </span><span class="hs-comment">--   all (\tl -&gt; all (`subVarSet` head tl) (tail tl)) (tails fv_list)</span><span>
</span><span id="line-1057"></span><span>                       </span><span class="hs-comment">-- That is, each set in the list is a superset of all later sets.</span><span>
</span><span id="line-1058"></span><span>
</span><span id="line-1059"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- yet to be sorted</span><span>
</span><span id="line-1060"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1061"></span><span>    </span><span id="local-6989586621682561162"><span class="annot"><span class="annottext">go :: [Var] -&gt; [VarSet] -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621682561162"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682561163"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561163"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621682561164"><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561164"><span class="hs-identifier hs-var">_fv_list</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561163"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1062"></span><span>    </span><span class="annot"><a href="#local-6989586621682561162"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561166"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561166"><span class="hs-identifier hs-var">acc</span></a></span></span><span>  </span><span id="local-6989586621682561167"><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561167"><span class="hs-identifier hs-var">fv_list</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561168"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561168"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682561169"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561169"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [VarSet] -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621682561162"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561170"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561171"><span class="hs-identifier hs-var">fv_list'</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561169"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1064"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1065"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682561170"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561170"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561171"><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561171"><span class="hs-identifier hs-var">fv_list'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [VarSet] -&gt; ([Var], [VarSet])
</span><a href="#local-6989586621682561172"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561168"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561166"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561167"><span class="hs-identifier hs-var">fv_list</span></a></span><span>
</span><span id="line-1066"></span><span>
</span><span id="line-1067"></span><span>    </span><span class="annot"><a href="#local-6989586621682561172"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span>       </span><span class="hs-comment">-- var to insert</span><span>
</span><span id="line-1068"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- sorted list, in reverse order</span><span>
</span><span id="line-1069"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- list of fvs, as above</span><span>
</span><span id="line-1070"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.Set.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- augmented lists</span><span>
</span><span id="line-1071"></span><span>    </span><span id="local-6989586621682561172"><span class="annot"><span class="annottext">insert :: Var -&gt; [Var] -&gt; [VarSet] -&gt; ([Var], [VarSet])
</span><a href="#local-6989586621682561172"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621682561173"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561173"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561173"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561173"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span>    </span><span class="annot"><a href="#local-6989586621682561172"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span id="local-6989586621682561174"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561174"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561175"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561175"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682561176"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561176"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561177"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561177"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682561178"><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561178"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1073"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561174"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561177"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1074"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561179"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561179"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561180"><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561180"><span class="hs-identifier hs-var">fvss'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [VarSet] -&gt; ([Var], [VarSet])
</span><a href="#local-6989586621682561172"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561174"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561176"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561178"><span class="hs-identifier hs-var">fvss</span></a></span><span>
</span><span id="line-1075"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561175"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561179"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561177"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561181"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; [VarSet] -&gt; [VarSet]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561180"><span class="hs-identifier hs-var">fvss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1078"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561174"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561175"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561176"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561177"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561181"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; [VarSet] -&gt; [VarSet]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561177"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; [VarSet] -&gt; [VarSet]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><a href="#local-6989586621682561178"><span class="hs-identifier hs-var">fvss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1080"></span><span>        </span><span id="local-6989586621682561181"><span class="annot"><span class="annottext">fv_tv :: VarSet
</span><a href="#local-6989586621682561181"><span class="hs-identifier hs-var hs-var">fv_tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561174"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span>       </span><span class="hs-comment">-- lists not in correspondence</span><span>
</span><span id="line-1083"></span><span>    </span><span class="annot"><a href="#local-6989586621682561172"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[VarSet]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Var], [VarSet])
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scopedSort&quot;</span></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="annot"><span class="hs-comment">-- | Get the free vars of a type in scoped order</span></span><span>
</span><span id="line-1086"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier hs-type">tyCoVarsOfTypeWellScoped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1087"></span><span id="tyCoVarsOfTypeWellScoped"><span class="annot"><span class="annottext">tyCoVarsOfTypeWellScoped :: Type -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypeWellScoped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Var]) -&gt; (Type -&gt; [Var]) -&gt; Type -&gt; [Var]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a></span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span class="annot"><span class="hs-comment">-- | Get the free vars of types in scoped order</span></span><span>
</span><span id="line-1090"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier hs-type">tyCoVarsOfTypesWellScoped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1091"></span><span id="tyCoVarsOfTypesWellScoped"><span class="annot"><span class="annottext">tyCoVarsOfTypesWellScoped :: [Type] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier hs-var hs-var">tyCoVarsOfTypesWellScoped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#scopedSort"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Var]) -&gt; ([Type] -&gt; [Var]) -&gt; [Type] -&gt; [Var]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Var]
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypesList"><span class="hs-identifier hs-var">tyCoVarsOfTypesList</span></a></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
            Free type constructors
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="hs-comment">{- Note [tyConsOfType]
~~~~~~~~~~~~~~~~~~~~~~
It is slightly odd to find the TyCons of a type.  Especially since, via a type
family reduction or axiom, a type that doesn't mention T might start to mention T.

This function is used in only three places:
* In GHC.Tc.Validity.validDerivPred, when identifying &quot;exotic&quot; predicates.
* In GHC.Tc.Errors.Ppr.pprTcSolverReportMsg, when trying to print a helpful
  error about overlapping instances
* In utils/dump-decls/Main.hs, an ill-documented module.

None seem critical. Currently tyConsOfType looks inside coercions, but perhaps
it doesn't even need to do that.
-}</span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- | All type constructors occurring in the type; looking through type</span><span>
</span><span id="line-1117"></span><span class="hs-comment">--   synonyms, but not newtypes.</span><span>
</span><span id="line-1118"></span><span class="hs-comment">--  When it finds a Class, it returns the class TyCon.</span><span>
</span><span id="line-1119"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyConsOfType"><span class="hs-identifier hs-type">tyConsOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1120"></span><span id="tyConsOfType"><span class="annot"><span class="annottext">tyConsOfType :: Type -&gt; UniqSet TyCon
</span><a href="GHC.Core.TyCo.FVs.html#tyConsOfType"><span class="hs-identifier hs-var hs-var">tyConsOfType</span></a></span></span><span> </span><span id="local-6989586621682561183"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561183"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1121"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561183"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1123"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>  </span><span class="hs-comment">-- The UniqSet does duplicate elim</span><span>
</span><span id="line-1124"></span><span>     </span><span id="local-6989586621682561184"><span class="annot"><span class="annottext">go :: Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682561185"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561185"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561186"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561186"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561185"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561186"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1125"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-1126"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-1127"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561188"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561188"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561189"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561189"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561188"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; UniqSet TyCon
</span><a href="GHC.Core.TyCo.FVs.html#tyConsOfTypes"><span class="hs-identifier hs-var">tyConsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561189"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1128"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561192"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561192"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682561193"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561193"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561192"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561193"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1129"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682561194"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682561194"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682561195"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561195"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561196"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561196"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682561197"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561197"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561195"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span>
</span><span id="line-1130"></span><span>                                      </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561196"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561197"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1131"></span><span>                                      </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag -&gt; TyCon
</span><a href="GHC.Builtin.Types.Prim.html#funTyFlagTyCon"><span class="hs-identifier hs-var">funTyFlagTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682561194"><span class="hs-identifier hs-var">af</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561198"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561198"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForAllTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561199"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561199"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561199"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561198"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561200"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561200"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561201"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561201"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561200"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561201"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1134"></span><span>     </span><span class="annot"><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682561203"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561203"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561203"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span>     </span><span id="local-6989586621682561202"><span class="annot"><span class="annottext">go_co :: Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682561206"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561206"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561206"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1137"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561207"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561207"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561208"><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682561208"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561207"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561209"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682561208"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-1138"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561210"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561210"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561211"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561211"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561210"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561212"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561211"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1139"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682561213"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561213"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682561214"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561214"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561213"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561214"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1140"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_kind :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561215"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561215"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561216"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561216"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561215"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561216"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1142"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_mult :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561217"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561217"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_arg :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561218"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561218"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_res :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561219"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561219"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561217"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561218"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561219"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1144"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span id="local-6989586621682561220"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682561220"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682561221"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561221"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561222"><span class="hs-identifier hs-var">go_ax</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682561220"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561212"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561221"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1145"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_lty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561223"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561223"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561224"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561224"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: Coercion -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561225"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561225"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561223"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561224"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561212"><span class="hs-identifier hs-var">go_cos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561225"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-1147"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-1148"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-1149"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682561226"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561226"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561226"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1150"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682561227"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561227"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682561228"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561228"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561227"><span class="hs-identifier hs-var">co1</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561228"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-1151"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoSel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561229"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561229"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561229"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1152"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561230"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561230"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561230"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1153"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682561231"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561231"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682561232"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561232"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561231"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-operator hs-var">`unionUniqSets`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561232"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1154"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682561233"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561233"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561233"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1155"></span><span>     </span><span class="annot"><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682561234"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561234"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561234"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1156"></span><span>
</span><span id="line-1157"></span><span>     </span><span id="local-6989586621682561209"><span class="annot"><span class="annottext">go_mco :: MCoercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561209"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>
</span><span id="line-1158"></span><span>     </span><span class="annot"><a href="#local-6989586621682561209"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682561235"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561235"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561235"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1159"></span><span>
</span><span id="line-1160"></span><span>     </span><span id="local-6989586621682561212"><span class="annot"><span class="annottext">go_cos :: [Coercion] -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561212"><span class="hs-identifier hs-var hs-var">go_cos</span></a></span></span><span> </span><span id="local-6989586621682561236"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561236"><span class="hs-identifier hs-var">cos</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; UniqSet TyCon -&gt; [Coercion] -&gt; UniqSet TyCon
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; (Coercion -&gt; UniqSet TyCon)
-&gt; Coercion
-&gt; UniqSet TyCon
-&gt; UniqSet TyCon
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561202"><span class="hs-identifier hs-var">go_co</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561236"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span>     </span><span id="local-6989586621682561190"><span class="annot"><span class="annottext">go_tc :: a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var hs-var">go_tc</span></a></span></span><span> </span><span id="local-6989586621682561239"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682561239"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; UniqSet a
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unitUniqSet"><span class="hs-identifier hs-var">unitUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682561239"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1163"></span><span>
</span><span id="line-1164"></span><span>     </span><span id="local-6989586621682561222"><span class="annot"><span class="annottext">go_ax :: CoAxiomRule -&gt; UniqSet TyCon
</span><a href="#local-6989586621682561222"><span class="hs-identifier hs-var hs-var">go_ax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#UnbranchedAxiom"><span class="hs-identifier hs-type">UnbranchedAxiom</span></a></span><span> </span><span id="local-6989586621682561245"><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682561245"><span class="hs-identifier hs-var">ax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; UniqSet TyCon) -&gt; TyCon -&gt; UniqSet TyCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoAxiom Unbranched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682561245"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-1165"></span><span>     </span><span class="annot"><a href="#local-6989586621682561222"><span class="hs-identifier hs-var">go_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BranchedAxiom"><span class="hs-identifier hs-type">BranchedAxiom</span></a></span><span> </span><span id="local-6989586621682561247"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682561247"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span class="annot"><span class="annottext">BranchIndex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; UniqSet TyCon) -&gt; TyCon -&gt; UniqSet TyCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682561247"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-1166"></span><span>     </span><span class="annot"><a href="#local-6989586621682561222"><span class="hs-identifier hs-var">go_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BuiltInFamRew"><span class="hs-identifier hs-type">BuiltInFamRew</span></a></span><span>  </span><span id="local-6989586621682561249"><span class="annot"><span class="annottext">BuiltInFamRewrite
</span><a href="#local-6989586621682561249"><span class="hs-identifier hs-var">bif</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; UniqSet TyCon
forall {a}. Uniquable a =&gt; a -&gt; UniqSet a
</span><a href="#local-6989586621682561190"><span class="hs-identifier hs-var">go_tc</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; UniqSet TyCon) -&gt; TyCon -&gt; UniqSet TyCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BuiltInFamRewrite -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#bifrw_fam_tc"><span class="hs-identifier hs-var">bifrw_fam_tc</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltInFamRewrite
</span><a href="#local-6989586621682561249"><span class="hs-identifier hs-var">bif</span></a></span><span>
</span><span id="line-1167"></span><span>     </span><span class="annot"><a href="#local-6989586621682561222"><span class="hs-identifier hs-var">go_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BuiltInFamInj"><span class="hs-identifier hs-type">BuiltInFamInj</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span>  </span><span class="hs-comment">-- A free-floating axiom</span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyConsOfTypes"><span class="hs-identifier hs-type">tyConsOfTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-1170"></span><span id="tyConsOfTypes"><span class="annot"><span class="annottext">tyConsOfTypes :: [Type] -&gt; UniqSet TyCon
</span><a href="GHC.Core.TyCo.FVs.html#tyConsOfTypes"><span class="hs-identifier hs-var hs-var">tyConsOfTypes</span></a></span></span><span> </span><span id="local-6989586621682561252"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561252"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; UniqSet TyCon -&gt; [Type] -&gt; UniqSet TyCon
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon
forall a. UniqSet a -&gt; UniqSet a -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a></span><span> </span><span class="annot"><span class="annottext">(UniqSet TyCon -&gt; UniqSet TyCon -&gt; UniqSet TyCon)
-&gt; (Type -&gt; UniqSet TyCon)
-&gt; Type
-&gt; UniqSet TyCon
-&gt; UniqSet TyCon
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; UniqSet TyCon
</span><a href="GHC.Core.TyCo.FVs.html#tyConsOfType"><span class="hs-identifier hs-var">tyConsOfType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UniqSet TyCon
forall a. UniqSet a
</span><a href="GHC.Types.Unique.Set.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561252"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="annot"><span class="hs-comment">{- **********************************************************************
*                                                                       *
           Occurs check expansion
%*                                                                      *
%********************************************************************* -}</span></span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span class="hs-comment">{- Note [Occurs check expansion]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
(occurCheckExpand tv xi) expands synonyms in xi just enough to get rid
of occurrences of tv outside type function arguments, if that is
possible; otherwise, it returns Nothing.

For example, suppose we have
  type F a b = [a]
Then
  occCheckExpand b (F Int b) = Just [Int]
but
  occCheckExpand a (F a Int) = Nothing

We don't promise to do the absolute minimum amount of expanding
necessary, but we try not to do expansions we don't need to.  We
prefer doing inner expansions first.  For example,
  type F a b = (a, Int, a, [a])
  type G b   = Char
We have
  occCheckExpand b (F (G b)) = Just (F Char)
even though we could also expand F to get rid of b.

Note [Occurrence checking: look inside kinds]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we are considering unifying
   (alpha :: *)  ~  Int -&gt; (beta :: alpha -&gt; alpha)
This may be an error (what is that alpha doing inside beta's kind?),
but we must not make the mistake of actually unifying or we'll
build an infinite data structure.  So when looking for occurrences
of alpha in the rhs, we must look in the kinds of type variables
that occur there.

occCheckExpand tries to expand type synonyms to remove
unnecessary occurrences of a variable, and thereby get past an
occurs-check failure.  This is good; but
     we can't do it in the /kind/ of a variable /occurrence/

For example #18451 built an infinite type:
    type Const a b = a
    data SameKind :: k -&gt; k -&gt; Type
    type T (k :: Const Type a) = forall (b :: k). SameKind a b

We have
  b :: k
  k :: Const Type a
  a :: k   (must be same as b)

So if we aren't careful, a's kind mentions a, which is bad.
And expanding an /occurrence/ of 'a' doesn't help, because the
/binding site/ is the master copy and all the occurrences should
match it.

Here's a related example:
   f :: forall a b (c :: Const Type b). Proxy '[a, c]

The list means that 'a' gets the same kind as 'c'; but that
kind mentions 'b', so the binders are out of order.

Bottom line: in occCheckExpand, do not expand inside the kinds
of occurrences.  See bad_var_occ in occCheckExpand.  And
see #18451 for more debate.
-}</span><span>
</span><span id="line-1240"></span><span>
</span><span id="line-1241"></span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier hs-type">occCheckExpand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1242"></span><span class="hs-comment">-- See Note [Occurs check expansion]</span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- We may have needed to do some type synonym unfolding in order to</span><span>
</span><span id="line-1244"></span><span class="hs-comment">-- get rid of the variable (or forall), so we also return the unfolded</span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- version of the type, which is guaranteed to be syntactically free</span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- of the given type variable.  If the type is already syntactically</span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- free of the variable, then the same type is returned.</span><span>
</span><span id="line-1248"></span><span id="occCheckExpand"><span class="annot"><span class="annottext">occCheckExpand :: [Var] -&gt; Type -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier hs-var hs-var">occCheckExpand</span></a></span></span><span> </span><span id="local-6989586621682561253"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561253"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span></span><span> </span><span id="local-6989586621682561254"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561254"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1249"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561253"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span>  </span><span class="hs-comment">-- Efficient shortcut</span><span>
</span><span id="line-1250"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561254"><span class="hs-identifier hs-var">ty</span></a></span><span>           </span><span class="hs-comment">-- Can happen, eg. GHC.Core.Utils.mkSingleAltCase</span><span>
</span><span id="line-1251"></span><span>
</span><span id="line-1252"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1253"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682561253"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarEnv Var
forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561254"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1255"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-1256"></span><span>          </span><span class="hs-comment">-- The VarSet is the set of variables we are trying to avoid</span><span>
</span><span id="line-1257"></span><span>          </span><span class="hs-comment">-- The VarEnv carries mappings necessary</span><span>
</span><span id="line-1258"></span><span>          </span><span class="hs-comment">-- because of kind expansion</span><span>
</span><span id="line-1259"></span><span>    </span><span id="local-6989586621682561256"><span class="annot"><span class="annottext">go :: (VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561259"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561259"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561260"><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561260"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561261"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682561261"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682561262"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561262"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561263"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561263"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarEnv Var -&gt; Var -&gt; Maybe Var
forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561260"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561262"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561263"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1261"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InterestingVarFun
</span><a href="#local-6989586621682561266"><span class="hs-identifier hs-var">bad_var_occ</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561259"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561262"><span class="hs-identifier hs-var">tv</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1262"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561261"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621682561267"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682561267"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561267"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1265"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561268"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561268"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682561269"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561269"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682561270"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561270"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561271"><span class="annot"><a href="#local-6989586621682561271"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561268"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561269"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1266"></span><span>                                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561272"><span class="annot"><a href="#local-6989586621682561272"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561268"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561270"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1267"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561271"><span class="hs-identifier hs-type">ty1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561272"><span class="hs-identifier hs-type">ty2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1268"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561273"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561273"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621682561274"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682561274"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682561275"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561275"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682561276"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561276"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682561277"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561277"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561278"><span class="annot"><a href="#local-6989586621682561278"><span class="hs-identifier hs-var">w'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561273"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561275"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1270"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561279"><span class="annot"><a href="#local-6989586621682561279"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561273"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561276"><span class="hs-identifier hs-type">ty1</span></a></span><span>
</span><span id="line-1271"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561280"><span class="annot"><a href="#local-6989586621682561280"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561273"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561277"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1272"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561274"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561278"><span class="hs-identifier hs-type">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561279"><span class="hs-identifier hs-type">ty1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561280"><span class="hs-identifier hs-type">ty2'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1273"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561284"><span class="annot"><span class="annottext">cxt :: (VarSet, VarEnv Var)
</span><a href="#local-6989586621682561284"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682561285"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561285"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561286"><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561286"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682561287"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561287"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682561288"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682561288"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561289"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561289"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561290"><span class="annot"><a href="#local-6989586621682561290"><span class="hs-identifier hs-var">ki'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561284"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561287"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682561291"><span class="annot"><a href="#local-6989586621682561291"><span class="hs-identifier hs-var hs-var">tv'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561287"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561290"><span class="hs-identifier hs-var">ki'</span></a></span><span>
</span><span id="line-1276"></span><span>                  </span><span id="local-6989586621682561293"><span class="annot"><a href="#local-6989586621682561293"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv Var -&gt; Var -&gt; Var -&gt; VarEnv Var
forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561286"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561287"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561291"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-1277"></span><span>                  </span><span id="local-6989586621682561295"><span class="annot"><a href="#local-6989586621682561295"><span class="hs-identifier hs-var hs-var">as'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561285"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561287"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1278"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561296"><span class="annot"><a href="#local-6989586621682561296"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561295"><span class="hs-identifier hs-type">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682561293"><span class="hs-identifier hs-type">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682561289"><span class="hs-identifier hs-type">body_ty</span></a></span><span>
</span><span id="line-1279"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561291"><span class="hs-identifier hs-type">tv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561288"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682561296"><span class="hs-identifier hs-type">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span>    </span><span class="hs-comment">-- For a type constructor application, first try expanding away the</span><span>
</span><span id="line-1282"></span><span>    </span><span class="hs-comment">-- offending variable from the arguments.  If that doesn't work, next</span><span>
</span><span id="line-1283"></span><span>    </span><span class="hs-comment">-- see if the type constructor is a type synonym, and if so, expand</span><span>
</span><span id="line-1284"></span><span>    </span><span class="hs-comment">-- it and try again.</span><span>
</span><span id="line-1285"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561297"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561297"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621682561298"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621682561298"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682561299"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561299"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561300"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561300"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1286"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; [Type] -&gt; Maybe [Type]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561297"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561300"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1287"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561302"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561302"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561299"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682561302"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1288"></span><span>          </span><span class="annot"><span class="annottext">Maybe [Type]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561303"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561303"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561298"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561297"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561303"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1289"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1290"></span><span>                      </span><span class="hs-comment">-- Failing that, try to expand a synonym</span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561304"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561304"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682561305"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561305"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561306"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561306"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561307"><span class="annot"><a href="#local-6989586621682561307"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561304"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561305"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1293"></span><span>                                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561308"><span class="annot"><a href="#local-6989586621682561308"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561304"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561306"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-1294"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561307"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561308"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1295"></span><span>    </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682561310"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561310"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682561311"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561311"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561312"><span class="annot"><a href="#local-6989586621682561312"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561310"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561311"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1296"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561312"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1297"></span><span>
</span><span id="line-1298"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-1299"></span><span>    </span><span class="annot"><a href="#local-6989586621682561266"><span class="hs-identifier hs-type">bad_var_occ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1300"></span><span>    </span><span class="hs-comment">-- Works for TyVar and CoVar</span><span>
</span><span id="line-1301"></span><span>    </span><span class="hs-comment">-- See Note [Occurrence checking: look inside kinds]</span><span>
</span><span id="line-1302"></span><span>    </span><span id="local-6989586621682561266"><span class="annot"><span class="annottext">bad_var_occ :: VarSet -&gt; InterestingVarFun
</span><a href="#local-6989586621682561266"><span class="hs-identifier hs-var hs-var">bad_var_occ</span></a></span></span><span> </span><span id="local-6989586621682561313"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561313"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span></span><span> </span><span id="local-6989586621682561314"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561314"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-1303"></span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561314"><span class="hs-identifier hs-var">v</span></a></span><span>                          </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span>       </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561313"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span>
</span><span id="line-1304"></span><span>       </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561314"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#intersectsVarSet"><span class="hs-operator hs-var">`intersectsVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561313"><span class="hs-identifier hs-var">vs_to_avoid</span></a></span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-1307"></span><span>    </span><span id="local-6989586621682561368"><span class="annot"><span class="annottext">go_mco :: (VarSet, VarEnv Var) -&gt; MCoercion -&gt; Maybe MCoercion
</span><a href="#local-6989586621682561368"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercion -&gt; Maybe MCoercion
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-1308"></span><span>    </span><span class="annot"><a href="#local-6989586621682561368"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span id="local-6989586621682561369"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561369"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682561370"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561370"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; MCoercion) -&gt; Maybe Coercion -&gt; Maybe MCoercion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561369"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561370"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1309"></span><span>
</span><span id="line-1310"></span><span>    </span><span class="hs-comment">------------------</span><span>
</span><span id="line-1311"></span><span>    </span><span id="local-6989586621682561309"><span class="annot"><span class="annottext">go_co :: (VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var hs-var">go_co</span></a></span></span><span> </span><span id="local-6989586621682561371"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561371"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682561372"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561372"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561373"><span class="annot"><a href="#local-6989586621682561373"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561371"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561372"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1312"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561373"><span class="hs-identifier hs-type">ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1313"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561374"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561374"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621682561375"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682561375"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682561376"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561376"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682561377"><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682561377"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561378"><span class="annot"><a href="#local-6989586621682561378"><span class="hs-identifier hs-var">mco'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; MCoercion -&gt; Maybe MCoercion
</span><a href="#local-6989586621682561368"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561374"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621682561377"><span class="hs-identifier hs-var">mco</span></a></span><span>
</span><span id="line-1314"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561379"><span class="annot"><a href="#local-6989586621682561379"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561374"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561376"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-1315"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561375"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561379"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561378"><span class="hs-identifier hs-type">mco'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1316"></span><span>      </span><span class="hs-comment">-- Note: Coercions do not contain type synonyms</span><span>
</span><span id="line-1317"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561380"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561380"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621682561381"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682561381"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682561382"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682561382"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682561383"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561383"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561384"><span class="annot"><a href="#local-6989586621682561384"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; Maybe Coercion) -&gt; [Coercion] -&gt; Maybe [Coercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561380"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561383"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1318"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561381"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561382"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561384"><span class="hs-identifier hs-type">args'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1319"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561385"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561385"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682561386"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561386"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682561387"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561387"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561388"><span class="annot"><a href="#local-6989586621682561388"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561385"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561386"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1320"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561389"><span class="annot"><a href="#local-6989586621682561389"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561385"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561387"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-1321"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561388"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561389"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1322"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561390"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561390"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682561391"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561391"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561392"><span class="annot"><a href="#local-6989586621682561392"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561390"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561391"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1323"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561392"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1324"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561393"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561393"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682561394"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561394"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682561395"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561395"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561396"><span class="annot"><a href="#local-6989586621682561396"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561393"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561394"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-1325"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561397"><span class="annot"><a href="#local-6989586621682561397"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561393"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561395"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-1326"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561396"><span class="hs-identifier hs-type">co1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561397"><span class="hs-identifier hs-type">co2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1327"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561398"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561398"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span id="local-6989586621682561399"><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682561399"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682561400"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561400"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561401"><span class="annot"><a href="#local-6989586621682561401"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561398"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561400"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1328"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561399"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561401"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1329"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561402"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561402"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621682561403"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682561403"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621682561404"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561404"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561405"><span class="annot"><a href="#local-6989586621682561405"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561402"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561404"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1330"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561403"><span class="hs-identifier hs-type">lr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561405"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1331"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561406"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561406"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682561407"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561407"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682561408"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561408"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561409"><span class="annot"><a href="#local-6989586621682561409"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561406"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561407"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1332"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561410"><span class="annot"><a href="#local-6989586621682561410"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561406"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561408"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-1333"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561409"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561410"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1334"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561411"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561411"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682561412"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561412"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561413"><span class="annot"><a href="#local-6989586621682561413"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561411"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561412"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1335"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561413"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1336"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561414"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561414"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682561415"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561415"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561416"><span class="annot"><a href="#local-6989586621682561416"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561414"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561415"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1337"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561416"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1338"></span><span>
</span><span id="line-1339"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561417"><span class="annot"><span class="annottext">cxt :: (VarSet, VarEnv Var)
</span><a href="#local-6989586621682561417"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682561418"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561418"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682561419"><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561419"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561420"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682561420"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: Coercion -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561421"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561421"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561422"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561422"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561423"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561423"><span class="hs-identifier hs-var">body_co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561424"><span class="annot"><a href="#local-6989586621682561424"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561417"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561422"><span class="hs-identifier hs-var">kind_co</span></a></span><span>
</span><span id="line-1341"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682561425"><span class="annot"><a href="#local-6989586621682561425"><span class="hs-identifier hs-var hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561421"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Var) -&gt; Type -&gt; Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1342"></span><span>                       </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; Type
Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561424"><span class="hs-identifier hs-var">kind_co'</span></a></span><span>
</span><span id="line-1343"></span><span>                 </span><span id="local-6989586621682561426"><span class="annot"><a href="#local-6989586621682561426"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarEnv Var -&gt; Var -&gt; Var -&gt; VarEnv Var
forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561419"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561421"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561425"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-1344"></span><span>                 </span><span id="local-6989586621682561427"><span class="annot"><a href="#local-6989586621682561427"><span class="hs-identifier hs-var hs-var">as'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561418"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-operator hs-var">`delVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561421"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1345"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561428"><span class="annot"><a href="#local-6989586621682561428"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561427"><span class="hs-identifier hs-type">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682561426"><span class="hs-identifier hs-type">env'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682561423"><span class="hs-identifier hs-type">body_co</span></a></span><span>
</span><span id="line-1346"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561420"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561425"><span class="hs-identifier hs-type">tv'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561424"><span class="hs-identifier hs-type">kind_co'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561428"><span class="hs-identifier hs-type">body'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561429"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561429"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621682561430"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682561430"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_mult :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561431"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561431"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_arg :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561432"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561432"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">fco_res :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561433"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561433"><span class="hs-identifier hs-var">co2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1349"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561434"><span class="annot"><a href="#local-6989586621682561434"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561429"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561432"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-1350"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561435"><span class="annot"><a href="#local-6989586621682561435"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561429"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561433"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-1351"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561436"><span class="annot"><a href="#local-6989586621682561436"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561429"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561431"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1352"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561430"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561436"><span class="hs-identifier hs-type">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561434"><span class="hs-identifier hs-type">co1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561435"><span class="hs-identifier hs-type">co2'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1353"></span><span>
</span><span id="line-1354"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561437"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561437"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682561438"><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561438"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561439"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682561439"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682561440"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561440"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1355"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682561441"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561441"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VarEnv Var -&gt; Var -&gt; Maybe Var
forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">VarEnv Var
</span><a href="#local-6989586621682561438"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561440"><span class="hs-identifier hs-var">c</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Maybe Coercion
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561441"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1356"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InterestingVarFun
</span><a href="#local-6989586621682561266"><span class="hs-identifier hs-var">bad_var_occ</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561437"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682561440"><span class="hs-identifier hs-var">c</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Coercion
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1357"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Maybe Coercion
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561439"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682561442"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561442"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VarEnv Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682561443"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682561443"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682561444"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682561444"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1360"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InterestingVarFun
</span><a href="#local-6989586621682561266"><span class="hs-identifier hs-var">bad_var_occ</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621682561442"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#ch_co_var"><span class="hs-identifier hs-var">ch_co_var</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682561444"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Coercion
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1361"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Maybe Coercion
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682561443"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1362"></span><span>
</span><span id="line-1363"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561446"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561446"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span id="local-6989586621682561447"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682561447"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682561448"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561448"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561449"><span class="annot"><a href="#local-6989586621682561449"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; Maybe Coercion) -&gt; [Coercion] -&gt; Maybe [Coercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Coercion -&gt; Maybe Coercion
</span><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561446"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561448"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1364"></span><span>                                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561447"><span class="hs-identifier hs-type">ax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561449"><span class="hs-identifier hs-type">cs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1365"></span><span>    </span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-var">go_co</span></a></span><span> </span><span id="local-6989586621682561450"><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561450"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621682561451"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682561451"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_lty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561452"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561452"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561453"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561453"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: Coercion -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682561454"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682561454"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1366"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682561455"><span class="annot"><a href="#local-6989586621682561455"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var) -&gt; Type -&gt; Maybe Type
</span><a href="#local-6989586621682561256"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(VarSet, VarEnv Var)
</span><a href="#local-6989586621682561450"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682561452"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1367"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561456"><span class="annot"><a href="#local-6989586621682561456"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682561256"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561450"><span class="hs-identifier hs-type">cxt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561453"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-1368"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682561457"><span class="annot"><a href="#local-6989586621682561457"><span class="hs-identifier hs-var">cos'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561309"><span class="hs-identifier hs-type">go_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682561450"><span class="hs-identifier hs-type">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682561454"><span class="hs-identifier hs-type">cos</span></a></span><span>
</span><span id="line-1369"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682561451"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561455"><span class="hs-identifier hs-type">ty1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561456"><span class="hs-identifier hs-type">ty2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682561457"><span class="hs-identifier hs-type">cos'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1370"></span><span>
</span><span id="line-1371"></span></pre></body></html>