<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BinaryLiterals #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html"><span class="hs-identifier">GHC.CmmToAsm.RV64.CodeGen</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier">cmmTopCodeGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier">generateJumpTableForInstr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#makeFarBranches"><span class="hs-identifier">makeFarBranches</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.html"><span class="hs-identifier">GHC.Cmm</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html"><span class="hs-identifier">GHC.Cmm.BlockId</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html"><span class="hs-identifier">GHC.Cmm.CLabel</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Block</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Graph.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Graph</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html"><span class="hs-identifier">GHC.Cmm.Dataflow.Label</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html"><span class="hs-identifier">GHC.Cmm.DebugBlock</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html"><span class="hs-identifier">GHC.Cmm.Switch</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Utils.html"><span class="hs-identifier">GHC.Cmm.Utils</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.CPrim.html"><span class="hs-identifier">GHC.CmmToAsm.CPrim</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html"><span class="hs-identifier">GHC.CmmToAsm.Config</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html"><span class="hs-identifier">GHC.CmmToAsm.Format</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html"><span class="hs-identifier">GHC.CmmToAsm.Monad</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier">NatM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier">getBlockIdNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier">getConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier">getDebugBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier">getFileId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier">getNewLabelNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier">getNewRegNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier">getPicBaseMaybeNat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier">getPlatform</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html"><span class="hs-identifier">GHC.CmmToAsm.PIC</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Cond.html"><span class="hs-identifier">GHC.CmmToAsm.RV64.Cond</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html"><span class="hs-identifier">GHC.CmmToAsm.RV64.Instr</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html"><span class="hs-identifier">GHC.CmmToAsm.RV64.Regs</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Types.html"><span class="hs-identifier">GHC.CmmToAsm.Types</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html"><span class="hs-identifier">GHC.Data.OrdList</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Float.html"><span class="hs-identifier">GHC.Float</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html"><span class="hs-identifier">GHC.Platform.Reg</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Regs.html"><span class="hs-identifier">GHC.Platform.Regs</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EQ</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.ForeignCall.html"><span class="hs-identifier">GHC.Types.ForeignCall</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier">srcSpanFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier">srcSpanStartCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier">srcSpanStartLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#GenTickish"><span class="hs-identifier">GenTickish</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html"><span class="hs-identifier">GHC.Types.Unique.DSM</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Constants.html"><span class="hs-identifier">GHC.Utils.Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier">debugIsOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- For an overview of an NCG's structure, see Note [General layout of an NCG]</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-type">cmmTopCodeGen</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="GHC.Cmm.html#RawCmmDecl"><span class="hs-identifier hs-type">RawCmmDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- Thus we'll have to deal with either CmmProc ...</span><span>
</span><span id="line-69"></span><span id="cmmTopCodeGen"><span class="annot"><span class="annottext">cmmTopCodeGen :: RawCmmDecl -&gt; NatM [NatCmmDecl RawCmmStatics Instr]
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var hs-var">cmmTopCodeGen</span></a></span></span><span> </span><span id="local-6989586621682860650"><span class="annot"><span class="annottext">_cmm :: RawCmmDecl
</span><a href="#local-6989586621682860650"><span class="hs-identifier hs-var">_cmm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-type">CmmProc</span></a></span><span> </span><span id="local-6989586621682860652"><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682860652"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621682860653"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860653"><span class="hs-identifier hs-var">lab</span></a></span></span><span> </span><span id="local-6989586621682860654"><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682860654"><span class="hs-identifier hs-var">live</span></a></span></span><span> </span><span id="local-6989586621682860655"><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682860655"><span class="hs-identifier hs-var">graph</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621682860656"><span class="annot"><a href="#local-6989586621682860656"><span class="hs-identifier hs-var">picBaseMb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM (Maybe Reg)
</span><a href="GHC.CmmToAsm.Monad.html#getPicBaseMaybeNat"><span class="hs-identifier hs-var">getPicBaseMaybeNat</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="annot"><a href="#local-6989586621682860656"><span class="hs-identifier hs-type">picBaseMb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-type">panic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;RV64.cmmTopCodeGen: Unexpected PIC base register (RISCV ISA does not define one)&quot;</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860660"><span class="annot"><a href="#local-6989586621682860660"><span class="hs-identifier hs-var hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmGraph -&gt; [Block CmmNode C C]
</span><a href="GHC.Cmm.Utils.html#toBlockListEntryFirst"><span class="hs-identifier hs-var">toBlockListEntryFirst</span></a></span><span> </span><span class="annot"><span class="annottext">CmmGraph
</span><a href="#local-6989586621682860655"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682860662"><span class="annot"><a href="#local-6989586621682860662"><span class="hs-identifier hs-var">nat_blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860663"><span class="annot"><a href="#local-6989586621682860663"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapAndUnzipM</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-type">basicBlockCodeGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860660"><span class="hs-identifier hs-type">blocks</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860666"><span class="annot"><a href="#local-6989586621682860666"><span class="hs-identifier hs-var hs-var">proc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
-&gt; CLabel
-&gt; [GlobalRegUse]
-&gt; ListGraph Instr
-&gt; NatCmmDecl RawCmmStatics Instr
forall d h g.
h -&gt; CLabel -&gt; [GlobalRegUse] -&gt; g -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmProc"><span class="hs-identifier hs-var">CmmProc</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682860652"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860653"><span class="hs-identifier hs-var">lab</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRegUse]
</span><a href="#local-6989586621682860654"><span class="hs-identifier hs-var">live</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; ListGraph Instr
forall i. [GenBasicBlock i] -&gt; ListGraph i
</span><a href="GHC.Cmm.html#ListGraph"><span class="hs-identifier hs-var">ListGraph</span></a></span><span> </span><span class="annot"><span class="annottext">([NatBasicBlock Instr] -&gt; ListGraph Instr)
-&gt; [NatBasicBlock Instr] -&gt; ListGraph Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]] -&gt; [NatBasicBlock Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatBasicBlock Instr]]
</span><a href="#local-6989586621682860662"><span class="hs-identifier hs-var">nat_blocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>      </span><span id="local-6989586621682860669"><span class="annot"><a href="#local-6989586621682860669"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl RawCmmStatics Instr
</span><a href="#local-6989586621682860666"><span class="hs-identifier hs-var">proc</span></a></span><span> </span><span class="annot"><span class="annottext">NatCmmDecl RawCmmStatics Instr
-&gt; [NatCmmDecl RawCmmStatics Instr]
-&gt; [NatCmmDecl RawCmmStatics Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl RawCmmStatics Instr]]
-&gt; [NatCmmDecl RawCmmStatics Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[NatCmmDecl RawCmmStatics Instr]]
</span><a href="#local-6989586621682860663"><span class="hs-identifier hs-var">statics</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682860669"><span class="hs-identifier hs-type">tops</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- ... or CmmData.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#cmmTopCodeGen"><span class="hs-identifier hs-var">cmmTopCodeGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-type">CmmData</span></a></span><span> </span><span id="local-6989586621682860671"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682860671"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682860672"><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682860672"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NatCmmDecl RawCmmStatics Instr]
-&gt; NatM [NatCmmDecl RawCmmStatics Instr]
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Section -&gt; RawCmmStatics -&gt; NatCmmDecl RawCmmStatics Instr
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682860671"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682860672"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- no translation, we just use CmmStatic</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-type">basicBlockCodeGen</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span id="basicBlockCodeGen"><span class="annot"><span class="annottext">basicBlockCodeGen :: Block CmmNode C C
-&gt; NatM ([NatBasicBlock Instr], [NatCmmDecl RawCmmStatics Instr])
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#basicBlockCodeGen"><span class="hs-identifier hs-var hs-var">basicBlockCodeGen</span></a></span></span><span> </span><span id="local-6989586621682860673"><span class="annot"><span class="annottext">Block CmmNode C C
</span><a href="#local-6989586621682860673"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621682860674"><span class="annot"><a href="#local-6989586621682860674"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860675"><span class="annot"><a href="#local-6989586621682860675"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860676"><span class="annot"><a href="#local-6989586621682860676"><span class="hs-identifier hs-var">tail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#blockSplit"><span class="hs-identifier hs-type">blockSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860673"><span class="hs-identifier hs-type">block</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span id="local-6989586621682860678"><span class="annot"><a href="#local-6989586621682860678"><span class="hs-identifier hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Block CmmNode C C -&gt; BlockId
forall (x :: Extensibility). Block CmmNode C x -&gt; BlockId
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; BlockId
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode C C
</span><a href="#local-6989586621682860673"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621682860680"><span class="annot"><a href="#local-6989586621682860680"><span class="hs-identifier hs-var hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O -&gt; [CmmNode O O]
forall (n :: Extensibility -&gt; Extensibility -&gt; *).
Block n O O -&gt; [n O O]
</span><a href="GHC.Cmm.Dataflow.Block.html#blockToList"><span class="hs-identifier hs-var">blockToList</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode O O
</span><a href="#local-6989586621682860675"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621682860682"><span class="annot"><a href="#local-6989586621682860682"><span class="hs-identifier hs-var hs-var">header_comment_instr</span></a></span></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>            </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span>
</span><span id="line-99"></span><span>              </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MULTILINE_COMMENT"><span class="hs-identifier hs-var">MULTILINE_COMMENT</span></a></span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-- --------------------------- basicBlockCodeGen --------------------------- --\n&quot;</span></span><span>
</span><span id="line-101"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="GHC.Utils.Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Block CmmNode C C -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860674"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Block CmmNode C C
</span><a href="#local-6989586621682860673"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">-- Generate location directive `.loc` (DWARF debug location info)</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621682860692"><span class="annot"><a href="#local-6989586621682860692"><span class="hs-identifier hs-var">loc_instrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682860693"><span class="hs-identifier hs-type">genLocInstrs</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- Generate other instructions</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621682860694"><span class="annot"><a href="#local-6989586621682860694"><span class="hs-identifier hs-var">mid_instrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860680"><span class="hs-identifier hs-type">stmts</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682860696"><span class="annot"><a href="#local-6989586621682860696"><span class="hs-identifier hs-var">tail_instrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860676"><span class="hs-identifier hs-type">tail</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860698"><span class="annot"><a href="#local-6989586621682860698"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860682"><span class="hs-identifier hs-var">header_comment_instr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860692"><span class="hs-identifier hs-var">loc_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860694"><span class="hs-identifier hs-var">mid_instrs</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860696"><span class="hs-identifier hs-var">tail_instrs</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-comment">-- TODO: Then x86 backend runs @verifyBasicBlock@ here. How important it is to</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-comment">-- have a valid CFG is an open question: This and the AArch64 and PPC NCGs</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-comment">-- work fine without it.</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- Code generation may introduce new basic block boundaries, which are</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-comment">-- indicated by the NEWBLOCK instruction. We must split up the instruction</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-comment">-- stream into basic blocks again. Also, we extract LDATAs here too.</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682860700"><span class="annot"><a href="#local-6989586621682860700"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860701"><span class="annot"><a href="#local-6989586621682860701"><span class="hs-identifier hs-var">other_blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860702"><span class="annot"><a href="#local-6989586621682860702"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#foldrOL"><span class="hs-identifier hs-type">foldrOL</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-type">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682860698"><span class="hs-identifier hs-type">instrs</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860678"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860700"><span class="hs-identifier hs-type">top</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682860701"><span class="hs-identifier hs-type">other_blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860702"><span class="hs-identifier hs-type">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621682860693"><span class="hs-identifier hs-type">genLocInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621682860693"><span class="annot"><span class="annottext">genLocInstrs :: NatM (OrdList Instr)
</span><a href="#local-6989586621682860693"><span class="hs-identifier hs-var hs-var">genLocInstrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621682860706"><span class="annot"><a href="#local-6989586621682860706"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; NatM (Maybe DebugBlock)
</span><a href="GHC.CmmToAsm.Monad.html#getDebugBlock"><span class="hs-identifier hs-var">getDebugBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Block CmmNode C C -&gt; BlockId
forall (x :: Extensibility). Block CmmNode C x -&gt; BlockId
forall (thing :: Extensibility -&gt; Extensibility -&gt; *)
       (x :: Extensibility).
NonLocal thing =&gt;
thing C x -&gt; BlockId
</span><a href="GHC.Cmm.Dataflow.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Block CmmNode C C
</span><a href="#local-6989586621682860673"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Cmm.DebugBlock.html#dblSourceTick"><span class="hs-identifier hs-var">dblSourceTick</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">=&lt;&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682860706"><span class="hs-identifier hs-type">dbg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#SourceNote"><span class="hs-identifier hs-type">SourceNote</span></a></span><span> </span><span id="local-6989586621682860710"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682860710"><span class="hs-identifier hs-var">span</span></a></span></span><span> </span><span id="local-6989586621682860711"><span class="annot"><span class="annottext">LexicalFastString
</span><a href="#local-6989586621682860711"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>            </span><span id="local-6989586621682860712"><span class="annot"><a href="#local-6989586621682860712"><span class="hs-identifier hs-var">fileId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM Int
</span><a href="GHC.CmmToAsm.Monad.html#getFileId"><span class="hs-identifier hs-var">getFileId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682860710"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860713"><span class="annot"><a href="#local-6989586621682860713"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682860710"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682860714"><span class="annot"><a href="#local-6989586621682860714"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier hs-var">srcSpanStartCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682860710"><span class="hs-identifier hs-var">span</span></a></span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LOCATION"><span class="hs-identifier hs-type">LOCATION</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860712"><span class="hs-identifier hs-type">fileId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860713"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860714"><span class="hs-identifier hs-type">col</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860711"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="annottext">Maybe CmmTickish
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span id="local-6989586621682859625"><span id="local-6989586621682859626"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-type">mkBlocks</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#GenCmmDecl"><span class="hs-identifier hs-type">GenCmmDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859625"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859626"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#GenCmmDecl"><span class="hs-identifier hs-type">GenCmmDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859625"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859626"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-140"></span><span id="mkBlocks"><span class="annot"><span class="annottext">mkBlocks :: forall h g.
Instr
-&gt; ([Instr], [NatBasicBlock Instr], [GenCmmDecl RawCmmStatics h g])
-&gt; ([Instr], [NatBasicBlock Instr], [GenCmmDecl RawCmmStatics h g])
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-var hs-var">mkBlocks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span id="local-6989586621682860717"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860717"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682860718"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860718"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860719"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860719"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860720"><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860720"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. BlockId -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860717"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860718"><span class="hs-identifier hs-var">instrs</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860719"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860720"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LDATA"><span class="hs-identifier hs-type">LDATA</span></a></span><span> </span><span id="local-6989586621682860722"><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682860722"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span id="local-6989586621682860723"><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682860723"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682860724"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860724"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860725"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860725"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860726"><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860726"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860724"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860725"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Section -&gt; RawCmmStatics -&gt; GenCmmDecl RawCmmStatics h g
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="annot"><span class="annottext">Section
</span><a href="#local-6989586621682860722"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682860723"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">GenCmmDecl RawCmmStatics h g
-&gt; [GenCmmDecl RawCmmStatics h g] -&gt; [GenCmmDecl RawCmmStatics h g]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860726"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-var">mkBlocks</span></a></span><span> </span><span id="local-6989586621682860727"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682860727"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682860728"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860728"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860729"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860729"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860730"><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860730"><span class="hs-identifier hs-var">statics</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682860727"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; [Instr] -&gt; [Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682860728"><span class="hs-identifier hs-var">instrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682860729"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GenCmmDecl RawCmmStatics h g]
</span><a href="#local-6989586621682860730"><span class="hs-identifier hs-var">statics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- | Utilities</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | Annotate an `Instr` with a `SDoc` comment</span></span><span>
</span><span id="line-152"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-153"></span><span id="ann"><span class="annot"><span class="annottext">ann :: SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621682860732"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682860732"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621682860733"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682860733"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-comment">{- debugIsOn -}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ANN"><span class="hs-identifier hs-var">ANN</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682860732"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682860733"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-154"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-pragma hs-type">ann</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Using pprExpr will hide the AST, @ANN@ will end up in the assembly with</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- -dppr-debug.  The idea is that we can trivially see how a cmm expression</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- ended up producing the assembly we see.  By having the verbatim AST printed</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- we can simply check the patterns that were matched to arrive at the assembly</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- we generated.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- pprExpr will hide a lot of noise of the underlying data structure and print</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- the expression into something that can be easily read by a human. However</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- going back to the exact CmmExpr representation can be laborious and adds</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- indirections to find the matches that lead to the assembly.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- An improvement could be to have</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">--    (pprExpr genericPlatform e) &lt;&gt; parens (text. show e)</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- to have the best of both worlds.</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- Note: debugIsOn is too restrictive, it only works for debug compilers.</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- However, we do not only want to inspect this for debug compilers. Ideally</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- we'd have a check for -dppr-debug here already, such that we don't even</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- generate the ANN expressions. However, as they are lazy, they shouldn't be</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- forced until we actually force them, and without -dppr-debug they should</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- never end up being forced.</span><span>
</span><span id="line-179"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-type">annExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-180"></span><span id="annExpr"><span class="annot"><span class="annottext">annExpr :: CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var hs-var">annExpr</span></a></span></span><span> </span><span id="local-6989586621682860736"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860736"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-comment">{- debugIsOn -}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ANN"><span class="hs-identifier hs-var">ANN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc) -&gt; (CmmExpr -&gt; [Char]) -&gt; CmmExpr -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; SDoc) -&gt; CmmExpr -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860736"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- annExpr e instr {- debugIsOn -} = ANN (pprExpr genericPlatform e) instr</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- annExpr _ instr = instr</span><span>
</span><span id="line-183"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-pragma hs-type">annExpr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- Generating a table-branch</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- Note [RISCV64 Jump Tables]</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- Jump tables are implemented by generating a table of relative addresses,</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- where each entry is the relative offset to the target block from the first</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- entry / table label (`generateJumpTableForInstr`). Using the jump table means</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- loading the entry's value and jumping to the calculated absolute address</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- (`genSwitch`).</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- For example, this Cmm switch</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   switch [1 .. 10] _s2wn::I64 {</span><span>
</span><span id="line-200"></span><span class="hs-comment">--       case 1 : goto c347;</span><span>
</span><span id="line-201"></span><span class="hs-comment">--       case 2 : goto c348;</span><span>
</span><span id="line-202"></span><span class="hs-comment">--       case 3 : goto c349;</span><span>
</span><span id="line-203"></span><span class="hs-comment">--       case 4 : goto c34a;</span><span>
</span><span id="line-204"></span><span class="hs-comment">--       case 5 : goto c34b;</span><span>
</span><span id="line-205"></span><span class="hs-comment">--       case 6 : goto c34c;</span><span>
</span><span id="line-206"></span><span class="hs-comment">--       case 7 : goto c34d;</span><span>
</span><span id="line-207"></span><span class="hs-comment">--       case 8 : goto c34e;</span><span>
</span><span id="line-208"></span><span class="hs-comment">--       case 9 : goto c34f;</span><span>
</span><span id="line-209"></span><span class="hs-comment">--       case 10 : goto c34g;</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   }   // CmmSwitch</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- leads to this jump table in Assembly</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">--   .section .rodata</span><span>
</span><span id="line-215"></span><span class="hs-comment">--           .balign 8</span><span>
</span><span id="line-216"></span><span class="hs-comment">--   .Ln34G:</span><span>
</span><span id="line-217"></span><span class="hs-comment">--           .quad   0</span><span>
</span><span id="line-218"></span><span class="hs-comment">--           .quad   .Lc347-(.Ln34G)+0</span><span>
</span><span id="line-219"></span><span class="hs-comment">--           .quad   .Lc348-(.Ln34G)+0</span><span>
</span><span id="line-220"></span><span class="hs-comment">--           .quad   .Lc349-(.Ln34G)+0</span><span>
</span><span id="line-221"></span><span class="hs-comment">--           .quad   .Lc34a-(.Ln34G)+0</span><span>
</span><span id="line-222"></span><span class="hs-comment">--           .quad   .Lc34b-(.Ln34G)+0</span><span>
</span><span id="line-223"></span><span class="hs-comment">--           .quad   .Lc34c-(.Ln34G)+0</span><span>
</span><span id="line-224"></span><span class="hs-comment">--           .quad   .Lc34d-(.Ln34G)+0</span><span>
</span><span id="line-225"></span><span class="hs-comment">--           .quad   .Lc34e-(.Ln34G)+0</span><span>
</span><span id="line-226"></span><span class="hs-comment">--           .quad   .Lc34f-(.Ln34G)+0</span><span>
</span><span id="line-227"></span><span class="hs-comment">--           .quad   .Lc34g-(.Ln34G)+0</span><span>
</span><span id="line-228"></span><span class="hs-comment">--</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- and this indexing code where the jump should be done (register t0 contains</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- the index)</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-comment">--           addi t0, t0, 0 // silly move (ignore it)</span><span>
</span><span id="line-233"></span><span class="hs-comment">--           la t1, .Ln34G // load the table's address</span><span>
</span><span id="line-234"></span><span class="hs-comment">--           sll t0, t0, 3 // index * 8 -&gt; offset in bytes</span><span>
</span><span id="line-235"></span><span class="hs-comment">--           add t0, t0, t1 // address of the table's entry</span><span>
</span><span id="line-236"></span><span class="hs-comment">--           ld t0, 0(t0) // load entry</span><span>
</span><span id="line-237"></span><span class="hs-comment">--           add t0, t0, t1 // relative to absolute address</span><span>
</span><span id="line-238"></span><span class="hs-comment">--           jalr zero, t0, 0 // jump to the block</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- In object code (disassembled) the table looks like</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   0000000000000000 &lt;.Ln34G&gt;:</span><span>
</span><span id="line-243"></span><span class="hs-comment">--        ...</span><span>
</span><span id="line-244"></span><span class="hs-comment">--        8: R_RISCV_ADD64        .Lc347</span><span>
</span><span id="line-245"></span><span class="hs-comment">--        8: R_RISCV_SUB64        .Ln34G</span><span>
</span><span id="line-246"></span><span class="hs-comment">--        10: R_RISCV_ADD64       .Lc348</span><span>
</span><span id="line-247"></span><span class="hs-comment">--        10: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-248"></span><span class="hs-comment">--        18: R_RISCV_ADD64       .Lc349</span><span>
</span><span id="line-249"></span><span class="hs-comment">--        18: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-250"></span><span class="hs-comment">--        20: R_RISCV_ADD64       .Lc34a</span><span>
</span><span id="line-251"></span><span class="hs-comment">--        20: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-252"></span><span class="hs-comment">--        28: R_RISCV_ADD64       .Lc34b</span><span>
</span><span id="line-253"></span><span class="hs-comment">--        28: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-254"></span><span class="hs-comment">--        30: R_RISCV_ADD64       .Lc34c</span><span>
</span><span id="line-255"></span><span class="hs-comment">--        30: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-256"></span><span class="hs-comment">--        38: R_RISCV_ADD64       .Lc34d</span><span>
</span><span id="line-257"></span><span class="hs-comment">--        38: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-258"></span><span class="hs-comment">--        40: R_RISCV_ADD64       .Lc34e</span><span>
</span><span id="line-259"></span><span class="hs-comment">--        40: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-260"></span><span class="hs-comment">--        48: R_RISCV_ADD64       .Lc34f</span><span>
</span><span id="line-261"></span><span class="hs-comment">--        48: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-262"></span><span class="hs-comment">--        50: R_RISCV_ADD64       .Lc34g</span><span>
</span><span id="line-263"></span><span class="hs-comment">--        50: R_RISCV_SUB64       .Ln34G</span><span>
</span><span id="line-264"></span><span class="hs-comment">--</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- I.e. the relative offset calculations are done by the linker via relocations.</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- This seems to be PIC compatible; at least `scanelf` (pax-utils) does not</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- complain.</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Generate jump to jump table target</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- The index into the jump table is calulated by evaluating @expr@. The</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- corresponding table entry contains the relative address to jump to (relative</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- to the jump table's first entry / the table's own label).</span><span>
</span><span id="line-275"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genSwitch"><span class="hs-identifier hs-type">genSwitch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Switch.html#SwitchTargets"><span class="hs-identifier hs-type">SwitchTargets</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-276"></span><span id="genSwitch"><span class="annot"><span class="annottext">genSwitch :: NCGConfig -&gt; CmmExpr -&gt; SwitchTargets -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genSwitch"><span class="hs-identifier hs-var hs-var">genSwitch</span></a></span></span><span> </span><span id="local-6989586621682860741"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860741"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682860742"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860742"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682860743"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682860743"><span class="hs-identifier hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682860744"><span class="annot"><a href="#local-6989586621682860744"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860745"><span class="annot"><a href="#local-6989586621682860745"><span class="hs-identifier hs-var">fmt1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860746"><span class="annot"><a href="#local-6989586621682860746"><span class="hs-identifier hs-var">e_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860748"><span class="hs-identifier hs-var">indexExpr</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860749"><span class="annot"><a href="#local-6989586621682860749"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621682860751"><span class="annot"><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860749"><span class="hs-identifier hs-type">fmt</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621682860752"><span class="annot"><a href="#local-6989586621682860752"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewLabelNat"><span class="hs-identifier hs-type">getNewLabelNat</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621682860753"><span class="annot"><a href="#local-6989586621682860753"><span class="hs-identifier hs-var">dynRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860741"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#DataReference"><span class="hs-identifier hs-type">DataReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860752"><span class="hs-identifier hs-type">lbl</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682860756"><span class="annot"><a href="#local-6989586621682860756"><span class="hs-identifier hs-var">tableReg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860757"><span class="annot"><a href="#local-6989586621682860757"><span class="hs-identifier hs-var">fmt2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860758"><span class="annot"><a href="#local-6989586621682860758"><span class="hs-identifier hs-var">t_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860753"><span class="hs-identifier hs-type">dynRef</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860759"><span class="annot"><a href="#local-6989586621682860759"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-285"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;indexExpr&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc) -&gt; (CmmExpr -&gt; [Char]) -&gt; CmmExpr -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860748"><span class="hs-identifier hs-var">indexExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;dynRef&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc) -&gt; (CmmExpr -&gt; [Char]) -&gt; CmmExpr -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860753"><span class="hs-identifier hs-var">dynRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860746"><span class="hs-identifier hs-var">e_code</span></a></span><span>
</span><span id="line-289"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860758"><span class="hs-identifier hs-var">t_code</span></a></span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-291"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; SDoc
forall doc. IsLine doc =&gt; FastString -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;Jump table for switch&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>              </span><span class="hs-comment">-- index to offset into the table (relative to tableReg)</span><span>
</span><span id="line-293"></span><span>              </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860742"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860745"><span class="hs-identifier hs-var">fmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860744"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860745"><span class="hs-identifier hs-var">fmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860744"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>              </span><span class="hs-comment">-- calculate table entry address</span><span>
</span><span id="line-295"></span><span>              </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860745"><span class="hs-identifier hs-var">fmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860744"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860757"><span class="hs-identifier hs-var">fmt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860756"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>              </span><span class="hs-comment">-- load table entry (relative offset from tableReg (first entry) to target label)</span><span>
</span><span id="line-297"></span><span>              </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDRU"><span class="hs-identifier hs-var">LDRU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-var">AddrRegImm</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>              </span><span class="hs-comment">-- calculate absolute address of the target label</span><span>
</span><span id="line-299"></span><span>              </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860756"><span class="hs-identifier hs-var">tableReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>              </span><span class="hs-comment">-- prepare jump to target label</span><span>
</span><span id="line-301"></span><span>              </span><span class="annot"><span class="annottext">[Maybe BlockId] -&gt; Maybe CLabel -&gt; Reg -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#J_TBL"><span class="hs-identifier hs-var">J_TBL</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe BlockId]
</span><a href="#local-6989586621682860775"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Maybe CLabel
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860752"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860751"><span class="hs-identifier hs-var">targetReg</span></a></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682860759"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- See Note [Sub-word subtlety during jump-table indexing] in</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- GHC.CmmToAsm.X86.CodeGen for why we must first offset, then widen.</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621682860776"><span class="annot"><span class="annottext">indexExpr0 :: CmmExpr
</span><a href="#local-6989586621682860776"><span class="hs-identifier hs-var hs-var">indexExpr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Int -&gt; CmmExpr
</span><a href="GHC.Cmm.Utils.html#cmmOffset"><span class="hs-identifier hs-var">cmmOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860778"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860742"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682860779"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- We widen to a native-width register to sanitize the high bits</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621682860748"><span class="annot"><span class="annottext">indexExpr :: CmmExpr
</span><a href="#local-6989586621682860748"><span class="hs-identifier hs-var hs-var">indexExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-var">MO_UU_Conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860782"><span class="hs-identifier hs-var">expr_w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#platformWordWidth"><span class="hs-identifier hs-var">platformWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860778"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860776"><span class="hs-identifier hs-var">indexExpr0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621682860782"><span class="annot"><span class="annottext">expr_w :: Width
</span><a href="#local-6989586621682860782"><span class="hs-identifier hs-var hs-var">expr_w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; Width
</span><a href="GHC.Cmm.Expr.html#cmmExprWidth"><span class="hs-identifier hs-var">cmmExprWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860778"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860742"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682860779"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682860779"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682860775"><span class="annot"><span class="annottext">[Maybe BlockId]
</span><a href="#local-6989586621682860775"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SwitchTargets -&gt; (Int, [Maybe BlockId])
</span><a href="GHC.Cmm.Switch.html#switchTargetsToTable"><span class="hs-identifier hs-var">switchTargetsToTable</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682860743"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621682860778"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682860778"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform
</span><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860741"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Generate jump table data (if required)</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- The idea is to emit one table entry per case. The entry is the relative</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- address of the block to jump to (relative to the table's first entry /</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- table's own label.) The calculation itself is done by the linker.</span><span>
</span><span id="line-322"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-type">generateJumpTableForInstr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatCmmDecl"><span class="hs-identifier hs-type">NatCmmDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="generateJumpTableForInstr"><span class="annot"><span class="annottext">generateJumpTableForInstr :: NCGConfig -&gt; Instr -&gt; Maybe (NatCmmDecl RawCmmStatics Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var hs-var">generateJumpTableForInstr</span></a></span></span><span> </span><span id="local-6989586621682860786"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860786"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#J_TBL"><span class="hs-identifier hs-type">J_TBL</span></a></span><span> </span><span id="local-6989586621682860787"><span class="annot"><span class="annottext">[Maybe BlockId]
</span><a href="#local-6989586621682860787"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682860788"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860788"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682860789"><span class="annot"><span class="annottext">jumpTable :: [CmmStatic]
</span><a href="#local-6989586621682860789"><span class="hs-identifier hs-var hs-var">jumpTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">(Maybe BlockId -&gt; CmmStatic) -&gt; [Maybe BlockId] -&gt; [CmmStatic]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Maybe BlockId -&gt; CmmStatic
</span><a href="#local-6989586621682860790"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe BlockId]
</span><a href="#local-6989586621682860787"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>          </span><span id="local-6989586621682860790"><span class="annot"><span class="annottext">jumpTableEntryRel :: Maybe BlockId -&gt; CmmStatic
</span><a href="#local-6989586621682860790"><span class="hs-identifier hs-var hs-var">jumpTableEntryRel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe BlockId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860786"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>          </span><span class="annot"><a href="#local-6989586621682860790"><span class="hs-identifier hs-var">jumpTableEntryRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682860794"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860794"><span class="hs-identifier hs-var">blockid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmStatic
</span><a href="GHC.Cmm.html#CmmStaticLit"><span class="hs-identifier hs-var">CmmStaticLit</span></a></span><span>
</span><span id="line-334"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; CLabel -&gt; Int -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-var">CmmLabelDiffOff</span></a></span><span>
</span><span id="line-335"></span><span>                  </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860796"><span class="hs-identifier hs-var">blockLabel</span></a></span><span>
</span><span id="line-336"></span><span>                  </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860788"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-337"></span><span>                  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-338"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NCGConfig -&gt; Width
</span><a href="GHC.CmmToAsm.Config.html#ncgWordWidth"><span class="hs-identifier hs-var">ncgWordWidth</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860786"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>              </span><span id="local-6989586621682860796"><span class="annot"><span class="annottext">blockLabel :: CLabel
</span><a href="#local-6989586621682860796"><span class="hs-identifier hs-var hs-var">blockLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860794"><span class="hs-identifier hs-var">blockid</span></a></span><span>
</span><span id="line-342"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NatCmmDecl RawCmmStatics Instr
-&gt; Maybe (NatCmmDecl RawCmmStatics Instr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Section -&gt; RawCmmStatics -&gt; NatCmmDecl RawCmmStatics Instr
forall d h g. Section -&gt; d -&gt; GenCmmDecl d h g
</span><a href="GHC.Cmm.html#CmmData"><span class="hs-identifier hs-var">CmmData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SectionType -&gt; CLabel -&gt; Section
</span><a href="GHC.Cmm.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">SectionType
</span><a href="GHC.Cmm.html#ReadOnlyData"><span class="hs-identifier hs-var">ReadOnlyData</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860788"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; [CmmStatic] -&gt; RawCmmStatics
forall (rawOnly :: Bool).
CLabel -&gt; [CmmStatic] -&gt; GenCmmStatics rawOnly
</span><a href="GHC.Cmm.html#CmmStaticsRaw"><span class="hs-identifier hs-var">CmmStaticsRaw</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682860788"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmStatic]
</span><a href="#local-6989586621682860789"><span class="hs-identifier hs-var">jumpTable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#generateJumpTableForInstr"><span class="hs-identifier hs-var">generateJumpTableForInstr</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NatCmmDecl RawCmmStatics Instr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- Top-level of the instruction selector</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-type">stmtsToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Cmm Statements</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Block.html#O"><span class="hs-identifier hs-type">O</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Resulting instruction</span></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-353"></span><span id="stmtsToInstrs"><span class="annot"><span class="annottext">stmtsToInstrs :: [CmmNode O O] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtsToInstrs"><span class="hs-identifier hs-var hs-var">stmtsToInstrs</span></a></span></span><span> </span><span id="local-6989586621682860801"><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682860801"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OrdList Instr] -&gt; OrdList Instr
forall a. [OrdList a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#concatOL"><span class="hs-identifier hs-var">concatOL</span></a></span><span> </span><span class="annot"><span class="annottext">([OrdList Instr] -&gt; OrdList Instr)
-&gt; NatM [OrdList Instr] -&gt; NatM (OrdList Instr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CmmNode O O -&gt; NatM (OrdList Instr))
-&gt; [CmmNode O O] -&gt; NatM [OrdList Instr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CmmNode O O -&gt; NatM (OrdList Instr)
forall (e :: Extensibility) (x :: Extensibility).
CmmNode e x -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var">stmtToInstrs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmNode O O]
</span><a href="#local-6989586621682860801"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span id="local-6989586621682859620"><span id="local-6989586621682859621"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-type">stmtToInstrs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmNode"><span class="hs-identifier hs-type">CmmNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859620"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859621"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Resulting instructions</span></span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span></span><span>
</span><span id="line-359"></span><span id="stmtToInstrs"><span class="annot"><span class="annottext">stmtToInstrs :: forall (e :: Extensibility) (x :: Extensibility).
CmmNode e x -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#stmtToInstrs"><span class="hs-identifier hs-var hs-var">stmtToInstrs</span></a></span></span><span> </span><span id="local-6989586621682860807"><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682860807"><span class="hs-identifier hs-var">stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621682860808"><span class="annot"><a href="#local-6989586621682860808"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621682860809"><span class="annot"><a href="#local-6989586621682860809"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682860807"><span class="hs-identifier hs-type">stmt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnsafeForeignCall"><span class="hs-identifier hs-type">CmmUnsafeForeignCall</span></a></span><span> </span><span id="local-6989586621682860813"><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682860813"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682860814"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682860814"><span class="hs-identifier hs-var">result_regs</span></a></span></span><span> </span><span id="local-6989586621682860815"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682860815"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="annottext">ForeignTarget -&gt; [CmmFormal] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCCall"><span class="hs-identifier hs-var">genCCall</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignTarget
</span><a href="#local-6989586621682860813"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682860814"><span class="hs-identifier hs-var">result_regs</span></a></span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682860815"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmComment"><span class="hs-identifier hs-type">CmmComment</span></a></span><span> </span><span id="local-6989586621682860822"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682860822"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; SDoc
forall doc. IsLine doc =&gt; FastString -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682860822"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmTick"><span class="hs-identifier hs-type">CmmTick</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmAssign"><span class="hs-identifier hs-type">CmmAssign</span></a></span><span> </span><span id="local-6989586621682860830"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682860830"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682860831"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860831"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860833"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var">assignReg_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860835"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682860830"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860831"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860835"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682860830"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860831"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621682860833"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682860833"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682860830"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-372"></span><span>        </span><span id="local-6989586621682860835"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682860835"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860833"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmStore"><span class="hs-identifier hs-type">CmmStore</span></a></span><span> </span><span id="local-6989586621682860842"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860842"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682860843"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860843"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621682860844"><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="#local-6989586621682860844"><span class="hs-identifier hs-var">_alignment</span></a></span></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Bool
</span><a href="GHC.Cmm.Type.html#isFloatType"><span class="hs-identifier hs-var">isFloatType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860845"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var">assignMem_FltCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860847"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860842"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860843"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860847"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860842"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860843"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>        </span><span id="local-6989586621682860845"><span class="annot"><span class="annottext">ty :: CmmType
</span><a href="#local-6989586621682860845"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmExprType"><span class="hs-identifier hs-var">cmmExprType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860809"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860843"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621682860847"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682860847"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860845"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmBranch"><span class="hs-identifier hs-type">CmmBranch</span></a></span><span> </span><span id="local-6989586621682860853"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860853"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860853"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-comment">-- We try to arrange blocks such that the likely branch is the fallthrough</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-comment">-- in GHC.Cmm.ContFlowOpt. So we can assume the condition is likely false here.</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCondBranch"><span class="hs-identifier hs-type">CmmCondBranch</span></a></span><span> </span><span id="local-6989586621682860858"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860858"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682860859"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860859"><span class="hs-identifier hs-var">true</span></a></span></span><span> </span><span id="local-6989586621682860860"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860860"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682860861"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621682860861"><span class="hs-identifier hs-var">_prediction</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var">genCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860859"><span class="hs-identifier hs-var">true</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682860860"><span class="hs-identifier hs-var">false</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860858"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmSwitch"><span class="hs-identifier hs-type">CmmSwitch</span></a></span><span> </span><span id="local-6989586621682860866"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860866"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682860867"><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682860867"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; CmmExpr -&gt; SwitchTargets -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genSwitch"><span class="hs-identifier hs-var">genSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860808"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860866"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">SwitchTargets
</span><a href="#local-6989586621682860867"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmCall"><span class="hs-identifier hs-type">CmmCall</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cml_target :: CmmNode O C -&gt; CmmExpr
</span><a href="GHC.Cmm.Node.html#cml_target"><span class="hs-identifier hs-var">cml_target</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682860872"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860872"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genJump"><span class="hs-identifier hs-var">genJump</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860872"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmUnwind"><span class="hs-identifier hs-type">CmmUnwind</span></a></span><span> </span><span id="local-6989586621682860878"><span class="annot"><span class="annottext">[(GlobalReg, Maybe CmmExpr)]
</span><a href="#local-6989586621682860878"><span class="hs-identifier hs-var">_regs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-comment">-- Intentionally not have a default case here: If anybody adds a</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-comment">-- constructor, the compiler should force them to think about this here.</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmForeignCall"><span class="hs-identifier hs-type">CmmForeignCall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;stmtToInstrs: statement should have been cps'd away&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmNode e x -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860809"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682860807"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Node.html#CmmEntry"><span class="hs-identifier hs-type">CmmEntry</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;stmtToInstrs: statement should have been cps'd away&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmNode e x -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860809"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmNode e x
</span><a href="#local-6989586621682860807"><span class="hs-identifier hs-var">stmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">-- | 'InstrBlock's are the insn sequences generated by the insn selectors.</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- They are really trees of insns to facilitate fast appending, where a</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- left-to-right traversal yields the insns in the correct order.</span><span>
</span><span id="line-398"></span><span class="hs-keyword">type</span><span> </span><span id="InstrBlock"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-var">InstrBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Register's passed up the tree.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- If the stix code forces the register to live in a pre-decided machine</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- register, it comes out as @Fixed@; otherwise, it comes out as @Any@, and the</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- parent can decide which register to put it in.</span><span>
</span><span id="line-406"></span><span class="hs-keyword">data</span><span> </span><span id="Register"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-var">Register</span></a></span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Fixed"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Any"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- | Sometimes we need to change the Format of a register. Primarily during</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- conversion.</span><span>
</span><span id="line-412"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-type">swizzleRegisterRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-413"></span><span id="swizzleRegisterRep"><span class="annot"><span class="annottext">swizzleRegisterRep :: Format -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var hs-var">swizzleRegisterRep</span></a></span></span><span> </span><span id="local-6989586621682860898"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860898"><span class="hs-identifier hs-var">format'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682860899"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860899"><span class="hs-identifier hs-var">_format</span></a></span></span><span> </span><span id="local-6989586621682860900"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860900"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682860901"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860901"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860898"><span class="hs-identifier hs-var">format'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860900"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860901"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-414"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var">swizzleRegisterRep</span></a></span><span> </span><span id="local-6989586621682860902"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860902"><span class="hs-identifier hs-var">format'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682860903"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860903"><span class="hs-identifier hs-var">_format</span></a></span></span><span> </span><span id="local-6989586621682860904"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860904"><span class="hs-identifier hs-var">codefn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860902"><span class="hs-identifier hs-var">format'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860904"><span class="hs-identifier hs-var">codefn</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Grab a `Reg` for a `CmmReg`</span><span>
</span><span id="line-417"></span><span class="hs-comment">--</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- `LocalReg`s are assigned virtual registers (`RegVirtual`), `GlobalReg`s are</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- assigned real registers (`RegReal`). It is an error if a `GlobalReg` is not a</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- STG register.</span><span>
</span><span id="line-421"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-type">getRegisterReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span>
</span><span id="line-422"></span><span id="getRegisterReg"><span class="annot"><span class="annottext">getRegisterReg :: Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var hs-var">getRegisterReg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-type">CmmLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span> </span><span id="local-6989586621682860912"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682860912"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682860913"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860913"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">VirtualReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegVirtual"><span class="hs-identifier hs-var">RegVirtual</span></a></span><span> </span><span class="annot"><span class="annottext">(VirtualReg -&gt; Reg) -&gt; VirtualReg -&gt; Reg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Format -&gt; VirtualReg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#mkVirtualReg"><span class="hs-identifier hs-var">mkVirtualReg</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682860912"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682860913"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span id="local-6989586621682860915"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860915"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span id="local-6989586621682860917"><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682860917"><span class="hs-identifier hs-var">mid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; GlobalReg -&gt; Maybe RealReg
</span><a href="GHC.Platform.Regs.html#globalRegMaybe"><span class="hs-identifier hs-var">globalRegMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860915"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRegUse -&gt; GlobalReg
</span><a href="GHC.Cmm.Reg.html#globalRegUse_reg"><span class="hs-identifier hs-var">globalRegUse_reg</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682860917"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682860920"><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682860920"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RealReg -&gt; Reg
</span><a href="GHC.Platform.Reg.html#RegReal"><span class="hs-identifier hs-var">RegReal</span></a></span><span> </span><span class="annot"><span class="annottext">RealReg
</span><a href="#local-6989586621682860920"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">Maybe RealReg
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; Reg
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegisterReg-memory&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmReg -&gt; SDoc) -&gt; CmmReg -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-var">CmmGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682860917"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- General things for putting together code sequences</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><span class="hs-comment">-- | Compute an expression into any register</span></span><span>
</span><span id="line-433"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="getSomeReg"><span class="annot"><span class="annottext">getSomeReg :: CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var hs-var">getSomeReg</span></a></span></span><span> </span><span id="local-6989586621682860922"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860922"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621682860923"><span class="annot"><a href="#local-6989586621682860923"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860922"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682860923"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682860925"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860925"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682860926"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860926"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621682860927"><span class="annot"><a href="#local-6989586621682860927"><span class="hs-identifier hs-var">newReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860925"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682860927"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860925"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860926"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860927"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682860928"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860928"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682860929"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860929"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682860930"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860930"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">(Reg, Format, OrdList Instr) -&gt; NatM (Reg, Format, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860929"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860928"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860930"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Compute an expression into any floating-point register</span><span>
</span><span id="line-444"></span><span class="hs-comment">--</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- If the initial expression is not a floating-point expression, finally move</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- the result into a floating-point register.</span><span>
</span><span id="line-447"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span id="getFloatReg"><span class="annot"><span class="annottext">getFloatReg :: HasCallStack =&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-var hs-var">getFloatReg</span></a></span></span><span> </span><span id="local-6989586621682860945"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860945"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621682860946"><span class="annot"><a href="#local-6989586621682860946"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860945"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682860946"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682860947"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860947"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682860948"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860948"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860947"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>      </span><span id="local-6989586621682860950"><span class="annot"><a href="#local-6989586621682860950"><span class="hs-identifier hs-var">newReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860947"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682860950"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860947"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860948"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860950"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II32"><span class="hs-identifier hs-var">II32</span></a></span><span> </span><span id="local-6989586621682860952"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860952"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621682860953"><span class="annot"><a href="#local-6989586621682860953"><span class="hs-identifier hs-var">newReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-var">FF32</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682860953"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF32"><span class="hs-identifier hs-type">FF32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860952"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860953"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span id="local-6989586621682860955"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860955"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>      </span><span id="local-6989586621682860956"><span class="annot"><a href="#local-6989586621682860956"><span class="hs-identifier hs-var">newReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-var">FF64</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682860956"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#FF64"><span class="hs-identifier hs-type">FF64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682860955"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860956"><span class="hs-identifier hs-type">newReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682860958"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860958"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span id="local-6989586621682860959"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682860959"><span class="hs-identifier hs-var">_code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>      </span><span id="local-6989586621682860960"><span class="annot"><a href="#local-6989586621682860960"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;can't do getFloatReg on&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860960"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682860945"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-comment">-- can't do much for fixed.</span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682860961"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860961"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682860962"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860962"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682860963"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860963"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">(Reg, Format, OrdList Instr) -&gt; NatM (Reg, Format, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682860962"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682860961"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682860963"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">-- | Map `CmmLit` to `OpImm`</span><span>
</span><span id="line-468"></span><span class="hs-comment">--</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- N.B. this is a partial function, because not all `CmmLit`s have an immediate</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- representation.</span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#litToImm%27"><span class="hs-identifier hs-type">litToImm'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span>
</span><span id="line-472"></span><span id="litToImm%27"><span class="annot"><span class="annottext">litToImm' :: CmmLit -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#litToImm%27"><span class="hs-identifier hs-var hs-var">litToImm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; (CmmLit -&gt; Imm) -&gt; CmmLit -&gt; Operand
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#litToImm"><span class="hs-identifier hs-var">litToImm</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="annot"><span class="hs-comment">-- | Compute a `CmmExpr` into a `Register`</span></span><span>
</span><span id="line-475"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-476"></span><span id="getRegister"><span class="annot"><span class="annottext">getRegister :: CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-var hs-var">getRegister</span></a></span></span><span> </span><span id="local-6989586621682860967"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860967"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621682860968"><span class="annot"><a href="#local-6989586621682860968"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860968"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Config.html#ncgPlatform"><span class="hs-identifier hs-var">ncgPlatform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682860968"><span class="hs-identifier hs-type">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682860967"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | The register width to be used for an operation on the given width</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- operand.</span><span>
</span><span id="line-482"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-type">opRegWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span>
</span><span id="line-483"></span><span id="opRegWidth"><span class="annot"><span class="annottext">opRegWidth :: Width -&gt; Width
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var hs-var">opRegWidth</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-484"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-485"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-486"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-487"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span id="local-6989586621682860974"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860974"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; Width
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;opRegWidth&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unsupported width&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860974"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- Note [Signed arithmetic on RISCV64]</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- Handling signed arithmetic on sub-word-size values on RISCV64 is a bit</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- tricky as Cmm's type system does not capture signedness. While 32-bit values</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- are fairly easy to handle due to RISCV64's 32-bit instruction variants</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- (denoted by use of %wN registers), 16- and 8-bit values require quite some</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- care.</span><span>
</span><span id="line-496"></span><span class="hs-comment">--</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- We handle 16-and 8-bit values by using the 32-bit operations and</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- sign-/zero-extending operands and truncate results as necessary. For</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- simplicity we maintain the invariant that a register containing a</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- sub-word-size value always contains the zero-extended form of that value</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- in between operations.</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- For instance, consider the program,</span><span>
</span><span id="line-504"></span><span class="hs-comment">--</span><span>
</span><span id="line-505"></span><span class="hs-comment">--    test(bits64 buffer)</span><span>
</span><span id="line-506"></span><span class="hs-comment">--      bits8 a = bits8[buffer];</span><span>
</span><span id="line-507"></span><span class="hs-comment">--      bits8 b = %mul(a, 42);</span><span>
</span><span id="line-508"></span><span class="hs-comment">--      bits8 c = %not(b);</span><span>
</span><span id="line-509"></span><span class="hs-comment">--      bits8 d = %shrl(c, 4::bits8);</span><span>
</span><span id="line-510"></span><span class="hs-comment">--      return (d);</span><span>
</span><span id="line-511"></span><span class="hs-comment">--    }</span><span>
</span><span id="line-512"></span><span class="hs-comment">--</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- This program begins by loading `a` from memory, for which we use a</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- zero-extended byte-size load.  We next sign-extend `a` to 32-bits, and use a</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- 32-bit multiplication to compute `b`, and truncate the result back down to</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- 8-bits.</span><span>
</span><span id="line-517"></span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- Next we compute `c`: The `%not` requires no extension of its operands, but</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- we must still truncate the result back down to 8-bits. Finally the `%shrl`</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- requires no extension and no truncate since we can assume that</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- `c` is zero-extended.</span><span>
</span><span id="line-522"></span><span class="hs-comment">--</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- The &quot;RISC-V Sign Extension Optimizations&quot; LLVM tech talk presentation by</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- Craig Topper covers possible future improvements</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- (https://llvm.org/devmtg/2022-11/slides/TechTalk21-RISC-VSignExtensionOptimizations.pdf)</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- Note [Handling PIC on RV64]</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- RV64 does not have a special PIC register, the general approach is to simply</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- do PC-relative addressing or go through the GOT. There is assembly support</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- for both.</span><span>
</span><span id="line-533"></span><span class="hs-comment">--</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- rv64 assembly has a `la` (load address) pseudo-instruction, that allows</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- loading a label's address into a register. The instruction is desugared into</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- different addressing modes, e.g. PC-relative addressing:</span><span>
</span><span id="line-537"></span><span class="hs-comment">--</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- 1: lui  rd1, %pcrel_hi(label)</span><span>
</span><span id="line-539"></span><span class="hs-comment">--    addi rd1, %pcrel_lo(1b)</span><span>
</span><span id="line-540"></span><span class="hs-comment">--</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- See https://sourceware.org/binutils/docs/as/RISC_002dV_002dModifiers.html,</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- PIC can be enabled/disabled through</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">--  .option pic</span><span>
</span><span id="line-545"></span><span class="hs-comment">--</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- See https://sourceware.org/binutils/docs/as/RISC_002dV_002dDirectives.html#RISC_002dV_002dDirectives</span><span>
</span><span id="line-547"></span><span class="hs-comment">--</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- CmmGlobal @PicBaseReg@'s are generated in @GHC.CmmToAsm.PIC@ in the</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- @cmmMakePicReference@.  This is in turn called from @cmmMakeDynamicReference@</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- also in @Cmm.CmmToAsm.PIC@ from where it is also exported.  There are two</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- callsites for this. One is in this module to produce the @target@ in @genCCall@</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- the other is in @GHC.CmmToAsm@ in @cmmExprNative@.</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- Conceptually we do not want any special PicBaseReg to be used on RV64. If</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- we want to distinguish between symbol loading, we need to address this through</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- the way we load it, not through a register.</span><span>
</span><span id="line-557"></span><span class="hs-comment">--</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-type">getRegister'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Config.html#NCGConfig"><span class="hs-identifier hs-type">NCGConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-560"></span><span class="hs-comment">-- OPTIMIZATION WARNING: CmmExpr rewrites</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- 1. Rewrite: Reg + (-n) =&gt; Reg - n</span><span>
</span><span id="line-562"></span><span class="hs-comment">--    TODO: this expression shouldn't even be generated to begin with.</span><span>
</span><span id="line-563"></span><span id="getRegister%27"><span class="annot"><span class="annottext">getRegister' :: NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var hs-var">getRegister'</span></a></span></span><span> </span><span id="local-6989586621682860975"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860975"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682860976"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860976"><span class="hs-identifier hs-var">plat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682860978"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860978"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682860979"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860979"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682860980"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860980"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682860981"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860981"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860980"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860975"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860976"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-var">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860978"><span class="hs-identifier hs-var">w0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860979"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860980"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860981"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682860984"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860984"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682860985"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860985"><span class="hs-identifier hs-var">plat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682860986"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860986"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682860987"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860987"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682860988"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860988"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682860989"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860989"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860988"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860984"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860985"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860986"><span class="hs-identifier hs-var">w0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860987"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860988"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860989"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- Generic case.</span><span>
</span><span id="line-570"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span id="local-6989586621682860990"><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860990"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621682860991"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span></span><span> </span><span id="local-6989586621682860992"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalRegUse"><span class="hs-identifier hs-type">GlobalRegUse</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-573"></span><span>      </span><span class="hs-comment">-- See Note [Handling PIC on RV64]</span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister': There's no PIC base register on RISCV&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalReg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="GHC.Cmm.Reg.html#PicBaseReg"><span class="hs-identifier hs-var">PicBaseReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span id="local-6989586621682860995"><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-577"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682860996"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860996"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682860996"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#zeroReg"><span class="hs-identifier hs-var">zeroReg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-578"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682860999"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860999"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682861000"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861000"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-579"></span><span>          </span><span class="hs-comment">-- narrowU is important: Negative immediates may be</span><span>
</span><span id="line-580"></span><span>          </span><span class="hs-comment">-- sign-extended on load!</span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861001"><span class="annot"><span class="annottext">imm :: Operand
</span><a href="#local-6989586621682861001"><span class="hs-identifier hs-var hs-var">imm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; (Integer -&gt; Imm) -&gt; Integer -&gt; Operand
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Operand) -&gt; Integer -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Integer -&gt; Integer
</span><a href="GHC.Cmm.Type.html#narrowU"><span class="hs-identifier hs-var">narrowU</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861000"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682860999"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-582"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861000"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861004"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861004"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861000"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861004"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861001"><span class="hs-identifier hs-var">imm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682861007"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861007"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-584"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861008"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682861008"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#litToImm%27"><span class="hs-identifier hs-var">litToImm'</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-585"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861007"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861010"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861010"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861007"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861010"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861008"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682861011"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861011"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmFloat), no support for bytes&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682861012"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861012"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmFloat), no support for halfs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682861013"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861013"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861014"><span class="annot"><span class="annottext">word :: Word32
</span><a href="#local-6989586621682861014"><span class="hs-identifier hs-var hs-var hs-var">word</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><span class="hs-identifier hs-var">castFloatToWord32</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Float
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861013"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-590"></span><span>          </span><span id="local-6989586621682861016"><span class="annot"><a href="#local-6989586621682861016"><span class="hs-identifier hs-var">intReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-592"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-593"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-type">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861017"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861017"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-595"></span><span>                    </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-596"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-597"></span><span>                          </span><span class="annot"><span class="annottext">(Instr -&gt; Instr) -&gt; Instr -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861016"><span class="hs-identifier hs-var">intReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682861014"><span class="hs-identifier hs-var">word</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-598"></span><span>                        </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861017"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861016"><span class="hs-identifier hs-var">intReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-600"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682861018"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861018"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-603"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861019"><span class="annot"><span class="annottext">word :: Word64
</span><a href="#local-6989586621682861019"><span class="hs-identifier hs-var hs-var hs-var">word</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Word64
</span><span class="hs-identifier hs-var">castDoubleToWord64</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861018"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-604"></span><span>          </span><span id="local-6989586621682861021"><span class="annot"><a href="#local-6989586621682861021"><span class="hs-identifier hs-var">intReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-606"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-607"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861022"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861022"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>                    </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-610"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-611"></span><span>                          </span><span class="annot"><span class="annottext">(Instr -&gt; Instr) -&gt; Instr -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861021"><span class="hs-identifier hs-var">intReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682861019"><span class="hs-identifier hs-var">word</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-612"></span><span>                        </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861022"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861021"><span class="hs-identifier hs-var">intReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmFloat"><span class="hs-identifier hs-type">CmmFloat</span></a></span><span> </span><span id="local-6989586621682861023"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682861023"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span id="local-6989586621682861024"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861024"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmFloat), unsupported float lit&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmVec"><span class="hs-identifier hs-type">CmmVec</span></a></span><span> </span><span id="local-6989586621682861026"><span class="annot"><span class="annottext">[CmmLit]
</span><a href="#local-6989586621682861026"><span class="hs-identifier hs-var">_lits</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmVec): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-type">CmmLabel</span></a></span><span> </span><span id="local-6989586621682861028"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861028"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861029"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682861029"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861028"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>              </span><span id="local-6989586621682861031"><span class="annot"><span class="annottext">rep :: CmmType
</span><a href="#local-6989586621682861031"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-621"></span><span>              </span><span id="local-6989586621682861033"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682861033"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861031"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-622"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861033"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861034"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861034"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861033"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861033"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861034"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861029"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span id="local-6989586621682861037"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861037"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682861038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861038"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621682861039"><span class="hs-identifier hs-var">isNbitEncodeable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861038"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861040"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682861040"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmIndex"><span class="hs-identifier hs-var">ImmIndex</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861037"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861038"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>              </span><span id="local-6989586621682861042"><span class="annot"><span class="annottext">rep :: CmmType
</span><a href="#local-6989586621682861042"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-626"></span><span>              </span><span id="local-6989586621682861043"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682861043"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861042"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-627"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861043"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861044"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861044"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861043"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861043"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861044"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861040"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelOff"><span class="hs-identifier hs-type">CmmLabelOff</span></a></span><span> </span><span id="local-6989586621682861045"><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861045"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682861046"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861046"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861047"><span class="annot"><span class="annottext">op :: Operand
</span><a href="#local-6989586621682861047"><span class="hs-identifier hs-var hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#litToImm%27"><span class="hs-identifier hs-var">litToImm'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmLabel"><span class="hs-identifier hs-var">CmmLabel</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="#local-6989586621682861045"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>              </span><span id="local-6989586621682861048"><span class="annot"><span class="annottext">rep :: CmmType
</span><a href="#local-6989586621682861048"><span class="hs-identifier hs-var hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmLit -&gt; CmmType
</span><a href="GHC.Cmm.Expr.html#cmmLitType"><span class="hs-identifier hs-var">cmmLitType</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmLit
</span><a href="#local-6989586621682860995"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-631"></span><span>              </span><span id="local-6989586621682861049"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682861049"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861048"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-632"></span><span>              </span><span id="local-6989586621682861050"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682861050"><span class="hs-identifier hs-var hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861048"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861052"><span class="annot"><a href="#local-6989586621682861052"><span class="hs-identifier hs-var">off_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861053"><span class="annot"><a href="#local-6989586621682861053"><span class="hs-identifier hs-var">_off_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861054"><span class="annot"><a href="#local-6989586621682861054"><span class="hs-identifier hs-var">off_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM (Reg, Format, OrdList Instr))
-&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861046"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861050"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-635"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-636"></span><span>                </span><span class="annot"><a href="#local-6989586621682861049"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-637"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861055"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861055"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-638"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861054"><span class="hs-identifier hs-var">off_code</span></a></span><span>
</span><span id="line-639"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861049"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861049"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861055"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861047"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-640"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861050"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861055"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861050"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861055"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861050"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861052"><span class="hs-identifier hs-var">off_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLabelDiffOff"><span class="hs-identifier hs-type">CmmLabelDiffOff</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmLabelOff): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmBlock"><span class="hs-identifier hs-type">CmmBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmLabelOff): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>        </span><span class="annot"><span class="annottext">CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmHighStackMark"><span class="hs-identifier hs-var">CmmHighStackMark</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmLit:CmmLabelOff): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-type">CmmLoad</span></a></span><span> </span><span id="local-6989586621682861060"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861060"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621682861061"><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861061"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861062"><span class="annot"><span class="annottext">format :: Format
</span><a href="#local-6989586621682861062"><span class="hs-identifier hs-var hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861061"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-648"></span><span>          </span><span id="local-6989586621682861063"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682861063"><span class="hs-identifier hs-var hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682861061"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-649"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682861065"><span class="annot"><a href="#local-6989586621682861065"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682861066"><span class="annot"><a href="#local-6989586621682861066"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Width -&gt; CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861063"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861060"><span class="hs-identifier hs-var">mem</span></a></span><span>
</span><span id="line-650"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861063"><span class="hs-identifier hs-type">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-651"></span><span>        </span><span id="local-6989586621682861068"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861068"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-652"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861068"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-comment">-- Load without sign-extension. See Note [Signed arithmetic on RISCV64]</span><span>
</span><span id="line-654"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-655"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-656"></span><span>                    </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861062"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-657"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861070"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861070"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-658"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861066"><span class="hs-identifier hs-var">addr_code</span></a></span><span>
</span><span id="line-659"></span><span>                          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDRU"><span class="hs-identifier hs-var">LDRU</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861062"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861063"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861070"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrMode
</span><a href="#local-6989586621682861065"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Width too big! Cannot load: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861063"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmStackSlot"><span class="hs-identifier hs-type">CmmStackSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Area
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (CmmStackSlot): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682861072"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861072"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span>
</span><span id="line-669"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861072"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861072"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682861074"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861074"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861075"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861075"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621682861039"><span class="hs-identifier hs-var">isNbitEncodeable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861075"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-674"></span><span>      </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860990"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM Register) -&gt; CmmExpr -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [CmmExpr] -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-var">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; MachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-var">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861076"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-var">CmmReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861074"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861075"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861076"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-677"></span><span>        </span><span id="local-6989586621682861076"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682861076"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861074"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682861077"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861077"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861078"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861078"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861079"><span class="annot"><a href="#local-6989586621682861079"><span class="hs-identifier hs-var">off_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861080"><span class="annot"><a href="#local-6989586621682861080"><span class="hs-identifier hs-var">_off_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861081"><span class="annot"><a href="#local-6989586621682861081"><span class="hs-identifier hs-var">off_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">(CmmExpr -&gt; NatM (Reg, Format, OrdList Instr))
-&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmLit -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-var">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Width -&gt; CmmLit
</span><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-var">CmmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861078"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861082"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861083"><span class="annot"><a href="#local-6989586621682861083"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861084"><span class="annot"><a href="#local-6989586621682861084"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861085"><span class="annot"><a href="#local-6989586621682861085"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861077"><span class="hs-identifier hs-type">reg</span></a></span><span>
</span><span id="line-681"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-683"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861082"><span class="hs-identifier hs-type">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861086"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861086"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-685"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861081"><span class="hs-identifier hs-var">off_code</span></a></span><span>
</span><span id="line-686"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861085"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-687"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861082"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861086"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861082"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861083"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861082"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861079"><span class="hs-identifier hs-var">off_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>        </span><span id="local-6989586621682861082"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682861082"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Width
</span><a href="GHC.Cmm.Type.html#typeWidth"><span class="hs-identifier hs-var">typeWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861077"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-comment">-- Handle MO_RelaxedRead as a normal CmmLoad, to allow</span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-comment">-- non-trivial addressing modes to be used.</span><span>
</span><span id="line-694"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_RelaxedRead"><span class="hs-identifier hs-type">MO_RelaxedRead</span></a></span><span> </span><span id="local-6989586621682861088"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861088"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861089"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861089"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-695"></span><span>      </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; CmmType -&gt; AlignmentSpec -&gt; CmmExpr
</span><a href="GHC.Cmm.Expr.html#CmmLoad"><span class="hs-identifier hs-var">CmmLoad</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861089"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; CmmType
</span><a href="GHC.Cmm.Type.html#cmmBits"><span class="hs-identifier hs-var">cmmBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861088"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AlignmentSpec
</span><a href="GHC.Cmm.Expr.html#NaturallyAligned"><span class="hs-identifier hs-var">NaturallyAligned</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-comment">-- for MachOps, see GHC.Cmm.MachOp</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-comment">-- For CmmMachOp, see GHC.Cmm.Expr</span><span>
</span><span id="line-698"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682861092"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861092"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861093"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-699"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861094"><span class="annot"><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861095"><span class="annot"><a href="#local-6989586621682861095"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861096"><span class="annot"><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-700"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861092"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-701"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Not"><span class="hs-identifier hs-type">MO_Not</span></a></span><span> </span><span id="local-6989586621682861098"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861098"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861098"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; OrdList Instr) -&gt; Register)
-&gt; (Reg -&gt; OrdList Instr) -&gt; Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861099"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861099"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-702"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861100"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861100"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861098"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-703"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-704"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-705"></span><span>                </span><span class="hs-comment">-- pseudo instruction `not` is `xori rd, rs, -1`</span><span>
</span><span id="line-706"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;not&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#XORI"><span class="hs-identifier hs-var">XORI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861100"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861099"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861100"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861100"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861098"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861099"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-comment">-- See Note [Signed arithmetic on RISCV64]</span><span>
</span><span id="line-708"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Neg"><span class="hs-identifier hs-type">MO_S_Neg</span></a></span><span> </span><span id="local-6989586621682861104"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861104"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Width -&gt; Reg -&gt; NatM Register
</span><a href="#local-6989586621682861105"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861104"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Neg"><span class="hs-identifier hs-type">MO_F_Neg</span></a></span><span> </span><span id="local-6989586621682861107"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861107"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-710"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-711"></span><span>            </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-712"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861107"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861108"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861108"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-715"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#NEG"><span class="hs-identifier hs-var">NEG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861107"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861108"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861107"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-comment">-- TODO: Can this case happen?</span><span>
</span><span id="line-718"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SF_Round"><span class="hs-identifier hs-type">MO_SF_Round</span></a></span><span> </span><span id="local-6989586621682861111"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861111"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861112"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861112"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861111"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>          </span><span class="hs-comment">-- extend to the smallest available representation</span><span>
</span><span id="line-720"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861113"><span class="annot"><a href="#local-6989586621682861113"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861114"><span class="annot"><a href="#local-6989586621682861114"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-var">signExtendReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861111"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-721"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-722"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-723"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861112"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861116"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861116"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-725"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-726"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861114"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-727"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FcvtVariant -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-var">FCVT</span></a></span><span> </span><span class="annot"><span class="annottext">FcvtVariant
</span><a href="GHC.CmmToAsm.RV64.Instr.html#IntToFloat"><span class="hs-identifier hs-var">IntToFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861112"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861116"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861111"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861113"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Signed ConVerT Float)</span><span>
</span><span id="line-728"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SF_Round"><span class="hs-identifier hs-type">MO_SF_Round</span></a></span><span> </span><span id="local-6989586621682861119"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861119"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861120"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861120"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-730"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-731"></span><span>            </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-732"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861120"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861121"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861121"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-734"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-735"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FcvtVariant -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-var">FCVT</span></a></span><span> </span><span class="annot"><span class="annottext">FcvtVariant
</span><a href="GHC.CmmToAsm.RV64.Instr.html#IntToFloat"><span class="hs-identifier hs-var">IntToFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861120"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861121"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861119"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Signed ConVerT Float)</span><span>
</span><span id="line-736"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>        </span><span class="hs-comment">-- TODO: Can this case happen?</span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FS_Truncate"><span class="hs-identifier hs-type">MO_FS_Truncate</span></a></span><span> </span><span id="local-6989586621682861123"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861123"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861124"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861124"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-739"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861124"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-740"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-741"></span><span>                </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-742"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861124"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861125"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861125"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-744"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-745"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span>
</span><span id="line-746"></span><span>                        </span><span class="hs-comment">-- W32 is the smallest width to convert to. Decrease width afterwards.</span><span>
</span><span id="line-747"></span><span>                        </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FcvtVariant -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-var">FCVT</span></a></span><span> </span><span class="annot"><span class="annottext">FcvtVariant
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FloatToInt"><span class="hs-identifier hs-var">FloatToInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861125"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861123"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861124"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861125"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861125"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-comment">-- (float convert (-&gt; zero) signed)</span><span>
</span><span id="line-749"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FS_Truncate"><span class="hs-identifier hs-type">MO_FS_Truncate</span></a></span><span> </span><span id="local-6989586621682861128"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861128"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861129"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861129"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-751"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-752"></span><span>            </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-753"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861129"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861130"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861130"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-755"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-756"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FcvtVariant -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-var">FCVT</span></a></span><span> </span><span class="annot"><span class="annottext">FcvtVariant
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FloatToInt"><span class="hs-identifier hs-var">FloatToInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861129"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861130"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861128"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861128"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861129"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861130"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-comment">-- (float convert (-&gt; zero) signed)</span><span>
</span><span id="line-758"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span id="local-6989586621682861131"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861131"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861132"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861132"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-760"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861131"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861132"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-761"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-762"></span><span>                </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-763"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861132"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861133"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861133"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-765"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-766"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861132"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861133"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861131"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UU_Conv"><span class="hs-identifier hs-type">MO_UU_Conv</span></a></span><span> </span><span id="local-6989586621682861134"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861134"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861135"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861135"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-769"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-770"></span><span>            </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-771"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861135"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861136"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861136"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-773"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-774"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861134"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861136"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861134"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861134"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861135"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861136"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-776"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SS_Conv"><span class="hs-identifier hs-type">MO_SS_Conv</span></a></span><span> </span><span id="local-6989586621682861138"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861138"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861139"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861139"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr -&gt; NatM Register
forall {f :: * -&gt; *}.
Applicative f =&gt;
Width -&gt; Width -&gt; Reg -&gt; OrdList Instr -&gt; f Register
</span><a href="#local-6989586621682861140"><span class="hs-identifier hs-var">ss_conv</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861138"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861139"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FF_Conv"><span class="hs-identifier hs-type">MO_FF_Conv</span></a></span><span> </span><span id="local-6989586621682861142"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861142"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861143"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861143"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861143"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861144"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861144"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FcvtVariant -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-var">FCVT</span></a></span><span> </span><span class="annot"><span class="annottext">FcvtVariant
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FloatToFloat"><span class="hs-identifier hs-var">FloatToFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861143"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861144"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861142"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_WF_Bitcast"><span class="hs-identifier hs-type">MO_WF_Bitcast</span></a></span><span> </span><span id="local-6989586621682861147"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861147"><span class="hs-identifier hs-var">w</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-var">floatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861147"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861148"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861148"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861147"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861148"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861147"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FW_Bitcast"><span class="hs-identifier hs-type">MO_FW_Bitcast</span></a></span><span> </span><span id="local-6989586621682861150"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861150"><span class="hs-identifier hs-var">w</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861150"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861151"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861151"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861150"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861151"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861150"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span>        </span><span class="hs-comment">-- Conversions</span><span>
</span><span id="line-783"></span><span>        </span><span class="hs-comment">-- TODO: Duplication with MO_UU_Conv</span><span>
</span><span id="line-784"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span id="local-6989586621682861153"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861153"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861154"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861154"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-785"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861154"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861153"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-786"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-787"></span><span>                </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span>
</span><span id="line-788"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861154"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861155"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861155"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-790"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861096"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-791"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861153"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861155"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861153"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861094"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861153"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861154"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861155"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-793"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_XX_Conv"><span class="hs-identifier hs-type">MO_XX_Conv</span></a></span><span> </span><span id="local-6989586621682861156"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861156"><span class="hs-identifier hs-var">_from</span></a></span></span><span> </span><span id="local-6989586621682861157"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861157"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Register -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#swizzleRegisterRep"><span class="hs-identifier hs-var">swizzleRegisterRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861157"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Register -&gt; Register) -&gt; NatM Register -&gt; NatM Register
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-var">getRegister</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-795"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AlignmentCheck"><span class="hs-identifier hs-type">MO_AlignmentCheck</span></a></span><span> </span><span id="local-6989586621682861159"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861159"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682861160"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861160"><span class="hs-identifier hs-var">wordWidth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-796"></span><span>          </span><span id="local-6989586621682861161"><span class="annot"><a href="#local-6989586621682861161"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860990"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861093"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-797"></span><span>          </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-type">addAlignmentCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861159"><span class="hs-identifier hs-type">align</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861160"><span class="hs-identifier hs-type">wordWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861161"><span class="hs-identifier hs-type">reg</span></a></span><span>
</span><span id="line-798"></span><span>        </span><span id="local-6989586621682861163"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (monadic CmmMachOp): &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861163"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-800"></span><span>        </span><span class="hs-comment">-- In the case of 16- or 8-bit values we need to sign-extend to 32-bits</span><span>
</span><span id="line-801"></span><span>        </span><span class="hs-comment">-- See Note [Signed arithmetic on RISCV64].</span><span>
</span><span id="line-802"></span><span>        </span><span id="local-6989586621682861105"><span class="annot"><span class="annottext">negate :: OrdList Instr -&gt; Width -&gt; Reg -&gt; NatM Register
</span><a href="#local-6989586621682861105"><span class="hs-identifier hs-var hs-var">negate</span></a></span></span><span> </span><span id="local-6989586621682861166"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861166"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621682861167"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861167"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861168"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861168"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-803"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861169"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861169"><span class="hs-identifier hs-var hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861167"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-804"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861170"><span class="annot"><a href="#local-6989586621682861170"><span class="hs-identifier hs-var">reg'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861171"><span class="annot"><a href="#local-6989586621682861171"><span class="hs-identifier hs-var">code_sx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-var">signExtendReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861167"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861169"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861168"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-805"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861167"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861172"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861172"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-806"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861166"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-807"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861171"><span class="hs-identifier hs-var">code_sx</span></a></span><span>
</span><span id="line-808"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#NEG"><span class="hs-identifier hs-var">NEG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861169"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861172"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861169"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861170"><span class="hs-identifier hs-var">reg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861169"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861167"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861172"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>        </span><span id="local-6989586621682861140"><span class="annot"><span class="annottext">ss_conv :: Width -&gt; Width -&gt; Reg -&gt; OrdList Instr -&gt; f Register
</span><a href="#local-6989586621682861140"><span class="hs-identifier hs-var hs-var">ss_conv</span></a></span></span><span> </span><span id="local-6989586621682861194"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682861195"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621682861196"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861196"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861197"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861197"><span class="hs-identifier hs-var">code</span></a></span></span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-813"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; f Register
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; f Register) -&gt; Register -&gt; f Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; OrdList Instr) -&gt; Register)
-&gt; (Reg -&gt; OrdList Instr) -&gt; Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861198"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861198"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-814"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861197"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-815"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861196"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861198"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-816"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861198"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-817"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-818"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; f Register
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; f Register) -&gt; Register -&gt; f Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; OrdList Instr) -&gt; Register)
-&gt; (Reg -&gt; OrdList Instr) -&gt; Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861201"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861201"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-819"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861197"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-820"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-821"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-822"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MO_SS_Conv: narrow register signed&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861196"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861201"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861196"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861203"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-824"></span><span>                      </span><span class="hs-comment">-- signed right shift</span><span>
</span><span id="line-825"></span><span>                      </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861201"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861201"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861203"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-827"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861201"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-828"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-829"></span><span>              </span><span class="hs-comment">-- No conversion necessary: Just copy.</span><span>
</span><span id="line-830"></span><span>              </span><span class="annot"><span class="annottext">Register -&gt; f Register
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; f Register) -&gt; Register -&gt; f Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Reg -&gt; OrdList Instr) -&gt; Register)
-&gt; (Reg -&gt; OrdList Instr) -&gt; Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861205"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861205"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-831"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861197"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861205"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861196"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-833"></span><span>            </span><span id="local-6989586621682861203"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861203"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861194"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861195"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span>    </span><span class="hs-comment">-- Dyadic machops:</span><span>
</span><span id="line-836"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-comment">-- The general idea is:</span><span>
</span><span id="line-838"></span><span>    </span><span class="hs-comment">-- compute x&lt;i&gt; &lt;- x</span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-comment">-- compute x&lt;j&gt; &lt;- y</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-comment">-- OP x&lt;r&gt;, x&lt;i&gt;, x&lt;j&gt;</span><span>
</span><span id="line-841"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-comment">-- TODO: for now we'll only implement the 64bit versions. And rely on the</span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-comment">--      fallthrough to alert us if things go wrong!</span><span>
</span><span id="line-844"></span><span>    </span><span class="hs-comment">-- OPTIMIZATION WARNING: Dyadic CmmMachOp destructuring</span><span>
</span><span id="line-845"></span><span>    </span><span class="hs-comment">-- 0. TODO This should not exist! Rewrite: Reg +- 0 -&gt; Reg</span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861207"><span class="annot"><span class="annottext">expr' :: CmmExpr
</span><a href="#local-6989586621682861207"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span id="local-6989586621682861208"><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682861208"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860990"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861207"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-847"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861209"><span class="annot"><span class="annottext">expr' :: CmmExpr
</span><a href="#local-6989586621682861209"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmGlobal"><span class="hs-identifier hs-type">CmmGlobal</span></a></span><span> </span><span id="local-6989586621682861210"><span class="annot"><span class="annottext">GlobalRegUse
</span><a href="#local-6989586621682861210"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NCGConfig -&gt; Platform -&gt; CmmExpr -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister%27"><span class="hs-identifier hs-var">getRegister'</span></a></span><span> </span><span class="annot"><span class="annottext">NCGConfig
</span><a href="#local-6989586621682860990"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861209"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-848"></span><span>    </span><span class="hs-comment">-- 1. Compute Reg +/- n directly.</span><span>
</span><span id="line-849"></span><span>    </span><span class="hs-comment">--    For Add/Sub we can directly encode 12bits, or 12bits lsl #12.</span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682861211"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861211"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682861212"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861212"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861213"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861213"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-851"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861213"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861211"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861215"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861215"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861211"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861215"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861216"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861217"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861213"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-853"></span><span>        </span><span class="hs-comment">-- TODO: 12bits lsl #12; e.g. lower 12 bits of n are 0; shift n &gt;&gt; 12, and set lsl to #12.</span><span>
</span><span id="line-854"></span><span>        </span><span id="local-6989586621682861216"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861216"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861212"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span>        </span><span id="local-6989586621682861217"><span class="annot"><span class="annottext">r' :: Reg
</span><a href="#local-6989586621682861217"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861212"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-856"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682861218"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861218"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682861219"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861219"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861220"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861220"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-857"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861220"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861218"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861221"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861221"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861218"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861221"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861223"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861224"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861220"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-859"></span><span>        </span><span class="hs-comment">-- TODO: 12bits lsl #12; e.g. lower 12 bits of n are 0; shift n &gt;&gt; 12, and set lsl to #12.</span><span>
</span><span id="line-860"></span><span>        </span><span id="local-6989586621682861223"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861223"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861219"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>        </span><span id="local-6989586621682861224"><span class="annot"><span class="annottext">r' :: Reg
</span><a href="#local-6989586621682861224"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861219"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-862"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Quot"><span class="hs-identifier hs-type">MO_U_Quot</span></a></span><span> </span><span id="local-6989586621682861226"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861227"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861227"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861228"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861228"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-863"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861230"><span class="annot"><a href="#local-6989586621682861230"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861231"><span class="annot"><a href="#local-6989586621682861231"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861232"><span class="annot"><a href="#local-6989586621682861232"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861227"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-864"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861233"><span class="annot"><a href="#local-6989586621682861233"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861234"><span class="annot"><a href="#local-6989586621682861234"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861235"><span class="annot"><a href="#local-6989586621682861235"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861228"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-865"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-866"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-867"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861226"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861236"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861236"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-869"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861232"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-870"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861231"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861230"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-871"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861235"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-872"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861234"><span class="hs-identifier hs-var">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861233"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-873"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DIVU"><span class="hs-identifier hs-var">DIVU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861236"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861230"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861226"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861233"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span>    </span><span class="hs-comment">-- 2. Shifts. x &lt;&lt; n, x &gt;&gt; n.</span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span id="local-6989586621682861239"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861240"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861240"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861241"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861241"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-878"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-879"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861241"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-880"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861241"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-881"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861242"><span class="annot"><a href="#local-6989586621682861242"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861243"><span class="annot"><a href="#local-6989586621682861243"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861244"><span class="annot"><a href="#local-6989586621682861244"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861240"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-882"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-883"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-884"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861239"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-885"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861245"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861245"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-886"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861244"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-887"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861245"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861242"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861241"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861239"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861245"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-889"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span id="local-6989586621682861246"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861247"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861247"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861248"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861248"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-891"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-892"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861248"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-893"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861248"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-894"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861249"><span class="annot"><a href="#local-6989586621682861249"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861250"><span class="annot"><a href="#local-6989586621682861250"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861251"><span class="annot"><a href="#local-6989586621682861251"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861247"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-895"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-896"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-897"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861246"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861252"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861252"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-899"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861251"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-900"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861252"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861249"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861248"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861246"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861252"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-902"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span id="local-6989586621682861254"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861254"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861255"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861255"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861256"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861256"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861256"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-904"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861257"><span class="annot"><a href="#local-6989586621682861257"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861258"><span class="annot"><a href="#local-6989586621682861258"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861259"><span class="annot"><a href="#local-6989586621682861259"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861255"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-905"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861260"><span class="annot"><a href="#local-6989586621682861260"><span class="hs-identifier hs-var">reg_x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861261"><span class="annot"><a href="#local-6989586621682861261"><span class="hs-identifier hs-var">code_x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-type">signExtendReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-type">formatToWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861258"><span class="hs-identifier hs-type">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861254"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861257"><span class="hs-identifier hs-type">reg_x</span></a></span><span>
</span><span id="line-906"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-907"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-908"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861254"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861262"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861262"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-910"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861259"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-911"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861261"><span class="hs-identifier hs-var">code_x'</span></a></span><span>
</span><span id="line-912"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861254"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861262"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861254"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861260"><span class="hs-identifier hs-var">reg_x'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861256"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span id="local-6989586621682861263"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861263"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861264"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861264"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861265"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861265"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-915"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861266"><span class="annot"><a href="#local-6989586621682861266"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861267"><span class="annot"><a href="#local-6989586621682861267"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861268"><span class="annot"><a href="#local-6989586621682861268"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861264"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-916"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861269"><span class="annot"><a href="#local-6989586621682861269"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861270"><span class="annot"><a href="#local-6989586621682861270"><span class="hs-identifier hs-var">_format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861271"><span class="annot"><a href="#local-6989586621682861271"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861265"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-917"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861272"><span class="annot"><a href="#local-6989586621682861272"><span class="hs-identifier hs-var">reg_x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861273"><span class="annot"><a href="#local-6989586621682861273"><span class="hs-identifier hs-var">code_x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-type">signExtendReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-type">formatToWidth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861267"><span class="hs-identifier hs-type">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861263"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861266"><span class="hs-identifier hs-type">reg_x</span></a></span><span>
</span><span id="line-918"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-920"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861263"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861274"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861274"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-922"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861268"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-923"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861273"><span class="hs-identifier hs-var">code_x'</span></a></span><span>
</span><span id="line-924"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861271"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-925"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861263"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861274"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861263"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861272"><span class="hs-identifier hs-var">reg_x'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861263"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861269"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861276"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861276"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861277"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861277"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861278"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861278"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861276"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-929"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861278"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-930"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861278"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861279"><span class="annot"><a href="#local-6989586621682861279"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861280"><span class="annot"><a href="#local-6989586621682861280"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861281"><span class="annot"><a href="#local-6989586621682861281"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861277"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-932"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-933"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-934"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861276"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-935"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861282"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861282"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-936"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861281"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-937"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861280"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861276"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861279"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-938"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861276"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861282"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861276"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861279"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861278"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861284"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861284"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861285"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861285"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861286"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861286"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861284"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-942"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861286"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-943"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861286"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-944"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861287"><span class="annot"><a href="#local-6989586621682861287"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861288"><span class="annot"><a href="#local-6989586621682861288"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861289"><span class="annot"><a href="#local-6989586621682861289"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861285"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-945"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-946"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-947"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861284"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861290"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861290"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-949"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861289"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-950"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861288"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861284"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861287"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-951"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861284"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861290"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861284"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861287"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861286"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861291"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861292"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861292"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861293"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861293"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-954"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861294"><span class="annot"><a href="#local-6989586621682861294"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861295"><span class="annot"><a href="#local-6989586621682861295"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861296"><span class="annot"><a href="#local-6989586621682861296"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861292"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-955"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861297"><span class="annot"><a href="#local-6989586621682861297"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861298"><span class="annot"><a href="#local-6989586621682861298"><span class="hs-identifier hs-var">_format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861299"><span class="annot"><a href="#local-6989586621682861299"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861293"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-956"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-957"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-958"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861291"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861300"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861300"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-960"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861296"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-961"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861299"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-962"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861295"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861294"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-963"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861300"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861294"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861291"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861297"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-965"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861301"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861301"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861302"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861302"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861303"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861303"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-966"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861301"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-967"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861303"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-968"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861303"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-969"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861304"><span class="annot"><a href="#local-6989586621682861304"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861305"><span class="annot"><a href="#local-6989586621682861305"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861306"><span class="annot"><a href="#local-6989586621682861306"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861302"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-970"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-971"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-972"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861301"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861307"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861307"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-974"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861306"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-975"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861301"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861307"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861301"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861304"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861303"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861308"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861308"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861309"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861309"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861310"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861310"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-978"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861308"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-979"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861310"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-980"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861310"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-981"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861311"><span class="annot"><a href="#local-6989586621682861311"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861312"><span class="annot"><a href="#local-6989586621682861312"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861313"><span class="annot"><a href="#local-6989586621682861313"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861309"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-982"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-983"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-984"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861308"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861314"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861314"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-986"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861313"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-987"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861308"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861314"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861308"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861311"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861310"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>
</span><span id="line-990"></span><span>    </span><span class="hs-comment">-- 3. Logic &amp;&amp;, ||</span><span>
</span><span id="line-991"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span id="local-6989586621682861316"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861316"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682861317"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861317"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861318"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861318"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-992"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-993"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861316"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861319"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861319"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861316"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861319"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861321"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861322"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861318"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-995"></span><span>        </span><span id="local-6989586621682861321"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861321"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861317"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span>        </span><span id="local-6989586621682861322"><span class="annot"><span class="annottext">r' :: Reg
</span><a href="#local-6989586621682861322"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861317"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-997"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span> </span><span id="local-6989586621682861324"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861324"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span id="local-6989586621682861325"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861325"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861326"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861326"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-998"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861326"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-999"></span><span>          </span><span class="annot"><span class="annottext">Register -&gt; NatM Register
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Register -&gt; NatM Register) -&gt; Register -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861324"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861327"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861327"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ORI"><span class="hs-identifier hs-var">ORI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861324"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861327"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861329"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861330"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-var">ImmInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861326"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1001"></span><span>        </span><span id="local-6989586621682861329"><span class="annot"><span class="annottext">w' :: Width
</span><a href="#local-6989586621682861329"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861325"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1002"></span><span>        </span><span id="local-6989586621682861330"><span class="annot"><span class="annottext">r' :: Reg
</span><a href="#local-6989586621682861330"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861325"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-1003"></span><span>
</span><span id="line-1004"></span><span>    </span><span class="hs-comment">-- Generic binary case.</span><span>
</span><span id="line-1005"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682861331"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861331"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861332"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861333"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861333"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1006"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- A &quot;plain&quot; operation.</span><span>
</span><span id="line-1007"></span><span>          </span><span id="local-6989586621682861334"><span class="annot"><span class="annottext">bitOp :: Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var hs-var">bitOp</span></a></span></span><span> </span><span id="local-6989586621682861335"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861335"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861336"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861336"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1008"></span><span>            </span><span class="hs-comment">-- compute x&lt;m&gt; &lt;- x</span><span>
</span><span id="line-1009"></span><span>            </span><span class="hs-comment">-- compute x&lt;o&gt; &lt;- y</span><span>
</span><span id="line-1010"></span><span>            </span><span class="hs-comment">-- &lt;OP&gt; x&lt;n&gt;, x&lt;m&gt;, x&lt;o&gt;</span><span>
</span><span id="line-1011"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861337"><span class="annot"><a href="#local-6989586621682861337"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861338"><span class="annot"><a href="#local-6989586621682861338"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861339"><span class="annot"><a href="#local-6989586621682861339"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1012"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861340"><span class="annot"><a href="#local-6989586621682861340"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861341"><span class="annot"><a href="#local-6989586621682861341"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861342"><span class="annot"><a href="#local-6989586621682861342"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861333"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1013"></span><span>            </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861338"><span class="hs-identifier hs-type">format_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861341"><span class="hs-identifier hs-type">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bitOp: incompatible&quot;</span></span><span>
</span><span id="line-1014"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-1015"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1016"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861335"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1017"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861345"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861345"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1018"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861339"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1019"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861342"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1020"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861336"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861335"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861345"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861335"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861337"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861335"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861340"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span>          </span><span class="hs-comment">-- A (potentially signed) integer operation.</span><span>
</span><span id="line-1024"></span><span>          </span><span class="hs-comment">-- In the case of 8- and 16-bit signed arithmetic we must first</span><span>
</span><span id="line-1025"></span><span>          </span><span class="hs-comment">-- sign-extend both arguments to 32-bits.</span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-comment">-- See Note [Signed arithmetic on RISCV64].</span><span>
</span><span id="line-1027"></span><span>          </span><span id="local-6989586621682861346"><span class="annot"><span class="annottext">intOp :: Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var hs-var">intOp</span></a></span></span><span> </span><span id="local-6989586621682861347"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682861347"><span class="hs-identifier hs-var">is_signed</span></a></span></span><span> </span><span id="local-6989586621682861348"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861348"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861349"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861349"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1028"></span><span>            </span><span class="hs-comment">-- compute x&lt;m&gt; &lt;- x</span><span>
</span><span id="line-1029"></span><span>            </span><span class="hs-comment">-- compute x&lt;o&gt; &lt;- y</span><span>
</span><span id="line-1030"></span><span>            </span><span class="hs-comment">-- &lt;OP&gt; x&lt;n&gt;, x&lt;m&gt;, x&lt;o&gt;</span><span>
</span><span id="line-1031"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861350"><span class="annot"><a href="#local-6989586621682861350"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861351"><span class="annot"><a href="#local-6989586621682861351"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861352"><span class="annot"><a href="#local-6989586621682861352"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1032"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861353"><span class="annot"><a href="#local-6989586621682861353"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861354"><span class="annot"><a href="#local-6989586621682861354"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861355"><span class="annot"><a href="#local-6989586621682861355"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861333"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1033"></span><span>            </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861351"><span class="hs-identifier hs-type">format_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-type">isIntFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861354"><span class="hs-identifier hs-type">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;intOp: non-int&quot;</span></span><span>
</span><span id="line-1034"></span><span>            </span><span class="hs-comment">-- This is the width of the registers on which the operation</span><span>
</span><span id="line-1035"></span><span>            </span><span class="hs-comment">-- should be performed.</span><span>
</span><span id="line-1036"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861357"><span class="annot"><a href="#local-6989586621682861357"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#opRegWidth"><span class="hs-identifier hs-var">opRegWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861348"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1037"></span><span>                </span><span id="local-6989586621682861358"><span class="annot"><a href="#local-6989586621682861358"><span class="hs-identifier hs-var hs-var">signExt</span></a></span></span><span> </span><span id="local-6989586621682861359"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861359"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-1038"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682861347"><span class="hs-identifier hs-var">is_signed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg, OrdList Instr) -&gt; NatM (Reg, OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861359"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-var">signExtendReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861348"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861357"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861359"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1040"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861361"><span class="annot"><a href="#local-6989586621682861361"><span class="hs-identifier hs-var">reg_x_sx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861362"><span class="annot"><a href="#local-6989586621682861362"><span class="hs-identifier hs-var">code_x_sx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682861358"><span class="hs-identifier hs-type">signExt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861350"><span class="hs-identifier hs-type">reg_x</span></a></span><span>
</span><span id="line-1041"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861363"><span class="annot"><a href="#local-6989586621682861363"><span class="hs-identifier hs-var">reg_y_sx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861364"><span class="annot"><a href="#local-6989586621682861364"><span class="hs-identifier hs-var">code_y_sx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682861358"><span class="hs-identifier hs-type">signExt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861353"><span class="hs-identifier hs-type">reg_y</span></a></span><span>
</span><span id="line-1042"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861348"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861365"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861365"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1043"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861352"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1044"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861355"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1045"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span>
</span><span id="line-1046"></span><span>                </span><span class="hs-comment">-- sign-extend both operands</span><span>
</span><span id="line-1047"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861362"><span class="hs-identifier hs-var">code_x_sx</span></a></span><span>
</span><span id="line-1048"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861364"><span class="hs-identifier hs-var">code_y_sx</span></a></span><span>
</span><span id="line-1049"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861349"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861357"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861365"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861357"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861361"><span class="hs-identifier hs-var">reg_x_sx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861357"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861363"><span class="hs-identifier hs-var">reg_y_sx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861357"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861348"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861365"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="hs-comment">-- truncate back to the operand's original width</span><span>
</span><span id="line-1051"></span><span>          </span><span id="local-6989586621682861366"><span class="annot"><span class="annottext">floatOp :: Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var hs-var">floatOp</span></a></span></span><span> </span><span id="local-6989586621682861367"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861367"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861368"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861368"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1052"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861369"><span class="annot"><a href="#local-6989586621682861369"><span class="hs-identifier hs-var">reg_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861370"><span class="annot"><a href="#local-6989586621682861370"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861371"><span class="annot"><a href="#local-6989586621682861371"><span class="hs-identifier hs-var">code_fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-var">getFloatReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1053"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861372"><span class="annot"><a href="#local-6989586621682861372"><span class="hs-identifier hs-var">reg_fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861373"><span class="annot"><a href="#local-6989586621682861373"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861374"><span class="annot"><a href="#local-6989586621682861374"><span class="hs-identifier hs-var">code_fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861333"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1054"></span><span>            </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861370"><span class="hs-identifier hs-type">format_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861373"><span class="hs-identifier hs-type">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;floatOp: non-float&quot;</span></span><span>
</span><span id="line-1055"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-1056"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1057"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861367"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861375"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861375"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1059"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861371"><span class="hs-identifier hs-var">code_fx</span></a></span><span>
</span><span id="line-1060"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861374"><span class="hs-identifier hs-var">code_fy</span></a></span><span>
</span><span id="line-1061"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861368"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861367"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861375"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861367"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861369"><span class="hs-identifier hs-var">reg_fx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861367"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861372"><span class="hs-identifier hs-var">reg_fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1062"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>
</span><span id="line-1064"></span><span>          </span><span class="hs-comment">-- need a special one for conditionals, as they return ints</span><span>
</span><span id="line-1065"></span><span>          </span><span id="local-6989586621682861376"><span class="annot"><span class="annottext">floatCond :: Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var hs-var">floatCond</span></a></span></span><span> </span><span id="local-6989586621682861377"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861377"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861378"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861378"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1066"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861379"><span class="annot"><a href="#local-6989586621682861379"><span class="hs-identifier hs-var">reg_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861380"><span class="annot"><a href="#local-6989586621682861380"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861381"><span class="annot"><a href="#local-6989586621682861381"><span class="hs-identifier hs-var">code_fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-var">getFloatReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1067"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861382"><span class="annot"><a href="#local-6989586621682861382"><span class="hs-identifier hs-var">reg_fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861383"><span class="annot"><a href="#local-6989586621682861383"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861384"><span class="annot"><a href="#local-6989586621682861384"><span class="hs-identifier hs-var">code_fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861333"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1068"></span><span>            </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861380"><span class="hs-identifier hs-type">format_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861383"><span class="hs-identifier hs-type">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;floatCond: non-float&quot;</span></span><span>
</span><span id="line-1069"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-1070"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1071"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861377"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861385"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861385"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1073"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861381"><span class="hs-identifier hs-var">code_fx</span></a></span><span>
</span><span id="line-1074"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861384"><span class="hs-identifier hs-var">code_fy</span></a></span><span>
</span><span id="line-1075"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861378"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861377"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861385"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861377"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861379"><span class="hs-identifier hs-var">reg_fx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861377"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861382"><span class="hs-identifier hs-var">reg_fy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861331"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1079"></span><span>        </span><span class="hs-comment">-- Integer operations</span><span>
</span><span id="line-1080"></span><span>        </span><span class="hs-comment">-- Add/Sub should only be Integer Options.</span><span>
</span><span id="line-1081"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682861386"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861386"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861386"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861387"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861387"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861388"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861388"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861389"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861389"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861387"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861388"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861389"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1082"></span><span>        </span><span class="hs-comment">-- TODO: Handle sub-word case</span><span>
</span><span id="line-1083"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682861390"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861390"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861390"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861391"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861391"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861392"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861392"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861393"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861393"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861391"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861392"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861393"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1084"></span><span>        </span><span class="hs-comment">-- N.B. We needn't sign-extend sub-word size (in)equality comparisons</span><span>
</span><span id="line-1085"></span><span>        </span><span class="hs-comment">-- since we don't care about ordering.</span><span>
</span><span id="line-1086"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span id="local-6989586621682861395"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861395"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var">bitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861395"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861396"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861396"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861397"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861397"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861398"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861398"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861396"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861397"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861398"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span id="local-6989586621682861402"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861402"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var">bitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861403"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861403"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861404"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861404"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861405"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861405"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861403"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861404"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861405"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>        </span><span class="hs-comment">-- Signed multiply/divide</span><span>
</span><span id="line-1089"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Mul"><span class="hs-identifier hs-type">MO_Mul</span></a></span><span> </span><span id="local-6989586621682861408"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861408"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861408"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861409"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861409"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861410"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861410"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861411"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861411"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861409"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861410"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861411"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_MulMayOflo"><span class="hs-identifier hs-type">MO_S_MulMayOflo</span></a></span><span> </span><span id="local-6989586621682861414"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861414"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682861415"><span class="hs-identifier hs-var">do_mul_may_oflo</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861414"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861332"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861333"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1091"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Quot"><span class="hs-identifier hs-type">MO_S_Quot</span></a></span><span> </span><span id="local-6989586621682861417"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861417"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861417"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861418"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861418"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861419"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861419"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861420"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861420"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861418"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861419"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861420"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Rem"><span class="hs-identifier hs-type">MO_S_Rem</span></a></span><span> </span><span id="local-6989586621682861423"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861423"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861423"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861424"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861424"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861425"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861425"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861426"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861426"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#REM"><span class="hs-identifier hs-var">REM</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861424"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861425"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861426"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>        </span><span class="hs-comment">-- Unsigned multiply/divide</span><span>
</span><span id="line-1094"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Quot"><span class="hs-identifier hs-type">MO_U_Quot</span></a></span><span> </span><span id="local-6989586621682861428"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861428"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861428"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861429"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861429"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861430"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861430"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861431"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861431"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DIVU"><span class="hs-identifier hs-var">DIVU</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861429"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861430"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861431"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1095"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Rem"><span class="hs-identifier hs-type">MO_U_Rem</span></a></span><span> </span><span id="local-6989586621682861433"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861433"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861433"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861434"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861434"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861435"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861435"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861436"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861436"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#REMU"><span class="hs-identifier hs-var">REMU</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861434"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861435"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861436"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-comment">-- Signed comparisons</span><span>
</span><span id="line-1097"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span id="local-6989586621682861439"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861439"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861439"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861440"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861440"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861441"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861441"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861442"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861442"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861440"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861441"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861442"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SGE"><span class="hs-identifier hs-var">SGE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span id="local-6989586621682861445"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861445"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861445"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861446"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861446"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861447"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861447"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861448"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861448"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861446"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861447"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861448"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SLE"><span class="hs-identifier hs-var">SLE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1099"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span id="local-6989586621682861451"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861451"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861451"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861452"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861452"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861453"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861453"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861454"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861454"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861452"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861453"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861454"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SGT"><span class="hs-identifier hs-var">SGT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span id="local-6989586621682861457"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861457"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861457"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861458"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861458"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861459"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861459"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861460"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861460"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861458"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861459"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861460"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SLT"><span class="hs-identifier hs-var">SLT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-comment">-- Unsigned comparisons</span><span>
</span><span id="line-1102"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span id="local-6989586621682861463"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861463"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861463"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861464"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861464"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861465"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861465"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861466"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861466"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861464"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861465"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861466"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#UGE"><span class="hs-identifier hs-var">UGE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span id="local-6989586621682861469"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861469"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861469"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861470"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861470"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861471"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861471"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861472"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861472"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861470"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861471"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861472"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#ULE"><span class="hs-identifier hs-var">ULE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span id="local-6989586621682861475"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861475"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861475"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861476"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861476"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861477"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861477"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861478"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861478"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861476"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861477"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861478"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#UGT"><span class="hs-identifier hs-var">UGT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span id="local-6989586621682861481"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861481"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861481"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861482"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861482"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861483"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861483"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861484"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861484"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861482"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861484"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#ULT"><span class="hs-identifier hs-var">ULT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>        </span><span class="hs-comment">-- Floating point arithmetic</span><span>
</span><span id="line-1107"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Add"><span class="hs-identifier hs-type">MO_F_Add</span></a></span><span> </span><span id="local-6989586621682861487"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861487"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861487"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861488"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861488"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861489"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861489"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861490"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861490"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861488"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861489"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861490"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Sub"><span class="hs-identifier hs-type">MO_F_Sub</span></a></span><span> </span><span id="local-6989586621682861492"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861492"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861492"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861493"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861493"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861494"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861494"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861495"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861495"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861493"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861494"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861495"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Mul"><span class="hs-identifier hs-type">MO_F_Mul</span></a></span><span> </span><span id="local-6989586621682861497"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861497"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861497"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861498"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861498"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861499"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861499"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861500"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861500"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861498"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861499"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861500"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1110"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Quot"><span class="hs-identifier hs-type">MO_F_Quot</span></a></span><span> </span><span id="local-6989586621682861502"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861502"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861502"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861503"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861503"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861504"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861504"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861505"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861505"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DIV"><span class="hs-identifier hs-var">DIV</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861503"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861504"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861505"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span>        </span><span class="hs-comment">-- Floating point comparison</span><span>
</span><span id="line-1112"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Min"><span class="hs-identifier hs-type">MO_F_Min</span></a></span><span> </span><span id="local-6989586621682861507"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861507"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861507"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861508"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861508"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861509"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861510"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861510"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMIN"><span class="hs-identifier hs-var">FMIN</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861508"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861509"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861510"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1113"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Max"><span class="hs-identifier hs-type">MO_F_Max</span></a></span><span> </span><span id="local-6989586621682861513"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861513"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861366"><span class="hs-identifier hs-var">floatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861513"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861514"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861514"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861515"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861515"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861516"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861516"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMAX"><span class="hs-identifier hs-var">FMAX</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861514"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861515"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861516"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span id="local-6989586621682861519"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861519"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861519"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861520"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861520"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861521"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861521"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861522"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861522"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861520"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861521"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861522"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span id="local-6989586621682861524"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861524"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861524"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861525"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861525"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861526"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861526"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861527"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861527"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861525"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861526"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861527"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span id="local-6989586621682861529"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861529"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861529"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861530"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861530"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861531"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861531"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861532"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861532"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861530"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861531"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861532"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FGE"><span class="hs-identifier hs-var">FGE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span id="local-6989586621682861535"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861535"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861535"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861536"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861536"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861537"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861538"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861538"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861536"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861538"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FLE"><span class="hs-identifier hs-var">FLE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- x &lt;= y &lt;=&gt; y &gt; x</span><span>
</span><span id="line-1118"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span id="local-6989586621682861541"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861541"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861541"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861542"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861542"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861543"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861543"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861544"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861544"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861542"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861543"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861544"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FGT"><span class="hs-identifier hs-var">FGT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span id="local-6989586621682861547"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861547"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861376"><span class="hs-identifier hs-var">floatCond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861547"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861548"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861548"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861549"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861549"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861550"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861550"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861548"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861549"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861550"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FLT"><span class="hs-identifier hs-var">FLT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- x &lt; y &lt;=&gt; y &gt;= x</span><span>
</span><span id="line-1120"></span><span>
</span><span id="line-1121"></span><span>        </span><span class="hs-comment">-- Bitwise operations</span><span>
</span><span id="line-1122"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_And"><span class="hs-identifier hs-type">MO_And</span></a></span><span> </span><span id="local-6989586621682861552"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861552"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var">bitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861552"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861553"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861553"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861554"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861554"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861555"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861555"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861553"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861554"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861555"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Or"><span class="hs-identifier hs-type">MO_Or</span></a></span><span> </span><span id="local-6989586621682861556"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861556"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var">bitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861556"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861557"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861557"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861558"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861558"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861559"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861559"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OR"><span class="hs-identifier hs-var">OR</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861557"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861558"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861559"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1124"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xor"><span class="hs-identifier hs-type">MO_Xor</span></a></span><span> </span><span id="local-6989586621682861562"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861562"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861334"><span class="hs-identifier hs-var">bitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861562"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861563"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861563"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861564"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861564"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861565"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861565"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861563"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861564"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861565"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1125"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Shl"><span class="hs-identifier hs-type">MO_Shl</span></a></span><span> </span><span id="local-6989586621682861567"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861567"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861567"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861568"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861568"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861569"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861569"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861570"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861570"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861568"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861569"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861570"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Shr"><span class="hs-identifier hs-type">MO_U_Shr</span></a></span><span> </span><span id="local-6989586621682861571"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861571"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861571"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861572"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861572"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861573"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861573"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861574"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861574"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861572"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861573"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861574"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Shr"><span class="hs-identifier hs-type">MO_S_Shr</span></a></span><span> </span><span id="local-6989586621682861575"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861575"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861346"><span class="hs-identifier hs-var">intOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861575"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861576"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861576"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861577"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861577"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861578"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861578"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861576"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861577"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861578"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>        </span><span id="local-6989586621682861579"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861579"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (unhandled dyadic CmmMachOp): &quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; NatM Register) -&gt; SDoc -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861579"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;in&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1129"></span><span>
</span><span id="line-1130"></span><span>    </span><span class="hs-comment">-- Generic ternary case.</span><span>
</span><span id="line-1131"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682861581"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861581"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861582"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861582"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861583"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861583"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861584"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861584"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1132"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861581"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1133"></span><span>        </span><span class="hs-comment">-- Floating-point fused multiply-add operations</span><span>
</span><span id="line-1134"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1135"></span><span>        </span><span class="hs-comment">-- x86 fmadd    x * y + z &lt;=&gt; RISCV64 fmadd : d =   r1 * r2 + r3</span><span>
</span><span id="line-1136"></span><span>        </span><span class="hs-comment">-- x86 fmsub    x * y - z &lt;=&gt; RISCV64 fnmsub: d =   r1 * r2 - r3</span><span>
</span><span id="line-1137"></span><span>        </span><span class="hs-comment">-- x86 fnmadd - x * y + z &lt;=&gt; RISCV64 fmsub : d = - r1 * r2 + r3</span><span>
</span><span id="line-1138"></span><span>        </span><span class="hs-comment">-- x86 fnmsub - x * y - z &lt;=&gt; RISCV64 fnmadd: d = - r1 * r2 - r3</span><span>
</span><span id="line-1139"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_FMA"><span class="hs-identifier hs-type">MO_FMA</span></a></span><span> </span><span id="local-6989586621682861586"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682861586"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682861587"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861587"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682861588"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861588"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1140"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861587"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1141"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682861586"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1142"></span><span>                </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861590"><span class="hs-identifier hs-var">float3Op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861591"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861591"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861592"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861592"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682861593"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861593"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682861594"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861594"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMA"><span class="hs-identifier hs-var">FMA</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861591"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861592"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861593"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861594"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>                </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861590"><span class="hs-identifier hs-var">float3Op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861597"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861597"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861598"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861598"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682861599"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861599"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682861600"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861600"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMA"><span class="hs-identifier hs-var">FMA</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861597"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861598"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861599"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861600"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>                </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861590"><span class="hs-identifier hs-var">float3Op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861602"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861602"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861603"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861603"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682861604"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861604"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682861605"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861605"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMA"><span class="hs-identifier hs-var">FMA</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861602"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861603"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861604"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861605"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>                </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861590"><span class="hs-identifier hs-var">float3Op</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861588"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861607"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861607"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682861608"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861608"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682861609"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861609"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682861610"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861610"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FMA"><span class="hs-identifier hs-var">FMA</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861607"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861608"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861609"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861610"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1147"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#sorry"><span class="hs-identifier hs-var">sorry</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The RISCV64 backend does not (yet) support vectors.&quot;</span></span><span>
</span><span id="line-1148"></span><span>        </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1149"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (unhandled ternary CmmMachOp): &quot;</span></span><span>
</span><span id="line-1150"></span><span>            </span><span class="annot"><span class="annottext">(SDoc -&gt; NatM Register) -&gt; SDoc -&gt; NatM Register
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MachOp -&gt; SDoc
</span><a href="GHC.Cmm.MachOp.html#pprMachOp"><span class="hs-identifier hs-var">pprMachOp</span></a></span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861581"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-1151"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;in&quot;</span></span><span>
</span><span id="line-1152"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1153"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1154"></span><span>        </span><span id="local-6989586621682861590"><span class="annot"><span class="annottext">float3Op :: Width
-&gt; (Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; NatM Register
</span><a href="#local-6989586621682861590"><span class="hs-identifier hs-var hs-var">float3Op</span></a></span></span><span> </span><span id="local-6989586621682861612"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861612"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861613"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861613"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1155"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861614"><span class="annot"><a href="#local-6989586621682861614"><span class="hs-identifier hs-var">reg_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861615"><span class="annot"><a href="#local-6989586621682861615"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861616"><span class="annot"><a href="#local-6989586621682861616"><span class="hs-identifier hs-var">code_fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-var">getFloatReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861582"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1156"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861617"><span class="annot"><a href="#local-6989586621682861617"><span class="hs-identifier hs-var">reg_fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861618"><span class="annot"><a href="#local-6989586621682861618"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861619"><span class="annot"><a href="#local-6989586621682861619"><span class="hs-identifier hs-var">code_fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861583"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1157"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682861620"><span class="annot"><a href="#local-6989586621682861620"><span class="hs-identifier hs-var">reg_fz</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861621"><span class="annot"><a href="#local-6989586621682861621"><span class="hs-identifier hs-var">format_z</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861622"><span class="annot"><a href="#local-6989586621682861622"><span class="hs-identifier hs-var">code_fz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861584"><span class="hs-identifier hs-type">z</span></a></span><span>
</span><span id="line-1158"></span><span>          </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861615"><span class="hs-identifier hs-type">format_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861618"><span class="hs-identifier hs-type">format_y</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861621"><span class="hs-identifier hs-type">format_z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;float3Op: non-float&quot;</span></span><span>
</span><span id="line-1160"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1161"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#floatFormat"><span class="hs-identifier hs-type">floatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861612"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861623"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861623"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1163"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861616"><span class="hs-identifier hs-var">code_fx</span></a></span><span>
</span><span id="line-1164"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861619"><span class="hs-identifier hs-var">code_fy</span></a></span><span>
</span><span id="line-1165"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861622"><span class="hs-identifier hs-var">code_fz</span></a></span><span>
</span><span id="line-1166"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682861613"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861612"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861623"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861612"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861614"><span class="hs-identifier hs-var">reg_fx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861612"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861617"><span class="hs-identifier hs-var">reg_fy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861612"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861620"><span class="hs-identifier hs-var">reg_fz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682861624"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861624"><span class="hs-identifier hs-var">_op</span></a></span></span><span> </span><span id="local-6989586621682861625"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682861625"><span class="hs-identifier hs-var">_xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1168"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getRegister' (variadic CmmMachOp): &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CmmExpr -&gt; SDoc
forall env a. OutputableP env a =&gt; env -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-var">pdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682860991"><span class="hs-identifier hs-var">plat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1170"></span><span>    </span><span class="annot"><a href="#local-6989586621682861039"><span class="hs-identifier hs-type">isNbitEncodeable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1171"></span><span>    </span><span id="local-6989586621682861039"><span class="annot"><span class="annottext">isNbitEncodeable :: Int -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621682861039"><span class="hs-identifier hs-var hs-var">isNbitEncodeable</span></a></span></span><span> </span><span id="local-6989586621682861626"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861626"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682861627"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861627"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861628"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861628"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861626"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861628"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861627"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861627"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861628"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span>    </span><span class="hs-comment">-- N.B. MUL does not set the overflow flag.</span><span>
</span><span id="line-1173"></span><span>    </span><span class="hs-comment">-- Return 0 when the operation cannot overflow, /= 0 otherwise</span><span>
</span><span id="line-1174"></span><span>    </span><span class="annot"><a href="#local-6989586621682861415"><span class="hs-identifier hs-type">do_mul_may_oflo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1175"></span><span>    </span><span id="local-6989586621682861415"><span class="annot"><span class="annottext">do_mul_may_oflo :: Width -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM Register
</span><a href="#local-6989586621682861415"><span class="hs-identifier hs-var hs-var">do_mul_may_oflo</span></a></span></span><span> </span><span id="local-6989586621682861630"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861630"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861631"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861631"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621682861632"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861632"><span class="hs-identifier hs-var">_y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861630"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM Register
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot multiply larger than 64bit&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861630"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1176"></span><span>    </span><span class="annot"><a href="#local-6989586621682861415"><span class="hs-identifier hs-var">do_mul_may_oflo</span></a></span><span> </span><span id="local-6989586621682861633"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span id="local-6989586621682861634"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861634"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861635"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861635"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1177"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861636"><span class="annot"><a href="#local-6989586621682861636"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861637"><span class="annot"><a href="#local-6989586621682861637"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861638"><span class="annot"><a href="#local-6989586621682861638"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861634"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1178"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861639"><span class="annot"><a href="#local-6989586621682861639"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861640"><span class="annot"><a href="#local-6989586621682861640"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861641"><span class="annot"><a href="#local-6989586621682861641"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861635"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1179"></span><span>      </span><span class="hs-comment">-- TODO: Can't we clobber reg_x and reg_y to save registers?</span><span>
</span><span id="line-1180"></span><span>      </span><span id="local-6989586621682861642"><span class="annot"><a href="#local-6989586621682861642"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1181"></span><span>      </span><span id="local-6989586621682861643"><span class="annot"><a href="#local-6989586621682861643"><span class="hs-identifier hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1182"></span><span>      </span><span class="hs-comment">-- TODO: Overhaul CSET: 3rd operand isn't needed for SNEZ</span><span>
</span><span id="line-1183"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861644"><span class="annot"><a href="#local-6989586621682861644"><span class="hs-identifier hs-var hs-var">nonSense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1184"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1185"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1186"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861633"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1187"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861645"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861645"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1188"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861638"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1189"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861637"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861636"><span class="hs-identifier hs-var">reg_x</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861636"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1190"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861641"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1191"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861640"><span class="hs-identifier hs-var">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861639"><span class="hs-identifier hs-var">reg_y</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861639"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1192"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1193"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MULH"><span class="hs-identifier hs-var">MULH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861643"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861636"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861639"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1194"></span><span>                    </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861642"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861636"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861639"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1195"></span><span>                    </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861642"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861642"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1196"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1197"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Set flag if result of MULH contains more than sign bits.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1198"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#XOR"><span class="hs-identifier hs-var">XOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861643"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861643"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861642"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1199"></span><span>                    </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861645"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861633"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861643"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861644"><span class="hs-identifier hs-var">nonSense</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-1200"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-1201"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span>    </span><span class="annot"><a href="#local-6989586621682861415"><span class="hs-identifier hs-var">do_mul_may_oflo</span></a></span><span> </span><span id="local-6989586621682861647"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861648"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682861649"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861649"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1203"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861650"><span class="annot"><a href="#local-6989586621682861650"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861651"><span class="annot"><a href="#local-6989586621682861651"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861652"><span class="annot"><a href="#local-6989586621682861652"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861648"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1204"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861653"><span class="annot"><a href="#local-6989586621682861653"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861654"><span class="annot"><a href="#local-6989586621682861654"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861655"><span class="annot"><a href="#local-6989586621682861655"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861649"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1205"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861656"><span class="annot"><a href="#local-6989586621682861656"><span class="hs-identifier hs-var hs-var">width_x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861651"><span class="hs-identifier hs-var">format_x</span></a></span><span>
</span><span id="line-1206"></span><span>          </span><span id="local-6989586621682861657"><span class="annot"><a href="#local-6989586621682861657"><span class="hs-identifier hs-var hs-var">width_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861654"><span class="hs-identifier hs-var">format_y</span></a></span><span>
</span><span id="line-1207"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682861647"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682861656"><span class="hs-identifier hs-type">width_x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682861647"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682861657"><span class="hs-identifier hs-type">width_y</span></a></span><span>
</span><span id="line-1208"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-1209"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1210"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1211"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861647"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861658"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861658"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1213"></span><span>                  </span><span class="hs-comment">-- 8bit * 8bit cannot overflow 16bit</span><span>
</span><span id="line-1214"></span><span>                  </span><span class="hs-comment">-- 16bit * 16bit cannot overflow 32bit</span><span>
</span><span id="line-1215"></span><span>                  </span><span class="hs-comment">-- 32bit * 32bit cannot overflow 64bit</span><span>
</span><span id="line-1216"></span><span>                  </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861658"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1217"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1219"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861660"><span class="annot"><a href="#local-6989586621682861660"><span class="hs-identifier hs-var hs-var">use32BitMul</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861656"><span class="hs-identifier hs-var">width_x</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861657"><span class="hs-identifier hs-var">width_y</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1220"></span><span>              </span><span id="local-6989586621682861661"><span class="annot"><a href="#local-6989586621682861661"><span class="hs-identifier hs-var hs-var">nonSense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682861660"><span class="hs-identifier hs-type">use32BitMul</span></a></span><span>
</span><span id="line-1222"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1223"></span><span>              </span><span id="local-6989586621682861662"><span class="annot"><a href="#local-6989586621682861662"><span class="hs-identifier hs-var">narrowedReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1224"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1225"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1226"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861647"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861663"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1228"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861652"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1229"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861651"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861650"><span class="hs-identifier hs-var">reg_x</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861650"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1230"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861655"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1231"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861654"><span class="hs-identifier hs-var">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861653"><span class="hs-identifier hs-var">reg_y</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861653"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1232"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MUL"><span class="hs-identifier hs-var">MUL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861650"><span class="hs-identifier hs-var">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861653"><span class="hs-identifier hs-var">reg_y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861662"><span class="hs-identifier hs-var">narrowedReg</span></a></span><span>
</span><span id="line-1234"></span><span>                        </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1235"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1236"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Check if the multiplied value fits in the narrowed register&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861662"><span class="hs-identifier hs-var">narrowedReg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1238"></span><span>                            </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Cond -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-var">CSET</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861663"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861661"><span class="hs-identifier hs-var">nonSense</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-1239"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-1240"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-1242"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1243"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-1244"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-type">intFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861647"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682861664"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861664"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1246"></span><span>                      </span><span class="hs-comment">-- Do not handle this unlikely case. Just tell that it may overflow.</span><span>
</span><span id="line-1247"></span><span>                      </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682860992"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861647"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861664"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- | Instructions to sign-extend the value in the given register from width @w@</span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- up to width @w'@.</span><span>
</span><span id="line-1252"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-type">signExtendReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span id="signExtendReg"><span class="annot"><span class="annottext">signExtendReg :: Width -&gt; Width -&gt; Reg -&gt; NatM (Reg, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-var hs-var">signExtendReg</span></a></span></span><span> </span><span id="local-6989586621682861665"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861665"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861666"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861666"><span class="hs-identifier hs-var">_w'</span></a></span></span><span> </span><span id="local-6989586621682861667"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861667"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861665"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reg, OrdList Instr) -&gt; NatM (Reg, OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861667"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendReg"><span class="hs-identifier hs-var">signExtendReg</span></a></span><span> </span><span id="local-6989586621682861668"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861668"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861669"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861669"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861670"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861670"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1255"></span><span>  </span><span id="local-6989586621682861671"><span class="annot"><a href="#local-6989586621682861671"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861669"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861672"><span class="annot"><a href="#local-6989586621682861672"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861669"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861670"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861671"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-1257"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682861671"><span class="hs-identifier hs-type">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682861672"><span class="hs-identifier hs-type">instrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span class="hs-comment">-- | Sign extends to 64bit, if needed</span><span>
</span><span id="line-1260"></span><span class="hs-comment">--</span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- Source `Reg` @r@ stays untouched, while the conversion happens on destination</span><span>
</span><span id="line-1262"></span><span class="hs-comment">-- `Reg` @r'@.</span><span>
</span><span id="line-1263"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-type">signExtend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1264"></span><span id="signExtend"><span class="annot"><span class="annottext">signExtend :: Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var hs-var">signExtend</span></a></span></span><span> </span><span id="local-6989586621682861673"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861673"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861674"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861674"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861675"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861675"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621682861676"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861676"><span class="hs-identifier hs-var">_r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861673"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861674"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;This is not a sign extension, but a truncation.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; OrdList Instr) -&gt; SDoc -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861673"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861674"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1265"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span id="local-6989586621682861677"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861677"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861678"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861678"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861679"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861679"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621682861680"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861680"><span class="hs-identifier hs-var">_r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861677"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861678"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected width (max is 64bit):&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; OrdList Instr) -&gt; SDoc -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861677"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861678"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1266"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span id="local-6989586621682861681"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861681"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861682"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861682"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861683"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861683"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861684"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861684"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861681"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861682"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861683"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861684"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-1267"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span id="local-6989586621682861685"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861685"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861686"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861686"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861687"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861687"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861688"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861688"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861685"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861686"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861686"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861688"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861685"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861687"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1268"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span id="local-6989586621682861689"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861689"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861690"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861690"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861691"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861691"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861692"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861692"><span class="hs-identifier hs-var">r'</span></a></span></span><span>
</span><span id="line-1269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861689"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861690"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1270"></span><span>      </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span>
</span><span id="line-1271"></span><span>        </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1272"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sign-extend register (SEXT.W)&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861691"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861689"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861690"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>          </span><span class="hs-comment">-- `ADDIW r r 0` is the pseudo-op SEXT.W</span><span>
</span><span id="line-1274"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861690"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861692"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861689"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861691"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span id="local-6989586621682861693"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861693"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861694"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861694"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861695"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861695"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861696"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861696"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1276"></span><span>  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1277"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1278"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;narrow register signed&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861695"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861693"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861695"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861694"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1279"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861694"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861696"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861693"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861695"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861698"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1280"></span><span>      </span><span class="hs-comment">-- signed (arithmetic) right shift</span><span>
</span><span id="line-1281"></span><span>      </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861694"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861696"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861694"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861696"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861698"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1282"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1283"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1284"></span><span>    </span><span id="local-6989586621682861698"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861698"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861693"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1285"></span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- | Sign extends to 64bit, if needed and reduces the precission to the target `Width` (@w'@)</span><span>
</span><span id="line-1287"></span><span class="hs-comment">--</span><span>
</span><span id="line-1288"></span><span class="hs-comment">-- Source `Reg` @r@ stays untouched, while the conversion happens on destination</span><span>
</span><span id="line-1289"></span><span class="hs-comment">-- `Reg` @r'@.</span><span>
</span><span id="line-1290"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-type">signExtendAdjustPrecission</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1291"></span><span id="signExtendAdjustPrecission"><span class="annot"><span class="annottext">signExtendAdjustPrecission :: Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var hs-var">signExtendAdjustPrecission</span></a></span></span><span> </span><span id="local-6989586621682861699"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861699"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861700"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861700"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861701"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861701"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621682861702"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861702"><span class="hs-identifier hs-var">_r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861699"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861700"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected width (max is 64bit):&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; OrdList Instr) -&gt; SDoc -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861699"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861700"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1292"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span id="local-6989586621682861703"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861703"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861704"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861704"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861705"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861705"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861706"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861706"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861703"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861704"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; Reg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861706"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-1293"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span id="local-6989586621682861707"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861707"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861708"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861708"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861709"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861709"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861710"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861710"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861707"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861708"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861708"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861710"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861707"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861709"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1294"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span id="local-6989586621682861711"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861711"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861712"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861712"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861713"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861713"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861714"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861714"><span class="hs-identifier hs-var">r'</span></a></span></span><span>
</span><span id="line-1295"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861711"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861712"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1296"></span><span>      </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span>
</span><span id="line-1297"></span><span>        </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1298"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sign-extend register (SEXT.W)&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861713"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861711"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861712"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1299"></span><span>          </span><span class="hs-comment">-- `ADDIW r r 0` is the pseudo-op SEXT.W</span><span>
</span><span id="line-1300"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861712"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861714"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861711"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861713"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span id="local-6989586621682861715"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861715"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861716"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861717"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861717"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861718"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861718"><span class="hs-identifier hs-var">r'</span></a></span></span><span>
</span><span id="line-1302"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861715"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1303"></span><span>      </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1304"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1305"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;narrow register signed&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861717"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861715"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861717"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1306"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861718"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861715"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861717"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861719"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1307"></span><span>          </span><span class="hs-comment">-- signed (arithmetic) right shift</span><span>
</span><span id="line-1308"></span><span>          </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861718"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861718"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861719"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1311"></span><span>    </span><span id="local-6989586621682861719"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861719"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861716"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1312"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtendAdjustPrecission"><span class="hs-identifier hs-var">signExtendAdjustPrecission</span></a></span><span> </span><span id="local-6989586621682861720"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861720"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861721"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861721"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861722"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861722"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682861723"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861723"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1313"></span><span>  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1314"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1315"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sign extend register&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861722"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861720"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861722"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861721"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1316"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861721"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861723"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861720"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861722"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861724"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1317"></span><span>      </span><span class="hs-comment">-- signed (arithmetic) right shift</span><span>
</span><span id="line-1318"></span><span>      </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-var">SRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861721"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861723"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861721"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861723"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861724"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1319"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1320"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1321"></span><span>    </span><span id="local-6989586621682861724"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861724"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861720"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1322"></span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- | Instructions to truncate the value in the given register from width @w@</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- to width @w'@.</span><span>
</span><span id="line-1325"></span><span class="hs-comment">--</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- In other words, it just cuts the width out of the register. N.B.: This</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- ignores signedness (no sign extension takes place)!</span><span>
</span><span id="line-1328"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-type">truncateReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#OrdList"><span class="hs-identifier hs-type">OrdList</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span>
</span><span id="line-1329"></span><span id="truncateReg"><span class="annot"><span class="annottext">truncateReg :: Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var hs-var">truncateReg</span></a></span></span><span> </span><span id="local-6989586621682861725"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861725"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span id="local-6989586621682861726"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861726"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861727"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861727"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861726"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-1330"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span id="local-6989586621682861728"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861728"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span id="local-6989586621682861729"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861729"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861730"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861730"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861729"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot truncate to width bigger than register size (max is 64bit):&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; OrdList Instr) -&gt; SDoc -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861730"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861729"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1331"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span id="local-6989586621682861731"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861731"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861732"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861732"><span class="hs-identifier hs-var">_w'</span></a></span></span><span> </span><span id="local-6989586621682861733"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861733"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861731"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected register size (max is 64bit):&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; OrdList Instr) -&gt; SDoc -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861733"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
forall doc. IsLine doc =&gt; Char -&gt; doc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861731"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1332"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span id="local-6989586621682861734"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861734"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861735"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861735"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621682861736"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1333"></span><span>  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1334"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1335"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;truncate register&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861734"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861735"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1336"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-var">SLL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861735"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861734"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861737"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1337"></span><span>      </span><span class="hs-comment">-- SHL ignores signedness!</span><span>
</span><span id="line-1338"></span><span>      </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-var">SRL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861735"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861734"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861736"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861737"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1340"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1341"></span><span>    </span><span id="local-6989586621682861737"><span class="annot"><span class="annottext">shift :: Int
</span><a href="#local-6989586621682861737"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Int
</span><a href="GHC.Cmm.Type.html#widthInBits"><span class="hs-identifier hs-var">widthInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861735"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- | Given a 'Register', produce a new 'Register' with an instruction block</span><span>
</span><span id="line-1344"></span><span class="hs-comment">-- which will check the value for alignment. Used for @-falignment-sanitisation@.</span><span>
</span><span id="line-1345"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-type">addAlignmentCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Register"><span class="hs-identifier hs-type">Register</span></a></span><span>
</span><span id="line-1346"></span><span id="addAlignmentCheck"><span class="annot"><span class="annottext">addAlignmentCheck :: Int -&gt; Width -&gt; Register -&gt; NatM Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#addAlignmentCheck"><span class="hs-identifier hs-var hs-var">addAlignmentCheck</span></a></span></span><span> </span><span id="local-6989586621682861738"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861738"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621682861739"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861739"><span class="hs-identifier hs-var">wordWidth</span></a></span></span><span> </span><span id="local-6989586621682861740"><span class="annot"><span class="annottext">Register
</span><a href="#local-6989586621682861740"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1347"></span><span>  </span><span id="local-6989586621682861741"><span class="annot"><a href="#local-6989586621682861741"><span class="hs-identifier hs-var">jumpReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Format -&gt; NatM Reg
</span><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-var">getNewRegNat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span>
</span><span id="line-1348"></span><span>  </span><span id="local-6989586621682861742"><span class="annot"><a href="#local-6989586621682861742"><span class="hs-identifier hs-var">cmpReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1349"></span><span>  </span><span id="local-6989586621682861743"><span class="annot"><a href="#local-6989586621682861743"><span class="hs-identifier hs-var">okayLblId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getBlockIdNat"><span class="hs-identifier hs-type">getBlockIdNat</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861740"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1352"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682861744"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861744"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682861745"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861745"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861746"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861746"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; OrdList Instr -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-var">Fixed</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861744"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861745"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861746"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; BlockId -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861747"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861744"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861741"><span class="hs-identifier hs-var">jumpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861742"><span class="hs-identifier hs-var">cmpReg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861743"><span class="hs-identifier hs-var">okayLblId</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861745"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1353"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621682861748"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861748"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682861749"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Format -&gt; (Reg -&gt; OrdList Instr) -&gt; Register
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861748"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682861750"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861750"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861750"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Reg -&gt; Reg -&gt; BlockId -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861747"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861748"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861741"><span class="hs-identifier hs-var">jumpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861742"><span class="hs-identifier hs-var">cmpReg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861743"><span class="hs-identifier hs-var">okayLblId</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861750"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1355"></span><span>    </span><span class="annot"><a href="#local-6989586621682861747"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1356"></span><span>    </span><span id="local-6989586621682861747"><span class="annot"><span class="annottext">check :: Format -&gt; Reg -&gt; Reg -&gt; BlockId -&gt; Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861747"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621682861751"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861751"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682861752"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861752"><span class="hs-identifier hs-var">jumpReg</span></a></span></span><span> </span><span id="local-6989586621682861753"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861753"><span class="hs-identifier hs-var">cmpReg</span></a></span></span><span> </span><span id="local-6989586621682861754"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861754"><span class="hs-identifier hs-var">okayLblId</span></a></span></span><span> </span><span id="local-6989586621682861755"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861755"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1357"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861756"><span class="annot"><span class="annottext">width :: Width
</span><a href="#local-6989586621682861756"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861751"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-1358"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; OrdList Instr -&gt; OrdList Instr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861751"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>            </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr) -&gt; OrdList Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1360"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-1361"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Alignment check - alignment: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall doc. IsLine doc =&gt; Int -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861738"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, word width: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861739"><span class="hs-identifier hs-var">wordWidth</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1362"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#AND"><span class="hs-identifier hs-var">AND</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861756"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861753"><span class="hs-identifier hs-var">cmpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861756"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861755"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; Imm -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Imm) -&gt; Int -&gt; Imm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861738"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1363"></span><span>                </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-var">BCOND</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861756"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861753"><span class="hs-identifier hs-var">cmpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-var">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861754"><span class="hs-identifier hs-var">okayLblId</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1364"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Alignment check failed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1365"></span><span>                </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861752"><span class="hs-identifier hs-var">jumpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="annot"><span class="annottext">(Imm -&gt; Operand) -&gt; Imm -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="annot"><span class="annottext">CLabel
</span><a href="GHC.Cmm.CLabel.html#mkBadAlignmentLabel"><span class="hs-identifier hs-var">mkBadAlignmentLabel</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1366"></span><span>                </span><span class="annot"><span class="annottext">Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-var">TReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861752"><span class="hs-identifier hs-var">jumpReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1367"></span><span>                </span><span class="annot"><span class="annottext">BlockId -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#NEWBLOCK"><span class="hs-identifier hs-var">NEWBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861754"><span class="hs-identifier hs-var">okayLblId</span></a></span><span>
</span><span id="line-1368"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1371"></span><span class="hs-comment">--  The 'Amode' type: Memory addressing modes passed up the tree.</span><span>
</span><span id="line-1372"></span><span class="hs-keyword">data</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Amode"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#AddrMode"><span class="hs-identifier hs-type">AddrMode</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1373"></span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- | Provide the value of a `CmmExpr` with an `Amode`</span><span>
</span><span id="line-1375"></span><span class="hs-comment">--</span><span>
</span><span id="line-1376"></span><span class="hs-comment">-- N.B. this function should be used to provide operands to load and store</span><span>
</span><span id="line-1377"></span><span class="hs-comment">-- instructions with signed 12bit wide immediates (S &amp; I types). For other</span><span>
</span><span id="line-1378"></span><span class="hs-comment">-- immediate sizes and formats (e.g. B type uses multiples of 2) this function</span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- would need to be adjusted.</span><span>
</span><span id="line-1380"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1381"></span><span>  </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1382"></span><span>  </span><span class="annot"><span class="hs-comment">-- | width of loaded value</span></span><span>
</span><span id="line-1383"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1384"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1385"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span>
</span><span id="line-1386"></span><span class="hs-comment">-- TODO: Specialize stuff we can destructure here.</span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span class="hs-comment">-- LDR/STR: Immediate can be represented with 12bits</span><span>
</span><span id="line-1389"></span><span id="getAmode"><span class="annot"><span class="annottext">getAmode :: Platform -&gt; Width -&gt; CmmExpr -&gt; NatM Amode
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-var hs-var">getAmode</span></a></span></span><span> </span><span id="local-6989586621682861764"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861764"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682861765"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861765"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmRegOff"><span class="hs-identifier hs-type">CmmRegOff</span></a></span><span> </span><span id="local-6989586621682861766"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861766"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861767"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861767"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1390"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861765"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1391"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861767"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1392"></span><span>      </span><span class="annot"><span class="annottext">Amode -&gt; NatM Amode
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Amode -&gt; NatM Amode) -&gt; Amode -&gt; NatM Amode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AddrMode -&gt; OrdList Instr -&gt; Amode
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-var">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-var">AddrRegImm</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861768"><span class="hs-identifier hs-var">reg'</span></a></span><span> </span><span class="annot"><span class="annottext">Imm
</span><a href="#local-6989586621682861769"><span class="hs-identifier hs-var">off'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span>
</span><span id="line-1393"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1394"></span><span>    </span><span id="local-6989586621682861768"><span class="annot"><span class="annottext">reg' :: Reg
</span><a href="#local-6989586621682861768"><span class="hs-identifier hs-var hs-var">reg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861764"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861766"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-1395"></span><span>    </span><span id="local-6989586621682861769"><span class="annot"><span class="annottext">off' :: Imm
</span><a href="#local-6989586621682861769"><span class="hs-identifier hs-var hs-var">off'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861767"><span class="hs-identifier hs-var">off</span></a></span><span>
</span><span id="line-1396"></span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- For Stores we often see something like this:</span><span>
</span><span id="line-1398"></span><span class="hs-comment">-- CmmStore (CmmMachOp (MO_Add w) [CmmLoad expr, CmmLit (CmmInt n w')]) (expr2)</span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- E.g. a CmmStoreOff really. This can be translated to `str $expr2, [$expr, #n ]</span><span>
</span><span id="line-1400"></span><span class="hs-comment">-- for `n` in range.</span><span>
</span><span id="line-1401"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span id="local-6989586621682861770"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861770"><span class="hs-identifier hs-var">_platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add"><span class="hs-identifier hs-type">MO_Add</span></a></span><span> </span><span id="local-6989586621682861771"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861771"><span class="hs-identifier hs-var">_w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861772"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861772"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861773"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861773"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682861774"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861774"><span class="hs-identifier hs-var">_w'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1402"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861773"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1403"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-1404"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682861775"><span class="annot"><a href="#local-6989586621682861775"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861776"><span class="annot"><a href="#local-6989586621682861776"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861777"><span class="annot"><a href="#local-6989586621682861777"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861772"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1405"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-type">AddrRegImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861775"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-type">ImmInteger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861773"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861777"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1406"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span id="local-6989586621682861778"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861778"><span class="hs-identifier hs-var">_platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Sub"><span class="hs-identifier hs-type">MO_Sub</span></a></span><span> </span><span id="local-6989586621682861779"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861779"><span class="hs-identifier hs-var">_w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861780"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861780"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span id="local-6989586621682861781"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861781"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682861782"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861782"><span class="hs-identifier hs-var">_w'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1407"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
forall a. (Num a, Ord a) =&gt; a -&gt; Bool
</span><a href="GHC.CmmToAsm.RV64.Instr.html#fitsIn12bitImm"><span class="hs-identifier hs-var">fitsIn12bitImm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682861781"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1408"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-1409"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682861783"><span class="annot"><a href="#local-6989586621682861783"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861784"><span class="annot"><a href="#local-6989586621682861784"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861785"><span class="annot"><a href="#local-6989586621682861785"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861780"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1410"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-type">AddrRegImm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861783"><span class="hs-identifier hs-type">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInteger"><span class="hs-identifier hs-type">ImmInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><a href="#local-6989586621682861781"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861785"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1411"></span><span>
</span><span id="line-1412"></span><span class="hs-comment">-- Generic case</span><span>
</span><span id="line-1413"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-var">getAmode</span></a></span><span> </span><span id="local-6989586621682861786"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861786"><span class="hs-identifier hs-var">_platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682861787"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861787"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1415"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682861788"><span class="annot"><a href="#local-6989586621682861788"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861789"><span class="annot"><a href="#local-6989586621682861789"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861790"><span class="annot"><a href="#local-6989586621682861790"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861787"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1416"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-type">AddrReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861788"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861790"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1417"></span><span>
</span><span id="line-1418"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1419"></span><span class="hs-comment">-- Generating assignments</span><span>
</span><span id="line-1420"></span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- Assignments are really at the heart of the whole code generation</span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- business.  Almost all top-level nodes of any real importance are</span><span>
</span><span id="line-1423"></span><span class="hs-comment">-- assignments, which correspond to loads, stores, or register</span><span>
</span><span id="line-1424"></span><span class="hs-comment">-- transfers.  If we're really lucky, some of the register transfers</span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- will go away, because we can use the destination register to</span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- complete the code generation for the right hand side.  This only</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- fails when the right hand side is forced into a fixed register</span><span>
</span><span id="line-1428"></span><span class="hs-comment">-- (e.g. the result of a call).</span><span>
</span><span id="line-1429"></span><span>
</span><span id="line-1430"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-type">assignMem_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1431"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-type">assignReg_IntCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1432"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-type">assignMem_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1433"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-type">assignReg_FltCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#CmmReg"><span class="hs-identifier hs-type">CmmReg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1434"></span><span id="assignMem_IntCode"><span class="annot"><span class="annottext">assignMem_IntCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var hs-var">assignMem_IntCode</span></a></span></span><span> </span><span id="local-6989586621682861792"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861792"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621682861793"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861793"><span class="hs-identifier hs-var">addrE</span></a></span></span><span> </span><span id="local-6989586621682861794"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861794"><span class="hs-identifier hs-var">srcE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1435"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1436"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682861795"><span class="annot"><a href="#local-6989586621682861795"><span class="hs-identifier hs-var">src_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861796"><span class="annot"><a href="#local-6989586621682861796"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861797"><span class="annot"><a href="#local-6989586621682861797"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861794"><span class="hs-identifier hs-var">srcE</span></a></span><span>
</span><span id="line-1437"></span><span>    </span><span id="local-6989586621682861798"><span class="annot"><a href="#local-6989586621682861798"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1438"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861799"><span class="annot"><a href="#local-6989586621682861799"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861792"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1439"></span><span>    </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Amode"><span class="hs-identifier hs-type">Amode</span></a></span><span> </span><span id="local-6989586621682861800"><span class="annot"><a href="#local-6989586621682861800"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682861801"><span class="annot"><a href="#local-6989586621682861801"><span class="hs-identifier hs-var">addr_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getAmode"><span class="hs-identifier hs-type">getAmode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861798"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861799"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861793"><span class="hs-identifier hs-type">addrE</span></a></span><span>
</span><span id="line-1440"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-type">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;CmmStore&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682861793"><span class="hs-identifier hs-type">addrE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682861794"><span class="hs-identifier hs-type">srcE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1441"></span><span>      </span><span class="annot"><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-type">`consOL`</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621682861797"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1442"></span><span>                   </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861801"><span class="hs-identifier hs-type">addr_code</span></a></span><span>
</span><span id="line-1443"></span><span>                   </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-type">STR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861792"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861799"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861795"><span class="hs-identifier hs-type">src_reg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-type">OpAddr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861800"><span class="hs-identifier hs-type">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1444"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-1445"></span><span>
</span><span id="line-1446"></span><span id="assignReg_IntCode"><span class="annot"><span class="annottext">assignReg_IntCode :: Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var hs-var">assignReg_IntCode</span></a></span></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682861805"><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861805"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621682861806"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861806"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1447"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1448"></span><span>    </span><span id="local-6989586621682861807"><span class="annot"><a href="#local-6989586621682861807"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1449"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861808"><span class="annot"><a href="#local-6989586621682861808"><span class="hs-identifier hs-var hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682861807"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861805"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-1450"></span><span>    </span><span id="local-6989586621682861809"><span class="annot"><a href="#local-6989586621682861809"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegister"><span class="hs-identifier hs-type">getRegister</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861806"><span class="hs-identifier hs-type">src</span></a></span><span>
</span><span id="line-1451"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861809"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1452"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682861810"><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861810"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1453"></span><span>        </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CmmAssign&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861805"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861806"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>          </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-var">`consOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; OrdList Instr
</span><a href="#local-6989586621682861810"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861808"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-1455"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#Fixed"><span class="hs-identifier hs-type">Fixed</span></a></span><span> </span><span id="local-6989586621682861811"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861811"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621682861812"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861812"><span class="hs-identifier hs-var">freg</span></a></span></span><span> </span><span id="local-6989586621682861813"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861813"><span class="hs-identifier hs-var">fcode</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1456"></span><span>        </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;CmmAssign&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmReg -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmReg
</span><a href="#local-6989586621682861805"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861806"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1457"></span><span>          </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-var">`consOL`</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861813"><span class="hs-identifier hs-var">fcode</span></a></span><span>
</span><span id="line-1458"></span><span>                       </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861811"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861808"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861811"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861812"><span class="hs-identifier hs-var">freg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1459"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-1460"></span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- Let's treat Floating point stuff</span><span>
</span><span id="line-1462"></span><span class="hs-comment">-- as integer code for now. Opaque.</span><span>
</span><span id="line-1463"></span><span id="assignMem_FltCode"><span class="annot"><span class="annottext">assignMem_FltCode :: Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_FltCode"><span class="hs-identifier hs-var hs-var">assignMem_FltCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmExpr -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignMem_IntCode"><span class="hs-identifier hs-var">assignMem_IntCode</span></a></span><span>
</span><span id="line-1464"></span><span>
</span><span id="line-1465"></span><span id="assignReg_FltCode"><span class="annot"><span class="annottext">assignReg_FltCode :: Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_FltCode"><span class="hs-identifier hs-var hs-var">assignReg_FltCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; CmmReg -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#assignReg_IntCode"><span class="hs-identifier hs-var">assignReg_IntCode</span></a></span><span>
</span><span id="line-1466"></span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- Jumps</span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- AArch64 has 26bits for targets, whereas RiscV only has 20.</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- Thus we need to distinguish between far (outside of the)</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- current compilation unit. And regular branches.</span><span>
</span><span id="line-1472"></span><span class="hs-comment">-- RiscV has &#177;2MB of displacement, whereas AArch64 has &#177;128MB.</span><span>
</span><span id="line-1473"></span><span class="hs-comment">-- Thus for most branches we can get away with encoding it</span><span>
</span><span id="line-1474"></span><span class="hs-comment">-- directly in the instruction rather than always loading the</span><span>
</span><span id="line-1475"></span><span class="hs-comment">-- address into a register and then using that to jump.</span><span>
</span><span id="line-1476"></span><span class="hs-comment">-- Under the assumption that our linked build product is less than</span><span>
</span><span id="line-1477"></span><span class="hs-comment">-- ~2*128MB of TEXT, and there are no jump that span the whole</span><span>
</span><span id="line-1478"></span><span class="hs-comment">-- TEXT segment.</span><span>
</span><span id="line-1479"></span><span class="hs-comment">-- Something where riscv's compressed instruction might come in</span><span>
</span><span id="line-1480"></span><span class="hs-comment">-- handy.</span><span>
</span><span id="line-1481"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genJump"><span class="hs-identifier hs-type">genJump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-comment">{-the branch target-}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1482"></span><span id="genJump"><span class="annot"><span class="annottext">genJump :: CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genJump"><span class="hs-identifier hs-var hs-var">genJump</span></a></span></span><span> </span><span id="local-6989586621682861814"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861814"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1483"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682861815"><span class="annot"><a href="#local-6989586621682861815"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861816"><span class="annot"><a href="#local-6989586621682861816"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861817"><span class="annot"><a href="#local-6989586621682861817"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861814"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1484"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682861817"><span class="hs-identifier hs-type">code</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-type">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-type">annExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861814"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-type">TReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861815"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1485"></span><span>
</span><span id="line-1486"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1487"></span><span class="hs-comment">--  Unconditional branches</span><span>
</span><span id="line-1488"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genBranch"><span class="hs-identifier hs-type">genBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1489"></span><span id="genBranch"><span class="annot"><span class="annottext">genBranch :: BlockId -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genBranch"><span class="hs-identifier hs-var hs-var">genBranch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; NatM (OrdList Instr))
-&gt; (BlockId -&gt; OrdList Instr) -&gt; BlockId -&gt; NatM (OrdList Instr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span> </span><span class="annot"><span class="annottext">([Instr] -&gt; OrdList Instr)
-&gt; (BlockId -&gt; [Instr]) -&gt; BlockId -&gt; OrdList Instr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; [Instr]
</span><a href="GHC.CmmToAsm.RV64.Instr.html#mkJumpInstr"><span class="hs-identifier hs-var">mkJumpInstr</span></a></span><span>
</span><span id="line-1490"></span><span>
</span><span id="line-1491"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1492"></span><span class="hs-comment">-- Conditional branches</span><span>
</span><span id="line-1493"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondJump"><span class="hs-identifier hs-type">genCondJump</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1494"></span><span>  </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1495"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1496"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1497"></span><span id="genCondJump"><span class="annot"><span class="annottext">genCondJump :: BlockId -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondJump"><span class="hs-identifier hs-var hs-var">genCondJump</span></a></span></span><span> </span><span id="local-6989586621682861820"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861820"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span id="local-6989586621682861821"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1498"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1499"></span><span>    </span><span class="hs-comment">-- Optimized == 0 case.</span><span>
</span><span id="line-1500"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span id="local-6989586621682861822"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861822"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861823"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861823"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1501"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861824"><span class="annot"><a href="#local-6989586621682861824"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861825"><span class="annot"><a href="#local-6989586621682861825"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861826"><span class="annot"><a href="#local-6989586621682861826"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861823"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1502"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682861826"><span class="hs-identifier hs-type">code_x</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-type">annExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861821"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-type">EQ</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#zero"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861822"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861824"><span class="hs-identifier hs-type">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861820"><span class="hs-identifier hs-type">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1503"></span><span>
</span><span id="line-1504"></span><span>    </span><span class="hs-comment">-- Optimized /= 0 case.</span><span>
</span><span id="line-1505"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span id="local-6989586621682861827"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861827"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861828"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861828"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmLit"><span class="hs-identifier hs-type">CmmLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmInt"><span class="hs-identifier hs-type">CmmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1506"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861829"><span class="annot"><a href="#local-6989586621682861829"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861830"><span class="annot"><a href="#local-6989586621682861830"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861831"><span class="annot"><a href="#local-6989586621682861831"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861828"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1507"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682861831"><span class="hs-identifier hs-type">code_x</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-type">annExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861821"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-type">NE</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#zero"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861827"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861829"><span class="hs-identifier hs-type">reg_x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861820"><span class="hs-identifier hs-type">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span>    </span><span class="hs-comment">-- Generic case.</span><span>
</span><span id="line-1510"></span><span>    </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmMachOp"><span class="hs-identifier hs-type">CmmMachOp</span></a></span><span> </span><span id="local-6989586621682861832"><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861832"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682861833"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861833"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861834"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861834"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1511"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861835"><span class="annot"><span class="annottext">ubcond :: Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861835"><span class="hs-identifier hs-var hs-var">ubcond</span></a></span></span><span> </span><span id="local-6989586621682861836"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861836"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861837"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861837"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1512"></span><span>            </span><span class="hs-comment">-- compute both sides.</span><span>
</span><span id="line-1513"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861838"><span class="annot"><a href="#local-6989586621682861838"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861839"><span class="annot"><a href="#local-6989586621682861839"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861840"><span class="annot"><a href="#local-6989586621682861840"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861833"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1514"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861841"><span class="annot"><a href="#local-6989586621682861841"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861842"><span class="annot"><a href="#local-6989586621682861842"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861843"><span class="annot"><a href="#local-6989586621682861843"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861834"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1515"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861844"><span class="annot"><a href="#local-6989586621682861844"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861836"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861838"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1516"></span><span>                </span><span id="local-6989586621682861845"><span class="annot"><a href="#local-6989586621682861845"><span class="hs-identifier hs-var hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861836"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861841"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1517"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861836"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1518"></span><span>              </span><span id="local-6989586621682861846"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861846"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1519"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1520"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861840"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1521"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861839"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861838"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1522"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861843"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1523"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-var">truncateReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861842"><span class="hs-identifier hs-var">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861841"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1524"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861843"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1525"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-var">BCOND</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861837"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861844"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861845"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-var">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861820"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1526"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1527"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861840"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1528"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861843"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1529"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-var">BCOND</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861837"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861844"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861845"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-var">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861820"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1530"></span><span>
</span><span id="line-1531"></span><span>          </span><span id="local-6989586621682861847"><span class="annot"><span class="annottext">sbcond :: Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var hs-var">sbcond</span></a></span></span><span> </span><span id="local-6989586621682861848"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861848"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861849"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861849"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1532"></span><span>            </span><span class="hs-comment">-- compute both sides.</span><span>
</span><span id="line-1533"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861850"><span class="annot"><a href="#local-6989586621682861850"><span class="hs-identifier hs-var">reg_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861851"><span class="annot"><a href="#local-6989586621682861851"><span class="hs-identifier hs-var">format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861852"><span class="annot"><a href="#local-6989586621682861852"><span class="hs-identifier hs-var">code_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861833"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1534"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861853"><span class="annot"><a href="#local-6989586621682861853"><span class="hs-identifier hs-var">reg_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861854"><span class="annot"><a href="#local-6989586621682861854"><span class="hs-identifier hs-var">format_y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861855"><span class="annot"><a href="#local-6989586621682861855"><span class="hs-identifier hs-var">code_y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861834"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1535"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861856"><span class="annot"><a href="#local-6989586621682861856"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861848"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861850"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1536"></span><span>                </span><span id="local-6989586621682861857"><span class="annot"><a href="#local-6989586621682861857"><span class="hs-identifier hs-var hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861848"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861853"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1537"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682861848"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1538"></span><span>              </span><span id="local-6989586621682861858"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861858"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1539"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861858"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; [Width] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W8"><span class="hs-identifier hs-var">W8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W16"><span class="hs-identifier hs-var">W16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1540"></span><span>                    </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861852"><span class="hs-identifier hs-var">code_x</span></a></span><span>
</span><span id="line-1541"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861851"><span class="hs-identifier hs-var">format_x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861850"><span class="hs-identifier hs-var">reg_x</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861850"><span class="hs-identifier hs-var">reg_x</span></a></span><span>
</span><span id="line-1542"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861855"><span class="hs-identifier hs-var">code_y</span></a></span><span>
</span><span id="line-1543"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861854"><span class="hs-identifier hs-var">format_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861853"><span class="hs-identifier hs-var">reg_y</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861853"><span class="hs-identifier hs-var">reg_y</span></a></span><span>
</span><span id="line-1544"></span><span>                      </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-var">BCOND</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861849"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861856"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861857"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-var">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861820"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>              </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861852"><span class="hs-identifier hs-var">code_x</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861855"><span class="hs-identifier hs-var">code_y</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmExpr -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-var">annExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-var">BCOND</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861849"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861856"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682861857"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-var">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861820"><span class="hs-identifier hs-var">bid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1546"></span><span>
</span><span id="line-1547"></span><span>          </span><span id="local-6989586621682861860"><span class="annot"><span class="annottext">fbcond :: Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var hs-var">fbcond</span></a></span></span><span> </span><span id="local-6989586621682861861"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861861"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682861862"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682861862"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1548"></span><span>            </span><span class="hs-comment">-- ensure we get float regs</span><span>
</span><span id="line-1549"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861863"><span class="annot"><a href="#local-6989586621682861863"><span class="hs-identifier hs-var">reg_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861864"><span class="annot"><a href="#local-6989586621682861864"><span class="hs-identifier hs-var">_format_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861865"><span class="annot"><a href="#local-6989586621682861865"><span class="hs-identifier hs-var">code_fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-var">getFloatReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861833"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1550"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682861866"><span class="annot"><a href="#local-6989586621682861866"><span class="hs-identifier hs-var">reg_fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861867"><span class="annot"><a href="#local-6989586621682861867"><span class="hs-identifier hs-var">_format_fy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861868"><span class="annot"><a href="#local-6989586621682861868"><span class="hs-identifier hs-var">code_fy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861834"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-1551"></span><span>            </span><span id="local-6989586621682861869"><span class="annot"><a href="#local-6989586621682861869"><span class="hs-identifier hs-var">condOpReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1552"></span><span>            </span><span id="local-6989586621682861870"><span class="annot"><a href="#local-6989586621682861870"><span class="hs-identifier hs-var">oneReg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getNewRegNat"><span class="hs-identifier hs-type">getNewRegNat</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span>
</span><span id="line-1553"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682861865"><span class="hs-identifier hs-type">code_fx</span></a></span><span>
</span><span id="line-1554"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861868"><span class="hs-identifier hs-type">code_fy</span></a></span><span>
</span><span id="line-1555"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#annExpr"><span class="hs-identifier hs-type">annExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861821"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-type">CSET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861869"><span class="hs-identifier hs-type">condOpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861861"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861863"><span class="hs-identifier hs-type">reg_fx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861861"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861866"><span class="hs-identifier hs-type">reg_fy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682861862"><span class="hs-identifier hs-type">cmp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861870"><span class="hs-identifier hs-type">oneReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-type">ImmInt</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1557"></span><span>              </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-type">EQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861869"><span class="hs-identifier hs-type">condOpReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861861"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861870"><span class="hs-identifier hs-type">oneReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861820"><span class="hs-identifier hs-type">bid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1558"></span><span>
</span><span id="line-1559"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MachOp
</span><a href="#local-6989586621682861832"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1560"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Eq"><span class="hs-identifier hs-type">MO_F_Eq</span></a></span><span> </span><span id="local-6989586621682861871"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861871"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861871"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-1561"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ne"><span class="hs-identifier hs-type">MO_F_Ne</span></a></span><span> </span><span id="local-6989586621682861872"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861872"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861872"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-1562"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Gt"><span class="hs-identifier hs-type">MO_F_Gt</span></a></span><span> </span><span id="local-6989586621682861873"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861873"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861873"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FGT"><span class="hs-identifier hs-var">FGT</span></a></span><span>
</span><span id="line-1563"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Ge"><span class="hs-identifier hs-type">MO_F_Ge</span></a></span><span> </span><span id="local-6989586621682861874"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861874"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861874"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FGE"><span class="hs-identifier hs-var">FGE</span></a></span><span>
</span><span id="line-1564"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Lt"><span class="hs-identifier hs-type">MO_F_Lt</span></a></span><span> </span><span id="local-6989586621682861875"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861875"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861875"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FLT"><span class="hs-identifier hs-var">FLT</span></a></span><span>
</span><span id="line-1565"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_F_Le"><span class="hs-identifier hs-type">MO_F_Le</span></a></span><span> </span><span id="local-6989586621682861876"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861876"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861860"><span class="hs-identifier hs-var">fbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861876"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#FLE"><span class="hs-identifier hs-var">FLE</span></a></span><span>
</span><span id="line-1566"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Eq"><span class="hs-identifier hs-type">MO_Eq</span></a></span><span> </span><span id="local-6989586621682861877"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861877"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861877"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-1567"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ne"><span class="hs-identifier hs-type">MO_Ne</span></a></span><span> </span><span id="local-6989586621682861878"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861878"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861878"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span>
</span><span id="line-1568"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Gt"><span class="hs-identifier hs-type">MO_S_Gt</span></a></span><span> </span><span id="local-6989586621682861879"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861879"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861879"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SGT"><span class="hs-identifier hs-var">SGT</span></a></span><span>
</span><span id="line-1569"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Ge"><span class="hs-identifier hs-type">MO_S_Ge</span></a></span><span> </span><span id="local-6989586621682861880"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861880"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861880"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SGE"><span class="hs-identifier hs-var">SGE</span></a></span><span>
</span><span id="line-1570"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Lt"><span class="hs-identifier hs-type">MO_S_Lt</span></a></span><span> </span><span id="local-6989586621682861881"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861881"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861881"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SLT"><span class="hs-identifier hs-var">SLT</span></a></span><span>
</span><span id="line-1571"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Le"><span class="hs-identifier hs-type">MO_S_Le</span></a></span><span> </span><span id="local-6989586621682861882"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861882"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861847"><span class="hs-identifier hs-var">sbcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861882"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#SLE"><span class="hs-identifier hs-var">SLE</span></a></span><span>
</span><span id="line-1572"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Gt"><span class="hs-identifier hs-type">MO_U_Gt</span></a></span><span> </span><span id="local-6989586621682861883"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861883"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861835"><span class="hs-identifier hs-var">ubcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861883"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#UGT"><span class="hs-identifier hs-var">UGT</span></a></span><span>
</span><span id="line-1573"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Ge"><span class="hs-identifier hs-type">MO_U_Ge</span></a></span><span> </span><span id="local-6989586621682861884"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861884"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861835"><span class="hs-identifier hs-var">ubcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861884"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#UGE"><span class="hs-identifier hs-var">UGE</span></a></span><span>
</span><span id="line-1574"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Lt"><span class="hs-identifier hs-type">MO_U_Lt</span></a></span><span> </span><span id="local-6989586621682861885"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861885"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861835"><span class="hs-identifier hs-var">ubcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861885"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#ULT"><span class="hs-identifier hs-var">ULT</span></a></span><span>
</span><span id="line-1575"></span><span>        </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Le"><span class="hs-identifier hs-type">MO_U_Le</span></a></span><span> </span><span id="local-6989586621682861886"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861886"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Cond -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861835"><span class="hs-identifier hs-var">ubcond</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861886"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="GHC.CmmToAsm.RV64.Cond.html#ULE"><span class="hs-identifier hs-var">ULE</span></a></span><span>
</span><span id="line-1576"></span><span>        </span><span class="annot"><span class="annottext">MachOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RV64.genCondJump:case mop: &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc) -&gt; [Char] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1577"></span><span>    </span><span class="annot"><span class="annottext">CmmExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RV64.genCondJump: &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc) -&gt; [Char] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861821"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1578"></span><span>
</span><span id="line-1579"></span><span class="hs-comment">-- | Generate conditional branching instructions</span><span>
</span><span id="line-1580"></span><span class="hs-comment">--</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- This is basically an &quot;if with else&quot; statement.</span><span>
</span><span id="line-1582"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondBranch"><span class="hs-identifier hs-type">genCondBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1583"></span><span>  </span><span class="annot"><span class="hs-comment">-- | the true branch target</span></span><span>
</span><span id="line-1584"></span><span>  </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1585"></span><span>  </span><span class="annot"><span class="hs-comment">-- | the false branch target</span></span><span>
</span><span id="line-1586"></span><span>  </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1587"></span><span>  </span><span class="annot"><span class="hs-comment">-- | the condition on which to branch</span></span><span>
</span><span id="line-1588"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Expr.html#CmmExpr"><span class="hs-identifier hs-type">CmmExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1589"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Instructions</span></span><span>
</span><span id="line-1590"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1591"></span><span id="genCondBranch"><span class="annot"><span class="annottext">genCondBranch :: BlockId -&gt; BlockId -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondBranch"><span class="hs-identifier hs-var hs-var">genCondBranch</span></a></span></span><span> </span><span id="local-6989586621682861887"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861887"><span class="hs-identifier hs-var">true</span></a></span></span><span> </span><span id="local-6989586621682861888"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861888"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621682861889"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861889"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1592"></span><span>  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-identifier hs-var">appOL</span></a></span><span>
</span><span id="line-1593"></span><span>    </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr) -&gt; NatM (OrdList Instr -&gt; OrdList Instr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; CmmExpr -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondJump"><span class="hs-identifier hs-var">genCondJump</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861887"><span class="hs-identifier hs-var">true</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861889"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1594"></span><span>    </span><span class="annot"><span class="annottext">NatM (OrdList Instr -&gt; OrdList Instr)
-&gt; NatM (OrdList Instr) -&gt; NatM (OrdList Instr)
forall a b. NatM (a -&gt; b) -&gt; NatM a -&gt; NatM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genBranch"><span class="hs-identifier hs-var">genBranch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682861888"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-1595"></span><span>
</span><span id="line-1596"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1597"></span><span class="hs-comment">--  Generating C calls</span><span>
</span><span id="line-1598"></span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- | Generate a call to a C function.</span><span>
</span><span id="line-1600"></span><span class="hs-comment">--</span><span>
</span><span id="line-1601"></span><span class="hs-comment">-- - Integer values are passed in GP registers a0-a7.</span><span>
</span><span id="line-1602"></span><span class="hs-comment">-- - Floating point values are passed in FP registers fa0-fa7.</span><span>
</span><span id="line-1603"></span><span class="hs-comment">-- - If there are no free floating point registers, the FP values are passed in GP registers.</span><span>
</span><span id="line-1604"></span><span class="hs-comment">-- - If all GP registers are taken, the values are spilled as whole words (!) onto the stack.</span><span>
</span><span id="line-1605"></span><span class="hs-comment">-- - For integers/words, the return value is in a0.</span><span>
</span><span id="line-1606"></span><span class="hs-comment">-- - The return value is in fa0 if the return type is a floating point value.</span><span>
</span><span id="line-1607"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1608"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- function to call</span><span>
</span><span id="line-1609"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmFormal"><span class="hs-identifier hs-type">CmmFormal</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- where to put the result</span><span>
</span><span id="line-1610"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Node.html#CmmActual"><span class="hs-identifier hs-type">CmmActual</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- arguments (of mixed type)</span><span>
</span><span id="line-1611"></span><span>  </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1612"></span><span class="hs-comment">-- TODO: Specialize where we can.</span><span>
</span><span id="line-1613"></span><span class="hs-comment">-- Generic impl</span><span>
</span><span id="line-1614"></span><span id="genCCall"><span class="annot"><span class="annottext">genCCall :: ForeignTarget -&gt; [CmmFormal] -&gt; [CmmExpr] -&gt; NatM (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCCall"><span class="hs-identifier hs-var hs-var">genCCall</span></a></span></span><span> </span><span id="local-6989586621682861891"><span class="annot"><span class="annottext">target :: ForeignTarget
</span><a href="#local-6989586621682861891"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span id="local-6989586621682861893"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861893"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682861894"><span class="annot"><span class="annottext">ForeignConvention
</span><a href="#local-6989586621682861894"><span class="hs-identifier hs-var">_cconv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861895"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682861895"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682861896"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682861896"><span class="hs-identifier hs-var">arg_regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1615"></span><span>  </span><span class="hs-comment">-- we want to pass arg_regs into allArgRegs</span><span>
</span><span id="line-1616"></span><span>  </span><span class="hs-comment">-- The target :: ForeignTarget call can either</span><span>
</span><span id="line-1617"></span><span>  </span><span class="hs-comment">-- be a foreign procedure with an address expr</span><span>
</span><span id="line-1618"></span><span>  </span><span class="hs-comment">-- and a calling convention.</span><span>
</span><span id="line-1619"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682861897"><span class="annot"><a href="#local-6989586621682861897"><span class="hs-identifier hs-var">call_target_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861898"><span class="annot"><a href="#local-6989586621682861898"><span class="hs-identifier hs-var">call_target_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1620"></span><span>    </span><span class="hs-comment">-- Compute the address of the call target into a register. This</span><span>
</span><span id="line-1621"></span><span>    </span><span class="hs-comment">-- addressing enables us to jump through the whole address space</span><span>
</span><span id="line-1622"></span><span>    </span><span class="hs-comment">-- without further ado. PC-relative addressing would involve</span><span>
</span><span id="line-1623"></span><span>    </span><span class="hs-comment">-- instructions to do similar, though.</span><span>
</span><span id="line-1624"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-1625"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682861899"><span class="annot"><a href="#local-6989586621682861899"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861900"><span class="annot"><a href="#local-6989586621682861900"><span class="hs-identifier hs-var">_format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861901"><span class="annot"><a href="#local-6989586621682861901"><span class="hs-identifier hs-var">reg_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682861893"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1626"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682861899"><span class="hs-identifier hs-type">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682861901"><span class="hs-identifier hs-type">reg_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1627"></span><span>  </span><span class="hs-comment">-- compute the code and register logic for all arg_regs.</span><span>
</span><span id="line-1628"></span><span>  </span><span class="hs-comment">-- this will give us the format information to match on.</span><span>
</span><span id="line-1629"></span><span>  </span><span id="local-6989586621682861902"><span class="annot"><a href="#local-6989586621682861902"><span class="hs-identifier hs-var">arg_regs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861896"><span class="hs-identifier hs-type">arg_regs</span></a></span><span>
</span><span id="line-1630"></span><span>
</span><span id="line-1631"></span><span>  </span><span class="hs-comment">-- Now this is stupid.  Our Cmm expressions doesn't carry the proper sizes</span><span>
</span><span id="line-1632"></span><span>  </span><span class="hs-comment">-- so while in Cmm we might get W64 incorrectly for an int, that is W32 in</span><span>
</span><span id="line-1633"></span><span>  </span><span class="hs-comment">-- STG; this then breaks packing of stack arguments, if we need to pack</span><span>
</span><span id="line-1634"></span><span>  </span><span class="hs-comment">-- for the pcs, e.g. darwinpcs.  Option one would be to fix the Int type</span><span>
</span><span id="line-1635"></span><span>  </span><span class="hs-comment">-- in Cmm proper. Option two, which we choose here is to use extended Hint</span><span>
</span><span id="line-1636"></span><span>  </span><span class="hs-comment">-- information to contain the size information and use that when packing</span><span>
</span><span id="line-1637"></span><span>  </span><span class="hs-comment">-- arguments, spilled onto the stack.</span><span>
</span><span id="line-1638"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682861903"><span class="annot"><a href="#local-6989586621682861903"><span class="hs-identifier hs-var">_res_hints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861904"><span class="annot"><a href="#local-6989586621682861904"><span class="hs-identifier hs-var">arg_hints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Cmm.Node.html#foreignTargetHints"><span class="hs-identifier hs-type">foreignTargetHints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861891"><span class="hs-identifier hs-type">target</span></a></span><span>
</span><span id="line-1639"></span><span>      </span><span id="local-6989586621682861906"><span class="annot"><a href="#local-6989586621682861906"><span class="hs-identifier hs-var hs-var">arg_regs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Reg, Format, OrdList Instr)
 -&gt; ForeignHint -&gt; (Reg, Format, ForeignHint, OrdList Instr))
-&gt; [(Reg, Format, OrdList Instr)]
-&gt; [ForeignHint]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682861908"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861908"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861909"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861909"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861910"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861910"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861911"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861911"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861908"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861909"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861911"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861910"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, OrdList Instr)]
</span><a href="#local-6989586621682861902"><span class="hs-identifier hs-var">arg_regs'</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignHint]
</span><a href="#local-6989586621682861904"><span class="hs-identifier hs-var">arg_hints</span></a></span><span>
</span><span id="line-1640"></span><span>
</span><span id="line-1641"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682861912"><span class="annot"><a href="#local-6989586621682861912"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861913"><span class="annot"><a href="#local-6989586621682861913"><span class="hs-identifier hs-var">passRegs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861914"><span class="annot"><a href="#local-6989586621682861914"><span class="hs-identifier hs-var">passArgumentsCode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-type">passArguments</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#allGpArgRegs"><span class="hs-identifier hs-type">allGpArgRegs</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#allFpArgRegs"><span class="hs-identifier hs-type">allFpArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861906"><span class="hs-identifier hs-type">arg_regs''</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span>  </span><span id="local-6989586621682861918"><span class="annot"><a href="#local-6989586621682861918"><span class="hs-identifier hs-var">readResultsCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-type">readResults</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#allGpArgRegs"><span class="hs-identifier hs-type">allGpArgRegs</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#allFpArgRegs"><span class="hs-identifier hs-type">allFpArgRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861895"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-type">nilOL</span></a></span><span>
</span><span id="line-1644"></span><span>
</span><span id="line-1645"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861934"><span class="annot"><a href="#local-6989586621682861934"><span class="hs-identifier hs-var hs-var">moveStackDown</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1646"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1647"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#PUSH_STACK_FRAME"><span class="hs-identifier hs-var">PUSH_STACK_FRAME</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1648"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-1649"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1650"></span><span>      </span><span class="annot"><a href="#local-6989586621682861934"><span class="hs-identifier hs-var">moveStackDown</span></a></span><span> </span><span id="local-6989586621682861937"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861937"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861937"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; OrdList Instr
</span><a href="#local-6989586621682861934"><span class="hs-identifier hs-var">moveStackDown</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861937"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1651"></span><span>      </span><span class="annot"><a href="#local-6989586621682861934"><span class="hs-identifier hs-var">moveStackDown</span></a></span><span> </span><span id="local-6989586621682861940"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861940"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1652"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1653"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#PUSH_STACK_FRAME"><span class="hs-identifier hs-var">PUSH_STACK_FRAME</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1654"></span><span>            </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-var">SUB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861940"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1655"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861940"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-1656"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1657"></span><span>      </span><span id="local-6989586621682861950"><span class="annot"><a href="#local-6989586621682861950"><span class="hs-identifier hs-var hs-var">moveStackUp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1658"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1659"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#POP_STACK_FRAME"><span class="hs-identifier hs-var">POP_STACK_FRAME</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1660"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1661"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1662"></span><span>      </span><span class="annot"><a href="#local-6989586621682861950"><span class="hs-identifier hs-var">moveStackUp</span></a></span><span> </span><span id="local-6989586621682861952"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861952"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861952"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; OrdList Instr
</span><a href="#local-6989586621682861950"><span class="hs-identifier hs-var">moveStackUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861952"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1663"></span><span>      </span><span class="annot"><a href="#local-6989586621682861950"><span class="hs-identifier hs-var">moveStackUp</span></a></span><span> </span><span id="local-6989586621682861953"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861953"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1664"></span><span>        </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1665"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-var">ADD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861953"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1666"></span><span>            </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#POP_STACK_FRAME"><span class="hs-identifier hs-var">POP_STACK_FRAME</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1667"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#DELTA"><span class="hs-identifier hs-var">DELTA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1668"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1669"></span><span>
</span><span id="line-1670"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861954"><span class="annot"><a href="#local-6989586621682861954"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1671"></span><span>        </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861898"><span class="hs-identifier hs-var">call_target_code</span></a></span><span> </span><span class="hs-comment">-- compute the label (possibly into a register)</span><span>
</span><span id="line-1672"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; OrdList Instr
</span><a href="#local-6989586621682861934"><span class="hs-identifier hs-var">moveStackDown</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861912"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span>
</span><span id="line-1673"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861914"><span class="hs-identifier hs-var">passArgumentsCode</span></a></span><span> </span><span class="hs-comment">-- put the arguments into x0, ...</span><span>
</span><span id="line-1674"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#BL"><span class="hs-identifier hs-var">BL</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861897"><span class="hs-identifier hs-var">call_target_reg</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861913"><span class="hs-identifier hs-var">passRegs</span></a></span><span> </span><span class="hs-comment">-- branch and link (C calls aren't tail calls, but return)</span><span>
</span><span id="line-1675"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861918"><span class="hs-identifier hs-var">readResultsCode</span></a></span><span> </span><span class="hs-comment">-- parse the results into registers</span><span>
</span><span id="line-1676"></span><span>          </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; OrdList Instr
</span><a href="#local-6989586621682861950"><span class="hs-identifier hs-var">moveStackUp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861912"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span>
</span><span id="line-1677"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682861954"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1678"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1679"></span><span>    </span><span class="hs-comment">-- Implementiation of the RISCV ABI calling convention.</span><span>
</span><span id="line-1680"></span><span>    </span><span class="hs-comment">-- https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/948463cd5dbebea7c1869e20146b17a2cc8fda2f/riscv-cc.adoc#integer-calling-convention</span><span>
</span><span id="line-1681"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-type">passArguments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#Format"><span class="hs-identifier hs-type">Format</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#ForeignHint"><span class="hs-identifier hs-type">ForeignHint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1682"></span><span>    </span><span class="hs-comment">-- Base case: no more arguments to pass (left)</span><span>
</span><span id="line-1683"></span><span>    </span><span id="local-6989586621682861915"><span class="annot"><span class="annottext">passArguments :: [Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var hs-var">passArguments</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682861956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861956"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682861957"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861957"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682861958"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861958"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, [Reg], OrdList Instr) -&gt; NatM (Int, [Reg], OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861956"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861957"><span class="hs-identifier hs-var">accumRegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861958"><span class="hs-identifier hs-var">accumCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1684"></span><span>    </span><span class="hs-comment">-- Still have GP regs, and we want to pass an GP argument.</span><span>
</span><span id="line-1685"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682861959"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861959"><span class="hs-identifier hs-var">gpReg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682861960"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861960"><span class="hs-identifier hs-var">gpRegs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861961"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861961"><span class="hs-identifier hs-var">fpRegs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682861962"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861962"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861963"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861963"><span class="hs-identifier hs-var">format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861964"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861964"><span class="hs-identifier hs-var">hint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861965"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861965"><span class="hs-identifier hs-var">code_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682861966"><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861966"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861967"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861967"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682861968"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861968"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682861969"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861969"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861963"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1686"></span><span>      </span><span class="hs-comment">-- RISCV64 Integer Calling Convention: &quot;When passed in registers or on the</span><span>
</span><span id="line-1687"></span><span>      </span><span class="hs-comment">-- stack, integer scalars narrower than XLEN bits are widened according to</span><span>
</span><span id="line-1688"></span><span>      </span><span class="hs-comment">-- the sign of their type up to 32 bits, then sign-extended to XLEN bits.&quot;</span><span>
</span><span id="line-1689"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861970"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682861970"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861963"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1690"></span><span>          </span><span id="local-6989586621682861971"><span class="annot"><span class="annottext">assignArg :: OrdList Instr
</span><a href="#local-6989586621682861971"><span class="hs-identifier hs-var hs-var">assignArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1691"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861964"><span class="hs-identifier hs-var">hint</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignHint -&gt; ForeignHint -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#SignedHint"><span class="hs-identifier hs-var">SignedHint</span></a></span><span>
</span><span id="line-1692"></span><span>              </span><span class="hs-keyword">then</span><span>
</span><span id="line-1693"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass gp argument sign-extended (SignedHint): &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861962"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1694"></span><span>                  </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#consOL"><span class="hs-operator hs-var">`consOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861970"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861962"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861959"><span class="hs-identifier hs-var">gpReg</span></a></span><span>
</span><span id="line-1695"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-1696"></span><span>                </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1697"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-var">COMMENT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass gp argument sign-extended (SignedHint): &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861962"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1698"></span><span>                    </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861970"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861959"><span class="hs-identifier hs-var">gpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861970"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861962"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1699"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-1700"></span><span>          </span><span id="local-6989586621682861973"><span class="annot"><span class="annottext">accumCode' :: OrdList Instr
</span><a href="#local-6989586621682861973"><span class="hs-identifier hs-var hs-var">accumCode'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1701"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861969"><span class="hs-identifier hs-var">accumCode</span></a></span><span>
</span><span id="line-1702"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861965"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1703"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861971"><span class="hs-identifier hs-var">assignArg</span></a></span><span>
</span><span id="line-1704"></span><span>      </span><span class="annot"><span class="annottext">[Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861960"><span class="hs-identifier hs-var">gpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861961"><span class="hs-identifier hs-var">fpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861966"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861967"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861959"><span class="hs-identifier hs-var">gpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; [Reg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861968"><span class="hs-identifier hs-var">accumRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861973"><span class="hs-identifier hs-var">accumCode'</span></a></span><span>
</span><span id="line-1705"></span><span>
</span><span id="line-1706"></span><span>    </span><span class="hs-comment">-- Still have FP regs, and we want to pass an FP argument.</span><span>
</span><span id="line-1707"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span id="local-6989586621682861974"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861974"><span class="hs-identifier hs-var">gpRegs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682861975"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861975"><span class="hs-identifier hs-var">fpReg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682861976"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861976"><span class="hs-identifier hs-var">fpRegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682861977"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861977"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861978"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861978"><span class="hs-identifier hs-var">format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861979"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861979"><span class="hs-identifier hs-var">_hint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861980"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861980"><span class="hs-identifier hs-var">code_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682861981"><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861981"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861982"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682861983"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861983"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682861984"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861984"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861978"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1708"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861985"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682861985"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861978"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1709"></span><span>          </span><span id="local-6989586621682861986"><span class="annot"><span class="annottext">mov :: Instr
</span><a href="#local-6989586621682861986"><span class="hs-identifier hs-var hs-var">mov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861985"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861975"><span class="hs-identifier hs-var">fpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861985"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861977"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1710"></span><span>          </span><span id="local-6989586621682861987"><span class="annot"><span class="annottext">accumCode' :: OrdList Instr
</span><a href="#local-6989586621682861987"><span class="hs-identifier hs-var hs-var">accumCode'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1711"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861984"><span class="hs-identifier hs-var">accumCode</span></a></span><span>
</span><span id="line-1712"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861980"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1713"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass fp argument: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861977"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682861986"><span class="hs-identifier hs-var">mov</span></a></span><span>
</span><span id="line-1714"></span><span>      </span><span class="annot"><span class="annottext">[Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861974"><span class="hs-identifier hs-var">gpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861976"><span class="hs-identifier hs-var">fpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861981"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861982"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861975"><span class="hs-identifier hs-var">fpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; [Reg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861983"><span class="hs-identifier hs-var">accumRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861987"><span class="hs-identifier hs-var">accumCode'</span></a></span><span>
</span><span id="line-1715"></span><span>
</span><span id="line-1716"></span><span>    </span><span class="hs-comment">-- No mor regs left to pass. Must pass on stack.</span><span>
</span><span id="line-1717"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682861988"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861988"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861989"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861989"><span class="hs-identifier hs-var">format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861990"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861990"><span class="hs-identifier hs-var">hint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682861991"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861991"><span class="hs-identifier hs-var">code_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682861992"><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861992"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682861993"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861993"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682861994"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861994"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682861995"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861995"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1718"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682861996"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682861996"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861989"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1719"></span><span>          </span><span id="local-6989586621682861997"><span class="annot"><span class="annottext">spOffet :: Int
</span><a href="#local-6989586621682861997"><span class="hs-identifier hs-var hs-var">spOffet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861993"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span>
</span><span id="line-1720"></span><span>          </span><span id="local-6989586621682861998"><span class="annot"><span class="annottext">str :: Instr
</span><a href="#local-6989586621682861998"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-var">STR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682861989"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861996"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861988"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-var">AddrRegImm</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861997"><span class="hs-identifier hs-var">spOffet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1721"></span><span>          </span><span id="local-6989586621682861999"><span class="annot"><span class="annottext">stackCode :: OrdList Instr
</span><a href="#local-6989586621682861999"><span class="hs-identifier hs-var hs-var">stackCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1722"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682861990"><span class="hs-identifier hs-var">hint</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignHint -&gt; ForeignHint -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#SignedHint"><span class="hs-identifier hs-var">SignedHint</span></a></span><span>
</span><span id="line-1723"></span><span>              </span><span class="hs-keyword">then</span><span>
</span><span id="line-1724"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861991"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1725"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Width -&gt; Reg -&gt; Reg -&gt; OrdList Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#signExtend"><span class="hs-identifier hs-var">signExtend</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861996"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861988"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-var">tmpReg</span></a></span><span>
</span><span id="line-1726"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass signed argument (size &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861996"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) on the stack: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-var">tmpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682861998"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1727"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-1728"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861991"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1729"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass unsigned argument (size &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682861996"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) on the stack: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682861988"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682861998"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1730"></span><span>      </span><span class="annot"><span class="annottext">[Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682861992"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682861993"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682861994"><span class="hs-identifier hs-var">accumRegs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861999"><span class="hs-identifier hs-var">stackCode</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682861995"><span class="hs-identifier hs-var">accumCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>
</span><span id="line-1732"></span><span>    </span><span class="hs-comment">-- Still have fpRegs left, but want to pass a GP argument. Must be passed on the stack then.</span><span>
</span><span id="line-1733"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682862001"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862001"><span class="hs-identifier hs-var">fpRegs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682862002"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862002"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862003"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862003"><span class="hs-identifier hs-var">format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862004"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682862004"><span class="hs-identifier hs-var">_hint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862005"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862005"><span class="hs-identifier hs-var">code_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862006"><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682862006"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682862007"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862007"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682862008"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862008"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682862009"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862009"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isIntFormat"><span class="hs-identifier hs-var">isIntFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862003"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1734"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862010"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682862010"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862003"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1735"></span><span>          </span><span id="local-6989586621682862011"><span class="annot"><span class="annottext">spOffet :: Int
</span><a href="#local-6989586621682862011"><span class="hs-identifier hs-var hs-var">spOffet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862007"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span>
</span><span id="line-1736"></span><span>          </span><span id="local-6989586621682862012"><span class="annot"><span class="annottext">str :: Instr
</span><a href="#local-6989586621682862012"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-var">STR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862003"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862010"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862002"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Imm -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrRegImm"><span class="hs-identifier hs-var">AddrRegImm</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#spMachReg"><span class="hs-identifier hs-var">spMachReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmInt"><span class="hs-identifier hs-var">ImmInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862011"><span class="hs-identifier hs-var">spOffet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span>          </span><span id="local-6989586621682862013"><span class="annot"><span class="annottext">stackCode :: OrdList Instr
</span><a href="#local-6989586621682862013"><span class="hs-identifier hs-var hs-var">stackCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1738"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862005"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1739"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass argument (size &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Width -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862010"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) on the stack: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862002"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862012"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1740"></span><span>      </span><span class="annot"><span class="annottext">[Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862001"><span class="hs-identifier hs-var">fpRegs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682862006"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862007"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862008"><span class="hs-identifier hs-var">accumRegs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862013"><span class="hs-identifier hs-var">stackCode</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862009"><span class="hs-identifier hs-var">accumCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1741"></span><span>
</span><span id="line-1742"></span><span>    </span><span class="hs-comment">-- Still have gpRegs left, but want to pass a FP argument. Must be passed in gpReg then.</span><span>
</span><span id="line-1743"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862014"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862014"><span class="hs-identifier hs-var">gpReg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862015"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862015"><span class="hs-identifier hs-var">gpRegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682862016"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862016"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862017"><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862017"><span class="hs-identifier hs-var">format</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862018"><span class="annot"><span class="annottext">ForeignHint
</span><a href="#local-6989586621682862018"><span class="hs-identifier hs-var">_hint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862019"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862019"><span class="hs-identifier hs-var">code_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862020"><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682862020"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682862021"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862021"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span></span><span> </span><span id="local-6989586621682862022"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862022"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682862023"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862023"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Bool
</span><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-var">isFloatFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862017"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1744"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862024"><span class="annot"><span class="annottext">w :: Width
</span><a href="#local-6989586621682862024"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; Width
</span><a href="GHC.CmmToAsm.Format.html#formatToWidth"><span class="hs-identifier hs-var">formatToWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862017"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-1745"></span><span>          </span><span id="local-6989586621682862025"><span class="annot"><span class="annottext">mov :: Instr
</span><a href="#local-6989586621682862025"><span class="hs-identifier hs-var hs-var">mov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-var">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862024"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862014"><span class="hs-identifier hs-var">gpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862024"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862016"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span>          </span><span id="local-6989586621682862026"><span class="annot"><span class="annottext">accumCode' :: OrdList Instr
</span><a href="#local-6989586621682862026"><span class="hs-identifier hs-var hs-var">accumCode'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1747"></span><span>            </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862023"><span class="hs-identifier hs-var">accumCode</span></a></span><span>
</span><span id="line-1748"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862019"><span class="hs-identifier hs-var">code_r</span></a></span><span>
</span><span id="line-1749"></span><span>              </span><span class="annot"><span class="annottext">OrdList Instr -&gt; Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-var">`snocOL`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Pass fp argument in gpReg: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862016"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862025"><span class="hs-identifier hs-var">mov</span></a></span><span>
</span><span id="line-1750"></span><span>      </span><span class="annot"><span class="annottext">[Reg]
-&gt; [Reg]
-&gt; [(Reg, Format, ForeignHint, OrdList Instr)]
-&gt; Int
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (Int, [Reg], OrdList Instr)
</span><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862015"><span class="hs-identifier hs-var">gpRegs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><a href="#local-6989586621682862020"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862021"><span class="hs-identifier hs-var">stackSpaceWords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862014"><span class="hs-identifier hs-var">gpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; [Reg] -&gt; [Reg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862022"><span class="hs-identifier hs-var">accumRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862026"><span class="hs-identifier hs-var">accumCode'</span></a></span><span>
</span><span id="line-1751"></span><span>    </span><span class="annot"><a href="#local-6989586621682861915"><span class="hs-identifier hs-var">passArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Reg, Format, ForeignHint, OrdList Instr)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; NatM (Int, [Reg], OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;passArguments&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid state&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>
</span><span id="line-1753"></span><span>    </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-type">readResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.Reg.html#LocalReg"><span class="hs-identifier hs-type">LocalReg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Platform.Reg.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1754"></span><span>    </span><span id="local-6989586621682861919"><span class="annot"><span class="annottext">readResults :: [Reg]
-&gt; [Reg]
-&gt; [CmmFormal]
-&gt; [Reg]
-&gt; OrdList Instr
-&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682861919"><span class="hs-identifier hs-var hs-var">readResults</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682862027"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862027"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862027"><span class="hs-identifier hs-var">accumCode</span></a></span><span>
</span><span id="line-1755"></span><span>    </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-var">readResults</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1756"></span><span>      </span><span id="local-6989586621682862028"><span class="annot"><a href="#local-6989586621682862028"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1757"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genCCall, out of gp registers when reading results&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862028"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861891"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1758"></span><span>    </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-var">readResults</span></a></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1759"></span><span>      </span><span id="local-6989586621682862029"><span class="annot"><a href="#local-6989586621682862029"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1760"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-type">pprPanic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;genCCall, out of fp registers when reading results&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#pdoc"><span class="hs-identifier hs-type">pdoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862029"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682861891"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1761"></span><span>    </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-var">readResults</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862030"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862030"><span class="hs-identifier hs-var">gpReg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862031"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862031"><span class="hs-identifier hs-var">gpRegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862032"><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862032"><span class="hs-identifier hs-var">fpReg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862033"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862033"><span class="hs-identifier hs-var">fpRegs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862034"><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862034"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862035"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682862035"><span class="hs-identifier hs-var">dsts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682862036"><span class="annot"><span class="annottext">[Reg]
</span><a href="#local-6989586621682862036"><span class="hs-identifier hs-var">accumRegs</span></a></span></span><span> </span><span id="local-6989586621682862037"><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862037"><span class="hs-identifier hs-var">accumCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1762"></span><span>      </span><span class="hs-comment">-- gp/fp reg -&gt; dst</span><span>
</span><span id="line-1763"></span><span>      </span><span id="local-6989586621682862038"><span class="annot"><a href="#local-6989586621682862038"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1764"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862039"><span class="annot"><a href="#local-6989586621682862039"><span class="hs-identifier hs-var hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; CmmType
</span><a href="GHC.Cmm.Reg.html#cmmRegType"><span class="hs-identifier hs-var">cmmRegType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmFormal -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862034"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1765"></span><span>          </span><span id="local-6989586621682862040"><span class="annot"><a href="#local-6989586621682862040"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmType -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#cmmTypeFormat"><span class="hs-identifier hs-var">cmmTypeFormat</span></a></span><span> </span><span class="annot"><span class="annottext">CmmType
</span><a href="#local-6989586621682862039"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-1766"></span><span>          </span><span id="local-6989586621682862041"><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmmReg -&gt; Width
</span><a href="GHC.Cmm.Reg.html#cmmRegWidth"><span class="hs-identifier hs-var">cmmRegWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmFormal -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862034"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1767"></span><span>          </span><span id="local-6989586621682862043"><span class="annot"><a href="#local-6989586621682862043"><span class="hs-identifier hs-var hs-var">r_dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682862038"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmFormal -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862034"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1768"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#isFloatFormat"><span class="hs-identifier hs-type">isFloatFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862040"><span class="hs-identifier hs-type">format</span></a></span><span>
</span><span id="line-1769"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-type">readResults</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862030"><span class="hs-identifier hs-type">gpReg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682862031"><span class="hs-identifier hs-type">gpRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682862033"><span class="hs-identifier hs-type">fpRegs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862035"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862032"><span class="hs-identifier hs-type">fpReg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682862036"><span class="hs-identifier hs-type">accumRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862037"><span class="hs-identifier hs-type">accumCode</span></a></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862043"><span class="hs-identifier hs-type">r_dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862032"><span class="hs-identifier hs-type">fpReg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1770"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-1771"></span><span>          </span><span class="annot"><a href="#local-6989586621682861919"><span class="hs-identifier hs-type">readResults</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862031"><span class="hs-identifier hs-type">gpRegs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862032"><span class="hs-identifier hs-type">fpReg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682862033"><span class="hs-identifier hs-type">fpRegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682862035"><span class="hs-identifier hs-type">dsts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862030"><span class="hs-identifier hs-type">gpReg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621682862036"><span class="hs-identifier hs-type">accumRegs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1772"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682862037"><span class="hs-identifier hs-type">accumCode</span></a></span><span>
</span><span id="line-1773"></span><span>            </span><span class="annot"><a href="GHC.Data.OrdList.html#snocOL"><span class="hs-operator hs-type">`snocOL`</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862043"><span class="hs-identifier hs-type">r_dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862030"><span class="hs-identifier hs-type">gpReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1774"></span><span>            </span><span class="annot"><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-type">`appOL`</span></a></span><span>
</span><span id="line-1775"></span><span>            </span><span class="hs-comment">-- truncate, otherwise an unexpectedly big value might be used in upfollowing calculations</span><span>
</span><span id="line-1776"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#truncateReg"><span class="hs-identifier hs-type">truncateReg</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862041"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862043"><span class="hs-identifier hs-type">r_dst</span></a></span><span>
</span><span id="line-1777"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCCall"><span class="hs-identifier hs-var">genCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#PrimTarget"><span class="hs-identifier hs-type">PrimTarget</span></a></span><span> </span><span id="local-6989586621682862045"><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682862046"><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682862046"><span class="hs-identifier hs-var">dest_regs</span></a></span></span><span> </span><span id="local-6989586621682862047"><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682862047"><span class="hs-identifier hs-var">arg_regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1778"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1779"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Fabs"><span class="hs-identifier hs-var">MO_F32_Fabs</span></a></span><span>
</span><span id="line-1780"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682862049"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862049"><span class="hs-identifier hs-var">arg_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682862047"><span class="hs-identifier hs-var">arg_regs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1781"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682862050"><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862050"><span class="hs-identifier hs-var">dest_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682862046"><span class="hs-identifier hs-var">dest_regs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1782"></span><span>          </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; CmmExpr
-&gt; CmmFormal
-&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862051"><span class="hs-identifier hs-var">unaryFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682862052"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862052"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682862053"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862053"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FABS"><span class="hs-identifier hs-var">FABS</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862052"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862053"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862049"><span class="hs-identifier hs-var">arg_reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862050"><span class="hs-identifier hs-var">dest_reg</span></a></span><span>
</span><span id="line-1783"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Fabs"><span class="hs-identifier hs-var">MO_F64_Fabs</span></a></span><span>
</span><span id="line-1784"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682862056"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862056"><span class="hs-identifier hs-var">arg_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682862047"><span class="hs-identifier hs-var">arg_regs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1785"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682862057"><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862057"><span class="hs-identifier hs-var">dest_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682862046"><span class="hs-identifier hs-var">dest_regs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1786"></span><span>          </span><span class="annot"><span class="annottext">Width
-&gt; (Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; CmmExpr
-&gt; CmmFormal
-&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862051"><span class="hs-identifier hs-var">unaryFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682862058"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862058"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682862059"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862059"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FABS"><span class="hs-identifier hs-var">FABS</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862058"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862059"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862056"><span class="hs-identifier hs-var">arg_reg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862057"><span class="hs-identifier hs-var">dest_reg</span></a></span><span>
</span><span id="line-1787"></span><span>    </span><span class="hs-comment">-- 64 bit float ops</span><span>
</span><span id="line-1788"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Pwr"><span class="hs-identifier hs-var">MO_F64_Pwr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;pow&quot;</span></span><span>
</span><span id="line-1789"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sin"><span class="hs-identifier hs-var">MO_F64_Sin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sin&quot;</span></span><span>
</span><span id="line-1790"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cos"><span class="hs-identifier hs-var">MO_F64_Cos</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;cos&quot;</span></span><span>
</span><span id="line-1791"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tan"><span class="hs-identifier hs-var">MO_F64_Tan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;tan&quot;</span></span><span>
</span><span id="line-1792"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sinh"><span class="hs-identifier hs-var">MO_F64_Sinh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sinh&quot;</span></span><span>
</span><span id="line-1793"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Cosh"><span class="hs-identifier hs-var">MO_F64_Cosh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;cosh&quot;</span></span><span>
</span><span id="line-1794"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Tanh"><span class="hs-identifier hs-var">MO_F64_Tanh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;tanh&quot;</span></span><span>
</span><span id="line-1795"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asin"><span class="hs-identifier hs-var">MO_F64_Asin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;asin&quot;</span></span><span>
</span><span id="line-1796"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acos"><span class="hs-identifier hs-var">MO_F64_Acos</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;acos&quot;</span></span><span>
</span><span id="line-1797"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atan"><span class="hs-identifier hs-var">MO_F64_Atan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;atan&quot;</span></span><span>
</span><span id="line-1798"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Asinh"><span class="hs-identifier hs-var">MO_F64_Asinh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;asinh&quot;</span></span><span>
</span><span id="line-1799"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Acosh"><span class="hs-identifier hs-var">MO_F64_Acosh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;acosh&quot;</span></span><span>
</span><span id="line-1800"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Atanh"><span class="hs-identifier hs-var">MO_F64_Atanh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;atanh&quot;</span></span><span>
</span><span id="line-1801"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log"><span class="hs-identifier hs-var">MO_F64_Log</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;log&quot;</span></span><span>
</span><span id="line-1802"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Log1P"><span class="hs-identifier hs-var">MO_F64_Log1P</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;log1p&quot;</span></span><span>
</span><span id="line-1803"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Exp"><span class="hs-identifier hs-var">MO_F64_Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;exp&quot;</span></span><span>
</span><span id="line-1804"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_ExpM1"><span class="hs-identifier hs-var">MO_F64_ExpM1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;expm1&quot;</span></span><span>
</span><span id="line-1805"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Fabs"><span class="hs-identifier hs-var">MO_F64_Fabs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;fabs&quot;</span></span><span>
</span><span id="line-1806"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F64_Sqrt"><span class="hs-identifier hs-var">MO_F64_Sqrt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sqrt&quot;</span></span><span>
</span><span id="line-1807"></span><span>    </span><span class="hs-comment">-- 32 bit float ops</span><span>
</span><span id="line-1808"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Pwr"><span class="hs-identifier hs-var">MO_F32_Pwr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;powf&quot;</span></span><span>
</span><span id="line-1809"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sin"><span class="hs-identifier hs-var">MO_F32_Sin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sinf&quot;</span></span><span>
</span><span id="line-1810"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cos"><span class="hs-identifier hs-var">MO_F32_Cos</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;cosf&quot;</span></span><span>
</span><span id="line-1811"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tan"><span class="hs-identifier hs-var">MO_F32_Tan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;tanf&quot;</span></span><span>
</span><span id="line-1812"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sinh"><span class="hs-identifier hs-var">MO_F32_Sinh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sinhf&quot;</span></span><span>
</span><span id="line-1813"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Cosh"><span class="hs-identifier hs-var">MO_F32_Cosh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;coshf&quot;</span></span><span>
</span><span id="line-1814"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Tanh"><span class="hs-identifier hs-var">MO_F32_Tanh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;tanhf&quot;</span></span><span>
</span><span id="line-1815"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asin"><span class="hs-identifier hs-var">MO_F32_Asin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;asinf&quot;</span></span><span>
</span><span id="line-1816"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acos"><span class="hs-identifier hs-var">MO_F32_Acos</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;acosf&quot;</span></span><span>
</span><span id="line-1817"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atan"><span class="hs-identifier hs-var">MO_F32_Atan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;atanf&quot;</span></span><span>
</span><span id="line-1818"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Asinh"><span class="hs-identifier hs-var">MO_F32_Asinh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;asinhf&quot;</span></span><span>
</span><span id="line-1819"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Acosh"><span class="hs-identifier hs-var">MO_F32_Acosh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;acoshf&quot;</span></span><span>
</span><span id="line-1820"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Atanh"><span class="hs-identifier hs-var">MO_F32_Atanh</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;atanhf&quot;</span></span><span>
</span><span id="line-1821"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log"><span class="hs-identifier hs-var">MO_F32_Log</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;logf&quot;</span></span><span>
</span><span id="line-1822"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Log1P"><span class="hs-identifier hs-var">MO_F32_Log1P</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;log1pf&quot;</span></span><span>
</span><span id="line-1823"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Exp"><span class="hs-identifier hs-var">MO_F32_Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;expf&quot;</span></span><span>
</span><span id="line-1824"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_ExpM1"><span class="hs-identifier hs-var">MO_F32_ExpM1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;expm1f&quot;</span></span><span>
</span><span id="line-1825"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Fabs"><span class="hs-identifier hs-var">MO_F32_Fabs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;fabsf&quot;</span></span><span>
</span><span id="line-1826"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_F32_Sqrt"><span class="hs-identifier hs-var">MO_F32_Sqrt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;sqrtf&quot;</span></span><span>
</span><span id="line-1827"></span><span>    </span><span class="hs-comment">-- 64-bit primops</span><span>
</span><span id="line-1828"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_ToI"><span class="hs-identifier hs-var">MO_I64_ToI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_int64ToInt&quot;</span></span><span>
</span><span id="line-1829"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_FromI"><span class="hs-identifier hs-var">MO_I64_FromI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_intToInt64&quot;</span></span><span>
</span><span id="line-1830"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_ToW"><span class="hs-identifier hs-var">MO_W64_ToW</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_word64ToWord&quot;</span></span><span>
</span><span id="line-1831"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_FromW"><span class="hs-identifier hs-var">MO_W64_FromW</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_wordToWord64&quot;</span></span><span>
</span><span id="line-1832"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Neg"><span class="hs-identifier hs-var">MO_x64_Neg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_neg64&quot;</span></span><span>
</span><span id="line-1833"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Add"><span class="hs-identifier hs-var">MO_x64_Add</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_add64&quot;</span></span><span>
</span><span id="line-1834"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Sub"><span class="hs-identifier hs-var">MO_x64_Sub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_sub64&quot;</span></span><span>
</span><span id="line-1835"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Mul"><span class="hs-identifier hs-var">MO_x64_Mul</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_mul64&quot;</span></span><span>
</span><span id="line-1836"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Quot"><span class="hs-identifier hs-var">MO_I64_Quot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_quotInt64&quot;</span></span><span>
</span><span id="line-1837"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Rem"><span class="hs-identifier hs-var">MO_I64_Rem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_remInt64&quot;</span></span><span>
</span><span id="line-1838"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Quot"><span class="hs-identifier hs-var">MO_W64_Quot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_quotWord64&quot;</span></span><span>
</span><span id="line-1839"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Rem"><span class="hs-identifier hs-var">MO_W64_Rem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_remWord64&quot;</span></span><span>
</span><span id="line-1840"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_And"><span class="hs-identifier hs-var">MO_x64_And</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_and64&quot;</span></span><span>
</span><span id="line-1841"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Or"><span class="hs-identifier hs-var">MO_x64_Or</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_or64&quot;</span></span><span>
</span><span id="line-1842"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Xor"><span class="hs-identifier hs-var">MO_x64_Xor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_xor64&quot;</span></span><span>
</span><span id="line-1843"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Not"><span class="hs-identifier hs-var">MO_x64_Not</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_not64&quot;</span></span><span>
</span><span id="line-1844"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Shl"><span class="hs-identifier hs-var">MO_x64_Shl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_uncheckedShiftL64&quot;</span></span><span>
</span><span id="line-1845"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Shr"><span class="hs-identifier hs-var">MO_I64_Shr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_uncheckedIShiftRA64&quot;</span></span><span>
</span><span id="line-1846"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Shr"><span class="hs-identifier hs-var">MO_W64_Shr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_uncheckedShiftRL64&quot;</span></span><span>
</span><span id="line-1847"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Eq"><span class="hs-identifier hs-var">MO_x64_Eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_eq64&quot;</span></span><span>
</span><span id="line-1848"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_x64_Ne"><span class="hs-identifier hs-var">MO_x64_Ne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_ne64&quot;</span></span><span>
</span><span id="line-1849"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Ge"><span class="hs-identifier hs-var">MO_I64_Ge</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_geInt64&quot;</span></span><span>
</span><span id="line-1850"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Gt"><span class="hs-identifier hs-var">MO_I64_Gt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_gtInt64&quot;</span></span><span>
</span><span id="line-1851"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Le"><span class="hs-identifier hs-var">MO_I64_Le</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_leInt64&quot;</span></span><span>
</span><span id="line-1852"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_I64_Lt"><span class="hs-identifier hs-var">MO_I64_Lt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_ltInt64&quot;</span></span><span>
</span><span id="line-1853"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Ge"><span class="hs-identifier hs-var">MO_W64_Ge</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_geWord64&quot;</span></span><span>
</span><span id="line-1854"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Gt"><span class="hs-identifier hs-var">MO_W64_Gt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_gtWord64&quot;</span></span><span>
</span><span id="line-1855"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Le"><span class="hs-identifier hs-var">MO_W64_Le</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_leWord64&quot;</span></span><span>
</span><span id="line-1856"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_W64_Lt"><span class="hs-identifier hs-var">MO_W64_Lt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;hs_ltWord64&quot;</span></span><span>
</span><span id="line-1857"></span><span>    </span><span class="hs-comment">-- Conversion</span><span>
</span><span id="line-1858"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_UF_Conv"><span class="hs-identifier hs-type">MO_UF_Conv</span></a></span><span> </span><span id="local-6989586621682862127"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862127"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#word2FloatLabel"><span class="hs-identifier hs-var">word2FloatLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862127"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1859"></span><span>    </span><span class="hs-comment">-- Optional MachOps</span><span>
</span><span id="line-1860"></span><span>    </span><span class="hs-comment">-- These are enabled/disabled by backend flags: GHC.StgToCmm.Config</span><span>
</span><span id="line-1861"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_Mul2"><span class="hs-identifier hs-type">MO_S_Mul2</span></a></span><span> </span><span id="local-6989586621682862130"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862130"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1862"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_S_QuotRem"><span class="hs-identifier hs-type">MO_S_QuotRem</span></a></span><span> </span><span id="local-6989586621682862133"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862133"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1863"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem"><span class="hs-identifier hs-type">MO_U_QuotRem</span></a></span><span> </span><span id="local-6989586621682862135"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862135"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1864"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_QuotRem2"><span class="hs-identifier hs-type">MO_U_QuotRem2</span></a></span><span> </span><span id="local-6989586621682862137"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862137"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1865"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Add2"><span class="hs-identifier hs-type">MO_Add2</span></a></span><span> </span><span id="local-6989586621682862139"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862139"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1866"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddWordC"><span class="hs-identifier hs-type">MO_AddWordC</span></a></span><span> </span><span id="local-6989586621682862141"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862141"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1867"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubWordC"><span class="hs-identifier hs-type">MO_SubWordC</span></a></span><span> </span><span id="local-6989586621682862143"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862143"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1868"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AddIntC"><span class="hs-identifier hs-type">MO_AddIntC</span></a></span><span> </span><span id="local-6989586621682862145"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862145"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1869"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_SubIntC"><span class="hs-identifier hs-type">MO_SubIntC</span></a></span><span> </span><span id="local-6989586621682862147"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862147"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1870"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_U_Mul2"><span class="hs-identifier hs-type">MO_U_Mul2</span></a></span><span> </span><span id="local-6989586621682862149"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862149"><span class="hs-identifier hs-var">_w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; NatM (OrdList Instr)
forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var">unsupported</span></a></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862045"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1871"></span><span>    </span><span class="hs-comment">-- Memory Ordering</span><span>
</span><span id="line-1872"></span><span>    </span><span class="hs-comment">-- The related C functions are:</span><span>
</span><span id="line-1873"></span><span>    </span><span class="hs-comment">-- #include &lt;stdatomic.h&gt;</span><span>
</span><span id="line-1874"></span><span>    </span><span class="hs-comment">-- atomic_thread_fence(memory_order_acquire);</span><span>
</span><span id="line-1875"></span><span>    </span><span class="hs-comment">-- atomic_thread_fence(memory_order_release);</span><span>
</span><span id="line-1876"></span><span>    </span><span class="hs-comment">-- atomic_thread_fence(memory_order_seq_cst);</span><span>
</span><span id="line-1877"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_AcquireFence"><span class="hs-identifier hs-var">MO_AcquireFence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceRead"><span class="hs-identifier hs-var">FenceRead</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1878"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ReleaseFence"><span class="hs-identifier hs-var">MO_ReleaseFence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceWrite"><span class="hs-identifier hs-var">FenceWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1879"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SeqCstFence"><span class="hs-identifier hs-var">MO_SeqCstFence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1880"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_Touch"><span class="hs-identifier hs-var">MO_Touch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- Keep variables live (when using interior pointers)</span><span>
</span><span id="line-1881"></span><span>    </span><span class="hs-comment">-- Prefetch</span><span>
</span><span id="line-1882"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Prefetch_Data"><span class="hs-identifier hs-type">MO_Prefetch_Data</span></a></span><span> </span><span id="local-6989586621682862159"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862159"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; NatM (OrdList Instr)
forall a. a -&gt; NatM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
forall a. OrdList a
</span><a href="GHC.Data.OrdList.html#nilOL"><span class="hs-identifier hs-var">nilOL</span></a></span><span> </span><span class="hs-comment">-- Prefetch hint.</span><span>
</span><span id="line-1883"></span><span>
</span><span id="line-1884"></span><span>    </span><span class="hs-comment">-- Memory copy/set/move/cmp, with alignment for optimization</span><span>
</span><span id="line-1885"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcpy"><span class="hs-identifier hs-type">MO_Memcpy</span></a></span><span> </span><span id="local-6989586621682862161"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862161"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;memcpy&quot;</span></span><span>
</span><span id="line-1886"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memset"><span class="hs-identifier hs-type">MO_Memset</span></a></span><span> </span><span id="local-6989586621682862163"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862163"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;memset&quot;</span></span><span>
</span><span id="line-1887"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memmove"><span class="hs-identifier hs-type">MO_Memmove</span></a></span><span> </span><span id="local-6989586621682862165"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862165"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;memmove&quot;</span></span><span>
</span><span id="line-1888"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Memcmp"><span class="hs-identifier hs-type">MO_Memcmp</span></a></span><span> </span><span id="local-6989586621682862167"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862167"><span class="hs-identifier hs-var">_align</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;memcmp&quot;</span></span><span>
</span><span id="line-1889"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_SuspendThread"><span class="hs-identifier hs-var">MO_SuspendThread</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;suspendThread&quot;</span></span><span>
</span><span id="line-1890"></span><span>    </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="GHC.Cmm.MachOp.html#MO_ResumeThread"><span class="hs-identifier hs-var">MO_ResumeThread</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-string">&quot;resumeThread&quot;</span></span><span>
</span><span id="line-1891"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_PopCnt"><span class="hs-identifier hs-type">MO_PopCnt</span></a></span><span> </span><span id="local-6989586621682862171"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862171"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#popCntLabel"><span class="hs-identifier hs-var">popCntLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862171"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1892"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pdep"><span class="hs-identifier hs-type">MO_Pdep</span></a></span><span> </span><span id="local-6989586621682862174"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862174"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#pdepLabel"><span class="hs-identifier hs-var">pdepLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862174"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1893"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Pext"><span class="hs-identifier hs-type">MO_Pext</span></a></span><span> </span><span id="local-6989586621682862177"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862177"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#pextLabel"><span class="hs-identifier hs-var">pextLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862177"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1894"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Clz"><span class="hs-identifier hs-type">MO_Clz</span></a></span><span> </span><span id="local-6989586621682862180"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862180"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#clzLabel"><span class="hs-identifier hs-var">clzLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862180"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1895"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Ctz"><span class="hs-identifier hs-type">MO_Ctz</span></a></span><span> </span><span id="local-6989586621682862183"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862183"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#ctzLabel"><span class="hs-identifier hs-var">ctzLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862183"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1896"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BSwap"><span class="hs-identifier hs-type">MO_BSwap</span></a></span><span> </span><span id="local-6989586621682862186"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862186"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#bSwapLabel"><span class="hs-identifier hs-var">bSwapLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862186"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1897"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_BRev"><span class="hs-identifier hs-type">MO_BRev</span></a></span><span> </span><span id="local-6989586621682862189"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862189"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#bRevLabel"><span class="hs-identifier hs-var">bRevLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862189"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>    </span><span class="hs-comment">-- Atomic read-modify-write.</span><span>
</span><span id="line-1899"></span><span>    </span><span id="local-6989586621682862191"><span class="annot"><span class="annottext">mo :: CallishMachOp
</span><a href="#local-6989586621682862191"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRead"><span class="hs-identifier hs-type">MO_AtomicRead</span></a></span><span> </span><span id="local-6989586621682862193"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682862194"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682862194"><span class="hs-identifier hs-var">ord</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1900"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682862195"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862195"><span class="hs-identifier hs-var">p_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682862047"><span class="hs-identifier hs-var">arg_regs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1901"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682862196"><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862196"><span class="hs-identifier hs-var">dst_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmFormal]
</span><a href="#local-6989586621682862046"><span class="hs-identifier hs-var">dest_regs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1902"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682862197"><span class="annot"><a href="#local-6989586621682862197"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862198"><span class="annot"><a href="#local-6989586621682862198"><span class="hs-identifier hs-var">_fmt_p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862199"><span class="annot"><a href="#local-6989586621682862199"><span class="hs-identifier hs-var">code_p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862195"><span class="hs-identifier hs-var">p_reg</span></a></span><span>
</span><span id="line-1903"></span><span>          </span><span id="local-6989586621682862200"><span class="annot"><a href="#local-6989586621682862200"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1904"></span><span>          </span><span class="hs-comment">-- Analog to the related MachOps (above)</span><span>
</span><span id="line-1905"></span><span>          </span><span class="hs-comment">-- The related C functions are:</span><span>
</span><span id="line-1906"></span><span>          </span><span class="hs-comment">-- #include &lt;stdatomic.h&gt;</span><span>
</span><span id="line-1907"></span><span>          </span><span class="hs-comment">-- __atomic_load_n(&amp;a, __ATOMIC_ACQUIRE);</span><span>
</span><span id="line-1908"></span><span>          </span><span class="hs-comment">-- __atomic_load_n(&amp;a, __ATOMIC_SEQ_CST);</span><span>
</span><span id="line-1909"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862201"><span class="annot"><a href="#local-6989586621682862201"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682862194"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1910"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelaxed"><span class="hs-identifier hs-var">MemOrderRelaxed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862203"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862204"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862197"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1911"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderAcquire"><span class="hs-identifier hs-var">MemOrderAcquire</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1912"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1913"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862203"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862204"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862197"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1914"></span><span>                      </span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceRead"><span class="hs-identifier hs-var">FenceRead</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span>
</span><span id="line-1915"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-1916"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderSeqCst"><span class="hs-identifier hs-var">MemOrderSeqCst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1917"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1918"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862203"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1919"></span><span>                      </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Format
</span><a href="GHC.CmmToAsm.Format.html#intFormat"><span class="hs-identifier hs-var">intFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862193"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862204"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862197"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1920"></span><span>                      </span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceRead"><span class="hs-identifier hs-var">FenceRead</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span>
</span><span id="line-1921"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-1922"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelease"><span class="hs-identifier hs-var">MemOrderRelease</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; OrdList Instr) -&gt; [Char] -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected MemOrderRelease on an AtomicRead: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862191"><span class="hs-identifier hs-var">mo</span></a></span><span>
</span><span id="line-1923"></span><span>              </span><span id="local-6989586621682862204"><span class="annot"><a href="#local-6989586621682862204"><span class="hs-identifier hs-var hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682862200"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmFormal -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862196"><span class="hs-identifier hs-var">dst_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1924"></span><span>              </span><span id="local-6989586621682862203"><span class="annot"><a href="#local-6989586621682862203"><span class="hs-identifier hs-var hs-var">moDescr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc)
-&gt; (CallishMachOp -&gt; [Char]) -&gt; CallishMachOp -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862191"><span class="hs-identifier hs-var">mo</span></a></span><span>
</span><span id="line-1925"></span><span>              </span><span id="local-6989586621682862208"><span class="annot"><a href="#local-6989586621682862208"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862199"><span class="hs-identifier hs-var">code_p</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862201"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-1926"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682862208"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1927"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mal-formed AtomicRead&quot;</span></span><span>
</span><span id="line-1928"></span><span>    </span><span id="local-6989586621682862209"><span class="annot"><span class="annottext">mo :: CallishMachOp
</span><a href="#local-6989586621682862209"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicWrite"><span class="hs-identifier hs-type">MO_AtomicWrite</span></a></span><span> </span><span id="local-6989586621682862211"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862211"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682862212"><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682862212"><span class="hs-identifier hs-var">ord</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1929"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682862213"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862213"><span class="hs-identifier hs-var">p_reg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862214"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862214"><span class="hs-identifier hs-var">val_reg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CmmExpr]
</span><a href="#local-6989586621682862047"><span class="hs-identifier hs-var">arg_regs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1930"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682862215"><span class="annot"><a href="#local-6989586621682862215"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862216"><span class="annot"><a href="#local-6989586621682862216"><span class="hs-identifier hs-var">_fmt_p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862217"><span class="annot"><a href="#local-6989586621682862217"><span class="hs-identifier hs-var">code_p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CmmExpr -&gt; NatM (Reg, Format, OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-var">getSomeReg</span></a></span><span> </span><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862213"><span class="hs-identifier hs-var">p_reg</span></a></span><span>
</span><span id="line-1931"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682862218"><span class="annot"><a href="#local-6989586621682862218"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862219"><span class="annot"><a href="#local-6989586621682862219"><span class="hs-identifier hs-var">fmt_val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862220"><span class="annot"><a href="#local-6989586621682862220"><span class="hs-identifier hs-var">code_val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getSomeReg"><span class="hs-identifier hs-type">getSomeReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862214"><span class="hs-identifier hs-type">val_reg</span></a></span><span>
</span><span id="line-1932"></span><span>          </span><span class="hs-comment">-- Analog to the related MachOps (above)</span><span>
</span><span id="line-1933"></span><span>          </span><span class="hs-comment">-- The related C functions are:</span><span>
</span><span id="line-1934"></span><span>          </span><span class="hs-comment">-- #include &lt;stdatomic.h&gt;</span><span>
</span><span id="line-1935"></span><span>          </span><span class="hs-comment">-- __atomic_store_n(&amp;a, 23, __ATOMIC_SEQ_CST);</span><span>
</span><span id="line-1936"></span><span>          </span><span class="hs-comment">-- __atomic_store_n(&amp;a, 23, __ATOMIC_RELEASE);</span><span>
</span><span id="line-1937"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862221"><span class="annot"><a href="#local-6989586621682862221"><span class="hs-identifier hs-var hs-var">instrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="#local-6989586621682862212"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1938"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelaxed"><span class="hs-identifier hs-var">MemOrderRelaxed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; OrdList Instr
forall a. a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#unitOL"><span class="hs-identifier hs-var">unitOL</span></a></span><span> </span><span class="annot"><span class="annottext">(Instr -&gt; OrdList Instr) -&gt; Instr -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862222"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-var">STR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862219"><span class="hs-identifier hs-var">fmt_val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862211"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862218"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862215"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1939"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderSeqCst"><span class="hs-identifier hs-var">MemOrderSeqCst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1940"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1941"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862222"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceWrite"><span class="hs-identifier hs-var">FenceWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1942"></span><span>                      </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-var">STR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862219"><span class="hs-identifier hs-var">fmt_val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862211"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862218"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862215"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1943"></span><span>                      </span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span>
</span><span id="line-1944"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-1945"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderRelease"><span class="hs-identifier hs-var">MemOrderRelease</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1946"></span><span>                  </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-1947"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862222"><span class="hs-identifier hs-var">moDescr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FenceType -&gt; FenceType -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-var">FENCE</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceReadWrite"><span class="hs-identifier hs-var">FenceReadWrite</span></a></span><span> </span><span class="annot"><span class="annottext">FenceType
</span><a href="GHC.CmmToAsm.RV64.Instr.html#FenceWrite"><span class="hs-identifier hs-var">FenceWrite</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1948"></span><span>                      </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-var">STR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="#local-6989586621682862219"><span class="hs-identifier hs-var">fmt_val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862211"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862218"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrMode -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpAddr"><span class="hs-identifier hs-var">OpAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(AddrMode -&gt; Operand) -&gt; AddrMode -&gt; Operand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reg -&gt; AddrMode
</span><a href="GHC.CmmToAsm.RV64.Regs.html#AddrReg"><span class="hs-identifier hs-var">AddrReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862215"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1949"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-1950"></span><span>                </span><span class="annot"><span class="annottext">MemoryOrdering
</span><a href="GHC.Cmm.MachOp.html#MemOrderAcquire"><span class="hs-identifier hs-var">MemOrderAcquire</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; OrdList Instr
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; OrdList Instr) -&gt; [Char] -&gt; OrdList Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unexpected MemOrderAcquire on an AtomicWrite&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862209"><span class="hs-identifier hs-var">mo</span></a></span><span>
</span><span id="line-1951"></span><span>              </span><span id="local-6989586621682862222"><span class="annot"><a href="#local-6989586621682862222"><span class="hs-identifier hs-var hs-var">moDescr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SDoc)
-&gt; (CallishMachOp -&gt; [Char]) -&gt; CallishMachOp -&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CallishMachOp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CallishMachOp
</span><a href="#local-6989586621682862209"><span class="hs-identifier hs-var">mo</span></a></span><span>
</span><span id="line-1952"></span><span>              </span><span id="local-6989586621682862223"><span class="annot"><a href="#local-6989586621682862223"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1953"></span><span>                </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862217"><span class="hs-identifier hs-var">code_p</span></a></span><span>
</span><span id="line-1954"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862220"><span class="hs-identifier hs-var">code_val</span></a></span><span>
</span><span id="line-1955"></span><span>                  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862221"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-1956"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682862223"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1957"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; NatM (OrdList Instr)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mal-formed AtomicWrite&quot;</span></span><span>
</span><span id="line-1958"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_AtomicRMW"><span class="hs-identifier hs-type">MO_AtomicRMW</span></a></span><span> </span><span id="local-6989586621682862225"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862225"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682862226"><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682862226"><span class="hs-identifier hs-var">amop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; AtomicMachOp -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#atomicRMWLabel"><span class="hs-identifier hs-var">atomicRMWLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862225"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicMachOp
</span><a href="#local-6989586621682862226"><span class="hs-identifier hs-var">amop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1959"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Cmpxchg"><span class="hs-identifier hs-type">MO_Cmpxchg</span></a></span><span> </span><span id="local-6989586621682862229"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862229"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#cmpxchgLabel"><span class="hs-identifier hs-var">cmpxchgLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862229"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1960"></span><span>    </span><span class="hs-comment">-- -- Should be an AtomicRMW variant eventually.</span><span>
</span><span id="line-1961"></span><span>    </span><span class="hs-comment">-- -- Sequential consistent.</span><span>
</span><span id="line-1962"></span><span>    </span><span class="hs-comment">-- TODO: this should be implemented properly!</span><span>
</span><span id="line-1963"></span><span>    </span><span class="annot"><a href="GHC.Cmm.MachOp.html#MO_Xchg"><span class="hs-identifier hs-type">MO_Xchg</span></a></span><span> </span><span id="local-6989586621682862232"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862232"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var">mkCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; FastString
</span><a href="GHC.CmmToAsm.CPrim.html#xchgLabel"><span class="hs-identifier hs-var">xchgLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862232"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1964"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1965"></span><span>    </span><span id="local-6989586621682859711"><span id="local-6989586621682859712"><span class="annot"><a href="#local-6989586621682862131"><span class="hs-identifier hs-type">unsupported</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621682859711"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682859711"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682859712"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-1966"></span><span>    </span><span id="local-6989586621682862131"><span class="annot"><span class="annottext">unsupported :: forall a b. Show a =&gt; a -&gt; b
</span><a href="#local-6989586621682862131"><span class="hs-identifier hs-var hs-var">unsupported</span></a></span></span><span> </span><span id="local-6989586621682862240"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682862240"><span class="hs-identifier hs-var">mop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1967"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; b
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span>
</span><span id="line-1968"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;outOfLineCmmOp: &quot;</span></span><span>
</span><span id="line-1969"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682862240"><span class="hs-identifier hs-var">mop</span></a></span><span>
</span><span id="line-1970"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; not supported here&quot;</span></span><span>
</span><span id="line-1971"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1972"></span><span>    </span><span class="annot"><a href="#local-6989586621682862061"><span class="hs-identifier hs-type">mkCCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Monad.html#NatM"><span class="hs-identifier hs-type">NatM</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span><span>
</span><span id="line-1973"></span><span>    </span><span id="local-6989586621682862061"><span class="annot"><span class="annottext">mkCCall :: FastString -&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862061"><span class="hs-identifier hs-var hs-var">mkCCall</span></a></span></span><span> </span><span id="local-6989586621682862241"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682862241"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1974"></span><span>      </span><span id="local-6989586621682862242"><span class="annot"><a href="#local-6989586621682862242"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM NCGConfig
</span><a href="GHC.CmmToAsm.Monad.html#getConfig"><span class="hs-identifier hs-var">getConfig</span></a></span><span>
</span><span id="line-1975"></span><span>      </span><span id="local-6989586621682862243"><span class="annot"><a href="#local-6989586621682862243"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1976"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#cmmMakeDynamicReference"><span class="hs-identifier hs-type">cmmMakeDynamicReference</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862242"><span class="hs-identifier hs-type">config</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.PIC.html#CallReference"><span class="hs-identifier hs-type">CallReference</span></a></span><span>
</span><span id="line-1977"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#mkForeignLabel"><span class="hs-identifier hs-type">mkForeignLabel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862241"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.CLabel.html#ForeignLabelInThisPackage"><span class="hs-identifier hs-type">ForeignLabelInThisPackage</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#IsFunction"><span class="hs-identifier hs-type">IsFunction</span></a></span><span>
</span><span id="line-1978"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862248"><span class="annot"><a href="#local-6989586621682862248"><span class="hs-identifier hs-var hs-var">cconv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCallConv
-&gt; [ForeignHint]
-&gt; [ForeignHint]
-&gt; CmmReturnInfo
-&gt; ForeignConvention
</span><a href="GHC.Cmm.Node.html#ForeignConvention"><span class="hs-identifier hs-var">ForeignConvention</span></a></span><span> </span><span class="annot"><span class="annottext">CCallConv
</span><a href="GHC.Types.ForeignCall.html#CCallConv"><span class="hs-identifier hs-var">CCallConv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#NoHint"><span class="hs-identifier hs-var">NoHint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignHint
</span><a href="GHC.Cmm.Type.html#NoHint"><span class="hs-identifier hs-var">NoHint</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CmmReturnInfo
</span><a href="GHC.Cmm.Node.html#CmmMayReturn"><span class="hs-identifier hs-var">CmmMayReturn</span></a></span><span>
</span><span id="line-1979"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCCall"><span class="hs-identifier hs-type">genCCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Node.html#ForeignTarget"><span class="hs-identifier hs-type">ForeignTarget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862243"><span class="hs-identifier hs-type">target</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862248"><span class="hs-identifier hs-type">cconv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682862046"><span class="hs-identifier hs-type">dest_regs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862047"><span class="hs-identifier hs-type">arg_regs</span></a></span><span>
</span><span id="line-1980"></span><span>
</span><span id="line-1981"></span><span>    </span><span id="local-6989586621682862051"><span class="annot"><span class="annottext">unaryFloatOp :: Width
-&gt; (Operand -&gt; Operand -&gt; OrdList Instr)
-&gt; CmmExpr
-&gt; CmmFormal
-&gt; NatM (OrdList Instr)
</span><a href="#local-6989586621682862051"><span class="hs-identifier hs-var hs-var">unaryFloatOp</span></a></span></span><span> </span><span id="local-6989586621682862258"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862258"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682862259"><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682862259"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682862260"><span class="annot"><span class="annottext">CmmExpr
</span><a href="#local-6989586621682862260"><span class="hs-identifier hs-var">arg_reg</span></a></span></span><span> </span><span id="local-6989586621682862261"><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862261"><span class="hs-identifier hs-var">dest_reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1982"></span><span>      </span><span id="local-6989586621682862262"><span class="annot"><a href="#local-6989586621682862262"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NatM Platform
</span><a href="GHC.CmmToAsm.Monad.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1983"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682862263"><span class="annot"><a href="#local-6989586621682862263"><span class="hs-identifier hs-var">reg_fx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862264"><span class="annot"><a href="#local-6989586621682862264"><span class="hs-identifier hs-var">_format_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862265"><span class="annot"><a href="#local-6989586621682862265"><span class="hs-identifier hs-var">code_fx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#getFloatReg"><span class="hs-identifier hs-type">getFloatReg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862260"><span class="hs-identifier hs-type">arg_reg</span></a></span><span>
</span><span id="line-1984"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862266"><span class="annot"><a href="#local-6989586621682862266"><span class="hs-identifier hs-var hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CmmReg -&gt; Reg
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#getRegisterReg"><span class="hs-identifier hs-var">getRegisterReg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682862262"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmmFormal -&gt; CmmReg
</span><a href="GHC.Cmm.Reg.html#CmmLocal"><span class="hs-identifier hs-var">CmmLocal</span></a></span><span> </span><span class="annot"><span class="annottext">CmmFormal
</span><a href="#local-6989586621682862261"><span class="hs-identifier hs-var">dest_reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1985"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862267"><span class="annot"><a href="#local-6989586621682862267"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrdList Instr
</span><a href="#local-6989586621682862265"><span class="hs-identifier hs-var">code_fx</span></a></span><span> </span><span class="annot"><span class="annottext">OrdList Instr -&gt; OrdList Instr -&gt; OrdList Instr
forall a. OrdList a -&gt; OrdList a -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#appOL"><span class="hs-operator hs-var">`appOL`</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Operand -&gt; OrdList Instr
</span><a href="#local-6989586621682862259"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862258"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862266"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682862258"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="#local-6989586621682862263"><span class="hs-identifier hs-var">reg_fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1986"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682862267"><span class="hs-identifier hs-type">code</span></a></span><span>
</span><span id="line-1987"></span><span>
</span><span id="line-1988"></span><span class="hs-comment">{- Note [RISCV64 far jumps]
~~~~~~~~~~~~~~~~~~~~~~~~~~~

RISCV64 conditional jump instructions can only encode an offset of +/-4KiB
(12bits) which is usually enough but can be exceeded in edge cases. In these
cases we will replace:

  b.cond &lt;cond&gt; foo

with the sequence:

  b.cond &lt;cond&gt; &lt;lbl_true&gt;
  b &lt;lbl_false&gt;
  &lt;lbl_true&gt;:
  la reg foo
  b reg
  &lt;lbl_false&gt;:

and

  b foo

with the sequence:

  la reg foo
  b reg

Compared to AArch64 the target label is loaded to a register, because
unconditional jump instructions can only address +/-1MiB. The LA
pseudo-instruction will be replaced by up to two real instructions, ensuring
correct addressing.

One could surely find more efficient replacements, taking PC-relative addressing
into account. This could be a future improvement. (As far branches are pretty
rare, one might question and measure the value of such improvement.)

RISCV has many pseudo-instructions which emit more than one real instructions.
Thus, we count the real instructions after the Assembler has seen them.

We make some simplifications in the name of performance which can result in
overestimating jump &lt;-&gt; label offsets:

\* To avoid having to recalculate the label offsets once we replaced a jump we simply
  assume all label jumps will be expanded to a three instruction far jump sequence.
\* For labels associated with a info table we assume the info table is 64byte large.
  Most info tables are smaller than that but it means we don't have to distinguish
  between multiple types of info tables.

In terms of implementation we walk the instruction stream at least once calculating
label offsets, and if we determine during this that the functions body is big enough
to potentially contain out of range jumps we walk the instructions a second time, replacing
out of range jumps with the sequence of instructions described above.

-}</span><span>
</span><span id="line-2042"></span><span>
</span><span id="line-2043"></span><span class="hs-comment">-- | A conditional jump to a far target</span><span>
</span><span id="line-2044"></span><span class="hs-comment">--</span><span>
</span><span id="line-2045"></span><span class="hs-comment">-- By loading the far target into a register for the jump, we can address the</span><span>
</span><span id="line-2046"></span><span class="hs-comment">-- whole memory range.</span><span>
</span><span id="line-2047"></span><span id="local-6989586621682859722"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondFarJump"><span class="hs-identifier hs-type">genCondFarJump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.DSM.html#MonadGetUnique"><span class="hs-identifier hs-type">MonadGetUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859722"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Cond.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682859722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-2048"></span><span id="genCondFarJump"><span class="annot"><span class="annottext">genCondFarJump :: forall (m :: * -&gt; *).
MonadGetUnique m =&gt;
Cond -&gt; Operand -&gt; Operand -&gt; BlockId -&gt; m (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondFarJump"><span class="hs-identifier hs-var hs-var">genCondFarJump</span></a></span></span><span> </span><span id="local-6989586621682862280"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682862280"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682862281"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862281"><span class="hs-identifier hs-var">op1</span></a></span></span><span> </span><span id="local-6989586621682862282"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862282"><span class="hs-identifier hs-var">op2</span></a></span></span><span> </span><span id="local-6989586621682862283"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862283"><span class="hs-identifier hs-var">far_target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2049"></span><span>  </span><span id="local-6989586621682862284"><span class="annot"><a href="#local-6989586621682862284"><span class="hs-identifier hs-var">skip_lbl_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockId
forall (m :: * -&gt; *). MonadGetUnique m =&gt; m BlockId
</span><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-var">newBlockId</span></a></span><span>
</span><span id="line-2050"></span><span>  </span><span id="local-6989586621682862286"><span class="annot"><a href="#local-6989586621682862286"><span class="hs-identifier hs-var">jmp_lbl_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#newBlockId"><span class="hs-identifier hs-type">newBlockId</span></a></span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span>  </span><span class="hs-comment">-- TODO: We can improve this by inverting the condition</span><span>
</span><span id="line-2053"></span><span>  </span><span class="hs-comment">-- but it's not quite trivial since we don't know if we</span><span>
</span><span id="line-2054"></span><span>  </span><span class="hs-comment">-- need to consider float orderings.</span><span>
</span><span id="line-2055"></span><span>  </span><span class="hs-comment">-- So we take the hit of the additional jump in the false</span><span>
</span><span id="line-2056"></span><span>  </span><span class="hs-comment">-- case for now.</span><span>
</span><span id="line-2057"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-2058"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-type">toOL</span></a></span><span>
</span><span id="line-2059"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Conditional far jump to: &quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862283"><span class="hs-identifier hs-type">far_target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2060"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862280"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862281"><span class="hs-identifier hs-type">op1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862282"><span class="hs-identifier hs-type">op2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862286"><span class="hs-identifier hs-type">jmp_lbl_id</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2061"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862284"><span class="hs-identifier hs-type">skip_lbl_id</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2062"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862286"><span class="hs-identifier hs-type">jmp_lbl_id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2063"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-type">LDR</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-type">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-type">OpReg</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-type">W64</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-type">tmpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-type">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#ImmCLbl"><span class="hs-identifier hs-type">ImmCLbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-type">blockLbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862283"><span class="hs-identifier hs-type">far_target</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2064"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-type">TReg</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-type">tmpReg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2065"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862284"><span class="hs-identifier hs-type">skip_lbl_id</span></a></span><span>
</span><span id="line-2066"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2067"></span><span>
</span><span id="line-2068"></span><span class="hs-comment">-- | An unconditional jump to a far target</span><span>
</span><span id="line-2069"></span><span class="hs-comment">--</span><span>
</span><span id="line-2070"></span><span class="hs-comment">-- By loading the far target into a register for the jump, we can address the</span><span>
</span><span id="line-2071"></span><span class="hs-comment">-- whole memory range.</span><span>
</span><span id="line-2072"></span><span id="local-6989586621682859726"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#genFarJump"><span class="hs-identifier hs-type">genFarJump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.DSM.html#MonadGetUnique"><span class="hs-identifier hs-type">MonadGetUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682859726"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682859726"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InstrBlock"><span class="hs-identifier hs-type">InstrBlock</span></a></span></span><span>
</span><span id="line-2073"></span><span id="genFarJump"><span class="annot"><span class="annottext">genFarJump :: forall (m :: * -&gt; *).
MonadGetUnique m =&gt;
BlockId -&gt; m (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genFarJump"><span class="hs-identifier hs-var hs-var">genFarJump</span></a></span></span><span> </span><span id="local-6989586621682862294"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862294"><span class="hs-identifier hs-var">far_target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2074"></span><span>  </span><span class="annot"><span class="annottext">OrdList Instr -&gt; m (OrdList Instr)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-2075"></span><span>    </span><span class="annot"><span class="annottext">(OrdList Instr -&gt; m (OrdList Instr))
-&gt; OrdList Instr -&gt; m (OrdList Instr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Instr] -&gt; OrdList Instr
forall a. [a] -&gt; OrdList a
</span><a href="GHC.Data.OrdList.html#toOL"><span class="hs-identifier hs-var">toOL</span></a></span><span>
</span><span id="line-2076"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#ann"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; SDoc
forall doc. IsLine doc =&gt; [Char] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unconditional far jump to: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862294"><span class="hs-identifier hs-var">far_target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2077"></span><span>          </span><span class="annot"><span class="annottext">(Instr -&gt; Instr) -&gt; Instr -&gt; Instr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format -&gt; Operand -&gt; Operand -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-var">LDR</span></a></span><span> </span><span class="annot"><span class="annottext">Format
</span><a href="GHC.CmmToAsm.Format.html#II64"><span class="hs-identifier hs-var">II64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Reg -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpReg"><span class="hs-identifier hs-var">OpReg</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-var">tmpReg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imm -&gt; Operand
</span><a href="GHC.CmmToAsm.RV64.Instr.html#OpImm"><span class="hs-identifier hs-var">OpImm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLabel -&gt; Imm
</span><a href="GHC.CmmToAsm.RV64.Regs.html#ImmCLbl"><span class="hs-identifier hs-var">ImmCLbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; CLabel
</span><a href="GHC.Cmm.BlockId.html#blockLbl"><span class="hs-identifier hs-var">blockLbl</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862294"><span class="hs-identifier hs-var">far_target</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2078"></span><span>        </span><span class="annot"><span class="annottext">Target -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reg -&gt; Target
</span><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-var">TReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><a href="GHC.CmmToAsm.RV64.Regs.html#tmpReg"><span class="hs-identifier hs-var">tmpReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2079"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span class="hs-comment">-- See Note [RISCV64 far jumps]</span><span>
</span><span id="line-2082"></span><span class="hs-keyword">data</span><span> </span><span id="BlockInRange"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#BlockInRange"><span class="hs-identifier hs-var">BlockInRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InRange"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#InRange"><span class="hs-identifier hs-var">InRange</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NotInRange"><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#NotInRange"><span class="hs-identifier hs-var">NotInRange</span></a></span></span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-2083"></span><span>
</span><span id="line-2084"></span><span class="hs-comment">-- See Note [RISCV64 far jumps]</span><span>
</span><span id="line-2085"></span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#makeFarBranches"><span class="hs-identifier hs-type">makeFarBranches</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2086"></span><span>  </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2087"></span><span>  </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><a href="GHC.Cmm.html#RawCmmStatics"><span class="hs-identifier hs-type">RawCmmStatics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2088"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2089"></span><span>  </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#UniqDSM"><span class="hs-identifier hs-type">UniqDSM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.Types.html#NatBasicBlock"><span class="hs-identifier hs-type">NatBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2090"></span><span id="makeFarBranches"><span class="annot"><span class="annottext">makeFarBranches :: Platform
-&gt; LabelMap RawCmmStatics
-&gt; [NatBasicBlock Instr]
-&gt; UniqDSM [NatBasicBlock Instr]
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#makeFarBranches"><span class="hs-identifier hs-var hs-var">makeFarBranches</span></a></span></span><span> </span><span class="hs-comment">{- only used when debugging -}</span><span> </span><span id="local-6989586621682862297"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682862297"><span class="hs-identifier hs-var">_platform</span></a></span></span><span> </span><span id="local-6989586621682862298"><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682862298"><span class="hs-identifier hs-var">statics</span></a></span></span><span> </span><span id="local-6989586621682862299"><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682862299"><span class="hs-identifier hs-var">basic_blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2091"></span><span>  </span><span class="hs-comment">-- All offsets/positions are counted in multiples of 4 bytes (the size of RISCV64 instructions)</span><span>
</span><span id="line-2092"></span><span>  </span><span class="hs-comment">-- That is an offset of 1 represents a 4-byte/one instruction offset.</span><span>
</span><span id="line-2093"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862300"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862300"><span class="hs-identifier hs-var">func_size</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862301"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862301"><span class="hs-identifier hs-var">lblMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, LabelMap Int) -&gt; NatBasicBlock Instr -&gt; (Int, LabelMap Int))
-&gt; (Int, LabelMap Int)
-&gt; [NatBasicBlock Instr]
-&gt; (Int, LabelMap Int)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">(Int, LabelMap Int) -&gt; NatBasicBlock Instr -&gt; (Int, LabelMap Int)
</span><a href="#local-6989586621682862303"><span class="hs-identifier hs-var">calc_lbl_positions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelMap Int
forall v. LabelMap v
</span><a href="GHC.Cmm.Dataflow.Label.html#mapEmpty"><span class="hs-identifier hs-var">mapEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682862299"><span class="hs-identifier hs-var">basic_blocks</span></a></span><span>
</span><span id="line-2094"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862300"><span class="hs-identifier hs-var">func_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862305"><span class="hs-identifier hs-var">max_jump_dist</span></a></span><span>
</span><span id="line-2095"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr] -&gt; UniqDSM [NatBasicBlock Instr]
forall a. a -&gt; UniqDSM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682862299"><span class="hs-identifier hs-var">basic_blocks</span></a></span><span>
</span><span id="line-2096"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2097"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862306"><span class="annot"><a href="#local-6989586621682862306"><span class="hs-identifier hs-var">blocks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int
 -&gt; NatBasicBlock Instr -&gt; UniqDSM (Int, [NatBasicBlock Instr]))
-&gt; Int
-&gt; [NatBasicBlock Instr]
-&gt; UniqDSM (Int, [[NatBasicBlock Instr]])
forall (m :: * -&gt; *) (t :: * -&gt; *) acc x y.
(Monad m, Traversable t) =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; t x -&gt; m (acc, t y)
</span><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LabelMap Int
-&gt; Int
-&gt; NatBasicBlock Instr
-&gt; UniqDSM (Int, [NatBasicBlock Instr])
</span><a href="#local-6989586621682862308"><span class="hs-identifier hs-var">replace_blk</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862301"><span class="hs-identifier hs-var">lblMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682862299"><span class="hs-identifier hs-var">basic_blocks</span></a></span><span>
</span><span id="line-2098"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">concat</span></span><span> </span><span class="annot"><a href="#local-6989586621682862306"><span class="hs-identifier hs-type">blocks</span></a></span><span>
</span><span id="line-2099"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2100"></span><span>    </span><span class="hs-comment">-- pprTrace &quot;lblMap&quot; (ppr lblMap) $ basic_blocks</span><span>
</span><span id="line-2101"></span><span>
</span><span id="line-2102"></span><span>    </span><span class="hs-comment">-- 2^11, 12 bit immediate with one bit is reserved for the sign</span><span>
</span><span id="line-2103"></span><span>    </span><span id="local-6989586621682862305"><span class="annot"><span class="annottext">max_jump_dist :: Int
</span><a href="#local-6989586621682862305"><span class="hs-identifier hs-var hs-var">max_jump_dist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2104"></span><span>    </span><span class="hs-comment">-- Currently all inline info tables fit into 64 bytes.</span><span>
</span><span id="line-2105"></span><span>    </span><span id="local-6989586621682862315"><span class="annot"><span class="annottext">max_info_size :: Int
</span><a href="#local-6989586621682862315"><span class="hs-identifier hs-var hs-var">max_info_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2106"></span><span>    </span><span id="local-6989586621682862316"><span class="annot"><span class="annottext">long_bc_jump_size :: Int
</span><a href="#local-6989586621682862316"><span class="hs-identifier hs-var hs-var">long_bc_jump_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2107"></span><span>    </span><span id="local-6989586621682862317"><span class="annot"><span class="annottext">long_b_jump_size :: Int
</span><a href="#local-6989586621682862317"><span class="hs-identifier hs-var hs-var">long_b_jump_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2108"></span><span>
</span><span id="line-2109"></span><span>    </span><span class="hs-comment">-- Replace out of range conditional jumps with unconditional jumps.</span><span>
</span><span id="line-2110"></span><span>    </span><span class="annot"><a href="#local-6989586621682862308"><span class="hs-identifier hs-type">replace_blk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#UniqDSM"><span class="hs-identifier hs-type">UniqDSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2111"></span><span>    </span><span id="local-6989586621682862308"><span class="annot"><span class="annottext">replace_blk :: LabelMap Int
-&gt; Int
-&gt; NatBasicBlock Instr
-&gt; UniqDSM (Int, [NatBasicBlock Instr])
</span><a href="#local-6989586621682862308"><span class="hs-identifier hs-var hs-var">replace_blk</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862318"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862318"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862319"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862319"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682862320"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862320"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682862321"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862321"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2112"></span><span>      </span><span class="hs-comment">-- Account for a potential info table before the label.</span><span>
</span><span id="line-2113"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862322"><span class="annot"><span class="annottext">block_pos :: Int
</span><a href="#local-6989586621682862322"><span class="hs-identifier hs-var hs-var hs-var">block_pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862319"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; Int
</span><a href="#local-6989586621682862323"><span class="hs-identifier hs-var">infoTblSize_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862320"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-2114"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682862324"><span class="annot"><a href="#local-6989586621682862324"><span class="hs-identifier hs-var">pos'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862325"><span class="annot"><a href="#local-6989586621682862325"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Instr -&gt; UniqDSM (Int, [Instr]))
-&gt; Int -&gt; [Instr] -&gt; UniqDSM (Int, [[Instr]])
forall (m :: * -&gt; *) (t :: * -&gt; *) acc x y.
(Monad m, Traversable t) =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; t x -&gt; m (acc, t y)
</span><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LabelMap Int -&gt; Int -&gt; Instr -&gt; UniqDSM (Int, [Instr])
</span><a href="#local-6989586621682862326"><span class="hs-identifier hs-var">replace_jump</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862318"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862322"><span class="hs-identifier hs-var">block_pos</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862321"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-2115"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862327"><span class="annot"><a href="#local-6989586621682862327"><span class="hs-identifier hs-var hs-var">instrs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Instr]] -&gt; [Instr]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Instr]]
</span><a href="#local-6989586621682862325"><span class="hs-identifier hs-var">instrs'</span></a></span><span>
</span><span id="line-2116"></span><span>      </span><span class="hs-comment">-- We might have introduced new labels, so split the instructions into basic blocks again if neccesary.</span><span>
</span><span id="line-2117"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862328"><span class="annot"><a href="#local-6989586621682862328"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862329"><span class="annot"><a href="#local-6989586621682862329"><span class="hs-identifier hs-var">split_blocks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862330"><span class="annot"><a href="#local-6989586621682862330"><span class="hs-identifier hs-var">no_data</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldr</span></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#mkBlocks"><span class="hs-identifier hs-type">mkBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682862327"><span class="hs-identifier hs-type">instrs''</span></a></span><span>
</span><span id="line-2118"></span><span>      </span><span class="hs-comment">-- There should be no data in the instruction stream at this point</span><span>
</span><span id="line-2119"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682862330"><span class="hs-identifier hs-type">no_data</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2120"></span><span>
</span><span id="line-2121"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682862334"><span class="annot"><a href="#local-6989586621682862334"><span class="hs-identifier hs-var hs-var">final_blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; [Instr] -&gt; NatBasicBlock Instr
forall i. BlockId -&gt; [i] -&gt; GenBasicBlock i
</span><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-var">BasicBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862320"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862328"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">NatBasicBlock Instr
-&gt; [NatBasicBlock Instr] -&gt; [NatBasicBlock Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[NatBasicBlock Instr]
</span><a href="#local-6989586621682862329"><span class="hs-identifier hs-var">split_blocks</span></a></span><span>
</span><span id="line-2122"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862324"><span class="hs-identifier hs-type">pos'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682862334"><span class="hs-identifier hs-type">final_blocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2123"></span><span>
</span><span id="line-2124"></span><span>    </span><span class="annot"><a href="#local-6989586621682862326"><span class="hs-identifier hs-type">replace_jump</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSM.html#UniqDSM"><span class="hs-identifier hs-type">UniqDSM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2125"></span><span>    </span><span id="local-6989586621682862326"><span class="annot"><span class="annottext">replace_jump :: LabelMap Int -&gt; Int -&gt; Instr -&gt; UniqDSM (Int, [Instr])
</span><a href="#local-6989586621682862326"><span class="hs-identifier hs-var hs-var">replace_jump</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862335"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862335"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862336"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621682862337"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2126"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2127"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#ANN"><span class="hs-identifier hs-type">ANN</span></a></span><span> </span><span id="local-6989586621682862338"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862338"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621682862339"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862339"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2128"></span><span>          </span><span class="annot"><span class="annottext">LabelMap Int -&gt; Int -&gt; Instr -&gt; UniqDSM (Int, [Instr])
</span><a href="#local-6989586621682862326"><span class="hs-identifier hs-var">replace_jump</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862335"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862339"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSM (Int, [Instr])
-&gt; ((Int, [Instr]) -&gt; UniqDSM (Int, [Instr]))
-&gt; UniqDSM (Int, [Instr])
forall a b. UniqDSM a -&gt; (a -&gt; UniqDSM b) -&gt; UniqDSM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-2129"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; UniqDSM (Int, [Instr])
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RV64:replace_jump&quot;</span></span><span>
</span><span id="line-2130"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682862341"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862341"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862342"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862342"><span class="hs-identifier hs-var">instr'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682862343"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862343"><span class="hs-identifier hs-var">instrs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2131"></span><span>              </span><span class="annot"><span class="annottext">(Int, [Instr]) -&gt; UniqDSM (Int, [Instr])
forall a. a -&gt; UniqDSM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862341"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Instr -&gt; Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#ANN"><span class="hs-identifier hs-var">ANN</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682862338"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862342"><span class="hs-identifier hs-var">instr'</span></a></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; [Instr] -&gt; [Instr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862343"><span class="hs-identifier hs-var">instrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2132"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span id="local-6989586621682862344"><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682862344"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621682862345"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862345"><span class="hs-identifier hs-var">op1</span></a></span></span><span> </span><span id="local-6989586621682862346"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862346"><span class="hs-identifier hs-var">op2</span></a></span></span><span> </span><span id="local-6989586621682862347"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862347"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2133"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LabelMap Int -&gt; Target -&gt; Int -&gt; BlockInRange
</span><a href="#local-6989586621682862348"><span class="hs-identifier hs-var">target_in_range</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862335"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862347"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2134"></span><span>            </span><span class="annot"><span class="annottext">BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#InRange"><span class="hs-identifier hs-var">InRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, [Instr]) -&gt; UniqDSM (Int, [Instr])
forall a. a -&gt; UniqDSM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var">instr_size</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2135"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#NotInRange"><span class="hs-identifier hs-type">NotInRange</span></a></span><span> </span><span id="local-6989586621682862350"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862350"><span class="hs-identifier hs-var">far_target</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2136"></span><span>              </span><span id="local-6989586621682862351"><span class="annot"><a href="#local-6989586621682862351"><span class="hs-identifier hs-var">jmp_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cond -&gt; Operand -&gt; Operand -&gt; BlockId -&gt; UniqDSM (OrdList Instr)
forall (m :: * -&gt; *).
MonadGetUnique m =&gt;
Cond -&gt; Operand -&gt; Operand -&gt; BlockId -&gt; m (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genCondFarJump"><span class="hs-identifier hs-var">genCondFarJump</span></a></span><span> </span><span class="annot"><span class="annottext">Cond
</span><a href="#local-6989586621682862344"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862345"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682862346"><span class="hs-identifier hs-var">op2</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862350"><span class="hs-identifier hs-var">far_target</span></a></span><span>
</span><span id="line-2137"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862336"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682862349"><span class="hs-identifier hs-type">instr_size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862337"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#fromOL"><span class="hs-identifier hs-type">fromOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862351"><span class="hs-identifier hs-type">jmp_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2138"></span><span>        </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span id="local-6989586621682862353"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862353"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2139"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LabelMap Int -&gt; Target -&gt; Int -&gt; BlockInRange
</span><a href="#local-6989586621682862348"><span class="hs-identifier hs-var">target_in_range</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862335"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862353"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2140"></span><span>            </span><span class="annot"><span class="annottext">BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#InRange"><span class="hs-identifier hs-var">InRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, [Instr]) -&gt; UniqDSM (Int, [Instr])
forall a. a -&gt; UniqDSM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var">instr_size</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2141"></span><span>            </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#NotInRange"><span class="hs-identifier hs-type">NotInRange</span></a></span><span> </span><span id="local-6989586621682862354"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862354"><span class="hs-identifier hs-var">far_target</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2142"></span><span>              </span><span id="local-6989586621682862355"><span class="annot"><a href="#local-6989586621682862355"><span class="hs-identifier hs-var">jmp_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; UniqDSM (OrdList Instr)
forall (m :: * -&gt; *).
MonadGetUnique m =&gt;
BlockId -&gt; m (OrdList Instr)
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#genFarJump"><span class="hs-identifier hs-var">genFarJump</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862354"><span class="hs-identifier hs-var">far_target</span></a></span><span>
</span><span id="line-2143"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682862336"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682862349"><span class="hs-identifier hs-type">instr_size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862337"><span class="hs-identifier hs-type">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.OrdList.html#fromOL"><span class="hs-identifier hs-type">fromOL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682862355"><span class="hs-identifier hs-type">jmp_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2144"></span><span>        </span><span class="annot"><span class="annottext">Instr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, [Instr]) -&gt; UniqDSM (Int, [Instr])
forall a. a -&gt; UniqDSM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862336"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var">instr_size</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862337"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2145"></span><span>
</span><span id="line-2146"></span><span>    </span><span class="annot"><a href="#local-6989586621682862348"><span class="hs-identifier hs-type">target_in_range</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#BlockInRange"><span class="hs-identifier hs-type">BlockInRange</span></a></span><span>
</span><span id="line-2147"></span><span>    </span><span id="local-6989586621682862348"><span class="annot"><span class="annottext">target_in_range :: LabelMap Int -&gt; Target -&gt; Int -&gt; BlockInRange
</span><a href="#local-6989586621682862348"><span class="hs-identifier hs-var hs-var">target_in_range</span></a></span></span><span> </span><span id="local-6989586621682862356"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862356"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682862357"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862357"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621682862358"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862358"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2148"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621682862357"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2149"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-type">TReg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#InRange"><span class="hs-identifier hs-var">InRange</span></a></span><span>
</span><span id="line-2150"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span id="local-6989586621682862359"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862359"><span class="hs-identifier hs-var">bid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LabelMap Int -&gt; Int -&gt; BlockId -&gt; BlockInRange
</span><a href="#local-6989586621682862360"><span class="hs-identifier hs-var">block_in_range</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862356"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862358"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862359"><span class="hs-identifier hs-var">bid</span></a></span><span>
</span><span id="line-2151"></span><span>
</span><span id="line-2152"></span><span>    </span><span class="annot"><a href="#local-6989586621682862360"><span class="hs-identifier hs-type">block_in_range</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.BlockId.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.CodeGen.html#BlockInRange"><span class="hs-identifier hs-type">BlockInRange</span></a></span><span>
</span><span id="line-2153"></span><span>    </span><span id="local-6989586621682862360"><span class="annot"><span class="annottext">block_in_range :: LabelMap Int -&gt; Int -&gt; BlockId -&gt; BlockInRange
</span><a href="#local-6989586621682862360"><span class="hs-identifier hs-var hs-var">block_in_range</span></a></span></span><span> </span><span id="local-6989586621682862361"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862361"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682862362"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862362"><span class="hs-identifier hs-var">src_pos</span></a></span></span><span> </span><span id="local-6989586621682862363"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862363"><span class="hs-identifier hs-var">dest_lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2154"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; LabelMap Int -&gt; Maybe Int
forall a. BlockId -&gt; LabelMap a -&gt; Maybe a
</span><a href="GHC.Cmm.Dataflow.Label.html#mapLookup"><span class="hs-identifier hs-var">mapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862363"><span class="hs-identifier hs-var">dest_lbl</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862361"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2155"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2156"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; SDoc -&gt; BlockInRange -&gt; BlockInRange
forall a. [Char] -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Trace.html#pprTrace"><span class="hs-identifier hs-var">pprTrace</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;not in range&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862363"><span class="hs-identifier hs-var">dest_lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2157"></span><span>            </span><span class="annot"><span class="annottext">(BlockInRange -&gt; BlockInRange) -&gt; BlockInRange -&gt; BlockInRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#NotInRange"><span class="hs-identifier hs-var">NotInRange</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862363"><span class="hs-identifier hs-var">dest_lbl</span></a></span><span>
</span><span id="line-2158"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682862366"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862366"><span class="hs-identifier hs-var">dest_pos</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2159"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862366"><span class="hs-identifier hs-var">dest_pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862362"><span class="hs-identifier hs-var">src_pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862305"><span class="hs-identifier hs-var">max_jump_dist</span></a></span><span>
</span><span id="line-2160"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#InRange"><span class="hs-identifier hs-var">InRange</span></a></span><span>
</span><span id="line-2161"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; BlockInRange
</span><a href="GHC.CmmToAsm.RV64.CodeGen.html#NotInRange"><span class="hs-identifier hs-var">NotInRange</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862363"><span class="hs-identifier hs-var">dest_lbl</span></a></span><span>
</span><span id="line-2162"></span><span>
</span><span id="line-2163"></span><span>    </span><span class="annot"><a href="#local-6989586621682862303"><span class="hs-identifier hs-type">calc_lbl_positions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.html#GenBasicBlock"><span class="hs-identifier hs-type">GenBasicBlock</span></a></span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-2164"></span><span>    </span><span id="local-6989586621682862303"><span class="annot"><span class="annottext">calc_lbl_positions :: (Int, LabelMap Int) -&gt; NatBasicBlock Instr -&gt; (Int, LabelMap Int)
</span><a href="#local-6989586621682862303"><span class="hs-identifier hs-var hs-var">calc_lbl_positions</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862368"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862368"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862369"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862369"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.html#BasicBlock"><span class="hs-identifier hs-type">BasicBlock</span></a></span><span> </span><span id="local-6989586621682862370"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862370"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682862371"><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862371"><span class="hs-identifier hs-var">instrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2165"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682862372"><span class="annot"><span class="annottext">pos' :: Int
</span><a href="#local-6989586621682862372"><span class="hs-identifier hs-var hs-var">pos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862368"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; Int
</span><a href="#local-6989586621682862323"><span class="hs-identifier hs-var">infoTblSize_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862370"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-2166"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((Int, LabelMap Int) -&gt; Instr -&gt; (Int, LabelMap Int))
-&gt; (Int, LabelMap Int) -&gt; [Instr] -&gt; (Int, LabelMap Int)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">(Int, LabelMap Int) -&gt; Instr -&gt; (Int, LabelMap Int)
</span><a href="#local-6989586621682862373"><span class="hs-identifier hs-var">instr_pos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862372"><span class="hs-identifier hs-var">pos'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; Int -&gt; LabelMap Int -&gt; LabelMap Int
forall v. BlockId -&gt; v -&gt; LabelMap v -&gt; LabelMap v
</span><a href="GHC.Cmm.Dataflow.Label.html#mapInsert"><span class="hs-identifier hs-var">mapInsert</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862370"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862372"><span class="hs-identifier hs-var">pos'</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862369"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Instr]
</span><a href="#local-6989586621682862371"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-2167"></span><span>
</span><span id="line-2168"></span><span>    </span><span class="annot"><a href="#local-6989586621682862373"><span class="hs-identifier hs-type">instr_pos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Cmm.Dataflow.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-2169"></span><span>    </span><span id="local-6989586621682862373"><span class="annot"><span class="annottext">instr_pos :: (Int, LabelMap Int) -&gt; Instr -&gt; (Int, LabelMap Int)
</span><a href="#local-6989586621682862373"><span class="hs-identifier hs-var hs-var">instr_pos</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682862375"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862375"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682862376"><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862376"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682862377"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862377"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862375"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var">instr_size</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862377"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelMap Int
</span><a href="#local-6989586621682862376"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2170"></span><span>
</span><span id="line-2171"></span><span>    </span><span id="local-6989586621682862323"><span class="annot"><span class="annottext">infoTblSize_maybe :: BlockId -&gt; Int
</span><a href="#local-6989586621682862323"><span class="hs-identifier hs-var hs-var">infoTblSize_maybe</span></a></span></span><span> </span><span id="local-6989586621682862378"><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862378"><span class="hs-identifier hs-var">bid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2172"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; LabelMap RawCmmStatics -&gt; Maybe RawCmmStatics
forall a. BlockId -&gt; LabelMap a -&gt; Maybe a
</span><a href="GHC.Cmm.Dataflow.Label.html#mapLookup"><span class="hs-identifier hs-var">mapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><a href="#local-6989586621682862378"><span class="hs-identifier hs-var">bid</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMap RawCmmStatics
</span><a href="#local-6989586621682862298"><span class="hs-identifier hs-var">statics</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2173"></span><span>        </span><span class="annot"><span class="annottext">Maybe RawCmmStatics
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2174"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682862379"><span class="annot"><span class="annottext">RawCmmStatics
</span><a href="#local-6989586621682862379"><span class="hs-identifier hs-var">_info_static</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862315"><span class="hs-identifier hs-var">max_info_size</span></a></span><span>
</span><span id="line-2175"></span><span>
</span><span id="line-2176"></span><span>    </span><span class="annot"><a href="#local-6989586621682862349"><span class="hs-identifier hs-type">instr_size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#Instr"><span class="hs-identifier hs-type">Instr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-2177"></span><span>    </span><span id="local-6989586621682862349"><span class="annot"><span class="annottext">instr_size :: Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var hs-var">instr_size</span></a></span></span><span> </span><span id="local-6989586621682862380"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862380"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2178"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#COMMENT"><span class="hs-identifier hs-type">COMMENT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2179"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MULTILINE_COMMENT"><span class="hs-identifier hs-type">MULTILINE_COMMENT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2180"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#ANN"><span class="hs-identifier hs-type">ANN</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682862381"><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862381"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instr -&gt; Int
</span><a href="#local-6989586621682862349"><span class="hs-identifier hs-var">instr_size</span></a></span><span> </span><span class="annot"><span class="annottext">Instr
</span><a href="#local-6989586621682862381"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-2181"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LOCATION"><span class="hs-identifier hs-type">LOCATION</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2182"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#DELTA"><span class="hs-identifier hs-type">DELTA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2183"></span><span>      </span><span class="hs-comment">-- At this point there should be no NEWBLOCK in the instruction stream (pos, mapInsert bid pos m)</span><span>
</span><span id="line-2184"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#NEWBLOCK"><span class="hs-identifier hs-type">NEWBLOCK</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mkFarBranched - Unexpected&quot;</span></span><span>
</span><span id="line-2185"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LDATA"><span class="hs-identifier hs-type">LDATA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mkFarBranched - Unexpected&quot;</span></span><span>
</span><span id="line-2186"></span><span>      </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#PUSH_STACK_FRAME"><span class="hs-identifier hs-var">PUSH_STACK_FRAME</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-2187"></span><span>      </span><span class="annot"><span class="annottext">Instr
</span><a href="GHC.CmmToAsm.RV64.Instr.html#POP_STACK_FRAME"><span class="hs-identifier hs-var">POP_STACK_FRAME</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-2188"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#ADD"><span class="hs-identifier hs-type">ADD</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2189"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MUL"><span class="hs-identifier hs-type">MUL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2190"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MULH"><span class="hs-identifier hs-type">MULH</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2191"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#NEG"><span class="hs-identifier hs-type">NEG</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2192"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#DIV"><span class="hs-identifier hs-type">DIV</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2193"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#REM"><span class="hs-identifier hs-type">REM</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2194"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#REMU"><span class="hs-identifier hs-type">REMU</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2195"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#SUB"><span class="hs-identifier hs-type">SUB</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2196"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#DIVU"><span class="hs-identifier hs-type">DIVU</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2197"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#AND"><span class="hs-identifier hs-type">AND</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2198"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#OR"><span class="hs-identifier hs-type">OR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2199"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#SRA"><span class="hs-identifier hs-type">SRA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2200"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#XOR"><span class="hs-identifier hs-type">XOR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2201"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#SLL"><span class="hs-identifier hs-type">SLL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2202"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#SRL"><span class="hs-identifier hs-type">SRL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2203"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#MOV"><span class="hs-identifier hs-type">MOV</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2204"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#ORI"><span class="hs-identifier hs-type">ORI</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2205"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#XORI"><span class="hs-identifier hs-type">XORI</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2206"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#CSET"><span class="hs-identifier hs-type">CSET</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2207"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#STR"><span class="hs-identifier hs-type">STR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2208"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LDR"><span class="hs-identifier hs-type">LDR</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2209"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#LDRU"><span class="hs-identifier hs-type">LDRU</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2210"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FENCE"><span class="hs-identifier hs-type">FENCE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2211"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FCVT"><span class="hs-identifier hs-type">FCVT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2212"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FABS"><span class="hs-identifier hs-type">FABS</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2213"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FMIN"><span class="hs-identifier hs-type">FMIN</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2214"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FMAX"><span class="hs-identifier hs-type">FMAX</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2215"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#FMA"><span class="hs-identifier hs-type">FMA</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2216"></span><span>      </span><span class="hs-comment">-- estimate the subsituted size for jumps to lables</span><span>
</span><span id="line-2217"></span><span>      </span><span class="hs-comment">-- jumps to registers have size 1</span><span>
</span><span id="line-2218"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BCOND"><span class="hs-identifier hs-type">BCOND</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862316"><span class="hs-identifier hs-var">long_bc_jump_size</span></a></span><span>
</span><span id="line-2219"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TBlock"><span class="hs-identifier hs-type">TBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682862317"><span class="hs-identifier hs-var">long_b_jump_size</span></a></span><span>
</span><span id="line-2220"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#TReg"><span class="hs-identifier hs-type">TReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2221"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#BL"><span class="hs-identifier hs-type">BL</span></a></span><span> </span><span class="annot"><span class="annottext">Reg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Reg]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2222"></span><span>      </span><span class="annot"><a href="GHC.CmmToAsm.RV64.Instr.html#J_TBL"><span class="hs-identifier hs-type">J_TBL</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2223"></span></pre></body></html>