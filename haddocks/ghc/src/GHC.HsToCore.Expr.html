<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


Desugaring expressions.
-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html"><span class="hs-identifier">GHC.HsToCore.Expr</span></a></span><span>
</span><span id="line-17"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier">dsExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier">dsLExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier">dsLocalBinds</span></a></span><span>
</span><span id="line-18"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsValBinds"><span class="hs-identifier">dsValBinds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsLit"><span class="hs-identifier">dsLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier">dsSyntaxExpr</span></a></span><span>
</span><span id="line-19"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html"><span class="hs-identifier">GHC.HsToCore.Match</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html"><span class="hs-identifier">GHC.HsToCore.Match.Literal</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Binds.html"><span class="hs-identifier">GHC.HsToCore.Binds</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.GuardedRHSs.html"><span class="hs-identifier">GHC.HsToCore.GuardedRHSs</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.ListComp.html"><span class="hs-identifier">GHC.HsToCore.ListComp</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html"><span class="hs-identifier">GHC.HsToCore.Utils</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Arrows.html"><span class="hs-identifier">GHC.HsToCore.Arrows</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html"><span class="hs-identifier">GHC.HsToCore.Monad</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Pmc.html"><span class="hs-identifier">GHC.HsToCore.Pmc</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html"><span class="hs-identifier">GHC.HsToCore.Errors.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier">varName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#topNormaliseType"><span class="hs-identifier">topNormaliseType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Quote.html"><span class="hs-identifier">GHC.HsToCore.Quote</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Ticks.html"><span class="hs-identifier">GHC.HsToCore.Ticks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Ticks.html#stripTicksTopHsExpr"><span class="hs-identifier">stripTicksTopHsExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- NB: The desugarer, which straddles the source and Core worlds, sometimes</span><span>
</span><span id="line-42"></span><span class="hs-comment">--     needs to see source types</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html"><span class="hs-identifier">GHC.Tc.Types.Evidence</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Make.html"><span class="hs-identifier">GHC.Core.Make</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.CostCentre.html"><span class="hs-identifier">GHC.Types.CostCentre</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html"><span class="hs-identifier">GHC.Types.Id.Make</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html"><span class="hs-identifier">GHC.Core.ConLike</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html"><span class="hs-identifier">GHC.Core.PatSyn</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                dsLocalBinds, dsValBinds
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-type">dsLocalBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-81"></span><span id="dsLocalBinds"><span class="annot"><span class="annottext">dsLocalBinds :: HsLocalBinds GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-var hs-var">dsLocalBinds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#EmptyLocalBinds"><span class="hs-identifier hs-type">EmptyLocalBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XEmptyLocalBinds GhcTc GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683141479"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141479"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141479"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-var">dsLocalBinds</span></a></span><span> </span><span id="local-6989586621683141480"><span class="annot"><span class="annottext">b :: HsLocalBinds GhcTc
</span><a href="#local-6989586621683141480"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XHsValBinds GhcTc GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141482"><span class="annot"><span class="annottext">HsValBindsLR GhcTc GhcTc
</span><a href="#local-6989586621683141482"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141483"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141483"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a. SrcSpan -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLocalBinds GhcTc -&gt; SrcSpan
forall (p :: Pass). HsLocalBinds (GhcPass p) -&gt; SrcSpan
</span><a href="GHC.Hs.Utils.html#spanHsLocaLBinds"><span class="hs-identifier hs-var">spanHsLocaLBinds</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcTc
</span><a href="#local-6989586621683141480"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-83"></span><span>                                           </span><span class="annot"><span class="annottext">HsValBindsLR GhcTc GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsValBinds"><span class="hs-identifier hs-var">dsValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">HsValBindsLR GhcTc GhcTc
</span><a href="#local-6989586621683141482"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141483"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-84"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-var">dsLocalBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsIPBinds"><span class="hs-identifier hs-type">HsIPBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XHsIPBinds GhcTc GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141487"><span class="annot"><span class="annottext">HsIPBinds GhcTc
</span><a href="#local-6989586621683141487"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621683141488"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141488"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsIPBinds GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsIPBinds"><span class="hs-identifier hs-var">dsIPBinds</span></a></span><span>  </span><span class="annot"><span class="annottext">HsIPBinds GhcTc
</span><a href="#local-6989586621683141487"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141488"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- caller sets location</span><span>
</span><span id="line-88"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsValBinds"><span class="hs-identifier hs-type">dsValBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsValBinds"><span class="hs-identifier hs-type">HsValBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-89"></span><span id="dsValBinds"><span class="annot"><span class="annottext">dsValBinds :: HsValBindsLR GhcTc GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsValBinds"><span class="hs-identifier hs-var hs-var">dsValBinds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XValBindsLR"><span class="hs-identifier hs-type">XValBindsLR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#NValBinds"><span class="hs-identifier hs-type">NValBinds</span></a></span><span> </span><span id="local-6989586621683141493"><span class="annot"><span class="annottext">[(RecFlag, LHsBinds GhcTc)]
</span><a href="#local-6989586621683141493"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141494"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141494"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141495"><span class="annot"><a href="#local-6989586621683141495"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-91"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldrM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-type">ds_val_bind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141495"><span class="hs-identifier hs-type">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141494"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141493"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsValBinds"><span class="hs-identifier hs-var">dsValBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsValBinds ValBindsIn&quot;</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-95"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsIPBinds"><span class="hs-identifier hs-type">dsIPBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsIPBinds"><span class="hs-identifier hs-type">HsIPBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-96"></span><span id="dsIPBinds"><span class="annot"><span class="annottext">dsIPBinds :: HsIPBinds GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsIPBinds"><span class="hs-identifier hs-var hs-var">dsIPBinds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#IPBinds"><span class="hs-identifier hs-type">IPBinds</span></a></span><span> </span><span id="local-6989586621683141502"><span class="annot"><span class="annottext">XIPBinds GhcTc
</span><a href="#local-6989586621683141502"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span> </span><span id="local-6989586621683141503"><span class="annot"><span class="annottext">[LIPBind GhcTc]
</span><a href="#local-6989586621683141503"><span class="hs-identifier hs-var">ip_binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141504"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141504"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TcEvBinds -&gt; ([CoreBind] -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a. TcEvBinds -&gt; ([CoreBind] -&gt; DsM a) -&gt; DsM a
</span><a href="GHC.HsToCore.Binds.html#dsTcEvBinds"><span class="hs-identifier hs-var">dsTcEvBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XIPBinds GhcTc
TcEvBinds
</span><a href="#local-6989586621683141502"><span class="hs-identifier hs-var">ev_binds</span></a></span><span> </span><span class="annot"><span class="annottext">(([CoreBind] -&gt; DsM CoreExpr) -&gt; DsM CoreExpr)
-&gt; ([CoreBind] -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683141506"><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621683141506"><span class="hs-identifier hs-var">ds_binds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141507"><span class="annot"><span class="annottext">inner :: CoreExpr
</span><a href="#local-6989586621683141507"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreBind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLets"><span class="hs-identifier hs-var">mkCoreLets</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621683141506"><span class="hs-identifier hs-var">ds_binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141504"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-99"></span><span>                </span><span class="hs-comment">-- The dict bindings may not be in</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-comment">-- dependency order; hence Rec</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IPBind GhcTc) -&gt; CoreExpr -&gt; DsM CoreExpr)
-&gt; CoreExpr
-&gt; [GenLocated SrcSpanAnnA (IPBind GhcTc)]
-&gt; DsM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldrM</span></span><span> </span><span class="annot"><span class="annottext">LIPBind GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
GenLocated SrcSpanAnnA (IPBind GhcTc) -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="#local-6989586621683141509"><span class="hs-identifier hs-var">ds_ip_bind</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141507"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">[LIPBind GhcTc]
[GenLocated SrcSpanAnnA (IPBind GhcTc)]
</span><a href="#local-6989586621683141503"><span class="hs-identifier hs-var">ip_binds</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="#local-6989586621683141509"><span class="hs-identifier hs-type">ds_ip_bind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LIPBind"><span class="hs-identifier hs-type">LIPBind</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621683141509"><span class="annot"><span class="annottext">ds_ip_bind :: LIPBind GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="#local-6989586621683141509"><span class="hs-identifier hs-var hs-var">ds_ip_bind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#IPBind"><span class="hs-identifier hs-type">IPBind</span></a></span><span> </span><span id="local-6989586621683141512"><span class="annot"><span class="annottext">XCIPBind GhcTc
</span><a href="#local-6989586621683141512"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">XRec GhcTc HsIPName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141513"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141513"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141514"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141514"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683141515"><span class="annot"><a href="#local-6989586621683141515"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141513"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-106"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141512"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141515"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141514"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- caller sets location</span><span>
</span><span id="line-110"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-type">ds_val_bind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- Special case for bindings which bind unlifted variables</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- We need to do a case right away, rather than building</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- a tuple and doing selections.</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Silently ignore INLINE and SPECIALISE pragmas...</span><span>
</span><span id="line-115"></span><span id="ds_val_bind"><span class="annot"><span class="annottext">ds_val_bind :: DynFlags -&gt; (RecFlag, LHsBinds GhcTc) -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-var hs-var">ds_val_bind</span></a></span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag
</span><a href="GHC.Types.Basic.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141519"><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141519"><span class="hs-identifier hs-var">hsbinds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141520"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141520"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141521"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141521"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683141522"><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141519"><span class="hs-identifier hs-var">hsbinds</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-comment">-- Non-recursive, non-overloaded bindings only come in ones</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- ToDo: in some bizarre case it's conceivable that there</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-comment">--       could be dict binds in the 'binds'.  (See the notes</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-comment">--       below.  Then pattern-match would fail.  Urk.)</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; Bool
</span><a href="GHC.Hs.Utils.html#isUnliftedHsBind"><span class="hs-identifier hs-var">isUnliftedHsBind</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a. SrcSpan -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141521"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-123"></span><span>     </span><span class="hs-comment">-- see Note [Strict binds checks] in GHC.HsToCore.Binds</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; Bool
forall {idL} {idR}.
(XXHsBindsLR idL idR ~ AbsBinds) =&gt;
HsBindLR idL idR -&gt; Bool
</span><a href="#local-6989586621683141525"><span class="hs-identifier hs-var">is_polymorphic</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Monad.html#errDsCoreExpr"><span class="hs-identifier hs-var">errDsCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsCannotMixPolyAndUnliftedBindings"><span class="hs-identifier hs-var">DsCannotMixPolyAndUnliftedBindings</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-comment">-- data Ptr a = Ptr Addr#</span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-comment">-- f x = let p@(Ptr y) = ... in ...</span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-comment">-- Here the binding for 'p' is polymorphic, but does</span><span>
</span><span id="line-129"></span><span>            </span><span class="hs-comment">-- not mix with an unlifted binding for 'y'.  You should</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-comment">-- use a bang pattern.  #6078.</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; Bool
</span><a href="GHC.Hs.Pat.html#looksLazyPatBind"><span class="hs-identifier hs-var">looksLazyPatBind</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env DsGblEnv DsLclEnv) ()
 -&gt; IOEnv (Env DsGblEnv DsLclEnv) ())
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-133"></span><span>              </span><span class="annot"><span class="annottext">DsMessage -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsUnbangedStrictPatterns"><span class="hs-identifier hs-var">DsUnbangedStrictPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-comment">-- Complain about a binding that looks lazy</span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-comment">--    e.g.    let I# y = x in ...</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-comment">-- Remember, in checkStrictBinds we are going to do strict</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-comment">-- matching, so (for software engineering reasons) we insist</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-comment">-- that the strictness is manifest on each binding</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-comment">-- However, lone (unboxed) variables are ok</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var">dsUnliftedBind</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141522"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141520"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621683141525"><span class="annot"><span class="annottext">is_polymorphic :: HsBindLR idL idR -&gt; Bool
</span><a href="#local-6989586621683141525"><span class="hs-identifier hs-var hs-var">is_polymorphic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XHsBindsLR"><span class="hs-identifier hs-type">XHsBindsLR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#AbsBinds"><span class="hs-identifier hs-type">AbsBinds</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">abs_tvs :: AbsBinds -&gt; [Id]
</span><a href="GHC.Hs.Binds.html#abs_tvs"><span class="hs-identifier hs-var">abs_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141540"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141540"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abs_ev_vars :: AbsBinds -&gt; [Id]
</span><a href="GHC.Hs.Binds.html#abs_ev_vars"><span class="hs-identifier hs-var">abs_ev_vars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141542"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141542"><span class="hs-identifier hs-var">evs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141540"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141542"><span class="hs-identifier hs-var">evs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="#local-6989586621683141525"><span class="hs-identifier hs-var">is_polymorphic</span></a></span><span> </span><span class="annot"><span class="annottext">HsBindLR idL idR
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-var">ds_val_bind</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141546"><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621683141546"><span class="hs-identifier hs-var">is_rec</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141547"><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141547"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141548"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141548"><span class="hs-identifier hs-var">_body</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsBind GhcTc) -&gt; Bool)
-&gt; [GenLocated SrcSpanAnnA (HsBind GhcTc)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; Bool
</span><a href="GHC.Hs.Utils.html#isUnliftedHsBind"><span class="hs-identifier hs-var">isUnliftedHsBind</span></a></span><span> </span><span class="annot"><span class="annottext">(HsBind GhcTc -&gt; Bool)
-&gt; (GenLocated SrcSpanAnnA (HsBind GhcTc) -&gt; HsBind GhcTc)
-&gt; GenLocated SrcSpanAnnA (HsBind GhcTc)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsBind GhcTc) -&gt; HsBind GhcTc
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
[GenLocated SrcSpanAnnA (HsBind GhcTc)]
</span><a href="#local-6989586621683141547"><span class="hs-identifier hs-var">binds</span></a></span><span>  </span><span class="hs-comment">-- see Note [Strict binds checks] in GHC.HsToCore.Binds</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (DsMessage -&gt; DsM CoreExpr) -&gt; DsMessage -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isRec"><span class="hs-identifier hs-var">isRec</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621683141546"><span class="hs-identifier hs-var">is_rec</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Monad.html#errDsCoreExpr"><span class="hs-identifier hs-var">errDsCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(DsMessage -&gt; DsM CoreExpr) -&gt; DsMessage -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc -&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsRecBindsNotAllowedForUnliftedTys"><span class="hs-identifier hs-var">DsRecBindsNotAllowedForUnliftedTys</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141547"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- Special case: a non-recursive PatBind. No dancing about with lets and seqs,</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- we make a case immediately. Very important for linear types: let !pat can be</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- linear, but selectors as used in the general case aren't. So the general case</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- would transform a linear definition into a non-linear one. See Wrinkle 2</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- Note [Desugar Strict binds] in GHC.HsToCore.Binds.</span><span>
</span><span id="line-159"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-var">ds_val_bind</span></a></span><span> </span><span id="local-6989586621683141555"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683141555"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag
</span><a href="GHC.Types.Basic.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141556"><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141556"><span class="hs-identifier hs-var">hsbinds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141557"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141557"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141558"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141558"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PatBind"><span class="hs-identifier hs-type">PatBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pat_lhs :: forall idL idR. HsBindLR idL idR -&gt; LPat idL
</span><a href="Language.Haskell.Syntax.Binds.html#pat_lhs"><span class="hs-identifier hs-var">pat_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141561"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141561"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pat_rhs :: forall idL idR. HsBindLR idL idR -&gt; GRHSs idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#pat_rhs"><span class="hs-identifier hs-var">pat_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141563"><span class="annot"><span class="annottext">GRHSs GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141563"><span class="hs-identifier hs-var">grhss</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pat_mult :: forall idL idR. HsBindLR idL idR -&gt; HsMultAnn idL
</span><a href="Language.Haskell.Syntax.Binds.html#pat_mult"><span class="hs-identifier hs-var">pat_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141565"><span class="annot"><span class="annottext">HsMultAnn GhcTc
</span><a href="#local-6989586621683141565"><span class="hs-identifier hs-var">mult_ann</span></a></span></span><span>
</span><span id="line-161"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pat_ext :: forall idL idR. HsBindLR idL idR -&gt; XPatBind idL idR
</span><a href="Language.Haskell.Syntax.Binds.html#pat_ext"><span class="hs-identifier hs-var">pat_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141567"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141567"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141568"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621683141568"><span class="hs-identifier hs-var">rhs_tick</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141569"><span class="annot"><span class="annottext">[[CoreTickish]]
</span><a href="#local-6989586621683141569"><span class="hs-identifier hs-var">_var_ticks</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141556"><span class="hs-identifier hs-var">hsbinds</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-comment">-- Non-recursive, non-overloaded bindings only come in ones</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141570"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141570"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; LPat GhcTc -&gt; LPat GhcTc
</span><a href="GHC.HsToCore.Utils.html#decideBangHood"><span class="hs-identifier hs-var">decideBangHood</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683141555"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141561"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LPat GhcTc -&gt; Bool
forall (p :: Pass). LPat (GhcPass p) -&gt; Bool
</span><a href="GHC.Hs.Pat.html#isBangedLPat"><span class="hs-identifier hs-var">isBangedLPat</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141570"><span class="hs-identifier hs-var">pat'</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141573"><span class="annot"><a href="#local-6989586621683141573"><span class="hs-identifier hs-var">rhss_nablas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
-&gt; GRHSs GhcTc (LHsExpr GhcTc) -&gt; DsM (NonEmpty Nablas)
</span><a href="GHC.HsToCore.Pmc.html#pmcGRHSs"><span class="hs-identifier hs-var">pmcGRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. HsMatchContext fn
</span><a href="Language.Haskell.Syntax.Expr.html#PatBindGuards"><span class="hs-identifier hs-var">PatBindGuards</span></a></span><span> </span><span class="annot"><span class="annottext">GRHSs GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141563"><span class="hs-identifier hs-var">grhss</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141576"><span class="annot"><a href="#local-6989586621683141576"><span class="hs-identifier hs-var">rhs_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.GuardedRHSs.html#dsGuarded"><span class="hs-identifier hs-type">dsGuarded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141563"><span class="hs-identifier hs-type">grhss</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141567"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141573"><span class="hs-identifier hs-type">rhss_nablas</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141578"><span class="annot"><a href="#local-6989586621683141578"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.HsToCore.Utils.html#mkOptTickBox"><span class="hs-identifier hs-var">mkOptTickBox</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621683141568"><span class="hs-identifier hs-var">rhs_tick</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141576"><span class="hs-identifier hs-var">rhs_expr</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141580"><span class="annot"><a href="#local-6989586621683141580"><span class="hs-identifier hs-var hs-var">body_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Type
CoreExpr -&gt; Type
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141557"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141582"><span class="annot"><a href="#local-6989586621683141582"><span class="hs-identifier hs-var hs-var">mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsMultAnn GhcTc -&gt; Type
</span><a href="GHC.Hs.Binds.html#getTcMultAnn"><span class="hs-identifier hs-var">getTcMultAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsMultAnn GhcTc
</span><a href="#local-6989586621683141565"><span class="hs-identifier hs-var">mult_ann</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141584"><span class="annot"><a href="#local-6989586621683141584"><span class="hs-identifier hs-var">error_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkErrorAppDs"><span class="hs-identifier hs-type">mkErrorAppDs</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#pAT_ERROR_ID"><span class="hs-identifier hs-type">pAT_ERROR_ID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141580"><span class="hs-identifier hs-type">body_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141570"><span class="hs-identifier hs-type">pat'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#matchSimply"><span class="hs-identifier hs-type">matchSimply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141578"><span class="hs-identifier hs-type">rhs'</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#PatBindRhs"><span class="hs-identifier hs-type">PatBindRhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141582"><span class="hs-identifier hs-type">mult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141570"><span class="hs-identifier hs-type">pat'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141557"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141584"><span class="hs-identifier hs-type">error_expr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- This is the one place where matchSimply is given a non-ManyTy</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- multiplicity argument.</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- In this form, there isn't a natural place for the var_ticks. In</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-comment">-- mkSelectorBinds, the ticks are around the selector function but there</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- aren't any selection functions as we make a single pattern-match. Is this a</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- problem?</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Ordinary case for bindings; none should be unlifted</span><span>
</span><span id="line-181"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_val_bind"><span class="hs-identifier hs-var">ds_val_bind</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141590"><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621683141590"><span class="hs-identifier hs-var">is_rec</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141591"><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141591"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141592"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141592"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isRec"><span class="hs-identifier hs-var">isRec</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621683141590"><span class="hs-identifier hs-var">is_rec</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsBind GhcTc)] -&gt; Bool
forall a. [a] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#isSingleton"><span class="hs-identifier hs-var">isSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
[GenLocated SrcSpanAnnA (HsBind GhcTc)]
</span><a href="#local-6989586621683141591"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>               </span><span class="hs-comment">-- we should never produce a non-recursive list of multiple binds</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141596"><span class="annot"><a href="#local-6989586621683141596"><span class="hs-identifier hs-var">force_vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683141597"><span class="annot"><a href="#local-6989586621683141597"><span class="hs-identifier hs-var">prs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc -&gt; DsM ([Id], [(Id, CoreExpr)])
</span><a href="GHC.HsToCore.Binds.html#dsLHsBinds"><span class="hs-identifier hs-var">dsLHsBinds</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141591"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141599"><span class="annot"><a href="#local-6989586621683141599"><span class="hs-identifier hs-var hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Id -&gt; CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; [Id] -&gt; CoreExpr
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.HsToCore.Utils.html#seqVar"><span class="hs-identifier hs-var">seqVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141592"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141596"><span class="hs-identifier hs-var">force_vars</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-type">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isUnliftedType"><span class="hs-identifier hs-type">isUnliftedType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141597"><span class="hs-identifier hs-type">prs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141590"><span class="hs-identifier hs-type">is_rec</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141591"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-comment">-- NB: bindings have a fixed RuntimeRep, so it's OK to call isUnliftedType</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683141597"><span class="hs-identifier hs-type">prs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141592"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">[(Id, CoreExpr)]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreBind] -&gt; CoreExpr -&gt; CoreExpr
forall b. [Bind b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag -&gt; [(Id, CoreExpr)] -&gt; [CoreBind]
forall b. RecFlag -&gt; [(b, Expr b)] -&gt; [Bind b]
</span><a href="GHC.HsToCore.Expr.html#mk_binds"><span class="hs-identifier hs-var">mk_binds</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621683141590"><span class="hs-identifier hs-var">is_rec</span></a></span><span> </span><span class="annot"><span class="annottext">[(Id, CoreExpr)]
</span><a href="#local-6989586621683141597"><span class="hs-identifier hs-var">prs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141599"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-comment">-- We can make a non-recursive let because we make sure to return</span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-comment">-- the bindings in dependency order in dsLHsBinds,</span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-comment">-- see Note [Return non-recursive bindings in dependency order] in</span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-comment">-- GHC.HsToCore.Binds</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Helper function. You can use the result of 'mk_binds' with 'mkLets' for</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span class="hs-comment">--   * @'mk_binds' 'Recursive' binds@ makes a single mutually-recursive</span><span>
</span><span id="line-201"></span><span class="hs-comment">--     bindings with all the rhs/lhs pairs in @binds@</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   * @'mk_binds' 'NonRecursive' binds@ makes one non-recursive binding</span><span>
</span><span id="line-203"></span><span class="hs-comment">--     for each rhs/lhs pairs in @binds@</span><span>
</span><span id="line-204"></span><span id="local-6989586621683140828"><span class="annot"><a href="GHC.HsToCore.Expr.html#mk_binds"><span class="hs-identifier hs-type">mk_binds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683140828"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683140828"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683140828"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-205"></span><span id="mk_binds"><span class="annot"><span class="annottext">mk_binds :: forall b. RecFlag -&gt; [(b, Expr b)] -&gt; [Bind b]
</span><a href="GHC.HsToCore.Expr.html#mk_binds"><span class="hs-identifier hs-var hs-var">mk_binds</span></a></span></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="GHC.Types.Basic.html#Recursive"><span class="hs-identifier hs-var">Recursive</span></a></span><span> </span><span id="local-6989586621683141610"><span class="annot"><span class="annottext">[(b, Expr b)]
</span><a href="#local-6989586621683141610"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(b, Expr b)] -&gt; Bind b
forall b. [(b, Expr b)] -&gt; Bind b
</span><a href="GHC.Core.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, Expr b)]
</span><a href="#local-6989586621683141610"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#mk_binds"><span class="hs-identifier hs-var">mk_binds</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="GHC.Types.Basic.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a></span><span> </span><span id="local-6989586621683141612"><span class="annot"><span class="annottext">[(b, Expr b)]
</span><a href="#local-6989586621683141612"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b, Expr b) -&gt; Bind b) -&gt; [(b, Expr b)] -&gt; [Bind b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Expr b -&gt; Bind b) -&gt; (b, Expr b) -&gt; Bind b
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Expr b -&gt; Bind b
forall b. b -&gt; Expr b -&gt; Bind b
</span><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(b, Expr b)]
</span><a href="#local-6989586621683141612"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-209"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-type">dsUnliftedBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#HsBind"><span class="hs-identifier hs-type">HsBind</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-210"></span><span id="dsUnliftedBind"><span class="annot"><span class="annottext">dsUnliftedBind :: HsBind GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var hs-var">dsUnliftedBind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#XHsBindsLR"><span class="hs-identifier hs-type">XHsBindsLR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Binds.html#AbsBinds"><span class="hs-identifier hs-type">AbsBinds</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">abs_tvs :: AbsBinds -&gt; [Id]
</span><a href="GHC.Hs.Binds.html#abs_tvs"><span class="hs-identifier hs-var">abs_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abs_ev_vars :: AbsBinds -&gt; [Id]
</span><a href="GHC.Hs.Binds.html#abs_ev_vars"><span class="hs-identifier hs-var">abs_ev_vars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abs_exports :: AbsBinds -&gt; [ABExport]
</span><a href="GHC.Hs.Binds.html#abs_exports"><span class="hs-identifier hs-var">abs_exports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141615"><span class="annot"><span class="annottext">[ABExport]
</span><a href="#local-6989586621683141615"><span class="hs-identifier hs-var">exports</span></a></span></span><span>
</span><span id="line-212"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abs_ev_binds :: AbsBinds -&gt; [TcEvBinds]
</span><a href="GHC.Hs.Binds.html#abs_ev_binds"><span class="hs-identifier hs-var">abs_ev_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141617"><span class="annot"><span class="annottext">[TcEvBinds]
</span><a href="#local-6989586621683141617"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span>
</span><span id="line-213"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abs_binds :: AbsBinds -&gt; LHsBinds GhcTc
</span><a href="GHC.Hs.Binds.html#abs_binds"><span class="hs-identifier hs-var">abs_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141619"><span class="annot"><span class="annottext">LHsBinds GhcTc
</span><a href="#local-6989586621683141619"><span class="hs-identifier hs-var">lbinds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141620"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141620"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141621"><span class="annot"><span class="annottext">body1 :: CoreExpr
</span><a href="#local-6989586621683141621"><span class="hs-identifier hs-var hs-var hs-var">body1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ABExport -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreExpr -&gt; [ABExport] -&gt; CoreExpr
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">ABExport -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683141622"><span class="hs-identifier hs-var">bind_export</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141620"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[ABExport]
</span><a href="#local-6989586621683141615"><span class="hs-identifier hs-var">exports</span></a></span><span>
</span><span id="line-215"></span><span>             </span><span id="local-6989586621683141622"><span class="annot"><span class="annottext">bind_export :: ABExport -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683141622"><span class="hs-identifier hs-var hs-var hs-var">bind_export</span></a></span></span><span> </span><span id="local-6989586621683141624"><span class="annot"><span class="annottext">ABExport
</span><a href="#local-6989586621683141624"><span class="hs-keyword hs-var">export</span></a></span></span><span> </span><span id="local-6989586621683141625"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141625"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ABExport -&gt; Id
</span><a href="GHC.Hs.Binds.html#abe_poly"><span class="hs-identifier hs-var">abe_poly</span></a></span><span> </span><span class="annot"><span class="annottext">ABExport
</span><a href="#local-6989586621683141624"><span class="hs-keyword hs-var">export</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ABExport -&gt; Id
</span><a href="GHC.Hs.Binds.html#abe_mono"><span class="hs-identifier hs-var">abe_mono</span></a></span><span> </span><span class="annot"><span class="annottext">ABExport
</span><a href="#local-6989586621683141624"><span class="hs-keyword hs-var">export</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141625"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-216"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141630"><span class="annot"><a href="#local-6989586621683141630"><span class="hs-identifier hs-var">body2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; GenLocated SrcSpanAnnA (HsBind GhcTc) -&gt; DsM CoreExpr)
-&gt; CoreExpr
-&gt; [GenLocated SrcSpanAnnA (HsBind GhcTc)]
-&gt; DsM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldlM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621683141632"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141632"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621683141633"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsBind GhcTc)
</span><a href="#local-6989586621683141633"><span class="hs-identifier hs-var">lbind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; CoreExpr -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var">dsUnliftedBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsBind GhcTc) -&gt; HsBind GhcTc
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsBind GhcTc)
</span><a href="#local-6989586621683141633"><span class="hs-identifier hs-var">lbind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141632"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                            </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141621"><span class="hs-identifier hs-var">body1</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcTc
[GenLocated SrcSpanAnnA (HsBind GhcTc)]
</span><a href="#local-6989586621683141619"><span class="hs-identifier hs-var">lbinds</span></a></span><span>
</span><span id="line-218"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Binds.html#dsTcEvBinds_s"><span class="hs-identifier hs-type">dsTcEvBinds_s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141617"><span class="hs-identifier hs-type">ev_binds</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683141635"><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621683141635"><span class="hs-identifier hs-var">ds_binds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreBind] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLets"><span class="hs-identifier hs-var">mkCoreLets</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreBind]
</span><a href="#local-6989586621683141635"><span class="hs-identifier hs-var">ds_binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141630"><span class="hs-identifier hs-var">body2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var">dsUnliftedBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141638"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683141638"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683141639"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141639"><span class="hs-identifier hs-var">fun</span></a></span></span><span>
</span><span id="line-222"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141641"><span class="annot"><span class="annottext">MatchGroup GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141641"><span class="hs-identifier hs-var">matches</span></a></span></span><span>
</span><span id="line-223"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_ext :: forall idL idR. HsBindLR idL idR -&gt; XFunBind idL idR
</span><a href="Language.Haskell.Syntax.Binds.html#fun_ext"><span class="hs-identifier hs-var">fun_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141643"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683141643"><span class="hs-identifier hs-var">co_fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141644"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621683141644"><span class="hs-identifier hs-var">tick</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                        </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141645"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141645"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-225"></span><span>               </span><span class="hs-comment">-- Can't be a bang pattern (that looks like a PatBind)</span><span>
</span><span id="line-226"></span><span>               </span><span class="hs-comment">-- so must be simply unboxed</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141646"><span class="annot"><a href="#local-6989586621683141646"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141647"><span class="annot"><a href="#local-6989586621683141647"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
-&gt; Maybe [LHsExpr GhcTc]
-&gt; MatchGroup GhcTc (LHsExpr GhcTc)
-&gt; DsM ([Id], CoreExpr)
</span><a href="GHC.HsToCore.Match.html#matchWrapper"><span class="hs-identifier hs-var">matchWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
-&gt; AnnFunRhs -&gt; HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. fn -&gt; AnnFunRhs -&gt; HsMatchContext fn
</span><a href="GHC.Hs.Utils.html#mkPrefixFunRhs"><span class="hs-identifier hs-var">mkPrefixFunRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnN -&gt; Name -&gt; GenLocated SrcSpanAnnN Name
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621683141638"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; GenLocated SrcSpanAnnN Name)
-&gt; Name -&gt; GenLocated SrcSpanAnnN Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141639"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnFunRhs
forall a. NoAnn a =&gt; a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [LHsExpr GhcTc]
Maybe [LocatedA (HsExpr GhcTc)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141641"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-228"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683141646"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Functions aren't unlifted</span><span>
</span><span id="line-229"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Binds.html#dsHsWrapper"><span class="hs-identifier hs-type">dsHsWrapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141643"><span class="hs-identifier hs-type">co_fn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683141653"><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683141653"><span class="hs-identifier hs-var">core_wrap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Can be non-identity (#21516)</span><span>
</span><span id="line-230"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141654"><span class="annot"><span class="annottext">rhs' :: CoreExpr
</span><a href="#local-6989586621683141654"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683141653"><span class="hs-identifier hs-var">core_wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.HsToCore.Utils.html#mkOptTickBox"><span class="hs-identifier hs-var">mkOptTickBox</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621683141644"><span class="hs-identifier hs-var">tick</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141647"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
Id -&gt; CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-var">bindNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141639"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141654"><span class="hs-identifier hs-var">rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141645"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var">dsUnliftedBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PatBind"><span class="hs-identifier hs-type">PatBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pat_lhs :: forall idL idR. HsBindLR idL idR -&gt; LPat idL
</span><a href="Language.Haskell.Syntax.Binds.html#pat_lhs"><span class="hs-identifier hs-var">pat_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141655"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141655"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pat_rhs :: forall idL idR. HsBindLR idL idR -&gt; GRHSs idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#pat_rhs"><span class="hs-identifier hs-var">pat_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141656"><span class="annot"><span class="annottext">GRHSs GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141656"><span class="hs-identifier hs-var">grhss</span></a></span></span><span>
</span><span id="line-234"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pat_ext :: forall idL idR. HsBindLR idL idR -&gt; XPatBind idL idR
</span><a href="Language.Haskell.Syntax.Binds.html#pat_ext"><span class="hs-identifier hs-var">pat_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141657"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141657"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([CoreTickish], [[CoreTickish]])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141658"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141658"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- let C x# y# = rhs in body</span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-comment">-- ==&gt; case rhs of C x# y# -&gt; body</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141659"><span class="annot"><a href="#local-6989586621683141659"><span class="hs-identifier hs-var">match_nablas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
-&gt; GRHSs GhcTc (LHsExpr GhcTc) -&gt; DsM (NonEmpty Nablas)
</span><a href="GHC.HsToCore.Pmc.html#pmcGRHSs"><span class="hs-identifier hs-var">pmcGRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. HsMatchContext fn
</span><a href="Language.Haskell.Syntax.Expr.html#PatBindGuards"><span class="hs-identifier hs-var">PatBindGuards</span></a></span><span> </span><span class="annot"><span class="annottext">GRHSs GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141656"><span class="hs-identifier hs-var">grhss</span></a></span><span>
</span><span id="line-238"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141660"><span class="annot"><a href="#local-6989586621683141660"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.GuardedRHSs.html#dsGuarded"><span class="hs-identifier hs-type">dsGuarded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141656"><span class="hs-identifier hs-type">grhss</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141657"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141659"><span class="hs-identifier hs-type">match_nablas</span></a></span><span>
</span><span id="line-239"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141661"><span class="annot"><a href="#local-6989586621683141661"><span class="hs-identifier hs-var hs-var">eqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EqnMatch"><span class="hs-identifier hs-type">EqnMatch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eqn_pat :: LPat GhcTc
</span><a href="GHC.HsToCore.Monad.html#eqn_pat"><span class="hs-identifier hs-var">eqn_pat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141655"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eqn_rest :: EquationInfo
</span><a href="GHC.HsToCore.Monad.html#eqn_rest"><span class="hs-identifier hs-var">eqn_rest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchResult CoreExpr -&gt; EquationInfo
</span><a href="GHC.HsToCore.Monad.html#EqnDone"><span class="hs-identifier hs-var">EqnDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; MatchResult CoreExpr
</span><a href="GHC.HsToCore.Utils.html#cantFailMatchResult"><span class="hs-identifier hs-var">cantFailMatchResult</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141658"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141667"><span class="annot"><a href="#local-6989586621683141667"><span class="hs-identifier hs-var">var</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#selectMatchVar"><span class="hs-identifier hs-type">selectMatchVar</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-type">ManyTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141655"><span class="hs-identifier hs-type">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                    </span><span class="hs-comment">-- `var` will end up in a let binder, so the multiplicity</span><span>
</span><span id="line-242"></span><span>                    </span><span class="hs-comment">-- doesn't matter.</span><span>
</span><span id="line-243"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141670"><span class="annot"><a href="#local-6989586621683141670"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#matchEquations"><span class="hs-identifier hs-type">matchEquations</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#PatBindRhs"><span class="hs-identifier hs-type">PatBindRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683141667"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683141661"><span class="hs-identifier hs-type">eqn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-type">exprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141658"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-type">bindNonRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141667"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141660"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141670"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsUnliftedBind"><span class="hs-identifier hs-var">dsUnliftedBind</span></a></span><span> </span><span id="local-6989586621683141672"><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141672"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621683141673"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141673"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsLet: unlifted&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsBind GhcTc -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsBind GhcTc
</span><a href="#local-6989586621683141672"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141673"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
*              Variables, constructors, literals                       *
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><span class="hs-comment">-- | Desugar a located typechecked expression.</span></span><span>
</span><span id="line-257"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-258"></span><span id="dsLExpr"><span class="annot"><span class="annottext">dsLExpr :: LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var hs-var">dsLExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141675"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141675"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683141676"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141676"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall ann a. EpAnn ann -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDsA"><span class="hs-identifier hs-var">putSrcSpanDsA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141675"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141676"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">-- | Desugar a typechecked expression.</span></span><span>
</span><span id="line-261"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-type">dsExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-262"></span><span id="dsExpr"><span class="annot"><span class="annottext">dsExpr :: HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var hs-var">dsExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span>    </span><span class="annot"><span class="annottext">XVar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141679"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141679"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsVar"><span class="hs-identifier hs-var">dsHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141679"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUnboundVar"><span class="hs-identifier hs-type">HsUnboundVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HER"><span class="hs-identifier hs-type">HER</span></a></span><span> </span><span id="local-6989586621683141683"><span class="annot"><span class="annottext">IORef EvTerm
</span><a href="#local-6989586621683141683"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EvTerm -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Binds.html#dsEvTerm"><span class="hs-identifier hs-var">dsEvTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(EvTerm -&gt; DsM CoreExpr)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) EvTerm -&gt; DsM CoreExpr
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IORef EvTerm -&gt; IOEnv (Env DsGblEnv DsLclEnv) EvTerm
forall a env. IORef a -&gt; IOEnv env a
</span><a href="GHC.Data.IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a></span><span> </span><span class="annot"><span class="annottext">IORef EvTerm
</span><a href="#local-6989586621683141683"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-comment">-- See Note [Holes] in GHC.Tc.Types.Constraint</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141688"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141688"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141688"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-269"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141690"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141690"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141690"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsIPVar"><span class="hs-identifier hs-type">HsIPVar</span></a></span><span> </span><span id="local-6989586621683141692"><span class="annot"><span class="annottext">XIPVar GhcTc
</span><a href="#local-6989586621683141692"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsIPName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XIPVar GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141692"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsGetField"><span class="hs-identifier hs-type">HsGetField</span></a></span><span> </span><span id="local-6989586621683141695"><span class="annot"><span class="annottext">XGetField GhcTc
</span><a href="#local-6989586621683141695"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XRec GhcTc (DotFieldOcc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XGetField GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141695"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-274"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsProjection"><span class="hs-identifier hs-type">HsProjection</span></a></span><span> </span><span id="local-6989586621683141697"><span class="annot"><span class="annottext">XProjection GhcTc
</span><a href="#local-6989586621683141697"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (DotFieldOcc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XProjection GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141697"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141699"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683141699"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLit"><span class="hs-identifier hs-var">warnAboutOverflowedLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683141699"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-278"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsLit GhcRn -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsLit"><span class="hs-identifier hs-var">dsLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; HsLit GhcRn
forall (p1 :: Pass) (p2 :: Pass).
HsLit (GhcPass p1) -&gt; HsLit (GhcPass p2)
</span><a href="GHC.Hs.Lit.html#convertLit"><span class="hs-identifier hs-var">convertLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683141699"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141703"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683141703"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedOverLit"><span class="hs-identifier hs-var">warnAboutOverflowedOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683141703"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-282"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-var">dsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683141703"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span id="local-6989586621683141706"><span class="annot"><span class="annottext">e :: HsExpr GhcTc
</span><a href="#local-6989586621683141706"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span id="local-6989586621683141708"><span class="annot"><span class="annottext">XXExpr GhcTc
</span><a href="#local-6989586621683141708"><span class="hs-identifier hs-var">ext_expr_tc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XXExpr GhcTc
</span><a href="#local-6989586621683141708"><span class="hs-identifier hs-var">ext_expr_tc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#ExpandedThingTc"><span class="hs-identifier hs-type">ExpandedThingTc</span></a></span><span> </span><span id="local-6989586621683141710"><span class="annot"><span class="annottext">HsThingRn
</span><a href="#local-6989586621683141710"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621683141711"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141711"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#OrigStmt"><span class="hs-identifier hs-type">OrigStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141713"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141713"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcRn GhcRn (GenLocated SrcSpanAnnA (HsExpr GhcRn))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsThingRn
</span><a href="#local-6989586621683141710"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall ann a. EpAnn ann -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDsA"><span class="hs-identifier hs-var">putSrcSpanDsA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141713"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141711"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141711"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#WrapExpr"><span class="hs-identifier hs-type">WrapExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsWrapped"><span class="hs-identifier hs-var">dsHsWrapped</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141706"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#ConLikeTc"><span class="hs-identifier hs-type">ConLikeTc</span></a></span><span> </span><span id="local-6989586621683141717"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683141717"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683141718"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141718"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621683141719"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621683141719"><span class="hs-identifier hs-var">tys</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; [Id] -&gt; [Scaled Type] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsConLike"><span class="hs-identifier hs-var">dsConLike</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683141717"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141718"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621683141719"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-comment">-- Hpc Support</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#HsTick"><span class="hs-identifier hs-type">HsTick</span></a></span><span> </span><span id="local-6989586621683141722"><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621683141722"><span class="hs-identifier hs-var">tickish</span></a></span></span><span> </span><span id="local-6989586621683141723"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141723"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>        </span><span id="local-6989586621683141724"><span class="annot"><a href="#local-6989586621683141724"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141723"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141722"><span class="hs-identifier hs-type">tickish</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141724"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-comment">-- There is a problem here. The then and else branches</span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-comment">-- have no free variables, so they are open to lifting.</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-comment">-- We need someway of stopping this.</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-comment">-- This will make no difference to binary coverage</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-comment">-- (did you go here: YES or NO), but will effect accurate</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-comment">-- tick counting.</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><a href="GHC.Hs.Expr.html#HsBinTick"><span class="hs-identifier hs-type">HsBinTick</span></a></span><span> </span><span id="local-6989586621683141727"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141727"><span class="hs-identifier hs-var">ixT</span></a></span></span><span> </span><span id="local-6989586621683141728"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141728"><span class="hs-identifier hs-var">ixF</span></a></span></span><span> </span><span id="local-6989586621683141729"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141729"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621683141730"><span class="annot"><a href="#local-6989586621683141730"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141729"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-type">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-type">exprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141730"><span class="hs-identifier hs-type">e2</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-type">`eqType`</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#boolTy"><span class="hs-identifier hs-type">boolTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkBinaryTickBox"><span class="hs-identifier hs-type">mkBinaryTickBox</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141727"><span class="hs-identifier hs-type">ixT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141728"><span class="hs-identifier hs-type">ixF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141730"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-comment">{- Record selectors are warned about if they are not
        present in all of the parent data type's constructor,
        or always in case of pattern synonym record selectors
        (regulated by a flag). However, this only produces
        a warning if it's not a part of a record selector
        application. For example:

                data T = T1 | T2 {s :: Bool}
                f x = s x -- the warning from this case will be supressed

        See the `HsApp` case for where it is filtered out
        -}</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsRecSelTc"><span class="hs-identifier hs-type">HsRecSelTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a></span><span> </span><span class="annot"><span class="annottext">XCFieldOcc GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141736"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141736"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span>  </span><span id="local-6989586621683141737"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621683141737"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141736"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-323"></span><span>                  </span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelId"><span class="hs-identifier hs-type">RecSelId</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sel_cons :: IdDetails -&gt; ([ConLike], [ConLike])
</span><a href="GHC.Types.Id.Info.html#sel_cons"><span class="hs-identifier hs-var">sel_cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ConLike]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141741"><span class="annot"><span class="annottext">[ConLike]
</span><a href="#local-6989586621683141741"><span class="hs-identifier hs-var hs-var">cons_wo_field</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; IdDetails
</span><a href="GHC.Types.Var.html#idDetails"><span class="hs-identifier hs-var">idDetails</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141736"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141743"><span class="annot"><a href="#local-6989586621683141743"><span class="hs-identifier hs-var">cons_trimmed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ConLike] -&gt; DsM [ConLike]
</span><a href="#local-6989586621683141744"><span class="hs-identifier hs-var">trim_cons</span></a></span><span> </span><span class="annot"><span class="annottext">[ConLike]
</span><a href="#local-6989586621683141741"><span class="hs-identifier hs-var">cons_wo_field</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683141741"><span class="hs-identifier hs-type">cons_wo_field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-type">diagnosticDs</span></a></span><span>
</span><span id="line-326"></span><span>                  </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html#DsIncompleteRecordSelector"><span class="hs-identifier hs-type">DsIncompleteRecordSelector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141737"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141743"><span class="hs-identifier hs-type">cons_trimmed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683141743"><span class="hs-identifier hs-type">cons_trimmed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="#local-6989586621683141741"><span class="hs-identifier hs-type">cons_wo_field</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>                      </span><span class="hs-comment">-- This only produces a warning if it's not a part of a</span><span>
</span><span id="line-328"></span><span>                      </span><span class="hs-comment">-- record selector application (e.g. `s a` where `s` is a selector)</span><span>
</span><span id="line-329"></span><span>                      </span><span class="hs-comment">-- See the `HsApp` case for where it is filtered out</span><span>
</span><span id="line-330"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsHsVar"><span class="hs-identifier hs-type">dsHsVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141736"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-331"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><a href="#local-6989586621683141744"><span class="hs-identifier hs-type">trim_cons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>            </span><span id="local-6989586621683141744"><span class="annot"><span class="annottext">trim_cons :: [ConLike] -&gt; DsM [ConLike]
</span><a href="#local-6989586621683141744"><span class="hs-identifier hs-var hs-var">trim_cons</span></a></span></span><span> </span><span id="local-6989586621683141748"><span class="annot"><span class="annottext">[ConLike]
</span><a href="#local-6989586621683141748"><span class="hs-identifier hs-var">cons_wo_field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>              </span><span id="local-6989586621683141749"><span class="annot"><a href="#local-6989586621683141749"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-335"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141750"><span class="annot"><a href="#local-6989586621683141750"><span class="hs-identifier hs-var hs-var">maxConstructors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Int
</span><a href="GHC.Driver.DynFlags.html#maxUncoveredPatterns"><span class="hs-identifier hs-var">maxUncoveredPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683141749"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-336"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">take</span></span><span> </span><span class="annot"><a href="#local-6989586621683141750"><span class="hs-identifier hs-type">maxConstructors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141748"><span class="hs-identifier hs-type">cons_wo_field</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- Strip ticks due to #21701, need to be invariant about warnings we produce whether</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- this is enabled or not.</span><span>
</span><span id="line-341"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#NegApp"><span class="hs-identifier hs-type">NegApp</span></a></span><span> </span><span class="annot"><span class="annottext">XNegApp GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141754"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141754"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-342"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; ([CoreTickish], HsExpr GhcTc)
</span><a href="GHC.HsToCore.Ticks.html#stripTicksTopHsExpr"><span class="hs-identifier hs-var">stripTicksTopHsExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141755"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621683141755"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141756"><span class="annot"><span class="annottext">lit :: HsOverLit GhcTc
</span><a href="#local-6989586621683141756"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_val :: forall p. HsOverLit p -&gt; OverLitVal
</span><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntegral"><span class="hs-identifier hs-type">HsIntegral</span></a></span><span> </span><span id="local-6989586621683141760"><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683141760"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>              </span><span id="local-6989586621683141761"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683141761"><span class="hs-identifier hs-var">neg_expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141762"><span class="annot"><a href="#local-6989586621683141762"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall ann a. EpAnn ann -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDsA"><span class="hs-identifier hs-var">putSrcSpanDsA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141754"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedOverLit"><span class="hs-identifier hs-var">warnAboutOverflowedOverLit</span></a></span><span>
</span><span id="line-346"></span><span>                </span><span class="hs-comment">-- See Note [Checking &quot;negative literals&quot;]</span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683141756"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntegral"><span class="hs-identifier hs-type">HsIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SourceText.html#negateIntegralLit"><span class="hs-identifier hs-type">negateIntegralLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141760"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-var">dsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683141756"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-349"></span><span>       </span><span class="hs-special">;</span><span>
</span><span id="line-350"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141761"><span class="hs-identifier hs-type">neg_expr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-type">mkTicks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141755"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141762"><span class="hs-identifier hs-type">expr'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#NegApp"><span class="hs-identifier hs-type">NegApp</span></a></span><span> </span><span class="annot"><span class="annottext">XNegApp GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141765"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141765"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621683141766"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683141766"><span class="hs-identifier hs-var">neg_expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141767"><span class="annot"><a href="#local-6989586621683141767"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141765"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-354"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141766"><span class="hs-identifier hs-type">neg_expr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683141767"><span class="hs-identifier hs-type">expr'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsLam"><span class="hs-identifier hs-type">HsLam</span></a></span><span> </span><span class="annot"><span class="annottext">XLam GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141769"><span class="annot"><span class="annottext">HsLamVariant
</span><a href="#local-6989586621683141769"><span class="hs-identifier hs-var">variant</span></a></span></span><span> </span><span id="local-6989586621683141770"><span class="annot"><span class="annottext">MatchGroup GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141770"><span class="hs-identifier hs-var">a_Match</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Id] -&gt; CoreExpr -&gt; CoreExpr) -&gt; ([Id], CoreExpr) -&gt; CoreExpr
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreLams"><span class="hs-identifier hs-var">mkCoreLams</span></a></span><span> </span><span class="annot"><span class="annottext">(([Id], CoreExpr) -&gt; CoreExpr)
-&gt; DsM ([Id], CoreExpr) -&gt; DsM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
-&gt; Maybe [LHsExpr GhcTc]
-&gt; MatchGroup GhcTc (LHsExpr GhcTc)
-&gt; DsM ([Id], CoreExpr)
</span><a href="GHC.HsToCore.Match.html#matchWrapper"><span class="hs-identifier hs-var">matchWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLamVariant -&gt; HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. HsLamVariant -&gt; HsMatchContext fn
</span><a href="Language.Haskell.Syntax.Expr.html#LamAlt"><span class="hs-identifier hs-var">LamAlt</span></a></span><span> </span><span class="annot"><span class="annottext">HsLamVariant
</span><a href="#local-6989586621683141769"><span class="hs-identifier hs-var">variant</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [LHsExpr GhcTc]
Maybe [LocatedA (HsExpr GhcTc)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141770"><span class="hs-identifier hs-var">a_Match</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span id="local-6989586621683141774"><span class="annot"><span class="annottext">e :: HsExpr GhcTc
</span><a href="#local-6989586621683141774"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141776"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141776"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621683141777"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141777"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>         </span><span class="hs-comment">-- We want to have a special case that uses the PMC information to filter</span><span>
</span><span id="line-361"></span><span>         </span><span class="hs-comment">-- out some of the incomplete record selectors warnings and not trigger</span><span>
</span><span id="line-362"></span><span>         </span><span class="hs-comment">-- the warning emitted during the desugaring of dsExpr(HsRecSel)</span><span>
</span><span id="line-363"></span><span>         </span><span class="hs-comment">-- See Note [Detecting incomplete record selectors] in GHC.HsToCore.Pmc</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141778"><span class="annot"><a href="#local-6989586621683141778"><span class="hs-identifier hs-var">msgs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141779"><span class="annot"><a href="#local-6989586621683141779"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DsM CoreExpr -&gt; DsM (Messages DsMessage, CoreExpr)
forall a. DsM a -&gt; DsM (Messages DsMessage, a)
</span><a href="GHC.HsToCore.Monad.html#captureMessagesDs"><span class="hs-identifier hs-var">captureMessagesDs</span></a></span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM (Messages DsMessage, CoreExpr))
-&gt; DsM CoreExpr -&gt; DsM (Messages DsMessage, CoreExpr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141776"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-365"></span><span>             </span><span class="hs-comment">-- Make sure to filter out the generic incomplete record selector warning</span><span>
</span><span id="line-366"></span><span>             </span><span class="hs-comment">-- if it's a raw record selector</span><span>
</span><span id="line-367"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141781"><span class="annot"><a href="#local-6989586621683141781"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141777"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-368"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#getIdFromTrivialExpr_maybe"><span class="hs-identifier hs-type">getIdFromTrivialExpr_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141779"><span class="hs-identifier hs-type">fun'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683141783"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141783"><span class="hs-identifier hs-var">fun_id</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isRecordSelector"><span class="hs-identifier hs-var">isRecordSelector</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141783"><span class="hs-identifier hs-var">fun_id</span></a></span><span>
</span><span id="line-370"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141785"><span class="annot"><span class="annottext">msgs' :: Messages DsMessage
</span><a href="#local-6989586621683141785"><span class="hs-identifier hs-var hs-var hs-var">msgs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MsgEnvelope DsMessage -&gt; Bool)
-&gt; Messages DsMessage -&gt; Messages DsMessage
forall e. (MsgEnvelope e -&gt; Bool) -&gt; Messages e -&gt; Messages e
</span><a href="GHC.Types.Error.html#filterMessages"><span class="hs-identifier hs-var">filterMessages</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DsMessage -&gt; Bool
</span><a href="#local-6989586621683141787"><span class="hs-identifier hs-var">is_incomplete_rec_sel_msg</span></a></span><span> </span><span class="annot"><span class="annottext">Messages DsMessage
</span><a href="#local-6989586621683141778"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-371"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Messages DsMessage -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Monad.html#addMessagesDs"><span class="hs-identifier hs-var">addMessagesDs</span></a></span><span> </span><span class="annot"><span class="annottext">Messages DsMessage
</span><a href="#local-6989586621683141785"><span class="hs-identifier hs-var">msgs'</span></a></span><span>
</span><span id="line-372"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Pmc.html#pmcRecSel"><span class="hs-identifier hs-var">pmcRecSel</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683141783"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683141781"><span class="hs-identifier hs-var">arg'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-373"></span><span>           </span><span class="annot"><span class="annottext">Maybe Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Messages DsMessage -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Monad.html#addMessagesDs"><span class="hs-identifier hs-var">addMessagesDs</span></a></span><span> </span><span class="annot"><span class="annottext">Messages DsMessage
</span><a href="#local-6989586621683141778"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-374"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#warnUnusedBindValue"><span class="hs-identifier hs-type">warnUnusedBindValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141776"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141777"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-type">exprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141781"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkCoreAppDs"><span class="hs-identifier hs-type">mkCoreAppDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;HsApp&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141774"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141779"><span class="hs-identifier hs-type">fun'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141781"><span class="hs-identifier hs-type">arg'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621683141787"><span class="hs-identifier hs-type">is_incomplete_rec_sel_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html#DsMessage"><span class="hs-identifier hs-type">DsMessage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621683141787"><span class="annot"><span class="annottext">is_incomplete_rec_sel_msg :: MsgEnvelope DsMessage -&gt; Bool
</span><a href="#local-6989586621683141787"><span class="hs-identifier hs-var hs-var">is_incomplete_rec_sel_msg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errMsgDiagnostic :: forall e. MsgEnvelope e -&gt; e
</span><a href="GHC.Types.Error.html#errMsgDiagnostic"><span class="hs-identifier hs-var">errMsgDiagnostic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html#DsIncompleteRecordSelector"><span class="hs-identifier hs-type">DsIncompleteRecordSelector</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="#local-6989586621683141787"><span class="hs-identifier hs-var">is_incomplete_rec_sel_msg</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DsMessage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span id="local-6989586621683141796"><span class="annot"><span class="annottext">e :: HsExpr GhcTc
</span><a href="#local-6989586621683141796"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsWrapped"><span class="hs-identifier hs-var">dsHsWrapped</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683141796"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">{-
Note [Checking &quot;negative literals&quot;]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

As observed in #13257 it's desirable to warn about overflowing negative literals
in some situations where the user thinks they are writing a negative literal (ie -1)
but without `-XNegativeLiterals` enabled.

This catches cases such as (-1 :: Word8) which overflow, because (negate 1 == 255) but
which we desugar to `negate (fromIntegral 1)`.

Notice it's crucial we still desugar to the correct (negate (fromIntegral ...)) despite
performing the negation in order to check whether the application of negate will overflow.
For a user written Integer instance we can't predict the interaction of negate and fromIntegral.

Also note that this works for detecting the right result for `-128 :: Int8`.. which is
in-range for Int8 but the correct result is achieved via two overflows.

negate (fromIntegral 128 :: Int8)
= negate (-128 :: Int8)
= -128 :: Int8

Note [Desugaring vars]
~~~~~~~~~~~~~~~~~~~~~~
In one situation we can get a *coercion* variable in a HsVar, namely
the support method for an equality superclass:
   class (a~b) =&gt; C a b where ...
   instance (blah) =&gt; C (T a) (T b) where ..
Then we get
   $dfCT :: forall ab. blah =&gt; C (T a) (T b)
   $dfCT ab blah = MkC ($c$p1C a blah) ($cop a blah)

   $c$p1C :: forall ab. blah =&gt; (T a ~ T b)
   $c$p1C ab blah = let ...; g :: T a ~ T b = ... } in g

That 'g' in the 'in' part is an evidence variable, and when
converting to core it must become a CO.
-}</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExplicitTuple"><span class="hs-identifier hs-type">ExplicitTuple</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitTuple GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141799"><span class="annot"><span class="annottext">[HsTupArg GhcTc]
</span><a href="#local-6989586621683141799"><span class="hs-identifier hs-var">tup_args</span></a></span></span><span> </span><span id="local-6989586621683141800"><span class="annot"><span class="annottext">Boxity
</span><a href="#local-6989586621683141800"><span class="hs-identifier hs-var">boxity</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141805"><span class="annot"><span class="annottext">go :: ([Id], [CoreExpr])
-&gt; HsTupArg GhcTc
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ([Id], [CoreExpr])
</span><a href="#local-6989586621683141805"><span class="hs-identifier hs-var hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141806"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141806"><span class="hs-identifier hs-var">lam_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141807"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621683141807"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#Missing"><span class="hs-identifier hs-type">Missing</span></a></span><span> </span><span id="local-6989586621683141809"><span class="annot"><span class="annottext">XMissing GhcTc
</span><a href="#local-6989586621683141809"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>                    </span><span class="hs-comment">-- For every missing expression, we need</span><span>
</span><span id="line-427"></span><span>                    </span><span class="hs-comment">-- another lambda in the desugaring.</span><span>
</span><span id="line-428"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141810"><span class="annot"><a href="#local-6989586621683141810"><span class="hs-identifier hs-var">lam_var</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Scaled Type -&gt; DsM Id
</span><a href="GHC.HsToCore.Monad.html#newSysLocalDs"><span class="hs-identifier hs-var">newSysLocalDs</span></a></span><span> </span><span class="annot"><span class="annottext">XMissing GhcTc
Scaled Type
</span><a href="#local-6989586621683141809"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-429"></span><span>                    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683141810"><span class="hs-identifier hs-type">lam_var</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683141806"><span class="hs-identifier hs-type">lam_vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141810"><span class="hs-identifier hs-type">lam_var</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683141807"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-430"></span><span>             </span><span class="annot"><a href="#local-6989586621683141805"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141812"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683141812"><span class="hs-identifier hs-var">lam_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141813"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621683141813"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#Present"><span class="hs-identifier hs-type">Present</span></a></span><span> </span><span class="annot"><span class="annottext">XPresent GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141815"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141815"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>                    </span><span class="hs-comment">-- Expressions that are present don't generate</span><span>
</span><span id="line-432"></span><span>                    </span><span class="hs-comment">-- lambdas, just arguments.</span><span>
</span><span id="line-433"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141816"><span class="annot"><a href="#local-6989586621683141816"><span class="hs-identifier hs-var">core_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141815"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-434"></span><span>                    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683141812"><span class="hs-identifier hs-type">lam_vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683141816"><span class="hs-identifier hs-type">core_expr</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621683141813"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141817"><span class="annot"><a href="#local-6989586621683141817"><span class="hs-identifier hs-var">lam_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141818"><span class="annot"><a href="#local-6989586621683141818"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Id], [CoreExpr])
 -&gt; HsTupArg GhcTc
 -&gt; IOEnv (Env DsGblEnv DsLclEnv) ([Id], [CoreExpr]))
-&gt; ([Id], [CoreExpr])
-&gt; [HsTupArg GhcTc]
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ([Id], [CoreExpr])
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">([Id], [CoreExpr])
-&gt; HsTupArg GhcTc
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ([Id], [CoreExpr])
</span><a href="#local-6989586621683141805"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HsTupArg GhcTc] -&gt; [HsTupArg GhcTc]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[HsTupArg GhcTc]
</span><a href="#local-6989586621683141799"><span class="hs-identifier hs-var">tup_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>                </span><span class="hs-comment">-- The reverse is because foldM goes left-to-right</span><span>
</span><span id="line-438"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreLams"><span class="hs-identifier hs-type">mkCoreLams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141817"><span class="hs-identifier hs-type">lam_vars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreTupBoxity"><span class="hs-identifier hs-type">mkCoreTupBoxity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141800"><span class="hs-identifier hs-type">boxity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141818"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-439"></span><span>                        </span><span class="hs-comment">-- See Note [Don't flatten tuples from HsSyn] in GHC.Core.Make</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExplicitSum"><span class="hs-identifier hs-type">ExplicitSum</span></a></span><span> </span><span id="local-6989586621683141823"><span class="annot"><span class="annottext">XExplicitSum GhcTc
</span><a href="#local-6989586621683141823"><span class="hs-identifier hs-var">types</span></a></span></span><span> </span><span id="local-6989586621683141824"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141824"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621683141825"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141825"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621683141826"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141826"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-var">mkCoreUnboxedSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141825"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141824"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
XExplicitSum GhcTc
</span><a href="#local-6989586621683141823"><span class="hs-identifier hs-var">types</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141826"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141829"><span class="annot"><span class="annottext">HsPragE GhcTc
</span><a href="#local-6989586621683141829"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span id="local-6989586621683141830"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141830"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="annottext">HsPragE GhcTc -&gt; LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#ds_prag_expr"><span class="hs-identifier hs-var">ds_prag_expr</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE GhcTc
</span><a href="#local-6989586621683141829"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141830"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsEmbTy"><span class="hs-identifier hs-type">HsEmbTy</span></a></span><span> </span><span id="local-6989586621683141833"><span class="annot"><span class="annottext">XEmbTy GhcTc
</span><a href="#local-6989586621683141833"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XEmbTy GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141833"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-448"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsQual"><span class="hs-identifier hs-type">HsQual</span></a></span><span> </span><span id="local-6989586621683141835"><span class="annot"><span class="annottext">XQual GhcTc
</span><a href="#local-6989586621683141835"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">XRec GhcTc [LHsExpr GhcTc]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XQual GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141835"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-449"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsForAll"><span class="hs-identifier hs-type">HsForAll</span></a></span><span> </span><span id="local-6989586621683141837"><span class="annot"><span class="annottext">XForAll GhcTc
</span><a href="#local-6989586621683141837"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsForAllTelescope GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XForAll GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141837"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-450"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsFunArr"><span class="hs-identifier hs-type">HsFunArr</span></a></span><span> </span><span id="local-6989586621683141839"><span class="annot"><span class="annottext">XFunArr GhcTc
</span><a href="#local-6989586621683141839"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsArrowOf (LHsExpr GhcTc) GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XFunArr GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsCase"><span class="hs-identifier hs-type">HsCase</span></a></span><span> </span><span id="local-6989586621683141841"><span class="annot"><span class="annottext">XCase GhcTc
</span><a href="#local-6989586621683141841"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621683141842"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141842"><span class="hs-identifier hs-var">discrim</span></a></span></span><span> </span><span id="local-6989586621683141843"><span class="annot"><span class="annottext">MatchGroup GhcTc (LHsExpr GhcTc)
</span><a href="#local-6989586621683141843"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141844"><span class="annot"><a href="#local-6989586621683141844"><span class="hs-identifier hs-var">core_discrim</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141842"><span class="hs-identifier hs-var">discrim</span></a></span><span>
</span><span id="line-454"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621683141845"><span class="annot"><a href="#local-6989586621683141845"><span class="hs-identifier hs-var">discrim_var</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141846"><span class="annot"><a href="#local-6989586621683141846"><span class="hs-identifier hs-var">matching_code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#matchWrapper"><span class="hs-identifier hs-type">matchWrapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141841"><span class="hs-identifier hs-type">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683141842"><span class="hs-identifier hs-type">discrim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141843"><span class="hs-identifier hs-type">matches</span></a></span><span>
</span><span id="line-455"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#bindNonRec"><span class="hs-identifier hs-type">bindNonRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141845"><span class="hs-identifier hs-type">discrim_var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141844"><span class="hs-identifier hs-type">core_discrim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141846"><span class="hs-identifier hs-type">matching_code</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- Pepe: The binds are in scope in the body but NOT in the binding group</span><span>
</span><span id="line-458"></span><span class="hs-comment">--       This is to avoid silliness in breakpoints</span><span>
</span><span id="line-459"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsLet"><span class="hs-identifier hs-type">HsLet</span></a></span><span> </span><span class="annot"><span class="annottext">XLet GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141848"><span class="annot"><span class="annottext">HsLocalBinds GhcTc
</span><a href="#local-6989586621683141848"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621683141849"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141849"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621683141850"><span class="annot"><a href="#local-6989586621683141850"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141849"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-type">dsLocalBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141848"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141850"><span class="hs-identifier hs-type">body'</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- We need the `ListComp' form to use `deListComp' (rather than the &quot;do&quot; form)</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- because the interpretation of `stmts' depends on what sort of thing it is.</span><span>
</span><span id="line-465"></span><span class="hs-comment">--</span><span>
</span><span id="line-466"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span id="local-6989586621683141852"><span class="annot"><span class="annottext">XDo GhcTc
</span><a href="#local-6989586621683141852"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="Language.Haskell.Syntax.Expr.html#ListComp"><span class="hs-identifier hs-var">ListComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141854"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141854"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.ListComp.html#dsListComp"><span class="hs-identifier hs-var">dsListComp</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141854"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
Type
</span><a href="#local-6989586621683141852"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-467"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span id="local-6989586621683141856"><span class="annot"><span class="annottext">XDo GhcTc
</span><a href="#local-6989586621683141856"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621683141857"><span class="annot"><span class="annottext">ctx :: HsDoFlavour
</span><a href="#local-6989586621683141857"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#DoExpr"><span class="hs-identifier hs-type">DoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141859"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141859"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDoFlavour -&gt; [ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-var">dsDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683141857"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141859"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
Type
</span><a href="#local-6989586621683141856"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-468"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span id="local-6989586621683141861"><span class="annot"><span class="annottext">XDo GhcTc
</span><a href="#local-6989586621683141861"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621683141862"><span class="annot"><span class="annottext">ctx :: HsDoFlavour
</span><a href="#local-6989586621683141862"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="Language.Haskell.Syntax.Expr.html#GhciStmtCtxt"><span class="hs-identifier hs-var">GhciStmtCtxt</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141864"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141864"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDoFlavour -&gt; [ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-var">dsDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683141862"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141864"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
Type
</span><a href="#local-6989586621683141861"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-469"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span id="local-6989586621683141865"><span class="annot"><span class="annottext">XDo GhcTc
</span><a href="#local-6989586621683141865"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621683141866"><span class="annot"><span class="annottext">ctx :: HsDoFlavour
</span><a href="#local-6989586621683141866"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#MDoExpr"><span class="hs-identifier hs-type">MDoExpr</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141868"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141868"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDoFlavour -&gt; [ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-var">dsDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683141866"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141868"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
Type
</span><a href="#local-6989586621683141865"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-470"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="Language.Haskell.Syntax.Expr.html#MonadComp"><span class="hs-identifier hs-var">MonadComp</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141870"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141870"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.ListComp.html#dsMonadComp"><span class="hs-identifier hs-var">dsMonadComp</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141870"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsIf"><span class="hs-identifier hs-type">HsIf</span></a></span><span> </span><span class="annot"><span class="annottext">XIf GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141873"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141873"><span class="hs-identifier hs-var">guard_expr</span></a></span></span><span> </span><span id="local-6989586621683141874"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141874"><span class="hs-identifier hs-var">then_expr</span></a></span></span><span> </span><span id="local-6989586621683141875"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141875"><span class="hs-identifier hs-var">else_expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141876"><span class="annot"><a href="#local-6989586621683141876"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141873"><span class="hs-identifier hs-var">guard_expr</span></a></span><span>
</span><span id="line-474"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141877"><span class="annot"><a href="#local-6989586621683141877"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141874"><span class="hs-identifier hs-type">then_expr</span></a></span><span>
</span><span id="line-475"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141878"><span class="annot"><a href="#local-6989586621683141878"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141875"><span class="hs-identifier hs-type">else_expr</span></a></span><span>
</span><span id="line-476"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkIfThenElse"><span class="hs-identifier hs-type">mkIfThenElse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141876"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141877"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141878"><span class="hs-identifier hs-type">b2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsMultiIf"><span class="hs-identifier hs-type">HsMultiIf</span></a></span><span> </span><span id="local-6989586621683141881"><span class="annot"><span class="annottext">XMultiIf GhcTc
</span><a href="#local-6989586621683141881"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span id="local-6989586621683141882"><span class="annot"><span class="annottext">[LGRHS GhcTc (LHsExpr GhcTc)]
</span><a href="#local-6989586621683141882"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   (EpAnn NoEpAnns) (GRHS GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[LGRHS GhcTc (LHsExpr GhcTc)]
[GenLocated
   (EpAnn NoEpAnns) (GRHS GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683141882"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DsM CoreExpr
</span><a href="#local-6989586621683141883"><span class="hs-identifier hs-var">mkErrorExpr</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141884"><span class="annot"><span class="annottext">grhss :: GRHSs GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683141884"><span class="hs-identifier hs-var hs-var hs-var">grhss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XCGRHSs GhcTc (LocatedA (HsExpr GhcTc))
-&gt; [LGRHS GhcTc (LocatedA (HsExpr GhcTc))]
-&gt; HsLocalBinds GhcTc
-&gt; GRHSs GhcTc (LocatedA (HsExpr GhcTc))
forall p body.
XCGRHSs p body -&gt; [LGRHS p body] -&gt; HsLocalBinds p -&gt; GRHSs p body
</span><a href="Language.Haskell.Syntax.Expr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">XCGRHSs GhcTc (LocatedA (HsExpr GhcTc))
EpAnnComments
</span><a href="GHC.Parser.Annotation.html#emptyComments"><span class="hs-identifier hs-var">emptyComments</span></a></span><span>  </span><span class="annot"><span class="annottext">[LGRHS GhcTc (LHsExpr GhcTc)]
[LGRHS GhcTc (LocatedA (HsExpr GhcTc))]
</span><a href="#local-6989586621683141882"><span class="hs-identifier hs-var">alts</span></a></span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcTc
forall (a :: Pass) (b :: Pass).
HsLocalBindsLR (GhcPass a) (GhcPass b)
</span><a href="GHC.Hs.Binds.html#emptyLocalBinds"><span class="hs-identifier hs-var">emptyLocalBinds</span></a></span><span>
</span><span id="line-484"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141888"><span class="annot"><a href="#local-6989586621683141888"><span class="hs-identifier hs-var">rhss_nablas</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
-&gt; GRHSs GhcTc (LHsExpr GhcTc) -&gt; DsM (NonEmpty Nablas)
</span><a href="GHC.HsToCore.Pmc.html#pmcGRHSs"><span class="hs-identifier hs-var">pmcGRHSs</span></a></span><span> </span><span class="annot"><span class="annottext">HsMatchContextRn
HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. HsMatchContext fn
</span><a href="Language.Haskell.Syntax.Expr.html#IfAlt"><span class="hs-identifier hs-var">IfAlt</span></a></span><span> </span><span class="annot"><span class="annottext">GRHSs GhcTc (LHsExpr GhcTc)
GRHSs GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683141884"><span class="hs-identifier hs-var">grhss</span></a></span><span>
</span><span id="line-485"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141890"><span class="annot"><a href="#local-6989586621683141890"><span class="hs-identifier hs-var">match_result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.GuardedRHSs.html#dsGRHSs"><span class="hs-identifier hs-type">dsGRHSs</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#IfAlt"><span class="hs-identifier hs-type">IfAlt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141884"><span class="hs-identifier hs-type">grhss</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141881"><span class="hs-identifier hs-type">res_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141888"><span class="hs-identifier hs-type">rhss_nablas</span></a></span><span>
</span><span id="line-486"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141892"><span class="annot"><a href="#local-6989586621683141892"><span class="hs-identifier hs-var">error_expr</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683141883"><span class="hs-identifier hs-type">mkErrorExpr</span></a></span><span>
</span><span id="line-487"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#extractMatchResult"><span class="hs-identifier hs-type">extractMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141890"><span class="hs-identifier hs-type">match_result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141892"><span class="hs-identifier hs-type">error_expr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621683141883"><span class="annot"><span class="annottext">mkErrorExpr :: DsM CoreExpr
</span><a href="#local-6989586621683141883"><span class="hs-identifier hs-var hs-var">mkErrorExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; SDoc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Utils.html#mkErrorAppDs"><span class="hs-identifier hs-var">mkErrorAppDs</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#nON_EXHAUSTIVE_GUARDS_ERROR_ID"><span class="hs-identifier hs-var">nON_EXHAUSTIVE_GUARDS_ERROR_ID</span></a></span><span> </span><span class="annot"><span class="annottext">XMultiIf GhcTc
Type
</span><a href="#local-6989586621683141881"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-490"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multi-way if&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">{-
\noindent
\underline{\bf Various data construction things}
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-}</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExplicitList"><span class="hs-identifier hs-type">ExplicitList</span></a></span><span> </span><span id="local-6989586621683141896"><span class="annot"><span class="annottext">XExplicitList GhcTc
</span><a href="#local-6989586621683141896"><span class="hs-identifier hs-var">elt_ty</span></a></span></span><span> </span><span id="local-6989586621683141897"><span class="annot"><span class="annottext">[LHsExpr GhcTc]
</span><a href="#local-6989586621683141897"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [LHsExpr GhcTc] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExplicitList"><span class="hs-identifier hs-var">dsExplicitList</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitList GhcTc
Type
</span><a href="#local-6989586621683141896"><span class="hs-identifier hs-var">elt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcTc]
</span><a href="#local-6989586621683141897"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ArithSeq"><span class="hs-identifier hs-type">ArithSeq</span></a></span><span> </span><span id="local-6989586621683141900"><span class="annot"><span class="annottext">XArithSeq GhcTc
</span><a href="#local-6989586621683141900"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621683141901"><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683141901"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span id="local-6989586621683141902"><span class="annot"><span class="annottext">ArithSeqInfo GhcTc
</span><a href="#local-6989586621683141902"><span class="hs-identifier hs-var">seq</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683141901"><span class="hs-identifier hs-var">witness</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-502"></span><span>     </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; ArithSeqInfo GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var">dsArithSeq</span></a></span><span> </span><span class="annot"><span class="annottext">XArithSeq GhcTc
HsExpr GhcTc
</span><a href="#local-6989586621683141900"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcTc
</span><a href="#local-6989586621683141902"><span class="hs-identifier hs-var">seq</span></a></span><span>
</span><span id="line-503"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683141904"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683141904"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141905"><span class="annot"><a href="#local-6989586621683141905"><span class="hs-identifier hs-var">newArithSeq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; ArithSeqInfo GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var">dsArithSeq</span></a></span><span> </span><span class="annot"><span class="annottext">XArithSeq GhcTc
HsExpr GhcTc
</span><a href="#local-6989586621683141900"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">ArithSeqInfo GhcTc
</span><a href="#local-6989586621683141902"><span class="hs-identifier hs-var">seq</span></a></span><span>
</span><span id="line-504"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141904"><span class="hs-identifier hs-type">fl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683141905"><span class="hs-identifier hs-type">newArithSeq</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">{-
Static Pointers
~~~~~~~~~~~~~~~

See Note [Grand plan for static forms] in GHC.Iface.Tidy.StaticPtrTable for an overview.

    g = ... static f ...
==&gt;
    g = ... makeStatic loc f ...
-}</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsStatic"><span class="hs-identifier hs-type">HsStatic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141907"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141907"><span class="hs-identifier hs-var">whole_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141908"><span class="annot"><span class="annottext">expr :: LHsExpr GhcTc
</span><a href="#local-6989586621683141908"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683141909"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683141909"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>    </span><span id="local-6989586621683141910"><span class="annot"><a href="#local-6989586621683141910"><span class="hs-identifier hs-var">expr_ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141908"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683141911"><span class="annot"><a href="#local-6989586621683141911"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp"><span class="hs-identifier hs-type">splitTyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141907"><span class="hs-identifier hs-type">whole_ty</span></a></span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621683141913"><span class="annot"><a href="#local-6989586621683141913"><span class="hs-identifier hs-var">makeStaticId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#dsLookupGlobalId"><span class="hs-identifier hs-type">dsLookupGlobalId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#makeStaticName"><span class="hs-identifier hs-type">makeStaticName</span></a></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621683141916"><span class="annot"><a href="#local-6989586621683141916"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141917"><span class="annot"><a href="#local-6989586621683141917"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683141916"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141919"><span class="annot"><a href="#local-6989586621683141919"><span class="hs-identifier hs-var">line</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141920"><span class="annot"><a href="#local-6989586621683141920"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141909"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-525"></span><span>           </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span id="local-6989586621683141922"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621683141922"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe BufSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>                            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcLocLine"><span class="hs-identifier hs-var">srcLocLine</span></a></span><span> </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; Int) -&gt; RealSrcLoc -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; RealSrcLoc
</span><a href="GHC.Types.SrcLoc.html#realSrcSpanStart"><span class="hs-identifier hs-var">realSrcSpanStart</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621683141922"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-527"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcLocCol"><span class="hs-identifier hs-var">srcLocCol</span></a></span><span>  </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; Int) -&gt; RealSrcLoc -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; RealSrcLoc
</span><a href="GHC.Types.SrcLoc.html#realSrcSpanStart"><span class="hs-identifier hs-var">realSrcSpanStart</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621683141922"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-528"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>           </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>        </span><span id="local-6989586621683141926"><span class="annot"><a href="#local-6989586621683141926"><span class="hs-identifier hs-var hs-var">srcLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreTup"><span class="hs-identifier hs-var">mkCoreTup</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntExprInt"><span class="hs-identifier hs-var">mkIntExprInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683141917"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141919"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-531"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntExprInt"><span class="hs-identifier hs-var">mkIntExprInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683141917"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683141920"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-532"></span><span>                           </span><span class="hs-special">]</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="GHC.HsToCore.Monad.html#putSrcSpanDsA"><span class="hs-identifier hs-type">putSrcSpanDsA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141909"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-535"></span><span>      </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141913"><span class="hs-identifier hs-type">makeStaticId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141911"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683141926"><span class="hs-identifier hs-type">srcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683141910"><span class="hs-identifier hs-type">expr_ds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">{-
\noindent
\underline{\bf Record construction and update}
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For record construction we do this (assuming T has three arguments)
\begin{verbatim}
        T { op2 = e }
==&gt;
        let err = /\a -&gt; recConError a
        T (recConError t1 &quot;M.hs/230/op1&quot;)
          e
          (recConError t1 &quot;M.hs/230/op3&quot;)
\end{verbatim}
@recConError@ then converts its argument string into a proper message
before printing it as
\begin{verbatim}
        M.hs, line 230: missing field op1 was evaluated
\end{verbatim}

We also handle @C{}@ as valid construction syntax for an unlabelled
constructor @C@, setting all of @C@'s fields to bottom.
-}</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#RecordCon"><span class="hs-identifier hs-type">RecordCon</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rcon_con :: forall p. HsExpr p -&gt; XRec p (ConLikeP p)
</span><a href="Language.Haskell.Syntax.Expr.html#rcon_con"><span class="hs-identifier hs-var">rcon_con</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141933"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683141933"><span class="hs-identifier hs-var">con_like</span></a></span></span><span>
</span><span id="line-561"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rcon_flds :: forall p. HsExpr p -&gt; HsRecordBinds p
</span><a href="Language.Haskell.Syntax.Expr.html#rcon_flds"><span class="hs-identifier hs-var">rcon_flds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141935"><span class="annot"><span class="annottext">HsRecordBinds GhcTc
</span><a href="#local-6989586621683141935"><span class="hs-identifier hs-var">rbinds</span></a></span></span><span>
</span><span id="line-562"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rcon_ext :: forall p. HsExpr p -&gt; XRecordCon p
</span><a href="Language.Haskell.Syntax.Expr.html#rcon_ext"><span class="hs-identifier hs-var">rcon_ext</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683141937"><span class="annot"><span class="annottext">XRecordCon GhcTc
</span><a href="#local-6989586621683141937"><span class="hs-identifier hs-var">con_expr</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683141938"><span class="annot"><a href="#local-6989586621683141938"><span class="hs-identifier hs-var">con_expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">XRecordCon GhcTc
HsExpr GhcTc
</span><a href="#local-6989586621683141937"><span class="hs-identifier hs-var">con_expr</span></a></span><span>
</span><span id="line-564"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-565"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621683141939"><span class="annot"><a href="#local-6989586621683141939"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-type">tcSplitFunTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-type">exprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141938"><span class="hs-identifier hs-type">con_expr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>             </span><span class="hs-comment">-- A newtype in the corner should be opaque;</span><span>
</span><span id="line-567"></span><span>             </span><span class="hs-comment">-- hence TcType.tcSplitFunTys</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>             </span><span id="local-6989586621683141941"><span class="annot"><a href="#local-6989586621683141941"><span class="hs-identifier hs-var hs-var">mk_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683141942"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141942"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683141943"><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621683141943"><span class="hs-identifier hs-var">fl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[LHsRecField GhcTc (LocatedA (HsExpr GhcTc))]
-&gt; Name -&gt; [LocatedA (HsExpr GhcTc)]
forall arg. [LHsRecField GhcTc arg] -&gt; Name -&gt; [arg]
</span><a href="GHC.HsToCore.Expr.html#findField"><span class="hs-identifier hs-var">findField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsRecFields GhcTc (LocatedA (HsExpr GhcTc))
-&gt; [LHsRecField GhcTc (LocatedA (HsExpr GhcTc))]
forall p arg. HsRecFields p arg -&gt; [LHsRecField p arg]
</span><a href="Language.Haskell.Syntax.Pat.html#rec_flds"><span class="hs-identifier hs-var">rec_flds</span></a></span><span> </span><span class="annot"><span class="annottext">HsRecordBinds GhcTc
HsRecFields GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683141935"><span class="hs-identifier hs-var">rbinds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldLabel -&gt; Name
</span><a href="GHC.Types.FieldLabel.html#flSelector"><span class="hs-identifier hs-var">flSelector</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621683141943"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-571"></span><span>                   </span><span class="hs-special">(</span><span id="local-6989586621683141947"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683141947"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683141948"><span class="annot"><span class="annottext">[LocatedA (HsExpr GhcTc)]
</span><a href="#local-6989586621683141948"><span class="hs-identifier hs-var">rhss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr)
-&gt; LocatedA (HsExpr GhcTc)
-&gt; DsM CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocatedA (HsExpr GhcTc)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[LocatedA (HsExpr GhcTc)]
</span><a href="#local-6989586621683141948"><span class="hs-identifier hs-var">rhss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>                                 </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683141947"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-573"></span><span>                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; SDoc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Utils.html#mkErrorAppDs"><span class="hs-identifier hs-var">mkErrorAppDs</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141942"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldLabelString -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldLabel -&gt; FieldLabelString
</span><a href="GHC.Types.FieldLabel.html#flLabel"><span class="hs-identifier hs-var">flLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621683141943"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>             </span><span id="local-6989586621683141953"><span class="annot"><a href="#local-6989586621683141953"><span class="hs-identifier hs-var hs-var">unlabelled_bottom</span></a></span></span><span> </span><span id="local-6989586621683141954"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141954"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; SDoc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Utils.html#mkErrorAppDs"><span class="hs-identifier hs-var">mkErrorAppDs</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Core.Make.html#rEC_CON_ERROR_ID"><span class="hs-identifier hs-var">rEC_CON_ERROR_ID</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683141954"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>             </span><span id="local-6989586621683141956"><span class="annot"><a href="#local-6989586621683141956"><span class="hs-identifier hs-var hs-var">labels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; [FieldLabel]
</span><a href="GHC.Core.ConLike.html#conLikeFieldLabels"><span class="hs-identifier hs-var">conLikeFieldLabels</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683141933"><span class="hs-identifier hs-var">con_like</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683141958"><span class="annot"><a href="#local-6989586621683141958"><span class="hs-identifier hs-var">con_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683141956"><span class="hs-identifier hs-type">labels</span></a></span><span>
</span><span id="line-579"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621683141953"><span class="hs-identifier hs-type">unlabelled_bottom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-type">scaledThing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141939"><span class="hs-identifier hs-type">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621683141941"><span class="hs-identifier hs-type">mk_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#zipEqual"><span class="hs-identifier hs-type">zipEqual</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;dsExpr:RecordCon&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-type">scaledThing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141939"><span class="hs-identifier hs-type">arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141956"><span class="hs-identifier hs-type">labels</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141938"><span class="hs-identifier hs-type">con_expr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141958"><span class="hs-identifier hs-type">con_args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#RecordUpd"><span class="hs-identifier hs-type">RecordUpd</span></a></span><span> </span><span id="local-6989586621683141963"><span class="annot"><span class="annottext">XRecordUpd GhcTc
</span><a href="#local-6989586621683141963"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsRecUpdFields GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XRecordUpd GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141963"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- Here is where we desugar the Template Haskell brackets and escapes</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-comment">-- Template Haskell stuff</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- See Note [The life cycle of a TH quotation]</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsTypedBracket"><span class="hs-identifier hs-type">HsTypedBracket</span></a></span><span>   </span><span id="local-6989586621683141965"><span class="annot"><span class="annottext">XTypedBracket GhcTc
</span><a href="#local-6989586621683141965"><span class="hs-identifier hs-var">bracket_tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsBracketTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Quote.html#dsBracket"><span class="hs-identifier hs-var">dsBracket</span></a></span><span> </span><span class="annot"><span class="annottext">XTypedBracket GhcTc
HsBracketTc
</span><a href="#local-6989586621683141965"><span class="hs-identifier hs-var">bracket_tc</span></a></span><span>
</span><span id="line-592"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUntypedBracket"><span class="hs-identifier hs-type">HsUntypedBracket</span></a></span><span> </span><span id="local-6989586621683141968"><span class="annot"><span class="annottext">XUntypedBracket GhcTc
</span><a href="#local-6989586621683141968"><span class="hs-identifier hs-var">bracket_tc</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsQuote GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsBracketTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Quote.html#dsBracket"><span class="hs-identifier hs-var">dsBracket</span></a></span><span> </span><span class="annot"><span class="annottext">XUntypedBracket GhcTc
HsBracketTc
</span><a href="#local-6989586621683141968"><span class="hs-identifier hs-var">bracket_tc</span></a></span><span>
</span><span id="line-593"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsTypedSplice"><span class="hs-identifier hs-type">HsTypedSplice</span></a></span><span>   </span><span class="annot"><span class="annottext">XTypedSplice GhcTc
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621683141970"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141970"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsExpr:typed splice&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; LHsExpr GhcTc -&gt; SDoc
forall (p :: Pass).
OutputableBndrId p =&gt;
Maybe Name -&gt; LHsExpr (GhcPass p) -&gt; SDoc
</span><a href="GHC.Hs.Expr.html#pprTypedSplice"><span class="hs-identifier hs-var">pprTypedSplice</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141970"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUntypedSplice"><span class="hs-identifier hs-type">HsUntypedSplice</span></a></span><span> </span><span id="local-6989586621683141973"><span class="annot"><span class="annottext">XUntypedSplice GhcTc
</span><a href="#local-6989586621683141973"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsUntypedSplice GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XUntypedSplice GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141973"><span class="hs-identifier hs-var">ext</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- Arrow notation extension</span><span>
</span><span id="line-597"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsProc"><span class="hs-identifier hs-type">HsProc</span></a></span><span> </span><span class="annot"><span class="annottext">XProc GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141975"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141975"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621683141976"><span class="annot"><span class="annottext">LHsCmdTop GhcTc
</span><a href="#local-6989586621683141976"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LPat GhcTc -&gt; LHsCmdTop GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Arrows.html#dsProcExpr"><span class="hs-identifier hs-var">dsProcExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683141975"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">LHsCmdTop GhcTc
</span><a href="#local-6989586621683141976"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- HsSyn constructs that just shouldn't be here, because</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- the renamer removed them.  See GHC.Rename.Expr.</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- Note [Handling overloaded and rebindable constructs]</span><span>
</span><span id="line-603"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLabel"><span class="hs-identifier hs-type">HsOverLabel</span></a></span><span> </span><span id="local-6989586621683141979"><span class="annot"><span class="annottext">XOverLabel GhcTc
</span><a href="#local-6989586621683141979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLabel GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141979"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-604"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span id="local-6989586621683141981"><span class="annot"><span class="annottext">XOpApp GhcTc
</span><a href="#local-6989586621683141981"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141981"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-605"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#SectionL"><span class="hs-identifier hs-type">SectionL</span></a></span><span> </span><span id="local-6989586621683141983"><span class="annot"><span class="annottext">XSectionL GhcTc
</span><a href="#local-6989586621683141983"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XSectionL GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141983"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-606"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#SectionR"><span class="hs-identifier hs-type">SectionR</span></a></span><span> </span><span id="local-6989586621683141985"><span class="annot"><span class="annottext">XSectionR GhcTc
</span><a href="#local-6989586621683141985"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataConCantHappen -&gt; DsM CoreExpr
forall a. DataConCantHappen -&gt; a
</span><a href="Language.Haskell.Syntax.Extension.html#dataConCantHappen"><span class="hs-identifier hs-var">dataConCantHappen</span></a></span><span> </span><span class="annot"><span class="annottext">XSectionR GhcTc
DataConCantHappen
</span><a href="#local-6989586621683141985"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#ds_prag_expr"><span class="hs-identifier hs-type">ds_prag_expr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-609"></span><span id="ds_prag_expr"><span class="annot"><span class="annottext">ds_prag_expr :: HsPragE GhcTc -&gt; LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#ds_prag_expr"><span class="hs-identifier hs-var hs-var">ds_prag_expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragSCC"><span class="hs-identifier hs-type">HsPragSCC</span></a></span><span> </span><span class="annot"><span class="annottext">XSCC GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683141987"><span class="annot"><span class="annottext">StringLiteral
</span><a href="#local-6989586621683141987"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683141988"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683141988"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>    </span><span id="local-6989586621683141989"><span class="annot"><a href="#local-6989586621683141989"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#sccProfilingEnabled"><span class="hs-identifier hs-type">sccProfilingEnabled</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141989"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-type">gopt</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_ProfManualCcs"><span class="hs-identifier hs-type">Opt_ProfManualCcs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141989"><span class="hs-identifier hs-type">dflags</span></a></span><span>
</span><span id="line-612"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>        </span><span id="local-6989586621683141993"><span class="annot"><a href="#local-6989586621683141993"><span class="hs-identifier hs-var">mod_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-type">getModule</span></a></span><span>
</span><span id="line-614"></span><span>        </span><span id="local-6989586621683141995"><span class="annot"><a href="#local-6989586621683141995"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#goptM"><span class="hs-identifier hs-type">goptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_ProfCountEntries"><span class="hs-identifier hs-type">Opt_ProfCountEntries</span></a></span><span>
</span><span id="line-615"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683141998"><span class="annot"><a href="#local-6989586621683141998"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringLiteral -&gt; FastString
</span><a href="GHC.Types.SourceText.html#sl_fs"><span class="hs-identifier hs-var">sl_fs</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral
</span><a href="#local-6989586621683141987"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-616"></span><span>        </span><span id="local-6989586621683142000"><span class="annot"><a href="#local-6989586621683142000"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Types.CostCentre.html#mkExprCCFlavour"><span class="hs-identifier hs-type">mkExprCCFlavour</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#getCCIndexDsM"><span class="hs-identifier hs-type">getCCIndexDsM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141998"><span class="hs-identifier hs-type">nm</span></a></span><span>
</span><span id="line-617"></span><span>        </span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Tickish.html#ProfNote"><span class="hs-identifier hs-type">ProfNote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.CostCentre.html#mkUserCC"><span class="hs-identifier hs-type">mkUserCC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141998"><span class="hs-identifier hs-type">nm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141993"><span class="hs-identifier hs-type">mod_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-type">getLocA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141988"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142000"><span class="hs-identifier hs-type">flavour</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683141995"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>               </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141988"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-619"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683141988"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-622"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-623"></span><span id="dsSyntaxExpr"><span class="annot"><span class="annottext">dsSyntaxExpr :: SyntaxExpr GhcTc -&gt; [CoreExpr] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-var hs-var">dsSyntaxExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#SyntaxExprTc"><span class="hs-identifier hs-type">SyntaxExprTc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">syn_expr :: SyntaxExprTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Expr.html#syn_expr"><span class="hs-identifier hs-var">syn_expr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142008"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142008"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-624"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">syn_arg_wraps :: SyntaxExprTc -&gt; [HsWrapper]
</span><a href="GHC.Hs.Expr.html#syn_arg_wraps"><span class="hs-identifier hs-var">syn_arg_wraps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142010"><span class="annot"><span class="annottext">[HsWrapper]
</span><a href="#local-6989586621683142010"><span class="hs-identifier hs-var">arg_wraps</span></a></span></span><span>
</span><span id="line-625"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">syn_res_wrap :: SyntaxExprTc -&gt; HsWrapper
</span><a href="GHC.Hs.Expr.html#syn_res_wrap"><span class="hs-identifier hs-var">syn_res_wrap</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142012"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142012"><span class="hs-identifier hs-var">res_wrap</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>             </span><span id="local-6989586621683142013"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621683142013"><span class="hs-identifier hs-var">arg_exprs</span></a></span></span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142014"><span class="annot"><a href="#local-6989586621683142014"><span class="hs-identifier hs-var">fun</span></a></span></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142008"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-628"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Binds.html#dsHsWrappers"><span class="hs-identifier hs-type">dsHsWrappers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142010"><span class="hs-identifier hs-type">arg_wraps</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683142016"><span class="annot"><span class="annottext">[CoreExpr -&gt; CoreExpr]
</span><a href="#local-6989586621683142016"><span class="hs-identifier hs-var">core_arg_wraps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsWrapper
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a. HsWrapper -&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM a) -&gt; DsM a
</span><a href="GHC.HsToCore.Binds.html#dsHsWrapper"><span class="hs-identifier hs-var">dsHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142012"><span class="hs-identifier hs-var">res_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">(((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr)
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683142017"><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683142017"><span class="hs-identifier hs-var">core_res_wrap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>       </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142018"><span class="annot"><span class="annottext">wrapped_args :: [CoreExpr]
</span><a href="#local-6989586621683142018"><span class="hs-identifier hs-var hs-var">wrapped_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr)
-&gt; [CoreExpr -&gt; CoreExpr]
-&gt; [CoreExpr]
-&gt; [CoreExpr]
forall a b c.
HasDebugCallStack =&gt;
String -&gt; (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="GHC.Utils.Misc.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsSyntaxExpr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr -&gt; CoreExpr]
</span><a href="#local-6989586621683142016"><span class="hs-identifier hs-var">core_arg_wraps</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621683142013"><span class="hs-identifier hs-var">arg_exprs</span></a></span><span>
</span><span id="line-631"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; DsM CoreExpr) -&gt; CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683142017"><span class="hs-identifier hs-var">core_res_wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-var">mkCoreApps</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142014"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621683142018"><span class="hs-identifier hs-var">wrapped_args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-632"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-var">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
SyntaxExprTc
</span><a href="GHC.Hs.Expr.html#NoSyntaxExprTc"><span class="hs-identifier hs-var">NoSyntaxExprTc</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsSyntaxExpr&quot;</span></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span id="local-6989586621683140967"><span class="annot"><a href="GHC.HsToCore.Expr.html#findField"><span class="hs-identifier hs-type">findField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683140967"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683140967"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-635"></span><span id="findField"><span class="annot"><span class="annottext">findField :: forall arg. [LHsRecField GhcTc arg] -&gt; Name -&gt; [arg]
</span><a href="GHC.HsToCore.Expr.html#findField"><span class="hs-identifier hs-var hs-var">findField</span></a></span></span><span> </span><span id="local-6989586621683142023"><span class="annot"><span class="annottext">[LHsRecField GhcTc arg]
</span><a href="#local-6989586621683142023"><span class="hs-identifier hs-var">rbinds</span></a></span></span><span> </span><span id="local-6989586621683142024"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683142024"><span class="hs-identifier hs-var">sel</span></a></span></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HsFieldBind (GenLocated SrcSpanAnnA (FieldOcc GhcTc)) arg -&gt; arg
forall lhs rhs. HsFieldBind lhs rhs -&gt; rhs
</span><a href="Language.Haskell.Syntax.Pat.html#hfbRHS"><span class="hs-identifier hs-var">hfbRHS</span></a></span><span> </span><span class="annot"><span class="annottext">HsFieldBind (GenLocated SrcSpanAnnA (FieldOcc GhcTc)) arg
</span><a href="#local-6989586621683142026"><span class="hs-identifier hs-var">fld</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142026"><span class="annot"><span class="annottext">HsFieldBind (GenLocated SrcSpanAnnA (FieldOcc GhcTc)) arg
</span><a href="#local-6989586621683142026"><span class="hs-identifier hs-var">fld</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LHsRecField GhcTc arg]
[GenLocated
   SrcSpanAnnA
   (HsFieldBind (GenLocated SrcSpanAnnA (FieldOcc GhcTc)) arg)]
</span><a href="#local-6989586621683142023"><span class="hs-identifier hs-var">rbinds</span></a></span><span>
</span><span id="line-637"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683142024"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsRecField GhcTc arg -&gt; Id
forall arg. HsRecField GhcTc arg -&gt; Id
</span><a href="GHC.Hs.Pat.html#hsRecFieldId"><span class="hs-identifier hs-var">hsRecFieldId</span></a></span><span> </span><span class="annot"><span class="annottext">HsRecField GhcTc arg
HsFieldBind (GenLocated SrcSpanAnnA (FieldOcc GhcTc)) arg
</span><a href="#local-6989586621683142026"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="hs-comment">{-
%--------------------------------------------------------------------

Note [Desugaring explicit lists]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Explicit lists are desugared in a cleverer way to prevent some
fruitless allocations.  Essentially, whenever we see a list literal
[x_1, ..., x_n] we generate the corresponding expression in terms of
build:

Explicit lists (literals) are desugared to allow build/foldr fusion when
beneficial. This is a bit of a trade-off,

 * build/foldr fusion can generate far larger code than the corresponding
   cons-chain (e.g. see #11707)

 * even when it doesn't produce more code, build can still fail to fuse,
   requiring that the simplifier do more work to bring the expression
   back into cons-chain form; this costs compile time

 * when it works, fusion can be a significant win. Allocations are reduced
   by up to 25% in some nofib programs. Specifically,

        Program           Size    Allocs   Runtime  CompTime
        rewrite          +0.0%    -26.3%      0.02     -1.8%
           ansi          -0.3%    -13.8%      0.00     +0.0%
           lift          +0.0%     -8.7%      0.00     -2.3%

At the moment we use a simple heuristic to determine whether build will be
fruitful: for small lists we assume the benefits of fusion will be worthwhile;
for long lists we assume that the benefits will be outweighed by the cost of
code duplication. This magic length threshold is @maxBuildLength@. Also, fusion
won't work at all if rewrite rules are disabled, so we don't use the build-based
desugaring in this case.

We used to have a more complex heuristic which would try to break the list into
&quot;static&quot; and &quot;dynamic&quot; parts and only build-desugar the dynamic part.
Unfortunately, determining &quot;static-ness&quot; reliably is a bit tricky and the
heuristic at times produced surprising behavior (see #11710) so it was dropped.
-}</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="annot"><span class="hs-comment">{- | The longest list length which we will desugar using @build@.

This is essentially a magic number and its setting is unfortunate rather
arbitrary. The idea here, as mentioned in Note [Desugaring explicit lists],
is to avoid deforesting large static data into large(r) code. Ideally we'd
want a smaller threshold with larger consumers and vice-versa, but we have no
way of knowing what will be consuming our list in the desugaring impossible to
set generally correctly.

The effect of reducing this number will be that 'build' fusion is applied
less often. From a runtime performance perspective, applying 'build' more
liberally on &quot;moderately&quot; sized lists should rarely hurt and will often it can
only expose further optimization opportunities; if no fusion is possible it will
eventually get rule-rewritten back to a list). We do, however, pay in compile
time.
-}</span></span><span>
</span><span id="line-696"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#maxBuildLength"><span class="hs-identifier hs-type">maxBuildLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-697"></span><span id="maxBuildLength"><span class="annot"><span class="annottext">maxBuildLength :: Int
</span><a href="GHC.HsToCore.Expr.html#maxBuildLength"><span class="hs-identifier hs-var hs-var">maxBuildLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExplicitList"><span class="hs-identifier hs-type">dsExplicitList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-701"></span><span class="hs-comment">-- See Note [Desugaring explicit lists]</span><span>
</span><span id="line-702"></span><span id="dsExplicitList"><span class="annot"><span class="annottext">dsExplicitList :: Type -&gt; [LHsExpr GhcTc] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExplicitList"><span class="hs-identifier hs-var hs-var">dsExplicitList</span></a></span></span><span> </span><span id="local-6989586621683142029"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142029"><span class="hs-identifier hs-var">elt_ty</span></a></span></span><span> </span><span id="local-6989586621683142030"><span class="annot"><span class="annottext">[LHsExpr GhcTc]
</span><a href="#local-6989586621683142030"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142031"><span class="annot"><a href="#local-6989586621683142031"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-704"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142032"><span class="annot"><a href="#local-6989586621683142032"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142030"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-705"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683142032"><span class="hs-identifier hs-type">xs'</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-type">`lengthExceeds`</span></a></span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#maxBuildLength"><span class="hs-identifier hs-type">maxBuildLength</span></a></span><span>
</span><span id="line-706"></span><span>                </span><span class="hs-comment">-- Don't generate builds if the list is very long.</span><span>
</span><span id="line-707"></span><span>         </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621683142032"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-708"></span><span>                </span><span class="hs-comment">-- Don't generate builds when the [] constructor will do</span><span>
</span><span id="line-709"></span><span>         </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-type">gopt</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_EnableRewriteRules"><span class="hs-identifier hs-type">Opt_EnableRewriteRules</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142031"><span class="hs-identifier hs-type">dflags</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Rewrite rules off</span><span>
</span><span id="line-710"></span><span>                </span><span class="hs-comment">-- Don't generate a build if there are no rules to eliminate it!</span><span>
</span><span id="line-711"></span><span>                </span><span class="hs-comment">-- See Note [Desugaring RULE left hand sides] in GHC.HsToCore</span><span>
</span><span id="line-712"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkListExpr"><span class="hs-identifier hs-type">mkListExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142029"><span class="hs-identifier hs-type">elt_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142032"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-713"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkBuildExpr"><span class="hs-identifier hs-type">mkBuildExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142029"><span class="hs-identifier hs-type">elt_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683142037"><span class="hs-identifier hs-type">mk_build_list</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142032"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621683142037"><span class="annot"><span class="annottext">mk_build_list :: t (Arg b) -&gt; (Id, b) -&gt; (Id, b) -&gt; m (Arg b)
</span><a href="#local-6989586621683142037"><span class="hs-identifier hs-var hs-var">mk_build_list</span></a></span></span><span> </span><span id="local-6989586621683142048"><span class="annot"><span class="annottext">t (Arg b)
</span><a href="#local-6989586621683142048"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142049"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142049"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142050"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142050"><span class="hs-identifier hs-var">nil</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg b -&gt; m (Arg b)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Arg b -&gt; Arg b -&gt; Arg b) -&gt; Arg b -&gt; t (Arg b) -&gt; Arg b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg b -&gt; Arg b -&gt; Arg b
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg b -&gt; Arg b -&gt; Arg b)
-&gt; (Arg b -&gt; Arg b) -&gt; Arg b -&gt; Arg b -&gt; Arg b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Arg b -&gt; Arg b -&gt; Arg b
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Arg b
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142049"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Arg b
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142050"><span class="hs-identifier hs-var">nil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Arg b)
</span><a href="#local-6989586621683142048"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-type">dsArithSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#PostTcExpr"><span class="hs-identifier hs-type">PostTcExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ArithSeqInfo"><span class="hs-identifier hs-type">ArithSeqInfo</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-719"></span><span id="dsArithSeq"><span class="annot"><span class="annottext">dsArithSeq :: HsExpr GhcTc -&gt; ArithSeqInfo GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var hs-var">dsArithSeq</span></a></span></span><span> </span><span id="local-6989586621683142053"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142053"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span id="local-6989586621683142055"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142055"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr -&gt; CoreExpr)
-&gt; DsM CoreExpr
-&gt; IOEnv (Env DsGblEnv DsLclEnv) (CoreExpr -&gt; CoreExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142053"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) (CoreExpr -&gt; CoreExpr)
-&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b.
IOEnv (Env DsGblEnv DsLclEnv) (a -&gt; b)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) a
-&gt; IOEnv (Env DsGblEnv DsLclEnv) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142055"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-721"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var">dsArithSeq</span></a></span><span> </span><span id="local-6989586621683142056"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142056"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#FromTo"><span class="hs-identifier hs-type">FromTo</span></a></span><span> </span><span id="local-6989586621683142058"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142058"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621683142059"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142059"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683142060"><span class="annot"><a href="#local-6989586621683142060"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DsM FamInstEnvs
</span><a href="GHC.HsToCore.Monad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a></span><span>
</span><span id="line-723"></span><span>       </span><span id="local-6989586621683142062"><span class="annot"><a href="#local-6989586621683142062"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span>
</span><span id="line-724"></span><span>       </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutEmptyEnumerations"><span class="hs-identifier hs-type">warnAboutEmptyEnumerations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142060"><span class="hs-identifier hs-type">fam_envs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142062"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142058"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="#local-6989586621683142059"><span class="hs-identifier hs-type">to</span></a></span><span>
</span><span id="line-725"></span><span>       </span><span id="local-6989586621683142064"><span class="annot"><a href="#local-6989586621683142064"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-type">dsExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142056"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-726"></span><span>       </span><span id="local-6989586621683142065"><span class="annot"><a href="#local-6989586621683142065"><span class="hs-identifier hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142058"><span class="hs-identifier hs-type">from</span></a></span><span>
</span><span id="line-727"></span><span>       </span><span id="local-6989586621683142066"><span class="annot"><a href="#local-6989586621683142066"><span class="hs-identifier hs-var">to'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142059"><span class="hs-identifier hs-type">to</span></a></span><span>
</span><span id="line-728"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-type">mkApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142064"><span class="hs-identifier hs-type">expr'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683142065"><span class="hs-identifier hs-type">from'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142066"><span class="hs-identifier hs-type">to'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var">dsArithSeq</span></a></span><span> </span><span id="local-6989586621683142068"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142068"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#FromThen"><span class="hs-identifier hs-type">FromThen</span></a></span><span> </span><span id="local-6989586621683142070"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142070"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621683142071"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142071"><span class="hs-identifier hs-var">thn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
forall b. Expr b -&gt; [Expr b] -&gt; Expr b
</span><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr)
-&gt; DsM CoreExpr
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ([CoreExpr] -&gt; CoreExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142068"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) ([CoreExpr] -&gt; CoreExpr)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) [CoreExpr] -&gt; DsM CoreExpr
forall a b.
IOEnv (Env DsGblEnv DsLclEnv) (a -&gt; b)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) a
-&gt; IOEnv (Env DsGblEnv DsLclEnv) b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr)
-&gt; [LocatedA (HsExpr GhcTc)]
-&gt; IOEnv (Env DsGblEnv DsLclEnv) [CoreExpr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142070"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142071"><span class="hs-identifier hs-var">thn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-731"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsArithSeq"><span class="hs-identifier hs-var">dsArithSeq</span></a></span><span> </span><span id="local-6989586621683142072"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142072"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#FromThenTo"><span class="hs-identifier hs-type">FromThenTo</span></a></span><span> </span><span id="local-6989586621683142074"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142074"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621683142075"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142075"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span id="local-6989586621683142076"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142076"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683142077"><span class="annot"><a href="#local-6989586621683142077"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DsM FamInstEnvs
</span><a href="GHC.HsToCore.Monad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a></span><span>
</span><span id="line-733"></span><span>       </span><span id="local-6989586621683142078"><span class="annot"><a href="#local-6989586621683142078"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span>
</span><span id="line-734"></span><span>       </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutEmptyEnumerations"><span class="hs-identifier hs-type">warnAboutEmptyEnumerations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142077"><span class="hs-identifier hs-type">fam_envs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142078"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142074"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683142075"><span class="hs-identifier hs-type">thn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142076"><span class="hs-identifier hs-type">to</span></a></span><span>
</span><span id="line-735"></span><span>       </span><span id="local-6989586621683142079"><span class="annot"><a href="#local-6989586621683142079"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-type">dsExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142072"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-736"></span><span>       </span><span id="local-6989586621683142080"><span class="annot"><a href="#local-6989586621683142080"><span class="hs-identifier hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142074"><span class="hs-identifier hs-type">from</span></a></span><span>
</span><span id="line-737"></span><span>       </span><span id="local-6989586621683142081"><span class="annot"><a href="#local-6989586621683142081"><span class="hs-identifier hs-var">thn'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142075"><span class="hs-identifier hs-type">thn</span></a></span><span>
</span><span id="line-738"></span><span>       </span><span id="local-6989586621683142082"><span class="annot"><a href="#local-6989586621683142082"><span class="hs-identifier hs-var">to'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142076"><span class="hs-identifier hs-type">to</span></a></span><span>
</span><span id="line-739"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-type">mkApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142079"><span class="hs-identifier hs-type">expr'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683142080"><span class="hs-identifier hs-type">from'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142081"><span class="hs-identifier hs-type">thn'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142082"><span class="hs-identifier hs-type">to'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="hs-comment">{-
Desugar 'do' and 'mdo' expressions (NOT list comprehensions, they're
handled in GHC.HsToCore.ListComp).  Basically does the translation given in the
Haskell 98 report:
-}</span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-type">dsDo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDoFlavour"><span class="hs-identifier hs-type">HsDoFlavour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprLStmt"><span class="hs-identifier hs-type">ExprLStmt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-748"></span><span class="hs-comment">-- SG: Surprisingly, this code path seems inactive for regular Do,</span><span>
</span><span id="line-749"></span><span class="hs-comment">--     which is expanded in GHC.Tc.Gen.Do.</span><span>
</span><span id="line-750"></span><span class="hs-comment">--     It's all used for ApplicativeDo (even the BindStmt case), which is *very*</span><span>
</span><span id="line-751"></span><span class="hs-comment">--     annoying because it is a lot of duplicated code that is seldomly tested.</span><span>
</span><span id="line-752"></span><span id="dsDo"><span class="annot"><span class="annottext">dsDo :: HsDoFlavour -&gt; [ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-var hs-var">dsDo</span></a></span></span><span> </span><span id="local-6989586621683142083"><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683142083"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621683142084"><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
</span><a href="#local-6989586621683142084"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span id="local-6989586621683142085"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142085"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142086"><span class="hs-identifier hs-var">goL</span></a></span><span> </span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142084"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-755"></span><span>    </span><span id="local-6989586621683142086"><span class="annot"><span class="annottext">goL :: [GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142086"><span class="hs-identifier hs-var hs-var">goL</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsDo&quot;</span></span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="#local-6989586621683142086"><span class="hs-identifier hs-var">goL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683142087"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142087"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683142088"><span class="annot"><span class="annottext">StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683142088"><span class="hs-identifier hs-var">stmt</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683142089"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142089"><span class="hs-identifier hs-var">lstmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall ann a. EpAnn ann -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDsA"><span class="hs-identifier hs-var">putSrcSpanDsA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142087"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142087"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683142088"><span class="hs-identifier hs-var">stmt</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142089"><span class="hs-identifier hs-var">lstmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621683142090"><span class="annot"><span class="annottext">go :: SrcSpanAnnA
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142090"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LastStmt"><span class="hs-identifier hs-type">LastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLastStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142092"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142092"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142093"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142093"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-759"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr)
-&gt; LocatedA (HsExpr GhcTc)
-&gt; DsM CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142093"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
LocatedA (HsExpr GhcTc) -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142092"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-760"></span><span>        </span><span class="hs-comment">-- The 'return' op isn't used for 'do' expressions</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#BodyStmt"><span class="hs-identifier hs-type">BodyStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XBodyStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142095"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142095"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621683142096"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142096"><span class="hs-identifier hs-var">then_expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142097"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142097"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-763"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142098"><span class="annot"><a href="#local-6989586621683142098"><span class="hs-identifier hs-var">rhs2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142095"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-764"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#warnDiscardedDoBindings"><span class="hs-identifier hs-type">warnDiscardedDoBindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142095"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-type">exprType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142098"><span class="hs-identifier hs-type">rhs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142100"><span class="annot"><a href="#local-6989586621683142100"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683142086"><span class="hs-identifier hs-type">goL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142097"><span class="hs-identifier hs-type">stmts</span></a></span><span>
</span><span id="line-766"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142096"><span class="hs-identifier hs-type">then_expr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683142098"><span class="hs-identifier hs-type">rhs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142100"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LetStmt"><span class="hs-identifier hs-type">LetStmt</span></a></span><span> </span><span class="annot"><span class="annottext">XLetStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142102"><span class="annot"><span class="annottext">HsLocalBinds GhcTc
</span><a href="#local-6989586621683142102"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142103"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142103"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-769"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142104"><span class="annot"><a href="#local-6989586621683142104"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142086"><span class="hs-identifier hs-var">goL</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142103"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-770"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLocalBinds"><span class="hs-identifier hs-type">dsLocalBinds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142102"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142104"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#BindStmt"><span class="hs-identifier hs-type">BindStmt</span></a></span><span> </span><span id="local-6989586621683142106"><span class="annot"><span class="annottext">XBindStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="#local-6989586621683142106"><span class="hs-identifier hs-var">xbs</span></a></span></span><span> </span><span id="local-6989586621683142107"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683142107"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621683142108"><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142108"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142109"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142109"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-comment">-- SG: As far as I can tell, this code path is only triggered when ApplicativeDo fails, e.g.</span><span>
</span><span id="line-774"></span><span>      </span><span class="hs-comment">--   do blah &lt;- action1; action2 (blah * 2)</span><span>
</span><span id="line-775"></span><span>      </span><span class="hs-comment">-- It is reached when compiling GHC.Parser.PostProcess.Haddock.addHaddockToModule</span><span>
</span><span id="line-776"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142110"><span class="annot"><a href="#local-6989586621683142110"><span class="hs-identifier hs-var">var</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; LPat GhcTc -&gt; DsM Id
</span><a href="GHC.HsToCore.Utils.html#selectSimpleMatchVarL"><span class="hs-identifier hs-var">selectSimpleMatchVarL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XBindStmtTc -&gt; Type
</span><a href="GHC.Hs.Expr.html#xbstc_boundResultMult"><span class="hs-identifier hs-var">xbstc_boundResultMult</span></a></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
XBindStmtTc
</span><a href="#local-6989586621683142106"><span class="hs-identifier hs-var">xbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683142107"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-777"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142113"><span class="annot"><a href="#local-6989586621683142113"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142108"><span class="hs-identifier hs-type">rhs</span></a></span><span>
</span><span id="line-778"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142114"><span class="annot"><a href="#local-6989586621683142114"><span class="hs-identifier hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#matchSinglePatVar"><span class="hs-identifier hs-type">matchSinglePatVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142110"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#StmtCtxt"><span class="hs-identifier hs-type">StmtCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDoStmt"><span class="hs-identifier hs-type">HsDoStmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142083"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142107"><span class="hs-identifier hs-type">pat</span></a></span><span>
</span><span id="line-779"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#xbstc_boundResultType"><span class="hs-identifier hs-var">xbstc_boundResultType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142106"><span class="hs-identifier hs-type">xbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MR_Infallible"><span class="hs-identifier hs-type">MR_Infallible</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621683142086"><span class="hs-identifier hs-type">goL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142109"><span class="hs-identifier hs-type">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>            </span><span class="hs-comment">-- NB: &quot;goL stmts&quot; needs to happen inside matchSinglePatVar, and not</span><span>
</span><span id="line-781"></span><span>            </span><span class="hs-comment">-- before it, so that long-distance information is properly threaded.</span><span>
</span><span id="line-782"></span><span>            </span><span class="hs-comment">-- See Note [Long-distance information in do notation].</span><span>
</span><span id="line-783"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142120"><span class="annot"><a href="#local-6989586621683142120"><span class="hs-identifier hs-var">match_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#dsHandleMonadicFailure"><span class="hs-identifier hs-type">dsHandleMonadicFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142083"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142107"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142085"><span class="hs-identifier hs-type">res_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142114"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#xbstc_failOp"><span class="hs-identifier hs-var">xbstc_failOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142106"><span class="hs-identifier hs-type">xbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#xbstc_bindOp"><span class="hs-identifier hs-var">xbstc_bindOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142106"><span class="hs-identifier hs-type">xbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683142113"><span class="hs-identifier hs-type">rhs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142110"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142120"><span class="hs-identifier hs-type">match_code</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683142125"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142125"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#RecStmt"><span class="hs-identifier hs-type">RecStmt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_stmts :: forall idL idR body.
StmtLR idL idR body -&gt; XRec idR [LStmtLR idL idR body]
</span><a href="Language.Haskell.Syntax.Expr.html#recS_stmts"><span class="hs-identifier hs-var">recS_stmts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLW
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142128"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142128"><span class="hs-identifier hs-var">rec_stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_later_ids :: forall idL idR body. StmtLR idL idR body -&gt; [IdP idR]
</span><a href="Language.Haskell.Syntax.Expr.html#recS_later_ids"><span class="hs-identifier hs-var">recS_later_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142130"><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621683142130"><span class="hs-identifier hs-var">later_ids</span></a></span></span><span>
</span><span id="line-787"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_rec_ids :: forall idL idR body. StmtLR idL idR body -&gt; [IdP idR]
</span><a href="Language.Haskell.Syntax.Expr.html#recS_rec_ids"><span class="hs-identifier hs-var">recS_rec_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142132"><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621683142132"><span class="hs-identifier hs-var">rec_ids</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_ret_fn :: forall idL idR body. StmtLR idL idR body -&gt; SyntaxExpr idR
</span><a href="Language.Haskell.Syntax.Expr.html#recS_ret_fn"><span class="hs-identifier hs-var">recS_ret_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142134"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142134"><span class="hs-identifier hs-var">return_op</span></a></span></span><span>
</span><span id="line-788"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_mfix_fn :: forall idL idR body. StmtLR idL idR body -&gt; SyntaxExpr idR
</span><a href="Language.Haskell.Syntax.Expr.html#recS_mfix_fn"><span class="hs-identifier hs-var">recS_mfix_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142136"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142136"><span class="hs-identifier hs-var">mfix_op</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_bind_fn :: forall idL idR body. StmtLR idL idR body -&gt; SyntaxExpr idR
</span><a href="Language.Haskell.Syntax.Expr.html#recS_bind_fn"><span class="hs-identifier hs-var">recS_bind_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142138"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142138"><span class="hs-identifier hs-var">bind_op</span></a></span></span><span>
</span><span id="line-789"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_ext :: forall idL idR body. StmtLR idL idR body -&gt; XRecStmt idL idR body
</span><a href="Language.Haskell.Syntax.Expr.html#recS_ext"><span class="hs-identifier hs-var">recS_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Expr.html#RecStmtTc"><span class="hs-identifier hs-type">RecStmtTc</span></a></span><span>
</span><span id="line-790"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recS_bind_ty :: RecStmtTc -&gt; Type
</span><a href="GHC.Hs.Expr.html#recS_bind_ty"><span class="hs-identifier hs-var">recS_bind_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142142"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142142"><span class="hs-identifier hs-var">bind_ty</span></a></span></span><span>
</span><span id="line-791"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_rec_rets :: RecStmtTc -&gt; [HsExpr GhcTc]
</span><a href="GHC.Hs.Expr.html#recS_rec_rets"><span class="hs-identifier hs-var">recS_rec_rets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142144"><span class="annot"><span class="annottext">[HsExpr GhcTc]
</span><a href="#local-6989586621683142144"><span class="hs-identifier hs-var">rec_rets</span></a></span></span><span>
</span><span id="line-792"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recS_ret_ty :: RecStmtTc -&gt; Type
</span><a href="GHC.Hs.Expr.html#recS_ret_ty"><span class="hs-identifier hs-var">recS_ret_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683142146"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142146"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142147"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142147"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-793"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; DsM CoreExpr
</span><a href="#local-6989586621683142086"><span class="hs-identifier hs-var">goL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated
  SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
</span><a href="#local-6989586621683142148"><span class="hs-identifier hs-var">new_bind_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated
  SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142147"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- rec_ids can be empty; eg  rec { print 'x' }</span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-795"></span><span>        </span><span id="local-6989586621683142148"><span class="annot"><span class="annottext">new_bind_stmt :: GenLocated
  SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
</span><a href="#local-6989586621683142148"><span class="hs-identifier hs-var hs-var">new_bind_stmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142125"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
 -&gt; GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))))
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XBindStmt GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; LPat GhcTc
-&gt; LocatedA (HsExpr GhcTc)
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
forall idL idR body.
XBindStmt idL idR body -&gt; LPat idL -&gt; body -&gt; StmtLR idL idR body
</span><a href="Language.Haskell.Syntax.Expr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a></span><span>
</span><span id="line-796"></span><span>          </span><span class="annot"><a href="GHC.Hs.Expr.html#XBindStmtTc"><span class="hs-identifier hs-type">XBindStmtTc</span></a></span><span>
</span><span id="line-797"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">xbstc_bindOp :: SyntaxExpr GhcTc
</span><a href="GHC.Hs.Expr.html#xbstc_bindOp"><span class="hs-identifier hs-var">xbstc_bindOp</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142138"><span class="hs-identifier hs-var">bind_op</span></a></span><span>
</span><span id="line-798"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">xbstc_boundResultType :: Type
</span><a href="GHC.Hs.Expr.html#xbstc_boundResultType"><span class="hs-identifier hs-var">xbstc_boundResultType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142142"><span class="hs-identifier hs-var">bind_ty</span></a></span><span>
</span><span id="line-799"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">xbstc_boundResultMult :: Type
</span><a href="GHC.Hs.Expr.html#xbstc_boundResultMult"><span class="hs-identifier hs-var">xbstc_boundResultMult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span>
</span><span id="line-800"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">xbstc_failOp :: Maybe (SyntaxExpr GhcTc)
</span><a href="GHC.Hs.Expr.html#xbstc_failOp"><span class="hs-identifier hs-var">xbstc_failOp</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
Maybe SyntaxExprTc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- Tuple cannot fail</span><span>
</span><span id="line-801"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-802"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LPat GhcTc] -&gt; LPat GhcTc
</span><a href="GHC.HsToCore.Utils.html#mkBigLHsPatTupId"><span class="hs-identifier hs-var">mkBigLHsPatTupId</span></a></span><span> </span><span class="annot"><span class="annottext">[LPat GhcTc]
[GenLocated SrcSpanAnnA (Pat GhcTc)]
</span><a href="#local-6989586621683142151"><span class="hs-identifier hs-var">later_pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>          </span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142152"><span class="hs-identifier hs-var">mfix_app</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span>        </span><span id="local-6989586621683142153"><span class="annot"><span class="annottext">tup_ids :: [IdP GhcTc]
</span><a href="#local-6989586621683142153"><span class="hs-identifier hs-var hs-var">tup_ids</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621683142132"><span class="hs-identifier hs-var">rec_ids</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc] -&gt; [IdP GhcTc] -&gt; [IdP GhcTc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(IdP GhcTc -&gt; Bool) -&gt; [IdP GhcTc] -&gt; [IdP GhcTc]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdP GhcTc -&gt; [IdP GhcTc] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621683142132"><span class="hs-identifier hs-var">rec_ids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621683142130"><span class="hs-identifier hs-var">later_ids</span></a></span><span>
</span><span id="line-806"></span><span>        </span><span id="local-6989586621683142156"><span class="annot"><span class="annottext">tup_ty :: Type
</span><a href="#local-6989586621683142156"><span class="hs-identifier hs-var hs-var">tup_ty</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
HasDebugCallStack =&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Make.html#mkBigCoreTupTy"><span class="hs-identifier hs-var">mkBigCoreTupTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Id -&gt; Type) -&gt; [Id] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
[Id]
</span><a href="#local-6989586621683142153"><span class="hs-identifier hs-var">tup_ids</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Deals with singleton case</span><span>
</span><span id="line-807"></span><span>        </span><span id="local-6989586621683142158"><span class="annot"><span class="annottext">rec_tup_pats :: [GenLocated SrcSpanAnnA (Pat GhcTc)]
</span><a href="#local-6989586621683142158"><span class="hs-identifier hs-var hs-var">rec_tup_pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IdGhcP 'Typechecked -&gt; GenLocated SrcSpanAnnA (Pat GhcTc))
-&gt; [IdGhcP 'Typechecked] -&gt; [GenLocated SrcSpanAnnA (Pat GhcTc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">IdP GhcTc -&gt; LPat GhcTc
IdGhcP 'Typechecked -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LPat (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
[IdGhcP 'Typechecked]
</span><a href="#local-6989586621683142153"><span class="hs-identifier hs-var">tup_ids</span></a></span><span>
</span><span id="line-808"></span><span>        </span><span id="local-6989586621683142151"><span class="annot"><span class="annottext">later_pats :: [GenLocated SrcSpanAnnA (Pat GhcTc)]
</span><a href="#local-6989586621683142151"><span class="hs-identifier hs-var hs-var">later_pats</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Pat GhcTc)]
</span><a href="#local-6989586621683142158"><span class="hs-identifier hs-var">rec_tup_pats</span></a></span><span>
</span><span id="line-809"></span><span>        </span><span id="local-6989586621683142160"><span class="annot"><span class="annottext">rets :: [LocatedA (HsExpr GhcTc)]
</span><a href="#local-6989586621683142160"><span class="hs-identifier hs-var hs-var">rets</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc))
-&gt; [HsExpr GhcTc] -&gt; [LocatedA (HsExpr GhcTc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExpr GhcTc]
</span><a href="#local-6989586621683142144"><span class="hs-identifier hs-var">rec_rets</span></a></span><span>
</span><span id="line-810"></span><span>        </span><span id="local-6989586621683142152"><span class="annot"><span class="annottext">mfix_app :: LHsExpr GhcTc
</span><a href="#local-6989586621683142152"><span class="hs-identifier hs-var hs-var">mfix_app</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExprTc -&gt; [LHsExpr GhcTc] -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#nlHsSyntaxApps"><span class="hs-identifier hs-var">nlHsSyntaxApps</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
SyntaxExprTc
</span><a href="#local-6989586621683142136"><span class="hs-identifier hs-var">mfix_op</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142163"><span class="hs-identifier hs-var">mfix_arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-811"></span><span>        </span><span id="local-6989586621683142164"><span class="annot"><span class="annottext">match_group :: MatchGroupTc
</span><a href="#local-6989586621683142164"><span class="hs-identifier hs-var hs-var">match_group</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type] -&gt; Type -&gt; Origin -&gt; MatchGroupTc
</span><a href="GHC.Hs.Expr.html#MatchGroupTc"><span class="hs-identifier hs-var">MatchGroupTc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142156"><span class="hs-identifier hs-var">tup_ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142146"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenReason -&gt; DoPmc -&gt; Origin
</span><a href="GHC.Types.Basic.html#Generated"><span class="hs-identifier hs-var">Generated</span></a></span><span> </span><span class="annot"><span class="annottext">GenReason
</span><a href="GHC.Types.Basic.html#OtherExpansion"><span class="hs-identifier hs-var">OtherExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">DoPmc
</span><a href="GHC.Types.Basic.html#SkipPmc"><span class="hs-identifier hs-var">SkipPmc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>        </span><span id="local-6989586621683142163"><span class="annot"><span class="annottext">mfix_arg :: LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142163"><span class="hs-identifier hs-var hs-var">mfix_arg</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc))
-&gt; HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XLam GhcTc
-&gt; HsLamVariant -&gt; MatchGroup GhcTc (LHsExpr GhcTc) -&gt; HsExpr GhcTc
forall p.
XLam p -&gt; HsLamVariant -&gt; MatchGroup p (LHsExpr p) -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a></span><span> </span><span class="annot"><span class="annottext">XLam GhcTc
forall a. NoAnn a =&gt; a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsLamVariant
</span><a href="Language.Haskell.Syntax.Expr.html#LamSingle"><span class="hs-identifier hs-var">LamSingle</span></a></span><span>
</span><span id="line-813"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#MG"><span class="hs-identifier hs-type">MG</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mg_alts :: XRec GhcTc [LMatch GhcTc (LocatedA (HsExpr GhcTc))]
</span><a href="Language.Haskell.Syntax.Expr.html#mg_alts"><span class="hs-identifier hs-var">mg_alts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LMatch GhcTc (LocatedA (HsExpr GhcTc))]
-&gt; GenLocated SrcSpanAnnLW [LMatch GhcTc (LocatedA (HsExpr GhcTc))]
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HsMatchContext (LIdP (NoGhcTc GhcTc))
-&gt; LocatedE [LPat GhcTc]
-&gt; LocatedA (HsExpr GhcTc)
-&gt; LMatch GhcTc (LocatedA (HsExpr GhcTc))
forall (p :: Pass) (body :: * -&gt; *).
(Anno (Match (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ SrcSpanAnnA,
 Anno (GRHS (GhcPass p) (LocatedA (body (GhcPass p))))
 ~ EpAnn NoEpAnns) =&gt;
HsMatchContext (LIdP (NoGhcTc (GhcPass p)))
-&gt; LocatedE [LPat (GhcPass p)]
-&gt; LocatedA (body (GhcPass p))
-&gt; LMatch (GhcPass p) (LocatedA (body (GhcPass p)))
</span><a href="GHC.Hs.Utils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a></span><span>
</span><span id="line-814"></span><span>                                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLamVariant -&gt; HsMatchContext (GenLocated SrcSpanAnnN Name)
forall fn. HsLamVariant -&gt; HsMatchContext fn
</span><a href="Language.Haskell.Syntax.Expr.html#LamAlt"><span class="hs-identifier hs-var">LamAlt</span></a></span><span> </span><span class="annot"><span class="annottext">HsLamVariant
</span><a href="Language.Haskell.Syntax.Expr.html#LamSingle"><span class="hs-identifier hs-var">LamSingle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Pat GhcTc)]
-&gt; GenLocated EpaLocation [GenLocated SrcSpanAnnA (Pat GhcTc)]
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142174"><span class="hs-identifier hs-var">mfix_pat</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142175"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-816"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mg_ext :: XMG GhcTc (LocatedA (HsExpr GhcTc))
</span><a href="Language.Haskell.Syntax.Expr.html#mg_ext"><span class="hs-identifier hs-var">mg_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XMG GhcTc (LocatedA (HsExpr GhcTc))
MatchGroupTc
</span><a href="#local-6989586621683142164"><span class="hs-identifier hs-var">match_group</span></a></span><span>
</span><span id="line-817"></span><span>                               </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>        </span><span id="local-6989586621683142174"><span class="annot"><span class="annottext">mfix_pat :: GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142174"><span class="hs-identifier hs-var hs-var">mfix_pat</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc))
-&gt; Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XLazyPat GhcTc -&gt; LPat GhcTc -&gt; Pat GhcTc
forall p. XLazyPat p -&gt; LPat p -&gt; Pat p
</span><a href="Language.Haskell.Syntax.Pat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a></span><span> </span><span class="annot"><span class="annottext">XLazyPat GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">(LPat GhcTc -&gt; Pat GhcTc) -&gt; LPat GhcTc -&gt; Pat GhcTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[LPat GhcTc] -&gt; LPat GhcTc
</span><a href="GHC.HsToCore.Utils.html#mkBigLHsPatTupId"><span class="hs-identifier hs-var">mkBigLHsPatTupId</span></a></span><span> </span><span class="annot"><span class="annottext">[LPat GhcTc]
[GenLocated SrcSpanAnnA (Pat GhcTc)]
</span><a href="#local-6989586621683142158"><span class="hs-identifier hs-var">rec_tup_pats</span></a></span><span>
</span><span id="line-819"></span><span>        </span><span id="local-6989586621683142175"><span class="annot"><span class="annottext">body :: LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142175"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc))
-&gt; HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
-&gt; HsDoFlavour -&gt; XRec GhcTc [ExprLStmt GhcTc] -&gt; HsExpr GhcTc
forall p. XDo p -&gt; HsDoFlavour -&gt; XRec p [ExprLStmt p] -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-var">HsDo</span></a></span><span> </span><span class="annot"><span class="annottext">XDo GhcTc
Type
</span><a href="#local-6989586621683142146"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-820"></span><span>                                </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683142083"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; GenLocated
     SrcSpanAnnLW
     [GenLocated
        SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142128"><span class="hs-identifier hs-var">rec_stmts</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenLocated
  SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
</span><a href="#local-6989586621683142179"><span class="hs-identifier hs-var">ret_stmt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>        </span><span id="local-6989586621683142180"><span class="annot"><span class="annottext">ret_app :: LHsExpr GhcTc
</span><a href="#local-6989586621683142180"><span class="hs-identifier hs-var hs-var">ret_app</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExprTc -&gt; [LHsExpr GhcTc] -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#nlHsSyntaxApps"><span class="hs-identifier hs-var">nlHsSyntaxApps</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
SyntaxExprTc
</span><a href="#local-6989586621683142134"><span class="hs-identifier hs-var">return_op</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[LHsExpr GhcTc] -&gt; LHsExpr GhcTc
</span><a href="GHC.HsToCore.Utils.html#mkBigLHsTupId"><span class="hs-identifier hs-var">mkBigLHsTupId</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsExpr GhcTc]
[LocatedA (HsExpr GhcTc)]
</span><a href="#local-6989586621683142160"><span class="hs-identifier hs-var">rets</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-822"></span><span>        </span><span id="local-6989586621683142179"><span class="annot"><span class="annottext">ret_stmt :: GenLocated
  SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
</span><a href="#local-6989586621683142179"><span class="hs-identifier hs-var hs-var">ret_stmt</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
 -&gt; GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))))
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
forall (idR :: Pass) (bodyR :: * -&gt; *) (idL :: Pass).
IsPass idR =&gt;
LocatedA (bodyR (GhcPass idR))
-&gt; StmtLR
     (GhcPass idL) (GhcPass idR) (LocatedA (bodyR (GhcPass idR)))
</span><a href="GHC.Hs.Utils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
LocatedA (HsExpr GhcTc)
</span><a href="#local-6989586621683142180"><span class="hs-identifier hs-var">ret_app</span></a></span><span>
</span><span id="line-823"></span><span>                     </span><span class="hs-comment">-- This LastStmt will be desugared with dsDo,</span><span>
</span><span id="line-824"></span><span>                     </span><span class="hs-comment">-- which ignores the return_op in the LastStmt,</span><span>
</span><span id="line-825"></span><span>                     </span><span class="hs-comment">-- so we must apply the return_op explicitly</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XStmtLR"><span class="hs-identifier hs-type">XStmtLR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeStmt"><span class="hs-identifier hs-type">ApplicativeStmt</span></a></span><span> </span><span id="local-6989586621683142185"><span class="annot"><span class="annottext">XApplicativeStmt GhcTc GhcTc
</span><a href="#local-6989586621683142185"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span> </span><span id="local-6989586621683142186"><span class="annot"><span class="annottext">[(SyntaxExpr GhcTc, ApplicativeArg GhcTc)]
</span><a href="#local-6989586621683142186"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621683142187"><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683142187"><span class="hs-identifier hs-var">mb_join</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142188"><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142188"><span class="hs-identifier hs-var">stmts</span></a></span></span><span>
</span><span id="line-828"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-829"></span><span>             </span><span class="hs-keyword">let</span><span>
</span><span id="line-830"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683142189"><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc)]
</span><a href="#local-6989586621683142189"><span class="hs-identifier hs-var hs-var">pats</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142190"><span class="annot"><span class="annottext">[DsM CoreExpr]
</span><a href="#local-6989586621683142190"><span class="hs-identifier hs-var hs-var">rhss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
  DsM CoreExpr)]
-&gt; ([(GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc)],
    [DsM CoreExpr])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SyntaxExprTc, ApplicativeArg GhcTc)
 -&gt; ((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
     DsM CoreExpr))
-&gt; [(SyntaxExprTc, ApplicativeArg GhcTc)]
-&gt; [((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
     DsM CoreExpr)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicativeArg GhcTc
-&gt; ((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
    DsM CoreExpr)
</span><a href="#local-6989586621683142192"><span class="hs-identifier hs-var">do_arg</span></a></span><span> </span><span class="annot"><span class="annottext">(ApplicativeArg GhcTc
 -&gt; ((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
     DsM CoreExpr))
-&gt; ((SyntaxExprTc, ApplicativeArg GhcTc) -&gt; ApplicativeArg GhcTc)
-&gt; (SyntaxExprTc, ApplicativeArg GhcTc)
-&gt; ((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
    DsM CoreExpr)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SyntaxExprTc, ApplicativeArg GhcTc) -&gt; ApplicativeArg GhcTc
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(SyntaxExpr GhcTc, ApplicativeArg GhcTc)]
[(SyntaxExprTc, ApplicativeArg GhcTc)]
</span><a href="#local-6989586621683142186"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span>               </span><span id="local-6989586621683142192"><span class="annot"><span class="annottext">do_arg :: ApplicativeArg GhcTc
-&gt; ((GenLocated SrcSpanAnnA (Pat GhcTc), Maybe SyntaxExprTc),
    DsM CoreExpr)
</span><a href="#local-6989586621683142192"><span class="hs-identifier hs-var hs-var hs-var">do_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeArgOne"><span class="hs-identifier hs-type">ApplicativeArgOne</span></a></span><span> </span><span id="local-6989586621683142195"><span class="annot"><span class="annottext">XApplicativeArgOne GhcTc
</span><a href="#local-6989586621683142195"><span class="hs-identifier hs-var">fail_op</span></a></span></span><span> </span><span id="local-6989586621683142196"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683142196"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621683142197"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142197"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-833"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcTc
GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142196"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe SyntaxExprTc
XApplicativeArgOne GhcTc
</span><a href="#local-6989586621683142195"><span class="hs-identifier hs-var">fail_op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-var">dsLExpr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142197"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>               </span><span class="annot"><a href="#local-6989586621683142192"><span class="hs-identifier hs-var">do_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ApplicativeArgMany"><span class="hs-identifier hs-type">ApplicativeArgMany</span></a></span><span> </span><span class="annot"><span class="annottext">XApplicativeArgMany GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142199"><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
</span><a href="#local-6989586621683142199"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span id="local-6989586621683142200"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142200"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span id="local-6989586621683142201"><span class="annot"><span class="annottext">LPat GhcTc
</span><a href="#local-6989586621683142201"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-835"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPat GhcTc
GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142201"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe SyntaxExprTc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HsDoFlavour -&gt; [ExprLStmt GhcTc] -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsDo"><span class="hs-identifier hs-var">dsDo</span></a></span><span> </span><span class="annot"><span class="annottext">HsDoFlavour
</span><a href="#local-6989586621683142083"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExprLStmt GhcTc]
[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><a href="#local-6989586621683142199"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
-&gt; [GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
 -&gt; GenLocated
      SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))))
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
-&gt; GenLocated
     SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocatedA (HsExpr GhcTc)
-&gt; StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc))
forall (idR :: Pass) (bodyR :: * -&gt; *) (idL :: Pass).
IsPass idR =&gt;
LocatedA (bodyR (GhcPass idR))
-&gt; StmtLR
     (GhcPass idL) (GhcPass idR) (LocatedA (bodyR (GhcPass idR)))
</span><a href="GHC.Hs.Utils.html#mkLastStmt"><span class="hs-identifier hs-var">mkLastStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142200"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142085"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142202"><span class="annot"><a href="#local-6989586621683142202"><span class="hs-identifier hs-var">rhss'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DsM CoreExpr] -&gt; IOEnv (Env DsGblEnv DsLclEnv) [CoreExpr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[DsM CoreExpr]
</span><a href="#local-6989586621683142190"><span class="hs-identifier hs-var">rhss</span></a></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142204"><span class="annot"><a href="#local-6989586621683142204"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsLExpr"><span class="hs-identifier hs-type">dsLExpr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-type">noLocA</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDo"><span class="hs-identifier hs-type">HsDo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142185"><span class="hs-identifier hs-type">body_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142083"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-type">noLocA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142188"><span class="hs-identifier hs-type">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142205"><span class="annot"><a href="#local-6989586621683142205"><span class="hs-identifier hs-var hs-var">match_args</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142206"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142206"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142207"><span class="annot"><span class="annottext">Maybe SyntaxExprTc
</span><a href="#local-6989586621683142207"><span class="hs-identifier hs-var">fail_op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142208"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683142208"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683142209"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142209"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; DsM ([Id], CoreExpr) -&gt; DsM ([Id], CoreExpr)
forall a. SrcSpan -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142206"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM ([Id], CoreExpr) -&gt; DsM ([Id], CoreExpr))
-&gt; DsM ([Id], CoreExpr) -&gt; DsM ([Id], CoreExpr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-843"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142210"><span class="annot"><a href="#local-6989586621683142210"><span class="hs-identifier hs-var">var</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; LPat GhcTc -&gt; DsM Id
</span><a href="GHC.HsToCore.Utils.html#selectSimpleMatchVarL"><span class="hs-identifier hs-var">selectSimpleMatchVarL</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683142206"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-844"></span><span>                        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142211"><span class="annot"><a href="#local-6989586621683142211"><span class="hs-identifier hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#matchSinglePatVar"><span class="hs-identifier hs-type">matchSinglePatVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142210"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#StmtCtxt"><span class="hs-identifier hs-type">StmtCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsDoStmt"><span class="hs-identifier hs-type">HsDoStmt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142083"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142206"><span class="hs-identifier hs-type">pat</span></a></span><span>
</span><span id="line-845"></span><span>                                   </span><span class="annot"><a href="#local-6989586621683142185"><span class="hs-identifier hs-type">body_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#cantFailMatchResult"><span class="hs-identifier hs-type">cantFailMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142209"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>                        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142212"><span class="annot"><a href="#local-6989586621683142212"><span class="hs-identifier hs-var">match_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#dsHandleMonadicFailure"><span class="hs-identifier hs-type">dsHandleMonadicFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142083"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142206"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142185"><span class="hs-identifier hs-type">body_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142211"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142207"><span class="hs-identifier hs-type">fail_op</span></a></span><span>
</span><span id="line-847"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683142210"><span class="hs-identifier hs-type">var</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621683142208"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142212"><span class="hs-identifier hs-type">match_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142213"><span class="annot"><a href="#local-6989586621683142213"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142214"><span class="annot"><a href="#local-6989586621683142214"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldrM</span></span><span> </span><span class="annot"><a href="#local-6989586621683142205"><span class="hs-identifier hs-type">match_args</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621683142204"><span class="hs-identifier hs-type">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142189"><span class="hs-identifier hs-type">pats</span></a></span><span>
</span><span id="line-851"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142215"><span class="annot"><a href="#local-6989586621683142215"><span class="hs-identifier hs-var hs-var">fun'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; CoreExpr -&gt; CoreExpr
forall b. [b] -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683142213"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142214"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-852"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142217"><span class="annot"><a href="#local-6989586621683142217"><span class="hs-identifier hs-var hs-var">mk_ap_call</span></a></span></span><span> </span><span id="local-6989586621683142218"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142218"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142219"><span class="annot"><span class="annottext">SyntaxExprTc
</span><a href="#local-6989586621683142219"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683142220"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142220"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc -&gt; [CoreExpr] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-var">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
SyntaxExprTc
</span><a href="#local-6989586621683142219"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142218"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142220"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-853"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142221"><span class="annot"><a href="#local-6989586621683142221"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldlM</span></span><span> </span><span class="annot"><a href="#local-6989586621683142217"><span class="hs-identifier hs-type">mk_ap_call</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142215"><span class="hs-identifier hs-type">fun'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621683142186"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683142202"><span class="hs-identifier hs-type">rhss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683142187"><span class="hs-identifier hs-type">mb_join</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-855"></span><span>               </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142221"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-856"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683142222"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142222"><span class="hs-identifier hs-var">join_op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc -&gt; [CoreExpr] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-var">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683142222"><span class="hs-identifier hs-var">join_op</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142221"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ParStmt"><span class="hs-identifier hs-type">ParStmt</span></a></span><span>   </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsDo ParStmt&quot;</span></span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><a href="#local-6989586621683142090"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#TransStmt"><span class="hs-identifier hs-type">TransStmt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated
   SrcSpanAnnA (StmtLR GhcTc GhcTc (LocatedA (HsExpr GhcTc)))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsDo TransStmt&quot;</span></span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="hs-comment">{- Note [Long-distance information in do notation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider T21360:

  data Foo = A Int | B

  swooble :: Foo -&gt; Maybe Foo
  swooble foo = do
    bar@A{} &lt;- Just foo
    return $ case bar of { A _ -&gt; A 9 }

The pattern-match checker **should not** complain that the case statement
is incomplete, because we know that 'bar' is headed by the constructor 'A',
due to the pattern match in the line above. However, we need to ensure that we
propagate this long-distance information; failing to do so lead to #21360.

To do this, we use &quot;matchSinglePatVar&quot; to handle the first pattern match

  bar@A{} &lt;- Just foo

&quot;matchSinglePatVar&quot; then threads through the long-distance information to the
desugaring of the remaining statements by using updPmNablasMatchResult.
This avoids any spurious pattern-match warnings when handling the case
statement on the last line.

Other places that requires from the same treatment:

  - monad comprehensions, e.g.

     blorble :: Foo -&gt; Maybe Foo
     blorble foo = [ case bar of { A _ -&gt; A 9 } | bar@A{} &lt;- Just foo ]

     See GHC.HsToCore.ListComp.dsMcBindStmt. Also tested in T21360.

  - guards, e.g.

      giddy :: Maybe Char -&gt; Char
      giddy x
        | y@(Just _) &lt;- x
        , let z = case y of { Just w -&gt; w }
        = z

    We don't want any inexhaustive pattern match warnings for the case statement,
    because we already know 'y' is of the form &quot;Just ...&quot;.
    See test case T21360b.

************************************************************************
*                                                                      *
   Desugaring Variables
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsHsVar"><span class="hs-identifier hs-type">dsHsVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-915"></span><span class="hs-comment">-- We could just call dsHsUnwrapped; but this is a short-cut</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- for the very common case of a variable with no wrapper.</span><span>
</span><span id="line-917"></span><span id="dsHsVar"><span class="annot"><span class="annottext">dsHsVar :: Id -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsVar"><span class="hs-identifier hs-var hs-var">dsHsVar</span></a></span></span><span> </span><span id="local-6989586621683142225"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142225"><span class="hs-identifier hs-var">var</span></a></span></span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#varToCoreExpr"><span class="hs-identifier hs-var">varToCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142225"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- See Note [Desugaring vars]</span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsHsConLike"><span class="hs-identifier hs-type">dsHsConLike</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-921"></span><span id="dsHsConLike"><span class="annot"><span class="annottext">dsHsConLike :: ConLike -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsConLike"><span class="hs-identifier hs-var hs-var">dsHsConLike</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621683142229"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683142229"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#varToCoreExpr"><span class="hs-identifier hs-var">varToCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Id
</span><a href="GHC.Core.DataCon.html#dataConWrapId"><span class="hs-identifier hs-var">dataConWrapId</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683142229"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsHsConLike"><span class="hs-identifier hs-var">dsHsConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621683142232"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683142232"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142233"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683142233"><span class="hs-identifier hs-var">builder_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142234"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683142234"><span class="hs-identifier hs-var">add_void</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; Maybe (Name, Type, Bool)
</span><a href="GHC.Core.PatSyn.html#patSynBuilder"><span class="hs-identifier hs-var">patSynBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683142232"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-925"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142236"><span class="annot"><a href="#local-6989586621683142236"><span class="hs-identifier hs-var">builder_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DsM Id
</span><a href="GHC.HsToCore.Monad.html#dsLookupGlobalId"><span class="hs-identifier hs-var">dsLookupGlobalId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683142233"><span class="hs-identifier hs-var">builder_name</span></a></span><span>
</span><span id="line-926"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683142234"><span class="hs-identifier hs-type">add_void</span></a></span><span>
</span><span id="line-927"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApp"><span class="hs-identifier hs-type">mkCoreApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;dsConLike&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142232"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142236"><span class="hs-identifier hs-type">builder_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier hs-type">unboxedUnitExpr</span></a></span><span>
</span><span id="line-929"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142236"><span class="hs-identifier hs-type">builder_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-930"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; DsM CoreExpr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsConLike&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatSyn -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683142232"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="hs-comment">-- | This function desugars 'ConLikeTc': it eta-expands</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- data constructors to make linear types work.</span><span>
</span><span id="line-935"></span><span class="hs-comment">--</span><span>
</span><span id="line-936"></span><span class="hs-comment">-- See Note [Typechecking data constructors] in GHC.Tc.Gen.Head</span><span>
</span><span id="line-937"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsConLike"><span class="hs-identifier hs-type">dsConLike</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-938"></span><span id="dsConLike"><span class="annot"><span class="annottext">dsConLike :: ConLike -&gt; [Id] -&gt; [Scaled Type] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsConLike"><span class="hs-identifier hs-var hs-var">dsConLike</span></a></span></span><span> </span><span id="local-6989586621683142240"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683142240"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683142241"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683142241"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621683142242"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621683142242"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-939"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142243"><span class="annot"><a href="#local-6989586621683142243"><span class="hs-identifier hs-var">ds_con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConLike -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsConLike"><span class="hs-identifier hs-var">dsHsConLike</span></a></span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621683142240"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-940"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142244"><span class="annot"><a href="#local-6989586621683142244"><span class="hs-identifier hs-var">ids</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#newSysLocalsDs"><span class="hs-identifier hs-type">newSysLocalsDs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142242"><span class="hs-identifier hs-type">tys</span></a></span><span>
</span><span id="line-941"></span><span>           </span><span class="hs-comment">-- NB: these 'Id's may be representation-polymorphic;</span><span>
</span><span id="line-942"></span><span>           </span><span class="hs-comment">-- see Wrinkle [Representation-polymorphic lambda] in</span><span>
</span><span id="line-943"></span><span>           </span><span class="hs-comment">-- Note [Typechecking data constructors] in GHC.Tc.Gen.Head.</span><span>
</span><span id="line-944"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-type">mkLams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142241"><span class="hs-identifier hs-type">tvs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-945"></span><span>                 </span><span class="annot"><a href="GHC.Core.html#mkLams"><span class="hs-identifier hs-type">mkLams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142244"><span class="hs-identifier hs-type">ids</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-946"></span><span>                 </span><span class="annot"><a href="#local-6989586621683142243"><span class="hs-identifier hs-type">ds_con</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#mkTyApps"><span class="hs-operator hs-type">`mkTyApps`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-type">mkTyVarTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142241"><span class="hs-identifier hs-type">tvs</span></a></span><span>
</span><span id="line-947"></span><span>                        </span><span class="annot"><a href="GHC.Core.html#mkVarApps"><span class="hs-operator hs-type">`mkVarApps`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142244"><span class="hs-identifier hs-type">ids</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Errors and contexts}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span class="hs-comment">-- Warn about certain types of values discarded in monadic bindings (#3263)</span><span>
</span><span id="line-958"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#warnUnusedBindValue"><span class="hs-identifier hs-type">warnUnusedBindValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span id="warnUnusedBindValue"><span class="annot"><span class="annottext">warnUnusedBindValue :: LHsExpr GhcTc
-&gt; LHsExpr GhcTc -&gt; Type -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Expr.html#warnUnusedBindValue"><span class="hs-identifier hs-var hs-var">warnUnusedBindValue</span></a></span></span><span> </span><span id="local-6989586621683142249"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142249"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621683142250"><span class="annot"><span class="annottext">arg :: LHsExpr GhcTc
</span><a href="#local-6989586621683142250"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683142251"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142251"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683142252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142252"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142253"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683142253"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142254"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142254"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (SrcSpan, Id)
</span><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142249"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-961"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142254"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#thenMClassOpKey"><span class="hs-identifier hs-var">thenMClassOpKey</span></a></span><span>    </span><span class="hs-comment">-- it is a (&gt;&gt;)</span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; Bool
</span><a href="GHC.Types.SrcLoc.html#isGeneratedSrcSpan"><span class="hs-identifier hs-var">isGeneratedSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683142253"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env DsGblEnv DsLclEnv) ()
 -&gt; IOEnv (Env DsGblEnv DsLclEnv) ())
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- it is compiler generated (&gt;&gt;)</span><span>
</span><span id="line-963"></span><span>         </span><span class="annot"><span class="annottext">SrcSpan
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a. SrcSpan -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Monad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142251"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IOEnv (Env DsGblEnv DsLclEnv) ()
 -&gt; IOEnv (Env DsGblEnv DsLclEnv) ())
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
-&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Type -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Expr.html#warnDiscardedDoBindings"><span class="hs-identifier hs-var">warnDiscardedDoBindings</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142250"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142252"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-965"></span><span>    </span><span class="hs-comment">-- Retrieve the location info and the head of the application</span><span>
</span><span id="line-966"></span><span>    </span><span class="hs-comment">-- It is important that we /do not/ look through HsApp to avoid</span><span>
</span><span id="line-967"></span><span>    </span><span class="hs-comment">-- generating duplicate warnings</span><span>
</span><span id="line-968"></span><span>    </span><span class="hs-comment">-- See Part 2. of Note [Expanding HsDo with XXExprGhcRn]</span><span>
</span><span id="line-969"></span><span>    </span><span class="annot"><a href="#local-6989586621683142255"><span class="hs-identifier hs-type">fish_var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>    </span><span id="local-6989586621683142255"><span class="annot"><span class="annottext">fish_var :: LHsExpr GhcTc -&gt; Maybe (SrcSpan, Id)
</span><a href="#local-6989586621683142255"><span class="hs-identifier hs-var hs-var">fish_var</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683142259"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142259"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142260"><span class="annot"><span class="annottext">LIdP GhcTc
</span><a href="#local-6989586621683142260"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SrcSpan, Id) -&gt; Maybe (SrcSpan, Id)
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142259"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Id -&gt; Id
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcTc
GenLocated SrcSpanAnnN Id
</span><a href="#local-6989586621683142260"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>    </span><span class="annot"><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142261"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142261"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (SrcSpan, Id)
</span><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142261"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-972"></span><span>    </span><span class="annot"><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683142262"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142262"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#WrapExpr"><span class="hs-identifier hs-type">WrapExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142263"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142263"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142264"><span class="annot"><a href="#local-6989586621683142264"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142265"><span class="annot"><a href="#local-6989586621683142265"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (SrcSpan, Id)
</span><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142262"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142263"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>                                               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683142264"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683142265"><span class="hs-identifier hs-type">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>    </span><span class="annot"><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683142266"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142266"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#ExpandedThingTc"><span class="hs-identifier hs-type">ExpandedThingTc</span></a></span><span> </span><span class="annot"><span class="annottext">HsThingRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142267"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142267"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (SrcSpan, Id)
</span><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; HsExpr GhcTc -&gt; LocatedA (HsExpr GhcTc)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683142266"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142267"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><a href="#local-6989586621683142255"><span class="hs-identifier hs-var">fish_var</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, Id)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#warnUnusedBindValue"><span class="hs-identifier hs-var">warnUnusedBindValue</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span class="hs-comment">-- Warn about certain types of values discarded in monadic bindings (#3263)</span><span>
</span><span id="line-980"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#warnDiscardedDoBindings"><span class="hs-identifier hs-type">warnDiscardedDoBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span id="warnDiscardedDoBindings"><span class="annot"><span class="annottext">warnDiscardedDoBindings :: LHsExpr GhcTc -&gt; Type -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Expr.html#warnDiscardedDoBindings"><span class="hs-identifier hs-var hs-var">warnDiscardedDoBindings</span></a></span></span><span> </span><span id="local-6989586621683142268"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142268"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621683142269"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142269"><span class="hs-identifier hs-var">rhs_ty</span></a></span></span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142270"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142270"><span class="hs-identifier hs-var">m_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683142271"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142271"><span class="hs-identifier hs-var">elt_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (Type, Type)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-var">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142269"><span class="hs-identifier hs-var">rhs_ty</span></a></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142273"><span class="annot"><a href="#local-6989586621683142273"><span class="hs-identifier hs-var">warn_unused</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; TcRnIf DsGblEnv DsLclEnv Bool
forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnUnusedDoBind"><span class="hs-identifier hs-var">Opt_WarnUnusedDoBind</span></a></span><span>
</span><span id="line-984"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142276"><span class="annot"><a href="#local-6989586621683142276"><span class="hs-identifier hs-var">warn_wrong</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-type">woptM</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_WarnWrongDoBind"><span class="hs-identifier hs-type">Opt_WarnWrongDoBind</span></a></span><span>
</span><span id="line-985"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683142273"><span class="hs-identifier hs-type">warn_unused</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621683142276"><span class="hs-identifier hs-type">warn_wrong</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-986"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142278"><span class="annot"><a href="#local-6989586621683142278"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-type">dsGetFamInstEnvs</span></a></span><span>
</span><span id="line-987"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142279"><span class="annot"><a href="#local-6989586621683142279"><span class="hs-identifier hs-var hs-var">norm_elt_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Type -&gt; Type
</span><a href="GHC.Core.FamInstEnv.html#topNormaliseType"><span class="hs-identifier hs-var">topNormaliseType</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683142278"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142271"><span class="hs-identifier hs-var">elt_ty</span></a></span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span>           </span><span class="hs-comment">-- Warn about discarding non-() things in 'monadic' binding</span><span>
</span><span id="line-990"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683142273"><span class="hs-identifier hs-type">warn_unused</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isUnitTy"><span class="hs-identifier hs-type">isUnitTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142279"><span class="hs-identifier hs-type">norm_elt_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-type">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html#DsUnusedDoBind"><span class="hs-identifier hs-type">DsUnusedDoBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142268"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142271"><span class="hs-identifier hs-type">elt_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-992"></span><span>         </span><span class="hs-keyword">else</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span>           </span><span class="hs-comment">-- Warn about discarding m a things in 'monadic' binding of the same type,</span><span>
</span><span id="line-995"></span><span>           </span><span class="hs-comment">-- but only if we didn't already warn due to Opt_WarnUnusedDoBind</span><span>
</span><span id="line-996"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621683142276"><span class="hs-identifier hs-type">warn_wrong</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-997"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#tcSplitAppTy_maybe"><span class="hs-identifier hs-type">tcSplitAppTy_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142279"><span class="hs-identifier hs-type">norm_elt_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-998"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683142282"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142282"><span class="hs-identifier hs-var">elt_m_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142270"><span class="hs-identifier hs-var">m_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Type -&gt; Type
</span><a href="GHC.Core.FamInstEnv.html#topNormaliseType"><span class="hs-identifier hs-var">topNormaliseType</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683142278"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142282"><span class="hs-identifier hs-var">elt_m_ty</span></a></span><span>
</span><span id="line-1000"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DsMessage -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Type -&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsWrongDoBind"><span class="hs-identifier hs-var">DsWrongDoBind</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683142268"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683142271"><span class="hs-identifier hs-var">elt_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span>                      </span><span class="annot"><span class="annottext">Maybe (Type, Type)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-comment">-- RHS does have type of form (m ty), which is weird</span><span>
</span><span id="line-1004"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IOEnv (Env DsGblEnv DsLclEnv) ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- but at least this warning is irrelevant</span><span>
</span><span id="line-1005"></span><span>
</span><span id="line-1006"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
            dsHsWrapped
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-1015"></span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsHsWrapped"><span class="hs-identifier hs-type">dsHsWrapped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1016"></span><span id="dsHsWrapped"><span class="annot"><span class="annottext">dsHsWrapped :: HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsHsWrapped"><span class="hs-identifier hs-var hs-var">dsHsWrapped</span></a></span></span><span> </span><span id="local-6989586621683142284"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142284"><span class="hs-identifier hs-var">orig_hs_expr</span></a></span></span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142284"><span class="hs-identifier hs-var">orig_hs_expr</span></a></span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1019"></span><span>    </span><span id="local-6989586621683142285"><span class="annot"><span class="annottext">go :: HsWrapper -&gt; HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="#local-6989586621683142285"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621683142295"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142295"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142296"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142296"><span class="hs-identifier hs-var">hs_e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142295"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142296"><span class="hs-identifier hs-var">hs_e</span></a></span><span>
</span><span id="line-1021"></span><span>    </span><span class="annot"><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683142297"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142297"><span class="hs-identifier hs-var">wrap1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#WrapExpr"><span class="hs-identifier hs-type">WrapExpr</span></a></span><span> </span><span id="local-6989586621683142298"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142298"><span class="hs-identifier hs-var">wrap2</span></a></span></span><span> </span><span id="local-6989586621683142299"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142299"><span class="hs-identifier hs-var">hs_e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142297"><span class="hs-identifier hs-var">wrap1</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142298"><span class="hs-identifier hs-var">wrap2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142299"><span class="hs-identifier hs-var">hs_e</span></a></span><span>
</span><span id="line-1023"></span><span>    </span><span class="annot"><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683142301"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142301"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span id="local-6989586621683142302"><span class="annot"><span class="annottext">XAppTypeE GhcTc
</span><a href="#local-6989586621683142302"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142303"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142303"><span class="hs-identifier hs-var">hs_e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc GhcTc)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142301"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#WpTyApp"><span class="hs-identifier hs-var">WpTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE GhcTc
Type
</span><a href="#local-6989586621683142302"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142303"><span class="hs-identifier hs-var">hs_e</span></a></span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span>    </span><span class="annot"><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683142305"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142305"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683142306"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142306"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsWrapper
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a. HsWrapper -&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM a) -&gt; DsM a
</span><a href="GHC.HsToCore.Binds.html#dsHsWrapper"><span class="hs-identifier hs-var">dsHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142305"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">(((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr)
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683142307"><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683142307"><span class="hs-identifier hs-var">wrap'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1028"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683142308"><span class="annot"><span class="annottext">expr :: CoreExpr
</span><a href="#local-6989586621683142308"><span class="hs-identifier hs-var hs-var hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683142307"><span class="hs-identifier hs-var">wrap'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#varToCoreExpr"><span class="hs-identifier hs-var">varToCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683142306"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1029"></span><span>                 </span><span id="local-6989586621683142309"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621683142309"><span class="hs-identifier hs-var hs-var hs-var">ty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; CoreExpr -&gt; Type
CoreExpr -&gt; Type
</span><a href="GHC.Core.Utils.html#exprType"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683142308"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1030"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683142310"><span class="annot"><a href="#local-6989586621683142310"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-1031"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutIdentities"><span class="hs-identifier hs-type">warnAboutIdentities</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142310"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142306"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142309"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-1032"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683142308"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>    </span><span class="annot"><a href="#local-6989586621683142285"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621683142312"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142312"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621683142313"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142313"><span class="hs-identifier hs-var">hs_e</span></a></span></span><span>
</span><span id="line-1035"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">HsWrapper
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a. HsWrapper -&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM a) -&gt; DsM a
</span><a href="GHC.HsToCore.Binds.html#dsHsWrapper"><span class="hs-identifier hs-var">dsHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142312"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">(((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr)
-&gt; ((CoreExpr -&gt; CoreExpr) -&gt; DsM CoreExpr) -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621683142314"><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621683142314"><span class="hs-identifier hs-var">wrap'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1036"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; Bag Id -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a. Origin -&gt; Bag Id -&gt; DsM a -&gt; DsM a
</span><a href="GHC.HsToCore.Pmc.html#addTyCs"><span class="hs-identifier hs-var">addTyCs</span></a></span><span> </span><span class="annot"><span class="annottext">Origin
</span><a href="GHC.Types.Basic.html#FromSource"><span class="hs-identifier hs-var">FromSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; Bag Id
</span><a href="GHC.Tc.Types.Evidence.html#hsWrapDictBinders"><span class="hs-identifier hs-var">hsWrapDictBinders</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621683142312"><span class="hs-identifier hs-var">wrap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM CoreExpr -&gt; DsM CoreExpr) -&gt; DsM CoreExpr -&gt; DsM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1037"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683142318"><span class="annot"><a href="#local-6989586621683142318"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683142313"><span class="hs-identifier hs-var">hs_e</span></a></span><span>
</span><span id="line-1038"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683142314"><span class="hs-identifier hs-type">wrap'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683142318"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1039"></span></pre></body></html>