<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | Command-line parser</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- This is an abstract command-line parser used by DynFlags.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- (c) The University of Glasgow 2005</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html"><span class="hs-identifier">GHC.Driver.CmdLine</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#processArgs"><span class="hs-identifier">processArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#parseResponseFile"><span class="hs-identifier">parseResponseFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier">OptKind</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#GhcFlagMode"><span class="hs-identifier">GhcFlagMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier">Flag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#defFlag"><span class="hs-identifier">defFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#defGhcFlag"><span class="hs-identifier">defGhcFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#defGhciFlag"><span class="hs-identifier">defGhciFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#defHiddenFlag"><span class="hs-identifier">defHiddenFlag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#hoistFlag"><span class="hs-identifier">hoistFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#errorsToGhcException"><span class="hs-identifier">errorsToGhcException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier">Err</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier">Warn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#warnsToMessages"><span class="hs-identifier">warnsToMessages</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier">EwM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#runEwM"><span class="hs-identifier">runEwM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#addErr"><span class="hs-identifier">addErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#addWarn"><span class="hs-identifier">addWarn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#addFlagWarn"><span class="hs-identifier">addFlagWarn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#getArg"><span class="hs-identifier">getArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#getCurLoc"><span class="hs-identifier">getCurLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#liftEwM"><span class="hs-identifier">liftEwM</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html"><span class="hs-identifier">GHC.Driver.Errors.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Ppr.html"><span class="hs-identifier">GHC.Driver.Errors.Ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- instance Diagnostic DriverMessage</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier">text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stripPrefix</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ResponseFile.html"><span class="hs-identifier">GHC.ResponseFile</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IOException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ap</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.IO.Class.html"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-47"></span><span class="hs-comment">--         The Flag and OptKind types</span><span>
</span><span id="line-48"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="Flag"><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span></span><span> </span><span id="local-6989586621682927108"><span class="annot"><a href="#local-6989586621682927108"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Flag"><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">{</span><span>   </span><span id="flagName"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Flag m -&gt; String
</span><a href="GHC.Driver.CmdLine.html#flagName"><span class="hs-identifier hs-var hs-var">flagName</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Flag, without the leading &quot;-&quot;</span><span>
</span><span id="line-52"></span><span>        </span><span id="flagOptKind"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Flag m -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#flagOptKind"><span class="hs-identifier hs-var hs-var">flagOptKind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927108"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- What to do if we see it</span><span>
</span><span id="line-53"></span><span>        </span><span id="flagGhcMode"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Flag m -&gt; GhcFlagMode
</span><a href="GHC.Driver.CmdLine.html#flagGhcMode"><span class="hs-identifier hs-var hs-var">flagGhcMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#GhcFlagMode"><span class="hs-identifier hs-type">GhcFlagMode</span></a></span><span>    </span><span class="hs-comment">-- Which modes this flag affects</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span id="local-6989586621682927115"><span class="annot"><a href="GHC.Driver.CmdLine.html#defFlag"><span class="hs-identifier hs-type">defFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927115"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-57"></span><span id="defFlag"><span class="annot"><span class="annottext">defFlag :: forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#defFlag"><span class="hs-identifier hs-var hs-var">defFlag</span></a></span></span><span> </span><span id="local-6989586621682927318"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927318"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682927319"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927319"><span class="hs-identifier hs-var">optKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927318"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927319"><span class="hs-identifier hs-var">optKind</span></a></span><span> </span><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="GHC.Driver.CmdLine.html#AllModes"><span class="hs-identifier hs-var">AllModes</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621682927321"><span class="annot"><a href="GHC.Driver.CmdLine.html#defGhcFlag"><span class="hs-identifier hs-type">defGhcFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927321"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927321"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-60"></span><span id="defGhcFlag"><span class="annot"><span class="annottext">defGhcFlag :: forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#defGhcFlag"><span class="hs-identifier hs-var hs-var">defGhcFlag</span></a></span></span><span> </span><span id="local-6989586621682927322"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927322"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682927323"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927323"><span class="hs-identifier hs-var">optKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927322"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927323"><span class="hs-identifier hs-var">optKind</span></a></span><span> </span><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="GHC.Driver.CmdLine.html#OnlyGhc"><span class="hs-identifier hs-var">OnlyGhc</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span id="local-6989586621682927325"><span class="annot"><a href="GHC.Driver.CmdLine.html#defGhciFlag"><span class="hs-identifier hs-type">defGhciFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927325"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-63"></span><span id="defGhciFlag"><span class="annot"><span class="annottext">defGhciFlag :: forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#defGhciFlag"><span class="hs-identifier hs-var hs-var">defGhciFlag</span></a></span></span><span> </span><span id="local-6989586621682927326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927326"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682927327"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927327"><span class="hs-identifier hs-var">optKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927326"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927327"><span class="hs-identifier hs-var">optKind</span></a></span><span> </span><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="GHC.Driver.CmdLine.html#OnlyGhci"><span class="hs-identifier hs-var">OnlyGhci</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621682927329"><span class="annot"><a href="GHC.Driver.CmdLine.html#defHiddenFlag"><span class="hs-identifier hs-type">defHiddenFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927329"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927329"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-66"></span><span id="defHiddenFlag"><span class="annot"><span class="annottext">defHiddenFlag :: forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#defHiddenFlag"><span class="hs-identifier hs-var hs-var">defHiddenFlag</span></a></span></span><span> </span><span id="local-6989586621682927330"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927330"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682927331"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927331"><span class="hs-identifier hs-var">optKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927330"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927331"><span class="hs-identifier hs-var">optKind</span></a></span><span> </span><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="GHC.Driver.CmdLine.html#HiddenFlag"><span class="hs-identifier hs-var">HiddenFlag</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#hoistFlag"><span class="hs-identifier hs-type">hoistFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682927120"><span class="annot"><a href="#local-6989586621682927120"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682927122"><span class="annot"><a href="#local-6989586621682927122"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682927121"><span class="annot"><a href="#local-6989586621682927121"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621682927120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927121"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682927122"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927121"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927122"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-69"></span><span id="hoistFlag"><span class="annot"><span class="annottext">hoistFlag :: forall (m :: * -&gt; *) (n :: * -&gt; *).
(forall a. m a -&gt; n a) -&gt; Flag m -&gt; Flag n
</span><a href="GHC.Driver.CmdLine.html#hoistFlag"><span class="hs-identifier hs-var hs-var">hoistFlag</span></a></span></span><span> </span><span id="local-6989586621682927333"><span class="annot"><span class="annottext">forall a. m a -&gt; n a
</span><a href="#local-6989586621682927333"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span id="local-6989586621682927334"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927334"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682927335"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927335"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682927336"><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="#local-6989586621682927336"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptKind n -&gt; GhcFlagMode -&gt; Flag n
forall (m :: * -&gt; *). String -&gt; OptKind m -&gt; GhcFlagMode -&gt; Flag m
</span><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927334"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OptKind m -&gt; OptKind n
</span><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927335"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GhcFlagMode
</span><a href="#local-6989586621682927336"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>      </span><span id="local-6989586621682927337"><span class="annot"><span class="annottext">go :: OptKind m -&gt; OptKind n
</span><a href="#local-6989586621682927337"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#NoArg"><span class="hs-identifier hs-type">NoArg</span></a></span><span> </span><span id="local-6989586621682927339"><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927339"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EwM n () -&gt; OptKind n
forall (m :: * -&gt; *). EwM m () -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927339"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#HasArg"><span class="hs-identifier hs-type">HasArg</span></a></span><span> </span><span id="local-6989586621682927342"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927342"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#HasArg"><span class="hs-identifier hs-var">HasArg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927343"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927343"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927342"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927343"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#SepArg"><span class="hs-identifier hs-type">SepArg</span></a></span><span> </span><span id="local-6989586621682927345"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927345"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#SepArg"><span class="hs-identifier hs-var">SepArg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927346"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927346"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927345"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span id="local-6989586621682927348"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927348"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927349"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927349"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927348"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927349"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptPrefix"><span class="hs-identifier hs-type">OptPrefix</span></a></span><span> </span><span id="local-6989586621682927351"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927351"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#OptPrefix"><span class="hs-identifier hs-var">OptPrefix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927352"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927352"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927351"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927352"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptIntSuffix"><span class="hs-identifier hs-type">OptIntSuffix</span></a></span><span> </span><span id="local-6989586621682927354"><span class="annot"><span class="annottext">Maybe Int -&gt; EwM m ()
</span><a href="#local-6989586621682927354"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (Maybe Int -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#OptIntSuffix"><span class="hs-identifier hs-var">OptIntSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927355"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621682927355"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; EwM m ()
</span><a href="#local-6989586621682927354"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621682927355"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#IntSuffix"><span class="hs-identifier hs-type">IntSuffix</span></a></span><span> </span><span id="local-6989586621682927357"><span class="annot"><span class="annottext">Int -&gt; EwM m ()
</span><a href="#local-6989586621682927357"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (Int -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#IntSuffix"><span class="hs-identifier hs-var">IntSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927358"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927358"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; EwM m ()
</span><a href="#local-6989586621682927357"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927358"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Word64Suffix"><span class="hs-identifier hs-type">Word64Suffix</span></a></span><span> </span><span id="local-6989586621682927360"><span class="annot"><span class="annottext">Word64 -&gt; EwM m ()
</span><a href="#local-6989586621682927360"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (Word64 -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#Word64Suffix"><span class="hs-identifier hs-var">Word64Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927361"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927361"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EwM m ()
</span><a href="#local-6989586621682927360"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927361"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#FloatSuffix"><span class="hs-identifier hs-type">FloatSuffix</span></a></span><span> </span><span id="local-6989586621682927363"><span class="annot"><span class="annottext">Float -&gt; EwM m ()
</span><a href="#local-6989586621682927363"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Float -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (Float -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#FloatSuffix"><span class="hs-identifier hs-var">FloatSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927364"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927364"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; EwM m ()
</span><a href="#local-6989586621682927363"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927364"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#PassFlag"><span class="hs-identifier hs-type">PassFlag</span></a></span><span> </span><span id="local-6989586621682927366"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927366"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#PassFlag"><span class="hs-identifier hs-var">PassFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927367"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927366"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927367"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><a href="#local-6989586621682927337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#AnySuffix"><span class="hs-identifier hs-type">AnySuffix</span></a></span><span> </span><span id="local-6989586621682927369"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927369"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; EwM n ()) -&gt; OptKind n
forall (m :: * -&gt; *). (String -&gt; EwM m ()) -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#AnySuffix"><span class="hs-identifier hs-var">AnySuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927370"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927370"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM n ()
forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927369"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927370"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>      </span><span id="local-6989586621682927127"><span class="annot"><a href="#local-6989586621682927340"><span class="hs-identifier hs-type">go2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927122"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927127"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621682927340"><span class="annot"><span class="annottext">go2 :: forall a. EwM m a -&gt; EwM n a
</span><a href="#local-6989586621682927340"><span class="hs-identifier hs-var hs-var">go2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span id="local-6989586621682927372"><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="#local-6989586621682927372"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; n (Errs, Warns, a)) -&gt; EwM n a
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="annot"><span class="annottext">((Located String -&gt; Errs -&gt; Warns -&gt; n (Errs, Warns, a))
 -&gt; EwM n a)
-&gt; (Located String -&gt; Errs -&gt; Warns -&gt; n (Errs, Warns, a))
-&gt; EwM n a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682927373"><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927373"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621682927374"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927374"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927375"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927375"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (Errs, Warns, a) -&gt; n (Errs, Warns, a)
forall a. m a -&gt; n a
</span><a href="#local-6989586621682927333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="#local-6989586621682927372"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927373"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927374"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927375"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | GHC flag modes describing when a flag has an effect.</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="GhcFlagMode"><span class="annot"><a href="GHC.Driver.CmdLine.html#GhcFlagMode"><span class="hs-identifier hs-var">GhcFlagMode</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="OnlyGhc"><span class="annot"><a href="GHC.Driver.CmdLine.html#OnlyGhc"><span class="hs-identifier hs-var">OnlyGhc</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The flag only affects the non-interactive GHC</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OnlyGhci"><span class="annot"><a href="GHC.Driver.CmdLine.html#OnlyGhci"><span class="hs-identifier hs-var">OnlyGhci</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The flag only affects the interactive GHC</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AllModes"><span class="annot"><a href="GHC.Driver.CmdLine.html#AllModes"><span class="hs-identifier hs-var">AllModes</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The flag affects multiple ghc modes</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HiddenFlag"><span class="annot"><a href="GHC.Driver.CmdLine.html#HiddenFlag"><span class="hs-identifier hs-var">HiddenFlag</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ This flag should not be seen in cli completion</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="OptKind"><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-var">OptKind</span></a></span></span><span> </span><span id="local-6989586621682927126"><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span></span><span>                             </span><span class="hs-comment">-- Suppose the flag is -f</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="NoArg"><span class="annot"><a href="GHC.Driver.CmdLine.html#NoArg"><span class="hs-identifier hs-var">NoArg</span></a></span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>                 </span><span class="hs-comment">-- -f all by itself</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HasArg"><span class="annot"><a href="GHC.Driver.CmdLine.html#HasArg"><span class="hs-identifier hs-var">HasArg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -farg or -f arg</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SepArg"><span class="annot"><a href="GHC.Driver.CmdLine.html#SepArg"><span class="hs-identifier hs-var">SepArg</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -f arg</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Prefix"><span class="annot"><a href="GHC.Driver.CmdLine.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -farg</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OptPrefix"><span class="annot"><a href="GHC.Driver.CmdLine.html#OptPrefix"><span class="hs-identifier hs-var">OptPrefix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -f or -farg (i.e. the arg is optional)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OptIntSuffix"><span class="annot"><a href="GHC.Driver.CmdLine.html#OptIntSuffix"><span class="hs-identifier hs-var">OptIntSuffix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- -f or -f=n; pass n to fn</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IntSuffix"><span class="annot"><a href="GHC.Driver.CmdLine.html#IntSuffix"><span class="hs-identifier hs-var">IntSuffix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- -f or -f=n; pass n to fn</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Word64Suffix"><span class="annot"><a href="GHC.Driver.CmdLine.html#Word64Suffix"><span class="hs-identifier hs-var">Word64Suffix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- -f or -f=n; pass n to fn</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="FloatSuffix"><span class="annot"><a href="GHC.Driver.CmdLine.html#FloatSuffix"><span class="hs-identifier hs-var">FloatSuffix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- -f or -f=n; pass n to fn</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PassFlag"><span class="annot"><a href="GHC.Driver.CmdLine.html#PassFlag"><span class="hs-identifier hs-var">PassFlag</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -f; pass &quot;-f&quot; fn</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AnySuffix"><span class="annot"><a href="GHC.Driver.CmdLine.html#AnySuffix"><span class="hs-identifier hs-var">AnySuffix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- -f or -farg; pass entire &quot;-farg&quot; to fn</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-108"></span><span class="hs-comment">--         The EwM monad</span><span>
</span><span id="line-109"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- | A command-line error message</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">newtype</span><span> </span><span id="Err"><span class="annot"><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier hs-var">Err</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Err"><span class="annot"><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier hs-var">Err</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="errMsg"><span class="annot"><span class="annottext">Err -&gt; Located String
</span><a href="GHC.Driver.CmdLine.html#errMsg"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | A command-line warning message and the reason it arose</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- This used to be own type, but now it's just @'MsgEnvelope' 'DriverMessage'@.</span><span>
</span><span id="line-117"></span><span class="hs-keyword">type</span><span> </span><span id="Warn"><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier hs-var">Warn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#DriverMessage"><span class="hs-identifier hs-type">DriverMessage</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">type</span><span> </span><span id="Errs"><span class="annot"><a href="GHC.Driver.CmdLine.html#Errs"><span class="hs-identifier hs-var">Errs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier hs-type">Err</span></a></span><span>
</span><span id="line-120"></span><span class="hs-keyword">type</span><span> </span><span id="Warns"><span class="annot"><a href="GHC.Driver.CmdLine.html#Warns"><span class="hs-identifier hs-var">Warns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier hs-type">Warn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- EwM (&quot;errors and warnings monad&quot;) is a monad</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- transformer for m that adds an (err, warn) state</span><span>
</span><span id="line-124"></span><span class="hs-keyword">newtype</span><span> </span><span id="EwM"><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span></span><span> </span><span id="local-6989586621682927132"><span class="annot"><a href="#local-6989586621682927132"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682927133"><span class="annot"><a href="#local-6989586621682927133"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EwM"><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unEwM"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
EwM m a -&gt; Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="GHC.Driver.CmdLine.html#unEwM"><span class="hs-identifier hs-var hs-var">unEwM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- Current parse arg</span><span>
</span><span id="line-125"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Errs"><span class="hs-identifier hs-type">Errs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warns"><span class="hs-identifier hs-type">Warns</span></a></span><span>
</span><span id="line-126"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682927132"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Errs"><span class="hs-identifier hs-type">Errs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warns"><span class="hs-identifier hs-type">Warns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682927133"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927382"><span id="local-6989586621682927385"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; EwM m a -&gt; EwM m b)
-&gt; (forall a b. a -&gt; EwM m b -&gt; EwM m a) -&gt; Functor (EwM m)
forall a b. a -&gt; EwM m b -&gt; EwM m a
forall a b. (a -&gt; b) -&gt; EwM m a -&gt; EwM m b
forall (m :: * -&gt; *) a b. Functor m =&gt; a -&gt; EwM m b -&gt; EwM m a
forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; EwM m a -&gt; EwM m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; EwM m a -&gt; EwM m b
fmap :: forall a b. (a -&gt; b) -&gt; EwM m a -&gt; EwM m b
$c&lt;$ :: forall (m :: * -&gt; *) a b. Functor m =&gt; a -&gt; EwM m b -&gt; EwM m a
&lt;$ :: forall a b. a -&gt; EwM m b -&gt; EwM m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682927161"><span id="local-6989586621682927397"><span id="local-6989586621682927401"><span id="local-6989586621682927404"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927161"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927161"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621682927411"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; EwM m a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621682927412"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682927412"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Located String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927413"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927413"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682927414"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927414"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Errs, Warns, a) -&gt; m (Errs, Warns, a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927413"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927414"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682927412"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621682927417"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. EwM m (a -&gt; b) -&gt; EwM m a -&gt; EwM m b
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EwM m (a -&gt; b) -&gt; EwM m a -&gt; EwM m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682927164"><span id="local-6989586621682927423"><span id="local-6989586621682927426"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927164"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span id="local-6989586621682927430"><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="#local-6989586621682927430"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927431"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. EwM m a -&gt; (a -&gt; EwM m b) -&gt; EwM m b
</span><span class="hs-operator hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621682927432"><span class="annot"><span class="annottext">a -&gt; EwM m b
</span><a href="#local-6989586621682927432"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, b)) -&gt; EwM m b
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682927433"><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927433"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682927434"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927434"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682927435"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927435"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927436"><span class="annot"><a href="#local-6989586621682927436"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927437"><span class="annot"><a href="#local-6989586621682927437"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927438"><span class="annot"><a href="#local-6989586621682927438"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="#local-6989586621682927430"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927433"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927434"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927435"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-135"></span><span>                                      </span><span class="annot"><a href="GHC.Driver.CmdLine.html#unEwM"><span class="hs-identifier hs-var">unEwM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682927432"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927438"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682927433"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927436"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927437"><span class="hs-identifier hs-type">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682927181"><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621682927181"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927181"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621682927449"><span class="annot"><span class="annottext">liftIO :: forall a. IO a -&gt; EwM m a
</span><a href="#local-6989586621682927449"><span class="hs-identifier hs-var hs-var hs-var">liftIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; EwM m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#liftEwM"><span class="hs-identifier hs-var">liftEwM</span></a></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; EwM m a) -&gt; (IO a -&gt; m a) -&gt; IO a -&gt; EwM m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; m a
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621682927188"><span id="local-6989586621682927189"><span class="annot"><a href="GHC.Driver.CmdLine.html#runEwM"><span class="hs-identifier hs-type">runEwM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927189"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682927188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Errs"><span class="hs-identifier hs-type">Errs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warns"><span class="hs-identifier hs-type">Warns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682927189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-140"></span><span id="runEwM"><span class="annot"><span class="annottext">runEwM :: forall (m :: * -&gt; *) a. EwM m a -&gt; m (Errs, Warns, a)
</span><a href="GHC.Driver.CmdLine.html#runEwM"><span class="hs-identifier hs-var hs-var">runEwM</span></a></span></span><span> </span><span id="local-6989586621682927456"><span class="annot"><span class="annottext">EwM m a
</span><a href="#local-6989586621682927456"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EwM m a -&gt; Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
forall (m :: * -&gt; *) a.
EwM m a -&gt; Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)
</span><a href="GHC.Driver.CmdLine.html#unEwM"><span class="hs-identifier hs-var">unEwM</span></a></span><span> </span><span class="annot"><span class="annottext">EwM m a
</span><a href="#local-6989586621682927456"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Located String
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;processArgs: no arg yet&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Errs
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Warns
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621682927198"><span class="annot"><a href="GHC.Driver.CmdLine.html#setArg"><span class="hs-identifier hs-type">setArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-143"></span><span id="setArg"><span class="annot"><span class="annottext">setArg :: forall (m :: * -&gt; *). Located String -&gt; EwM m () -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#setArg"><span class="hs-identifier hs-var hs-var">setArg</span></a></span></span><span> </span><span id="local-6989586621682927460"><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927460"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span id="local-6989586621682927461"><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, ())
</span><a href="#local-6989586621682927461"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, ()))
-&gt; EwM m ()
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Located String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927462"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927462"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927463"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927463"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, ())
</span><a href="#local-6989586621682927461"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927460"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927462"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927463"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621682927200"><span class="annot"><a href="GHC.Driver.CmdLine.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927200"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927200"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-146"></span><span id="addErr"><span class="annot"><span class="annottext">addErr :: forall (m :: * -&gt; *). Monad m =&gt; String -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addErr"><span class="hs-identifier hs-var hs-var">addErr</span></a></span></span><span> </span><span id="local-6989586621682927466"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927466"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, ()))
-&gt; EwM m ()
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682927468"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927468"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927469"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927469"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927470"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927470"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Errs, Warns, ()) -&gt; m (Errs, Warns, ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927469"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Errs -&gt; Err -&gt; Errs
forall a. Bag a -&gt; a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#snocBag"><span class="hs-operator hs-var">`snocBag`</span></a></span><span> </span><span class="annot"><span class="annottext">Located String -&gt; Err
</span><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier hs-var">Err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; String -&gt; Located String
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927468"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927466"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927470"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621682927472"><span class="annot"><a href="GHC.Driver.CmdLine.html#addWarn"><span class="hs-identifier hs-type">addWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-149"></span><span id="addWarn"><span class="annot"><span class="annottext">addWarn :: forall (m :: * -&gt; *). Monad m =&gt; String -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addWarn"><span class="hs-identifier hs-var hs-var">addWarn</span></a></span></span><span> </span><span id="local-6989586621682927482"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927482"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DriverMessage -&gt; EwM m ()
forall (m :: * -&gt; *). Monad m =&gt; DriverMessage -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addFlagWarn"><span class="hs-identifier hs-var">addFlagWarn</span></a></span><span> </span><span class="annot"><span class="annottext">(DriverMessage -&gt; EwM m ()) -&gt; DriverMessage -&gt; EwM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnknownDiagnostic (DiagnosticOpts DriverMessage) -&gt; DriverMessage
</span><a href="GHC.Driver.Errors.Types.html#DriverUnknownMessage"><span class="hs-identifier hs-var">DriverUnknownMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(UnknownDiagnostic (DiagnosticOpts DriverMessage) -&gt; DriverMessage)
-&gt; UnknownDiagnostic (DiagnosticOpts DriverMessage)
-&gt; DriverMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DiagnosticMessage
-&gt; UnknownDiagnostic (DiagnosticOpts DriverMessage)
forall a b.
(Diagnostic a, Typeable a, DiagnosticOpts a ~ NoDiagnosticOpts) =&gt;
a -&gt; UnknownDiagnostic b
</span><a href="GHC.Types.Error.html#mkSimpleUnknownDiagnostic"><span class="hs-identifier hs-var">mkSimpleUnknownDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">(DiagnosticMessage
 -&gt; UnknownDiagnostic (DiagnosticOpts DriverMessage))
-&gt; DiagnosticMessage
-&gt; UnknownDiagnostic (DiagnosticOpts DriverMessage)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">DiagnosticReason -&gt; [GhcHint] -&gt; SDoc -&gt; DiagnosticMessage
</span><a href="GHC.Types.Error.html#mkPlainDiagnostic"><span class="hs-identifier hs-var">mkPlainDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-var">WarningWithoutFlag</span></a></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><a href="GHC.Types.Error.html#noHints"><span class="hs-identifier hs-var">noHints</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; DiagnosticMessage) -&gt; SDoc -&gt; DiagnosticMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927482"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621682927216"><span class="annot"><a href="GHC.Driver.CmdLine.html#addFlagWarn"><span class="hs-identifier hs-type">addFlagWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#DriverMessage"><span class="hs-identifier hs-type">DriverMessage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-153"></span><span id="addFlagWarn"><span class="annot"><span class="annottext">addFlagWarn :: forall (m :: * -&gt; *). Monad m =&gt; DriverMessage -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addFlagWarn"><span class="hs-identifier hs-var hs-var">addFlagWarn</span></a></span></span><span> </span><span id="local-6989586621682927490"><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682927490"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, ()))
-&gt; EwM m ()
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682927491"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927491"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927492"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927492"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927493"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927493"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Errs, Warns, ()) -&gt; m (Errs, Warns, ())
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927492"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; DriverMessage -&gt; GenLocated SrcSpan DriverMessage
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927491"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682927490"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan DriverMessage -&gt; Warns -&gt; Warns
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927493"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621682927224"><span class="annot"><a href="GHC.Driver.CmdLine.html#getArg"><span class="hs-identifier hs-type">getArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-157"></span><span id="getArg"><span class="annot"><span class="annottext">getArg :: forall (m :: * -&gt; *). Monad m =&gt; EwM m String
</span><a href="GHC.Driver.CmdLine.html#getArg"><span class="hs-identifier hs-var hs-var">getArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, String))
-&gt; EwM m String
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927496"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927496"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927497"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927497"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927498"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927498"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Errs, Warns, String) -&gt; m (Errs, Warns, String)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927497"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927498"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927496"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621682927226"><span class="annot"><a href="GHC.Driver.CmdLine.html#getCurLoc"><span class="hs-identifier hs-type">getCurLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927226"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927226"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span></span><span>
</span><span id="line-160"></span><span id="getCurLoc"><span class="annot"><span class="annottext">getCurLoc :: forall (m :: * -&gt; *). Monad m =&gt; EwM m SrcSpan
</span><a href="GHC.Driver.CmdLine.html#getCurLoc"><span class="hs-identifier hs-var hs-var">getCurLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, SrcSpan))
-&gt; EwM m SrcSpan
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682927501"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927501"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927502"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927502"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927503"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927503"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Errs, Warns, SrcSpan) -&gt; m (Errs, Warns, SrcSpan)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927502"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927503"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927501"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621682927183"><span id="local-6989586621682927184"><span class="annot"><a href="GHC.Driver.CmdLine.html#liftEwM"><span class="hs-identifier hs-type">liftEwM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682927183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927184"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927184"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-163"></span><span id="liftEwM"><span class="annot"><span class="annottext">liftEwM :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#liftEwM"><span class="hs-identifier hs-var hs-var">liftEwM</span></a></span></span><span> </span><span id="local-6989586621682927507"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682927507"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
forall (m :: * -&gt; *) a.
(Located String -&gt; Errs -&gt; Warns -&gt; m (Errs, Warns, a)) -&gt; EwM m a
</span><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-var">EwM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Located String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927508"><span class="annot"><span class="annottext">Errs
</span><a href="#local-6989586621682927508"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621682927509"><span class="annot"><span class="annottext">Warns
</span><a href="#local-6989586621682927509"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682927510"><span class="annot"><a href="#local-6989586621682927510"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621682927507"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682927508"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682927509"><span class="hs-identifier hs-type">ws</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682927510"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#warnsToMessages"><span class="hs-identifier hs-type">warnsToMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#DiagOpts"><span class="hs-identifier hs-type">DiagOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier hs-type">Warn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#Messages"><span class="hs-identifier hs-type">Messages</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Errors.Types.html#DriverMessage"><span class="hs-identifier hs-type">DriverMessage</span></a></span><span>
</span><span id="line-166"></span><span id="warnsToMessages"><span class="annot"><span class="annottext">warnsToMessages :: DiagOpts -&gt; Warns -&gt; Messages DriverMessage
</span><a href="GHC.Driver.CmdLine.html#warnsToMessages"><span class="hs-identifier hs-var hs-var">warnsToMessages</span></a></span></span><span> </span><span id="local-6989586621682927511"><span class="annot"><span class="annottext">DiagOpts
</span><a href="#local-6989586621682927511"><span class="hs-identifier hs-var">diag_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpan DriverMessage
 -&gt; Messages DriverMessage -&gt; Messages DriverMessage)
-&gt; Messages DriverMessage -&gt; Warns -&gt; Messages DriverMessage
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682927513"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927513"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621682927514"><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682927514"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927515"><span class="annot"><span class="annottext">Messages DriverMessage
</span><a href="#local-6989586621682927515"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DriverMessage
-&gt; Messages DriverMessage -&gt; Messages DriverMessage
forall e. MsgEnvelope e -&gt; Messages e -&gt; Messages e
</span><a href="GHC.Types.Error.html#addMessage"><span class="hs-identifier hs-var">addMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiagOpts -&gt; SrcSpan -&gt; DriverMessage -&gt; MsgEnvelope DriverMessage
forall e. Diagnostic e =&gt; DiagOpts -&gt; SrcSpan -&gt; e -&gt; MsgEnvelope e
</span><a href="GHC.Utils.Error.html#mkPlainMsgEnvelope"><span class="hs-identifier hs-var">mkPlainMsgEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">DiagOpts
</span><a href="#local-6989586621682927511"><span class="hs-identifier hs-var">diag_opts</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682927513"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">DriverMessage
</span><a href="#local-6989586621682927514"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Messages DriverMessage
</span><a href="#local-6989586621682927515"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">Messages DriverMessage
forall e. Messages e
</span><a href="GHC.Types.Error.html#emptyMessages"><span class="hs-identifier hs-var">emptyMessages</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">--         Processing arguments</span><span>
</span><span id="line-172"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621682927239"><span class="annot"><a href="GHC.Driver.CmdLine.html#processArgs"><span class="hs-identifier hs-type">processArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621682927239"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927239"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span>               </span><span class="annot"><span class="hs-comment">-- ^ cmdline parser spec</span></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>       </span><span class="annot"><span class="hs-comment">-- ^ args</span></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927239"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ response file handler</span></span><span>
</span><span id="line-178"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682927239"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- spare args</span><span>
</span><span id="line-179"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Err"><span class="hs-identifier hs-type">Err</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- errors</span><span>
</span><span id="line-180"></span><span>                   </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warns"><span class="hs-identifier hs-type">Warns</span></a></span><span> </span><span class="hs-special">)</span></span><span> </span><span class="hs-comment">-- warnings</span><span>
</span><span id="line-181"></span><span id="processArgs"><span class="annot"><span class="annottext">processArgs :: forall (m :: * -&gt; *).
Monad m =&gt;
[Flag m]
-&gt; [Located String]
-&gt; (String -&gt; EwM m [Located String])
-&gt; m ([Located String], [Err], Warns)
</span><a href="GHC.Driver.CmdLine.html#processArgs"><span class="hs-identifier hs-var hs-var">processArgs</span></a></span></span><span> </span><span id="local-6989586621682927528"><span class="annot"><span class="annottext">[Flag m]
</span><a href="#local-6989586621682927528"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621682927529"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927529"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682927530"><span class="annot"><span class="annottext">String -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927530"><span class="hs-identifier hs-var">handleRespFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682927531"><span class="annot"><a href="#local-6989586621682927531"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927532"><span class="annot"><a href="#local-6989586621682927532"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927533"><span class="annot"><a href="#local-6989586621682927533"><span class="hs-identifier hs-var">spare</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EwM m [Located String] -&gt; m (Errs, Warns, [Located String])
forall (m :: * -&gt; *) a. EwM m a -&gt; m (Errs, Warns, a)
</span><a href="GHC.Driver.CmdLine.html#runEwM"><span class="hs-identifier hs-var">runEwM</span></a></span><span> </span><span class="annot"><span class="annottext">EwM m [Located String]
</span><a href="#local-6989586621682927534"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682927533"><span class="hs-identifier hs-type">spare</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#bagToList"><span class="hs-identifier hs-type">bagToList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927531"><span class="hs-identifier hs-type">errs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682927532"><span class="hs-identifier hs-type">warns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621682927534"><span class="annot"><span class="annottext">action :: EwM m [Located String]
</span><a href="#local-6989586621682927534"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927529"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- process :: [Located String] -&gt; [Located String] -&gt; EwM m [Located String]</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621682927536"><span class="annot"><span class="annottext">process :: [Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var hs-var">process</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682927537"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927537"><span class="hs-identifier hs-var">spare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; EwM m [Located String]
forall a. a -&gt; EwM m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927537"><span class="hs-identifier hs-var">spare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927539"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927539"><span class="hs-identifier hs-var">resp_file</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927540"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927540"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927541"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927541"><span class="hs-identifier hs-var">spare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621682927542"><span class="annot"><a href="#local-6989586621682927542"><span class="hs-identifier hs-var">resp_args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927530"><span class="hs-identifier hs-var">handleRespFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927539"><span class="hs-identifier hs-var">resp_file</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><a href="#local-6989586621682927536"><span class="hs-identifier hs-type">process</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682927542"><span class="hs-identifier hs-type">resp_args</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682927540"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682927541"><span class="hs-identifier hs-type">spare</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927543"><span class="annot"><span class="annottext">locArg :: Located String
</span><a href="#local-6989586621682927543"><span class="hs-identifier hs-var">locArg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927544"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927544"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927545"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927545"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927546"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927546"><span class="hs-identifier hs-var">spare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Flag m] -&gt; String -&gt; Maybe (String, OptKind m)
forall (m :: * -&gt; *).
[Flag m] -&gt; String -&gt; Maybe (String, OptKind m)
</span><a href="GHC.Driver.CmdLine.html#findArg"><span class="hs-identifier hs-var">findArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Flag m]
</span><a href="#local-6989586621682927528"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927544"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927548"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927548"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927549"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927549"><span class="hs-identifier hs-var">opt_kind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OptKind m
-&gt; String
-&gt; String
-&gt; [Located String]
-&gt; Either String (EwM m (), [Located String])
forall (m :: * -&gt; *).
OptKind m
-&gt; String
-&gt; String
-&gt; [Located String]
-&gt; Either String (EwM m (), [Located String])
</span><a href="GHC.Driver.CmdLine.html#processOneArg"><span class="hs-identifier hs-var">processOneArg</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927549"><span class="hs-identifier hs-var">opt_kind</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927548"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927544"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927545"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682927551"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927551"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682927552"><span class="annot"><span class="annottext">b :: EwM m [Located String]
</span><a href="#local-6989586621682927552"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927545"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927546"><span class="hs-identifier hs-var">spare</span></a></span><span>
</span><span id="line-200"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located String -&gt; EwM m () -&gt; EwM m ()
forall (m :: * -&gt; *). Located String -&gt; EwM m () -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#setArg"><span class="hs-identifier hs-var">setArg</span></a></span><span> </span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927543"><span class="hs-identifier hs-var">locArg</span></a></span><span> </span><span class="annot"><span class="annottext">(EwM m () -&gt; EwM m ()) -&gt; EwM m () -&gt; EwM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; EwM m ()
forall (m :: * -&gt; *). Monad m =&gt; String -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927551"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM m [Located String] -&gt; EwM m [Located String]
forall a b. EwM m a -&gt; EwM m b -&gt; EwM m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EwM m [Located String]
</span><a href="#local-6989586621682927552"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927553"><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927553"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682927554"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927554"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682927555"><span class="annot"><span class="annottext">b :: EwM m [Located String]
</span><a href="#local-6989586621682927555"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927554"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927546"><span class="hs-identifier hs-var">spare</span></a></span><span>
</span><span id="line-204"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located String -&gt; EwM m () -&gt; EwM m ()
forall (m :: * -&gt; *). Located String -&gt; EwM m () -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#setArg"><span class="hs-identifier hs-var">setArg</span></a></span><span> </span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927543"><span class="hs-identifier hs-var">locArg</span></a></span><span> </span><span class="annot"><span class="annottext">(EwM m () -&gt; EwM m ()) -&gt; EwM m () -&gt; EwM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927553"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM m [Located String] -&gt; EwM m [Located String]
forall a b. EwM m a -&gt; EwM m b -&gt; EwM m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EwM m [Located String]
</span><a href="#local-6989586621682927555"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">Maybe (String, OptKind m)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927545"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927543"><span class="hs-identifier hs-var">locArg</span></a></span><span> </span><span class="annot"><span class="annottext">Located String -&gt; [Located String] -&gt; [Located String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927546"><span class="hs-identifier hs-var">spare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927556"><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927556"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927557"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927557"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682927558"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927558"><span class="hs-identifier hs-var">spare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; [Located String] -&gt; EwM m [Located String]
</span><a href="#local-6989586621682927536"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927557"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located String
</span><a href="#local-6989586621682927556"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Located String -&gt; [Located String] -&gt; [Located String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927558"><span class="hs-identifier hs-var">spare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621682927245"><span class="annot"><a href="GHC.Driver.CmdLine.html#processOneArg"><span class="hs-identifier hs-type">processOneArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span id="processOneArg"><span class="annot"><span class="annottext">processOneArg :: forall (m :: * -&gt; *).
OptKind m
-&gt; String
-&gt; String
-&gt; [Located String]
-&gt; Either String (EwM m (), [Located String])
</span><a href="GHC.Driver.CmdLine.html#processOneArg"><span class="hs-identifier hs-var hs-var">processOneArg</span></a></span></span><span> </span><span id="local-6989586621682927566"><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927566"><span class="hs-identifier hs-var">opt_kind</span></a></span></span><span> </span><span id="local-6989586621682927567"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927567"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span id="local-6989586621682927568"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927568"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682927569"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682927570"><span class="annot"><span class="annottext">dash_arg :: String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var hs-var">dash_arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927568"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span id="local-6989586621682927571"><span class="annot"><span class="annottext">rest_no_eq :: String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var hs-var">rest_no_eq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="GHC.Driver.CmdLine.html#dropEq"><span class="hs-identifier hs-var">dropEq</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927567"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927566"><span class="hs-identifier hs-var">opt_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#NoArg"><span class="hs-identifier hs-type">NoArg</span></a></span><span>  </span><span id="local-6989586621682927573"><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927573"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ((EwM m (), [Located String])
    -&gt; Either String (EwM m (), [Located String]))
-&gt; (EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927567"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EwM m ()
</span><a href="#local-6989586621682927573"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#HasArg"><span class="hs-identifier hs-type">HasArg</span></a></span><span> </span><span id="local-6989586621682927576"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927576"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; Bool
</span><a href="GHC.Utils.Misc.html#notNull"><span class="hs-identifier hs-var">notNull</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927576"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>                                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#missingArgErr"><span class="hs-identifier hs-var">missingArgErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span>
</span><span id="line-222"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927579"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927579"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682927580"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927580"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927576"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927579"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927580"><span class="hs-identifier hs-var">args1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-comment">-- See #9776</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#SepArg"><span class="hs-identifier hs-type">SepArg</span></a></span><span> </span><span id="local-6989586621682927581"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927581"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>                        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#missingArgErr"><span class="hs-identifier hs-var">missingArgErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span>
</span><span id="line-227"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682927582"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927582"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682927583"><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927583"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927581"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927582"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927583"><span class="hs-identifier hs-var">args1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-comment">-- See #12625</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span id="local-6989586621682927584"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927584"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; Bool
</span><a href="GHC.Utils.Misc.html#notNull"><span class="hs-identifier hs-var">notNull</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927584"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#missingArgErr"><span class="hs-identifier hs-var">missingArgErr</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#PassFlag"><span class="hs-identifier hs-type">PassFlag</span></a></span><span> </span><span id="local-6989586621682927585"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927585"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; Bool
</span><a href="GHC.Utils.Misc.html#notNull"><span class="hs-identifier hs-var">notNull</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927567"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#unknownFlagErr"><span class="hs-identifier hs-var">unknownFlagErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span>
</span><span id="line-234"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927585"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptIntSuffix"><span class="hs-identifier hs-type">OptIntSuffix</span></a></span><span> </span><span id="local-6989586621682927587"><span class="annot"><span class="annottext">Maybe Int -&gt; EwM m ()
</span><a href="#local-6989586621682927587"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927567"><span class="hs-identifier hs-var">rest</span></a></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; EwM m ()
</span><a href="#local-6989586621682927587"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682927588"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927588"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="GHC.Driver.CmdLine.html#parseInt"><span class="hs-identifier hs-var">parseInt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; EwM m ()
</span><a href="#local-6989586621682927587"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927588"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;malformed integer argument in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#IntSuffix"><span class="hs-identifier hs-type">IntSuffix</span></a></span><span> </span><span id="local-6989586621682927590"><span class="annot"><span class="annottext">Int -&gt; EwM m ()
</span><a href="#local-6989586621682927590"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682927591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927591"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
</span><a href="GHC.Driver.CmdLine.html#parseInt"><span class="hs-identifier hs-var">parseInt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; EwM m ()
</span><a href="#local-6989586621682927590"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927591"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;malformed integer argument in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Word64Suffix"><span class="hs-identifier hs-type">Word64Suffix</span></a></span><span> </span><span id="local-6989586621682927592"><span class="annot"><span class="annottext">Word64 -&gt; EwM m ()
</span><a href="#local-6989586621682927592"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682927593"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Word64
</span><a href="GHC.Driver.CmdLine.html#parseWord64"><span class="hs-identifier hs-var">parseWord64</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EwM m ()
</span><a href="#local-6989586621682927592"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927593"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;malformed natural argument in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#FloatSuffix"><span class="hs-identifier hs-type">FloatSuffix</span></a></span><span> </span><span id="local-6989586621682927595"><span class="annot"><span class="annottext">Float -&gt; EwM m ()
</span><a href="#local-6989586621682927595"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682927596"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927596"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Float
</span><a href="GHC.Driver.CmdLine.html#parseFloat"><span class="hs-identifier hs-var">parseFloat</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; EwM m ()
</span><a href="#local-6989586621682927595"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927596"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (EwM m (), [Located String])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;malformed float argument in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptPrefix"><span class="hs-identifier hs-type">OptPrefix</span></a></span><span> </span><span id="local-6989586621682927598"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927598"><span class="hs-identifier hs-var">f</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927598"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927571"><span class="hs-identifier hs-var">rest_no_eq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><a href="GHC.Driver.CmdLine.html#AnySuffix"><span class="hs-identifier hs-type">AnySuffix</span></a></span><span> </span><span id="local-6989586621682927599"><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927599"><span class="hs-identifier hs-var">f</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EwM m (), [Located String])
-&gt; Either String (EwM m (), [Located String])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; EwM m ()
</span><a href="#local-6989586621682927599"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927570"><span class="hs-identifier hs-var">dash_arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Located String]
</span><a href="#local-6989586621682927569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621682927244"><span class="annot"><a href="GHC.Driver.CmdLine.html#findArg"><span class="hs-identifier hs-type">findArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-253"></span><span id="findArg"><span class="annot"><span class="annottext">findArg :: forall (m :: * -&gt; *).
[Flag m] -&gt; String -&gt; Maybe (String, OptKind m)
</span><a href="GHC.Driver.CmdLine.html#findArg"><span class="hs-identifier hs-var hs-var">findArg</span></a></span></span><span> </span><span id="local-6989586621682927605"><span class="annot"><span class="annottext">[Flag m]
</span><a href="#local-6989586621682927605"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span id="local-6989586621682927606"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927606"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((String, OptKind m) -&gt; (String, OptKind m) -&gt; Ordering)
-&gt; [(String, OptKind m)] -&gt; [(String, OptKind m)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Ordering)
-&gt; ((String, OptKind m) -&gt; Int)
-&gt; (String, OptKind m)
-&gt; (String, OptKind m)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int)
-&gt; ((String, OptKind m) -&gt; String) -&gt; (String, OptKind m) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, OptKind m) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- prefer longest matching flag</span><span>
</span><span id="line-255"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="GHC.Utils.Misc.html#removeSpaces"><span class="hs-identifier hs-var">removeSpaces</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927612"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927613"><span class="hs-identifier hs-var">optKind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682927614"><span class="annot"><span class="annottext">Flag m
</span><a href="#local-6989586621682927614"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Flag m]
</span><a href="#local-6989586621682927605"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682927613"><span class="annot"><span class="annottext">optKind :: OptKind m
</span><a href="#local-6989586621682927613"><span class="hs-identifier hs-var hs-var">optKind</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag m -&gt; OptKind m
forall (m :: * -&gt; *). Flag m -&gt; OptKind m
</span><a href="GHC.Driver.CmdLine.html#flagOptKind"><span class="hs-identifier hs-var">flagOptKind</span></a></span><span> </span><span class="annot"><span class="annottext">Flag m
</span><a href="#local-6989586621682927614"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682927612"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927612"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe String
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><span class="hs-identifier hs-var">stripPrefix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag m -&gt; String
forall (m :: * -&gt; *). Flag m -&gt; String
</span><a href="GHC.Driver.CmdLine.html#flagName"><span class="hs-identifier hs-var">flagName</span></a></span><span> </span><span class="annot"><span class="annottext">Flag m
</span><a href="#local-6989586621682927614"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927606"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>             </span><span class="annot"><span class="annottext">OptKind m -&gt; String -&gt; String -&gt; Bool
forall (t :: * -&gt; *). OptKind t -&gt; String -&gt; String -&gt; Bool
</span><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="annot"><span class="annottext">OptKind m
</span><a href="#local-6989586621682927613"><span class="hs-identifier hs-var">optKind</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927612"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927606"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">of</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (String, OptKind m)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682927616"><span class="annot"><span class="annottext">(String, OptKind m)
</span><a href="#local-6989586621682927616"><span class="hs-identifier hs-var">one</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(String, OptKind m)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String, OptKind m) -&gt; Maybe (String, OptKind m)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String, OptKind m)
</span><a href="#local-6989586621682927616"><span class="hs-identifier hs-var">one</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span id="local-6989586621682927264"><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-type">arg_ok</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptKind"><span class="hs-identifier hs-type">OptKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927264"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-265"></span><span id="arg_ok"><span class="annot"><span class="annottext">arg_ok :: forall (t :: * -&gt; *). OptKind t -&gt; String -&gt; String -&gt; Bool
</span><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var hs-var">arg_ok</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#NoArg"><span class="hs-identifier hs-type">NoArg</span></a></span><span>           </span><span class="annot"><span class="annottext">EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682927620"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927620"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927620"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-266"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#HasArg"><span class="hs-identifier hs-type">HasArg</span></a></span><span>          </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-267"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#SepArg"><span class="hs-identifier hs-type">SepArg</span></a></span><span>          </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682927621"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927621"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927621"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-268"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span>          </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- Missing argument checked for in processOneArg t</span><span>
</span><span id="line-269"></span><span>                                            </span><span class="hs-comment">-- to improve error message (#12625)</span><span>
</span><span id="line-270"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptIntSuffix"><span class="hs-identifier hs-type">OptIntSuffix</span></a></span><span>    </span><span class="annot"><span class="annottext">Maybe Int -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-271"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#IntSuffix"><span class="hs-identifier hs-type">IntSuffix</span></a></span><span>       </span><span class="annot"><span class="annottext">Int -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-272"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Word64Suffix"><span class="hs-identifier hs-type">Word64Suffix</span></a></span><span>    </span><span class="annot"><span class="annottext">Word64 -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-273"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#FloatSuffix"><span class="hs-identifier hs-type">FloatSuffix</span></a></span><span>     </span><span class="annot"><span class="annottext">Float -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-274"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#OptPrefix"><span class="hs-identifier hs-type">OptPrefix</span></a></span><span>       </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-275"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#PassFlag"><span class="hs-identifier hs-type">PassFlag</span></a></span><span>        </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621682927622"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927622"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927622"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-276"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#arg_ok"><span class="hs-identifier hs-var">arg_ok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.CmdLine.html#AnySuffix"><span class="hs-identifier hs-type">AnySuffix</span></a></span><span>       </span><span class="annot"><span class="annottext">String -&gt; EwM t ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Parse an Int</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- Looks for &quot;433&quot; or &quot;=342&quot;, with no trailing gubbins</span><span>
</span><span id="line-281"></span><span class="hs-comment">--   * n or =n      =&gt; Just n</span><span>
</span><span id="line-282"></span><span class="hs-comment">--   * gibberish    =&gt; Nothing</span><span>
</span><span id="line-283"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#parseInt"><span class="hs-identifier hs-type">parseInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-284"></span><span id="parseInt"><span class="annot"><span class="annottext">parseInt :: String -&gt; Maybe Int
</span><a href="GHC.Driver.CmdLine.html#parseInt"><span class="hs-identifier hs-var hs-var">parseInt</span></a></span></span><span> </span><span id="local-6989586621682927623"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927623"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Int
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927623"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682927625"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927625"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Int, String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682927625"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-286"></span><span>                 </span><span class="annot"><span class="annottext">[(Int, String)]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#parseWord64"><span class="hs-identifier hs-type">parseWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-289"></span><span id="parseWord64"><span class="annot"><span class="annottext">parseWord64 :: String -&gt; Maybe Word64
</span><a href="GHC.Driver.CmdLine.html#parseWord64"><span class="hs-identifier hs-var hs-var">parseWord64</span></a></span></span><span> </span><span id="local-6989586621682927626"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927626"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Word64
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927626"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682927627"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927627"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Word64, String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682927627"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-291"></span><span>                 </span><span class="annot"><span class="annottext">[(Word64, String)]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#parseFloat"><span class="hs-identifier hs-type">parseFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-294"></span><span id="parseFloat"><span class="annot"><span class="annottext">parseFloat :: String -&gt; Maybe Float
</span><a href="GHC.Driver.CmdLine.html#parseFloat"><span class="hs-identifier hs-var hs-var">parseFloat</span></a></span></span><span> </span><span id="local-6989586621682927628"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927628"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Float
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927628"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>                   </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682927629"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927629"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Float, String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Maybe Float
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682927629"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-296"></span><span>                   </span><span class="annot"><span class="annottext">[(Float, String)]
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Float
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | Discards a leading equals sign</span></span><span>
</span><span id="line-299"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#dropEq"><span class="hs-identifier hs-type">dropEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-300"></span><span id="dropEq"><span class="annot"><span class="annottext">dropEq :: String -&gt; String
</span><a href="GHC.Driver.CmdLine.html#dropEq"><span class="hs-identifier hs-var hs-var">dropEq</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682927630"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927630"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927630"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-301"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#dropEq"><span class="hs-identifier hs-var">dropEq</span></a></span><span> </span><span id="local-6989586621682927631"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927631"><span class="hs-identifier hs-var">s</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927631"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span id="local-6989586621682927632"><span class="annot"><a href="GHC.Driver.CmdLine.html#unknownFlagErr"><span class="hs-identifier hs-type">unknownFlagErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621682927632"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-304"></span><span id="unknownFlagErr"><span class="annot"><span class="annottext">unknownFlagErr :: forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#unknownFlagErr"><span class="hs-identifier hs-var hs-var">unknownFlagErr</span></a></span></span><span> </span><span id="local-6989586621682927633"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927633"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unrecognised flag: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927633"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span id="local-6989586621682927253"><span class="annot"><a href="GHC.Driver.CmdLine.html#missingArgErr"><span class="hs-identifier hs-type">missingArgErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621682927253"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-307"></span><span id="missingArgErr"><span class="annot"><span class="annottext">missingArgErr :: forall a. String -&gt; Either String a
</span><a href="GHC.Driver.CmdLine.html#missingArgErr"><span class="hs-identifier hs-var hs-var">missingArgErr</span></a></span></span><span> </span><span id="local-6989586621682927634"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927634"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;missing argument for flag: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927634"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- Utils</span><span>
</span><span id="line-311"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><span class="hs-comment">-- | Parse a response file into arguments.</span></span><span>
</span><span id="line-314"></span><span id="local-6989586621682927270"><span class="annot"><a href="GHC.Driver.CmdLine.html#parseResponseFile"><span class="hs-identifier hs-type">parseResponseFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621682927270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#EwM"><span class="hs-identifier hs-type">EwM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682927270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-315"></span><span id="parseResponseFile"><span class="annot"><span class="annottext">parseResponseFile :: forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; EwM m [Located String]
</span><a href="GHC.Driver.CmdLine.html#parseResponseFile"><span class="hs-identifier hs-var hs-var">parseResponseFile</span></a></span></span><span> </span><span id="local-6989586621682927649"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927649"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621682927650"><span class="annot"><a href="#local-6989586621682927650"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either IOException String) -&gt; EwM m (Either IOException String)
forall a. IO a -&gt; EwM m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either IOException String)
 -&gt; EwM m (Either IOException String))
-&gt; IO (Either IOException String)
-&gt; EwM m (Either IOException String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either IOException String)
-&gt; IO String -&gt; IO (Either IOException String)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either IOException String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927649"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either IOException String)
-&gt; (IOException -&gt; IO (Either IOException String))
-&gt; IO (Either IOException String)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`catch`</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682927652"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621682927652"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOException String -&gt; IO (Either IOException String)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException -&gt; Either IOException String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621682927652"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682927650"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682927653"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621682927653"><span class="hs-identifier hs-var">_err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; EwM m ()
forall (m :: * -&gt; *). Monad m =&gt; String -&gt; EwM m ()
</span><a href="GHC.Driver.CmdLine.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not open response file&quot;</span></span><span> </span><span class="annot"><span class="annottext">EwM m () -&gt; EwM m [Located String] -&gt; EwM m [Located String]
forall a b. EwM m a -&gt; EwM m b -&gt; EwM m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; EwM m [Located String]
forall a. a -&gt; EwM m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682927654"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927654"><span class="hs-identifier hs-var">resp_file</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Located String] -&gt; EwM m [Located String]
forall a. a -&gt; EwM m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Located String] -&gt; EwM m [Located String])
-&gt; [Located String] -&gt; EwM m [Located String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Located String) -&gt; [String] -&gt; [Located String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Located String
forall e. String -&gt; e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#mkGeneralLocated"><span class="hs-identifier hs-var">mkGeneralLocated</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927649"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">unescapeArgs</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927654"><span class="hs-identifier hs-var">resp_file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- See Note [Handling errors when parsing command-line flags]</span><span>
</span><span id="line-323"></span><span class="annot"><a href="GHC.Driver.CmdLine.html#errorsToGhcException"><span class="hs-identifier hs-type">errorsToGhcException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Location</span><span>
</span><span id="line-324"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Error</span><span>
</span><span id="line-325"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html#GhcException"><span class="hs-identifier hs-type">GhcException</span></a></span><span>
</span><span id="line-326"></span><span id="errorsToGhcException"><span class="annot"><span class="annottext">errorsToGhcException :: [(String, String)] -&gt; GhcException
</span><a href="GHC.Driver.CmdLine.html#errorsToGhcException"><span class="hs-identifier hs-var hs-var">errorsToGhcException</span></a></span></span><span> </span><span id="local-6989586621682927657"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621682927657"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; GhcException
</span><a href="GHC.Utils.Panic.html#UsageError"><span class="hs-identifier hs-var">UsageError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; GhcException) -&gt; String -&gt; GhcException
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927659"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927660"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682927659"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927659"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682927660"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682927660"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621682927657"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">{- Note [Handling errors when parsing command-line flags]
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Parsing of static and mode flags happens before any session is started, i.e.,
before the first call to 'GHC.withGhc'. Therefore, to report errors for
invalid usage of these two types of flags, we can not call any function that
needs DynFlags, as there are no DynFlags available yet (unsafeGlobalDynFlags
is not set either). So we always print &quot;on the commandline&quot; as the location,
which is true except for Api users, which is probably ok.

When reporting errors for invalid usage of dynamic flags we /can/ make use of
DynFlags, and we do so explicitly in DynFlags.parseDynamicFlagsFull.

Before, we called unsafeGlobalDynFlags when an invalid (combination of)
flag(s) was given on the commandline, resulting in panics (#9963).
-}</span><span>
</span><span id="line-344"></span></pre></body></html>