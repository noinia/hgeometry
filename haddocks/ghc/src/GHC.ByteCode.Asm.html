<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -optc-DNON_POSIX_SOURCE #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">--  (c) The University of Glasgow 2002-2006</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="annot"><span class="hs-comment">-- | Bytecode assembler and linker</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html"><span class="hs-identifier">GHC.ByteCode.Asm</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier">assembleBCOs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier">assembleOneBCO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier">bcoFreeNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#SizedSeq"><span class="hs-identifier">SizedSeq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#sizeSS"><span class="hs-identifier">sizeSS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#ssElts"><span class="hs-identifier">ssElts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier">iNTERP_STACK_CHECK_THRESH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoLit"><span class="hs-identifier">mkNativeCallInfoLit</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html"><span class="hs-identifier">GHC.ByteCode.Instr</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.InfoTable.html"><span class="hs-identifier">GHC.ByteCode.InfoTable</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html"><span class="hs-identifier">GHC.ByteCode.Types</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghci-9.12.2-bd10/src/GHCi.RemoteTypes.html"><span class="hs-identifier">GHCi.RemoteTypes</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.html"><span class="hs-identifier">GHC.Runtime.Interpreter</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html"><span class="hs-identifier">GHC.Runtime.Heap.Layout</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#fromStgWord"><span class="hs-identifier">fromStgWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#StgWord"><span class="hs-identifier">StgWord</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html"><span class="hs-identifier">GHC.Types.Unique.DSet</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SptEntry.html"><span class="hs-identifier">GHC.Types.SptEntry</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FlatBag.html"><span class="hs-identifier">GHC.Data.FlatBag</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html"><span class="hs-identifier">GHC.Data.SizedSeq</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Layout.html"><span class="hs-identifier">GHC.StgToCmm.Layout</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier">ArgRep</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html"><span class="hs-identifier">GHC.Cmm.Expr</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html"><span class="hs-identifier">GHC.Cmm.Reg</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalArgRegs"><span class="hs-identifier">GlobalArgRegs</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CallConv.html"><span class="hs-identifier">GHC.Cmm.CallConv</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.CallConv.html#allArgRegsCover"><span class="hs-identifier">allArgRegsCover</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html"><span class="hs-identifier">GHC.Platform.Profile</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html"><span class="hs-identifier">Control.Monad.Trans.Class</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Unboxed.html"><span class="hs-identifier">Data.Array.Unboxed</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html"><span class="hs-identifier">Data.Array.Base</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#UArray"><span class="hs-identifier">UArray</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.html"><span class="hs-identifier">Foreign</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftR</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ord</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">genericLength</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Float.html"><span class="hs-identifier">GHC.Float</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">castFloatToWord32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">castDoubleToWord64</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Unlinked BCOs</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- CompiledByteCode represents the result of byte-code</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- compiling a bunch of functions and data types</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Finds external references.  Remember to remove the names</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- defined by this group of BCOs themselves</span><span>
</span><span id="line-70"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier hs-type">bcoFreeNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html#UniqDSet"><span class="hs-identifier hs-type">UniqDSet</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-71"></span><span id="bcoFreeNames"><span class="annot"><span class="annottext">bcoFreeNames :: UnlinkedBCO -&gt; UniqDSet Name
</span><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier hs-var hs-var">bcoFreeNames</span></a></span></span><span> </span><span id="local-6989586621682963866"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963866"><span class="hs-identifier hs-var">bco</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621682963867"><span class="hs-identifier hs-var">bco_refs</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963866"><span class="hs-identifier hs-var">bco</span></a></span><span> </span><span class="annot"><span class="annottext">UniqDSet Name -&gt; UniqSet Name -&gt; UniqDSet Name
forall a. UniqDSet a -&gt; UniqSet a -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#uniqDSetMinusUniqSet"><span class="hs-operator hs-var">`uniqDSetMinusUniqSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; UniqSet Name
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; Name
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOName"><span class="hs-identifier hs-var">unlinkedBCOName</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963866"><span class="hs-identifier hs-var">bco</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621682963867"><span class="annot"><span class="annottext">bco_refs :: UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621682963867"><span class="hs-identifier hs-var hs-var">bco_refs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BCOByteArray Word16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BCOByteArray Word
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682963875"><span class="annot"><span class="annottext">FlatBag BCONPtr
</span><a href="#local-6989586621682963875"><span class="hs-identifier hs-var">nonptrs</span></a></span></span><span> </span><span id="local-6989586621682963876"><span class="annot"><span class="annottext">FlatBag BCOPtr
</span><a href="#local-6989586621682963876"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UniqDSet Name] -&gt; UniqDSet Name
forall a. [UniqDSet a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#unionManyUniqDSets"><span class="hs-identifier hs-var">unionManyUniqDSets</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-76"></span><span>             </span><span class="annot"><span class="annottext">[Name] -&gt; UniqDSet Name
forall a. Uniquable a =&gt; [a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#mkUniqDSet"><span class="hs-identifier hs-var">mkUniqDSet</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682963879"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrName"><span class="hs-identifier hs-type">BCOPtrName</span></a></span><span> </span><span id="local-6989586621682963879"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682963879"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FlatBag BCOPtr -&gt; [BCOPtr]
forall a. FlatBag a -&gt; [a]
</span><a href="GHC.Data.FlatBag.html#elemsFlatBag"><span class="hs-identifier hs-var">elemsFlatBag</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCOPtr
</span><a href="#local-6989586621682963876"><span class="hs-identifier hs-var">ptrs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">UniqDSet Name -&gt; [UniqDSet Name] -&gt; [UniqDSet Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-77"></span><span>             </span><span class="annot"><span class="annottext">[Name] -&gt; UniqDSet Name
forall a. Uniquable a =&gt; [a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#mkUniqDSet"><span class="hs-identifier hs-var">mkUniqDSet</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682963882"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrItbl"><span class="hs-identifier hs-type">BCONPtrItbl</span></a></span><span> </span><span id="local-6989586621682963882"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682963882"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FlatBag BCONPtr -&gt; [BCONPtr]
forall a. FlatBag a -&gt; [a]
</span><a href="GHC.Data.FlatBag.html#elemsFlatBag"><span class="hs-identifier hs-var">elemsFlatBag</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCONPtr
</span><a href="#local-6989586621682963875"><span class="hs-identifier hs-var">nonptrs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">UniqDSet Name -&gt; [UniqDSet Name] -&gt; [UniqDSet Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-78"></span><span>             </span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; UniqDSet Name) -&gt; [UnlinkedBCO] -&gt; [UniqDSet Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621682963867"><span class="hs-identifier hs-var">bco_refs</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963884"><span class="hs-identifier hs-var">bco</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621682963884"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963884"><span class="hs-identifier hs-var">bco</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FlatBag BCOPtr -&gt; [BCOPtr]
forall a. FlatBag a -&gt; [a]
</span><a href="GHC.Data.FlatBag.html#elemsFlatBag"><span class="hs-identifier hs-var">elemsFlatBag</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCOPtr
</span><a href="#local-6989586621682963876"><span class="hs-identifier hs-var">ptrs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- The bytecode assembler</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- The object format for bytecodes is: 16 bits for the opcode, and 16</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- for each field -- so the code can be considered a sequence of</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- 16-bit ints.  Each field denotes either a stack offset or number of</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- items on the stack (eg SLIDE), and index into the pointer table (eg</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- PUSH_G), an index into the literal table (eg PUSH_I/D/L), or a</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- bytecode address in this BCO.</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- Top level assembler fn.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier hs-type">assembleBCOs</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FlatBag.html#FlatBag"><span class="hs-identifier hs-type">FlatBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#AddrEnv"><span class="hs-identifier hs-type">AddrEnv</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#ModBreaks"><span class="hs-identifier hs-type">ModBreaks</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SptEntry.html#SptEntry"><span class="hs-identifier hs-type">SptEntry</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#CompiledByteCode"><span class="hs-identifier hs-type">CompiledByteCode</span></a></span><span>
</span><span id="line-101"></span><span id="assembleBCOs"><span class="annot"><span class="annottext">assembleBCOs :: Interp
-&gt; Profile
-&gt; FlatBag (ProtoBCO Name)
-&gt; [TyCon]
-&gt; AddrEnv
-&gt; Maybe ModBreaks
-&gt; [SptEntry]
-&gt; IO CompiledByteCode
</span><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier hs-var hs-var">assembleBCOs</span></a></span></span><span> </span><span id="local-6989586621682963886"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621682963886"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621682963887"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621682963887"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621682963888"><span class="annot"><span class="annottext">FlatBag (ProtoBCO Name)
</span><a href="#local-6989586621682963888"><span class="hs-identifier hs-var">proto_bcos</span></a></span></span><span> </span><span id="local-6989586621682963889"><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621682963889"><span class="hs-identifier hs-var">tycons</span></a></span></span><span> </span><span id="local-6989586621682963890"><span class="annot"><span class="annottext">AddrEnv
</span><a href="#local-6989586621682963890"><span class="hs-identifier hs-var">top_strs</span></a></span></span><span> </span><span id="local-6989586621682963891"><span class="annot"><span class="annottext">Maybe ModBreaks
</span><a href="#local-6989586621682963891"><span class="hs-identifier hs-var">modbreaks</span></a></span></span><span> </span><span id="local-6989586621682963892"><span class="annot"><span class="annottext">[SptEntry]
</span><a href="#local-6989586621682963892"><span class="hs-identifier hs-var">spt_entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- TODO: the profile should be bundled with the interpreter: the rts ways are</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">-- fixed for an interpreter</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621682963893"><span class="annot"><a href="#local-6989586621682963893"><span class="hs-identifier hs-var">itblenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Interp -&gt; Profile -&gt; [TyCon] -&gt; IO ItblEnv
</span><a href="GHC.ByteCode.InfoTable.html#mkITbls"><span class="hs-identifier hs-var">mkITbls</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621682963886"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621682963887"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621682963889"><span class="hs-identifier hs-var">tycons</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621682963895"><span class="annot"><a href="#local-6989586621682963895"><span class="hs-identifier hs-var">bcos</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-type">assembleBCO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.Profile.html#profilePlatform"><span class="hs-identifier hs-var">profilePlatform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963887"><span class="hs-identifier hs-type">profile</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682963888"><span class="hs-identifier hs-type">proto_bcos</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621682963899"><span class="annot"><a href="#local-6989586621682963899"><span class="hs-identifier hs-var">bcos'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-type">mallocStrings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963886"><span class="hs-identifier hs-type">interp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963895"><span class="hs-identifier hs-type">bcos</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#CompiledByteCode"><span class="hs-identifier hs-type">CompiledByteCode</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_bcos"><span class="hs-identifier hs-var">bc_bcos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963899"><span class="hs-identifier hs-type">bcos'</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_itbls"><span class="hs-identifier hs-var">bc_itbls</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><a href="#local-6989586621682963893"><span class="hs-identifier hs-type">itblenv</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_ffis"><span class="hs-identifier hs-var">bc_ffis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">concatMap</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#protoBCOFFIs"><span class="hs-identifier hs-var">protoBCOFFIs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963888"><span class="hs-identifier hs-type">proto_bcos</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_strs"><span class="hs-identifier hs-var">bc_strs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963890"><span class="hs-identifier hs-type">top_strs</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_breaks"><span class="hs-identifier hs-var">bc_breaks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963891"><span class="hs-identifier hs-type">modbreaks</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#bc_spt_entries"><span class="hs-identifier hs-var">bc_spt_entries</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963892"><span class="hs-identifier hs-type">spt_entries</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Note [Allocating string literals]</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- Our strategy for handling top-level string literal bindings is described in</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- Note [Generating code for top-level string literal bindings] in GHC.StgToByteCode,</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- but not all Addr# literals in a program are guaranteed to be lifted to the</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- top level. Our strategy for handling local Addr# literals is somewhat simpler:</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- after assembling, we find all the BCONPtrStr arguments in the program, malloc</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- memory for them, and bake the resulting addresses into the instruction stream</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- in the form of BCONPtrWord arguments.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Since we do this when assembling, we only allocate the memory when we compile</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- the module, not each time we relink it. However, we do want to take care to</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- malloc the memory all in one go, since that is more efficient with</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- -fexternal-interpreter, especially when compiling in parallel.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Note that, as with top-level string literal bindings, this memory is never</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- freed, so it just leaks if the BCO is unloaded. See Note [Generating code for</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- top-level string literal bindings] in GHC.StgToByteCode for some discussion</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- about why.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-type">mallocStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FlatBag.html#FlatBag"><span class="hs-identifier hs-type">FlatBag</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FlatBag.html#FlatBag"><span class="hs-identifier hs-type">FlatBag</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="mallocStrings"><span class="annot"><span class="annottext">mallocStrings :: Interp -&gt; FlatBag UnlinkedBCO -&gt; IO (FlatBag UnlinkedBCO)
</span><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-var hs-var">mallocStrings</span></a></span></span><span> </span><span id="local-6989586621682963910"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621682963910"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621682963911"><span class="annot"><span class="annottext">FlatBag UnlinkedBCO
</span><a href="#local-6989586621682963911"><span class="hs-identifier hs-var">ulbcos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682963912"><span class="annot"><span class="annottext">bytestrings :: [ByteString]
</span><a href="#local-6989586621682963912"><span class="hs-identifier hs-var hs-var hs-var">bytestrings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State [ByteString] () -&gt; [ByteString] -&gt; [ByteString]
forall s a. State s a -&gt; s -&gt; s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#execState"><span class="hs-identifier hs-var">execState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; State [ByteString] ())
-&gt; FlatBag UnlinkedBCO -&gt; State [ByteString] ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; State [ByteString] ()
forall {m :: * -&gt; *}.
Monad m =&gt;
UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682963916"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag UnlinkedBCO
</span><a href="#local-6989586621682963911"><span class="hs-identifier hs-var">ulbcos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621682963917"><span class="annot"><a href="#local-6989586621682963917"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Interp -&gt; Message [RemotePtr ()] -&gt; IO [RemotePtr ()]
forall a. Binary a =&gt; Interp -&gt; Message a -&gt; IO a
</span><a href="GHC.Runtime.Interpreter.html#interpCmd"><span class="hs-identifier hs-var">interpCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621682963910"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; Message [RemotePtr ()]
</span><a href="../../ghci-9.12.2-bd10/src/GHCi.Message.html#MallocStrings"><span class="hs-identifier hs-var">MallocStrings</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621682963912"><span class="hs-identifier hs-var">bytestrings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#evalState"><span class="hs-identifier hs-type">evalState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682963921"><span class="hs-identifier hs-type">splice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963911"><span class="hs-identifier hs-type">ulbcos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682963917"><span class="hs-identifier hs-type">ptrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621682963921"><span class="annot"><span class="annottext">splice :: UnlinkedBCO -&gt; StateT [RemotePtr a] m UnlinkedBCO
</span><a href="#local-6989586621682963921"><span class="hs-identifier hs-var hs-var">splice</span></a></span></span><span> </span><span id="local-6989586621682963942"><span class="annot"><span class="annottext">bco :: UnlinkedBCO
</span><a href="#local-6989586621682963942"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">{</span><span id="local-6989586621682963943"><span id="local-6989586621682963944"><span id="local-6989586621682963945"><span id="local-6989586621682963946"><span id="local-6989586621682963947"><span id="local-6989586621682963948"><span class="annot"><span class="annottext">Int
BCOByteArray Word
BCOByteArray Word16
Name
FlatBag BCONPtr
FlatBag BCOPtr
unlinkedBCOName :: UnlinkedBCO -&gt; Name
unlinkedBCOName :: Name
unlinkedBCOArity :: Int
unlinkedBCOInstrs :: BCOByteArray Word16
unlinkedBCOBitmap :: BCOByteArray Word
unlinkedBCOLits :: FlatBag BCONPtr
unlinkedBCOPtrs :: FlatBag BCOPtr
unlinkedBCOPtrs :: UnlinkedBCO -&gt; FlatBag BCOPtr
unlinkedBCOLits :: UnlinkedBCO -&gt; FlatBag BCONPtr
unlinkedBCOBitmap :: UnlinkedBCO -&gt; BCOByteArray Word
unlinkedBCOInstrs :: UnlinkedBCO -&gt; BCOByteArray Word16
unlinkedBCOArity :: UnlinkedBCO -&gt; Int
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOName"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621682963954"><span class="annot"><a href="#local-6989586621682963954"><span class="hs-identifier hs-var">lits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr)
-&gt; FlatBag BCONPtr -&gt; StateT [RemotePtr a] m (FlatBag BCONPtr)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; FlatBag a -&gt; m (FlatBag b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
forall {m :: * -&gt; *} {a}.
Monad m =&gt;
BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
</span><a href="#local-6989586621682963955"><span class="hs-identifier hs-var">spliceLit</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCONPtr
</span><a href="#local-6989586621682963947"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621682963956"><span class="annot"><a href="#local-6989586621682963956"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="#local-6989586621682963957"><span class="hs-identifier hs-type">splicePtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963948"><span class="hs-identifier hs-type">unlinkedBCOPtrs</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682963942"><span class="hs-identifier hs-type">bco</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#unlinkedBCOLits"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963954"><span class="hs-identifier hs-type">lits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#unlinkedBCOPtrs"><span class="hs-identifier hs-var">unlinkedBCOPtrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682963956"><span class="hs-identifier hs-type">ptrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621682963955"><span class="annot"><span class="annottext">spliceLit :: BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
</span><a href="#local-6989586621682963955"><span class="hs-identifier hs-var hs-var">spliceLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-type">BCONPtrStr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621682963975"><span class="annot"><a href="#local-6989586621682963975"><span class="hs-identifier hs-var">rptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT [RemotePtr a] m [RemotePtr a]
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682963975"><span class="hs-identifier hs-type">rptrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../../ghci-9.12.2-bd10/src/GHCi.RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span id="local-6989586621682963978"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682963978"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682963979"><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621682963979"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><span class="annottext">[RemotePtr a] -&gt; StateT [RemotePtr a] m ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621682963979"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="annottext">BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
forall a. a -&gt; StateT [RemotePtr a] m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrWord"><span class="hs-identifier hs-var">BCONPtrWord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682963978"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">[RemotePtr a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; StateT [RemotePtr a] m BCONPtr
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mallocStrings:spliceLit&quot;</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="#local-6989586621682963955"><span class="hs-identifier hs-var">spliceLit</span></a></span><span> </span><span id="local-6989586621682963983"><span class="annot"><span class="annottext">BCONPtr
</span><a href="#local-6989586621682963983"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
forall a. a -&gt; StateT [RemotePtr a] m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BCONPtr
</span><a href="#local-6989586621682963983"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621682963957"><span class="annot"><span class="annottext">splicePtr :: BCOPtr -&gt; StateT [RemotePtr a] m BCOPtr
</span><a href="#local-6989586621682963957"><span class="hs-identifier hs-var hs-var">splicePtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621682963984"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963984"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; BCOPtr)
-&gt; StateT [RemotePtr a] m UnlinkedBCO
-&gt; StateT [RemotePtr a] m BCOPtr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; StateT [RemotePtr a] m UnlinkedBCO
</span><a href="#local-6989586621682963921"><span class="hs-identifier hs-var">splice</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682963984"><span class="hs-identifier hs-var">bco</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="#local-6989586621682963957"><span class="hs-identifier hs-var">splicePtr</span></a></span><span> </span><span id="local-6989586621682963986"><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621682963986"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; StateT [RemotePtr a] m BCOPtr
forall a. a -&gt; StateT [RemotePtr a] m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621682963986"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621682963916"><span class="annot"><span class="annottext">collect :: UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682963916"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">{</span><span id="local-6989586621682964000"><span id="local-6989586621682964001"><span id="local-6989586621682964002"><span id="local-6989586621682964003"><span id="local-6989586621682964004"><span id="local-6989586621682964005"><span class="annot"><span class="annottext">Int
BCOByteArray Word
BCOByteArray Word16
Name
FlatBag BCONPtr
FlatBag BCOPtr
unlinkedBCOName :: UnlinkedBCO -&gt; Name
unlinkedBCOPtrs :: UnlinkedBCO -&gt; FlatBag BCOPtr
unlinkedBCOLits :: UnlinkedBCO -&gt; FlatBag BCONPtr
unlinkedBCOBitmap :: UnlinkedBCO -&gt; BCOByteArray Word
unlinkedBCOInstrs :: UnlinkedBCO -&gt; BCOByteArray Word16
unlinkedBCOArity :: UnlinkedBCO -&gt; Int
unlinkedBCOName :: Name
unlinkedBCOArity :: Int
unlinkedBCOInstrs :: BCOByteArray Word16
unlinkedBCOBitmap :: BCOByteArray Word
unlinkedBCOLits :: FlatBag BCONPtr
unlinkedBCOPtrs :: FlatBag BCOPtr
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOName"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">(BCONPtr -&gt; StateT [ByteString] m ())
-&gt; FlatBag BCONPtr -&gt; StateT [ByteString] m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">BCONPtr -&gt; StateT [ByteString] m ()
forall {m :: * -&gt; *}.
Monad m =&gt;
BCONPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682964006"><span class="hs-identifier hs-var">collectLit</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCONPtr
</span><a href="#local-6989586621682964004"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">(BCOPtr -&gt; StateT [ByteString] m ())
-&gt; FlatBag BCOPtr -&gt; StateT [ByteString] m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682964007"><span class="hs-identifier hs-var">collectPtr</span></a></span><span> </span><span class="annot"><span class="annottext">FlatBag BCOPtr
</span><a href="#local-6989586621682964005"><span class="hs-identifier hs-var">unlinkedBCOPtrs</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621682964006"><span class="annot"><span class="annottext">collectLit :: BCONPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682964006"><span class="hs-identifier hs-var hs-var">collectLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-type">BCONPtrStr</span></a></span><span> </span><span id="local-6989586621682964018"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682964018"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621682964019"><span class="annot"><a href="#local-6989586621682964019"><span class="hs-identifier hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT [ByteString] m [ByteString]
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-type">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682964018"><span class="hs-identifier hs-type">bs</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621682964019"><span class="hs-identifier hs-type">strs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="#local-6989586621682964006"><span class="hs-identifier hs-var">collectLit</span></a></span><span> </span><span class="annot"><span class="annottext">BCONPtr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT [ByteString] m ()
forall a. a -&gt; StateT [ByteString] m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621682964007"><span class="annot"><span class="annottext">collectPtr :: BCOPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682964007"><span class="hs-identifier hs-var hs-var">collectPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621682964020"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682964020"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621682963916"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621682964020"><span class="hs-identifier hs-var">bco</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="#local-6989586621682964007"><span class="hs-identifier hs-var">collectPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT [ByteString] m ()
forall a. a -&gt; StateT [ByteString] m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier hs-type">assembleOneBCO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span>
</span><span id="line-173"></span><span id="assembleOneBCO"><span class="annot"><span class="annottext">assembleOneBCO :: Interp -&gt; Profile -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier hs-var hs-var">assembleOneBCO</span></a></span></span><span> </span><span id="local-6989586621682964021"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621682964021"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621682964022"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621682964022"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621682964023"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964023"><span class="hs-identifier hs-var">pbco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- TODO: the profile should be bundled with the interpreter: the rts ways are</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- fixed for an interpreter</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621682964024"><span class="annot"><a href="#local-6989586621682964024"><span class="hs-identifier hs-var">ubco</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; Platform
</span><a href="GHC.Platform.Profile.html#profilePlatform"><span class="hs-identifier hs-var">profilePlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621682964022"><span class="hs-identifier hs-var">profile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964023"><span class="hs-identifier hs-var">pbco</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="GHC.Data.FlatBag.html#UnitFlatBag"><span class="hs-identifier hs-type">UnitFlatBag</span></a></span><span> </span><span id="local-6989586621682964026"><span class="annot"><a href="#local-6989586621682964026"><span class="hs-identifier hs-var">ubco'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-type">mallocStrings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964021"><span class="hs-identifier hs-type">interp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FlatBag.html#UnitFlatBag"><span class="hs-identifier hs-type">UnitFlatBag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964024"><span class="hs-identifier hs-type">ubco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682964026"><span class="hs-identifier hs-type">ubco'</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-type">assembleBCO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span>
</span><span id="line-181"></span><span id="assembleBCO"><span class="annot"><span class="annottext">assembleBCO :: Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var hs-var">assembleBCO</span></a></span></span><span> </span><span id="local-6989586621682964027"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964027"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">protoBCOName :: forall a. ProtoBCO a -&gt; a
</span><a href="GHC.ByteCode.Instr.html#protoBCOName"><span class="hs-identifier hs-var">protoBCOName</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682964030"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964030"><span class="hs-identifier hs-var">nm</span></a></span></span><span>
</span><span id="line-182"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOInstrs :: forall a. ProtoBCO a -&gt; [BCInstr]
</span><a href="GHC.ByteCode.Instr.html#protoBCOInstrs"><span class="hs-identifier hs-var">protoBCOInstrs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682964032"><span class="annot"><span class="annottext">[BCInstr]
</span><a href="#local-6989586621682964032"><span class="hs-identifier hs-var">instrs</span></a></span></span><span>
</span><span id="line-183"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOBitmap :: forall a. ProtoBCO a -&gt; [StgWord]
</span><a href="GHC.ByteCode.Instr.html#protoBCOBitmap"><span class="hs-identifier hs-var">protoBCOBitmap</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682964034"><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621682964034"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span>
</span><span id="line-184"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOBitmapSize :: forall a. ProtoBCO a -&gt; Word
</span><a href="GHC.ByteCode.Instr.html#protoBCOBitmapSize"><span class="hs-identifier hs-var">protoBCOBitmapSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682964036"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964036"><span class="hs-identifier hs-var">bsize</span></a></span></span><span>
</span><span id="line-185"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOArity :: forall a. ProtoBCO a -&gt; Int
</span><a href="GHC.ByteCode.Instr.html#protoBCOArity"><span class="hs-identifier hs-var">protoBCOArity</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682964038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964038"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- pass 1: collect up the offsets of the local labels.</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964039"><span class="annot"><span class="annottext">asm :: Assembler ()
</span><a href="#local-6989586621682964039"><span class="hs-identifier hs-var hs-var hs-var">asm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BCInstr -&gt; Assembler ()) -&gt; [BCInstr] -&gt; Assembler ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; BCInstr -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-var">assembleI</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964027"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BCInstr]
</span><a href="#local-6989586621682964032"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621682964042"><span class="annot"><span class="annottext">initial_offset :: Word
</span><a href="#local-6989586621682964042"><span class="hs-identifier hs-var hs-var hs-var">initial_offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-comment">-- Jump instructions are variable-sized, there are long and short variants</span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-comment">-- depending on the magnitude of the offset.  However, we can't tell what</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-comment">-- size instructions we will need until we have calculated the offsets of</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-comment">-- the labels, which depends on the size of the instructions...  So we</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-comment">-- first create the label environment assuming that all jumps are short,</span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-comment">-- and if the final size is indeed small enough for short jumps, we are</span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-comment">-- done.  Otherwise, we repeat the calculation, and we force all jumps in</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-comment">-- this BCO to be long.</span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682964043"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964043"><span class="hs-identifier hs-var hs-var">n_insns0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964044"><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621682964044"><span class="hs-identifier hs-var hs-var">lbl_map0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; Word -&gt; Assembler () -&gt; (Word, LabelEnvMap)
forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var">inspectAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964027"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964042"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621682964039"><span class="hs-identifier hs-var">asm</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682964046"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964046"><span class="hs-identifier hs-var hs-var">n_insns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964047"><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621682964047"><span class="hs-identifier hs-var hs-var">lbl_map</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964048"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964048"><span class="hs-identifier hs-var hs-var">long_jumps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeW"><span class="hs-identifier hs-var">isLargeW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word) -&gt; Int -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap -&gt; Int
forall k a. Map k a -&gt; Int
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#size"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621682964044"><span class="hs-identifier hs-var">lbl_map0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeW"><span class="hs-identifier hs-var">isLargeW</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964043"><span class="hs-identifier hs-var">n_insns0</span></a></span><span>
</span><span id="line-203"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Bool -&gt; Word -&gt; Assembler () -&gt; (Word, LabelEnvMap)
forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var">inspectAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964027"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964042"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621682964039"><span class="hs-identifier hs-var">asm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964043"><span class="hs-identifier hs-var">n_insns0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621682964044"><span class="hs-identifier hs-var">lbl_map0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><a href="#local-6989586621682964052"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-207"></span><span>      </span><span id="local-6989586621682964052"><span class="annot"><span class="annottext">env :: LocalLabel -&gt; Word
</span><a href="#local-6989586621682964052"><span class="hs-identifier hs-var hs-var hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682964053"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964053"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Maybe Word -&gt; Word
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Word
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assembleBCO.findLabel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalLabel -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964053"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalLabel -&gt; LabelEnvMap -&gt; Maybe Word
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964053"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621682964047"><span class="hs-identifier hs-var">lbl_map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- pass 2: run assembler and generate instructions, literals and pointers</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964057"><span class="annot"><span class="annottext">initial_state :: (SizedSeq a, SizedSeq a, SizedSeq a)
</span><a href="#local-6989586621682964057"><span class="hs-identifier hs-var hs-var hs-var">initial_state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq a
forall a. SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SizedSeq a
forall a. SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SizedSeq a
forall a. SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682964059"><span class="annot"><a href="#local-6989586621682964059"><span class="hs-identifier hs-var">final_insns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964060"><span class="annot"><a href="#local-6989586621682964060"><span class="hs-identifier hs-var">final_lits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964061"><span class="annot"><a href="#local-6989586621682964061"><span class="hs-identifier hs-var">final_ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
 -&gt; (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
 -&gt; IO (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr))
-&gt; (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
-&gt; IO (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
-&gt; (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
-&gt; IO (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#execStateT"><span class="hs-identifier hs-var">execStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
forall {a} {a} {a}. (SizedSeq a, SizedSeq a, SizedSeq a)
</span><a href="#local-6989586621682964057"><span class="hs-identifier hs-var">initial_state</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
 -&gt; IO (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr))
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
-&gt; IO (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform
-&gt; Bool
-&gt; (LocalLabel -&gt; Word)
-&gt; Assembler ()
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
forall a.
Platform
-&gt; Bool
-&gt; (LocalLabel -&gt; Word)
-&gt; Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-var">runAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964027"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964048"><span class="hs-identifier hs-var">long_jumps</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621682964052"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621682964039"><span class="hs-identifier hs-var">asm</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- precomputed size should be equal to final size</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="GHC.Utils.Panic.html#massertPpr"><span class="hs-identifier hs-type">massertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682964046"><span class="hs-identifier hs-type">n_insns</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#sizeSS"><span class="hs-identifier hs-type">sizeSS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964059"><span class="hs-identifier hs-type">final_insns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;bytecode instruction count mismatch&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964067"><span class="annot"><a href="#local-6989586621682964067"><span class="hs-identifier hs-var hs-var">asm_insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16 -&gt; [Word16]
forall a. SizedSeq a -&gt; [a]
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#ssElts"><span class="hs-identifier hs-var">ssElts</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964059"><span class="hs-identifier hs-var">final_insns</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621682964068"><span class="annot"><a href="#local-6989586621682964068"><span class="hs-identifier hs-var hs-var">insns_arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">UArray Int Word16 -&gt; BCOByteArray Word16
forall a. UArray Int a -&gt; BCOByteArray a
</span><a href="../../ghci-9.12.2-bd10/src/GHCi.ResolvedBCO.html#mkBCOByteArray"><span class="hs-identifier hs-var">mkBCOByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray Int Word16 -&gt; BCOByteArray Word16)
-&gt; UArray Int Word16 -&gt; BCOByteArray Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word16] -&gt; UArray Int Word16
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#listArray"><span class="hs-identifier hs-var">Array.listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964046"><span class="hs-identifier hs-var">n_insns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621682964067"><span class="hs-identifier hs-var">asm_insns</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621682964071"><span class="annot"><a href="#local-6989586621682964071"><span class="hs-identifier hs-var hs-var">bitmap_arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray Int Word -&gt; BCOByteArray Word
forall a. UArray Int a -&gt; BCOByteArray a
</span><a href="../../ghci-9.12.2-bd10/src/GHCi.ResolvedBCO.html#mkBCOByteArray"><span class="hs-identifier hs-var">mkBCOByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">(UArray Int Word -&gt; BCOByteArray Word)
-&gt; UArray Int Word -&gt; BCOByteArray Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; [StgWord] -&gt; UArray Int Word
</span><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-var">mkBitmapArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964036"><span class="hs-identifier hs-var">bsize</span></a></span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621682964034"><span class="hs-identifier hs-var">bitmap</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621682964073"><span class="annot"><a href="#local-6989586621682964073"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Int
-&gt; BCOByteArray Word16
-&gt; BCOByteArray Word
-&gt; FlatBag BCONPtr
-&gt; FlatBag BCOPtr
-&gt; UnlinkedBCO
</span><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-var">UnlinkedBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964030"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964038"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">BCOByteArray Word16
</span><a href="#local-6989586621682964068"><span class="hs-identifier hs-var">insns_arr</span></a></span><span> </span><span class="annot"><span class="annottext">BCOByteArray Word
</span><a href="#local-6989586621682964071"><span class="hs-identifier hs-var">bitmap_arr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq BCONPtr -&gt; FlatBag BCONPtr
forall a. SizedSeq a -&gt; FlatBag a
</span><a href="GHC.Data.FlatBag.html#fromSizedSeq"><span class="hs-identifier hs-var">fromSizedSeq</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964060"><span class="hs-identifier hs-var">final_lits</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq BCOPtr -&gt; FlatBag BCOPtr
forall a. SizedSeq a -&gt; FlatBag a
</span><a href="GHC.Data.FlatBag.html#fromSizedSeq"><span class="hs-identifier hs-var">fromSizedSeq</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964061"><span class="hs-identifier hs-var">final_ptrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- 8 Aug 01: Finalisers aren't safe when attached to non-primitive</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- objects, since they might get run too early.  Disable this until</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- we figure out what to do.</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- when (notNull malloced) (addFinalizer ul_bco (mapM_ zonk malloced))</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682964073"><span class="hs-identifier hs-type">ul_bco</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-type">mkBitmapArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#StgWord"><span class="hs-identifier hs-type">StgWord</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- Here the return type must be an array of Words, not StgWords,</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- because the underlying ByteArray# will end up as a component</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- of a BCO object.</span><span>
</span><span id="line-235"></span><span id="mkBitmapArray"><span class="annot"><span class="annottext">mkBitmapArray :: Word -&gt; [StgWord] -&gt; UArray Int Word
</span><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-var hs-var">mkBitmapArray</span></a></span></span><span> </span><span id="local-6989586621682964075"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964075"><span class="hs-identifier hs-var">bsize</span></a></span></span><span> </span><span id="local-6989586621682964076"><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621682964076"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word] -&gt; UArray Int Word
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#listArray"><span class="hs-identifier hs-var">Array.listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[StgWord] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621682964076"><span class="hs-identifier hs-var">bitmap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word] -&gt; UArray Int Word) -&gt; [Word] -&gt; UArray Int Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">Word -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964075"><span class="hs-identifier hs-var">bsize</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; [Word] -&gt; [Word]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(StgWord -&gt; Word) -&gt; [StgWord] -&gt; [Word]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Word) -&gt; (StgWord -&gt; Integer) -&gt; StgWord -&gt; Word
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StgWord -&gt; Integer
</span><a href="GHC.Runtime.Heap.Layout.html#fromStgWord"><span class="hs-identifier hs-var">fromStgWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621682964076"><span class="hs-identifier hs-var">bitmap</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- instrs nonptrs ptrs</span><span>
</span><span id="line-240"></span><span class="hs-keyword">type</span><span> </span><span id="AsmState"><span class="annot"><a href="GHC.ByteCode.Asm.html#AsmState"><span class="hs-identifier hs-var">AsmState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">,</span><span>
</span><span id="line-241"></span><span>                 </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-242"></span><span>                 </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">data</span><span> </span><span id="Operand"><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-var">Operand</span></a></span></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Op"><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IOp"><span class="annot"><a href="GHC.ByteCode.Asm.html#IOp"><span class="hs-identifier hs-var">IOp</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SmallOp"><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-var">SmallOp</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LabelOp"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-var">LabelOp</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#wOp"><span class="hs-identifier hs-type">wOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span>
</span><span id="line-251"></span><span id="wOp"><span class="annot"><span class="annottext">wOp :: WordOff -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#wOp"><span class="hs-identifier hs-var hs-var">wOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Operand) -&gt; (WordOff -&gt; Word) -&gt; WordOff -&gt; Operand
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WordOff -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#bOp"><span class="hs-identifier hs-type">bOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#ByteOff"><span class="hs-identifier hs-type">ByteOff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span>
</span><span id="line-254"></span><span id="bOp"><span class="annot"><span class="annottext">bOp :: ByteOff -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#bOp"><span class="hs-identifier hs-var hs-var">bOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Operand) -&gt; (ByteOff -&gt; Word) -&gt; ByteOff -&gt; Operand
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteOff -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#truncHalfWord"><span class="hs-identifier hs-type">truncHalfWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#HalfWord"><span class="hs-identifier hs-type">HalfWord</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span>
</span><span id="line-257"></span><span id="truncHalfWord"><span class="annot"><span class="annottext">truncHalfWord :: Platform -&gt; HalfWord -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#truncHalfWord"><span class="hs-identifier hs-var hs-var">truncHalfWord</span></a></span></span><span> </span><span id="local-6989586621682964087"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964087"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964088"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964087"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">HalfWord -&gt; HalfWord -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><span class="hs-number">65535</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfWord -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">HalfWord -&gt; HalfWord -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><span class="hs-number">4294967295</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfWord -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">PlatformWordSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Operand
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.ByteCode.Asm.truncHalfWord&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfWord -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964088"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">data</span><span> </span><span id="Assembler"><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-var">Assembler</span></a></span></span><span> </span><span id="local-6989586621682963351"><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AllocPtr"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AllocLit"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AllocLabel"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Emit"><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NullAsm"><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-var">NullAsm</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682963351"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682964099"><span id="local-6989586621682964106"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b)
-&gt; (forall a b. a -&gt; Assembler b -&gt; Assembler a)
-&gt; Functor Assembler
forall a b. a -&gt; Assembler b -&gt; Assembler a
forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
fmap :: forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
$c&lt;$ :: forall a b. a -&gt; Assembler b -&gt; Assembler a
&lt;$ :: forall a b. a -&gt; Assembler b -&gt; Assembler a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682964118"><span id="local-6989586621682964122"><span id="local-6989586621682964125"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621682964128"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Assembler a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler a
forall a. a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-var">NullAsm</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621682964130"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Assembler (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assembler (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682964136"><span id="local-6989586621682964139"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span id="local-6989586621682964146"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682964146"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682964147"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
</span><span class="hs-operator hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621682964148"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964148"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964148"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682964146"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span id="local-6989586621682964149"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964149"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682964150"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964150"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621682964151"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964151"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; (Word -&gt; Assembler b) -&gt; Assembler b
forall a. IO BCOPtr -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964149"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964150"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Assembler a) -&gt; (a -&gt; Assembler b) -&gt; Word -&gt; Assembler b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964151"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621682964153"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964153"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682964154"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964154"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621682964155"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964155"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; (Word -&gt; Assembler b) -&gt; Assembler b
forall a. [BCONPtr] -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964153"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964154"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Assembler a) -&gt; (a -&gt; Assembler b) -&gt; Word -&gt; Assembler b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964155"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span id="local-6989586621682964156"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964156"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682964157"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964157"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621682964158"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964158"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Assembler b -&gt; Assembler b
forall a. LocalLabel -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964156"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964157"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
forall a b. Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964158"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span id="local-6989586621682964159"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964159"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964160"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964160"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682964161"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964161"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621682964162"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler b -&gt; Assembler b
forall a. Word16 -&gt; [Operand] -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964159"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964160"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964161"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
forall a b. Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621682964162"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-type">ioptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-282"></span><span id="ioptr"><span class="annot"><span class="annottext">ioptr :: IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var hs-var">ioptr</span></a></span></span><span> </span><span id="local-6989586621682964164"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964164"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; (Word -&gt; Assembler Word) -&gt; Assembler Word
forall a. IO BCOPtr -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964164"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
forall a. a -&gt; Assembler a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-285"></span><span id="ptr"><span class="annot"><span class="annottext">ptr :: BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="annot"><span class="annottext">(IO BCOPtr -&gt; Assembler Word)
-&gt; (BCOPtr -&gt; IO BCOPtr) -&gt; BCOPtr -&gt; Assembler Word
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; IO BCOPtr
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-288"></span><span id="lit"><span class="annot"><span class="annottext">lit :: [BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621682964167"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964167"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; (Word -&gt; Assembler Word) -&gt; Assembler Word
forall a. [BCONPtr] -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964167"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
forall a. a -&gt; Assembler a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span id="label"><span class="annot"><span class="annottext">label :: LocalLabel -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621682964169"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964169"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Assembler () -&gt; Assembler ()
forall a. LocalLabel -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964169"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Assembler ()
forall a. a -&gt; Assembler a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span id="emit"><span class="annot"><span class="annottext">emit :: Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var hs-var">emit</span></a></span></span><span> </span><span id="local-6989586621682964171"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964171"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964172"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964172"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler () -&gt; Assembler ()
forall a. Word16 -&gt; [Operand] -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964171"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964172"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Assembler ()
forall a. a -&gt; Assembler a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">type</span><span> </span><span id="LabelEnv"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnv"><span class="hs-identifier hs-var">LabelEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-type">largeOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-299"></span><span id="largeOp"><span class="annot"><span class="annottext">largeOp :: Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var hs-var">largeOp</span></a></span></span><span> </span><span id="local-6989586621682964175"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964175"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621682964176"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682964176"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621682964176"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-300"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-301"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621682964177"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964177"><span class="hs-identifier hs-var">w</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeW"><span class="hs-identifier hs-var">isLargeW</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964177"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-302"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#IOp"><span class="hs-identifier hs-type">IOp</span></a></span><span> </span><span id="local-6989586621682964178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964178"><span class="hs-identifier hs-var">i</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeI"><span class="hs-identifier hs-var">isLargeI</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964178"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-303"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964175"><span class="hs-identifier hs-var">long_jumps</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621682963305"><span class="annot"><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-type">runAsm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnv"><span class="hs-identifier hs-type">LabelEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963305"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AsmState"><span class="hs-identifier hs-type">AsmState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682963305"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-306"></span><span id="runAsm"><span class="annot"><span class="annottext">runAsm :: forall a.
Platform
-&gt; Bool
-&gt; (LocalLabel -&gt; Word)
-&gt; Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-var hs-var">runAsm</span></a></span></span><span> </span><span id="local-6989586621682964201"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964201"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964202"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964202"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621682964203"><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621682964203"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621682964204"><span class="annot"><span class="annottext">go :: Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621682964204"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span id="local-6989586621682964205"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682964205"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
forall a.
a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682964205"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span id="local-6989586621682964206"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964206"><span class="hs-identifier hs-var">p_io</span></a></span></span><span> </span><span id="local-6989586621682964207"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964207"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>      </span><span id="local-6989586621682964208"><span class="annot"><a href="#local-6989586621682964208"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO BCOPtr
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621682964206"><span class="hs-identifier hs-var">p_io</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621682964210"><span class="annot"><a href="#local-6989586621682964210"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#state"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682964212"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964212"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964213"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964213"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964214"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964214"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964215"><span class="annot"><span class="annottext">st_p1 :: SizedSeq BCOPtr
</span><a href="#local-6989586621682964215"><span class="hs-identifier hs-var hs-var">st_p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr -&gt; BCOPtr -&gt; SizedSeq BCOPtr
forall a. SizedSeq a -&gt; a -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#addToSS"><span class="hs-identifier hs-var">addToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964214"><span class="hs-identifier hs-var">st_p0</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621682964208"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq BCOPtr -&gt; Word
forall a. SizedSeq a -&gt; Word
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#sizeSS"><span class="hs-identifier hs-var">sizeSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964214"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964212"><span class="hs-identifier hs-var">st_i0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964213"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964215"><span class="hs-identifier hs-var">st_p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682964207"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964210"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621682964217"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964217"><span class="hs-identifier hs-var">lits</span></a></span></span><span> </span><span id="local-6989586621682964218"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964218"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>      </span><span id="local-6989586621682964219"><span class="annot"><a href="#local-6989586621682964219"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
 -&gt; (Word, (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO Word
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">(((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
  -&gt; (Word, (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
 -&gt; StateT
      (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO Word)
-&gt; ((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
    -&gt; (Word, (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682964220"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964220"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964221"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964221"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964222"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964222"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964223"><span class="annot"><span class="annottext">st_l1 :: SizedSeq BCONPtr
</span><a href="#local-6989586621682964223"><span class="hs-identifier hs-var hs-var">st_l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr -&gt; [BCONPtr] -&gt; SizedSeq BCONPtr
forall a. SizedSeq a -&gt; [a] -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#addListToSS"><span class="hs-identifier hs-var">addListToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964221"><span class="hs-identifier hs-var">st_l0</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964217"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq BCONPtr -&gt; Word
forall a. SizedSeq a -&gt; Word
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#sizeSS"><span class="hs-identifier hs-var">sizeSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964221"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964220"><span class="hs-identifier hs-var">st_i0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964223"><span class="hs-identifier hs-var">st_l1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964222"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682964218"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964219"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682964225"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964225"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964225"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span id="local-6989586621682964226"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964226"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964227"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964227"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682964228"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964228"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964229"><span class="annot"><span class="annottext">largeArgs :: Bool
</span><a href="#local-6989586621682964229"><span class="hs-identifier hs-var hs-var hs-var">largeArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Bool) -&gt; [Operand] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var">largeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964202"><span class="hs-identifier hs-var">long_jumps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964227"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-323"></span><span>          </span><span id="local-6989586621682964231"><span class="annot"><span class="annottext">opcode :: Word16
</span><a href="#local-6989586621682964231"><span class="hs-identifier hs-var hs-var hs-var">opcode</span></a></span></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964229"><span class="hs-identifier hs-var">largeArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-var">largeArgInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964226"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964226"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-326"></span><span>          </span><span id="local-6989586621682964233"><span class="annot"><span class="annottext">words :: [Word16]
</span><a href="#local-6989586621682964233"><span class="hs-identifier hs-var hs-var hs-var">words</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; [Word16]) -&gt; [Operand] -&gt; [Word16]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Word16]
</span><a href="#local-6989586621682964234"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964227"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-327"></span><span>          </span><span id="local-6989586621682964234"><span class="annot"><span class="annottext">expand :: Operand -&gt; [Word16]
</span><a href="#local-6989586621682964234"><span class="hs-identifier hs-var hs-var hs-var">expand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span id="local-6989586621682964235"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964235"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964235"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>          </span><span class="annot"><a href="#local-6989586621682964234"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span id="local-6989586621682964236"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964236"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Word16]
</span><a href="#local-6989586621682964234"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621682964203"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964236"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>          </span><span class="annot"><a href="#local-6989586621682964234"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621682964237"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964237"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964229"><span class="hs-identifier hs-var">largeArgs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word64 -&gt; [Word16]
</span><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-var">largeArg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964201"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964237"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964237"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>          </span><span class="annot"><a href="#local-6989586621682964234"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#IOp"><span class="hs-identifier hs-type">IOp</span></a></span><span> </span><span id="local-6989586621682964239"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964239"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964229"><span class="hs-identifier hs-var">largeArgs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word64 -&gt; [Word16]
</span><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-var">largeArg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964201"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964239"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964239"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><span class="annottext">((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
 -&gt; ((), (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.6.1.2-38b1/src/Control.Monad.Trans.State.Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">(((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
  -&gt; ((), (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
 -&gt; StateT
      (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ())
-&gt; ((SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)
    -&gt; ((), (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr)))
-&gt; StateT
     (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682964240"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964240"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964241"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964241"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682964242"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964242"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964243"><span class="annot"><span class="annottext">st_i1 :: SizedSeq Word16
</span><a href="#local-6989586621682964243"><span class="hs-identifier hs-var hs-var">st_i1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16 -&gt; [Word16] -&gt; SizedSeq Word16
forall a. SizedSeq a -&gt; [a] -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.12.2-1a37/src/GHC.Data.SizedSeq.html#addListToSS"><span class="hs-identifier hs-var">addListToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964240"><span class="hs-identifier hs-var">st_i0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964231"><span class="hs-identifier hs-var">opcode</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Word16] -&gt; [Word16]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621682964233"><span class="hs-identifier hs-var">words</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621682964243"><span class="hs-identifier hs-var">st_i1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621682964241"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621682964242"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621682964204"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964228"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">type</span><span> </span><span id="LabelEnvMap"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-var">LabelEnvMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-keyword">data</span><span> </span><span id="InspectState"><span class="annot"><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InspectState"><span class="annot"><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="instrCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var hs-var">instrCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ptrCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var hs-var">ptrCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="litCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var hs-var">litCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lblEnv"><span class="annot"><span class="annottext">InspectState -&gt; LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var hs-var">lblEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-type">LabelEnvMap</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621682963280"><span class="annot"><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-type">inspectAsm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682963280"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-type">LabelEnvMap</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-346"></span><span id="inspectAsm"><span class="annot"><span class="annottext">inspectAsm :: forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var hs-var">inspectAsm</span></a></span></span><span> </span><span id="local-6989586621682964263"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964263"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964264"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964264"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621682964265"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964265"><span class="hs-identifier hs-var">initial_offset</span></a></span></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; LabelEnvMap -&gt; InspectState
</span><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964265"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621682964266"><span class="annot"><span class="annottext">go :: InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682964268"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682964269"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964269"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682964270"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964270"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964269"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var">ptrCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682964271"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964270"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964271"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682964271"><span class="annot"><span class="annottext">n :: Word
</span><a href="#local-6989586621682964271"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var">ptrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964269"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682964273"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964273"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621682964274"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621682964274"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621682964275"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964275"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964273"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var">litCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682964276"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">genericLength</span></span><span> </span><span class="annot"><a href="#local-6989586621682964274"><span class="hs-identifier hs-type">ls</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621682964275"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964276"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682964276"><span class="annot"><span class="annottext">n :: Word
</span><a href="#local-6989586621682964276"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var">litCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964273"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682964277"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964277"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span id="local-6989586621682964278"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964278"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621682964279"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964279"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964280"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964279"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682964280"><span class="annot"><span class="annottext">s' :: InspectState
</span><a href="#local-6989586621682964280"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964277"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#insert"><span class="hs-identifier hs-type">Map.insert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964278"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964277"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964277"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682964282"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964282"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682964283"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964283"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682964284"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964284"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621682964266"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964285"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621682964284"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>        </span><span id="local-6989586621682964285"><span class="annot"><span class="annottext">s' :: InspectState
</span><a href="#local-6989586621682964285"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621682964282"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964282"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682964286"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621682964286"><span class="annot"><span class="annottext">size :: Word
</span><a href="#local-6989586621682964286"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Word
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Operand -&gt; Word) -&gt; [Operand] -&gt; [Word]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Word
</span><a href="#local-6989586621682964288"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964283"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621682964289"><span class="annot"><span class="annottext">largeOps :: Bool
</span><a href="#local-6989586621682964289"><span class="hs-identifier hs-var hs-var">largeOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Operand -&gt; Bool) -&gt; [Operand] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var">largeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964264"><span class="hs-identifier hs-var">long_jumps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621682964283"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span id="local-6989586621682964288"><span class="annot"><span class="annottext">count :: Operand -&gt; Word
</span><a href="#local-6989586621682964288"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><a href="#local-6989586621682964288"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Word
</span><a href="#local-6989586621682964288"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="#local-6989586621682964288"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964289"><span class="hs-identifier hs-var">largeOps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-var">largeArg16s</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964263"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><a href="#local-6989586621682964288"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#IOp"><span class="hs-identifier hs-type">IOp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682964289"><span class="hs-identifier hs-var">largeOps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-var">largeArg16s</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964263"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- Bring in all the bci_ bytecode constants.</span><span class="hs-cpp">
#include &quot;Bytecodes.h&quot;
</span><span>
</span><span id="line-369"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-type">largeArgInstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-370"></span><span id="largeArgInstr"><span class="annot"><span class="annottext">largeArgInstr :: Word16 -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-var hs-var">largeArgInstr</span></a></span></span><span> </span><span id="local-6989586621682964291"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964291"><span class="hs-identifier hs-var">bci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_FLAG_LARGE_ARGS</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">bci</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-type">largeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span id="largeArg"><span class="annot"><span class="annottext">largeArg :: Platform -&gt; Word64 -&gt; [Word16]
</span><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-var hs-var">largeArg</span></a></span></span><span> </span><span id="local-6989586621682964293"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964293"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964294"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964293"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-374"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>           </span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>           </span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-377"></span><span>           </span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; [Word16] -&gt; [Word16]
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;largeArg too big:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word16] -&gt; [Word16]) -&gt; [Word16] -&gt; [Word16]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-381"></span><span>           </span><span class="annot"><span class="annottext">Word64 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964294"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-type">largeArg16s</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-384"></span><span id="largeArg16s"><span class="annot"><span class="annottext">largeArg16s :: Platform -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-var hs-var">largeArg16s</span></a></span></span><span> </span><span id="local-6989586621682964300"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964300"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964300"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">4</span></span><span>
</span><span id="line-386"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-type">assembleI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-389"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#BCInstr"><span class="hs-identifier hs-type">BCInstr</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span id="assembleI"><span class="annot"><span class="annottext">assembleI :: Platform -&gt; BCInstr -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-var hs-var">assembleI</span></a></span></span><span> </span><span id="local-6989586621682964301"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964302"><span class="annot"><span class="annottext">BCInstr
</span><a href="#local-6989586621682964302"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BCInstr
</span><a href="#local-6989586621682964302"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#STKCHECK"><span class="hs-identifier hs-type">STKCHECK</span></a></span><span> </span><span id="local-6989586621682964304"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964304"><span class="hs-identifier hs-var">n</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_STKCHECK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_L"><span class="hs-identifier hs-type">PUSH_L</span></a></span><span> </span><span id="local-6989586621682964306"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964306"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_L</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_LL"><span class="hs-identifier hs-type">PUSH_LL</span></a></span><span> </span><span id="local-6989586621682964308"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964308"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621682964309"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964309"><span class="hs-identifier hs-var">o2</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_LL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o2</span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_LLL"><span class="hs-identifier hs-type">PUSH_LLL</span></a></span><span> </span><span id="local-6989586621682964311"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964311"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621682964312"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964312"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span id="local-6989586621682964313"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964313"><span class="hs-identifier hs-var">o3</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_LLL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">o3</span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH8"><span class="hs-identifier hs-type">PUSH8</span></a></span><span> </span><span id="local-6989586621682964315"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964315"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH16"><span class="hs-identifier hs-type">PUSH16</span></a></span><span> </span><span id="local-6989586621682964317"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964317"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH32"><span class="hs-identifier hs-type">PUSH32</span></a></span><span> </span><span id="local-6989586621682964319"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964319"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH8_W"><span class="hs-identifier hs-type">PUSH8_W</span></a></span><span> </span><span id="local-6989586621682964321"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964321"><span class="hs-identifier hs-var">o1</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH8_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH16_W"><span class="hs-identifier hs-type">PUSH16_W</span></a></span><span> </span><span id="local-6989586621682964323"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964323"><span class="hs-identifier hs-var">o1</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH16_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH32_W"><span class="hs-identifier hs-type">PUSH32_W</span></a></span><span> </span><span id="local-6989586621682964325"><span class="annot"><span class="annottext">ByteOff
</span><a href="#local-6989586621682964325"><span class="hs-identifier hs-var">o1</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH32_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">bOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_G"><span class="hs-identifier hs-type">PUSH_G</span></a></span><span> </span><span id="local-6989586621682964327"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964327"><span class="hs-identifier hs-var">nm</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964328"><span class="annot"><a href="#local-6989586621682964328"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrName"><span class="hs-identifier hs-var">BCOPtrName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964327"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_PRIMOP"><span class="hs-identifier hs-type">PUSH_PRIMOP</span></a></span><span> </span><span id="local-6989586621682964330"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682964330"><span class="hs-identifier hs-var">op</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964331"><span class="annot"><a href="#local-6989586621682964331"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrPrimOp"><span class="hs-identifier hs-var">BCOPtrPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682964330"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_BCO"><span class="hs-identifier hs-type">PUSH_BCO</span></a></span><span> </span><span id="local-6989586621682964334"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964334"><span class="hs-identifier hs-var">proto</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964335"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621682964335"><span class="hs-identifier hs-var hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964334"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-407"></span><span>                                 </span><span id="local-6989586621682964336"><span class="annot"><a href="#local-6989586621682964336"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; BCOPtr) -&gt; IO UnlinkedBCO -&gt; IO BCOPtr
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621682964335"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ALTS"><span class="hs-identifier hs-type">PUSH_ALTS</span></a></span><span> </span><span id="local-6989586621682964339"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964339"><span class="hs-identifier hs-var">proto</span></a></span></span><span> </span><span id="local-6989586621682964340"><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621682964340"><span class="hs-identifier hs-var">pk</span></a></span></span><span>
</span><span id="line-410"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964341"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621682964341"><span class="hs-identifier hs-var hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964339"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-411"></span><span>                                 </span><span id="local-6989586621682964342"><span class="annot"><a href="#local-6989586621682964342"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; BCOPtr) -&gt; IO UnlinkedBCO -&gt; IO BCOPtr
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621682964341"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-type">push_alts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964340"><span class="hs-identifier hs-type">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964342"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ALTS_TUPLE"><span class="hs-identifier hs-type">PUSH_ALTS_TUPLE</span></a></span><span> </span><span id="local-6989586621682964345"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964345"><span class="hs-identifier hs-var">proto</span></a></span></span><span> </span><span id="local-6989586621682964346"><span class="annot"><span class="annottext">NativeCallInfo
</span><a href="#local-6989586621682964346"><span class="hs-identifier hs-var">call_info</span></a></span></span><span> </span><span id="local-6989586621682964347"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964347"><span class="hs-identifier hs-var">tuple_proto</span></a></span></span><span>
</span><span id="line-414"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682964348"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621682964348"><span class="hs-identifier hs-var hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964345"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-415"></span><span>                                     </span><span id="local-6989586621682964349"><span class="annot"><span class="annottext">ul_tuple_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621682964349"><span class="hs-identifier hs-var hs-var hs-var">ul_tuple_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-416"></span><span>                                                                </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621682964347"><span class="hs-identifier hs-var">tuple_proto</span></a></span><span>
</span><span id="line-417"></span><span>                                 </span><span id="local-6989586621682964350"><span class="annot"><a href="#local-6989586621682964350"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnlinkedBCO -&gt; BCOPtr) -&gt; IO UnlinkedBCO -&gt; IO BCOPtr
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621682964348"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>                                 </span><span id="local-6989586621682964351"><span class="annot"><a href="#local-6989586621682964351"><span class="hs-identifier hs-var">p_tup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-type">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">liftM</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964349"><span class="hs-identifier hs-type">ul_tuple_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>                                 </span><span id="local-6989586621682964352"><span class="annot"><a href="#local-6989586621682964352"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682964353"><span class="hs-identifier hs-type">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-420"></span><span>                                              </span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoSig"><span class="hs-identifier hs-type">mkNativeCallInfoSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964301"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964346"><span class="hs-identifier hs-type">call_info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_T</span><span>
</span><span id="line-422"></span><span>                                      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964350"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964352"><span class="hs-identifier hs-type">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964351"><span class="hs-identifier hs-type">p_tup</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD8"><span class="hs-identifier hs-var">PUSH_PAD8</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD8</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD16"><span class="hs-identifier hs-var">PUSH_PAD16</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD16</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD32"><span class="hs-identifier hs-var">PUSH_PAD32</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD32</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX8"><span class="hs-identifier hs-type">PUSH_UBX8</span></a></span><span> </span><span id="local-6989586621682964359"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964359"><span class="hs-identifier hs-var">lit</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964360"><span class="annot"><a href="#local-6989586621682964360"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964359"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-427"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX16"><span class="hs-identifier hs-type">PUSH_UBX16</span></a></span><span> </span><span id="local-6989586621682964363"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964363"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964364"><span class="annot"><a href="#local-6989586621682964364"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964363"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-429"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX32"><span class="hs-identifier hs-type">PUSH_UBX32</span></a></span><span> </span><span id="local-6989586621682964366"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964366"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964367"><span class="annot"><a href="#local-6989586621682964367"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964366"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-431"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX"><span class="hs-identifier hs-type">PUSH_UBX</span></a></span><span> </span><span id="local-6989586621682964369"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964369"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621682964370"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964370"><span class="hs-identifier hs-var">nws</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964371"><span class="annot"><a href="#local-6989586621682964371"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682964369"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-433"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">nws</span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-comment">-- see Note [Generating code for top-level string literal bindings] in GHC.StgToByteCode</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ADDR"><span class="hs-identifier hs-type">PUSH_ADDR</span></a></span><span> </span><span id="local-6989586621682964373"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964373"><span class="hs-identifier hs-var">nm</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964374"><span class="annot"><a href="#local-6989586621682964374"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrAddr"><span class="hs-identifier hs-var">BCONPtrAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682964373"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_N"><span class="hs-identifier hs-var">PUSH_APPLY_N</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_N</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_V"><span class="hs-identifier hs-var">PUSH_APPLY_V</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_V</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_F"><span class="hs-identifier hs-var">PUSH_APPLY_F</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_F</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_D"><span class="hs-identifier hs-var">PUSH_APPLY_D</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_D</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_L"><span class="hs-identifier hs-var">PUSH_APPLY_L</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_L</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_P"><span class="hs-identifier hs-var">PUSH_APPLY_P</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_P</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PP"><span class="hs-identifier hs-var">PUSH_APPLY_PP</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPP</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPP</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPPP</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPPPP</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#SLIDE"><span class="hs-identifier hs-type">SLIDE</span></a></span><span>     </span><span id="local-6989586621682964388"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964388"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682964389"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964389"><span class="hs-identifier hs-var">by</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_SLIDE</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">by</span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_AP"><span class="hs-identifier hs-type">ALLOC_AP</span></a></span><span>  </span><span id="local-6989586621682964391"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964391"><span class="hs-identifier hs-var">n</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_AP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_AP_NOUPD"><span class="hs-identifier hs-type">ALLOC_AP_NOUPD</span></a></span><span> </span><span id="local-6989586621682964393"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964393"><span class="hs-identifier hs-var">n</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_AP_NOUPD</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_PAP"><span class="hs-identifier hs-type">ALLOC_PAP</span></a></span><span> </span><span id="local-6989586621682964395"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964395"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621682964396"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964396"><span class="hs-identifier hs-var">n</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_PAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">arity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#MKAP"><span class="hs-identifier hs-type">MKAP</span></a></span><span>      </span><span id="local-6989586621682964398"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964398"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682964399"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964399"><span class="hs-identifier hs-var">sz</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_MKAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#MKPAP"><span class="hs-identifier hs-type">MKPAP</span></a></span><span>     </span><span id="local-6989586621682964401"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964401"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682964402"><span class="annot"><span class="annottext">HalfWord
</span><a href="#local-6989586621682964402"><span class="hs-identifier hs-var">sz</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_MKPAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">truncHalfWord</span><span> </span><span class="hs-identifier">platform</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#UNPACK"><span class="hs-identifier hs-type">UNPACK</span></a></span><span>    </span><span id="local-6989586621682964404"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964404"><span class="hs-identifier hs-var">n</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_UNPACK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PACK"><span class="hs-identifier hs-type">PACK</span></a></span><span>      </span><span id="local-6989586621682964406"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682964406"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621682964407"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964407"><span class="hs-identifier hs-var">sz</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964408"><span class="annot"><a href="#local-6989586621682964408"><span class="hs-identifier hs-var">itbl_no</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrItbl"><span class="hs-identifier hs-var">BCONPtrItbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682964406"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-459"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_PACK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">itbl_no</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LABEL"><span class="hs-identifier hs-type">LABEL</span></a></span><span>     </span><span id="local-6989586621682964411"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964411"><span class="hs-identifier hs-var">lbl</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964411"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I"><span class="hs-identifier hs-type">TESTLT_I</span></a></span><span>  </span><span id="local-6989586621682964413"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964413"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964414"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964414"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964415"><span class="annot"><a href="#local-6989586621682964415"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621682964416"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964413"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-462"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I"><span class="hs-identifier hs-type">TESTEQ_I</span></a></span><span>  </span><span id="local-6989586621682964418"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964418"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964419"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964419"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964420"><span class="annot"><a href="#local-6989586621682964420"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621682964416"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964418"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-464"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W"><span class="hs-identifier hs-type">TESTLT_W</span></a></span><span>  </span><span id="local-6989586621682964422"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964422"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964423"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964423"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964424"><span class="annot"><a href="#local-6989586621682964424"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964422"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-466"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W"><span class="hs-identifier hs-type">TESTEQ_W</span></a></span><span>  </span><span id="local-6989586621682964426"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964426"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964427"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964427"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964428"><span class="annot"><a href="#local-6989586621682964428"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964426"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-468"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I64"><span class="hs-identifier hs-type">TESTLT_I64</span></a></span><span>  </span><span id="local-6989586621682964430"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682964430"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964431"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964431"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964432"><span class="annot"><a href="#local-6989586621682964432"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682964430"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I64</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I64"><span class="hs-identifier hs-type">TESTEQ_I64</span></a></span><span>  </span><span id="local-6989586621682964435"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682964435"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964436"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964436"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964437"><span class="annot"><a href="#local-6989586621682964437"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682964435"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I64</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I32"><span class="hs-identifier hs-type">TESTLT_I32</span></a></span><span>  </span><span id="local-6989586621682964439"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621682964439"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964440"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964440"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964441"><span class="annot"><a href="#local-6989586621682964441"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621682964439"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I32"><span class="hs-identifier hs-type">TESTEQ_I32</span></a></span><span> </span><span id="local-6989586621682964443"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621682964443"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964444"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964444"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964445"><span class="annot"><a href="#local-6989586621682964445"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621682964443"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I16"><span class="hs-identifier hs-type">TESTLT_I16</span></a></span><span>  </span><span id="local-6989586621682964447"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964447"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964448"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964448"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964449"><span class="annot"><a href="#local-6989586621682964449"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964447"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I16"><span class="hs-identifier hs-type">TESTEQ_I16</span></a></span><span> </span><span id="local-6989586621682964451"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964451"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964452"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964452"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964453"><span class="annot"><a href="#local-6989586621682964453"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964451"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I8"><span class="hs-identifier hs-type">TESTLT_I8</span></a></span><span>  </span><span id="local-6989586621682964455"><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621682964455"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964456"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964456"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964457"><span class="annot"><a href="#local-6989586621682964457"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621682964455"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I8"><span class="hs-identifier hs-type">TESTEQ_I8</span></a></span><span> </span><span id="local-6989586621682964459"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964459"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964460"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964460"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964461"><span class="annot"><a href="#local-6989586621682964461"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621682964459"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W64"><span class="hs-identifier hs-type">TESTLT_W64</span></a></span><span>  </span><span id="local-6989586621682964463"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964463"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964464"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964464"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964465"><span class="annot"><a href="#local-6989586621682964465"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964463"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-486"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W64</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W64"><span class="hs-identifier hs-type">TESTEQ_W64</span></a></span><span>  </span><span id="local-6989586621682964467"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964467"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964468"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964468"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964469"><span class="annot"><a href="#local-6989586621682964469"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964467"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-488"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W64</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W32"><span class="hs-identifier hs-type">TESTLT_W32</span></a></span><span>  </span><span id="local-6989586621682964471"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964471"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964472"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964472"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964473"><span class="annot"><a href="#local-6989586621682964473"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964471"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W32"><span class="hs-identifier hs-type">TESTEQ_W32</span></a></span><span>  </span><span id="local-6989586621682964475"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964475"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964476"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964476"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964477"><span class="annot"><a href="#local-6989586621682964477"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964475"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W16"><span class="hs-identifier hs-type">TESTLT_W16</span></a></span><span>  </span><span id="local-6989586621682964479"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964479"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964480"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964480"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964481"><span class="annot"><a href="#local-6989586621682964481"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964479"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W16"><span class="hs-identifier hs-type">TESTEQ_W16</span></a></span><span>  </span><span id="local-6989586621682964483"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964483"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964484"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964484"><span class="hs-identifier hs-var">l</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964485"><span class="annot"><a href="#local-6989586621682964485"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964483"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W8"><span class="hs-identifier hs-type">TESTLT_W8</span></a></span><span>  </span><span id="local-6989586621682964487"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964487"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964488"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964488"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964489"><span class="annot"><a href="#local-6989586621682964489"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964487"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W8"><span class="hs-identifier hs-type">TESTEQ_W8</span></a></span><span>  </span><span id="local-6989586621682964491"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964491"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621682964492"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964492"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964493"><span class="annot"><a href="#local-6989586621682964493"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964491"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_F"><span class="hs-identifier hs-type">TESTLT_F</span></a></span><span>  </span><span id="local-6989586621682964495"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964495"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682964496"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964496"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964497"><span class="annot"><a href="#local-6989586621682964497"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621682964498"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964495"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-502"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_F</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_F"><span class="hs-identifier hs-type">TESTEQ_F</span></a></span><span>  </span><span id="local-6989586621682964500"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964500"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682964501"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964501"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964502"><span class="annot"><a href="#local-6989586621682964502"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621682964498"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964500"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-504"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_F</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_D"><span class="hs-identifier hs-type">TESTLT_D</span></a></span><span>  </span><span id="local-6989586621682964504"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964504"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682964505"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964505"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964506"><span class="annot"><a href="#local-6989586621682964506"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621682964507"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964504"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-506"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_D</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_D"><span class="hs-identifier hs-type">TESTEQ_D</span></a></span><span>  </span><span id="local-6989586621682964509"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964509"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682964510"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964510"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964511"><span class="annot"><a href="#local-6989586621682964511"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621682964507"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964509"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-508"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_D</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_P"><span class="hs-identifier hs-type">TESTLT_P</span></a></span><span>  </span><span id="local-6989586621682964513"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964513"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964514"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964514"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_P"><span class="hs-identifier hs-type">TESTEQ_P</span></a></span><span>  </span><span id="local-6989586621682964516"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964516"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682964517"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964517"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#CASEFAIL"><span class="hs-identifier hs-var">CASEFAIL</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_CASEFAIL</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#SWIZZLE"><span class="hs-identifier hs-type">SWIZZLE</span></a></span><span>   </span><span id="local-6989586621682964520"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964520"><span class="hs-identifier hs-var">stkoff</span></a></span></span><span> </span><span id="local-6989586621682964521"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964521"><span class="hs-identifier hs-var">n</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_SWIZZLE</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">stkoff</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">IOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span>       </span><span id="local-6989586621682964523"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621682964523"><span class="hs-identifier hs-var">l</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_JMP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#ENTER"><span class="hs-identifier hs-var">ENTER</span></a></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ENTER</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#RETURN"><span class="hs-identifier hs-type">RETURN</span></a></span><span> </span><span id="local-6989586621682964526"><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621682964526"><span class="hs-identifier hs-var">rep</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621682964526"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#RETURN_TUPLE"><span class="hs-identifier hs-var">RETURN_TUPLE</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_RETURN_T</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#CCALL"><span class="hs-identifier hs-type">CCALL</span></a></span><span> </span><span id="local-6989586621682964530"><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964530"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621682964531"><span class="annot"><span class="annottext">RemotePtr C_ffi_cif
</span><a href="#local-6989586621682964531"><span class="hs-identifier hs-var">m_addr</span></a></span></span><span> </span><span id="local-6989586621682964532"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964532"><span class="hs-identifier hs-var">i</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964533"><span class="annot"><a href="#local-6989586621682964533"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RemotePtr C_ffi_cif -&gt; Assembler Word
forall {a}. RemotePtr a -&gt; Assembler Word
</span><a href="#local-6989586621682964534"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">RemotePtr C_ffi_cif
</span><a href="#local-6989586621682964531"><span class="hs-identifier hs-var">m_addr</span></a></span><span>
</span><span id="line-518"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_CCALL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">wOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">]</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PRIMCALL"><span class="hs-identifier hs-var">PRIMCALL</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PRIMCALL</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#BRK_FUN"><span class="hs-identifier hs-type">BRK_FUN</span></a></span><span> </span><span id="local-6989586621682964537"><span class="annot"><span class="annottext">ForeignRef BreakArray
</span><a href="#local-6989586621682964537"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621682964538"><span class="annot"><span class="annottext">RemotePtr ModuleName
</span><a href="#local-6989586621682964538"><span class="hs-identifier hs-var">tick_mod</span></a></span></span><span> </span><span id="local-6989586621682964539"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964539"><span class="hs-identifier hs-var">tickx</span></a></span></span><span> </span><span id="local-6989586621682964540"><span class="annot"><span class="annottext">RemotePtr ModuleName
</span><a href="#local-6989586621682964540"><span class="hs-identifier hs-var">info_mod</span></a></span></span><span> </span><span id="local-6989586621682964541"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964541"><span class="hs-identifier hs-var">infox</span></a></span></span><span> </span><span id="local-6989586621682964542"><span class="annot"><span class="annottext">RemotePtr CostCentre
</span><a href="#local-6989586621682964542"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-521"></span><span>                              </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682964543"><span class="annot"><a href="#local-6989586621682964543"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignRef BreakArray -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBreakArray"><span class="hs-identifier hs-var">BCOPtrBreakArray</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignRef BreakArray
</span><a href="#local-6989586621682964537"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>                                 </span><span id="local-6989586621682964545"><span class="annot"><a href="#local-6989586621682964545"><span class="hs-identifier hs-var">tick_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682964534"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964538"><span class="hs-identifier hs-type">tick_mod</span></a></span><span>
</span><span id="line-523"></span><span>                                 </span><span id="local-6989586621682964546"><span class="annot"><a href="#local-6989586621682964546"><span class="hs-identifier hs-var">info_addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682964534"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964540"><span class="hs-identifier hs-type">info_mod</span></a></span><span>
</span><span id="line-524"></span><span>                                 </span><span id="local-6989586621682964547"><span class="annot"><a href="#local-6989586621682964547"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682964534"><span class="hs-identifier hs-type">addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682964542"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-525"></span><span>                                 </span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-identifier">bci_BRK_FUN</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p1</span><span>
</span><span id="line-526"></span><span>                                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">tick_addr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">info_addr</span><span>
</span><span id="line-527"></span><span>                                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">tickx</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">infox</span><span>
</span><span id="line-528"></span><span>                                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span>
</span><span id="line-529"></span><span>                                                  </span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621682964361"><span class="annot"><span class="annottext">literal :: Literal -&gt; Assembler Word
</span><a href="#local-6989586621682964361"><span class="hs-identifier hs-var hs-var">literal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitLabel"><span class="hs-identifier hs-type">LitLabel</span></a></span><span> </span><span id="local-6989586621682964577"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682964577"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Assembler Word
</span><a href="#local-6989586621682964578"><span class="hs-identifier hs-var">litlabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682964577"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Types.Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682964581"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682964581"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621682964498"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Float
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682964581"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682964583"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682964583"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621682964507"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682964583"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span> </span><span id="local-6989586621682964585"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682964585"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621682964416"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682964585"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682964587"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682964587"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-var">BCONPtrStr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682964587"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>       </span><span class="hs-comment">-- LitString requires a zero-terminator when emitted</span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682964589"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682964589"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621682964590"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682964589"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Assembler Word
</span><a href="#local-6989586621682964594"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Assembler Word
</span><a href="#local-6989586621682964594"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Assembler Word
</span><a href="#local-6989586621682964597"><span class="hs-identifier hs-var">word16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Assembler Word
</span><a href="#local-6989586621682964597"><span class="hs-identifier hs-var">word16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Assembler Word
</span><a href="#local-6989586621682964600"><span class="hs-identifier hs-var">word32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Assembler Word
</span><a href="#local-6989586621682964600"><span class="hs-identifier hs-var">word32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682964590"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumBigNat"><span class="hs-identifier hs-var">LitNumBigNat</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assembler Word
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.ByteCode.Asm.literal: LitNumBigNat&quot;</span></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-comment">-- We can lower 'LitRubbish' to an arbitrary constant, but @NULL@ is most</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-comment">-- likely to elicit a crash (rather than corrupt memory) in case absence</span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-comment">-- analysis messed up.</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="#local-6989586621682964361"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-type">LitRubbish</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621682964578"><span class="annot"><span class="annottext">litlabel :: FastString -&gt; Assembler Word
</span><a href="#local-6989586621682964578"><span class="hs-identifier hs-var hs-var">litlabel</span></a></span></span><span> </span><span id="local-6989586621682964606"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682964606"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FastString -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrLbl"><span class="hs-identifier hs-var">BCONPtrLbl</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682964606"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621682964534"><span class="annot"><span class="annottext">addr :: RemotePtr a -&gt; Assembler Word
</span><a href="#local-6989586621682964534"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghci-9.12.2-bd10/src/GHCi.RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span id="local-6989586621682964610"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964610"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621682964611"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964610"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621682964611"><span class="annot"><span class="annottext">words :: [Word] -&gt; Assembler Word
</span><a href="#local-6989586621682964611"><span class="hs-identifier hs-var hs-var">words</span></a></span></span><span> </span><span id="local-6989586621682964612"><span class="annot"><span class="annottext">[Word]
</span><a href="#local-6989586621682964612"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word -&gt; BCONPtr) -&gt; [Word] -&gt; [BCONPtr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrWord"><span class="hs-identifier hs-var">BCONPtrWord</span></a></span><span> </span><span class="annot"><span class="annottext">[Word]
</span><a href="#local-6989586621682964612"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621682964353"><span class="annot"><span class="annottext">word :: Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var hs-var">word</span></a></span></span><span> </span><span id="local-6989586621682964613"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964613"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621682964611"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964613"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621682964614"><span class="annot"><span class="annottext">word_size :: PlatformWordSize
</span><a href="#local-6989586621682964614"><span class="hs-identifier hs-var hs-var">word_size</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621682964615"><span class="annot"><span class="annottext">word_size_bits :: Int
</span><a href="#local-6989586621682964615"><span class="hs-identifier hs-var hs-var">word_size_bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int
</span><a href="GHC.Platform.html#platformWordSizeInBits"><span class="hs-identifier hs-var">platformWordSizeInBits</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-comment">-- Make lists of host-sized words for literals, so that when the</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-comment">-- words are placed in memory at increasing addresses, the</span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-comment">-- bit pattern is correct for the host's word size and endianness.</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-comment">-- Note that we only support host endianness == target endianness for now,</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-comment">-- even with the external interpreter. This would need to be fixed to</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-comment">-- support host endianness /= target endianness</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><a href="#local-6989586621682964416"><span class="hs-identifier hs-type">int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621682964416"><span class="annot"><span class="annottext">int :: Int -&gt; Assembler Word
</span><a href="#local-6989586621682964416"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span>  </span><span id="local-6989586621682964617"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964617"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964617"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><a href="#local-6989586621682964498"><span class="hs-identifier hs-type">float</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621682964498"><span class="annot"><span class="annottext">float :: Float -&gt; Assembler Word
</span><a href="#local-6989586621682964498"><span class="hs-identifier hs-var hs-var">float</span></a></span></span><span> </span><span id="local-6989586621682964618"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964618"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Assembler Word
</span><a href="#local-6989586621682964600"><span class="hs-identifier hs-var">word32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><span class="hs-identifier hs-var">castFloatToWord32</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682964618"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><a href="#local-6989586621682964507"><span class="hs-identifier hs-type">double</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621682964507"><span class="annot"><span class="annottext">double :: Double -&gt; Assembler Word
</span><a href="#local-6989586621682964507"><span class="hs-identifier hs-var hs-var">double</span></a></span></span><span> </span><span id="local-6989586621682964619"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964619"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var">word64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Word64
</span><span class="hs-identifier hs-var">castDoubleToWord64</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682964619"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><a href="#local-6989586621682964433"><span class="hs-identifier hs-type">word64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621682964433"><span class="annot"><span class="annottext">word64 :: Word64 -&gt; Assembler Word
</span><a href="#local-6989586621682964433"><span class="hs-identifier hs-var hs-var">word64</span></a></span></span><span> </span><span id="local-6989586621682964620"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964620"><span class="hs-identifier hs-var">ww</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="#local-6989586621682964614"><span class="hs-identifier hs-var">word_size</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-582"></span><span>       </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682964621"><span class="annot"><span class="annottext">wl :: Word
</span><a href="#local-6989586621682964621"><span class="hs-identifier hs-var hs-var">wl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964620"><span class="hs-identifier hs-var">ww</span></a></span><span>
</span><span id="line-584"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621682964622"><span class="annot"><span class="annottext">wh :: Word
</span><a href="#local-6989586621682964622"><span class="hs-identifier hs-var hs-var">wh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964620"><span class="hs-identifier hs-var">ww</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ByteOrder
</span><a href="GHC.Platform.html#platformByteOrder"><span class="hs-identifier hs-var">platformByteOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-586"></span><span>            </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">LittleEndian</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621682964611"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964621"><span class="hs-identifier hs-var">wl</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964622"><span class="hs-identifier hs-var">wh</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span>            </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">BigEndian</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621682964611"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964622"><span class="hs-identifier hs-var">wh</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964621"><span class="hs-identifier hs-var">wl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-588"></span><span>       </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682964620"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="#local-6989586621682964594"><span class="hs-identifier hs-type">word8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-591"></span><span>    </span><span id="local-6989586621682964594"><span class="annot"><span class="annottext">word8 :: Word8 -&gt; Assembler Word
</span><a href="#local-6989586621682964594"><span class="hs-identifier hs-var hs-var">word8</span></a></span></span><span>  </span><span id="local-6989586621682964627"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964627"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ByteOrder
</span><a href="GHC.Platform.html#platformByteOrder"><span class="hs-identifier hs-var">platformByteOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">LittleEndian</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964627"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">BigEndian</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682964627"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964615"><span class="hs-identifier hs-var">word_size_bits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="#local-6989586621682964597"><span class="hs-identifier hs-type">word16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621682964597"><span class="annot"><span class="annottext">word16 :: Word16 -&gt; Assembler Word
</span><a href="#local-6989586621682964597"><span class="hs-identifier hs-var hs-var">word16</span></a></span></span><span> </span><span id="local-6989586621682964629"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ByteOrder
</span><a href="GHC.Platform.html#platformByteOrder"><span class="hs-identifier hs-var">platformByteOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-597"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">LittleEndian</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964629"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">BigEndian</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682964629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964615"><span class="hs-identifier hs-var">word_size_bits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><a href="#local-6989586621682964600"><span class="hs-identifier hs-type">word32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621682964600"><span class="annot"><span class="annottext">word32 :: Word32 -&gt; Assembler Word
</span><a href="#local-6989586621682964600"><span class="hs-identifier hs-var hs-var">word32</span></a></span></span><span> </span><span id="local-6989586621682964630"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964630"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ByteOrder
</span><a href="GHC.Platform.html#platformByteOrder"><span class="hs-identifier hs-var">platformByteOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964301"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">LittleEndian</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964630"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><span class="annottext">ByteOrder
</span><span class="hs-identifier hs-var">BigEndian</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="#local-6989586621682964614"><span class="hs-identifier hs-var">word_size</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964630"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621682964353"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964630"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#isLargeW"><span class="hs-identifier hs-type">isLargeW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-609"></span><span id="isLargeW"><span class="annot"><span class="annottext">isLargeW :: Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeW"><span class="hs-identifier hs-var hs-var">isLargeW</span></a></span></span><span> </span><span id="local-6989586621682964631"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964631"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682964631"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">65535</span></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#isLargeI"><span class="hs-identifier hs-type">isLargeI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-612"></span><span id="isLargeI"><span class="annot"><span class="annottext">isLargeI :: Int -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLargeI"><span class="hs-identifier hs-var hs-var">isLargeI</span></a></span></span><span> </span><span id="local-6989586621682964633"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964633"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964633"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32767</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964633"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32768</span></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-type">push_alts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier hs-type">ArgRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-615"></span><span id="push_alts"><span class="annot"><span class="annottext">push_alts :: ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var hs-var">push_alts</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V"><span class="hs-identifier hs-var">V</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_V</span><span>
</span><span id="line-616"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_P</span><span>
</span><span id="line-617"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#N"><span class="hs-identifier hs-var">N</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_N</span><span>
</span><span id="line-618"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#L"><span class="hs-identifier hs-var">L</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_L</span><span>
</span><span id="line-619"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#F"><span class="hs-identifier hs-var">F</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_F</span><span>
</span><span id="line-620"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#D"><span class="hs-identifier hs-var">D</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_D</span><span>
</span><span id="line-621"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V16"><span class="hs-identifier hs-var">V16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-622"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V32"><span class="hs-identifier hs-var">V32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-623"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V64"><span class="hs-identifier hs-var">V64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-type">return_non_tuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier hs-type">ArgRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-626"></span><span id="return_non_tuple"><span class="annot"><span class="annottext">return_non_tuple :: ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var hs-var">return_non_tuple</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V"><span class="hs-identifier hs-var">V</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_V</span><span>
</span><span id="line-627"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_P</span><span>
</span><span id="line-628"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#N"><span class="hs-identifier hs-var">N</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_N</span><span>
</span><span id="line-629"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#L"><span class="hs-identifier hs-var">L</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_L</span><span>
</span><span id="line-630"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#F"><span class="hs-identifier hs-var">F</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_F</span><span>
</span><span id="line-631"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#D"><span class="hs-identifier hs-var">D</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_D</span><span>
</span><span id="line-632"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V16"><span class="hs-identifier hs-var">V16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_non_tuple: vector&quot;</span></span><span>
</span><span id="line-633"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V32"><span class="hs-identifier hs-var">V32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_non_tuple: vector&quot;</span></span><span>
</span><span id="line-634"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_non_tuple"><span class="hs-identifier hs-var">return_non_tuple</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V64"><span class="hs-identifier hs-var">V64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word16
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_non_tuple: vector&quot;</span></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span class="hs-comment">{-
  we can only handle up to a fixed number of words on the stack,
  because we need a stg_ctoi_tN stack frame for each size N. See
  Note [unboxed tuple bytecodes and tuple_BCO].

  If needed, you can support larger tuples by adding more in
  Jumps.cmm, StgMiscClosures.cmm, Interpreter.c and MiscClosures.h and
  raising this limit.

  Note that the limit is the number of words passed on the stack.
  If the calling convention passes part of the tuple in registers, the
  maximum number of tuple elements may be larger. Elements can also
  take multiple words on the stack (for example Double# on a 32 bit
  platform).
 -}</span><span>
</span><span id="line-651"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#maxTupleReturnNativeStackSize"><span class="hs-identifier hs-type">maxTupleReturnNativeStackSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a></span><span>
</span><span id="line-652"></span><span id="maxTupleReturnNativeStackSize"><span class="annot"><span class="annottext">maxTupleReturnNativeStackSize :: WordOff
</span><a href="GHC.ByteCode.Asm.html#maxTupleReturnNativeStackSize"><span class="hs-identifier hs-var hs-var">maxTupleReturnNativeStackSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WordOff
</span><span class="hs-number">62</span></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="hs-comment">{-
  Construct the call_info word that stg_ctoi_t, stg_ret_t and stg_primcall
  use to convert arguments between the native calling convention and the
  interpreter.

  See Note [GHCi and native call registers] for more information.
 -}</span><span>
</span><span id="line-661"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoSig"><span class="hs-identifier hs-type">mkNativeCallInfoSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#NativeCallInfo"><span class="hs-identifier hs-type">NativeCallInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-662"></span><span id="mkNativeCallInfoSig"><span class="annot"><span class="annottext">mkNativeCallInfoSig :: Platform -&gt; NativeCallInfo -&gt; Word32
</span><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoSig"><span class="hs-identifier hs-var hs-var">mkNativeCallInfoSig</span></a></span></span><span> </span><span id="local-6989586621682964645"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964645"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#NativeCallInfo"><span class="hs-identifier hs-type">NativeCallInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621682964647"><span id="local-6989586621682964648"><span id="local-6989586621682964649"><span id="local-6989586621682964650"><span class="annot"><span class="annottext">GlobalRegSet
NativeCallType
WordOff
nativeCallType :: NativeCallType
nativeCallSize :: WordOff
nativeCallRegs :: GlobalRegSet
nativeCallStackSpillSize :: WordOff
nativeCallStackSpillSize :: NativeCallInfo -&gt; WordOff
nativeCallRegs :: NativeCallInfo -&gt; GlobalRegSet
nativeCallSize :: NativeCallInfo -&gt; WordOff
nativeCallType :: NativeCallInfo -&gt; NativeCallType
</span><a href="#local-6989586621682964647"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NativeCallType
</span><a href="#local-6989586621682964647"><span class="hs-identifier hs-var">nativeCallType</span></a></span><span> </span><span class="annot"><span class="annottext">NativeCallType -&gt; NativeCallType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NativeCallType
</span><a href="GHC.ByteCode.Types.html#NativeTupleReturn"><span class="hs-identifier hs-var">NativeTupleReturn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964650"><span class="hs-identifier hs-var">nativeCallStackSpillSize</span></a></span><span> </span><span class="annot"><span class="annottext">WordOff -&gt; WordOff -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="GHC.ByteCode.Asm.html#maxTupleReturnNativeStackSize"><span class="hs-identifier hs-var">maxTupleReturnNativeStackSize</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Word32
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkNativeCallInfoSig: tuple too big for the bytecode compiler&quot;</span></span><span>
</span><span id="line-665"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WordOff -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964650"><span class="hs-identifier hs-var">nativeCallStackSpillSize</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stack words.&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-666"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use -fobject-code to get around this limit&quot;</span></span><span>
</span><span id="line-667"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- 24 bits for register bitmap</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc
-&gt; (Bool
    -&gt; SDoc
    -&gt; (Bool -&gt; SDoc -&gt; Word32 -&gt; Word32)
    -&gt; Bool
    -&gt; SDoc
    -&gt; Word32
    -&gt; Word32)
-&gt; Bool
-&gt; SDoc
-&gt; (Bool -&gt; SDoc -&gt; Word32 -&gt; Word32)
-&gt; Bool
-&gt; SDoc
-&gt; Word32
-&gt; Word32
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(GlobalReg, Int)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var">argRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;too many registers for bitmap:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(GlobalReg, Int)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var">argRegs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-comment">-- 8 bits for continuation offset (only for NativeTupleReturn)</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; SDoc
-&gt; (Bool -&gt; SDoc -&gt; Word32 -&gt; Word32)
-&gt; Bool
-&gt; SDoc
-&gt; Word32
-&gt; Word32
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964658"><span class="hs-identifier hs-var">cont_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;continuation offset too large:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964658"><span class="hs-identifier hs-var">cont_offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-comment">-- all regs accounted for</span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Word32 -&gt; Word32
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GlobalReg -&gt; Bool) -&gt; [GlobalReg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalReg -&gt; [GlobalReg] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GlobalReg, Int) -&gt; GlobalReg)
-&gt; [(GlobalReg, Int)] -&gt; [GlobalReg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(GlobalReg, Int) -&gt; GlobalReg
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var">argRegs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRegSet -&gt; [GlobalReg]
forall r. RegSet r -&gt; [r]
</span><a href="GHC.Cmm.Expr.html#regSetToList"><span class="hs-identifier hs-var">regSetToList</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegSet
</span><a href="#local-6989586621682964649"><span class="hs-identifier hs-var">nativeCallRegs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-678"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not all registers accounted for&quot;</span></span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;argRegs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var">argRegs</span></a></span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nativeCallRegs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegSet -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegSet
</span><a href="#local-6989586621682964649"><span class="hs-identifier hs-var">nativeCallRegs</span></a></span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-682"></span><span>      </span><span class="hs-comment">-- SIMD GHCi TODO: the above assertion doesn't account for register overlap;</span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-comment">-- it will need to be adjusted for SIMD vector support in the bytecode interpreter.</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span>    </span><span class="annot"><span class="annottext">(Word32 -&gt; (GlobalReg, Int) -&gt; Word32)
-&gt; Word32 -&gt; [(GlobalReg, Int)] -&gt; Word32
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (GlobalReg, Int) -&gt; Word32
</span><a href="#local-6989586621682964665"><span class="hs-identifier hs-var">reg_bit</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var">argRegs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964658"><span class="hs-identifier hs-var">cont_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>    </span><span class="annot"><a href="#local-6989586621682964658"><span class="hs-identifier hs-type">cont_offset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621682964658"><span class="annot"><span class="annottext">cont_offset :: Word32
</span><a href="#local-6989586621682964658"><span class="hs-identifier hs-var hs-var">cont_offset</span></a></span></span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NativeCallType
</span><a href="#local-6989586621682964647"><span class="hs-identifier hs-var">nativeCallType</span></a></span><span> </span><span class="annot"><span class="annottext">NativeCallType -&gt; NativeCallType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NativeCallType
</span><a href="GHC.ByteCode.Types.html#NativeTupleReturn"><span class="hs-identifier hs-var">NativeTupleReturn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WordOff -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621682964650"><span class="hs-identifier hs-var">nativeCallStackSpillSize</span></a></span><span>
</span><span id="line-690"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- there is no continuation for primcalls</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><a href="#local-6989586621682964665"><span class="hs-identifier hs-type">reg_bit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Reg.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-693"></span><span>    </span><span id="local-6989586621682964665"><span class="annot"><span class="annottext">reg_bit :: Word32 -&gt; (GlobalReg, Int) -&gt; Word32
</span><a href="#local-6989586621682964665"><span class="hs-identifier hs-var hs-var">reg_bit</span></a></span></span><span> </span><span id="local-6989586621682964667"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682964668"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682964668"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682964669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964669"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621682964668"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalReg -&gt; GlobalRegSet -&gt; Bool
forall r. Ord r =&gt; r -&gt; RegSet r -&gt; Bool
</span><a href="GHC.Cmm.Expr.html#elemRegSet"><span class="hs-operator hs-var">`elemRegSet`</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegSet
</span><a href="#local-6989586621682964649"><span class="hs-identifier hs-var">nativeCallRegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682964669"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682964667"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621682964657"><span class="annot"><span class="annottext">argRegs :: [(GlobalReg, Int)]
</span><a href="#local-6989586621682964657"><span class="hs-identifier hs-var hs-var">argRegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalReg] -&gt; [Int] -&gt; [(GlobalReg, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; GlobalArgRegs -&gt; [GlobalReg]
</span><a href="GHC.Cmm.CallConv.html#allArgRegsCover"><span class="hs-identifier hs-var">allArgRegsCover</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964645"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalArgRegs
</span><a href="GHC.Cmm.Reg.html#SCALAR_ARG_REGS"><span class="hs-identifier hs-var">SCALAR_ARG_REGS</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-comment">-- The bytecode interpreter does not (currently) handle vector registers,</span><span>
</span><span id="line-698"></span><span>      </span><span class="hs-comment">-- so we only use the scalar argument-passing registers here.</span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoLit"><span class="hs-identifier hs-type">mkNativeCallInfoLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#NativeCallInfo"><span class="hs-identifier hs-type">NativeCallInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-701"></span><span id="mkNativeCallInfoLit"><span class="annot"><span class="annottext">mkNativeCallInfoLit :: Platform -&gt; NativeCallInfo -&gt; Literal
</span><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoLit"><span class="hs-identifier hs-var hs-var">mkNativeCallInfoLit</span></a></span></span><span> </span><span id="local-6989586621682964672"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964672"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682964673"><span class="annot"><span class="annottext">NativeCallInfo
</span><a href="#local-6989586621682964673"><span class="hs-identifier hs-var">call_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-702"></span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964672"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; (Word32 -&gt; Integer) -&gt; Word32 -&gt; Literal
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Literal) -&gt; Word32 -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NativeCallInfo -&gt; Word32
</span><a href="GHC.ByteCode.Asm.html#mkNativeCallInfoSig"><span class="hs-identifier hs-var">mkNativeCallInfoSig</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682964672"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NativeCallInfo
</span><a href="#local-6989586621682964673"><span class="hs-identifier hs-var">call_info</span></a></span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier hs-type">iNTERP_STACK_CHECK_THRESH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-705"></span><span id="iNTERP_STACK_CHECK_THRESH"><span class="annot"><span class="annottext">iNTERP_STACK_CHECK_THRESH :: Int
</span><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier hs-var hs-var">iNTERP_STACK_CHECK_THRESH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">INTERP_STACK_CHECK_THRESH</span><span>
</span><span id="line-706"></span></pre></body></html>