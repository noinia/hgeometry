<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiWayIf          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1993-1998


A ``lint'' pass to check for Core correctness.
See Note [Core Lint guarantee].
-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html"><span class="hs-identifier">GHC.Core.Lint</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#LintPassResultConfig"><span class="hs-identifier">LintPassResultConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier">LintFlags</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#StaticPtrCheck"><span class="hs-identifier">StaticPtrCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier">LintConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier">WarnsAndErrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreBindings%27"><span class="hs-identifier">lintCoreBindings'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintUnfolding"><span class="hs-identifier">lintUnfolding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#lintPassResult"><span class="hs-identifier">lintPassResult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintExpr"><span class="hs-identifier">lintExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#lintAnnots"><span class="hs-identifier">lintAnnots</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintAxioms"><span class="hs-identifier">lintAxioms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Debug output</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#EndPassConfig"><span class="hs-identifier">EndPassConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#endPassIO"><span class="hs-identifier">endPassIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#displayLintResults"><span class="hs-identifier">displayLintResults</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#dumpPassResult"><span class="hs-identifier">dumpPassResult</span></a></span><span>
</span><span id="line-30"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier">ConcreteTvOrigin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTyVars"><span class="hs-identifier">ConcreteTyVars</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatingPrimTy"><span class="hs-identifier">isFloatingPrimTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isTyFamFree"><span class="hs-identifier">isTyFamFree</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepOrigin"><span class="hs-identifier">FixedRuntimeRepOrigin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html"><span class="hs-identifier">GHC.Unit.Module.ModGuts</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FVs.html"><span class="hs-identifier">GHC.Core.FVs</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Stats.html"><span class="hs-identifier">GHC.Core.Stats</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Stats.html#coreBindsStats"><span class="hs-identifier">coreBindsStats</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Ppr.html"><span class="hs-identifier">GHC.Core.Ppr</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html"><span class="hs-identifier">GHC.Core.Predicate</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Predicate.html#isCoVarType"><span class="hs-identifier">isCoVarType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Multiplicity.html"><span class="hs-identifier">GHC.Core.Multiplicity</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html"><span class="hs-identifier">GHC.Core.UsageEnv</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>   </span><span class="hs-comment">-- checks validity of types/coercions</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier">eqType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqTypes"><span class="hs-identifier">eqTypes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqTypeIgnoringMultiplicity"><span class="hs-identifier">eqTypeIgnoringMultiplicity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqForAllVis"><span class="hs-identifier">eqForAllVis</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html"><span class="hs-identifier">GHC.Core.TyCo.Subst</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html"><span class="hs-identifier">GHC.Core.TyCo.Ppr</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TyCon</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html"><span class="hs-identifier">GHC.Core.Coercion.Axiom</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#compatibleBranches"><span class="hs-identifier">compatibleBranches</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Unify.html"><span class="hs-identifier">GHC.Core.Unify</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Arity.html"><span class="hs-identifier">GHC.Core.Opt.Arity</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Arity.html#typeArity"><span class="hs-identifier">typeArity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Arity.html#exprIsDeadEnd"><span class="hs-identifier">exprIsDeadEnd</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html"><span class="hs-identifier">GHC.Core.Opt.Monad</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Var</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#isNullUFM"><span class="hs-identifier">isNullUFM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#sizeUFM"><span class="hs-identifier">sizeUFM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.RepType.html"><span class="hs-identifier">GHC.Types.RepType</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html"><span class="hs-identifier">GHC.Types.Demand</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html#splitDmdSig"><span class="hs-identifier">splitDmdSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html#isDeadEndDiv"><span class="hs-identifier">isDeadEndDiv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier">multiplicityTy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.List.SetOps.html"><span class="hs-identifier">GHC.Data.List.SetOps</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Constants.html"><span class="hs-identifier">GHC.Utils.Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier">debugIsOn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Err</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#groupWith"><span class="hs-identifier">groupWith</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">partition</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.html"><span class="hs-identifier">Data.IntMap.Strict</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier">IntMap</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.html"><span class="hs-identifier">Data.IntMap.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#lookup"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#keys"><span class="hs-identifier">keys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#fromList"><span class="hs-identifier">fromList</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html"><span class="hs-identifier">GHC.Data.Pair</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">oneShot</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Unboxed.html"><span class="hs-identifier">GHC.Data.Unboxed</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">{-
Note [Core Lint guarantee]
~~~~~~~~~~~~~~~~~~~~~~~~~~
Core Lint is the type-checker for Core. Using it, we get the following guarantee:

If all of:
1. Core Lint passes,
2. there are no unsafe coercions (i.e. unsafeEqualityProof),
3. all plugin-supplied coercions (i.e. PluginProv) are valid, and
4. all case-matches are complete
then running the compiled program will not seg-fault, assuming no bugs downstream
(e.g. in the code generator). This guarantee is quite powerful, in that it allows us
to decouple the safety of the resulting program from the type inference algorithm.

However, do note point (4) above. Core Lint does not check for incomplete case-matches;
see Note [Case expression invariants] in GHC.Core, invariant (4). As explained there,
an incomplete case-match might slip by Core Lint and cause trouble at runtime.

Note [GHC Formalism]
~~~~~~~~~~~~~~~~~~~~
This file implements the type-checking algorithm for System FC, the &quot;official&quot;
name of the Core language. Type safety of FC is heart of the claim that
executables produced by GHC do not have segmentation faults. Thus, it is
useful to be able to reason about System FC independently of reading the code.
To this purpose, there is a document core-spec.pdf built in docs/core-spec that
contains a formalism of the types and functions dealt with here. If you change
just about anything in this file or you change other types/functions throughout
the Core language (all signposted to this note), you should update that
formalism. See docs/core-spec/README for more info about how to do so.

Note [check vs lint]
~~~~~~~~~~~~~~~~~~~~
This file implements both a type checking algorithm and also general sanity
checking. For example, the &quot;sanity checking&quot; checks for TyConApp on the left
of an AppTy, which should never happen. These sanity checks don't really
affect any notion of type soundness. Yet, it is convenient to do the sanity
checks at the same time as the type checks. So, we use the following naming
convention:

- Functions that begin with 'lint'... are involved in type checking. These
  functions might also do some sanity checking.

- Functions that begin with 'check'... are *not* involved in type checking.
  They exist only for sanity checking.

Issues surrounding variable naming, shadowing, and such are considered *not*
to be part of type checking, as the formalism omits these details.

Summary of checks
~~~~~~~~~~~~~~~~~
Checks that a set of core bindings is well-formed.  The PprStyle and String
just control what we print in the event of an error.  The Bool value
indicates whether we have done any specialisation yet (in which case we do
some extra checks).

We check for
        (a) type errors
        (b) Out-of-scope type variables
        (c) Out-of-scope local variables
        (d) Ill-kinded types
        (e) Incorrect unsafe coercions

If we have done specialisation the we check that there are
        (a) No top-level bindings of primitive (unboxed type)

Note [Linting function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All saturated applications of funTyCon are represented with the FunTy constructor.
See Note [Function type constructors and FunTy] in GHC.Builtin.Types.Prim

 We check this invariant in lintType.

Note [Linting type lets]
~~~~~~~~~~~~~~~~~~~~~~~~
In the desugarer, it's very very convenient to be able to say (in effect)
        let a = Type Bool in
        let x::a = True in &lt;body&gt;
That is, use a type let.  See Note [Core type and coercion invariant] in &quot;GHC.Core&quot;.
One place it is used is in mkWwBodies; see Note [Join points and beta-redexes]
in GHC.Core.Opt.WorkWrap.Utils.  (Maybe there are other &quot;clients&quot; of this feature; I'm not sure).

* Hence when linting &lt;body&gt; we need to remember that a=Int, else we
  might reject a correct program.  So we carry a type substitution (in
  this example [a -&gt; Bool]) and apply this substitution before
  comparing types. In effect, in Lint, type equality is always
  equality-modulo-le-subst.  This is in the le_subst field of
  LintEnv.  But nota bene:

  (SI1) The le_subst substitution is applied to types and coercions only

  (SI2) The result of that substitution is used only to check for type
        equality, to check well-typed-ness, /but is then discarded/.
        The result of substitution does not outlive the CoreLint pass.

  (SI3) The InScopeSet of le_subst includes only TyVar and CoVar binders.

* The function
        lintInTy :: Type -&gt; LintM (Type, Kind)
  returns a substituted type.

* When we encounter a binder (like x::a) we must apply the substitution
  to the type of the binding variable.  lintBinders does this.

* Clearly we need to clone tyvar binders as we go.

* But take care (#17590)! We must also clone CoVar binders:
    let a = TYPE (ty |&gt; cv)
    in \cv -&gt; blah
  blindly substituting for `a` might capture `cv`.

* Alas, when cloning a coercion variable we might choose a unique
  that happens to clash with an inner Id, thus
      \cv_66 -&gt; let wild_X7 = blah in blah
  We decide to clone `cv_66` because it's already in scope.  Fine,
  choose a new unique.  Aha, X7 looks good.  So we check the lambda
  body with le_subst of [cv_66 :-&gt; cv_X7]

  This is all fine, even though we use the same unique as wild_X7.
  As (SI2) says, we do /not/ return a new lambda
     (\cv_X7 -&gt; let wild_X7 = blah in ...)
  We simply use the le_subst substitution in types/coercions only, when
  checking for equality.

* We still need to check that Id occurrences are bound by some
  enclosing binding.  We do /not/ use the InScopeSet for the le_subst
  for this purpose -- it contains only TyCoVars.  Instead we have a separate
  le_ids for the in-scope Id binders.

Sigh.  We might want to explore getting rid of type-let!

Note [Bad unsafe coercion]
~~~~~~~~~~~~~~~~~~~~~~~~~~
For discussion see https://gitlab.haskell.org/ghc/ghc/wikis/bad-unsafe-coercions
Linter introduces additional rules that checks improper coercion between
different types, called bad coercions. Following coercions are forbidden:

  (a) coercions between boxed and unboxed values;
  (b) coercions between unlifted values of the different sizes, here
      active size is checked, i.e. size of the actual value but not
      the space allocated for value;
  (c) coercions between floating and integral boxed values, this check
      is not yet supported for unboxed tuples, as no semantics were
      specified for that;
  (d) coercions from / to vector type
  (e) If types are unboxed tuples then tuple (# A_1,..,A_n #) can be
      coerced to (# B_1,..,B_m #) if n=m and for each pair A_i, B_i rules
      (a-e) holds.

Note [Join points]
~~~~~~~~~~~~~~~~~~
We check the rules listed in Note [Invariants on join points] in GHC.Core. The
only one that causes any difficulty is the first: All occurrences must be tail
calls. To this end, along with the in-scope set, we remember in le_joins the
subset of in-scope Ids that are valid join ids. For example:

  join j x = ... in
  case e of
    A -&gt; jump j y -- good
    B -&gt; case (jump j z) of -- BAD
           C -&gt; join h = jump j w in ... -- good
           D -&gt; let x = jump j v in ... -- BAD

A join point remains valid in case branches, so when checking the A
branch, j is still valid. When we check the scrutinee of the inner
case, however, we set le_joins to empty, and catch the
error. Similarly, join points can occur free in RHSes of other join
points but not the RHSes of value bindings (thunks and functions).

Note [Avoiding compiler perf traps when constructing error messages.]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's quite common to put error messages into a where clause when it might
be triggered by multiple branches. E.g.

  checkThing x y z =
    case x of
      X -&gt; unless (correctX x) $ failWithL errMsg
      Y -&gt; unless (correctY y) $ failWithL errMsg
    where
      errMsg = text &quot;My error involving:&quot; $$ ppr x &lt;+&gt; ppr y

However ghc will compile this to:

  checkThink x y z =
    let errMsg = text &quot;My error involving:&quot; $$ ppr x &lt;+&gt; ppr y
    in case x of
      X -&gt; unless (correctX x) $ failWithL errMsg
      Y -&gt; unless (correctY y) $ failWithL errMsg

Putting the allocation of errMsg into the common non-error path.
One way to work around this is to turn errMsg into a function:

  checkThink x y z =
    case x of
      X -&gt; unless (correctX x) $ failWithL (errMsg x y)
      Y -&gt; unless (correctY y) $ failWithL (errMsg x y)
    where
      errMsg x y = text &quot;My error involving:&quot; $$ ppr x &lt;+&gt; ppr y

This way `errMsg` is a static function and it being defined in the common
path does not result in allocation in the hot path. This can be surprisingly
impactful. Changing `lint_app` reduced allocations for one test program I was
looking at by ~4%.

Note [MCInfo for Lint]
~~~~~~~~~~~~~~~~~~~~~~
When printing a Lint message, use the MCInfo severity so that the
message is printed on stderr rather than stdout (#13342).

************************************************************************
*                                                                      *
                 Beginning and ending passes
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Configuration for boilerplate operations at the end of a</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- compilation pass producing Core.</span><span>
</span><span id="line-327"></span><span class="hs-keyword">data</span><span> </span><span id="EndPassConfig"><span class="annot"><a href="GHC.Core.Lint.html#EndPassConfig"><span class="hs-identifier hs-var">EndPassConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EndPassConfig"><span class="annot"><a href="GHC.Core.Lint.html#EndPassConfig"><span class="hs-identifier hs-var">EndPassConfig</span></a></span></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ep_dumpCoreSizes"><span class="annot"><span class="annottext">EndPassConfig -&gt; Bool
</span><a href="GHC.Core.Lint.html#ep_dumpCoreSizes"><span class="hs-identifier hs-var hs-var">ep_dumpCoreSizes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-comment">-- ^ Whether core bindings should be dumped with the size of what they</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- are binding (i.e. the size of the RHS of the binding).</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ep_lintPassResult"><span class="annot"><span class="annottext">EndPassConfig -&gt; Maybe LintPassResultConfig
</span><a href="GHC.Core.Lint.html#ep_lintPassResult"><span class="hs-identifier hs-var hs-var">ep_lintPassResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintPassResultConfig"><span class="hs-identifier hs-type">LintPassResultConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Whether we should lint the result of this pass.</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ep_namePprCtx"><span class="annot"><span class="annottext">EndPassConfig -&gt; NamePprCtx
</span><a href="GHC.Core.Lint.html#ep_namePprCtx"><span class="hs-identifier hs-var hs-var">ep_namePprCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Outputable.html#NamePprCtx"><span class="hs-identifier hs-type">NamePprCtx</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ep_dumpFlag"><span class="annot"><span class="annottext">EndPassConfig -&gt; Maybe DumpFlag
</span><a href="GHC.Core.Lint.html#ep_dumpFlag"><span class="hs-identifier hs-var hs-var">ep_dumpFlag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#DumpFlag"><span class="hs-identifier hs-type">DumpFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ep_prettyPass"><span class="annot"><span class="annottext">EndPassConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#ep_prettyPass"><span class="hs-identifier hs-var hs-var">ep_prettyPass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ep_passDetails"><span class="annot"><span class="annottext">EndPassConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#ep_passDetails"><span class="hs-identifier hs-var hs-var">ep_passDetails</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="GHC.Core.Lint.html#endPassIO"><span class="hs-identifier hs-type">endPassIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-345"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#EndPassConfig"><span class="hs-identifier hs-type">EndPassConfig</span></a></span><span>
</span><span id="line-346"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- Used by the IO-is CorePrep too</span><span>
</span><span id="line-349"></span><span id="endPassIO"><span class="annot"><span class="annottext">endPassIO :: Logger -&gt; EndPassConfig -&gt; CoreProgram -&gt; [CoreRule] -&gt; IO ()
</span><a href="GHC.Core.Lint.html#endPassIO"><span class="hs-identifier hs-var hs-var">endPassIO</span></a></span></span><span> </span><span id="local-6989586621682972346"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972346"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682972347"><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682972348"><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972348"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621682972349"><span class="annot"><span class="annottext">[CoreRule]
</span><a href="#local-6989586621682972349"><span class="hs-identifier hs-var">rules</span></a></span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; Bool
-&gt; NamePprCtx
-&gt; Maybe DumpFlag
-&gt; String
-&gt; SDoc
-&gt; CoreProgram
-&gt; [CoreRule]
-&gt; IO ()
</span><a href="GHC.Core.Lint.html#dumpPassResult"><span class="hs-identifier hs-var">dumpPassResult</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972346"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndPassConfig -&gt; Bool
</span><a href="GHC.Core.Lint.html#ep_dumpCoreSizes"><span class="hs-identifier hs-var">ep_dumpCoreSizes</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndPassConfig -&gt; NamePprCtx
</span><a href="GHC.Core.Lint.html#ep_namePprCtx"><span class="hs-identifier hs-var">ep_namePprCtx</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe DumpFlag
</span><a href="#local-6989586621682972350"><span class="hs-identifier hs-var">mb_flag</span></a></span><span>
</span><span id="line-351"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; String
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndPassConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#ep_prettyPass"><span class="hs-identifier hs-var">ep_prettyPass</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndPassConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#ep_passDetails"><span class="hs-identifier hs-var">ep_passDetails</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972348"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreRule]
</span><a href="#local-6989586621682972349"><span class="hs-identifier hs-var">rules</span></a></span><span>
</span><span id="line-353"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe LintPassResultConfig
-&gt; (LintPassResultConfig -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndPassConfig -&gt; Maybe LintPassResultConfig
</span><a href="GHC.Core.Lint.html#ep_lintPassResult"><span class="hs-identifier hs-var">ep_lintPassResult</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((LintPassResultConfig -&gt; IO ()) -&gt; IO ())
-&gt; (LintPassResultConfig -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682972353"><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972353"><span class="hs-identifier hs-var">lp_cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-354"></span><span>           </span><span class="annot"><span class="annottext">Logger -&gt; LintPassResultConfig -&gt; CoreProgram -&gt; IO ()
</span><a href="GHC.Core.Lint.html#lintPassResult"><span class="hs-identifier hs-var">lintPassResult</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972346"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972353"><span class="hs-identifier hs-var">lp_cfg</span></a></span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972348"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-355"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621682972350"><span class="annot"><span class="annottext">mb_flag :: Maybe DumpFlag
</span><a href="#local-6989586621682972350"><span class="hs-identifier hs-var hs-var">mb_flag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EndPassConfig -&gt; Maybe DumpFlag
</span><a href="GHC.Core.Lint.html#ep_dumpFlag"><span class="hs-identifier hs-var">ep_dumpFlag</span></a></span><span> </span><span class="annot"><span class="annottext">EndPassConfig
</span><a href="#local-6989586621682972347"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-358"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972354"><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972354"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DumpFlag -&gt; Bool
</span><a href="GHC.Utils.Logger.html#logHasDumpFlag"><span class="hs-identifier hs-var">logHasDumpFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972346"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972354"><span class="hs-identifier hs-var">flag</span></a></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DumpFlag -&gt; Maybe DumpFlag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972354"><span class="hs-identifier hs-var">flag</span></a></span><span>
</span><span id="line-359"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; DumpFlag -&gt; Bool
</span><a href="GHC.Utils.Logger.html#logHasDumpFlag"><span class="hs-identifier hs-var">logHasDumpFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972346"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_verbose_core2core"><span class="hs-identifier hs-var">Opt_D_verbose_core2core</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DumpFlag -&gt; Maybe DumpFlag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972354"><span class="hs-identifier hs-var">flag</span></a></span><span>
</span><span id="line-360"></span><span>                </span><span class="annot"><span class="annottext">Maybe DumpFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DumpFlag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpPassResult"><span class="hs-identifier hs-type">dumpPassResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-363"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                  </span><span class="hs-comment">-- dump core sizes?</span><span>
</span><span id="line-364"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#NamePprCtx"><span class="hs-identifier hs-type">NamePprCtx</span></a></span><span>
</span><span id="line-365"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#DumpFlag"><span class="hs-identifier hs-type">DumpFlag</span></a></span><span>        </span><span class="hs-comment">-- Just df =&gt; show details in a file whose</span><span>
</span><span id="line-366"></span><span>                                        </span><span class="hs-comment">--            name is specified by df</span><span>
</span><span id="line-367"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                </span><span class="hs-comment">-- Header</span><span>
</span><span id="line-368"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>                  </span><span class="hs-comment">-- Extra info to appear after header</span><span>
</span><span id="line-369"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span id="dumpPassResult"><span class="annot"><span class="annottext">dumpPassResult :: Logger
-&gt; Bool
-&gt; NamePprCtx
-&gt; Maybe DumpFlag
-&gt; String
-&gt; SDoc
-&gt; CoreProgram
-&gt; [CoreRule]
-&gt; IO ()
</span><a href="GHC.Core.Lint.html#dumpPassResult"><span class="hs-identifier hs-var hs-var">dumpPassResult</span></a></span></span><span> </span><span id="local-6989586621682972357"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972357"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682972358"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972358"><span class="hs-identifier hs-var">dump_core_sizes</span></a></span></span><span> </span><span id="local-6989586621682972359"><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621682972359"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span></span><span> </span><span id="local-6989586621682972360"><span class="annot"><span class="annottext">Maybe DumpFlag
</span><a href="#local-6989586621682972360"><span class="hs-identifier hs-var">mb_flag</span></a></span></span><span> </span><span id="local-6989586621682972361"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972361"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span id="local-6989586621682972362"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972362"><span class="hs-identifier hs-var">extra_info</span></a></span></span><span> </span><span id="local-6989586621682972363"><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972363"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621682972364"><span class="annot"><span class="annottext">[CoreRule]
</span><a href="#local-6989586621682972364"><span class="hs-identifier hs-var">rules</span></a></span></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe DumpFlag -&gt; (DumpFlag -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">Maybe DumpFlag
</span><a href="#local-6989586621682972360"><span class="hs-identifier hs-var">mb_flag</span></a></span><span> </span><span class="annot"><span class="annottext">((DumpFlag -&gt; IO ()) -&gt; IO ()) -&gt; (DumpFlag -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682972366"><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972366"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>           </span><span class="annot"><span class="annottext">Logger
-&gt; PprStyle -&gt; DumpFlag -&gt; String -&gt; DumpFormat -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Logger.html#logDumpFile"><span class="hs-identifier hs-var">logDumpFile</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972357"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePprCtx -&gt; PprStyle
</span><a href="GHC.Utils.Outputable.html#mkDumpStyle"><span class="hs-identifier hs-var">mkDumpStyle</span></a></span><span> </span><span class="annot"><span class="annottext">NamePprCtx
</span><a href="#local-6989586621682972359"><span class="hs-identifier hs-var">name_ppr_ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="#local-6989586621682972366"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972361"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFormat
</span><a href="GHC.Utils.Logger.html#FormatCore"><span class="hs-identifier hs-var">FormatCore</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972370"><span class="hs-identifier hs-var">dump_doc</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>         </span><span class="hs-comment">-- Report result size</span><span>
</span><span id="line-376"></span><span>         </span><span class="hs-comment">-- This has the side effect of forcing the intermediate to be evaluated</span><span>
</span><span id="line-377"></span><span>         </span><span class="hs-comment">-- if it's not already forced by a -ddump flag.</span><span>
</span><span id="line-378"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; JoinArity -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Error.html#debugTraceMsg"><span class="hs-identifier hs-var">Err.debugTraceMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972357"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972372"><span class="hs-identifier hs-var">size_doc</span></a></span><span>
</span><span id="line-379"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621682972372"><span class="annot"><span class="annottext">size_doc :: SDoc
</span><a href="#local-6989586621682972372"><span class="hs-identifier hs-var hs-var">size_doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Result size of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972361"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreStats -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreProgram -&gt; CoreStats
</span><a href="GHC.Core.Stats.html#coreBindsStats"><span class="hs-identifier hs-var">coreBindsStats</span></a></span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972363"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621682972370"><span class="annot"><span class="annottext">dump_doc :: SDoc
</span><a href="#local-6989586621682972370"><span class="hs-identifier hs-var hs-var">dump_doc</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972362"><span class="hs-identifier hs-var">extra_info</span></a></span><span>
</span><span id="line-385"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972372"><span class="hs-identifier hs-var">size_doc</span></a></span><span>
</span><span id="line-386"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#blankLine"><span class="hs-identifier hs-var">blankLine</span></a></span><span>
</span><span id="line-387"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972358"><span class="hs-identifier hs-var">dump_core_sizes</span></a></span><span>
</span><span id="line-388"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CoreProgram -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprCoreBindingsWithSize"><span class="hs-identifier hs-var">pprCoreBindingsWithSize</span></a></span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972363"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-389"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CoreProgram -&gt; SDoc
forall b. OutputableBndr b =&gt; [Bind b] -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprCoreBindings"><span class="hs-identifier hs-var">pprCoreBindings</span></a></span><span>         </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972363"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-390"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; Bool -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ppUnless"><span class="hs-identifier hs-var">ppUnless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreRule] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[CoreRule]
</span><a href="#local-6989586621682972364"><span class="hs-identifier hs-var">rules</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972385"><span class="hs-identifier hs-var">pp_rules</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621682972385"><span class="annot"><span class="annottext">pp_rules :: SDoc
</span><a href="#local-6989586621682972385"><span class="hs-identifier hs-var hs-var">pp_rules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#blankLine"><span class="hs-identifier hs-var">blankLine</span></a></span><span>
</span><span id="line-392"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;------ Local rules for imported ids --------&quot;</span></span><span>
</span><span id="line-393"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CoreRule] -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprRules"><span class="hs-identifier hs-var">pprRules</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreRule]
</span><a href="#local-6989586621682972364"><span class="hs-identifier hs-var">rules</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                 Top-level interfaces
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-keyword">data</span><span> </span><span id="LintPassResultConfig"><span class="annot"><a href="GHC.Core.Lint.html#LintPassResultConfig"><span class="hs-identifier hs-var">LintPassResultConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LintPassResultConfig"><span class="annot"><a href="GHC.Core.Lint.html#LintPassResultConfig"><span class="hs-identifier hs-var">LintPassResultConfig</span></a></span></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="lpr_diagOpts"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#lpr_diagOpts"><span class="hs-identifier hs-var hs-var">lpr_diagOpts</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Error.html#DiagOpts"><span class="hs-identifier hs-type">DiagOpts</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lpr_platform"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; Platform
</span><a href="GHC.Core.Lint.html#lpr_platform"><span class="hs-identifier hs-var hs-var">lpr_platform</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lpr_makeLintFlags"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#lpr_makeLintFlags"><span class="hs-identifier hs-var hs-var">lpr_makeLintFlags</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lpr_showLintWarnings"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; Bool
</span><a href="GHC.Core.Lint.html#lpr_showLintWarnings"><span class="hs-identifier hs-var hs-var">lpr_showLintWarnings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lpr_passPpr"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lpr_passPpr"><span class="hs-identifier hs-var hs-var">lpr_passPpr</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lpr_localsInScope"><span class="annot"><span class="annottext">LintPassResultConfig -&gt; [Var]
</span><a href="GHC.Core.Lint.html#lpr_localsInScope"><span class="hs-identifier hs-var hs-var">lpr_localsInScope</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="GHC.Core.Lint.html#lintPassResult"><span class="hs-identifier hs-type">lintPassResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintPassResultConfig"><span class="hs-identifier hs-type">LintPassResultConfig</span></a></span><span>
</span><span id="line-413"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span id="lintPassResult"><span class="annot"><span class="annottext">lintPassResult :: Logger -&gt; LintPassResultConfig -&gt; CoreProgram -&gt; IO ()
</span><a href="GHC.Core.Lint.html#lintPassResult"><span class="hs-identifier hs-var hs-var">lintPassResult</span></a></span></span><span> </span><span id="local-6989586621682972394"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972394"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682972395"><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682972396"><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972396"><span class="hs-identifier hs-var">binds</span></a></span></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972397"><span class="annot"><span class="annottext">warns_and_errs :: WarnsAndErrs
</span><a href="#local-6989586621682972397"><span class="hs-identifier hs-var hs-var hs-var">warns_and_errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; CoreProgram -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#lintCoreBindings%27"><span class="hs-identifier hs-var">lintCoreBindings'</span></a></span><span>
</span><span id="line-416"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span>
</span><span id="line-417"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">l_diagOpts :: DiagOpts
</span><a href="GHC.Core.Lint.html#l_diagOpts"><span class="hs-identifier hs-var">l_diagOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#lpr_diagOpts"><span class="hs-identifier hs-var">lpr_diagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-418"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l_platform :: Platform
</span><a href="GHC.Core.Lint.html#l_platform"><span class="hs-identifier hs-var">l_platform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; Platform
</span><a href="GHC.Core.Lint.html#lpr_platform"><span class="hs-identifier hs-var">lpr_platform</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-419"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l_flags :: LintFlags
</span><a href="GHC.Core.Lint.html#l_flags"><span class="hs-identifier hs-var">l_flags</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#lpr_makeLintFlags"><span class="hs-identifier hs-var">lpr_makeLintFlags</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-420"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l_vars :: [Var]
</span><a href="GHC.Core.Lint.html#l_vars"><span class="hs-identifier hs-var">l_vars</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; [Var]
</span><a href="GHC.Core.Lint.html#lpr_localsInScope"><span class="hs-identifier hs-var">lpr_localsInScope</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-421"></span><span>                </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>               </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972396"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-423"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; String -&gt; IO ()
</span><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-var">Err.showPass</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972394"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-424"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Core Linted result of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-425"></span><span>           </span><span class="annot"><span class="annottext">SDocContext -&gt; SDoc -&gt; String
</span><a href="GHC.Utils.Outputable.html#renderWithContext"><span class="hs-identifier hs-var">renderWithContext</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="GHC.Utils.Outputable.html#defaultSDocContext"><span class="hs-identifier hs-var">defaultSDocContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lpr_passPpr"><span class="hs-identifier hs-var">lpr_passPpr</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; Bool -&gt; SDoc -&gt; SDoc -&gt; WarnsAndErrs -&gt; IO ()
</span><a href="GHC.Core.Lint.html#displayLintResults"><span class="hs-identifier hs-var">displayLintResults</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972394"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-427"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; Bool
</span><a href="GHC.Core.Lint.html#lpr_showLintWarnings"><span class="hs-identifier hs-var">lpr_showLintWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintPassResultConfig -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lpr_passPpr"><span class="hs-identifier hs-var">lpr_passPpr</span></a></span><span> </span><span class="annot"><span class="annottext">LintPassResultConfig
</span><a href="#local-6989586621682972395"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreProgram -&gt; SDoc
forall b. OutputableBndr b =&gt; [Bind b] -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprCoreBindings"><span class="hs-identifier hs-var">pprCoreBindings</span></a></span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972396"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682972397"><span class="hs-identifier hs-var">warns_and_errs</span></a></span><span>
</span><span id="line-429"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><a href="GHC.Core.Lint.html#displayLintResults"><span class="hs-identifier hs-type">displayLintResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-432"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ If 'True', display linter warnings.</span><span>
</span><span id="line-433"></span><span>                           </span><span class="hs-comment">--   If 'False', ignore linter warnings.</span><span>
</span><span id="line-434"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The source of the linted program</span></span><span>
</span><span id="line-435"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The linted program, pretty-printed</span></span><span>
</span><span id="line-436"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span>
</span><span id="line-437"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span id="displayLintResults"><span class="annot"><span class="annottext">displayLintResults :: Logger -&gt; Bool -&gt; SDoc -&gt; SDoc -&gt; WarnsAndErrs -&gt; IO ()
</span><a href="GHC.Core.Lint.html#displayLintResults"><span class="hs-identifier hs-var hs-var">displayLintResults</span></a></span></span><span> </span><span id="local-6989586621682972404"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972404"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682972405"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972405"><span class="hs-identifier hs-var">display_warnings</span></a></span></span><span> </span><span id="local-6989586621682972406"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972406"><span class="hs-identifier hs-var">pp_what</span></a></span></span><span> </span><span id="local-6989586621682972407"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972407"><span class="hs-identifier hs-var">pp_pgm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972408"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972408"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972409"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972409"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972409"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; MessageClass -&gt; SrcSpan -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Logger.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972404"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCInfo"><span class="hs-identifier hs-var">Err.MCInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>  </span><span class="hs-comment">-- See Note [MCInfo for Lint]</span><span>
</span><span id="line-441"></span><span>           </span><span class="annot"><span class="annottext">(SDoc -&gt; IO ()) -&gt; SDoc -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PprStyle -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="GHC.Utils.Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a></span><span>
</span><span id="line-442"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;errors&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972406"><span class="hs-identifier hs-var">pp_what</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; SDoc
</span><a href="GHC.Types.Error.html#pprMessageBag"><span class="hs-identifier hs-var">Err.pprMessageBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972409"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-443"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*** Offending Program ***&quot;</span></span><span>
</span><span id="line-444"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972407"><span class="hs-identifier hs-var">pp_pgm</span></a></span><span>
</span><span id="line-445"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*** End of Offense ***&quot;</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; JoinArity -&gt; IO ()
</span><a href="GHC.Utils.Error.html#ghcExit"><span class="hs-identifier hs-var">Err.ghcExit</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972404"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972408"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LogFlags -&gt; Bool
</span><a href="GHC.Utils.Logger.html#log_enable_debug"><span class="hs-identifier hs-var">log_enable_debug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logger -&gt; LogFlags
</span><a href="GHC.Utils.Logger.html#logFlags"><span class="hs-identifier hs-var">logFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972404"><span class="hs-identifier hs-var">logger</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972405"><span class="hs-identifier hs-var">display_warnings</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; MessageClass -&gt; SrcSpan -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Utils.Logger.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682972404"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">MessageClass
</span><a href="GHC.Types.Error.html#MCInfo"><span class="hs-identifier hs-var">Err.MCInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>  </span><span class="hs-comment">-- See Note [MCInfo for Lint]</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="annottext">(SDoc -&gt; IO ()) -&gt; SDoc -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PprStyle -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="GHC.Utils.Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-var">defaultDumpStyle</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_banner"><span class="hs-identifier hs-var">lint_banner</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;warnings&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972406"><span class="hs-identifier hs-var">pp_what</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; SDoc
</span><a href="GHC.Types.Error.html#pprMessageBag"><span class="hs-identifier hs-var">Err.pprMessageBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; Bag SDoc -&gt; Bag SDoc
forall a b. (a -&gt; b) -&gt; Bag a -&gt; Bag b
</span><a href="GHC.Data.Bag.html#mapBag"><span class="hs-identifier hs-var">mapBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#blankLine"><span class="hs-identifier hs-var">blankLine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972408"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_banner"><span class="hs-identifier hs-type">lint_banner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-458"></span><span id="lint_banner"><span class="annot"><span class="annottext">lint_banner :: String -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_banner"><span class="hs-identifier hs-var hs-var">lint_banner</span></a></span></span><span> </span><span id="local-6989586621682972424"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972424"><span class="hs-identifier hs-var">string</span></a></span></span><span> </span><span id="local-6989586621682972425"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972425"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*** Core Lint&quot;</span></span><span>      </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972424"><span class="hs-identifier hs-var">string</span></a></span><span>
</span><span id="line-459"></span><span>                          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: in result of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972425"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-460"></span><span>                          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;***&quot;</span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="annot"><span class="hs-comment">-- | Type-check a 'CoreProgram'. See Note [Core Lint guarantee].</span></span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreBindings%27"><span class="hs-identifier hs-type">lintCoreBindings'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreProgram"><span class="hs-identifier hs-type">CoreProgram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span>
</span><span id="line-464"></span><span class="hs-comment">--   Returns (warnings, errors)</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-467"></span><span id="lintCoreBindings%27"><span class="annot"><span class="annottext">lintCoreBindings' :: LintConfig -&gt; CoreProgram -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#lintCoreBindings%27"><span class="hs-identifier hs-var hs-var">lintCoreBindings'</span></a></span></span><span> </span><span id="local-6989586621682972426"><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972426"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682972427"><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972427"><span class="hs-identifier hs-var">binds</span></a></span></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; LintM ((), [UsageEnv]) -&gt; WarnsAndErrs
forall a. LintConfig -&gt; LintM a -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-var">initL</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972426"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM ((), [UsageEnv]) -&gt; WarnsAndErrs)
-&gt; LintM ((), [UsageEnv]) -&gt; WarnsAndErrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM ((), [UsageEnv]) -&gt; LintM ((), [UsageEnv])
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LintLocInfo
</span><a href="GHC.Core.Lint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a></span><span>           </span><span class="annot"><span class="annottext">(LintM ((), [UsageEnv]) -&gt; LintM ((), [UsageEnv]))
-&gt; LintM ((), [UsageEnv]) -&gt; LintM ((), [UsageEnv])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972432"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#dupVars"><span class="hs-identifier hs-var">dupVars</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972432"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Name] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621682972434"><span class="hs-identifier hs-var">ext_dups</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Name] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#dupExtVars"><span class="hs-identifier hs-var">dupExtVars</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621682972434"><span class="hs-identifier hs-var">ext_dups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
-&gt; [(Var, CoreExpr)]
-&gt; ([Var] -&gt; LintM ())
-&gt; LintM ((), [UsageEnv])
forall a.
TopLevelFlag
-&gt; [(Var, CoreExpr)] -&gt; ([Var] -&gt; LintM a) -&gt; LintM (a, [UsageEnv])
</span><a href="GHC.Core.Lint.html#lintRecBindings"><span class="hs-identifier hs-var">lintRecBindings</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972438"><span class="hs-identifier hs-var">all_pairs</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM ()) -&gt; LintM ((), [UsageEnv]))
-&gt; ([Var] -&gt; LintM ()) -&gt; LintM ((), [UsageEnv])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>         </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621682972438"><span class="annot"><span class="annottext">all_pairs :: [(Var, CoreExpr)]
</span><a href="#local-6989586621682972438"><span class="hs-identifier hs-var hs-var">all_pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreProgram -&gt; [(Var, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><a href="GHC.Core.html#flattenBinds"><span class="hs-identifier hs-var">flattenBinds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682972427"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-476"></span><span>     </span><span class="hs-comment">-- Put all the top-level binders in scope at the start</span><span>
</span><span id="line-477"></span><span>     </span><span class="hs-comment">-- This is because rewrite rules can bring something</span><span>
</span><span id="line-478"></span><span>     </span><span class="hs-comment">-- into use 'unexpectedly'; see Note [Glomming] in &quot;GHC.Core.Opt.OccurAnal&quot;</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621682972440"><span class="annot"><span class="annottext">binders :: [Var]
</span><a href="#local-6989586621682972440"><span class="hs-identifier hs-var hs-var">binders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, CoreExpr) -&gt; Var) -&gt; [(Var, CoreExpr)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Var, CoreExpr) -&gt; Var
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972438"><span class="hs-identifier hs-var">all_pairs</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972432"><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972432"><span class="hs-identifier hs-var">dups</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Var -&gt; Ordering) -&gt; [Var] -&gt; ([Var], [NonEmpty Var])
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972440"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-comment">-- ext_dups checks for names with different uniques</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-comment">-- but the same External name M.n.  We don't</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-comment">-- allow this at top level:</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-comment">--    M.n{r3}  = ...</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">--    M.n{r29} = ...</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-comment">-- because they both get the same linker symbol</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621682972434"><span class="annot"><span class="annottext">ext_dups :: [NonEmpty Name]
</span><a href="#local-6989586621682972434"><span class="hs-identifier hs-var hs-var">ext_dups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name], [NonEmpty Name]) -&gt; [NonEmpty Name]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Name], [NonEmpty Name]) -&gt; [NonEmpty Name])
-&gt; ([Name], [NonEmpty Name]) -&gt; [NonEmpty Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; (Module, OccName)) -&gt; [Name] -&gt; ([Name], [NonEmpty Name])
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDupsOn"><span class="hs-identifier hs-var">removeDupsOn</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; (Module, OccName)
</span><a href="#local-6989586621682972446"><span class="hs-identifier hs-var">ord_ext</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ([Name], [NonEmpty Name]))
-&gt; [Name] -&gt; ([Name], [NonEmpty Name])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-490"></span><span>               </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [Name]) -&gt; [Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Name) -&gt; [Var] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">Var.varName</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972440"><span class="hs-identifier hs-var">binders</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621682972446"><span class="annot"><span class="annottext">ord_ext :: Name -&gt; (Module, OccName)
</span><a href="#local-6989586621682972446"><span class="hs-identifier hs-var hs-var">ord_ext</span></a></span></span><span> </span><span id="local-6989586621682972450"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682972450"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Module
Name -&gt; Module
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682972450"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682972450"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintUnfolding]{lintUnfolding}
*                                                                      *
************************************************************************

Note [Linting Unfoldings from Interfaces]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We use this to check all top-level unfoldings that come in from interfaces
(it is very painful to catch errors otherwise).

We do not need to call lintUnfolding on unfoldings that are nested within
top-level unfoldings; they are linted when we lint the top-level unfolding;
hence the `TopLevelFlag` on `tcPragExpr` in GHC.IfaceToCore.

-}</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><a href="GHC.Core.Lint.html#lintUnfolding"><span class="hs-identifier hs-type">lintUnfolding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ True &lt;=&gt; is a compulsory unfolding</span></span><span>
</span><span id="line-512"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span>
</span><span id="line-513"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a></span><span>
</span><span id="line-514"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-515"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Nothing =&gt; OK</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="lintUnfolding"><span class="annot"><span class="annottext">lintUnfolding :: Bool -&gt; LintConfig -&gt; SrcLoc -&gt; CoreExpr -&gt; Maybe (Bag SDoc)
</span><a href="GHC.Core.Lint.html#lintUnfolding"><span class="hs-identifier hs-var hs-var">lintUnfolding</span></a></span></span><span> </span><span id="local-6989586621682972453"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972453"><span class="hs-identifier hs-var">is_compulsory</span></a></span></span><span> </span><span id="local-6989586621682972454"><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972454"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682972455"><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682972455"><span class="hs-identifier hs-var">locn</span></a></span></span><span> </span><span id="local-6989586621682972456"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972456"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972457"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Bag SDoc)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; Maybe (Bag SDoc)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972457"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682972458"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972458"><span class="hs-identifier hs-var">_warns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972457"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972457"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; LintM (LintedType, UsageEnv) -&gt; WarnsAndErrs
forall a. LintConfig -&gt; LintM a -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-var">initL</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972454"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; WarnsAndErrs)
-&gt; LintM (LintedType, UsageEnv) -&gt; WarnsAndErrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-522"></span><span>                     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972453"><span class="hs-identifier hs-var">is_compulsory</span></a></span><span>
</span><span id="line-523"></span><span>                       </span><span class="hs-comment">-- See Note [Checking for representation polymorphism]</span><span>
</span><span id="line-524"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#noFixedRuntimeRepChecks"><span class="hs-identifier hs-var">noFixedRuntimeRepChecks</span></a></span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972460"><span class="hs-identifier hs-var">linter</span></a></span><span>
</span><span id="line-525"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972460"><span class="hs-identifier hs-var">linter</span></a></span><span>
</span><span id="line-526"></span><span>    </span><span id="local-6989586621682972460"><span class="annot"><span class="annottext">linter :: LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972460"><span class="hs-identifier hs-var hs-var">linter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#ImportedUnfolding"><span class="hs-identifier hs-var">ImportedUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682972455"><span class="hs-identifier hs-var">locn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-527"></span><span>             </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972456"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="annot"><a href="GHC.Core.Lint.html#lintExpr"><span class="hs-identifier hs-type">lintExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span>
</span><span id="line-530"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-531"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Nothing =&gt; OK</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span id="lintExpr"><span class="annot"><span class="annottext">lintExpr :: LintConfig -&gt; CoreExpr -&gt; Maybe (Bag SDoc)
</span><a href="GHC.Core.Lint.html#lintExpr"><span class="hs-identifier hs-var hs-var">lintExpr</span></a></span></span><span> </span><span id="local-6989586621682972463"><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972463"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682972464"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972464"><span class="hs-identifier hs-var">expr</span></a></span></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972465"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Bag SDoc)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; Maybe (Bag SDoc)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972465"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682972466"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972466"><span class="hs-identifier hs-var">_warns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972465"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682972465"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; LintM (LintedType, UsageEnv) -&gt; WarnsAndErrs
forall a. LintConfig -&gt; LintM a -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-var">initL</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682972463"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972467"><span class="hs-identifier hs-var">linter</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621682972467"><span class="annot"><span class="annottext">linter :: LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972467"><span class="hs-identifier hs-var hs-var">linter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LintLocInfo
</span><a href="GHC.Core.Lint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-539"></span><span>             </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972464"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintCoreBinding]{lintCoreBinding}
*                                                                      *
************************************************************************

Check a core binding, returning the list of variables bound.
-}</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- Returns a UsageEnv because this function is called in lintCoreExpr for</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- Let</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span id="local-6989586621682970377"><span class="annot"><a href="GHC.Core.Lint.html#lintRecBindings"><span class="hs-identifier hs-type">lintRecBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-555"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-type">LintedId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970377"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682970377"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-556"></span><span id="lintRecBindings"><span class="annot"><span class="annottext">lintRecBindings :: forall a.
TopLevelFlag
-&gt; [(Var, CoreExpr)] -&gt; ([Var] -&gt; LintM a) -&gt; LintM (a, [UsageEnv])
</span><a href="GHC.Core.Lint.html#lintRecBindings"><span class="hs-identifier hs-var hs-var">lintRecBindings</span></a></span></span><span> </span><span id="local-6989586621682972477"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682972477"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621682972478"><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972478"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span id="local-6989586621682972479"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682972479"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
-&gt; [Var]
-&gt; ([Var] -&gt; LintM (a, [UsageEnv]))
-&gt; LintM (a, [UsageEnv])
forall a. TopLevelFlag -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintIdBndrs"><span class="hs-identifier hs-var">lintIdBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682972477"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972481"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM (a, [UsageEnv])) -&gt; LintM (a, [UsageEnv]))
-&gt; ([Var] -&gt; LintM (a, [UsageEnv])) -&gt; LintM (a, [UsageEnv])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682972482"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972482"><span class="hs-identifier hs-var">bndrs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972483"><span class="annot"><a href="#local-6989586621682972483"><span class="hs-identifier hs-var">ues</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; CoreExpr -&gt; LintM UsageEnv)
-&gt; [Var] -&gt; [CoreExpr] -&gt; LintM [UsageEnv]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; LintM UsageEnv
</span><a href="#local-6989586621682972485"><span class="hs-identifier hs-var">lint_pair</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972482"><span class="hs-identifier hs-var">bndrs'</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972486"><span class="hs-identifier hs-var">rhss</span></a></span><span>
</span><span id="line-559"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972487"><span class="annot"><a href="#local-6989586621682972487"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682972479"><span class="hs-identifier hs-type">thing_inside</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972482"><span class="hs-identifier hs-type">bndrs'</span></a></span><span>
</span><span id="line-560"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972483"><span class="hs-identifier hs-type">ues</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682972481"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972481"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972486"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972486"><span class="hs-identifier hs-var">rhss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)] -&gt; ([Var], [CoreExpr])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972478"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621682972485"><span class="annot"><span class="annottext">lint_pair :: Var -&gt; CoreExpr -&gt; LintM UsageEnv
</span><a href="#local-6989586621682972485"><span class="hs-identifier hs-var hs-var">lint_pair</span></a></span></span><span> </span><span id="local-6989586621682972489"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972489"><span class="hs-identifier hs-var">bndr'</span></a></span></span><span> </span><span id="local-6989586621682972490"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972490"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM UsageEnv -&gt; LintM UsageEnv
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972489"><span class="hs-identifier hs-var">bndr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM UsageEnv -&gt; LintM UsageEnv)
-&gt; LintM UsageEnv -&gt; LintM UsageEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972492"><span class="annot"><a href="#local-6989586621682972492"><span class="hs-identifier hs-var">rhs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972493"><span class="annot"><a href="#local-6989586621682972493"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var">lintRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972489"><span class="hs-identifier hs-var">bndr'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972490"><span class="hs-identifier hs-var">rhs</span></a></span><span>         </span><span class="hs-comment">-- Check the rhs</span><span>
</span><span id="line-566"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintLetBind"><span class="hs-identifier hs-type">lintLetBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972477"><span class="hs-identifier hs-type">top_lvl</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Recursive"><span class="hs-identifier hs-type">Recursive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972489"><span class="hs-identifier hs-type">bndr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972490"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972492"><span class="hs-identifier hs-type">rhs_ty</span></a></span><span>
</span><span id="line-567"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682972493"><span class="hs-identifier hs-type">ue</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="GHC.Core.Lint.html#lintLetBody"><span class="hs-identifier hs-type">lintLetBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-type">LintedId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span id="lintLetBody"><span class="annot"><span class="annottext">lintLetBody :: LintLocInfo -&gt; [Var] -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLetBody"><span class="hs-identifier hs-var hs-var">lintLetBody</span></a></span></span><span> </span><span id="local-6989586621682972498"><span class="annot"><span class="annottext">LintLocInfo
</span><a href="#local-6989586621682972498"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621682972499"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972499"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621682972500"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972500"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972501"><span class="annot"><a href="#local-6989586621682972501"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972502"><span class="annot"><a href="#local-6989586621682972502"><span class="hs-identifier hs-var">body_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LintLocInfo
</span><a href="#local-6989586621682972498"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972500"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lintJoinBndrType"><span class="hs-identifier hs-type">lintJoinBndrType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972501"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682972499"><span class="hs-identifier hs-type">bndrs</span></a></span><span>
</span><span id="line-573"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972501"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972502"><span class="hs-identifier hs-type">body_ue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="GHC.Core.Lint.html#lintLetBind"><span class="hs-identifier hs-type">lintLetBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#RecFlag"><span class="hs-identifier hs-type">RecFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-type">LintedId</span></a></span><span>
</span><span id="line-576"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- Binder's type, and the RHS, have already been linted</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- This function checks other invariants</span><span>
</span><span id="line-579"></span><span id="lintLetBind"><span class="annot"><span class="annottext">lintLetBind :: TopLevelFlag
-&gt; RecFlag -&gt; Var -&gt; CoreExpr -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintLetBind"><span class="hs-identifier hs-var hs-var">lintLetBind</span></a></span></span><span> </span><span id="local-6989586621682972505"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682972505"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621682972506"><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621682972506"><span class="hs-identifier hs-var">rec_flag</span></a></span></span><span> </span><span id="local-6989586621682972507"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621682972508"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682972509"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972509"><span class="hs-identifier hs-var">rhs_ty</span></a></span></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972510"><span class="annot"><span class="annottext">binder_ty :: LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var hs-var hs-var">binder_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span>
</span><span id="line-581"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var">binder_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972509"><span class="hs-identifier hs-var">rhs_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkRhsMsg"><span class="hs-identifier hs-var">mkRhsMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RHS&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972509"><span class="hs-identifier hs-var">rhs_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>       </span><span class="hs-comment">-- If the binding is for a CoVar, the RHS should be (Coercion co)</span><span>
</span><span id="line-584"></span><span>       </span><span class="hs-comment">-- See Note [Core type and coercion invariant] in GHC.Core</span><span>
</span><span id="line-585"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
forall b. Expr b -&gt; Bool
</span><a href="GHC.Core.html#isCoArg"><span class="hs-identifier hs-var">isCoArg</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkLetErr"><span class="hs-identifier hs-var">mkLetErr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>        </span><span class="hs-comment">-- Check the let-can-float invariant</span><span>
</span><span id="line-589"></span><span>        </span><span class="hs-comment">-- See Note [Core let-can-float invariant] in GHC.Core</span><span>
</span><span id="line-590"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-var">isJoinId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span>
</span><span id="line-591"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#mightBeLiftedType"><span class="hs-identifier hs-var">mightBeLiftedType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var">binder_ty</span></a></span><span>
</span><span id="line-592"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isNonRec"><span class="hs-identifier hs-var">isNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="#local-6989586621682972506"><span class="hs-identifier hs-var">rec_flag</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="GHC.Core.Utils.html#exprOkForSpeculation"><span class="hs-identifier hs-var">exprOkForSpeculation</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isDataConWorkId"><span class="hs-identifier hs-var">isDataConWorkId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isDataConWrapId"><span class="hs-identifier hs-var">isDataConWrapId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-comment">-- until #17521 is fixed</span><span>
</span><span id="line-594"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="GHC.Core.Utils.html#exprIsTickedString"><span class="hs-identifier hs-var">exprIsTickedString</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#badBndrTyMsg"><span class="hs-identifier hs-var">badBndrTyMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unlifted&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-comment">-- Check that if the binder is at the top level and has type Addr#,</span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-comment">-- that it is a string literal.</span><span>
</span><span id="line-599"></span><span>        </span><span class="hs-comment">-- See Note [Core top-level string literals].</span><span>
</span><span id="line-600"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682972505"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var">binder_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="GHC.Builtin.Types.Prim.html#addrPrimTy"><span class="hs-identifier hs-var">addrPrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="GHC.Core.Utils.html#exprIsTickedString"><span class="hs-identifier hs-var">exprIsTickedString</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972508"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkTopNonLitStrMsg"><span class="hs-identifier hs-var">mkTopNonLitStrMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972530"><span class="annot"><a href="#local-6989586621682972530"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span>         </span><span class="hs-comment">-- Check that a join-point binder has a valid type</span><span>
</span><span id="line-607"></span><span>         </span><span class="hs-comment">-- NB: lintIdBinder has checked that it is not top-level bound</span><span>
</span><span id="line-608"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-type">idJoinPointHood</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-609"></span><span>            </span><span class="annot"><span class="annottext">JoinPointHood
</span><a href="GHC.Utils.Outputable.html#NotJoinPoint"><span class="hs-identifier hs-var">NotJoinPoint</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>            </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682972535"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972535"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isValidJoinPointType"><span class="hs-identifier hs-var">isValidJoinPointType</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972535"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var">binder_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkInvalidJoinPointMsg"><span class="hs-identifier hs-var">mkInvalidJoinPointMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972510"><span class="hs-identifier hs-var">binder_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_inline_loop_breakers"><span class="hs-identifier hs-var">lf_check_inline_loop_breakers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972530"><span class="hs-identifier hs-type">flags</span></a></span><span>
</span><span id="line-614"></span><span>               </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.html#isStableUnfolding"><span class="hs-identifier hs-type">isStableUnfolding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#realIdUnfolding"><span class="hs-identifier hs-type">realIdUnfolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>               </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#isStrongLoopBreaker"><span class="hs-identifier hs-type">isStrongLoopBreaker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idOccInfo"><span class="hs-identifier hs-type">idOccInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>               </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#isInlinePragma"><span class="hs-identifier hs-type">isInlinePragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idInlinePragma"><span class="hs-identifier hs-type">idInlinePragma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-type">addWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;INLINE binder is (non-rule) loop breaker:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>              </span><span class="hs-comment">-- Only non-rule loop breakers inhibit inlining</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>       </span><span class="hs-comment">-- We used to check that the dmdTypeDepth of a demand signature never</span><span>
</span><span id="line-621"></span><span>       </span><span class="hs-comment">-- exceeds idArity, but that is an unnecessary complication, see</span><span>
</span><span id="line-622"></span><span>       </span><span class="hs-comment">-- Note [idArity varies independently of dmdTypeDepth] in GHC.Core.Opt.DmdAnal</span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span>       </span><span class="hs-comment">-- Check that the binder's arity is within the bounds imposed by the type</span><span>
</span><span id="line-625"></span><span>       </span><span class="hs-comment">-- and the strictness signature. See Note [Arity invariants for bindings]</span><span>
</span><span id="line-626"></span><span>       </span><span class="hs-comment">-- and Note [Trimming arity]</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.Arity.html#typeArity"><span class="hs-identifier hs-type">typeArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idArity"><span class="hs-identifier hs-type">idArity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;idArity&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idArity"><span class="hs-identifier hs-type">idArity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-630"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;exceeds typeArity&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-631"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.Arity.html#typeArity"><span class="hs-identifier hs-type">typeArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-type">colon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-632"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span>       </span><span class="hs-comment">-- See Note [idArity varies independently of dmdTypeDepth]</span><span>
</span><span id="line-635"></span><span>       </span><span class="hs-comment">--     in GHC.Core.Opt.DmdAnal</span><span>
</span><span id="line-636"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Demand.html#splitDmdSig"><span class="hs-identifier hs-type">splitDmdSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idDmdSig"><span class="hs-identifier hs-type">idDmdSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-637"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621682972551"><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621682972551"><span class="hs-identifier hs-var">demands</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972552"><span class="annot"><span class="annottext">Divergence
</span><a href="#local-6989586621682972552"><span class="hs-identifier hs-var">result_info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Divergence -&gt; Bool
</span><a href="GHC.Types.Demand.html#isDeadEndDiv"><span class="hs-identifier hs-var">isDeadEndDiv</span></a></span><span> </span><span class="annot"><span class="annottext">Divergence
</span><a href="#local-6989586621682972552"><span class="hs-identifier hs-var">result_info</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-638"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Demand]
</span><a href="#local-6989586621682972551"><span class="hs-identifier hs-var">demands</span></a></span><span> </span><span class="annot"><span class="annottext">[Demand] -&gt; JoinArity -&gt; Bool
forall a. [a] -&gt; JoinArity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthAtLeast"><span class="hs-operator hs-var">`lengthAtLeast`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinArity
</span><a href="GHC.Types.Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; LintM () -&gt; LintM ()
forall a. String -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Trace.html#pprTrace"><span class="hs-identifier hs-var">pprTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hack alert: lintLetBind #24623&quot;</span></span><span>
</span><span id="line-641"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; JoinArity
</span><a href="GHC.Types.Id.html#idArity"><span class="hs-identifier hs-var">idArity</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">DmdSig -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; DmdSig
</span><a href="GHC.Types.Id.html#idDmdSig"><span class="hs-identifier hs-var">idDmdSig</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972507"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-642"></span><span>                   </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span class="hs-comment">--             checkL (demands `lengthAtLeast` idArity binder)</span><span>
</span><span id="line-644"></span><span class="hs-comment">--               (text &quot;idArity&quot; &lt;+&gt; ppr (idArity binder) &lt;+&gt;</span><span>
</span><span id="line-645"></span><span class="hs-comment">--               text &quot;exceeds arity imposed by the strictness signature&quot; &lt;+&gt;</span><span>
</span><span id="line-646"></span><span class="hs-comment">--               ppr (idDmdSig binder) &lt;&gt; colon &lt;+&gt;</span><span>
</span><span id="line-647"></span><span class="hs-comment">--               ppr binder)</span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>           </span><span class="annot"><span class="annottext">([Demand], Divergence)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#RuleOf"><span class="hs-identifier hs-type">RuleOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreRule"><span class="hs-identifier hs-type">lintCoreRule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972510"><span class="hs-identifier hs-type">binder_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idCoreRules"><span class="hs-identifier hs-type">idCoreRules</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#UnfoldingOf"><span class="hs-identifier hs-type">UnfoldingOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-654"></span><span>         </span><span class="annot"><a href="GHC.Core.Lint.html#lintIdUnfolding"><span class="hs-identifier hs-type">lintIdUnfolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972510"><span class="hs-identifier hs-type">binder_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idUnfolding"><span class="hs-identifier hs-type">idUnfolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972507"><span class="hs-identifier hs-type">binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span>        </span><span class="hs-comment">-- We should check the unfolding, if any, but this is tricky because</span><span>
</span><span id="line-658"></span><span>        </span><span class="hs-comment">-- the unfolding is a SimplifiableCoreExpr. Give up for now.</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- | Checks the RHS of bindings. It only differs from 'lintCoreExpr'</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- in that it doesn't reject occurrences of the function 'makeStatic' when they</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- appear at the top level and @lf_check_static_ptrs == AllowAtTopLevel@, and</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- for join points, it skips the outer lambdas that take arguments to the</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- join point.</span><span>
</span><span id="line-665"></span><span class="hs-comment">--</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- See Note [Checking StaticPtrs].</span><span>
</span><span id="line-667"></span><span class="annot"><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-type">lintRhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- NB: the Id can be Linted or not -- it's only used for</span><span>
</span><span id="line-669"></span><span class="hs-comment">--     its OccInfo and join-pointer-hood</span><span>
</span><span id="line-670"></span><span id="lintRhs"><span class="annot"><span class="annottext">lintRhs :: Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var hs-var">lintRhs</span></a></span></span><span> </span><span id="local-6989586621682972561"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972561"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682972562"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972562"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-671"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682972563"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972563"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinPointHood
</span><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-var">idJoinPointHood</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972561"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; Maybe Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintJoinLams"><span class="hs-identifier hs-var">lintJoinLams</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972563"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972561"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972562"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#AlwaysTailCalled"><span class="hs-identifier hs-type">AlwaysTailCalled</span></a></span><span> </span><span id="local-6989586621682972566"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972566"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OccInfo -&gt; TailCallInfo
</span><a href="GHC.Types.Basic.html#tailCallInfo"><span class="hs-identifier hs-var">tailCallInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; OccInfo
</span><a href="GHC.Types.Id.html#idOccInfo"><span class="hs-identifier hs-var">idOccInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972561"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; Maybe Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintJoinLams"><span class="hs-identifier hs-var">lintJoinLams</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972566"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972562"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- Allow applications of the data constructor @StaticPtr@ at the top</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- but produce errors otherwise.</span><span>
</span><span id="line-678"></span><span class="annot"><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var">lintRhs</span></a></span><span> </span><span id="local-6989586621682972568"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972568"><span class="hs-identifier hs-var">_bndr</span></a></span></span><span> </span><span id="local-6989586621682972569"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972569"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintFlags -&gt; StaticPtrCheck)
-&gt; LintM LintFlags -&gt; LintM StaticPtrCheck
forall a b. (a -&gt; b) -&gt; LintM a -&gt; LintM b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LintFlags -&gt; StaticPtrCheck
</span><a href="GHC.Core.Lint.html#lf_check_static_ptrs"><span class="hs-identifier hs-var">lf_check_static_ptrs</span></a></span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span> </span><span class="annot"><span class="annottext">LintM StaticPtrCheck
-&gt; (StaticPtrCheck -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv)
forall a b. LintM a -&gt; (a -&gt; LintM b) -&gt; LintM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">StaticPtrCheck -&gt; LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972571"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-comment">-- Allow occurrences of 'makeStatic' at the top-level but produce errors</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-comment">-- otherwise.</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="#local-6989586621682972571"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#StaticPtrCheck"><span class="hs-identifier hs-type">StaticPtrCheck</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#OutType"><span class="hs-identifier hs-type">OutType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621682972571"><span class="annot"><span class="annottext">go :: StaticPtrCheck -&gt; LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972571"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">StaticPtrCheck
</span><a href="GHC.Core.Lint.html#AllowAtTopLevel"><span class="hs-identifier hs-var">AllowAtTopLevel</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972574"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972574"><span class="hs-identifier hs-var">binders0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972575"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972575"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; ([Var], CoreExpr)
</span><a href="GHC.Core.html#collectTyBinders"><span class="hs-identifier hs-var">collectTyBinders</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972569"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972577"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972577"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972578"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972578"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972579"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972579"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972580"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972580"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (CoreExpr, LintedType, CoreExpr, CoreExpr)
</span><a href="GHC.Core.Utils.html#collectMakeStaticArgs"><span class="hs-identifier hs-var">collectMakeStaticArgs</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972575"><span class="hs-identifier hs-var">rhs'</span></a></span><span>
</span><span id="line-686"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-687"></span><span>        </span><span class="annot"><span class="annottext">(Var
 -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv)
-&gt; [Var]
-&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-688"></span><span>        </span><span class="hs-comment">-- imitate @lintCoreExpr (Lam ...)@</span><span>
</span><span id="line-689"></span><span>        </span><span class="annot"><span class="annottext">Var -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-var">lintLambda</span></a></span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-comment">-- imitate @lintCoreExpr (App ...)@</span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682972585"><span class="annot"><a href="#local-6989586621682972585"><span class="hs-identifier hs-var">fun_ty_ue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972577"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-692"></span><span>            </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-type">lintCoreArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972585"><span class="hs-identifier hs-type">fun_ty_ue</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972578"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972579"><span class="hs-identifier hs-type">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972580"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>        </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972574"><span class="hs-identifier hs-var">binders0</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><a href="#local-6989586621682972571"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StaticPtrCheck
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972569"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="hs-comment">-- | Lint the RHS of a join point with expected join arity of @n@ (see Note</span><span>
</span><span id="line-698"></span><span class="hs-comment">-- [Join points] in &quot;GHC.Core&quot;).</span><span>
</span><span id="line-699"></span><span class="annot"><a href="GHC.Core.Lint.html#lintJoinLams"><span class="hs-identifier hs-type">lintJoinLams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span id="lintJoinLams"><span class="annot"><span class="annottext">lintJoinLams :: JoinArity -&gt; Maybe Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintJoinLams"><span class="hs-identifier hs-var hs-var">lintJoinLams</span></a></span></span><span> </span><span id="local-6989586621682972588"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972588"><span class="hs-identifier hs-var">join_arity</span></a></span></span><span> </span><span id="local-6989586621682972589"><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621682972589"><span class="hs-identifier hs-var">enforce</span></a></span></span><span> </span><span id="local-6989586621682972590"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972590"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972591"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972588"><span class="hs-identifier hs-var">join_arity</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972590"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621682972591"><span class="annot"><span class="annottext">go :: JoinArity -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972591"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682972592"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972592"><span class="hs-identifier hs-var">expr</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972592"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-704"></span><span>    </span><span class="annot"><a href="#local-6989586621682972591"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682972593"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621682972595"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972595"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972596"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972596"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-var">lintLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972595"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972591"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972593"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972596"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span class="annot"><a href="#local-6989586621682972591"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682972597"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972597"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682972598"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972598"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972599"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972599"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621682972589"><span class="hs-identifier hs-var">enforce</span></a></span><span> </span><span class="hs-comment">-- Join point with too few RHS lambdas</span><span>
</span><span id="line-706"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM (LintedType, UsageEnv)
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM (LintedType, UsageEnv))
-&gt; SDoc -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; JoinArity -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJoinArityMsg"><span class="hs-identifier hs-var">mkBadJoinArityMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972599"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972588"><span class="hs-identifier hs-var">join_arity</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972597"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972590"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-707"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">-- Future join point, not yet eta-expanded</span><span>
</span><span id="line-708"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972598"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-709"></span><span>                </span><span class="hs-comment">-- Body of lambda is not a tail position</span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span class="annot"><a href="GHC.Core.Lint.html#lintIdUnfolding"><span class="hs-identifier hs-type">lintIdUnfolding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Unfolding"><span class="hs-identifier hs-type">Unfolding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span id="lintIdUnfolding"><span class="annot"><span class="annottext">lintIdUnfolding :: Var -&gt; LintedType -&gt; Unfolding -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintIdUnfolding"><span class="hs-identifier hs-var hs-var">lintIdUnfolding</span></a></span></span><span> </span><span id="local-6989586621682972603"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972603"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682972604"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972604"><span class="hs-identifier hs-var">bndr_ty</span></a></span></span><span> </span><span id="local-6989586621682972605"><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682972605"><span class="hs-identifier hs-var">uf</span></a></span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Unfolding -&gt; Bool
</span><a href="GHC.Core.html#isStableUnfolding"><span class="hs-identifier hs-var">isStableUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682972605"><span class="hs-identifier hs-var">uf</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972606"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972606"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unfolding -&gt; Maybe CoreExpr
</span><a href="GHC.Core.html#maybeUnfoldingTemplate"><span class="hs-identifier hs-var">maybeUnfoldingTemplate</span></a></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682972605"><span class="hs-identifier hs-var">uf</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972608"><span class="annot"><a href="#local-6989586621682972608"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv) -&gt; LintedType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((LintedType, UsageEnv) -&gt; LintedType)
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM LintedType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Unfolding -&gt; Bool
</span><a href="GHC.Core.html#isCompulsoryUnfolding"><span class="hs-identifier hs-var">isCompulsoryUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><a href="#local-6989586621682972605"><span class="hs-identifier hs-var">uf</span></a></span><span>
</span><span id="line-716"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#noFixedRuntimeRepChecks"><span class="hs-identifier hs-var">noFixedRuntimeRepChecks</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var">lintRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972603"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972606"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-717"></span><span>            </span><span class="hs-comment">--               ^^^^^^^^^^^^^^^^^^^^^^^</span><span>
</span><span id="line-718"></span><span>            </span><span class="hs-comment">-- See Note [Checking for representation polymorphism]</span><span>
</span><span id="line-719"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var">lintRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972603"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972606"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972604"><span class="hs-identifier hs-type">bndr_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972608"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkRhsMsg"><span class="hs-identifier hs-type">mkRhsMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972603"><span class="hs-identifier hs-type">bndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;unfolding&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682972608"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-721"></span><span class="annot"><a href="GHC.Core.Lint.html#lintIdUnfolding"><span class="hs-identifier hs-var">lintIdUnfolding</span></a></span><span>  </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Unfolding
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Do not Lint unstable unfoldings, because that leads</span><span>
</span><span id="line-723"></span><span>                    </span><span class="hs-comment">-- to exponential behaviour; c.f. GHC.Core.FVs.idUnfoldingVars</span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span class="hs-comment">{- Note [Checking for INLINE loop breakers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's very suspicious if a strong loop breaker is marked INLINE.

However, the desugarer generates instance methods with INLINE pragmas
that form a mutually recursive group.  Only after a round of
simplification are they unravelled.  So we suppress the test for
the desugarer.  Here is an example:
  instance Eq T where
    t1 == t2 = blah
    t1 /= t2 = not (t1 == t2)
    {-# INLINE (/=) #-}

This will generate something like
    -- From the class decl for Eq
    data Eq a = EqDict (a-&gt;a-&gt;Bool) (a-&gt;a-&gt;Bool)
    eq_sel :: Eq a -&gt; (a-&gt;a-&gt;Bool)
    eq_sel (EqDict eq _) = eq

    -- From the instance Eq T
    $ceq :: T -&gt; T -&gt; Bool
    $ceq = blah

    Rec { $dfEqT :: Eq T {-# DFunId #-}
          $dfEqT = EqDict $ceq $cnoteq

          $cnoteq :: T -&gt; T -&gt; Bool  {-# INLINE #-}
          $cnoteq x y = not (eq_sel $dfEqT x y) }

Notice that

* `$dfEqT` and `$cnotEq` are mutually recursive.

* We do not want `$dfEqT` to be the loop breaker: it's a DFunId, and
  we want to let it &quot;cancel&quot; with &quot;eq_sel&quot; (see Note [ClassOp/DFun
  selection] in GHC.Tc.TyCl.Instance, which it can't do if it's a loop
  breaker.

So we make `$cnoteq` into the loop breaker. That means it can't
inline, despite the INLINE pragma. That's what gives rise to the
warning, which is perfectly appropriate for, say
   Rec { {-# INLINE f #-}  f = \x -&gt; ...f.... }
We can't inline a recursive function -- it's a loop breaker.

But now we can optimise `eq_sel $dfEqT` to `$ceq`, so we get
  Rec {
    $dfEqT :: Eq T {-# DFunId #-}
    $dfEqT = EqDict $ceq $cnoteq

    $cnoteq :: T -&gt; T -&gt; Bool  {-# INLINE #-}
    $cnoteq x y = not ($ceq x y) }

and now the dependencies of the Rec have gone, and we can split it up to give
    NonRec {  $dfEqT :: Eq T {-# DFunId #-}
              $dfEqT = EqDict $ceq $cnoteq }

    NonRec {  $cnoteq :: T -&gt; T -&gt; Bool  {-# INLINE #-}
              $cnoteq x y = not ($ceq x y) }

Now $cnoteq is not a loop breaker any more, so the INLINE pragma can
take effect -- the warning turned out to be temporary.

To stop excessive warnings, this warning for INLINE loop breakers is
switched off when linting the result of the desugarer.  See
lf_check_inline_loop_breakers in GHC.Core.Lint.


Note [Checking for representation polymorphism]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We ordinarily want to check for bad representation polymorphism. See
Note [Representation polymorphism invariants] in GHC.Core. However, we do *not*
want to do this in a compulsory unfolding. Compulsory unfoldings arise
only internally, for things like newtype wrappers, dictionaries, and
(notably) unsafeCoerce#. These might legitimately be representation-polymorphic;
indeed representation-polymorphic unfoldings are a primary reason for the
very existence of compulsory unfoldings (we can't compile code for
the original, representation-polymorphic, binding).

It is vitally important that we do representation polymorphism checks *after*
performing the unfolding, but not beforehand. This is all safe because
we will check any unfolding after it has been unfolded; checking the
unfolding beforehand is merely an optimization, and one that actively
hurts us here.

Note [Linting of runRW#]
~~~~~~~~~~~~~~~~~~~~~~~~
runRW# has some very special behavior (see Note [runRW magic] in
GHC.CoreToStg.Prep) which CoreLint must accommodate, by allowing
join points in its argument.  For example, this is fine:

    join j x = ...
    in runRW#  (\s. case v of
                       A -&gt; j 3
                       B -&gt; j 4)

Usually those calls to the join point 'j' would not be valid tail calls,
because they occur in a function argument.  But in the case of runRW#
they are fine, because runRW# (\s.e) behaves operationally just like e.
(runRW# is ultimately inlined in GHC.CoreToStg.Prep.)

In the case that the continuation is /not/ a lambda we simply disable this
special behaviour.  For example, this is /not/ fine:

    join j = ...
    in runRW# @r @ty (jump j)

Note [Coercions in terms]
~~~~~~~~~~~~~~~~~~~~~~~~~
The expression (Type ty) can occur only as the argument of an application,
or the RHS of a non-recursive Let.  But what about (Coercion co)?

Currently it appears in ghc-prim:GHC.Types.coercible_sel, a WiredInId whose
definition is:
   coercible_sel :: Coercible a b =&gt; (a ~R# b)
   coercible_sel d = case d of
                         MkCoercibleDict (co :: a ~# b) -&gt; Coercion co

So this function has a (Coercion co) in the alternative of a case.

Richard says (!11908): it shouldn't appear outside of arguments, but we've been
loose about this. coercible_sel is some thin ice. Really we should be unpacking
Coercible using case, not a selector. I recall looking into this a few years
back and coming to the conclusion that the fix was worse than the disease. Don't
remember the details, but could probably recover it if we want to revisit.

So Lint current accepts (Coercion co) in arbitrary places.  There is no harm in
that: it really is a value, albeit a zero-bit value.

************************************************************************
*                                                                      *
\subsection[lintCoreExpr]{lintCoreExpr}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- Linted things: substitution applied, and type is linted</span><span>
</span><span id="line-861"></span><span class="hs-keyword">type</span><span> </span><span id="LintedType"><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-var">LintedType</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-862"></span><span class="hs-keyword">type</span><span> </span><span id="LintedKind"><span class="annot"><a href="GHC.Core.Lint.html#LintedKind"><span class="hs-identifier hs-var">LintedKind</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span>
</span><span id="line-863"></span><span class="hs-keyword">type</span><span> </span><span id="LintedCoercion"><span class="annot"><a href="GHC.Core.Lint.html#LintedCoercion"><span class="hs-identifier hs-var">LintedCoercion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-864"></span><span class="hs-keyword">type</span><span> </span><span id="LintedTyCoVar"><span class="annot"><a href="GHC.Core.Lint.html#LintedTyCoVar"><span class="hs-identifier hs-var">LintedTyCoVar</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span>
</span><span id="line-865"></span><span class="hs-keyword">type</span><span> </span><span id="LintedId"><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-var">LintedId</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-comment">-- | Lint an expression cast through the given coercion, returning the type</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- resulting from the cast.</span><span>
</span><span id="line-869"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCastExpr"><span class="hs-identifier hs-type">lintCastExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-870"></span><span id="lintCastExpr"><span class="annot"><span class="annottext">lintCastExpr :: CoreExpr -&gt; LintedType -&gt; Coercion -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintCastExpr"><span class="hs-identifier hs-var hs-var">lintCastExpr</span></a></span></span><span> </span><span id="local-6989586621682972617"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972617"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682972618"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972618"><span class="hs-identifier hs-var">expr_ty</span></a></span></span><span> </span><span id="local-6989586621682972619"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972619"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972620"><span class="annot"><a href="#local-6989586621682972620"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972619"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-872"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682972623"><span class="annot"><a href="#local-6989586621682972623"><span class="hs-identifier hs-var">from_ty</span></a></span></span><span> </span><span id="local-6989586621682972624"><span class="annot"><a href="#local-6989586621682972624"><span class="hs-identifier hs-var">to_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972625"><span class="annot"><a href="#local-6989586621682972625"><span class="hs-keyword hs-var">role</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972620"><span class="hs-identifier hs-type">co'</span></a></span><span>
</span><span id="line-873"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-type">checkValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972624"><span class="hs-identifier hs-type">to_ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-874"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;target of cast&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-type">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972620"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972620"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-type">Representational</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972625"><span class="hs-keyword hs-type">role</span></a></span><span>
</span><span id="line-876"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972623"><span class="hs-identifier hs-type">from_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972618"><span class="hs-identifier hs-type">expr_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkCastErr"><span class="hs-identifier hs-type">mkCastErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972617"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972620"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972623"><span class="hs-identifier hs-type">from_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972618"><span class="hs-identifier hs-type">expr_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682972624"><span class="hs-identifier hs-type">to_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-type">lintCoreExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- The returned type has the substitution from the monad</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- already applied to it:</span><span>
</span><span id="line-882"></span><span class="hs-comment">--      lintCoreExpr e subst = exprType (subst e)</span><span>
</span><span id="line-883"></span><span class="hs-comment">--</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- The returned &quot;type&quot; can be a kind, if the expression is (Type ty)</span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span id="lintCoreExpr"><span class="annot"><span class="annottext">lintCoreExpr :: CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var hs-var">lintCoreExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682972633"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972633"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-891"></span><span>      </span><span id="local-6989586621682972634"><span class="annot"><a href="#local-6989586621682972634"><span class="hs-identifier hs-var">var_pair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682972635"><span class="annot"><a href="#local-6989586621682972635"><span class="hs-identifier hs-var">var_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintIdOcc"><span class="hs-identifier hs-var">lintIdOcc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972633"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span>
</span><span id="line-892"></span><span>      </span><span class="hs-comment">-- See Note [Linting representation-polymorphic builtins]</span><span>
</span><span id="line-893"></span><span>      </span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltin"><span class="hs-identifier hs-type">checkRepPolyBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972633"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682972635"><span class="hs-identifier hs-type">var_ty</span></a></span><span>
</span><span id="line-894"></span><span>      </span><span class="hs-comment">--checkDataToTagPrimOpTyCon (Var var) []</span><span>
</span><span id="line-895"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682972634"><span class="hs-identifier hs-type">var_pair</span></a></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682972639"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682972639"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; LintedType
</span><a href="GHC.Types.Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682972639"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Cast"><span class="hs-identifier hs-type">Cast</span></a></span><span> </span><span id="local-6989586621682972643"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972643"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682972644"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972644"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972645"><span class="annot"><a href="#local-6989586621682972645"><span class="hs-identifier hs-var">expr_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972646"><span class="annot"><a href="#local-6989586621682972646"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972643"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>            </span><span class="hs-comment">-- markAllJoinsBad: see Note [Join points and casts]</span><span>
</span><span id="line-903"></span><span>       </span><span id="local-6989586621682972647"><span class="annot"><a href="#local-6989586621682972647"><span class="hs-identifier hs-var">to_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCastExpr"><span class="hs-identifier hs-type">lintCastExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972643"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972645"><span class="hs-identifier hs-type">expr_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972644"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-904"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972647"><span class="hs-identifier hs-type">to_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972646"><span class="hs-identifier hs-type">ue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span id="local-6989586621682972649"><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972649"><span class="hs-identifier hs-var">tickish</span></a></span></span><span> </span><span id="local-6989586621682972650"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972650"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972649"><span class="hs-identifier hs-var">tickish</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-908"></span><span>         </span><span class="annot"><a href="GHC.Types.Tickish.html#Breakpoint"><span class="hs-identifier hs-type">Breakpoint</span></a></span><span> </span><span class="annot"><span class="annottext">XBreakpoint 'TickishPassCore
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682972652"><span class="annot"><span class="annottext">[XTickishId 'TickishPassCore]
</span><a href="#local-6989586621682972652"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="annot"><span class="annottext">Module
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; (Var -&gt; LintM (Var, LintedType)) -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Var]
[XTickishId 'TickishPassCore]
</span><a href="#local-6989586621682972652"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="annot"><span class="annottext">((Var -&gt; LintM (Var, LintedType)) -&gt; LintM ())
-&gt; (Var -&gt; LintM (Var, LintedType)) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682972653"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972653"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-909"></span><span>                                   </span><span class="annot"><span class="annottext">Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkDeadIdOcc"><span class="hs-identifier hs-var">checkDeadIdOcc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972653"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-910"></span><span>                                   </span><span class="annot"><span class="annottext">Var -&gt; LintM (Var, LintedType)
</span><a href="GHC.Core.Lint.html#lookupIdInScope"><span class="hs-identifier hs-var">lookupIdInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972653"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-911"></span><span>         </span><span class="annot"><span class="annottext">CoreTickish
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>       </span><span class="annot"><span class="annottext">Bool
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. Bool -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBadIf"><span class="hs-identifier hs-var">markAllJoinsBadIf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682972657"><span class="hs-identifier hs-var">block_joins</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972650"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-913"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-914"></span><span>    </span><span id="local-6989586621682972657"><span class="annot"><span class="annottext">block_joins :: Bool
</span><a href="#local-6989586621682972657"><span class="hs-identifier hs-var hs-var">block_joins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972649"><span class="hs-identifier hs-var">tickish</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; TickishScoping -&gt; Bool
forall (pass :: TickishPass).
GenTickish pass -&gt; TickishScoping -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishScopesLike"><span class="hs-operator hs-var">`tickishScopesLike`</span></a></span><span> </span><span class="annot"><span class="annottext">TickishScoping
</span><a href="GHC.Types.Tickish.html#SoftScope"><span class="hs-identifier hs-var">SoftScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>      </span><span class="hs-comment">-- TODO Consider whether this is the correct rule. It is consistent with</span><span>
</span><span id="line-916"></span><span>      </span><span class="hs-comment">-- the simplifier's behaviour - cost-centre-scoped ticks become part of</span><span>
</span><span id="line-917"></span><span>      </span><span class="hs-comment">-- the continuation, and thus they behave like part of an evaluation</span><span>
</span><span id="line-918"></span><span>      </span><span class="hs-comment">-- context, but soft-scoped and non-scoped ticks simply wrap the result</span><span>
</span><span id="line-919"></span><span>      </span><span class="hs-comment">-- (see Simplify.simplTick).</span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span id="local-6989586621682972662"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972662"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682972663"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972663"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972664"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972664"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972662"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- See Note [Linting type lets]</span><span>
</span><span id="line-924"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972666"><span class="annot"><a href="#local-6989586621682972666"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972663"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-925"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintTyBndr"><span class="hs-identifier hs-type">lintTyBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972662"><span class="hs-identifier hs-type">tv</span></a></span><span>              </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682972669"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972669"><span class="hs-identifier hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-926"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM () -&gt; LintM ()
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972662"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintTyKind"><span class="hs-identifier hs-var">lintTyKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972669"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972666"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-927"></span><span>                </span><span class="hs-comment">-- Now extend the substitution so we</span><span>
</span><span id="line-928"></span><span>                </span><span class="hs-comment">-- take advantage of it in the body</span><span>
</span><span id="line-929"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var
-&gt; LintedType
-&gt; LintM (LintedType, UsageEnv)
-&gt; LintM (LintedType, UsageEnv)
forall a. Var -&gt; LintedType -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#extendTvSubstL"><span class="hs-identifier hs-var">extendTvSubstL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972662"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972666"><span class="hs-identifier hs-var">ty'</span></a></span><span>        </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-930"></span><span>          </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#BodyOfLet"><span class="hs-identifier hs-var">BodyOfLet</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972662"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-931"></span><span>          </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972664"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span id="local-6989586621682972673"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972673"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682972674"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972674"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972675"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972675"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isId"><span class="hs-identifier hs-var">isId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972673"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-935"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- First Lint the RHS, before bringing the binder into scope</span><span>
</span><span id="line-936"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621682972677"><span class="annot"><a href="#local-6989586621682972677"><span class="hs-identifier hs-var">rhs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972678"><span class="annot"><a href="#local-6989586621682972678"><span class="hs-identifier hs-var">let_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintRhs"><span class="hs-identifier hs-var">lintRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972673"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972674"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span>          </span><span class="hs-comment">-- See Note [Multiplicity of let binders] in Var</span><span>
</span><span id="line-939"></span><span>         </span><span class="hs-comment">-- Now lint the binder</span><span>
</span><span id="line-940"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-type">lintBinder</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-type">LetBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972673"><span class="hs-identifier hs-type">bndr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682972681"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972681"><span class="hs-identifier hs-var">bndr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-941"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
-&gt; RecFlag -&gt; Var -&gt; CoreExpr -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintLetBind"><span class="hs-identifier hs-var">lintLetBind</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">RecFlag
</span><a href="GHC.Types.Basic.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972681"><span class="hs-identifier hs-var">bndr'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972674"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972677"><span class="hs-identifier hs-var">rhs_ty</span></a></span><span>
</span><span id="line-942"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Var
-&gt; UsageEnv
-&gt; LintM (LintedType, UsageEnv)
-&gt; LintM (LintedType, UsageEnv)
forall a. Var -&gt; UsageEnv -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addAliasUE"><span class="hs-identifier hs-var">addAliasUE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972673"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972678"><span class="hs-identifier hs-var">let_ue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintLocInfo -&gt; [Var] -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLetBody"><span class="hs-identifier hs-var">lintLetBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#BodyOfLet"><span class="hs-identifier hs-var">BodyOfLet</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972681"><span class="hs-identifier hs-var">bndr'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972681"><span class="hs-identifier hs-var">bndr'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972675"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM (LintedType, UsageEnv)
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkLetErr"><span class="hs-identifier hs-var">mkLetErr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972673"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972674"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- Not quite accurate</span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span id="local-6989586621682972685"><span class="annot"><span class="annottext">e :: CoreExpr
</span><a href="#local-6989586621682972685"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span id="local-6989586621682972687"><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972687"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972688"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972688"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Check that the list of pairs is non-empty</span><span>
</span><span id="line-949"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, CoreExpr)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972687"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#emptyRec"><span class="hs-identifier hs-var">emptyRec</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972685"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span>          </span><span class="hs-comment">-- Check that there are no duplicated binders</span><span>
</span><span id="line-952"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972690"><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972690"><span class="hs-identifier hs-var hs-var">dups</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Var -&gt; Ordering) -&gt; [Var] -&gt; ([Var], [NonEmpty Var])
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; ([a], [NonEmpty a])
</span><a href="GHC.Data.List.SetOps.html#removeDups"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972691"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-953"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972690"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NonEmpty Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#dupVars"><span class="hs-identifier hs-var">dupVars</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682972690"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span>          </span><span class="hs-comment">-- Check that either all the binders are joins, or none</span><span>
</span><span id="line-956"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-var">isJoinId</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972691"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Var -&gt; Bool) -&gt; Var -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-var">isJoinId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972691"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-957"></span><span>          </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkInconsistentRecMsg"><span class="hs-identifier hs-var">mkInconsistentRecMsg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972691"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>          </span><span class="hs-comment">-- See Note [Multiplicity of let binders] in Var</span><span>
</span><span id="line-960"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682972695"><span class="annot"><a href="#local-6989586621682972695"><span class="hs-identifier hs-var">body_type</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972696"><span class="annot"><a href="#local-6989586621682972696"><span class="hs-identifier hs-var">body_ue</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972697"><span class="annot"><a href="#local-6989586621682972697"><span class="hs-identifier hs-var">ues</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-961"></span><span>            </span><span class="annot"><span class="annottext">TopLevelFlag
-&gt; [(Var, CoreExpr)]
-&gt; ([Var] -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM ((LintedType, UsageEnv), [UsageEnv])
forall a.
TopLevelFlag
-&gt; [(Var, CoreExpr)] -&gt; ([Var] -&gt; LintM a) -&gt; LintM (a, [UsageEnv])
</span><a href="GHC.Core.Lint.html#lintRecBindings"><span class="hs-identifier hs-var">lintRecBindings</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972687"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM (LintedType, UsageEnv))
 -&gt; LintM ((LintedType, UsageEnv), [UsageEnv]))
-&gt; ([Var] -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM ((LintedType, UsageEnv), [UsageEnv])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682972698"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972698"><span class="hs-identifier hs-var">bndrs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-962"></span><span>            </span><span class="annot"><span class="annottext">LintLocInfo -&gt; [Var] -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLetBody"><span class="hs-identifier hs-var">lintLetBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972698"><span class="hs-identifier hs-var">bndrs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972698"><span class="hs-identifier hs-var">bndrs'</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972688"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-963"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972695"><span class="hs-identifier hs-type">body_type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972696"><span class="hs-identifier hs-type">body_ue</span></a></span><span>  </span><span class="annot"><a href="GHC.Core.UsageEnv.html#addUE"><span class="hs-operator hs-type">`addUE`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#scaleUE"><span class="hs-identifier hs-type">scaleUE</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-type">ManyTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">foldr1</span></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#addUE"><span class="hs-identifier hs-type">addUE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972697"><span class="hs-identifier hs-type">ues</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-965"></span><span>    </span><span id="local-6989586621682972691"><span class="annot"><span class="annottext">bndrs :: [Var]
</span><a href="#local-6989586621682972691"><span class="hs-identifier hs-var hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, CoreExpr) -&gt; Var) -&gt; [(Var, CoreExpr)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Var, CoreExpr) -&gt; Var
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682972687"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span id="local-6989586621682972704"><span class="annot"><span class="annottext">e :: CoreExpr
</span><a href="#local-6989586621682972704"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682972706"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972706"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972707"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972706"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#runRWKey"><span class="hs-identifier hs-var">runRWKey</span></a></span><span>
</span><span id="line-970"></span><span>    </span><span class="hs-comment">-- N.B. we may have an over-saturated application of the form:</span><span>
</span><span id="line-971"></span><span>    </span><span class="hs-comment">--   runRW (\s -&gt; \x -&gt; ...) y</span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972710"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972710"><span class="hs-identifier hs-var">ty_arg1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682972711"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972711"><span class="hs-identifier hs-var">ty_arg2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682972712"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972712"><span class="hs-identifier hs-var">arg3</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682972713"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972713"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972714"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972715"><span class="annot"><a href="#local-6989586621682972715"><span class="hs-identifier hs-var">fun_pair1</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv) -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972706"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972710"><span class="hs-identifier hs-var">ty_arg1</span></a></span><span>
</span><span id="line-974"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972717"><span class="annot"><a href="#local-6989586621682972717"><span class="hs-identifier hs-var">fun_ty2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972718"><span class="annot"><a href="#local-6989586621682972718"><span class="hs-identifier hs-var">ue2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-type">lintCoreArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972715"><span class="hs-identifier hs-type">fun_pair1</span></a></span><span>            </span><span class="annot"><a href="#local-6989586621682972711"><span class="hs-identifier hs-type">ty_arg2</span></a></span><span>
</span><span id="line-975"></span><span>         </span><span class="hs-comment">-- See Note [Linting of runRW#]</span><span>
</span><span id="line-976"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682972719"><span class="hs-identifier hs-type">lintRunRWCont</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>             </span><span id="local-6989586621682972719"><span class="annot"><a href="#local-6989586621682972719"><span class="hs-identifier hs-var hs-var">lintRunRWCont</span></a></span></span><span> </span><span id="local-6989586621682972721"><span class="annot"><span class="annottext">expr :: CoreExpr
</span><a href="#local-6989586621682972721"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-978"></span><span>                </span><span class="annot"><span class="annottext">JoinArity -&gt; Maybe Var -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintJoinLams"><span class="hs-identifier hs-var">lintJoinLams</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972706"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972721"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-979"></span><span>             </span><span class="annot"><a href="#local-6989586621682972719"><span class="hs-identifier hs-var">lintRunRWCont</span></a></span><span> </span><span id="local-6989586621682972722"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972722"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972722"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-980"></span><span>             </span><span class="hs-comment">-- TODO: Look through ticks?</span><span>
</span><span id="line-981"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972723"><span class="annot"><a href="#local-6989586621682972723"><span class="hs-identifier hs-var">arg3_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972724"><span class="annot"><a href="#local-6989586621682972724"><span class="hs-identifier hs-var">ue3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682972719"><span class="hs-identifier hs-type">lintRunRWCont</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972712"><span class="hs-identifier hs-type">arg3</span></a></span><span>
</span><span id="line-982"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972725"><span class="annot"><a href="#local-6989586621682972725"><span class="hs-identifier hs-var">app_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintValApp"><span class="hs-identifier hs-type">lintValApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972712"><span class="hs-identifier hs-type">arg3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972717"><span class="hs-identifier hs-type">fun_ty2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972723"><span class="hs-identifier hs-type">arg3_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972718"><span class="hs-identifier hs-type">ue2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972724"><span class="hs-identifier hs-type">ue3</span></a></span><span>
</span><span id="line-983"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-type">lintCoreArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972725"><span class="hs-identifier hs-type">app_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972713"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-984"></span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972727"><span class="annot"><a href="#local-6989586621682972727"><span class="hs-identifier hs-var">fun_pair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-var">lintCoreFun</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972707"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; JoinArity
forall a. [a] -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972714"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972730"><span class="annot"><a href="#local-6989586621682972730"><span class="hs-identifier hs-var">app_pair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682972731"><span class="annot"><a href="#local-6989586621682972731"><span class="hs-identifier hs-var">app_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-type">lintCoreArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972727"><span class="hs-identifier hs-type">fun_pair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972714"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span>       </span><span class="hs-comment">-- See Note [Linting representation-polymorphic builtins]</span><span>
</span><span id="line-990"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltin"><span class="hs-identifier hs-type">checkRepPolyBuiltin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972707"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972714"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972731"><span class="hs-identifier hs-type">app_ty</span></a></span><span>
</span><span id="line-991"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-comment">--checkDataToTagPrimOpTyCon fun args</span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682972730"><span class="hs-identifier hs-type">app_pair</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-994"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-995"></span><span>    </span><span id="local-6989586621682972732"><span class="annot"><span class="annottext">skipTick :: CoreTickish -&gt; Bool
</span><a href="#local-6989586621682972732"><span class="hs-identifier hs-var hs-var">skipTick</span></a></span></span><span> </span><span id="local-6989586621682972733"><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972733"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b
</span><a href="GHC.Core.html#collectFunSimple"><span class="hs-identifier hs-var">collectFunSimple</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972704"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-996"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682972735"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972735"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreTickish -&gt; Bool
forall (pass :: TickishPass). Var -&gt; GenTickish pass -&gt; Bool
</span><a href="GHC.Core.Utils.html#etaExpansionTick"><span class="hs-identifier hs-var">etaExpansionTick</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972735"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972733"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-997"></span><span>      </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
forall (pass :: TickishPass). GenTickish pass -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishFloatable"><span class="hs-identifier hs-var">tickishFloatable</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682972733"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-998"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682972707"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972707"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972714"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972714"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972738"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682972738"><span class="hs-identifier hs-var">_source_ticks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreTickish -&gt; Bool)
-&gt; CoreExpr -&gt; (CoreExpr, [CoreExpr], [CoreTickish])
forall b.
(CoreTickish -&gt; Bool)
-&gt; Expr b -&gt; (Expr b, [Expr b], [CoreTickish])
</span><a href="GHC.Core.html#collectArgsTicks"><span class="hs-identifier hs-var">collectArgsTicks</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
</span><a href="#local-6989586621682972732"><span class="hs-identifier hs-var">skipTick</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972704"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-999"></span><span>      </span><span class="hs-comment">-- We must look through source ticks to avoid #21152, for example:</span><span>
</span><span id="line-1000"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1001"></span><span>      </span><span class="hs-comment">-- reallyUnsafePtrEquality</span><span>
</span><span id="line-1002"></span><span>      </span><span class="hs-comment">--   = \ @a -&gt;</span><span>
</span><span id="line-1003"></span><span>      </span><span class="hs-comment">--       (src&lt;loc&gt; reallyUnsafePtrEquality#)</span><span>
</span><span id="line-1004"></span><span>      </span><span class="hs-comment">--         @Lifted @a @Lifted @a</span><span>
</span><span id="line-1005"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1006"></span><span>      </span><span class="hs-comment">-- To do this, we use `collectArgsTicks tickishFloatable` to match</span><span>
</span><span id="line-1007"></span><span>      </span><span class="hs-comment">-- the eta expansion behaviour, as per Note [Eta expansion and source notes]</span><span>
</span><span id="line-1008"></span><span>      </span><span class="hs-comment">-- in GHC.Core.Opt.Arity.</span><span>
</span><span id="line-1009"></span><span>      </span><span class="hs-comment">-- Sadly this was not quite enough. So we now also accept things that CorePrep will allow.</span><span>
</span><span id="line-1010"></span><span>      </span><span class="hs-comment">-- See Note [Ticks and mandatory eta expansion]</span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621682972740"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972740"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972741"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972741"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1014"></span><span>    </span><span class="annot"><span class="annottext">Var -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-var">lintLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972740"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972741"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span id="local-6989586621682972743"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972743"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621682972744"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972744"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972745"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972745"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span id="local-6989586621682972746"><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682972746"><span class="hs-identifier hs-var">alts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr
-&gt; Var -&gt; LintedType -&gt; [Alt Var] -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCaseExpr"><span class="hs-identifier hs-var">lintCaseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972743"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972744"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972745"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682972746"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1018"></span><span>
</span><span id="line-1019"></span><span class="hs-comment">-- This case can't happen; linting types in expressions gets routed through</span><span>
</span><span id="line-1020"></span><span class="hs-comment">-- lintCoreArgs</span><span>
</span><span id="line-1021"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682972748"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972748"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM (LintedType, UsageEnv)
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type found as expression&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972748"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span id="local-6989586621682972750"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972750"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1025"></span><span>  </span><span class="hs-comment">-- See Note [Coercions in terms]</span><span>
</span><span id="line-1026"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972751"><span class="annot"><a href="#local-6989586621682972751"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM Coercion -&gt; LintM Coercion
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#InCo"><span class="hs-identifier hs-var">InCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972750"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM Coercion -&gt; LintM Coercion)
-&gt; LintM Coercion -&gt; LintM Coercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1027"></span><span>                </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972750"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1028"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-type">coercionType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972751"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-type">zeroUE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span class="hs-comment">----------------------</span><span>
</span><span id="line-1031"></span><span class="annot"><a href="GHC.Core.Lint.html#lintIdOcc"><span class="hs-identifier hs-type">lintIdOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Number of arguments (type or value) being passed</span><span>
</span><span id="line-1032"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- returns type of the *variable*</span><span>
</span><span id="line-1033"></span><span id="lintIdOcc"><span class="annot"><span class="annottext">lintIdOcc :: Var -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintIdOcc"><span class="hs-identifier hs-var hs-var">lintIdOcc</span></a></span></span><span> </span><span id="local-6989586621682972754"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972755"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972755"><span class="hs-identifier hs-var">nargs</span></a></span></span><span>
</span><span id="line-1034"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#OccOf"><span class="hs-identifier hs-var">OccOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1035"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isNonCoVarId"><span class="hs-identifier hs-var">isNonCoVarId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non term variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>                 </span><span class="hs-comment">-- See GHC.Core Note [Variable occurrences in Core]</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span>        </span><span class="hs-comment">-- Check that the type of the occurrence is the same</span><span>
</span><span id="line-1040"></span><span>        </span><span class="hs-comment">-- as the type of the binding site.  The inScopeIds are</span><span>
</span><span id="line-1041"></span><span>        </span><span class="hs-comment">-- /un-substituted/, so this checks that the occurrence type</span><span>
</span><span id="line-1042"></span><span>        </span><span class="hs-comment">-- is identical to the binder type.</span><span>
</span><span id="line-1043"></span><span>        </span><span class="hs-comment">-- This makes things much easier for things like:</span><span>
</span><span id="line-1044"></span><span>        </span><span class="hs-comment">--    /\a. \(x::Maybe a). /\a. ...(x::Maybe a)...</span><span>
</span><span id="line-1045"></span><span>        </span><span class="hs-comment">-- The &quot;::Maybe a&quot; on the occurrence is referring to the /outer/ a.</span><span>
</span><span id="line-1046"></span><span>        </span><span class="hs-comment">-- If we compared /substituted/ types we'd risk comparing</span><span>
</span><span id="line-1047"></span><span>        </span><span class="hs-comment">-- (Maybe a) from the binding site with bogus (Maybe a1) from</span><span>
</span><span id="line-1048"></span><span>        </span><span class="hs-comment">-- the occurrence site.  Comparing un-substituted types finesses</span><span>
</span><span id="line-1049"></span><span>        </span><span class="hs-comment">-- this altogether</span><span>
</span><span id="line-1050"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972758"><span class="annot"><a href="#local-6989586621682972758"><span class="hs-identifier hs-var">bndr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972759"><span class="annot"><a href="#local-6989586621682972759"><span class="hs-identifier hs-var">linted_bndr_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM (Var, LintedType)
</span><a href="GHC.Core.Lint.html#lookupIdInScope"><span class="hs-identifier hs-var">lookupIdInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1051"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972760"><span class="annot"><a href="#local-6989586621682972760"><span class="hs-identifier hs-var hs-var">occ_ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972754"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1052"></span><span>              </span><span id="local-6989586621682972761"><span class="annot"><a href="#local-6989586621682972761"><span class="hs-identifier hs-var hs-var">bndr_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972758"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1053"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972760"><span class="hs-identifier hs-type">occ_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972761"><span class="hs-identifier hs-type">bndr_ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1054"></span><span>          </span><span class="annot"><a href="GHC.Core.Lint.html#mkBndrOccTypeMismatchMsg"><span class="hs-identifier hs-type">mkBndrOccTypeMismatchMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972758"><span class="hs-identifier hs-type">bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972761"><span class="hs-identifier hs-type">bndr_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972760"><span class="hs-identifier hs-type">occ_ty</span></a></span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span>          </span><span class="hs-comment">-- Check for a nested occurrence of the StaticPtr constructor.</span><span>
</span><span id="line-1057"></span><span>          </span><span class="hs-comment">-- See Note [Checking StaticPtrs].</span><span>
</span><span id="line-1058"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972763"><span class="annot"><a href="#local-6989586621682972763"><span class="hs-identifier hs-var">lf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-type">getLintFlags</span></a></span><span>
</span><span id="line-1059"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972755"><span class="hs-identifier hs-type">nargs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_static_ptrs"><span class="hs-identifier hs-var">lf_check_static_ptrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972763"><span class="hs-identifier hs-type">lf</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#AllowAnywhere"><span class="hs-identifier hs-type">AllowAnywhere</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1060"></span><span>            </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-type">idName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#makeStaticName"><span class="hs-identifier hs-type">makeStaticName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1061"></span><span>              </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Found makeStatic nested in an expression&quot;</span></span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkDeadIdOcc"><span class="hs-identifier hs-type">checkDeadIdOcc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span>
</span><span id="line-1064"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkJoinOcc"><span class="hs-identifier hs-type">checkJoinOcc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972755"><span class="hs-identifier hs-type">nargs</span></a></span><span>
</span><span id="line-1065"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#isDataConId_maybe"><span class="hs-identifier hs-type">isDataConId_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1066"></span><span>             </span><span class="annot"><span class="annottext">Maybe DataCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972770"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972770"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; DataCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTypeDataConOcc"><span class="hs-identifier hs-var">checkTypeDataConOcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expression&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972770"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972772"><span class="annot"><a href="#local-6989586621682972772"><span class="hs-identifier hs-var">usage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#varCallSiteUsage"><span class="hs-identifier hs-type">varCallSiteUsage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972754"><span class="hs-identifier hs-type">var</span></a></span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972759"><span class="hs-identifier hs-type">linted_bndr_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972772"><span class="hs-identifier hs-type">usage</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1072"></span><span>
</span><span id="line-1073"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-type">lintCoreFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1074"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                          </span><span class="hs-comment">-- Number of arguments (type or val) being passed</span><span>
</span><span id="line-1075"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Returns type of the *function*</span><span>
</span><span id="line-1076"></span><span id="lintCoreFun"><span class="annot"><span class="annottext">lintCoreFun :: CoreExpr -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-var hs-var">lintCoreFun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682972774"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972774"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972775"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972775"><span class="hs-identifier hs-var">nargs</span></a></span></span><span>
</span><span id="line-1077"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintIdOcc"><span class="hs-identifier hs-var">lintIdOcc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972774"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972775"><span class="hs-identifier hs-var">nargs</span></a></span><span>
</span><span id="line-1078"></span><span>
</span><span id="line-1079"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-var">lintCoreFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621682972776"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972776"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972777"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972777"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972778"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972778"><span class="hs-identifier hs-var">nargs</span></a></span></span><span>
</span><span id="line-1080"></span><span>  </span><span class="hs-comment">-- Act like lintCoreExpr of Lam, but *don't* call markAllJoinsBad;</span><span>
</span><span id="line-1081"></span><span>  </span><span class="hs-comment">-- See Note [Beta redexes]</span><span>
</span><span id="line-1082"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972778"><span class="hs-identifier hs-var">nargs</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1083"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-var">lintLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972776"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; JoinArity -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-var">lintCoreFun</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972777"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972778"><span class="hs-identifier hs-var">nargs</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreFun"><span class="hs-identifier hs-var">lintCoreFun</span></a></span><span> </span><span id="local-6989586621682972779"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972779"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682972780"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972780"><span class="hs-identifier hs-var">nargs</span></a></span></span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. Bool -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBadIf"><span class="hs-identifier hs-var">markAllJoinsBadIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972780"><span class="hs-identifier hs-var">nargs</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1087"></span><span>      </span><span class="hs-comment">-- See Note [Join points are less general than the paper]</span><span>
</span><span id="line-1088"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972779"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1089"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-1090"></span><span class="annot"><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-type">lintLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span id="lintLambda"><span class="annot"><span class="annottext">lintLambda :: Var -&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintLambda"><span class="hs-identifier hs-var hs-var">lintLambda</span></a></span></span><span> </span><span id="local-6989586621682972781"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972781"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972782"><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972782"><span class="hs-identifier hs-var">lintBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1092"></span><span>    </span><span class="annot"><span class="annottext">LintLocInfo
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#LambdaBodyOf"><span class="hs-identifier hs-var">LambdaBodyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972781"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1093"></span><span>    </span><span class="annot"><span class="annottext">BindingSite
-&gt; Var
-&gt; (Var -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv)
forall a. BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-var">lintBinder</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LambdaBind"><span class="hs-identifier hs-var">LambdaBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972781"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">((Var -&gt; LintM (LintedType, UsageEnv))
 -&gt; LintM (LintedType, UsageEnv))
-&gt; (Var -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682972785"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972785"><span class="hs-identifier hs-var">var'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1094"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972786"><span class="annot"><a href="#local-6989586621682972786"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972787"><span class="annot"><a href="#local-6989586621682972787"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv)
</span><a href="#local-6989586621682972782"><span class="hs-identifier hs-var">lintBody</span></a></span><span>
</span><span id="line-1095"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972788"><span class="annot"><a href="#local-6989586621682972788"><span class="hs-identifier hs-var">ue'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkLinearity"><span class="hs-identifier hs-type">checkLinearity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972787"><span class="hs-identifier hs-type">ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972785"><span class="hs-identifier hs-type">var'</span></a></span><span>
</span><span id="line-1096"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Utils.html#mkLamType"><span class="hs-identifier hs-type">mkLamType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972785"><span class="hs-identifier hs-type">var'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972786"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972788"><span class="hs-identifier hs-type">ue'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1097"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-1098"></span><span class="annot"><a href="GHC.Core.Lint.html#checkDeadIdOcc"><span class="hs-identifier hs-type">checkDeadIdOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- Occurrences of an Id should never be dead....</span><span>
</span><span id="line-1100"></span><span class="hs-comment">-- except when we are checking a case pattern</span><span>
</span><span id="line-1101"></span><span id="checkDeadIdOcc"><span class="annot"><span class="annottext">checkDeadIdOcc :: Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkDeadIdOcc"><span class="hs-identifier hs-var hs-var">checkDeadIdOcc</span></a></span></span><span> </span><span id="local-6989586621682972791"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972791"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OccInfo -&gt; Bool
</span><a href="GHC.Types.Basic.html#isDeadOcc"><span class="hs-identifier hs-var">isDeadOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; OccInfo
</span><a href="GHC.Types.Id.html#idOccInfo"><span class="hs-identifier hs-var">idOccInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972791"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972793"><span class="annot"><a href="#local-6989586621682972793"><span class="hs-identifier hs-var">in_case</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Bool
</span><a href="GHC.Core.Lint.html#inCasePat"><span class="hs-identifier hs-var">inCasePat</span></a></span><span>
</span><span id="line-1104"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972793"><span class="hs-identifier hs-type">in_case</span></a></span><span>
</span><span id="line-1105"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Occurrence of a dead Id&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972791"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1107"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span class="hs-comment">------------------</span><span>
</span><span id="line-1110"></span><span class="annot"><a href="GHC.Core.Lint.html#lintJoinBndrType"><span class="hs-identifier hs-type">lintJoinBndrType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-comment">-- Type of the body</span><span>
</span><span id="line-1111"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-type">LintedId</span></a></span><span>   </span><span class="hs-comment">-- Possibly a join Id</span><span>
</span><span id="line-1112"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1113"></span><span class="hs-comment">-- Checks that the return type of a join Id matches the body</span><span>
</span><span id="line-1114"></span><span class="hs-comment">-- E.g. join j x = rhs in body</span><span>
</span><span id="line-1115"></span><span class="hs-comment">--      The type of 'rhs' must be the same as the type of 'body'</span><span>
</span><span id="line-1116"></span><span id="lintJoinBndrType"><span class="annot"><span class="annottext">lintJoinBndrType :: LintedType -&gt; Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintJoinBndrType"><span class="hs-identifier hs-var hs-var">lintJoinBndrType</span></a></span></span><span> </span><span id="local-6989586621682972795"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972795"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span> </span><span id="local-6989586621682972796"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972796"><span class="hs-identifier hs-var">bndr</span></a></span></span><span>
</span><span id="line-1117"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682972797"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972797"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinPointHood
</span><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-var">idJoinPointHood</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972796"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972798"><span class="annot"><span class="annottext">bndr_ty :: LintedType
</span><a href="#local-6989586621682972798"><span class="hs-identifier hs-var hs-var">bndr_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972796"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972799"><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682972799"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972800"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972800"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; ([PiTyBinder], LintedType)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972798"><span class="hs-identifier hs-var">bndr_ty</span></a></span><span>
</span><span id="line-1120"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; JoinArity
forall a. [a] -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682972799"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972797"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1121"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972795"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder] -&gt; LintedType -&gt; LintedType
HasDebugCallStack =&gt; [PiTyBinder] -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#mkPiTys"><span class="hs-identifier hs-var">mkPiTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity -&gt; [PiTyBinder] -&gt; [PiTyBinder]
forall a. JoinArity -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972797"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">[PiTyBinder]
</span><a href="#local-6989586621682972799"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972800"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join point returns different type than body&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>       </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join bndr:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972796"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972796"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1124"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join arity:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972797"><span class="hs-identifier hs-var">arity</span></a></span><span>
</span><span id="line-1125"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972795"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1127"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span class="annot"><a href="GHC.Core.Lint.html#checkJoinOcc"><span class="hs-identifier hs-type">checkJoinOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- Check that if the occurrence is a JoinId, then so is the</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- binding site, and it's a valid join Id</span><span>
</span><span id="line-1132"></span><span id="checkJoinOcc"><span class="annot"><span class="annottext">checkJoinOcc :: Var -&gt; JoinArity -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkJoinOcc"><span class="hs-identifier hs-var hs-var">checkJoinOcc</span></a></span></span><span> </span><span id="local-6989586621682972806"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972806"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682972807"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972807"><span class="hs-identifier hs-var">n_args</span></a></span></span><span>
</span><span id="line-1133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682972808"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972808"><span class="hs-identifier hs-var">join_arity_occ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; JoinPointHood
</span><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-var">idJoinPointHood</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972806"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1134"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972809"><span class="annot"><a href="#local-6989586621682972809"><span class="hs-identifier hs-var">mb_join_arity_bndr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM JoinPointHood
</span><a href="GHC.Core.Lint.html#lookupJoinId"><span class="hs-identifier hs-var">lookupJoinId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972806"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1135"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682972809"><span class="hs-identifier hs-type">mb_join_arity_bndr</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-1136"></span><span>           </span><span class="annot"><span class="annottext">JoinPointHood
</span><a href="GHC.Utils.Outputable.html#NotJoinPoint"><span class="hs-identifier hs-var">NotJoinPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972811"><span class="annot"><a href="#local-6989586621682972811"><span class="hs-identifier hs-var">join_set</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM IdSet
</span><a href="GHC.Core.Lint.html#getValidJoins"><span class="hs-identifier hs-var">getValidJoins</span></a></span><span>
</span><span id="line-1137"></span><span>                              </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-type">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;join set &quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972811"><span class="hs-identifier hs-type">join_set</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span>
</span><span id="line-1138"></span><span>                                </span><span class="annot"><a href="GHC.Core.Lint.html#invalidJoinOcc"><span class="hs-identifier hs-type">invalidJoinOcc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972806"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span>           </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682972815"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972815"><span class="hs-identifier hs-var">join_arity_bndr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1141"></span><span>
</span><span id="line-1142"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972815"><span class="hs-identifier hs-var">join_arity_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972808"><span class="hs-identifier hs-var">join_arity_occ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1143"></span><span>           </span><span class="hs-comment">-- Arity differs at binding site and occurrence</span><span>
</span><span id="line-1144"></span><span>         </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; JoinArity -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkJoinBndrOccMismatchMsg"><span class="hs-identifier hs-var">mkJoinBndrOccMismatchMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972806"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972815"><span class="hs-identifier hs-var">join_arity_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972808"><span class="hs-identifier hs-var">join_arity_occ</span></a></span><span>
</span><span id="line-1145"></span><span>
</span><span id="line-1146"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972807"><span class="hs-identifier hs-var">n_args</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972808"><span class="hs-identifier hs-var">join_arity_occ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1147"></span><span>           </span><span class="hs-comment">-- Arity doesn't match #args</span><span>
</span><span id="line-1148"></span><span>         </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; JoinArity -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJumpMsg"><span class="hs-identifier hs-var">mkBadJumpMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972806"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972808"><span class="hs-identifier hs-var">join_arity_occ</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972807"><span class="hs-identifier hs-var">n_args</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1151"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>
</span><span id="line-1153"></span><span class="annot"><a href="GHC.Core.Lint.html#checkTypeDataConOcc"><span class="hs-identifier hs-type">checkTypeDataConOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- Check that the Id is not a data constructor of a `type data` declaration</span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- Invariant (I1) of Note [Type data declarations] in GHC.Rename.Module</span><span>
</span><span id="line-1156"></span><span id="checkTypeDataConOcc"><span class="annot"><span class="annottext">checkTypeDataConOcc :: String -&gt; DataCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTypeDataConOcc"><span class="hs-identifier hs-var hs-var">checkTypeDataConOcc</span></a></span></span><span> </span><span id="local-6989586621682972818"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972818"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span id="local-6989586621682972819"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972819"><span class="hs-identifier hs-var">dc</span></a></span></span><span>
</span><span id="line-1157"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeDataTyCon"><span class="hs-identifier hs-var">isTypeDataTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972819"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1158"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type data constructor found in a&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682972818"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972819"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span>
</span><span id="line-1160"></span><span class="hs-comment">{-
-- | Check that a use of a dataToTag# primop satisfies conditions DTT2
-- and DTT3 from Note [DataToTag overview] in GHC.Tc.Instance.Class
--
-- Ignores applications not headed by dataToTag# primops.

-- Commented out because GHC.PrimopWrappers doesn't respect this condition yet.
-- See wrinkle DTW7 in Note [DataToTag overview].
checkDataToTagPrimOpTyCon
  :: CoreExpr   -- ^ the function (head of the application) we are checking
  -&gt; [CoreArg]  -- ^ The arguments to the application
  -&gt; LintM ()
checkDataToTagPrimOpTyCon (Var fun_id) args
  | Just op &lt;- isPrimOpId_maybe fun_id
  , op == DataToTagSmallOp || op == DataToTagLargeOp
  = case args of
      Type _levity : Type dty : _rest
        | Just (tc, _) &lt;- splitTyConApp_maybe dty
        , isValidDTT2TyCon tc
          -&gt; do  platform &lt;- getPlatform
                 let  numConstrs = tyConFamilySize tc
                      isSmallOp = op == DataToTagSmallOp
                 checkL (isSmallFamily platform numConstrs == isSmallOp) $
                   text &quot;dataToTag# primop-size/tycon-family-size mismatch&quot;
        | otherwise -&gt; failWithL $ text &quot;dataToTagLarge# used at non-ADT type:&quot;
                                   &lt;+&gt; ppr dty
      _ -&gt; failWithL $ text &quot;dataToTagLarge# needs two type arguments but has args:&quot;
                       &lt;+&gt; ppr (take 2 args)

checkDataToTagPrimOpTyCon _ _ = pure ()
-}</span><span>
</span><span id="line-1191"></span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- | Check representation-polymorphic invariants in an application of a</span><span>
</span><span id="line-1193"></span><span class="hs-comment">-- built-in function or newtype constructor.</span><span>
</span><span id="line-1194"></span><span class="hs-comment">--</span><span>
</span><span id="line-1195"></span><span class="hs-comment">-- See Note [Linting representation-polymorphic builtins].</span><span>
</span><span id="line-1196"></span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltin"><span class="hs-identifier hs-type">checkRepPolyBuiltin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the function (head of the application) we are checking</span></span><span>
</span><span id="line-1197"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the arguments to the application</span></span><span>
</span><span id="line-1198"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the instantiated type of the overall application</span></span><span>
</span><span id="line-1199"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1200"></span><span id="checkRepPolyBuiltin"><span class="annot"><span class="annottext">checkRepPolyBuiltin :: CoreExpr -&gt; [CoreExpr] -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkRepPolyBuiltin"><span class="hs-identifier hs-var hs-var">checkRepPolyBuiltin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682972822"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972822"><span class="hs-identifier hs-var">fun_id</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972823"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972823"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682972824"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972824"><span class="hs-identifier hs-var">app_ty</span></a></span></span><span>
</span><span id="line-1201"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972825"><span class="annot"><a href="#local-6989586621682972825"><span class="hs-identifier hs-var">do_rep_poly_checks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_fixed_rep"><span class="hs-identifier hs-var">lf_check_fixed_rep</span></a></span><span> </span><span class="annot"><span class="annottext">(LintFlags -&gt; Bool) -&gt; LintM LintFlags -&gt; LintM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-1202"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972825"><span class="hs-identifier hs-type">do_rep_poly_checks</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Types.Id.html#hasNoBinding"><span class="hs-identifier hs-type">hasNoBinding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972822"><span class="hs-identifier hs-type">fun_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1203"></span><span>           </span><span class="hs-keyword">if</span><span>
</span><span id="line-1204"></span><span>             </span><span class="hs-comment">-- (2) representation-polymorphic unlifted newtypes</span><span>
</span><span id="line-1205"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972828"><span class="annot"><a href="#local-6989586621682972828"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#isDataConId_maybe"><span class="hs-identifier hs-type">isDataConId_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972822"><span class="hs-identifier hs-type">fun_id</span></a></span><span>
</span><span id="line-1206"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#isNewDataCon"><span class="hs-identifier hs-type">isNewDataCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972828"><span class="hs-identifier hs-type">dc</span></a></span><span>
</span><span id="line-1207"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tcHasFixedRuntimeRep"><span class="hs-identifier hs-type">tcHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-type">dataConTyCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972828"><span class="hs-identifier hs-type">dc</span></a></span><span>
</span><span id="line-1208"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyNewtypeApp"><span class="hs-identifier hs-type">checkRepPolyNewtypeApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972828"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972823"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972824"><span class="hs-identifier hs-type">app_ty</span></a></span><span>
</span><span id="line-1210"></span><span>
</span><span id="line-1211"></span><span>             </span><span class="hs-comment">-- (1) representation-polymorphic builtins</span><span>
</span><span id="line-1212"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>
</span><span id="line-1213"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltinApp"><span class="hs-identifier hs-type">checkRepPolyBuiltinApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972822"><span class="hs-identifier hs-type">fun_id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972823"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-1214"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1215"></span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltin"><span class="hs-identifier hs-var">checkRepPolyBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyNewtypeApp"><span class="hs-identifier hs-type">checkRepPolyNewtypeApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span id="checkRepPolyNewtypeApp"><span class="annot"><span class="annottext">checkRepPolyNewtypeApp :: DataCon -&gt; [CoreExpr] -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkRepPolyNewtypeApp"><span class="hs-identifier hs-var hs-var">checkRepPolyNewtypeApp</span></a></span></span><span> </span><span id="local-6989586621682972833"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972833"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621682972834"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972834"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682972835"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972835"><span class="hs-identifier hs-var">app_ty</span></a></span></span><span>
</span><span id="line-1219"></span><span>  </span><span class="hs-comment">-- If the newtype is saturated, we're OK.</span><span>
</span><span id="line-1220"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
forall b. Expr b -&gt; Bool
</span><a href="GHC.Core.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972834"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1221"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1222"></span><span>  </span><span class="hs-comment">-- Otherwise, check we can eta-expand.</span><span>
</span><span id="line-1223"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1224"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; [(Scaled LintedType, FunTyFlag)]
</span><a href="GHC.Core.Type.html#getRuntimeArgTys"><span class="hs-identifier hs-var">getRuntimeArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972835"><span class="hs-identifier hs-var">app_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1225"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682972840"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972840"><span class="hs-identifier hs-var">first_val_arg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Scaled LintedType, FunTyFlag)]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-1226"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; Bool
LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-var">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972840"><span class="hs-identifier hs-var">first_val_arg_ty</span></a></span><span>
</span><span id="line-1227"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
</span><a href="#local-6989586621682972842"><span class="hs-identifier hs-var">err_msg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972840"><span class="hs-identifier hs-var">first_val_arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>      </span><span class="annot"><span class="annottext">[(Scaled LintedType, FunTyFlag)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1231"></span><span>
</span><span id="line-1232"></span><span>      </span><span class="annot"><a href="#local-6989586621682972842"><span class="hs-identifier hs-type">err_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1233"></span><span>      </span><span id="local-6989586621682972842"><span class="annot"><span class="annottext">err_msg :: LintedType -&gt; SDoc
</span><a href="#local-6989586621682972842"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span> </span><span id="local-6989586621682972843"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972843"><span class="hs-identifier hs-var">bad_arg_ty</span></a></span></span><span>
</span><span id="line-1234"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot eta expand unlifted newtype constructor&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682972833"><span class="hs-identifier hs-var">nt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a></span><span>
</span><span id="line-1235"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Its argument type does not have a fixed runtime representation:&quot;</span></span><span>
</span><span id="line-1236"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
</span><a href="#local-6989586621682972845"><span class="hs-identifier hs-var">ppr_ty_ki</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972843"><span class="hs-identifier hs-var">bad_arg_ty</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1237"></span><span>
</span><span id="line-1238"></span><span>      </span><span class="annot"><a href="#local-6989586621682972845"><span class="hs-identifier hs-type">ppr_ty_ki</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1239"></span><span>      </span><span id="local-6989586621682972845"><span class="annot"><span class="annottext">ppr_ty_ki :: LintedType -&gt; SDoc
</span><a href="#local-6989586621682972845"><span class="hs-identifier hs-var hs-var">ppr_ty_ki</span></a></span></span><span> </span><span id="local-6989586621682972846"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972846"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#bullet"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972846"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972846"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1240"></span><span>
</span><span id="line-1241"></span><span class="annot"><a href="GHC.Core.Lint.html#checkRepPolyBuiltinApp"><span class="hs-identifier hs-type">checkRepPolyBuiltinApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span id="checkRepPolyBuiltinApp"><span class="annot"><span class="annottext">checkRepPolyBuiltinApp :: Var -&gt; [CoreExpr] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkRepPolyBuiltinApp"><span class="hs-identifier hs-var hs-var">checkRepPolyBuiltinApp</span></a></span></span><span> </span><span id="local-6989586621682972849"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972849"><span class="hs-identifier hs-var">fun_id</span></a></span></span><span> </span><span id="local-6989586621682972850"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972850"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(SDoc, ConcreteTvOrigin)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(SDoc, ConcreteTvOrigin)]
</span><a href="#local-6989586621682972851"><span class="hs-identifier hs-var">not_concs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972852"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-1243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1244"></span><span>
</span><span id="line-1245"></span><span>    </span><span class="annot"><a href="#local-6989586621682972853"><span class="hs-identifier hs-type">conc_binder_positions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span>
</span><span id="line-1246"></span><span>    </span><span id="local-6989586621682972853"><span class="annot"><span class="annottext">conc_binder_positions :: IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972853"><span class="hs-identifier hs-var hs-var">conc_binder_positions</span></a></span></span><span>
</span><span id="line-1247"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; ConcreteTyVars -&gt; IntMap ConcreteTvOrigin
</span><a href="GHC.Core.Lint.html#concreteTyVarPositions"><span class="hs-identifier hs-var">concreteTyVarPositions</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972849"><span class="hs-identifier hs-var">fun_id</span></a></span><span>
</span><span id="line-1248"></span><span>      </span><span class="annot"><span class="annottext">(ConcreteTyVars -&gt; IntMap ConcreteTvOrigin)
-&gt; ConcreteTyVars -&gt; IntMap ConcreteTvOrigin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; ConcreteTyVars
</span><a href="GHC.Types.Id.Info.html#idDetailsConcreteTvs"><span class="hs-identifier hs-var">idDetailsConcreteTvs</span></a></span><span>
</span><span id="line-1249"></span><span>      </span><span class="annot"><span class="annottext">(IdDetails -&gt; ConcreteTyVars) -&gt; IdDetails -&gt; ConcreteTyVars
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; IdDetails
</span><a href="GHC.Types.Var.html#idDetails"><span class="hs-identifier hs-var">idDetails</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972849"><span class="hs-identifier hs-var">fun_id</span></a></span><span>
</span><span id="line-1250"></span><span>
</span><span id="line-1251"></span><span>    </span><span class="annot"><a href="#local-6989586621682972857"><span class="hs-identifier hs-type">max_pos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1252"></span><span>    </span><span id="local-6989586621682972857"><span class="annot"><span class="annottext">max_pos :: JoinArity
</span><a href="#local-6989586621682972857"><span class="hs-identifier hs-var hs-var">max_pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1253"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin -&gt; [JoinArity]
forall a. IntMap a -&gt; [JoinArity]
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#keys"><span class="hs-identifier hs-var">IntMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972853"><span class="hs-identifier hs-var">conc_binder_positions</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1254"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1255"></span><span>        </span><span id="local-6989586621682972858"><span class="annot"><span class="annottext">[JoinArity]
</span><a href="#local-6989586621682972858"><span class="hs-identifier hs-var">positions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[JoinArity] -&gt; JoinArity
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[JoinArity]
</span><a href="#local-6989586621682972858"><span class="hs-identifier hs-var">positions</span></a></span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span>    </span><span class="annot"><a href="#local-6989586621682972851"><span class="hs-identifier hs-type">not_concs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1258"></span><span>    </span><span id="local-6989586621682972851"><span class="annot"><span class="annottext">not_concs :: [(SDoc, ConcreteTvOrigin)]
</span><a href="#local-6989586621682972851"><span class="hs-identifier hs-var hs-var">not_concs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1259"></span><span>      </span><span class="annot"><span class="annottext">((JoinArity, Maybe CoreExpr) -&gt; Maybe (SDoc, ConcreteTvOrigin))
-&gt; [(JoinArity, Maybe CoreExpr)] -&gt; [(SDoc, ConcreteTvOrigin)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(JoinArity, Maybe CoreExpr) -&gt; Maybe (SDoc, ConcreteTvOrigin)
</span><a href="#local-6989586621682972861"><span class="hs-identifier hs-var">is_bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[JoinArity] -&gt; [Maybe CoreExpr] -&gt; [(JoinArity, Maybe CoreExpr)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972857"><span class="hs-identifier hs-var">max_pos</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; [CoreExpr] -&gt; [Maybe CoreExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972850"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe CoreExpr] -&gt; [Maybe CoreExpr] -&gt; [Maybe CoreExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr -&gt; [Maybe CoreExpr]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>        </span><span class="hs-comment">-- NB: 1-indexed</span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span>    </span><span class="annot"><a href="#local-6989586621682972861"><span class="hs-identifier hs-type">is_bad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1263"></span><span>    </span><span id="local-6989586621682972861"><span class="annot"><span class="annottext">is_bad :: (JoinArity, Maybe CoreExpr) -&gt; Maybe (SDoc, ConcreteTvOrigin)
</span><a href="#local-6989586621682972861"><span class="hs-identifier hs-var hs-var">is_bad</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972863"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972863"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972864"><span class="annot"><span class="annottext">Maybe CoreExpr
</span><a href="#local-6989586621682972864"><span class="hs-identifier hs-var">mb_arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1264"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972865"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972865"><span class="hs-identifier hs-var">conc_reason</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; IntMap ConcreteTvOrigin -&gt; Maybe ConcreteTvOrigin
forall a. JoinArity -&gt; IntMap a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IntMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972863"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972853"><span class="hs-identifier hs-var">conc_binder_positions</span></a></span><span>
</span><span id="line-1265"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972866"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972866"><span class="hs-identifier hs-var">bad_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
</span><a href="#local-6989586621682972864"><span class="hs-identifier hs-var">mb_arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1266"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682972867"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972867"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1267"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isConcreteType"><span class="hs-identifier hs-var">isConcreteType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972867"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1268"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SDoc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1269"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1270"></span><span>            </span><span class="hs-comment">-- Here we handle the situation in which a &quot;must be concrete&quot; TyVar</span><span>
</span><span id="line-1271"></span><span>            </span><span class="hs-comment">-- has been instantiated with a type that is not concrete.</span><span>
</span><span id="line-1272"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Maybe SDoc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; Maybe SDoc) -&gt; SDoc -&gt; Maybe SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972867"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not concrete.&quot;</span></span><span>
</span><span id="line-1273"></span><span>          </span><span class="hs-comment">-- We expected a type argument in this position, and got something else: panic!</span><span>
</span><span id="line-1274"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972869"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972869"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1275"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Maybe SDoc
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checkRepPolyBuiltinApp: expected a type in this position&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; Maybe SDoc) -&gt; SDoc -&gt; Maybe SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1276"></span><span>              </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun_id:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972849"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972849"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1277"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pos:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972863"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-1278"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972869"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1279"></span><span>          </span><span class="annot"><span class="annottext">Maybe CoreExpr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1280"></span><span>            </span><span class="hs-comment">-- Here we handle the situation in which a &quot;must be concrete&quot; TyVar</span><span>
</span><span id="line-1281"></span><span>            </span><span class="hs-comment">-- has not been instantiated at all.</span><span>
</span><span id="line-1282"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972865"><span class="hs-identifier hs-var">conc_reason</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1283"></span><span>              </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-type">ConcreteFRR</span></a></span><span> </span><span id="local-6989586621682972872"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621682972872"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1284"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972873"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682972873"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin -&gt; LintedType
</span><a href="GHC.Tc.Types.Origin.html#frr_type"><span class="hs-identifier hs-var">frr_type</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621682972872"><span class="hs-identifier hs-var">frr_orig</span></a></span><span>
</span><span id="line-1285"></span><span>                </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; Maybe SDoc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; Maybe SDoc) -&gt; SDoc -&gt; Maybe SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972873"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972873"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1286"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SDoc, ConcreteTvOrigin) -&gt; Maybe (SDoc, ConcreteTvOrigin)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972866"><span class="hs-identifier hs-var">bad_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972865"><span class="hs-identifier hs-var">conc_reason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1288"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SDoc, ConcreteTvOrigin)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span>    </span><span class="annot"><a href="#local-6989586621682972852"><span class="hs-identifier hs-type">err_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1291"></span><span>    </span><span id="local-6989586621682972852"><span class="annot"><span class="annottext">err_msg :: SDoc
</span><a href="#local-6989586621682972852"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span>
</span><span id="line-1292"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((SDoc, ConcreteTvOrigin) -&gt; SDoc)
-&gt; [(SDoc, ConcreteTvOrigin)] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#bullet"><span class="hs-identifier hs-var">bullet</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc)
-&gt; ((SDoc, ConcreteTvOrigin) -&gt; SDoc)
-&gt; (SDoc, ConcreteTvOrigin)
-&gt; SDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SDoc, ConcreteTvOrigin) -&gt; SDoc
</span><a href="#local-6989586621682972875"><span class="hs-identifier hs-var">ppr_not_conc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(SDoc, ConcreteTvOrigin)]
</span><a href="#local-6989586621682972851"><span class="hs-identifier hs-var">not_concs</span></a></span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span>    </span><span class="annot"><a href="#local-6989586621682972875"><span class="hs-identifier hs-type">ppr_not_conc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1295"></span><span>    </span><span id="local-6989586621682972875"><span class="annot"><span class="annottext">ppr_not_conc :: (SDoc, ConcreteTvOrigin) -&gt; SDoc
</span><a href="#local-6989586621682972875"><span class="hs-identifier hs-var hs-var">ppr_not_conc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972876"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972876"><span class="hs-identifier hs-var">bad_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972877"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972877"><span class="hs-identifier hs-var">conc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1296"></span><span>      </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-1297"></span><span>       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin -&gt; SDoc
</span><a href="#local-6989586621682972878"><span class="hs-identifier hs-var">ppr_conc_orig</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972877"><span class="hs-identifier hs-var">conc</span></a></span><span>
</span><span id="line-1298"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972876"><span class="hs-identifier hs-var">bad_ty</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1299"></span><span>
</span><span id="line-1300"></span><span>    </span><span class="annot"><a href="#local-6989586621682972878"><span class="hs-identifier hs-type">ppr_conc_orig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1301"></span><span>    </span><span id="local-6989586621682972878"><span class="annot"><span class="annottext">ppr_conc_orig :: ConcreteTvOrigin -&gt; SDoc
</span><a href="#local-6989586621682972878"><span class="hs-identifier hs-var hs-var">ppr_conc_orig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteFRR"><span class="hs-identifier hs-type">ConcreteFRR</span></a></span><span> </span><span id="local-6989586621682972879"><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621682972879"><span class="hs-identifier hs-var">frr_orig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1302"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepOrigin
</span><a href="#local-6989586621682972879"><span class="hs-identifier hs-var">frr_orig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1303"></span><span>        </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#FixedRuntimeRepOrigin"><span class="hs-identifier hs-type">FixedRuntimeRepOrigin</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">frr_context :: FixedRuntimeRepOrigin -&gt; FixedRuntimeRepContext
</span><a href="GHC.Tc.Types.Origin.html#frr_context"><span class="hs-identifier hs-var">frr_context</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682972882"><span class="annot"><span class="annottext">FixedRuntimeRepContext
</span><a href="#local-6989586621682972882"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1304"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepContext -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FixedRuntimeRepContext
</span><a href="#local-6989586621682972882"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does not have a fixed runtime representation:&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1305"></span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- | Compute the 1-indexed positions in the outer forall'd quantified type variables</span><span>
</span><span id="line-1307"></span><span class="hs-comment">-- of the type in which the concrete type variables occur.</span><span>
</span><span id="line-1308"></span><span class="hs-comment">--</span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- See Note [Representation-polymorphism checking built-ins] in GHC.Tc.Utils.Concrete.</span><span>
</span><span id="line-1310"></span><span class="annot"><a href="GHC.Core.Lint.html#concreteTyVarPositions"><span class="hs-identifier hs-type">concreteTyVarPositions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTyVars"><span class="hs-identifier hs-type">ConcreteTyVars</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ConcreteTvOrigin"><span class="hs-identifier hs-type">ConcreteTvOrigin</span></a></span><span>
</span><span id="line-1311"></span><span id="concreteTyVarPositions"><span class="annot"><span class="annottext">concreteTyVarPositions :: Var -&gt; ConcreteTyVars -&gt; IntMap ConcreteTvOrigin
</span><a href="GHC.Core.Lint.html#concreteTyVarPositions"><span class="hs-identifier hs-var hs-var">concreteTyVarPositions</span></a></span></span><span> </span><span id="local-6989586621682972884"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972884"><span class="hs-identifier hs-var">fun_id</span></a></span></span><span> </span><span id="local-6989586621682972885"><span class="annot"><span class="annottext">ConcreteTyVars
</span><a href="#local-6989586621682972885"><span class="hs-identifier hs-var">conc_tvs</span></a></span></span><span>
</span><span id="line-1312"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars -&gt; Bool
forall {k} (key :: k) elt. UniqFM key elt -&gt; Bool
</span><a href="GHC.Types.Unique.FM.html#isNullUFM"><span class="hs-identifier hs-var">isNullUFM</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars
</span><a href="#local-6989586621682972885"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span>
</span><span id="line-1313"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IntMap.empty</span></a></span><span>
</span><span id="line-1314"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1315"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; ([Var], LintedType)
</span><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-var">splitForAllTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972884"><span class="hs-identifier hs-var">fun_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1316"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
forall a. IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#empty"><span class="hs-identifier hs-var">IntMap.empty</span></a></span><span>
</span><span id="line-1317"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682972887"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972887"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1318"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972888"><span class="annot"><span class="annottext">positions :: IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972888"><span class="hs-identifier hs-var hs-var">positions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1319"></span><span>            </span><span class="annot"><span class="annottext">[(JoinArity, ConcreteTvOrigin)] -&gt; IntMap ConcreteTvOrigin
forall a. [(JoinArity, a)] -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">IntMap.fromList</span></a></span><span>
</span><span id="line-1320"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972889"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972890"><span class="hs-identifier hs-var">conc_orig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1321"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972891"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972891"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972889"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682972889"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [JoinArity] -&gt; [(Var, JoinArity)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972887"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1322"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972890"><span class="annot"><span class="annottext">ConcreteTvOrigin
</span><a href="#local-6989586621682972890"><span class="hs-identifier hs-var">conc_orig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ConcreteTvOrigin -&gt; [ConcreteTvOrigin]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ConcreteTvOrigin -&gt; [ConcreteTvOrigin])
-&gt; Maybe ConcreteTvOrigin -&gt; [ConcreteTvOrigin]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars -&gt; Name -&gt; Maybe ConcreteTvOrigin
forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars
</span><a href="#local-6989586621682972885"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972891"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-1324"></span><span>         </span><span class="hs-comment">-- Assert that we have as many positions as concrete type variables,</span><span>
</span><span id="line-1325"></span><span>         </span><span class="hs-comment">-- i.e. we are not missing any concreteness information.</span><span>
</span><span id="line-1326"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; IntMap ConcreteTvOrigin -&gt; IntMap ConcreteTvOrigin
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteTyVars -&gt; JoinArity
forall {k} (key :: k) elt. UniqFM key elt -&gt; JoinArity
</span><a href="GHC.Types.Unique.FM.html#sizeUFM"><span class="hs-identifier hs-var">sizeUFM</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars
</span><a href="#local-6989586621682972885"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin -&gt; JoinArity
forall a. IntMap a -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972888"><span class="hs-identifier hs-var">positions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1327"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;concreteTyVarPositions: missing concreteness information&quot;</span></span><span>
</span><span id="line-1328"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun_id:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972884"><span class="hs-identifier hs-var">fun_id</span></a></span><span>
</span><span id="line-1329"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tvs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682972887"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1330"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected # of concrete tvs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteTyVars -&gt; JoinArity
forall {k} (key :: k) elt. UniqFM key elt -&gt; JoinArity
</span><a href="GHC.Types.Unique.FM.html#sizeUFM"><span class="hs-identifier hs-var">sizeUFM</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteTyVars
</span><a href="#local-6989586621682972885"><span class="hs-identifier hs-var">conc_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1331"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Actual # of concrete tvs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin -&gt; JoinArity
forall a. IntMap a -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972888"><span class="hs-identifier hs-var">positions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1332"></span><span>           </span><span class="annot"><span class="annottext">IntMap ConcreteTvOrigin
</span><a href="#local-6989586621682972888"><span class="hs-identifier hs-var">positions</span></a></span><span>
</span><span id="line-1333"></span><span>
</span><span id="line-1334"></span><span class="hs-comment">-- Check that the usage of var is consistent with var itself, and pop the var</span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- from the usage environment (this is important because of shadowing).</span><span>
</span><span id="line-1336"></span><span class="annot"><a href="GHC.Core.Lint.html#checkLinearity"><span class="hs-identifier hs-type">checkLinearity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1337"></span><span id="checkLinearity"><span class="annot"><span class="annottext">checkLinearity :: UsageEnv -&gt; Var -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#checkLinearity"><span class="hs-identifier hs-var hs-var">checkLinearity</span></a></span></span><span> </span><span id="local-6989586621682972896"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972896"><span class="hs-identifier hs-var">body_ue</span></a></span></span><span> </span><span id="local-6989586621682972897"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972897"><span class="hs-identifier hs-var">lam_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1338"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Maybe LintedType
</span><a href="GHC.Types.Var.html#varMultMaybe"><span class="hs-identifier hs-var">varMultMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972897"><span class="hs-identifier hs-var">lam_var</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1339"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682972899"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972899"><span class="hs-identifier hs-var">mult</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1340"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972900"><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972900"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972901"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972901"><span class="hs-identifier hs-var hs-var">body_ue'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; Var -&gt; (Usage, UsageEnv)
forall n. NamedThing n =&gt; UsageEnv -&gt; n -&gt; (Usage, UsageEnv)
</span><a href="GHC.Core.UsageEnv.html#popUE"><span class="hs-identifier hs-var">popUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972896"><span class="hs-identifier hs-var">body_ue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972897"><span class="hs-identifier hs-var">lam_var</span></a></span><span>
</span><span id="line-1341"></span><span>          </span><span id="local-6989586621682972903"><span class="annot"><span class="annottext">err_msg :: SDoc
</span><a href="#local-6989586621682972903"><span class="hs-identifier hs-var hs-var hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linearity failure in lambda:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972897"><span class="hs-identifier hs-var">lam_var</span></a></span><span>
</span><span id="line-1342"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Usage -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972900"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8840;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972899"><span class="hs-identifier hs-var">mult</span></a></span><span>
</span><span id="line-1343"></span><span>      </span><span class="annot"><span class="annottext">Usage -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-var">ensureSubUsage</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972900"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972899"><span class="hs-identifier hs-var">mult</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972903"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-1344"></span><span>      </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM UsageEnv
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972901"><span class="hs-identifier hs-var">body_ue'</span></a></span><span>
</span><span id="line-1345"></span><span>    </span><span class="annot"><span class="annottext">Maybe LintedType
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM UsageEnv
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972896"><span class="hs-identifier hs-var">body_ue</span></a></span><span> </span><span class="hs-comment">-- A type variable</span><span>
</span><span id="line-1346"></span><span>
</span><span id="line-1347"></span><span class="hs-comment">{- Note [Join points and casts]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You might think that this should be OK:
   join j x = rhs
   in (case e of
          A   -&gt; alt1
          B x -&gt; (jump j x) |&gt; co)

You might think that, since the cast is ultimately erased, the jump to
`j` should still be OK as a join point.  But no!  See #21716. Suppose

  newtype Age = MkAge Int   -- axAge :: Age ~ Int
  f :: Int -&gt; ...           -- f strict in it's first argument

and consider the expression

  f (join j :: Bool -&gt; Age
          j x = (rhs1 :: Age)
     in case v of
         Just x  -&gt; (j x |&gt; axAge :: Int)
         Nothing -&gt; rhs2)

Then, if the Simplifier pushes the strict call into the join points
and alternatives we'll get

   join j' x = f (rhs1 :: Age)
   in case v of
      Just x  -&gt; j' x |&gt; axAge
      Nothing -&gt; f rhs2

Utterly bogus.  `f` expects an `Int` and we are giving it an `Age`.
No no no.  Casts destroy the tail-call property.  Henc markAllJoinsBad
in the (Cast expr co) case of lintCoreExpr.

Note [No alternatives lint check]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Case expressions with no alternatives are odd beasts, and it would seem
like they would worth be looking at in the linter (cf #10180). We
used to check two things:

* exprIsHNF is false: it would *seem* to be terribly wrong if
  the scrutinee was already in head normal form.

* exprIsDeadEnd is true: we should be able to see why GHC believes the
  scrutinee is diverging for sure.

It was already known that the second test was not entirely reliable.
Unfortunately (#13990), the first test turned out not to be reliable
either. Getting the checks right turns out to be somewhat complicated.

For example, suppose we have (comment 8)

  data T a where
    TInt :: T Int

  absurdTBool :: T Bool -&gt; a
  absurdTBool v = case v of

  data Foo = Foo !(T Bool)

  absurdFoo :: Foo -&gt; a
  absurdFoo (Foo x) = absurdTBool x

GHC initially accepts the empty case because of the GADT conditions. But then
we inline absurdTBool, getting

  absurdFoo (Foo x) = case x of

x is in normal form (because the Foo constructor is strict) but the
case is empty. To avoid this problem, GHC would have to recognize
that matching on Foo x is already absurd, which is not so easy.

More generally, we don't really know all the ways that GHC can
lose track of why an expression is bottom, so we shouldn't make too
much fuss when that happens.


Note [Beta redexes]
~~~~~~~~~~~~~~~~~~~
Consider:

  join j @x y z = ... in
  (\@x y z -&gt; jump j @x y z) @t e1 e2

This is clearly ill-typed, since the jump is inside both an application and a
lambda, either of which is enough to disqualify it as a tail call (see Note
[Invariants on join points] in GHC.Core). However, strictly from a
lambda-calculus perspective, the term doesn't go wrong---after the two beta
reductions, the jump *is* a tail call and everything is fine.

Why would we want to allow this when we have let? One reason is that a compound
beta redex (that is, one with more than one argument) has different scoping
rules: naively reducing the above example using lets will capture any free
occurrence of y in e2. More fundamentally, type lets are tricky; many passes,
such as Float Out, tacitly assume that the incoming program's type lets have
all been dealt with by the simplifier. Thus we don't want to let-bind any types
in, say, GHC.Core.Subst.simpleOptPgm, which in some circumstances can run immediately
before Float Out.

All that said, currently GHC.Core.Subst.simpleOptPgm is the only thing using this
loophole, doing so to avoid re-traversing large functions (beta-reducing a type
lambda without introducing a type let requires a substitution). TODO: Improve
simpleOptPgm so that we can forget all this ever happened.

************************************************************************
*                                                                      *
\subsection[lintCoreArgs]{lintCoreArgs}
*                                                                      *
************************************************************************

The basic version of these functions checks that the argument is a
subtype of the required type, as one would expect.
-}</span><span>
</span><span id="line-1460"></span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- Takes the functions type and arguments as argument.</span><span>
</span><span id="line-1462"></span><span class="hs-comment">-- Returns the *result* of applying the function to arguments.</span><span>
</span><span id="line-1463"></span><span class="hs-comment">-- e.g. f :: Int -&gt; Bool -&gt; Int would return `Int` as result type.</span><span>
</span><span id="line-1464"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-type">lintCoreArgs</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span id="lintCoreArgs"><span class="annot"><span class="annottext">lintCoreArgs :: (LintedType, UsageEnv)
-&gt; [CoreExpr] -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-var hs-var">lintCoreArgs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972905"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972905"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972906"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972906"><span class="hs-identifier hs-var">fun_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972907"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972907"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LintedType, UsageEnv)
 -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv))
-&gt; (LintedType, UsageEnv)
-&gt; [CoreExpr]
-&gt; LintM (LintedType, UsageEnv)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv) -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972905"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972906"><span class="hs-identifier hs-var">fun_ue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682972907"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1466"></span><span>
</span><span id="line-1467"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-type">lintCoreArg</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1468"></span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- Type argument</span><span>
</span><span id="line-1470"></span><span id="lintCoreArg"><span class="annot"><span class="annottext">lintCoreArg :: (LintedType, UsageEnv) -&gt; CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-var hs-var">lintCoreArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972909"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972909"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972910"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972910"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682972911"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972911"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1471"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972911"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1472"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unnecessary coercion-to-type injection:&quot;</span></span><span>
</span><span id="line-1473"></span><span>                  </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972911"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1474"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972913"><span class="annot"><a href="#local-6989586621682972913"><span class="hs-identifier hs-var">arg_ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972911"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1475"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972914"><span class="annot"><a href="#local-6989586621682972914"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintTyApp"><span class="hs-identifier hs-type">lintTyApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972909"><span class="hs-identifier hs-type">fun_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972913"><span class="hs-identifier hs-type">arg_ty'</span></a></span><span>
</span><span id="line-1476"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972914"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972910"><span class="hs-identifier hs-type">ue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1477"></span><span>
</span><span id="line-1478"></span><span class="hs-comment">-- Coercion argument</span><span>
</span><span id="line-1479"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972916"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972916"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972917"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972917"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span id="local-6989586621682972918"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972918"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972919"><span class="annot"><a href="#local-6989586621682972919"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM Coercion -&gt; LintM Coercion
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#InCo"><span class="hs-identifier hs-var">InCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972918"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM Coercion -&gt; LintM Coercion)
-&gt; LintM Coercion -&gt; LintM Coercion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1481"></span><span>                </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972918"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1482"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972920"><span class="annot"><a href="#local-6989586621682972920"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoApp"><span class="hs-identifier hs-type">lintCoApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972916"><span class="hs-identifier hs-type">fun_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972919"><span class="hs-identifier hs-type">co'</span></a></span><span>
</span><span id="line-1483"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682972920"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682972917"><span class="hs-identifier hs-type">ue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1484"></span><span>
</span><span id="line-1485"></span><span class="hs-comment">-- Other value argument</span><span>
</span><span id="line-1486"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreArg"><span class="hs-identifier hs-var">lintCoreArg</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972922"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972922"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972923"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972923"><span class="hs-identifier hs-var">fun_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682972924"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972924"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-1487"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972925"><span class="annot"><a href="#local-6989586621682972925"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972926"><span class="annot"><a href="#local-6989586621682972926"><span class="hs-identifier hs-var">arg_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972924"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1488"></span><span>           </span><span class="hs-comment">-- See Note [Representation polymorphism invariants] in GHC.Core</span><span>
</span><span id="line-1489"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972927"><span class="annot"><a href="#local-6989586621682972927"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-type">getLintFlags</span></a></span><span>
</span><span id="line-1490"></span><span>
</span><span id="line-1491"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_fixed_rep"><span class="hs-identifier hs-var">lf_check_fixed_rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972927"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1492"></span><span>         </span><span class="hs-comment">-- Only check that 'arg_ty' has a fixed RuntimeRep</span><span>
</span><span id="line-1493"></span><span>         </span><span class="hs-comment">-- if 'lf_check_fixed_rep' is on.</span><span>
</span><span id="line-1494"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-type">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972925"><span class="hs-identifier hs-type">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1495"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Argument does not have a fixed runtime representation&quot;</span></span><span>
</span><span id="line-1496"></span><span>                      </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972924"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span>
</span><span id="line-1497"></span><span>                      </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972925"><span class="hs-identifier hs-type">arg_ty</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972925"><span class="hs-identifier hs-type">arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintValApp"><span class="hs-identifier hs-type">lintValApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972924"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972922"><span class="hs-identifier hs-type">fun_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972925"><span class="hs-identifier hs-type">arg_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972923"><span class="hs-identifier hs-type">fun_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972926"><span class="hs-identifier hs-type">arg_ue</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1500"></span><span>
</span><span id="line-1501"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-1502"></span><span class="annot"><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-type">lintAltBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1503"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>         </span><span class="hs-comment">-- Case binder</span><span>
</span><span id="line-1504"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>     </span><span class="hs-comment">-- Scrutinee type</span><span>
</span><span id="line-1505"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>     </span><span class="hs-comment">-- Constructor type</span><span>
</span><span id="line-1506"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Binders</span><span>
</span><span id="line-1507"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1508"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1509"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-1510"></span><span id="lintAltBinders"><span class="annot"><span class="annottext">lintAltBinders :: UsageEnv
-&gt; Var
-&gt; LintedType
-&gt; LintedType
-&gt; [(LintedType, Var)]
-&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-var hs-var">lintAltBinders</span></a></span></span><span> </span><span id="local-6989586621682972932"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972932"><span class="hs-identifier hs-var">rhs_ue</span></a></span></span><span> </span><span id="local-6989586621682972933"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972933"><span class="hs-identifier hs-var">_case_bndr</span></a></span></span><span> </span><span id="local-6989586621682972934"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972934"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682972935"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972935"><span class="hs-identifier hs-var">con_ty</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1511"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972935"><span class="hs-identifier hs-var">con_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972934"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadPatMsg"><span class="hs-identifier hs-var">mkBadPatMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972935"><span class="hs-identifier hs-var">con_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972934"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1512"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM UsageEnv
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972932"><span class="hs-identifier hs-var">rhs_ue</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1513"></span><span class="annot"><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-var">lintAltBinders</span></a></span><span> </span><span id="local-6989586621682972937"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972937"><span class="hs-identifier hs-var">rhs_ue</span></a></span></span><span> </span><span id="local-6989586621682972938"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972938"><span class="hs-identifier hs-var">case_bndr</span></a></span></span><span> </span><span id="local-6989586621682972939"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972939"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682972940"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972940"><span class="hs-identifier hs-var">con_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682972941"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972941"><span class="hs-identifier hs-var">var_w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972942"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972942"><span class="hs-identifier hs-var">bndr</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682972943"><span class="annot"><span class="annottext">[(LintedType, Var)]
</span><a href="#local-6989586621682972943"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1514"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972942"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1515"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972944"><span class="annot"><a href="#local-6989586621682972944"><span class="hs-identifier hs-var">con_ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintTyApp"><span class="hs-identifier hs-var">lintTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972940"><span class="hs-identifier hs-var">con_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972942"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1516"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-type">lintAltBinders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972937"><span class="hs-identifier hs-type">rhs_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972938"><span class="hs-identifier hs-type">case_bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972939"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972944"><span class="hs-identifier hs-type">con_ty'</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621682972943"><span class="hs-identifier hs-type">bndrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1517"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972946"><span class="annot"><a href="#local-6989586621682972946"><span class="hs-identifier hs-var">con_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
-&gt; LintedType
-&gt; LintedType
-&gt; UsageEnv
-&gt; UsageEnv
-&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintValApp"><span class="hs-identifier hs-var">lintValApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; CoreExpr
forall b. Var -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972942"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972940"><span class="hs-identifier hs-var">con_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972942"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span>
</span><span id="line-1519"></span><span>         </span><span class="hs-comment">-- We can pass zeroUE to lintValApp because we ignore its usage</span><span>
</span><span id="line-1520"></span><span>         </span><span class="hs-comment">-- calculation and compute it in the call for checkCaseLinearity below.</span><span>
</span><span id="line-1521"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972947"><span class="annot"><a href="#local-6989586621682972947"><span class="hs-identifier hs-var">rhs_ue'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkCaseLinearity"><span class="hs-identifier hs-type">checkCaseLinearity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972937"><span class="hs-identifier hs-type">rhs_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972938"><span class="hs-identifier hs-type">case_bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972941"><span class="hs-identifier hs-type">var_w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972942"><span class="hs-identifier hs-type">bndr</span></a></span><span>
</span><span id="line-1522"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-type">lintAltBinders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972947"><span class="hs-identifier hs-type">rhs_ue'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972938"><span class="hs-identifier hs-type">case_bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972939"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972946"><span class="hs-identifier hs-type">con_ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972943"><span class="hs-identifier hs-type">bndrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span class="annot"><span class="hs-comment">-- | Implements the case rules for linearity</span></span><span>
</span><span id="line-1525"></span><span class="annot"><a href="GHC.Core.Lint.html#checkCaseLinearity"><span class="hs-identifier hs-type">checkCaseLinearity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1526"></span><span id="checkCaseLinearity"><span class="annot"><span class="annottext">checkCaseLinearity :: UsageEnv -&gt; Var -&gt; LintedType -&gt; Var -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#checkCaseLinearity"><span class="hs-identifier hs-var hs-var">checkCaseLinearity</span></a></span></span><span> </span><span id="local-6989586621682972949"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972949"><span class="hs-identifier hs-var">ue</span></a></span></span><span> </span><span id="local-6989586621682972950"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972950"><span class="hs-identifier hs-var">case_bndr</span></a></span></span><span> </span><span id="local-6989586621682972951"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span></span><span> </span><span id="local-6989586621682972952"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1527"></span><span>  </span><span class="annot"><span class="annottext">Usage -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-var">ensureSubUsage</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972953"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972954"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972955"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-1528"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; LintedType -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintLinearBinder"><span class="hs-identifier hs-var">lintLinearBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972957"><span class="hs-identifier hs-var">case_bndr_w</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.Multiplicity.html#mkMultMul"><span class="hs-operator hs-var">`mkMultMul`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varMult"><span class="hs-identifier hs-var">varMult</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1529"></span><span>  </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM UsageEnv
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(UsageEnv -&gt; LintM UsageEnv) -&gt; UsageEnv -&gt; LintM UsageEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; Var -&gt; UsageEnv
forall n. NamedThing n =&gt; UsageEnv -&gt; n -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#deleteUE"><span class="hs-identifier hs-var">deleteUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972949"><span class="hs-identifier hs-var">ue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1530"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1531"></span><span>    </span><span id="local-6989586621682972953"><span class="annot"><span class="annottext">lhs :: Usage
</span><a href="#local-6989586621682972953"><span class="hs-identifier hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972961"><span class="hs-identifier hs-var">bndr_usage</span></a></span><span> </span><span class="annot"><span class="annottext">Usage -&gt; Usage -&gt; Usage
</span><a href="GHC.Core.UsageEnv.html#addUsage"><span class="hs-operator hs-var">`addUsage`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Usage -&gt; Usage
</span><a href="GHC.Core.UsageEnv.html#scaleUsage"><span class="hs-operator hs-var">`scaleUsage`</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972964"><span class="hs-identifier hs-var">case_bndr_usage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>    </span><span id="local-6989586621682972954"><span class="annot"><span class="annottext">rhs :: LintedType
</span><a href="#local-6989586621682972954"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972957"><span class="hs-identifier hs-var">case_bndr_w</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.Multiplicity.html#mkMultMul"><span class="hs-operator hs-var">`mkMultMul`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span><span>
</span><span id="line-1533"></span><span>    </span><span id="local-6989586621682972955"><span class="annot"><span class="annottext">err_msg :: SDoc
</span><a href="#local-6989586621682972955"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linearity failure in variable:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1534"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Usage -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972953"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8840;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972954"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1535"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Computed by:&quot;</span></span><span>
</span><span id="line-1536"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LHS:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972965"><span class="hs-identifier hs-var">lhs_formula</span></a></span><span>
</span><span id="line-1537"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RHS:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682972966"><span class="hs-identifier hs-var">rhs_formula</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>    </span><span id="local-6989586621682972965"><span class="annot"><span class="annottext">lhs_formula :: SDoc
</span><a href="#local-6989586621682972965"><span class="hs-identifier hs-var hs-var">lhs_formula</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Usage -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972961"><span class="hs-identifier hs-var">bndr_usage</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-1539"></span><span>                                 </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Usage -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682972964"><span class="hs-identifier hs-var">case_bndr_usage</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1540"></span><span>    </span><span id="local-6989586621682972966"><span class="annot"><span class="annottext">rhs_formula :: SDoc
</span><a href="#local-6989586621682972966"><span class="hs-identifier hs-var hs-var">rhs_formula</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972957"><span class="hs-identifier hs-var">case_bndr_w</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972951"><span class="hs-identifier hs-var">var_w</span></a></span><span>
</span><span id="line-1541"></span><span>    </span><span id="local-6989586621682972957"><span class="annot"><span class="annottext">case_bndr_w :: LintedType
</span><a href="#local-6989586621682972957"><span class="hs-identifier hs-var hs-var">case_bndr_w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varMult"><span class="hs-identifier hs-var">varMult</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972950"><span class="hs-identifier hs-var">case_bndr</span></a></span><span>
</span><span id="line-1542"></span><span>    </span><span id="local-6989586621682972964"><span class="annot"><span class="annottext">case_bndr_usage :: Usage
</span><a href="#local-6989586621682972964"><span class="hs-identifier hs-var hs-var">case_bndr_usage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; Var -&gt; Usage
forall n. NamedThing n =&gt; UsageEnv -&gt; n -&gt; Usage
</span><a href="GHC.Core.UsageEnv.html#lookupUE"><span class="hs-identifier hs-var">lookupUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972949"><span class="hs-identifier hs-var">ue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972950"><span class="hs-identifier hs-var">case_bndr</span></a></span><span>
</span><span id="line-1543"></span><span>    </span><span id="local-6989586621682972961"><span class="annot"><span class="annottext">bndr_usage :: Usage
</span><a href="#local-6989586621682972961"><span class="hs-identifier hs-var hs-var">bndr_usage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; Var -&gt; Usage
forall n. NamedThing n =&gt; UsageEnv -&gt; n -&gt; Usage
</span><a href="GHC.Core.UsageEnv.html#lookupUE"><span class="hs-identifier hs-var">lookupUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972949"><span class="hs-identifier hs-var">ue</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972952"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-1544"></span><span>
</span><span id="line-1545"></span><span>
</span><span id="line-1546"></span><span>
</span><span id="line-1547"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-1548"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTyApp"><span class="hs-identifier hs-type">lintTyApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-1549"></span><span id="lintTyApp"><span class="annot"><span class="annottext">lintTyApp :: LintedType -&gt; LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintTyApp"><span class="hs-identifier hs-var hs-var">lintTyApp</span></a></span></span><span> </span><span id="local-6989586621682972968"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972968"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682972969"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972969"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972970"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972970"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682972971"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972971"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (Var, LintedType)
</span><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier hs-var">splitForAllTyVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972968"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-1551"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintTyKind"><span class="hs-identifier hs-var">lintTyKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972970"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972969"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1552"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682972973"><span class="annot"><a href="#local-6989586621682972973"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM InScopeSet
</span><a href="GHC.Core.Lint.html#getInScope"><span class="hs-identifier hs-var">getInScope</span></a></span><span>
</span><span id="line-1553"></span><span>        </span><span class="hs-comment">-- substTy needs the set of tyvars in scope to avoid generating</span><span>
</span><span id="line-1554"></span><span>        </span><span class="hs-comment">-- uniques that are already in scope.</span><span>
</span><span id="line-1555"></span><span>        </span><span class="hs-comment">-- See Note [The substitution invariant] in GHC.Core.TyCo.Subst</span><span>
</span><span id="line-1556"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithInScope"><span class="hs-identifier hs-type">substTyWithInScope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972973"><span class="hs-identifier hs-type">in_scope</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682972970"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682972969"><span class="hs-identifier hs-type">arg_ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621682972971"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1559"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkTyAppMsg"><span class="hs-identifier hs-var">mkTyAppMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972968"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972969"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-1562"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoApp"><span class="hs-identifier hs-type">lintCoApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedCoercion"><span class="hs-identifier hs-type">LintedCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-1563"></span><span id="lintCoApp"><span class="annot"><span class="annottext">lintCoApp :: LintedType -&gt; Coercion -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintCoApp"><span class="hs-identifier hs-var hs-var">lintCoApp</span></a></span></span><span> </span><span id="local-6989586621682972977"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972977"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682972978"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972978"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-1564"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682972979"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972979"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682972980"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972980"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (Var, LintedType)
</span><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier hs-var">splitForAllCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972977"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-1565"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972982"><span class="annot"><span class="annottext">co_ty :: LintedType
</span><a href="#local-6989586621682972982"><span class="hs-identifier hs-var hs-var">co_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972978"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1566"></span><span>        </span><span id="local-6989586621682972983"><span class="annot"><span class="annottext">cv_ty :: LintedType
</span><a href="#local-6989586621682972983"><span class="hs-identifier hs-var hs-var">cv_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972979"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-1567"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972983"><span class="hs-identifier hs-var">cv_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972982"><span class="hs-identifier hs-var">co_ty</span></a></span><span>
</span><span id="line-1568"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682972984"><span class="annot"><a href="#local-6989586621682972984"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM InScopeSet
</span><a href="GHC.Core.Lint.html#getInScope"><span class="hs-identifier hs-var">getInScope</span></a></span><span>
</span><span id="line-1569"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682972985"><span class="annot"><a href="#local-6989586621682972985"><span class="hs-identifier hs-var hs-var">init_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682972984"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-1570"></span><span>             </span><span id="local-6989586621682972987"><span class="annot"><a href="#local-6989586621682972987"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; Coercion -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier hs-var">extendCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682972985"><span class="hs-identifier hs-var">init_subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682972979"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972978"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1571"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-type">substTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972987"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682972980"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1572"></span><span>
</span><span id="line-1573"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972990"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972990"><span class="hs-identifier hs-var">arg_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682972991"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972991"><span class="hs-identifier hs-var">res_ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (FunTyFlag, LintedType, LintedType, LintedType)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972977"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-1574"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972993"><span class="hs-identifier hs-var">co_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972990"><span class="hs-identifier hs-var">arg_ty'</span></a></span><span>
</span><span id="line-1575"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972991"><span class="hs-identifier hs-var">res_ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1576"></span><span>
</span><span id="line-1577"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1578"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Coercion -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkCoAppMsg"><span class="hs-identifier hs-var">mkCoAppMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972977"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972978"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1581"></span><span>    </span><span id="local-6989586621682972993"><span class="annot"><span class="annottext">co_ty :: LintedType
</span><a href="#local-6989586621682972993"><span class="hs-identifier hs-var hs-var">co_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682972978"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-1582"></span><span>
</span><span id="line-1583"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span class="hs-comment">-- | @lintValApp arg fun_ty arg_ty@ lints an application of @fun arg@</span><span>
</span><span id="line-1586"></span><span class="hs-comment">-- where @fun :: fun_ty@ and @arg :: arg_ty@, returning the type of the</span><span>
</span><span id="line-1587"></span><span class="hs-comment">-- application.</span><span>
</span><span id="line-1588"></span><span class="annot"><a href="GHC.Core.Lint.html#lintValApp"><span class="hs-identifier hs-type">lintValApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1589"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1590"></span><span id="lintValApp"><span class="annot"><span class="annottext">lintValApp :: CoreExpr
-&gt; LintedType
-&gt; LintedType
-&gt; UsageEnv
-&gt; UsageEnv
-&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintValApp"><span class="hs-identifier hs-var hs-var">lintValApp</span></a></span></span><span> </span><span id="local-6989586621682972995"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972995"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621682972996"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972996"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682972997"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972997"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span id="local-6989586621682972998"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972998"><span class="hs-identifier hs-var">fun_ue</span></a></span></span><span> </span><span id="local-6989586621682972999"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972999"><span class="hs-identifier hs-var">arg_ue</span></a></span></span><span>
</span><span id="line-1591"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973000"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973000"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973001"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973001"><span class="hs-identifier hs-var">arg_ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973002"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973002"><span class="hs-identifier hs-var">res_ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (FunTyFlag, LintedType, LintedType, LintedType)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972996"><span class="hs-identifier hs-var">fun_ty</span></a></span><span>
</span><span id="line-1592"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973001"><span class="hs-identifier hs-var">arg_ty'</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972997"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkAppMsg"><span class="hs-identifier hs-var">mkAppMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973001"><span class="hs-identifier hs-var">arg_ty'</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972997"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972995"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973004"><span class="annot"><span class="annottext">app_ue :: UsageEnv
</span><a href="#local-6989586621682973004"><span class="hs-identifier hs-var hs-var">app_ue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">UsageEnv -&gt; UsageEnv -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#addUE"><span class="hs-identifier hs-var">addUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972998"><span class="hs-identifier hs-var">fun_ue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; UsageEnv -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#scaleUE"><span class="hs-identifier hs-var">scaleUE</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973000"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682972999"><span class="hs-identifier hs-var">arg_ue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1594"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973002"><span class="hs-identifier hs-var">res_ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682973004"><span class="hs-identifier hs-var">app_ue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1595"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1596"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM (LintedType, UsageEnv)
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973005"><span class="hs-identifier hs-var">err2</span></a></span><span>
</span><span id="line-1597"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1598"></span><span>    </span><span id="local-6989586621682973005"><span class="annot"><span class="annottext">err2 :: SDoc
</span><a href="#local-6989586621682973005"><span class="hs-identifier hs-var hs-var">err2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonFunAppMsg"><span class="hs-identifier hs-var">mkNonFunAppMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972996"><span class="hs-identifier hs-var">fun_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682972997"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682972995"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1599"></span><span>
</span><span id="line-1600"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTyKind"><span class="hs-identifier hs-type">lintTyKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#OutTyVar"><span class="hs-identifier hs-type">OutTyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1601"></span><span class="hs-comment">-- Both args have had substitution applied</span><span>
</span><span id="line-1602"></span><span>
</span><span id="line-1603"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1604"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-1605"></span><span id="lintTyKind"><span class="annot"><span class="annottext">lintTyKind :: Var -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintTyKind"><span class="hs-identifier hs-var hs-var">lintTyKind</span></a></span></span><span> </span><span id="local-6989586621682973008"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973008"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span> </span><span id="local-6989586621682973009"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973009"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-1606"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973011"><span class="hs-identifier hs-var">arg_kind</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973012"><span class="hs-identifier hs-var">tyvar_kind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1607"></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkKindErrMsg"><span class="hs-identifier hs-var">mkKindErrMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973008"><span class="hs-identifier hs-var">tyvar</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973009"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linted Arg kind:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973011"><span class="hs-identifier hs-var">arg_kind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1608"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1609"></span><span>    </span><span id="local-6989586621682973012"><span class="annot"><span class="annottext">tyvar_kind :: LintedType
</span><a href="#local-6989586621682973012"><span class="hs-identifier hs-var hs-var">tyvar_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973008"><span class="hs-identifier hs-var">tyvar</span></a></span><span>
</span><span id="line-1610"></span><span>    </span><span id="local-6989586621682973011"><span class="annot"><span class="annottext">arg_kind :: LintedType
</span><a href="#local-6989586621682973011"><span class="hs-identifier hs-var hs-var">arg_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973009"><span class="hs-identifier hs-var">arg_ty</span></a></span><span>
</span><span id="line-1611"></span><span>
</span><span id="line-1612"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lintCoreAlts]{lintCoreAlts}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1619"></span><span>
</span><span id="line-1620"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCaseExpr"><span class="hs-identifier hs-type">lintCaseExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1621"></span><span id="lintCaseExpr"><span class="annot"><span class="annottext">lintCaseExpr :: CoreExpr
-&gt; Var -&gt; LintedType -&gt; [Alt Var] -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCaseExpr"><span class="hs-identifier hs-var hs-var">lintCaseExpr</span></a></span></span><span> </span><span id="local-6989586621682973016"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973016"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621682973017"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682973018"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973018"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span id="local-6989586621682973019"><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973019"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1622"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973020"><span class="annot"><span class="annottext">e :: CoreExpr
</span><a href="#local-6989586621682973020"><span class="hs-identifier hs-var hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Var -&gt; LintedType -&gt; [Alt Var] -&gt; CoreExpr
forall b. Expr b -&gt; b -&gt; LintedType -&gt; [Alt b] -&gt; Expr b
</span><a href="GHC.Core.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973016"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973018"><span class="hs-identifier hs-var">alt_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973019"><span class="hs-identifier hs-var">alts</span></a></span><span>   </span><span class="hs-comment">-- Just for error messages</span><span>
</span><span id="line-1623"></span><span>
</span><span id="line-1624"></span><span>     </span><span class="hs-comment">-- Check the scrutinee</span><span>
</span><span id="line-1625"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973021"><span class="annot"><a href="#local-6989586621682973021"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973022"><span class="annot"><a href="#local-6989586621682973022"><span class="hs-identifier hs-var">scrut_ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973016"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-1626"></span><span>          </span><span class="hs-comment">-- See Note [Join points are less general than the paper]</span><span>
</span><span id="line-1627"></span><span>          </span><span class="hs-comment">-- in GHC.Core</span><span>
</span><span id="line-1628"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973023"><span class="annot"><a href="#local-6989586621682973023"><span class="hs-identifier hs-var hs-var">scrut_mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varMult"><span class="hs-identifier hs-var">varMult</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-1629"></span><span>
</span><span id="line-1630"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973024"><span class="annot"><a href="#local-6989586621682973024"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#CaseTy"><span class="hs-identifier hs-type">CaseTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973016"><span class="hs-identifier hs-type">scrut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1631"></span><span>                 </span><span class="annot"><a href="GHC.Core.Lint.html#lintValueType"><span class="hs-identifier hs-type">lintValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973018"><span class="hs-identifier hs-type">alt_ty</span></a></span><span>
</span><span id="line-1632"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973027"><span class="annot"><a href="#local-6989586621682973027"><span class="hs-identifier hs-var">var_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#IdTy"><span class="hs-identifier hs-type">IdTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973017"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1633"></span><span>                 </span><span class="annot"><a href="GHC.Core.Lint.html#lintValueType"><span class="hs-identifier hs-type">lintValueType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973017"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>
</span><span id="line-1635"></span><span>     </span><span class="hs-comment">-- We used to try to check whether a case expression with no</span><span>
</span><span id="line-1636"></span><span>     </span><span class="hs-comment">-- alternatives was legitimate, but this didn't work.</span><span>
</span><span id="line-1637"></span><span>     </span><span class="hs-comment">-- See Note [No alternatives lint check] for details.</span><span>
</span><span id="line-1638"></span><span>
</span><span id="line-1639"></span><span>     </span><span class="hs-comment">-- Check that the scrutinee is not a floating-point type</span><span>
</span><span id="line-1640"></span><span>     </span><span class="hs-comment">-- if there are any literal alternatives</span><span>
</span><span id="line-1641"></span><span>     </span><span class="hs-comment">-- See GHC.Core Note [Case expression invariants] item (5)</span><span>
</span><span id="line-1642"></span><span>     </span><span class="hs-comment">-- See Note [Rules for floating-point comparisons] in GHC.Core.Opt.ConstantFold</span><span>
</span><span id="line-1643"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973029"><span class="annot"><a href="#local-6989586621682973029"><span class="hs-identifier hs-var hs-var">isLitPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Expr b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1644"></span><span>           </span><span class="annot"><a href="#local-6989586621682973029"><span class="hs-identifier hs-var">isLitPat</span></a></span><span> </span><span class="annot"><span class="annottext">Alt b
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1645"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isFloatingPrimTy"><span class="hs-identifier hs-type">isFloatingPrimTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973021"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">any</span></span><span> </span><span class="annot"><a href="#local-6989586621682973029"><span class="hs-identifier hs-type">isLitPat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973019"><span class="hs-identifier hs-type">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1646"></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Lint warning: Scrutinising floating-point expression with literal pattern in case analysis (see #9238).&quot;</span></span><span>
</span><span id="line-1647"></span><span>          </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scrut&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973016"><span class="hs-identifier hs-type">scrut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-type">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973017"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1650"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973033"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973033"><span class="hs-identifier hs-var">tycon</span></a></span></span><span>
</span><span id="line-1651"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Constants.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span>
</span><span id="line-1652"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973033"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1653"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAbstractTyCon"><span class="hs-identifier hs-var">isAbstractTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973033"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1654"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973033"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1655"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; Bool
</span><a href="GHC.Core.Opt.Arity.html#exprIsDeadEnd"><span class="hs-identifier hs-var">exprIsDeadEnd</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973016"><span class="hs-identifier hs-var">scrut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1656"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; LintM () -&gt; LintM ()
forall a. String -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Trace.html#pprTrace"><span class="hs-identifier hs-var">pprTrace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Lint warning: case binder's type has no constructors&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1657"></span><span>                        </span><span class="hs-comment">-- This can legitimately happen for type families</span><span>
</span><span id="line-1658"></span><span>                      </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1659"></span><span>         </span><span id="local-6989586621682973037"><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621682973037"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span>        </span><span class="hs-comment">-- Don't use lintIdBndr on var, because unboxed tuple is legitimate</span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973038"><span class="annot"><a href="#local-6989586621682973038"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-type">getSubst</span></a></span><span>
</span><span id="line-1664"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973027"><span class="hs-identifier hs-type">var_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973021"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkScrutMsg"><span class="hs-identifier hs-type">mkScrutMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973017"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973027"><span class="hs-identifier hs-type">var_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973021"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973038"><span class="hs-identifier hs-type">subst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1665"></span><span>       </span><span class="hs-comment">-- See GHC.Core Note [Case expression invariants] item (7)</span><span>
</span><span id="line-1666"></span><span>
</span><span id="line-1667"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-type">lintBinder</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#CaseBind"><span class="hs-identifier hs-type">CaseBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973017"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1668"></span><span>       </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Check the alternatives</span><span>
</span><span id="line-1669"></span><span>          </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973042"><span class="annot"><a href="#local-6989586621682973042"><span class="hs-identifier hs-var">alt_ues</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Alt Var -&gt; LintM UsageEnv) -&gt; [Alt Var] -&gt; LintM [UsageEnv]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
-&gt; LintedType
-&gt; LintedType
-&gt; LintedType
-&gt; Alt Var
-&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintCoreAlt"><span class="hs-identifier hs-var">lintCoreAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973017"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973021"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973023"><span class="hs-identifier hs-var">scrut_mult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973024"><span class="hs-identifier hs-var">alt_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973019"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1670"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973045"><span class="annot"><a href="#local-6989586621682973045"><span class="hs-identifier hs-var hs-var">case_ue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; UsageEnv -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#scaleUE"><span class="hs-identifier hs-var">scaleUE</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973023"><span class="hs-identifier hs-var">scrut_mult</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682973022"><span class="hs-identifier hs-var">scrut_ue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; UsageEnv -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#addUE"><span class="hs-operator hs-var">`addUE`</span></a></span><span> </span><span class="annot"><span class="annottext">[UsageEnv] -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#supUEs"><span class="hs-identifier hs-var">supUEs</span></a></span><span> </span><span class="annot"><span class="annottext">[UsageEnv]
</span><a href="#local-6989586621682973042"><span class="hs-identifier hs-var">alt_ues</span></a></span><span>
</span><span id="line-1671"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkCaseAlts"><span class="hs-identifier hs-type">checkCaseAlts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973020"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973021"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973019"><span class="hs-identifier hs-type">alts</span></a></span><span>
</span><span id="line-1672"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973024"><span class="hs-identifier hs-type">alt_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682973045"><span class="hs-identifier hs-type">case_ue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1673"></span><span>
</span><span id="line-1674"></span><span class="annot"><a href="GHC.Core.Lint.html#checkCaseAlts"><span class="hs-identifier hs-type">checkCaseAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1675"></span><span class="hs-comment">-- a) Check that the alts are non-empty</span><span>
</span><span id="line-1676"></span><span class="hs-comment">-- b1) Check that the DEFAULT comes first, if it exists</span><span>
</span><span id="line-1677"></span><span class="hs-comment">-- b2) Check that the others are in increasing order</span><span>
</span><span id="line-1678"></span><span class="hs-comment">-- c) Check that there's a default for infinite types</span><span>
</span><span id="line-1679"></span><span class="hs-comment">-- NB: Algebraic cases are not necessarily exhaustive, because</span><span>
</span><span id="line-1680"></span><span class="hs-comment">--     the simplifier correctly eliminates case that can't</span><span>
</span><span id="line-1681"></span><span class="hs-comment">--     possibly match.</span><span>
</span><span id="line-1682"></span><span>
</span><span id="line-1683"></span><span id="checkCaseAlts"><span class="annot"><span class="annottext">checkCaseAlts :: CoreExpr -&gt; LintedType -&gt; [Alt Var] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkCaseAlts"><span class="hs-identifier hs-var hs-var">checkCaseAlts</span></a></span></span><span> </span><span id="local-6989586621682973048"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973048"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682973049"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973049"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682973050"><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973050"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1684"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Alt Var -&gt; Bool) -&gt; [Alt Var] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Alt Var -&gt; Bool
forall {b}. Alt b -&gt; Bool
</span><a href="#local-6989586621682973051"><span class="hs-identifier hs-var">non_deflt</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973052"><span class="hs-identifier hs-var">con_alts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonDefltMsg"><span class="hs-identifier hs-var">mkNonDefltMsg</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973048"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1685"></span><span>         </span><span class="hs-comment">-- See GHC.Core Note [Case expression invariants] item (2)</span><span>
</span><span id="line-1686"></span><span>
</span><span id="line-1687"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Alt Var] -&gt; Bool
forall {a}. [Alt a] -&gt; Bool
</span><a href="#local-6989586621682973054"><span class="hs-identifier hs-var">increasing_tag</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973052"><span class="hs-identifier hs-var">con_alts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonIncreasingAltsMsg"><span class="hs-identifier hs-var">mkNonIncreasingAltsMsg</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973048"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1688"></span><span>         </span><span class="hs-comment">-- See GHC.Core Note [Case expression invariants] item (3)</span><span>
</span><span id="line-1689"></span><span>
</span><span id="line-1690"></span><span>          </span><span class="hs-comment">-- For types Int#, Word# with an infinite (well, large!) number of</span><span>
</span><span id="line-1691"></span><span>          </span><span class="hs-comment">-- possible values, there should usually be a DEFAULT case</span><span>
</span><span id="line-1692"></span><span>          </span><span class="hs-comment">-- But (see Note [Empty case alternatives] in GHC.Core) it's ok to</span><span>
</span><span id="line-1693"></span><span>          </span><span class="hs-comment">-- have *no* case alternatives.</span><span>
</span><span id="line-1694"></span><span>          </span><span class="hs-comment">-- In effect, this is a kind of partial test. I suppose it's possible</span><span>
</span><span id="line-1695"></span><span>          </span><span class="hs-comment">-- that we might *know* that 'x' was 1 or 2, in which case</span><span>
</span><span id="line-1696"></span><span>          </span><span class="hs-comment">--   case x of { 1 -&gt; e1; 2 -&gt; e2 }</span><span>
</span><span id="line-1697"></span><span>          </span><span class="hs-comment">-- would be fine.</span><span>
</span><span id="line-1698"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe CoreExpr -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
</span><a href="#local-6989586621682973057"><span class="hs-identifier hs-var">maybe_deflt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973058"><span class="hs-identifier hs-var">is_infinite_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Alt Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973050"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1699"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#nonExhaustiveAltsMsg"><span class="hs-identifier hs-var">nonExhaustiveAltsMsg</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973048"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1700"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1701"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682973052"><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973052"><span class="hs-identifier hs-var">con_alts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973057"><span class="annot"><span class="annottext">Maybe CoreExpr
</span><a href="#local-6989586621682973057"><span class="hs-identifier hs-var">maybe_deflt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Alt Var] -&gt; ([Alt Var], Maybe CoreExpr)
forall b. [Alt b] -&gt; ([Alt b], Maybe (Expr b))
</span><a href="GHC.Core.Utils.html#findDefault"><span class="hs-identifier hs-var">findDefault</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621682973050"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span>        </span><span class="hs-comment">-- Check that successive alternatives have strictly increasing tags</span><span>
</span><span id="line-1704"></span><span>    </span><span id="local-6989586621682973054"><span class="annot"><span class="annottext">increasing_tag :: [Alt a] -&gt; Bool
</span><a href="#local-6989586621682973054"><span class="hs-identifier hs-var hs-var">increasing_tag</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973061"><span class="annot"><span class="annottext">Alt a
</span><a href="#local-6989586621682973061"><span class="hs-identifier hs-var">alt1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682973062"><span class="annot"><span class="annottext">rest :: [Alt a]
</span><a href="#local-6989586621682973062"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span> </span><span id="local-6989586621682973063"><span class="annot"><span class="annottext">Alt a
</span><a href="#local-6989586621682973063"><span class="hs-identifier hs-var">alt2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Alt a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alt a
</span><a href="#local-6989586621682973061"><span class="hs-identifier hs-var">alt1</span></a></span><span> </span><span class="annot"><span class="annottext">Alt a -&gt; Alt a -&gt; Bool
forall a. Alt a -&gt; Alt a -&gt; Bool
</span><a href="GHC.Core.html#ltAlt"><span class="hs-operator hs-var">`ltAlt`</span></a></span><span> </span><span class="annot"><span class="annottext">Alt a
</span><a href="#local-6989586621682973063"><span class="hs-identifier hs-var">alt2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Alt a] -&gt; Bool
</span><a href="#local-6989586621682973054"><span class="hs-identifier hs-var">increasing_tag</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt a]
</span><a href="#local-6989586621682973062"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1705"></span><span>    </span><span class="annot"><a href="#local-6989586621682973054"><span class="hs-identifier hs-var">increasing_tag</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt a]
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1706"></span><span>
</span><span id="line-1707"></span><span>    </span><span id="local-6989586621682973051"><span class="annot"><span class="annottext">non_deflt :: Alt b -&gt; Bool
</span><a href="#local-6989586621682973051"><span class="hs-identifier hs-var hs-var">non_deflt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1708"></span><span>    </span><span class="annot"><a href="#local-6989586621682973051"><span class="hs-identifier hs-var">non_deflt</span></a></span><span> </span><span class="annot"><span class="annottext">Alt b
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1709"></span><span>
</span><span id="line-1710"></span><span>    </span><span id="local-6989586621682973058"><span class="annot"><span class="annottext">is_infinite_ty :: Bool
</span><a href="#local-6989586621682973058"><span class="hs-identifier hs-var hs-var">is_infinite_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973049"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1711"></span><span>                        </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1712"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973066"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973066"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973066"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span class="annot"><a href="GHC.Core.Lint.html#lintAltExpr"><span class="hs-identifier hs-type">lintAltExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1715"></span><span id="lintAltExpr"><span class="annot"><span class="annottext">lintAltExpr :: CoreExpr -&gt; LintedType -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintAltExpr"><span class="hs-identifier hs-var hs-var">lintAltExpr</span></a></span></span><span> </span><span id="local-6989586621682973069"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973069"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621682973070"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973070"><span class="hs-identifier hs-var">ann_ty</span></a></span></span><span>
</span><span id="line-1716"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973071"><span class="annot"><a href="#local-6989586621682973071"><span class="hs-identifier hs-var">actual_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973072"><span class="annot"><a href="#local-6989586621682973072"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973069"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-1717"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973071"><span class="hs-identifier hs-type">actual_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973070"><span class="hs-identifier hs-type">ann_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkCaseAltMsg"><span class="hs-identifier hs-type">mkCaseAltMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973069"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973071"><span class="hs-identifier hs-type">actual_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973070"><span class="hs-identifier hs-type">ann_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682973072"><span class="hs-identifier hs-type">ue</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1719"></span><span>         </span><span class="hs-comment">-- See GHC.Core Note [Case expression invariants] item (6)</span><span>
</span><span id="line-1720"></span><span>
</span><span id="line-1721"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreAlt"><span class="hs-identifier hs-type">lintCoreAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>              </span><span class="hs-comment">-- Case binder</span><span>
</span><span id="line-1722"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>       </span><span class="hs-comment">-- Type of scrutinee</span><span>
</span><span id="line-1723"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span>             </span><span class="hs-comment">-- Multiplicity of scrutinee</span><span>
</span><span id="line-1724"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>       </span><span class="hs-comment">-- Type of the alternative</span><span>
</span><span id="line-1725"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span>
</span><span id="line-1726"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-1727"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1728"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-1729"></span><span id="lintCoreAlt"><span class="annot"><span class="annottext">lintCoreAlt :: Var
-&gt; LintedType
-&gt; LintedType
-&gt; LintedType
-&gt; Alt Var
-&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintCoreAlt"><span class="hs-identifier hs-var hs-var">lintCoreAlt</span></a></span></span><span> </span><span id="local-6989586621682973074"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973074"><span class="hs-identifier hs-var">case_bndr</span></a></span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682973075"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973075"><span class="hs-identifier hs-var">scrut_mult</span></a></span></span><span> </span><span id="local-6989586621682973076"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973076"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span id="local-6989586621682973077"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973077"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682973078"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973078"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973077"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-var">mkDefaultArgsMsg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973077"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1731"></span><span>     </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973081"><span class="annot"><a href="#local-6989586621682973081"><span class="hs-identifier hs-var">rhs_ue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintedType -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973078"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973076"><span class="hs-identifier hs-var">alt_ty</span></a></span><span>
</span><span id="line-1732"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973082"><span class="annot"><a href="#local-6989586621682973082"><span class="hs-identifier hs-var">case_bndr_usage</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973083"><span class="annot"><a href="#local-6989586621682973083"><span class="hs-identifier hs-var">rhs_ue'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#popUE"><span class="hs-identifier hs-type">popUE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973081"><span class="hs-identifier hs-type">rhs_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973074"><span class="hs-identifier hs-type">case_bndr</span></a></span><span>
</span><span id="line-1733"></span><span>           </span><span id="local-6989586621682973084"><span class="annot"><a href="#local-6989586621682973084"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Linearity failure in the DEFAULT clause:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973074"><span class="hs-identifier hs-var">case_bndr</span></a></span><span>
</span><span id="line-1734"></span><span>                     </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Usage -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="#local-6989586621682973082"><span class="hs-identifier hs-var">case_bndr_usage</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8840;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973075"><span class="hs-identifier hs-var">scrut_mult</span></a></span><span>
</span><span id="line-1735"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-type">ensureSubUsage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973082"><span class="hs-identifier hs-type">case_bndr_usage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973075"><span class="hs-identifier hs-type">scrut_mult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973084"><span class="hs-identifier hs-type">err_msg</span></a></span><span>
</span><span id="line-1736"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682973083"><span class="hs-identifier hs-type">rhs_ue'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1737"></span><span>
</span><span id="line-1738"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreAlt"><span class="hs-identifier hs-var">lintCoreAlt</span></a></span><span> </span><span id="local-6989586621682973085"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973085"><span class="hs-identifier hs-var">case_bndr</span></a></span></span><span> </span><span id="local-6989586621682973086"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973086"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682973087"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973087"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span> </span><span id="local-6989586621682973088"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682973088"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973089"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973089"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682973090"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973090"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1739"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#litIsLifted"><span class="hs-identifier hs-var">litIsLifted</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682973088"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1740"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM UsageEnv
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Core.Lint.html#integerScrutinisedMsg"><span class="hs-identifier hs-var">integerScrutinisedMsg</span></a></span><span>
</span><span id="line-1741"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1742"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973089"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-var">mkDefaultArgsMsg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973089"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-var">ensureEqTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973093"><span class="hs-identifier hs-var">lit_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973086"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadPatMsg"><span class="hs-identifier hs-var">mkBadPatMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973093"><span class="hs-identifier hs-var">lit_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973086"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1744"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973094"><span class="annot"><a href="#local-6989586621682973094"><span class="hs-identifier hs-var">rhs_ue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintedType -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973090"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973087"><span class="hs-identifier hs-var">alt_ty</span></a></span><span>
</span><span id="line-1745"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.UsageEnv.html#deleteUE"><span class="hs-identifier hs-type">deleteUE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973094"><span class="hs-identifier hs-type">rhs_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973085"><span class="hs-identifier hs-type">case_bndr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- No need for linearity checks</span><span>
</span><span id="line-1746"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1747"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1748"></span><span>    </span><span id="local-6989586621682973093"><span class="annot"><span class="annottext">lit_ty :: LintedType
</span><a href="#local-6989586621682973093"><span class="hs-identifier hs-var hs-var">lit_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; LintedType
</span><a href="GHC.Types.Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682973088"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1749"></span><span>
</span><span id="line-1750"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreAlt"><span class="hs-identifier hs-var">lintCoreAlt</span></a></span><span> </span><span id="local-6989586621682973095"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973095"><span class="hs-identifier hs-var">case_bndr</span></a></span></span><span> </span><span id="local-6989586621682973096"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973096"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682973097"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973097"><span class="hs-identifier hs-var">_scrut_mult</span></a></span></span><span> </span><span id="local-6989586621682973098"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973098"><span class="hs-identifier hs-var">alt_ty</span></a></span></span><span> </span><span id="local-6989586621682973099"><span class="annot"><span class="annottext">alt :: Alt Var
</span><a href="#local-6989586621682973099"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-type">DataAlt</span></a></span><span> </span><span id="local-6989586621682973101"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973102"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973102"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621682973103"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973103"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1751"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM () -&gt; LintM UsageEnv
forall a b. a -&gt; LintM b -&gt; LintM a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Alt Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNewTyDataConAltMsg"><span class="hs-identifier hs-var">mkNewTyDataConAltMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973096"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682973099"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1753"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973107"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973107"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973108"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973108"><span class="hs-identifier hs-var">tycon_arg_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; Maybe (TyCon, [LintedType])
LintedType -&gt; Maybe (TyCon, [LintedType])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973096"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span>
</span><span id="line-1754"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM UsageEnv -&gt; LintM UsageEnv
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alt Var -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682973099"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM UsageEnv -&gt; LintM UsageEnv)
-&gt; LintM UsageEnv -&gt; LintM UsageEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1755"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; DataCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTypeDataConOcc"><span class="hs-identifier hs-var">checkTypeDataConOcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pattern&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1756"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973107"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; DataCon -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadConMsg"><span class="hs-identifier hs-var">mkBadConMsg</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973107"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1757"></span><span>
</span><span id="line-1758"></span><span>      </span><span class="hs-comment">-- Instantiate the universally quantified</span><span>
</span><span id="line-1759"></span><span>      </span><span class="hs-comment">-- type variables of the data constructor</span><span>
</span><span id="line-1760"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973112"><span class="annot"><span class="annottext">con_payload_ty :: LintedType
</span><a href="#local-6989586621682973112"><span class="hs-identifier hs-var hs-var">con_payload_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; [LintedType] -&gt; LintedType
LintedType -&gt; [LintedType] -&gt; LintedType
</span><a href="GHC.Core.Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; LintedType
</span><a href="GHC.Core.DataCon.html#dataConRepType"><span class="hs-identifier hs-var">dataConRepType</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682973101"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973108"><span class="hs-identifier hs-var">tycon_arg_tys</span></a></span><span>
</span><span id="line-1761"></span><span>          </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973115"><span class="annot"><span class="annottext">binderMult :: PiTyBinder -&gt; LintedType
</span><a href="#local-6989586621682973115"><span class="hs-identifier hs-var hs-var">binderMult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="annottext">ForAllTyBinder
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span>
</span><span id="line-1762"></span><span>          </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621682973115"><span class="hs-identifier hs-var">binderMult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span id="local-6989586621682973118"><span class="annot"><span class="annottext">Scaled LintedType
</span><a href="#local-6989586621682973118"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled LintedType -&gt; LintedType
forall a. Scaled a -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#scaledMult"><span class="hs-identifier hs-var">scaledMult</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled LintedType
</span><a href="#local-6989586621682973118"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1763"></span><span>          </span><span class="hs-comment">-- See Note [Validating multiplicities in a case]</span><span>
</span><span id="line-1764"></span><span>          </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973120"><span class="annot"><span class="annottext">multiplicities :: [LintedType]
</span><a href="#local-6989586621682973120"><span class="hs-identifier hs-var hs-var">multiplicities</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PiTyBinder -&gt; LintedType) -&gt; [PiTyBinder] -&gt; [LintedType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PiTyBinder -&gt; LintedType
</span><a href="#local-6989586621682973115"><span class="hs-identifier hs-var">binderMult</span></a></span><span> </span><span class="annot"><span class="annottext">([PiTyBinder] -&gt; [LintedType]) -&gt; [PiTyBinder] -&gt; [LintedType]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([PiTyBinder], LintedType) -&gt; [PiTyBinder]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([PiTyBinder], LintedType) -&gt; [PiTyBinder])
-&gt; ([PiTyBinder], LintedType) -&gt; [PiTyBinder]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; ([PiTyBinder], LintedType)
</span><a href="GHC.Core.Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973112"><span class="hs-identifier hs-var">con_payload_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1765"></span><span>
</span><span id="line-1766"></span><span>        </span><span class="hs-comment">-- And now bring the new binders into scope</span><span>
</span><span id="line-1767"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM UsageEnv) -&gt; LintM UsageEnv
forall a. BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#CasePatBind"><span class="hs-identifier hs-var">CasePatBind</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973102"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM UsageEnv) -&gt; LintM UsageEnv)
-&gt; ([Var] -&gt; LintM UsageEnv) -&gt; LintM UsageEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682973123"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973123"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1768"></span><span>      </span><span class="hs-special">{</span><span>
</span><span id="line-1769"></span><span>        </span><span id="local-6989586621682973124"><span class="annot"><a href="#local-6989586621682973124"><span class="hs-identifier hs-var">rhs_ue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintedType -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#lintAltExpr"><span class="hs-identifier hs-var">lintAltExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973103"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973098"><span class="hs-identifier hs-var">alt_ty</span></a></span><span>
</span><span id="line-1770"></span><span>      </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973125"><span class="annot"><a href="#local-6989586621682973125"><span class="hs-identifier hs-var">rhs_ue'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#CasePat"><span class="hs-identifier hs-type">CasePat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973099"><span class="hs-identifier hs-type">alt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lintAltBinders"><span class="hs-identifier hs-type">lintAltBinders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973124"><span class="hs-identifier hs-type">rhs_ue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973095"><span class="hs-identifier hs-type">case_bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973096"><span class="hs-identifier hs-type">scrut_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973112"><span class="hs-identifier hs-type">con_payload_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#zipEqual"><span class="hs-identifier hs-type">zipEqual</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;lintCoreAlt&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682973120"><span class="hs-identifier hs-type">multiplicities</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621682973123"><span class="hs-identifier hs-type">args'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1771"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#deleteUE"><span class="hs-identifier hs-type">deleteUE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973125"><span class="hs-identifier hs-type">rhs_ue'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973095"><span class="hs-identifier hs-type">case_bndr</span></a></span><span>
</span><span id="line-1772"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-1773"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-1774"></span><span>
</span><span id="line-1775"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-comment">-- Scrut-ty is wrong shape</span><span>
</span><span id="line-1776"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; LintM () -&gt; LintM UsageEnv
forall a b. a -&gt; LintM b -&gt; LintM a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Alt Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadAltMsg"><span class="hs-identifier hs-var">mkBadAltMsg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973096"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682973099"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1777"></span><span>
</span><span id="line-1778"></span><span class="hs-comment">{-
Note [Validating multiplicities in a case]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose 'MkT :: a %m -&gt; T m a'.
If we are validating 'case (x :: T Many a) of MkT y -&gt; ...',
we have to substitute m := Many in the type of MkT - in particular,
y can be used Many times and that expression would still be linear in x.
We do this by looking at con_payload_ty, which is the type of the datacon
applied to the surrounding arguments.
Testcase: linear/should_compile/MultConstructor

Data constructors containing existential tyvars will then have
Named binders, which are always multiplicity Many.
Testcase: indexed-types/should_compile/GADT1
-}</span><span>
</span><span id="line-1793"></span><span>
</span><span id="line-1794"></span><span class="annot"><a href="GHC.Core.Lint.html#lintLinearBinder"><span class="hs-identifier hs-type">lintLinearBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1795"></span><span id="lintLinearBinder"><span class="annot"><span class="annottext">lintLinearBinder :: SDoc -&gt; LintedType -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintLinearBinder"><span class="hs-identifier hs-var hs-var">lintLinearBinder</span></a></span></span><span> </span><span id="local-6989586621682973129"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973129"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621682973130"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973130"><span class="hs-identifier hs-var">actual_usage</span></a></span></span><span> </span><span id="local-6989586621682973131"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973131"><span class="hs-identifier hs-var">described_usage</span></a></span></span><span>
</span><span id="line-1796"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubMult"><span class="hs-identifier hs-var">ensureSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973130"><span class="hs-identifier hs-var">actual_usage</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973131"><span class="hs-identifier hs-var">described_usage</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973133"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-1797"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1798"></span><span>      </span><span id="local-6989586621682973133"><span class="annot"><span class="annottext">err_msg :: SDoc
</span><a href="#local-6989586621682973133"><span class="hs-identifier hs-var hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplicity of variable does not agree with its context&quot;</span></span><span>
</span><span id="line-1799"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973129"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1800"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973130"><span class="hs-identifier hs-var">actual_usage</span></a></span><span>
</span><span id="line-1801"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Annotation:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973131"><span class="hs-identifier hs-var">described_usage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1802"></span><span>
</span><span id="line-1803"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lint-types]{Types}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1810"></span><span>
</span><span id="line-1811"></span><span class="hs-comment">-- When we lint binders, we (one at a time and in order):</span><span>
</span><span id="line-1812"></span><span class="hs-comment">--  1. Lint var types or kinds (possibly substituting)</span><span>
</span><span id="line-1813"></span><span class="hs-comment">--  2. Add the binder to the in scope set, and if its a coercion var,</span><span>
</span><span id="line-1814"></span><span class="hs-comment">--     we may extend the substitution to reflect its (possibly) new kind</span><span>
</span><span id="line-1815"></span><span id="local-6989586621682970513"><span class="annot"><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-type">lintBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#BindingSite"><span class="hs-identifier hs-type">BindingSite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970513"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970513"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1816"></span><span id="lintBinders"><span class="annot"><span class="annottext">lintBinders :: forall a. BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var hs-var">lintBinders</span></a></span></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span id="local-6989586621682973134"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973134"><span class="hs-identifier hs-var">linterF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973134"><span class="hs-identifier hs-var">linterF</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1817"></span><span class="annot"><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a></span><span> </span><span id="local-6989586621682973135"><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973135"><span class="hs-identifier hs-var">site</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973136"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973136"><span class="hs-identifier hs-var">var</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682973137"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973137"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973138"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973138"><span class="hs-identifier hs-var">linterF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a. BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-var">lintBinder</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973135"><span class="hs-identifier hs-var">site</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973136"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">((Var -&gt; LintM a) -&gt; LintM a) -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973139"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973139"><span class="hs-identifier hs-var">var'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1818"></span><span>                                      </span><span class="annot"><span class="annottext">BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
forall a. BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973135"><span class="hs-identifier hs-var">site</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973137"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM a) -&gt; LintM a) -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682973140"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973140"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1819"></span><span>                                      </span><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973138"><span class="hs-identifier hs-var">linterF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973139"><span class="hs-identifier hs-var">var'</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973140"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1820"></span><span>
</span><span id="line-1821"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1822"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-1823"></span><span id="local-6989586621682970444"><span class="annot"><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-type">lintBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#BindingSite"><span class="hs-identifier hs-type">BindingSite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970444"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1824"></span><span id="lintBinder"><span class="annot"><span class="annottext">lintBinder :: forall a. BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinder"><span class="hs-identifier hs-var hs-var">lintBinder</span></a></span></span><span> </span><span id="local-6989586621682973141"><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973141"><span class="hs-identifier hs-var">site</span></a></span></span><span> </span><span id="local-6989586621682973142"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973142"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682973143"><span class="annot"><span class="annottext">Var -&gt; LintM a
</span><a href="#local-6989586621682973143"><span class="hs-identifier hs-var">linterF</span></a></span></span><span>
</span><span id="line-1825"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973142"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a. Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-var">lintTyCoBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973142"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM a
</span><a href="#local-6989586621682973143"><span class="hs-identifier hs-var">linterF</span></a></span><span>
</span><span id="line-1826"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a.
TopLevelFlag -&gt; BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintIdBndr"><span class="hs-identifier hs-var">lintIdBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#NotTopLevel"><span class="hs-identifier hs-var">NotTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973141"><span class="hs-identifier hs-var">site</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973142"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintM a
</span><a href="#local-6989586621682973143"><span class="hs-identifier hs-var">linterF</span></a></span><span>
</span><span id="line-1827"></span><span>
</span><span id="line-1828"></span><span id="local-6989586621682970441"><span class="annot"><a href="GHC.Core.Lint.html#lintTyBndr"><span class="hs-identifier hs-type">lintTyBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedTyCoVar"><span class="hs-identifier hs-type">LintedTyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970441"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970441"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1829"></span><span id="lintTyBndr"><span class="annot"><span class="annottext">lintTyBndr :: forall a. Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintTyBndr"><span class="hs-identifier hs-var hs-var">lintTyBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a. Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-var">lintTyCoBndr</span></a></span><span>  </span><span class="hs-comment">-- We could specialise it, I guess</span><span>
</span><span id="line-1830"></span><span>
</span><span id="line-1831"></span><span id="local-6989586621682973148"><span class="annot"><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-type">lintTyCoBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintedTyCoVar"><span class="hs-identifier hs-type">LintedTyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973148"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1832"></span><span id="lintTyCoBndr"><span class="annot"><span class="annottext">lintTyCoBndr :: forall a. Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-var hs-var">lintTyCoBndr</span></a></span></span><span> </span><span id="local-6989586621682973164"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973164"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span id="local-6989586621682973165"><span class="annot"><span class="annottext">Var -&gt; LintM a
</span><a href="#local-6989586621682973165"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1833"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973166"><span class="annot"><a href="#local-6989586621682973166"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Subst
</span><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-var">getSubst</span></a></span><span>
</span><span id="line-1834"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973167"><span class="annot"><a href="#local-6989586621682973167"><span class="hs-identifier hs-var">tcv_type'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973164"><span class="hs-identifier hs-type">tcv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1835"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973169"><span class="annot"><a href="#local-6989586621682973169"><span class="hs-identifier hs-var hs-var">tcv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; InScopeSet
</span><a href="GHC.Core.TyCo.Subst.html#getSubstInScope"><span class="hs-identifier hs-var">getSubstInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973166"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Var) -&gt; Var -&gt; Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1836"></span><span>                    </span><span class="annot"><span class="annottext">Var -&gt; LintedType -&gt; Var
</span><a href="GHC.Types.Var.html#setVarType"><span class="hs-identifier hs-var">setVarType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973164"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973167"><span class="hs-identifier hs-var">tcv_type'</span></a></span><span>
</span><span id="line-1837"></span><span>             </span><span id="local-6989586621682973173"><span class="annot"><a href="#local-6989586621682973173"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; Var -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier hs-var">extendTCvSubstWithClone</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973166"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973164"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973169"><span class="hs-identifier hs-var">tcv'</span></a></span><span>
</span><span id="line-1838"></span><span>
</span><span id="line-1839"></span><span>       </span><span class="hs-comment">-- See (FORALL1) and (FORALL2) in GHC.Core.Type</span><span>
</span><span id="line-1840"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-type">isTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973164"><span class="hs-identifier hs-type">tcv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1841"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- Check that in (forall (a:ki). blah) we have ki:Type</span><span>
</span><span id="line-1842"></span><span>              </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isLiftedTypeKind"><span class="hs-identifier hs-type">isLiftedTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973167"><span class="hs-identifier hs-type">tcv_type'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1843"></span><span>              </span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;TyVar whose kind does not have kind Type:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1844"></span><span>                 </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973169"><span class="hs-identifier hs-type">tcv'</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973167"><span class="hs-identifier hs-type">tcv_type'</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973167"><span class="hs-identifier hs-type">tcv_type'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1845"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- Check that in (forall (cv::ty). blah),</span><span>
</span><span id="line-1846"></span><span>              </span><span class="hs-comment">-- then ty looks like (t1 ~# t2)</span><span>
</span><span id="line-1847"></span><span>              </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#isCoVarType"><span class="hs-identifier hs-type">isCoVarType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973167"><span class="hs-identifier hs-type">tcv_type'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1848"></span><span>              </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;CoVar with non-coercion type:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTyVar"><span class="hs-identifier hs-type">pprTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973164"><span class="hs-identifier hs-type">tcv</span></a></span><span>
</span><span id="line-1849"></span><span>
</span><span id="line-1850"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#updateSubst"><span class="hs-identifier hs-type">updateSubst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973173"><span class="hs-identifier hs-type">subst'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973165"><span class="hs-identifier hs-type">thing_inside</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973169"><span class="hs-identifier hs-type">tcv'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1851"></span><span>
</span><span id="line-1852"></span><span class="annot"><a href="GHC.Core.Lint.html#lintIdBndrs"><span class="hs-identifier hs-type">lintIdBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682970393"><span class="annot"><a href="#local-6989586621682970393"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedId"><span class="hs-identifier hs-type">LintedId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970393"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1853"></span><span id="lintIdBndrs"><span class="annot"><span class="annottext">lintIdBndrs :: forall a. TopLevelFlag -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintIdBndrs"><span class="hs-identifier hs-var hs-var">lintIdBndrs</span></a></span></span><span> </span><span id="local-6989586621682973178"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682973178"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621682973179"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973179"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621682973180"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973180"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1854"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="#local-6989586621682973181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973179"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973180"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1855"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1856"></span><span>    </span><span class="annot"><a href="#local-6989586621682973181"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970393"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1857"></span><span>    </span><span id="local-6989586621682973181"><span class="annot"><span class="annottext">go :: [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="#local-6989586621682973181"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621682973182"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973182"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973182"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1858"></span><span>    </span><span class="annot"><a href="#local-6989586621682973181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973183"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973183"><span class="hs-identifier hs-var">id</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682973184"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973184"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973185"><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973185"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a.
TopLevelFlag -&gt; BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintIdBndr"><span class="hs-identifier hs-var">lintIdBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682973178"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973183"><span class="hs-identifier hs-var">id</span></a></span><span>  </span><span class="annot"><span class="annottext">((Var -&gt; LintM a) -&gt; LintM a) -&gt; (Var -&gt; LintM a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973186"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973186"><span class="hs-identifier hs-var">id'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1859"></span><span>                               </span><span class="annot"><span class="annottext">[Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="#local-6989586621682973181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973184"><span class="hs-identifier hs-var">ids</span></a></span><span>                         </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM a) -&gt; LintM a) -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973187"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973187"><span class="hs-identifier hs-var">ids'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1860"></span><span>                               </span><span class="annot"><span class="annottext">[Var] -&gt; LintM a
</span><a href="#local-6989586621682973185"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973186"><span class="hs-identifier hs-var">id'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973187"><span class="hs-identifier hs-var">ids'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1861"></span><span>
</span><span id="line-1862"></span><span id="local-6989586621682970518"><span class="annot"><a href="GHC.Core.Lint.html#lintIdBndr"><span class="hs-identifier hs-type">lintIdBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#BindingSite"><span class="hs-identifier hs-type">BindingSite</span></a></span><span>
</span><span id="line-1863"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InVar"><span class="hs-identifier hs-type">InVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970518"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970518"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1864"></span><span class="hs-comment">-- Do substitution on the type of a binder and add the var with this</span><span>
</span><span id="line-1865"></span><span class="hs-comment">-- new type to the in-scope set of the second argument</span><span>
</span><span id="line-1866"></span><span class="hs-comment">-- ToDo: lint its rules</span><span>
</span><span id="line-1867"></span><span id="lintIdBndr"><span class="annot"><span class="annottext">lintIdBndr :: forall a.
TopLevelFlag -&gt; BindingSite -&gt; Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintIdBndr"><span class="hs-identifier hs-var hs-var">lintIdBndr</span></a></span></span><span> </span><span id="local-6989586621682973226"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682973226"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621682973227"><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973227"><span class="hs-identifier hs-var">bind_site</span></a></span></span><span> </span><span id="local-6989586621682973228"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973228"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682973229"><span class="annot"><span class="annottext">Var -&gt; LintM a
</span><a href="#local-6989586621682973229"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1868"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM a -&gt; LintM a
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isId"><span class="hs-identifier hs-var">isId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973228"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973228"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM a -&gt; LintM a) -&gt; LintM a -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1869"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973230"><span class="annot"><a href="#local-6989586621682973230"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-1870"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_global_ids"><span class="hs-identifier hs-var">lf_check_global_ids</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973230"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#isLocalId"><span class="hs-identifier hs-type">isLocalId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1871"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-local Id binder&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>                </span><span class="hs-comment">-- See Note [Checking for global Ids]</span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span>       </span><span class="hs-comment">-- Check that if the binder is nested, it is not marked as exported</span><span>
</span><span id="line-1875"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#isExportedId"><span class="hs-identifier hs-type">isExportedId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682973234"><span class="hs-identifier hs-type">is_top_lvl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1876"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkNonTopExportedMsg"><span class="hs-identifier hs-type">mkNonTopExportedMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1877"></span><span>
</span><span id="line-1878"></span><span>       </span><span class="hs-comment">-- Check that if the binder is nested, it does not have an external name</span><span>
</span><span id="line-1879"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#isExternalName"><span class="hs-identifier hs-type">isExternalName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">Var.varName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682973234"><span class="hs-identifier hs-type">is_top_lvl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1880"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkNonTopExternalNameMsg"><span class="hs-identifier hs-type">mkNonTopExternalNameMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1881"></span><span>
</span><span id="line-1882"></span><span>          </span><span class="hs-comment">-- See Note [Representation polymorphism invariants] in GHC.Core</span><span>
</span><span id="line-1883"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-type">isJoinId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_fixed_rep"><span class="hs-identifier hs-var">lf_check_fixed_rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973230"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1884"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-type">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1885"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Binder does not have a fixed runtime representation:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-1886"></span><span>            </span><span class="annot"><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-type">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1887"></span><span>
</span><span id="line-1888"></span><span>       </span><span class="hs-comment">-- Check that a join-id is a not-top-level let-binding</span><span>
</span><span id="line-1889"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-type">isJoinId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1890"></span><span>         </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621682973234"><span class="hs-identifier hs-type">is_top_lvl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682973238"><span class="hs-identifier hs-type">is_let_bind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1891"></span><span>         </span><span class="annot"><a href="GHC.Core.Lint.html#mkBadJoinBindMsg"><span class="hs-identifier hs-type">mkBadJoinBindMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span>
</span><span id="line-1892"></span><span>
</span><span id="line-1893"></span><span>       </span><span class="hs-comment">-- Check that the Id does not have type (t1 ~# t2) or (t1 ~R# t2);</span><span>
</span><span id="line-1894"></span><span>       </span><span class="hs-comment">-- if so, it should be a CoVar, and checked by lintCoVarBndr</span><span>
</span><span id="line-1895"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Predicate.html#isCoVarType"><span class="hs-identifier hs-type">isCoVarType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1896"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-CoVar has coercion type&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1897"></span><span>
</span><span id="line-1898"></span><span>       </span><span class="hs-comment">-- Check that the lambda binder has no value or OtherCon unfolding.</span><span>
</span><span id="line-1899"></span><span>       </span><span class="hs-comment">-- See #21496</span><span>
</span><span id="line-1900"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973227"><span class="hs-identifier hs-type">bind_site</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#LambdaBind"><span class="hs-identifier hs-type">LambdaBind</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.html#isEvaldUnfolding"><span class="hs-identifier hs-type">isEvaldUnfolding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idUnfolding"><span class="hs-identifier hs-type">idUnfolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1901"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Lambda binder with value or OtherCon unfolding.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1902"></span><span>
</span><span id="line-1903"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973241"><span class="annot"><a href="#local-6989586621682973241"><span class="hs-identifier hs-var">linted_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#IdTy"><span class="hs-identifier hs-type">IdTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lintValueType"><span class="hs-identifier hs-type">lintValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973237"><span class="hs-identifier hs-type">id_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addInScopeId"><span class="hs-identifier hs-type">addInScopeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973241"><span class="hs-identifier hs-type">linted_ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1906"></span><span>         </span><span class="annot"><a href="#local-6989586621682973229"><span class="hs-identifier hs-type">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#setIdType"><span class="hs-identifier hs-type">setIdType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973228"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973241"><span class="hs-identifier hs-type">linted_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1907"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1908"></span><span>    </span><span id="local-6989586621682973237"><span class="annot"><span class="annottext">id_ty :: LintedType
</span><a href="#local-6989586621682973237"><span class="hs-identifier hs-var hs-var">id_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973228"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1909"></span><span>
</span><span id="line-1910"></span><span>    </span><span id="local-6989586621682973234"><span class="annot"><span class="annottext">is_top_lvl :: Bool
</span><a href="#local-6989586621682973234"><span class="hs-identifier hs-var hs-var">is_top_lvl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621682973226"><span class="hs-identifier hs-var">top_lvl</span></a></span><span>
</span><span id="line-1911"></span><span>    </span><span id="local-6989586621682973238"><span class="annot"><span class="annottext">is_let_bind :: Bool
</span><a href="#local-6989586621682973238"><span class="hs-identifier hs-var hs-var">is_let_bind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="#local-6989586621682973227"><span class="hs-identifier hs-var">bind_site</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1912"></span><span>                    </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1913"></span><span>                    </span><span class="annot"><span class="annottext">BindingSite
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1914"></span><span>
</span><span id="line-1915"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
             Types
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-1922"></span><span>
</span><span id="line-1923"></span><span class="annot"><a href="GHC.Core.Lint.html#lintValueType"><span class="hs-identifier hs-type">lintValueType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-1924"></span><span class="hs-comment">-- Types only, not kinds</span><span>
</span><span id="line-1925"></span><span class="hs-comment">-- Check the type, and apply the substitution to it</span><span>
</span><span id="line-1926"></span><span class="hs-comment">-- See Note [Linting type lets]</span><span>
</span><span id="line-1927"></span><span id="lintValueType"><span class="annot"><span class="annottext">lintValueType :: LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintValueType"><span class="hs-identifier hs-var hs-var">lintValueType</span></a></span></span><span> </span><span id="local-6989586621682973244"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973244"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1928"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM LintedType -&gt; LintM LintedType
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#InType"><span class="hs-identifier hs-var">InType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973244"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM LintedType -&gt; LintM LintedType)
-&gt; LintM LintedType -&gt; LintM LintedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1929"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973246"><span class="annot"><a href="#local-6989586621682973246"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973244"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1930"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973247"><span class="annot"><a href="#local-6989586621682973247"><span class="hs-identifier hs-var hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973246"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1931"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-type">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973247"><span class="hs-identifier hs-type">sk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1932"></span><span>          </span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Ill-kinded type:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973244"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1933"></span><span>             </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;has kind:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973247"><span class="hs-identifier hs-type">sk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1934"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682973246"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1935"></span><span>
</span><span id="line-1936"></span><span class="annot"><a href="GHC.Core.Lint.html#checkTyCon"><span class="hs-identifier hs-type">checkTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1937"></span><span id="checkTyCon"><span class="annot"><span class="annottext">checkTyCon :: TyCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCon"><span class="hs-identifier hs-var hs-var">checkTyCon</span></a></span></span><span> </span><span id="local-6989586621682973250"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973250"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-1938"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTcTyCon"><span class="hs-identifier hs-var">isTcTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973250"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Found TcTyCon:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973250"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1939"></span><span>
</span><span id="line-1940"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-1941"></span><span class="annot"><a href="GHC.Core.Lint.html#checkTyCoVarInScope"><span class="hs-identifier hs-type">checkTyCoVarInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1942"></span><span id="checkTyCoVarInScope"><span class="annot"><span class="annottext">checkTyCoVarInScope :: Subst -&gt; Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCoVarInScope"><span class="hs-identifier hs-var hs-var">checkTyCoVarInScope</span></a></span></span><span> </span><span id="local-6989586621682973253"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973253"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621682973254"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973254"><span class="hs-identifier hs-var">tcv</span></a></span></span><span>
</span><span id="line-1943"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973254"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Subst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-operator hs-var">`isInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973253"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1944"></span><span>    </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The type or coercion variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; Var -&gt; SDoc
forall a. OutputableBndr a =&gt; BindingSite -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973254"><span class="hs-identifier hs-var">tcv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1945"></span><span>       </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is out of scope&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1946"></span><span>
</span><span id="line-1947"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-1948"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-1949"></span><span>
</span><span id="line-1950"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-1951"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-1952"></span><span id="lintType"><span class="annot"><span class="annottext">lintType :: LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var hs-var">lintType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621682973258"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973258"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1953"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973258"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1954"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadTyVarMsg"><span class="hs-identifier hs-var">mkBadTyVarMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973258"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1955"></span><span>
</span><span id="line-1956"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1957"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973260"><span class="annot"><a href="#local-6989586621682973260"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Subst
</span><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-var">getSubst</span></a></span><span>
</span><span id="line-1958"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier hs-type">lookupTyVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973260"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973258"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1959"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973262"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973262"><span class="hs-identifier hs-var">linted_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973262"><span class="hs-identifier hs-var">linted_ty</span></a></span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span>           </span><span class="hs-comment">-- In GHCi we may lint an expression with a free</span><span>
</span><span id="line-1962"></span><span>           </span><span class="hs-comment">-- type variable.  Then it won't be in the</span><span>
</span><span id="line-1963"></span><span>           </span><span class="hs-comment">-- substitution, but it should be in scope</span><span>
</span><span id="line-1964"></span><span>           </span><span class="annot"><span class="annottext">Maybe LintedType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCoVarInScope"><span class="hs-identifier hs-var">checkTyCoVarInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973260"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973258"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1965"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973258"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1966"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-1967"></span><span>
</span><span id="line-1968"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span id="local-6989586621682973263"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682973263"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621682973265"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973265"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973266"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973266"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1969"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973265"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1970"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM LintedType) -&gt; SDoc -&gt; LintM LintedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TyConApp to the left of AppTy:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973263"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1971"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1972"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973268"><span class="annot"><a href="#local-6989586621682973268"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973265"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1973"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973269"><span class="annot"><a href="#local-6989586621682973269"><span class="hs-identifier hs-var">t2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973266"><span class="hs-identifier hs-type">t2</span></a></span><span>
</span><span id="line-1974"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-type">lint_ty_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973263"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973268"><span class="hs-identifier hs-type">t1'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682973269"><span class="hs-identifier hs-type">t2'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1975"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973268"><span class="hs-identifier hs-type">t1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973269"><span class="hs-identifier hs-type">t2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1976"></span><span>
</span><span id="line-1977"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span id="local-6989586621682973271"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682973271"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621682973272"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682973273"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973273"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1978"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeSynonymTyCon"><span class="hs-identifier hs-var">isTypeSynonymTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1979"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973276"><span class="annot"><a href="#local-6989586621682973276"><span class="hs-identifier hs-var">report_unsat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_report_unsat_syns"><span class="hs-identifier hs-var">lf_report_unsat_syns</span></a></span><span> </span><span class="annot"><span class="annottext">(LintFlags -&gt; Bool) -&gt; LintM LintFlags -&gt; LintM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-1980"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintTySynFamApp"><span class="hs-identifier hs-type">lintTySynFamApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973276"><span class="hs-identifier hs-type">report_unsat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973271"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973272"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973273"><span class="hs-identifier hs-type">tys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1981"></span><span>
</span><span id="line-1982"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; TyCon -&gt; [LintedType] -&gt; Maybe LintedType
TyCon -&gt; [LintedType] -&gt; Maybe LintedType
</span><a href="GHC.Core.Type.html#tyConAppFunTy_maybe"><span class="hs-identifier hs-var">tyConAppFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973273"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1983"></span><span>    </span><span class="hs-comment">-- We should never see a saturated application of funTyCon; such</span><span>
</span><span id="line-1984"></span><span>    </span><span class="hs-comment">-- applications should be represented with the FunTy constructor.</span><span>
</span><span id="line-1985"></span><span>    </span><span class="hs-comment">-- See Note [Linting function types]</span><span>
</span><span id="line-1986"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Saturated application of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973271"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1987"></span><span>
</span><span id="line-1988"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-comment">-- Data types, data families, primitive types</span><span>
</span><span id="line-1989"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCon"><span class="hs-identifier hs-var">checkTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973272"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1990"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973280"><span class="annot"><a href="#local-6989586621682973280"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LintedType -&gt; LintM LintedType)
-&gt; [LintedType] -&gt; LintM [LintedType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973273"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1991"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-type">lint_ty_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973271"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973272"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973280"><span class="hs-identifier hs-type">tys'</span></a></span><span>
</span><span id="line-1992"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973272"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973280"><span class="hs-identifier hs-type">tys'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1993"></span><span>
</span><span id="line-1994"></span><span class="hs-comment">-- arrows can related *unlifted* kinds, so this has to be separate from</span><span>
</span><span id="line-1995"></span><span class="hs-comment">-- a dependent forall.</span><span>
</span><span id="line-1996"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span id="local-6989586621682973282"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682973282"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span id="local-6989586621682973284"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682973284"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621682973285"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973285"><span class="hs-identifier hs-var">tw</span></a></span></span><span> </span><span id="local-6989586621682973286"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973286"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973287"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973287"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1997"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973288"><span class="annot"><a href="#local-6989586621682973288"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973286"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1998"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973289"><span class="annot"><a href="#local-6989586621682973289"><span class="hs-identifier hs-var">t2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973287"><span class="hs-identifier hs-type">t2</span></a></span><span>
</span><span id="line-1999"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973290"><span class="annot"><a href="#local-6989586621682973290"><span class="hs-identifier hs-var">tw'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973285"><span class="hs-identifier hs-type">tw</span></a></span><span>
</span><span id="line-2000"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintArrow"><span class="hs-identifier hs-type">lintArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;type or kind&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-type">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973282"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973288"><span class="hs-identifier hs-type">t1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973289"><span class="hs-identifier hs-type">t2'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973290"><span class="hs-identifier hs-type">tw'</span></a></span><span>
</span><span id="line-2001"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973292"><span class="annot"><a href="#local-6989586621682973292"><span class="hs-identifier hs-var hs-var">real_af</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType -&gt; FunTyFlag
LintedType -&gt; LintedType -&gt; FunTyFlag
</span><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-var">chooseFunTyFlag</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973286"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973287"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2002"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973292"><span class="hs-identifier hs-type">real_af</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682973284"><span class="hs-identifier hs-type">af</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-type">addErrL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2003"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Bad FunTyFlag in FunTy&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2004"></span><span>            </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973282"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-2005"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;FunTyFlag =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973284"><span class="hs-identifier hs-type">af</span></a></span><span>
</span><span id="line-2006"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Computed FunTyFlag =&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973292"><span class="hs-identifier hs-type">real_af</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2007"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973284"><span class="hs-identifier hs-type">af</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973290"><span class="hs-identifier hs-type">tw'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973288"><span class="hs-identifier hs-type">t1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973289"><span class="hs-identifier hs-type">t2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2008"></span><span>
</span><span id="line-2009"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span id="local-6989586621682973294"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682973294"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682973297"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973297"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span id="local-6989586621682973298"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682973298"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973299"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973299"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2010"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973297"><span class="hs-identifier hs-var">tcv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2011"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-Tyvar or Non-Covar bound in type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973294"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2013"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; (Var -&gt; LintM LintedType) -&gt; LintM LintedType
forall a. Var -&gt; (Var -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-var">lintTyCoBndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973297"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="annot"><span class="annottext">((Var -&gt; LintM LintedType) -&gt; LintM LintedType)
-&gt; (Var -&gt; LintM LintedType) -&gt; LintM LintedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973300"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973300"><span class="hs-identifier hs-var">tcv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2014"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973301"><span class="annot"><a href="#local-6989586621682973301"><span class="hs-identifier hs-var">body_ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973299"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-2015"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintForAllBody"><span class="hs-identifier hs-type">lintForAllBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973300"><span class="hs-identifier hs-type">tcv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973301"><span class="hs-identifier hs-type">body_ty'</span></a></span><span>
</span><span id="line-2016"></span><span>
</span><span id="line-2017"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-type">isCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973297"><span class="hs-identifier hs-type">tcv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2018"></span><span>         </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973297"><span class="hs-identifier hs-type">tcv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-type">`elemVarSet`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-type">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973299"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2019"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Covar does not occur in the body:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973297"><span class="hs-identifier hs-type">tcv</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973299"><span class="hs-identifier hs-type">body_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>         </span><span class="hs-comment">-- See GHC.Core.TyCo.Rep Note [Unused coercion variable in ForAllTy]</span><span>
</span><span id="line-2021"></span><span>
</span><span id="line-2022"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973300"><span class="hs-identifier hs-type">tcv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973298"><span class="hs-identifier hs-type">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973301"><span class="hs-identifier hs-type">body_ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2023"></span><span>
</span><span id="line-2024"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span id="local-6989586621682973305"><span class="annot"><span class="annottext">ty :: LintedType
</span><a href="#local-6989586621682973305"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621682973307"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682973307"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2025"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintTyLit"><span class="hs-identifier hs-var">lintTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621682973307"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973305"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2026"></span><span>
</span><span id="line-2027"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621682973310"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973310"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682973311"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973311"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2028"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973312"><span class="annot"><a href="#local-6989586621682973312"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973310"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2029"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973313"><span class="annot"><a href="#local-6989586621682973313"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintStarCoercion"><span class="hs-identifier hs-type">lintStarCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973311"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2030"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973315"><span class="annot"><a href="#local-6989586621682973315"><span class="hs-identifier hs-var hs-var">tyk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973312"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2031"></span><span>             </span><span id="local-6989586621682973316"><span class="annot"><a href="#local-6989586621682973316"><span class="hs-identifier hs-var hs-var">cok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; LintedType
Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973313"><span class="hs-identifier hs-var">co'</span></a></span><span>
</span><span id="line-2032"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973315"><span class="hs-identifier hs-type">tyk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973316"><span class="hs-identifier hs-type">cok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#mkCastTyErr"><span class="hs-identifier hs-type">mkCastTyErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973310"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973311"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973315"><span class="hs-identifier hs-type">tyk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973316"><span class="hs-identifier hs-type">cok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2033"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973312"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973313"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2034"></span><span>
</span><span id="line-2035"></span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621682973320"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973320"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2036"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973321"><span class="annot"><a href="#local-6989586621682973321"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973320"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2037"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973321"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2038"></span><span>
</span><span id="line-2039"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2040"></span><span class="annot"><a href="GHC.Core.Lint.html#lintForAllBody"><span class="hs-identifier hs-type">lintForAllBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedTyCoVar"><span class="hs-identifier hs-type">LintedTyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2041"></span><span class="hs-comment">-- Do the checks for the body of a forall-type</span><span>
</span><span id="line-2042"></span><span id="lintForAllBody"><span class="annot"><span class="annottext">lintForAllBody :: Var -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintForAllBody"><span class="hs-identifier hs-var hs-var">lintForAllBody</span></a></span></span><span> </span><span id="local-6989586621682973322"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973322"><span class="hs-identifier hs-var">tcv</span></a></span></span><span> </span><span id="local-6989586621682973323"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973323"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span>
</span><span id="line-2043"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-var">checkValueType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973323"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;the body of forall:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973323"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2044"></span><span>
</span><span id="line-2045"></span><span>         </span><span class="hs-comment">-- For type variables, check for skolem escape</span><span>
</span><span id="line-2046"></span><span>         </span><span class="hs-comment">-- See Note [Phantom type variables in kinds] in GHC.Core.Type</span><span>
</span><span id="line-2047"></span><span>         </span><span class="hs-comment">-- The kind of (forall cv. th) is liftedTypeKind, so no</span><span>
</span><span id="line-2048"></span><span>         </span><span class="hs-comment">-- need to check for skolem-escape in the CoVar case</span><span>
</span><span id="line-2049"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973324"><span class="annot"><span class="annottext">body_kind :: LintedType
</span><a href="#local-6989586621682973324"><span class="hs-identifier hs-var hs-var">body_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973323"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-2050"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973322"><span class="hs-identifier hs-var">tcv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2051"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; LintedType -&gt; Maybe LintedType
</span><a href="GHC.Core.TyCo.FVs.html#occCheckExpand"><span class="hs-identifier hs-var">occCheckExpand</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973322"><span class="hs-identifier hs-var">tcv</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973324"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2052"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2053"></span><span>           </span><span class="annot"><span class="annottext">Maybe LintedType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2054"></span><span>                      </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Variable escape in forall:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2055"></span><span>                         </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tyvar:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973322"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-2056"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973323"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-2057"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kind:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973324"><span class="hs-identifier hs-var">body_kind</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2058"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-2059"></span><span>
</span><span id="line-2060"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2061"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTySynFamApp"><span class="hs-identifier hs-type">lintTySynFamApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#InType"><span class="hs-identifier hs-type">InType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#InType"><span class="hs-identifier hs-type">InType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span>
</span><span id="line-2062"></span><span class="hs-comment">-- The TyCon is a type synonym or a type family (not a data family)</span><span>
</span><span id="line-2063"></span><span class="hs-comment">-- See Note [Linting type synonym applications]</span><span>
</span><span id="line-2064"></span><span class="hs-comment">-- c.f. GHC.Tc.Validity.check_syn_tc_app</span><span>
</span><span id="line-2065"></span><span id="lintTySynFamApp"><span class="annot"><span class="annottext">lintTySynFamApp :: Bool -&gt; LintedType -&gt; TyCon -&gt; [LintedType] -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintTySynFamApp"><span class="hs-identifier hs-var hs-var">lintTySynFamApp</span></a></span></span><span> </span><span id="local-6989586621682973327"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973327"><span class="hs-identifier hs-var">report_unsat</span></a></span></span><span> </span><span id="local-6989586621682973328"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973328"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682973329"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973329"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682973330"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973330"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2066"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973327"><span class="hs-identifier hs-var">report_unsat</span></a></span><span>   </span><span class="hs-comment">-- Report unsaturated only if report_unsat is on</span><span>
</span><span id="line-2067"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973330"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType] -&gt; JoinArity -&gt; Bool
forall a. [a] -&gt; JoinArity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthLessThan"><span class="hs-operator hs-var">`lengthLessThan`</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; JoinArity
</span><a href="GHC.Core.TyCon.html#tyConArity"><span class="hs-identifier hs-var">tyConArity</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973329"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2068"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM LintedType
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Un-saturated type application&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973328"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2069"></span><span>
</span><span id="line-2070"></span><span>  </span><span class="hs-comment">-- Deal with type synonyms</span><span>
</span><span id="line-2071"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#ExpandsSyn"><span class="hs-identifier hs-type">ExpandsSyn</span></a></span><span> </span><span id="local-6989586621682973334"><span class="annot"><span class="annottext">[(Var, LintedType)]
</span><a href="#local-6989586621682973334"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621682973335"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973335"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621682973336"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973336"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [LintedType] -&gt; ExpandSynResult LintedType
forall tyco. TyCon -&gt; [tyco] -&gt; ExpandSynResult tyco
</span><a href="GHC.Core.TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973329"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973330"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2072"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973338"><span class="annot"><span class="annottext">expanded_ty :: LintedType
</span><a href="#local-6989586621682973338"><span class="hs-identifier hs-var hs-var">expanded_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; [LintedType] -&gt; LintedType
</span><a href="GHC.Core.Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; LintedType -&gt; LintedType
Subst -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, LintedType)] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, LintedType)]
</span><a href="#local-6989586621682973334"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973335"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973336"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-2073"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Kind-check the argument types, but without reporting</span><span>
</span><span id="line-2074"></span><span>         </span><span class="hs-comment">-- un-saturated type families/synonyms</span><span>
</span><span id="line-2075"></span><span>         </span><span id="local-6989586621682973341"><span class="annot"><a href="#local-6989586621682973341"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM [LintedType] -&gt; LintM [LintedType]
forall a. Bool -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#setReportUnsat"><span class="hs-identifier hs-var">setReportUnsat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LintedType -&gt; LintM LintedType)
-&gt; [LintedType] -&gt; LintM [LintedType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973330"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2076"></span><span>
</span><span id="line-2077"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621682973327"><span class="hs-identifier hs-type">report_unsat</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2078"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973338"><span class="hs-identifier hs-type">expanded_ty</span></a></span><span>
</span><span id="line-2079"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-type">lint_ty_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973328"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973329"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973341"><span class="hs-identifier hs-type">tys'</span></a></span><span>
</span><span id="line-2082"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973329"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973341"><span class="hs-identifier hs-type">tys'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2083"></span><span>
</span><span id="line-2084"></span><span>  </span><span class="hs-comment">-- Otherwise this must be a type family</span><span>
</span><span id="line-2085"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2086"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973343"><span class="annot"><a href="#local-6989586621682973343"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LintedType -&gt; LintM LintedType)
-&gt; [LintedType] -&gt; LintM [LintedType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973330"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2087"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-type">lint_ty_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973328"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973329"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973343"><span class="hs-identifier hs-type">tys'</span></a></span><span>
</span><span id="line-2088"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973329"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973343"><span class="hs-identifier hs-type">tys'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2089"></span><span>
</span><span id="line-2090"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2091"></span><span class="hs-comment">-- Confirms that a type is really TYPE r or Constraint</span><span>
</span><span id="line-2092"></span><span class="annot"><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-type">checkValueType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2093"></span><span id="checkValueType"><span class="annot"><span class="annottext">checkValueType :: LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-var hs-var">checkValueType</span></a></span></span><span> </span><span id="local-6989586621682973344"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973344"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682973345"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973345"><span class="hs-identifier hs-var">doc</span></a></span></span><span>
</span><span id="line-2094"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-var">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973346"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2095"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-Type-like kind when Type-like expected:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973346"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-2096"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;when checking&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973345"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2097"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2098"></span><span>    </span><span id="local-6989586621682973346"><span class="annot"><span class="annottext">kind :: LintedType
</span><a href="#local-6989586621682973346"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973344"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2099"></span><span>
</span><span id="line-2100"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2101"></span><span class="annot"><a href="GHC.Core.Lint.html#lintArrow"><span class="hs-identifier hs-type">lintArrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2102"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-2103"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-2104"></span><span id="lintArrow"><span class="annot"><span class="annottext">lintArrow :: SDoc -&gt; LintedType -&gt; LintedType -&gt; LintedType -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintArrow"><span class="hs-identifier hs-var hs-var">lintArrow</span></a></span></span><span> </span><span id="local-6989586621682973347"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973347"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span id="local-6989586621682973348"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973348"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973349"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973349"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621682973350"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973350"><span class="hs-identifier hs-var">tw</span></a></span></span><span>  </span><span class="hs-comment">-- Eg lintArrow &quot;type or kind `blah'&quot; k1 k2 kw</span><span>
</span><span id="line-2105"></span><span>                         </span><span class="hs-comment">-- or lintArrow &quot;coercion `blah'&quot; k1 k2 kw</span><span>
</span><span id="line-2106"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-var">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973351"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; LintedType -&gt; LintM ()
</span><a href="#local-6989586621682973352"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;argument&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973351"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2107"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-var">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973353"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; LintedType -&gt; LintM ()
</span><a href="#local-6989586621682973352"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;result&quot;</span></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973353"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2108"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#isMultiplicityTy"><span class="hs-identifier hs-var">isMultiplicityTy</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973355"><span class="hs-identifier hs-var">kw</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; LintedType -&gt; LintM ()
</span><a href="#local-6989586621682973352"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multiplicity&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973355"><span class="hs-identifier hs-var">kw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2109"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2110"></span><span>    </span><span id="local-6989586621682973351"><span class="annot"><span class="annottext">k1 :: LintedType
</span><a href="#local-6989586621682973351"><span class="hs-identifier hs-var hs-var">k1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973348"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-2111"></span><span>    </span><span id="local-6989586621682973353"><span class="annot"><span class="annottext">k2 :: LintedType
</span><a href="#local-6989586621682973353"><span class="hs-identifier hs-var hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973349"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2112"></span><span>    </span><span id="local-6989586621682973355"><span class="annot"><span class="annottext">kw :: LintedType
</span><a href="#local-6989586621682973355"><span class="hs-identifier hs-var hs-var">kw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973350"><span class="hs-identifier hs-var">tw</span></a></span><span>
</span><span id="line-2113"></span><span>    </span><span id="local-6989586621682973352"><span class="annot"><span class="annottext">report :: SDoc -&gt; LintedType -&gt; LintM ()
</span><a href="#local-6989586621682973352"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span id="local-6989586621682973356"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973356"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621682973357"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973357"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ill-kinded&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973356"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2114"></span><span>                                     </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973347"><span class="hs-identifier hs-var">what</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2115"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973347"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kind:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973357"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2116"></span><span>
</span><span id="line-2117"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-2118"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-type">lint_ty_app</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2119"></span><span id="lint_ty_app"><span class="annot"><span class="annottext">lint_ty_app :: LintedType -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_ty_app"><span class="hs-identifier hs-var hs-var">lint_ty_app</span></a></span></span><span> </span><span id="local-6989586621682973358"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973358"><span class="hs-identifier hs-var">msg_ty</span></a></span></span><span> </span><span id="local-6989586621682973359"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973359"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682973360"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973360"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2120"></span><span>    </span><span class="hs-comment">-- See Note [Avoiding compiler perf traps when constructing error messages.]</span><span>
</span><span id="line-2121"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintedType -&gt; SDoc)
-&gt; LintedType -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
forall msg_thing.
Outputable msg_thing =&gt;
(msg_thing -&gt; SDoc)
-&gt; msg_thing -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_app"><span class="hs-identifier hs-var">lint_app</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682973362"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973362"><span class="hs-identifier hs-var">msg_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973362"><span class="hs-identifier hs-var">msg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973358"><span class="hs-identifier hs-var">msg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973359"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973360"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2122"></span><span>
</span><span id="line-2123"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-2124"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-type">lint_co_app</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2125"></span><span id="lint_co_app"><span class="annot"><span class="annottext">lint_co_app :: Coercion -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-var hs-var">lint_co_app</span></a></span></span><span> </span><span id="local-6989586621682973364"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973364"><span class="hs-identifier hs-var">msg_ty</span></a></span></span><span> </span><span id="local-6989586621682973365"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973365"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682973366"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973366"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-2126"></span><span>    </span><span class="hs-comment">-- See Note [Avoiding compiler perf traps when constructing error messages.]</span><span>
</span><span id="line-2127"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; SDoc)
-&gt; Coercion -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
forall msg_thing.
Outputable msg_thing =&gt;
(msg_thing -&gt; SDoc)
-&gt; msg_thing -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_app"><span class="hs-identifier hs-var">lint_app</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682973367"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973367"><span class="hs-identifier hs-var">msg_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;coercion&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973367"><span class="hs-identifier hs-var">msg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973364"><span class="hs-identifier hs-var">msg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973365"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973366"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-2128"></span><span>
</span><span id="line-2129"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-2130"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTyLit"><span class="hs-identifier hs-type">lintTyLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2131"></span><span id="lintTyLit"><span class="annot"><span class="annottext">lintTyLit :: TyLit -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintTyLit"><span class="hs-identifier hs-var hs-var">lintTyLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NumTyLit"><span class="hs-identifier hs-type">NumTyLit</span></a></span><span> </span><span id="local-6989586621682973369"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682973369"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682973369"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973370"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-2134"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621682973370"><span class="annot"><span class="annottext">msg :: SDoc
</span><a href="#local-6989586621682973370"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Negative type literal:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SDoc
forall doc. IsLine doc =&gt; Integer -&gt; doc
</span><a href="GHC.Utils.Outputable.html#integer"><span class="hs-identifier hs-var">integer</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682973369"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2135"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTyLit"><span class="hs-identifier hs-var">lintTyLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#StrTyLit"><span class="hs-identifier hs-type">StrTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2136"></span><span class="annot"><a href="GHC.Core.Lint.html#lintTyLit"><span class="hs-identifier hs-var">lintTyLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CharTyLit"><span class="hs-identifier hs-type">CharTyLit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2137"></span><span>
</span><span id="line-2138"></span><span id="local-6989586621682970531"><span class="annot"><a href="GHC.Core.Lint.html#lint_app"><span class="hs-identifier hs-type">lint_app</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970531"><span class="hs-identifier hs-type">msg_thing</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682970531"><span class="hs-identifier hs-type">msg_thing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970531"><span class="hs-identifier hs-type">msg_thing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-2139"></span><span class="hs-comment">-- (lint_app d fun_kind arg_tys)</span><span>
</span><span id="line-2140"></span><span class="hs-comment">--    We have an application (f arg_ty1 .. arg_tyn),</span><span>
</span><span id="line-2141"></span><span class="hs-comment">--    where f :: fun_kind</span><span>
</span><span id="line-2142"></span><span>
</span><span id="line-2143"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-2144"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-2145"></span><span class="hs-comment">--</span><span>
</span><span id="line-2146"></span><span class="hs-comment">-- Being strict in the kind here avoids quite a few pointless thunks</span><span>
</span><span id="line-2147"></span><span class="hs-comment">-- reducing allocations by ~5%</span><span>
</span><span id="line-2148"></span><span id="lint_app"><span class="annot"><span class="annottext">lint_app :: forall msg_thing.
Outputable msg_thing =&gt;
(msg_thing -&gt; SDoc)
-&gt; msg_thing -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_app"><span class="hs-identifier hs-var hs-var">lint_app</span></a></span></span><span> </span><span id="local-6989586621682973417"><span class="annot"><span class="annottext">msg_thing -&gt; SDoc
</span><a href="#local-6989586621682973417"><span class="hs-identifier hs-var">mk_msg</span></a></span></span><span> </span><span id="local-6989586621682973418"><span class="annot"><span class="annottext">msg_thing
</span><a href="#local-6989586621682973418"><span class="hs-identifier hs-var">msg_type</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682973419"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973419"><span class="hs-identifier hs-var">kfn</span></a></span></span><span> </span><span id="local-6989586621682973420"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973420"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span>
</span><span id="line-2149"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682973421"><span class="annot"><a href="#local-6989586621682973421"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM InScopeSet
</span><a href="GHC.Core.Lint.html#getInScope"><span class="hs-identifier hs-var">getInScope</span></a></span><span>
</span><span id="line-2150"></span><span>         </span><span class="hs-comment">-- We need the in_scope set to satisfy the invariant in</span><span>
</span><span id="line-2151"></span><span>         </span><span class="hs-comment">-- Note [The substitution invariant] in GHC.Core.TyCo.Subst</span><span>
</span><span id="line-2152"></span><span>         </span><span class="hs-comment">-- Forcing the in scope set eagerly here reduces allocations by up to 4%.</span><span>
</span><span id="line-2153"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-type">go_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973421"><span class="hs-identifier hs-type">in_scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973419"><span class="hs-identifier hs-type">kfn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973420"><span class="hs-identifier hs-type">arg_tys</span></a></span><span>
</span><span id="line-2154"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-2155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2156"></span><span>
</span><span id="line-2157"></span><span>    </span><span class="hs-comment">-- We use explicit recursion instead of a fold here to avoid go_app becoming</span><span>
</span><span id="line-2158"></span><span>    </span><span class="hs-comment">-- an allocated function closure. This reduced allocations by up to 7% for some</span><span>
</span><span id="line-2159"></span><span>    </span><span class="hs-comment">-- modules.</span><span>
</span><span id="line-2160"></span><span>    </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-type">go_app</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedKind"><span class="hs-identifier hs-type">LintedKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2161"></span><span>    </span><span id="local-6989586621682973422"><span class="annot"><span class="annottext">go_app :: InScopeSet -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="#local-6989586621682973422"><span class="hs-identifier hs-var hs-var">go_app</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682973423"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973423"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682973424"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973424"><span class="hs-identifier hs-var">kfn</span></a></span></span><span> </span><span id="local-6989586621682973425"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973425"><span class="hs-identifier hs-var">ta</span></a></span></span><span>
</span><span id="line-2162"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973426"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973426"><span class="hs-identifier hs-var">kfn'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe LintedType
</span><a href="GHC.Core.Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973424"><span class="hs-identifier hs-var">kfn</span></a></span><span>
</span><span id="line-2163"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973423"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973426"><span class="hs-identifier hs-var">kfn'</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973425"><span class="hs-identifier hs-var">ta</span></a></span><span>
</span><span id="line-2164"></span><span>
</span><span id="line-2165"></span><span>    </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span id="local-6989586621682973428"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973428"><span class="hs-identifier hs-var">_in_scope</span></a></span></span><span> </span><span id="local-6989586621682973429"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973429"><span class="hs-identifier hs-var">_kind</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2166"></span><span>
</span><span id="line-2167"></span><span>    </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span id="local-6989586621682973430"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973430"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621682973431"><span class="annot"><span class="annottext">fun_kind :: LintedType
</span><a href="#local-6989586621682973431"><span class="hs-identifier hs-var">fun_kind</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682973432"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973432"><span class="hs-identifier hs-var">kfa</span></a></span></span><span> </span><span id="local-6989586621682973433"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973433"><span class="hs-identifier hs-var">kfb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973434"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973434"><span class="hs-identifier hs-var">ta</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682973435"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973435"><span class="hs-identifier hs-var">tas</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2168"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973436"><span class="annot"><span class="annottext">ka :: LintedType
</span><a href="#local-6989586621682973436"><span class="hs-identifier hs-var hs-var hs-var">ka</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973434"><span class="hs-identifier hs-var">ta</span></a></span><span>
</span><span id="line-2169"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973436"><span class="hs-identifier hs-var">ka</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973432"><span class="hs-identifier hs-var">kfa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2170"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
-&gt; [LintedType] -&gt; (msg_thing -&gt; SDoc) -&gt; msg_thing -&gt; SDoc -&gt; SDoc
forall a1 a2 t.
(Outputable a1, Outputable a2) =&gt;
a1 -&gt; a2 -&gt; (t -&gt; SDoc) -&gt; t -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_app_fail_msg"><span class="hs-identifier hs-var">lint_app_fail_msg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973419"><span class="hs-identifier hs-var">kfn</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973420"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing -&gt; SDoc
</span><a href="#local-6989586621682973417"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing
</span><a href="#local-6989586621682973418"><span class="hs-identifier hs-var">msg_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fun:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973431"><span class="hs-identifier hs-var">fun_kind</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973434"><span class="hs-identifier hs-var">ta</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973436"><span class="hs-identifier hs-var">ka</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2171"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973430"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973433"><span class="hs-identifier hs-var">kfb</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973435"><span class="hs-identifier hs-var">tas</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2172"></span><span>
</span><span id="line-2173"></span><span>    </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span id="local-6989586621682973438"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973438"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621682973439"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973439"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span id="local-6989586621682973440"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682973440"><span class="hs-identifier hs-var">_vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973441"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973441"><span class="hs-identifier hs-var">kfn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973442"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973442"><span class="hs-identifier hs-var">ta</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682973443"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973443"><span class="hs-identifier hs-var">tas</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2174"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973444"><span class="annot"><span class="annottext">kv_kind :: LintedType
</span><a href="#local-6989586621682973444"><span class="hs-identifier hs-var hs-var hs-var">kv_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973439"><span class="hs-identifier hs-var">kv</span></a></span><span>
</span><span id="line-2175"></span><span>                 </span><span id="local-6989586621682973445"><span class="annot"><span class="annottext">ka :: LintedType
</span><a href="#local-6989586621682973445"><span class="hs-identifier hs-var hs-var hs-var">ka</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973442"><span class="hs-identifier hs-var">ta</span></a></span><span>
</span><span id="line-2176"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973445"><span class="hs-identifier hs-var">ka</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973444"><span class="hs-identifier hs-var">kv_kind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2177"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
-&gt; [LintedType] -&gt; (msg_thing -&gt; SDoc) -&gt; msg_thing -&gt; SDoc -&gt; SDoc
forall a1 a2 t.
(Outputable a1, Outputable a2) =&gt;
a1 -&gt; a2 -&gt; (t -&gt; SDoc) -&gt; t -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_app_fail_msg"><span class="hs-identifier hs-var">lint_app_fail_msg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973441"><span class="hs-identifier hs-var">kfn</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973420"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing -&gt; SDoc
</span><a href="#local-6989586621682973417"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing
</span><a href="#local-6989586621682973418"><span class="hs-identifier hs-var">msg_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Forall:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973439"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973444"><span class="hs-identifier hs-var">kv_kind</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-2178"></span><span>                                                    </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973442"><span class="hs-identifier hs-var">ta</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973445"><span class="hs-identifier hs-var">ka</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2179"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973446"><span class="annot"><span class="annottext">kind' :: LintedType
</span><a href="#local-6989586621682973446"><span class="hs-identifier hs-var hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; LintedType -&gt; LintedType
Subst -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; LintedType -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973438"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973439"><span class="hs-identifier hs-var">kv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973442"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973441"><span class="hs-identifier hs-var">kfn</span></a></span><span>
</span><span id="line-2180"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; LintedType -&gt; [LintedType] -&gt; LintM ()
</span><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973438"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973446"><span class="hs-identifier hs-var">kind'</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973443"><span class="hs-identifier hs-var">tas</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2181"></span><span>
</span><span id="line-2182"></span><span>    </span><span class="annot"><a href="#local-6989586621682973422"><span class="hs-identifier hs-var">go_app</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682973448"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973448"><span class="hs-identifier hs-var">kfn</span></a></span></span><span> </span><span id="local-6989586621682973449"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973449"><span class="hs-identifier hs-var">ta</span></a></span></span><span>
</span><span id="line-2183"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
-&gt; [LintedType] -&gt; (msg_thing -&gt; SDoc) -&gt; msg_thing -&gt; SDoc -&gt; SDoc
forall a1 a2 t.
(Outputable a1, Outputable a2) =&gt;
a1 -&gt; a2 -&gt; (t -&gt; SDoc) -&gt; t -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_app_fail_msg"><span class="hs-identifier hs-var">lint_app_fail_msg</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973448"><span class="hs-identifier hs-var">kfn</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973420"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing -&gt; SDoc
</span><a href="#local-6989586621682973417"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">msg_thing
</span><a href="#local-6989586621682973418"><span class="hs-identifier hs-var">msg_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not a fun:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973448"><span class="hs-identifier hs-var">kfn</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973449"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2184"></span><span>
</span><span id="line-2185"></span><span class="hs-comment">-- This is a top level definition to ensure we pass all variables of the error message</span><span>
</span><span id="line-2186"></span><span class="hs-comment">-- explicitly and don't capture them as free variables. Otherwise this binder might</span><span>
</span><span id="line-2187"></span><span class="hs-comment">-- become a thunk that get's allocated in the hot code path.</span><span>
</span><span id="line-2188"></span><span class="hs-comment">-- See Note [Avoiding compiler perf traps when constructing error messages.]</span><span>
</span><span id="line-2189"></span><span id="local-6989586621682970535"><span id="local-6989586621682970536"><span id="local-6989586621682970537"><span class="annot"><a href="GHC.Core.Lint.html#lint_app_fail_msg"><span class="hs-identifier hs-type">lint_app_fail_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970535"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970536"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970535"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970536"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682970537"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970537"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span></span><span>
</span><span id="line-2190"></span><span id="lint_app_fail_msg"><span class="annot"><span class="annottext">lint_app_fail_msg :: forall a1 a2 t.
(Outputable a1, Outputable a2) =&gt;
a1 -&gt; a2 -&gt; (t -&gt; SDoc) -&gt; t -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#lint_app_fail_msg"><span class="hs-identifier hs-var hs-var">lint_app_fail_msg</span></a></span></span><span> </span><span id="local-6989586621682973460"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682973460"><span class="hs-identifier hs-var">kfn</span></a></span></span><span> </span><span id="local-6989586621682973461"><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682973461"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span id="local-6989586621682973462"><span class="annot"><span class="annottext">t -&gt; SDoc
</span><a href="#local-6989586621682973462"><span class="hs-identifier hs-var">mk_msg</span></a></span></span><span> </span><span id="local-6989586621682973463"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682973463"><span class="hs-identifier hs-var">msg_type</span></a></span></span><span> </span><span id="local-6989586621682973464"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973464"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Kind application error in&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; SDoc
</span><a href="#local-6989586621682973462"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682973463"><span class="hs-identifier hs-var">msg_type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2191"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function kind =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621682973460"><span class="hs-identifier hs-var">kfn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2192"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg types =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a2 -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a2
</span><a href="#local-6989586621682973461"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2193"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973464"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2194"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
        Linting rules
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-2199"></span><span>
</span><span id="line-2200"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreRule"><span class="hs-identifier hs-type">lintCoreRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#OutVar"><span class="hs-identifier hs-type">OutVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2201"></span><span id="lintCoreRule"><span class="annot"><span class="annottext">lintCoreRule :: Var -&gt; LintedType -&gt; CoreRule -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintCoreRule"><span class="hs-identifier hs-var hs-var">lintCoreRule</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2202"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Don't bother</span><span>
</span><span id="line-2203"></span><span>
</span><span id="line-2204"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoreRule"><span class="hs-identifier hs-var">lintCoreRule</span></a></span><span> </span><span id="local-6989586621682973466"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973466"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621682973467"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973467"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682973468"><span class="annot"><span class="annottext">rule :: CoreRule
</span><a href="#local-6989586621682973468"><span class="hs-identifier hs-var">rule</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Rule"><span class="hs-identifier hs-type">Rule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: CoreRule -&gt; FastString
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973471"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682973471"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_bndrs :: CoreRule -&gt; [Var]
</span><a href="GHC.Core.html#ru_bndrs"><span class="hs-identifier hs-var">ru_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973473"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973473"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span>
</span><span id="line-2205"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_args :: CoreRule -&gt; [CoreExpr]
</span><a href="GHC.Core.html#ru_args"><span class="hs-identifier hs-var">ru_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973475"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682973475"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_rhs :: CoreRule -&gt; CoreExpr
</span><a href="GHC.Core.html#ru_rhs"><span class="hs-identifier hs-var">ru_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973477"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973477"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2206"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM ()) -&gt; LintM ()
forall a. BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LambdaBind"><span class="hs-identifier hs-var">LambdaBind</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973473"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM ()) -&gt; LintM ())
-&gt; ([Var] -&gt; LintM ()) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2207"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973478"><span class="annot"><a href="#local-6989586621682973478"><span class="hs-identifier hs-var">lhs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LintedType, UsageEnv)
-&gt; [CoreExpr] -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreArgs"><span class="hs-identifier hs-var">lintCoreArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973467"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="GHC.Core.UsageEnv.html#zeroUE"><span class="hs-identifier hs-var">zeroUE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682973475"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2208"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973479"><span class="annot"><a href="#local-6989586621682973479"><span class="hs-identifier hs-var">rhs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-type">idJoinPointHood</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973466"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2209"></span><span>                     </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682973480"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973480"><span class="hs-identifier hs-var">join_arity</span></a></span></span><span>
</span><span id="line-2210"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682973475"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; JoinArity -&gt; Bool
forall a. [a] -&gt; JoinArity -&gt; Bool
</span><a href="GHC.Utils.Misc.html#lengthIs"><span class="hs-operator hs-var">`lengthIs`</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973480"><span class="hs-identifier hs-var">join_arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2211"></span><span>                                </span><span class="annot"><span class="annottext">Var -&gt; JoinArity -&gt; CoreRule -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJoinPointRuleMsg"><span class="hs-identifier hs-var">mkBadJoinPointRuleMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973466"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973480"><span class="hs-identifier hs-var">join_arity</span></a></span><span> </span><span class="annot"><span class="annottext">CoreRule
</span><a href="#local-6989586621682973468"><span class="hs-identifier hs-var">rule</span></a></span><span>
</span><span id="line-2212"></span><span>                               </span><span class="hs-comment">-- See Note [Rules for join points]</span><span>
</span><span id="line-2213"></span><span>                             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973477"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2214"></span><span>                     </span><span class="annot"><span class="annottext">JoinPointHood
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv))
-&gt; LintM (LintedType, UsageEnv) -&gt; LintM (LintedType, UsageEnv)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; LintM (LintedType, UsageEnv)
</span><a href="GHC.Core.Lint.html#lintCoreExpr"><span class="hs-identifier hs-var">lintCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973477"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2215"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973478"><span class="hs-identifier hs-type">lhs_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973479"><span class="hs-identifier hs-type">rhs_ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2216"></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973483"><span class="hs-identifier hs-type">rule_doc</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;lhs type:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973478"><span class="hs-identifier hs-type">lhs_ty</span></a></span><span>
</span><span id="line-2217"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rhs type:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973479"><span class="hs-identifier hs-type">rhs_ty</span></a></span><span>
</span><span id="line-2218"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;fun_ty:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973467"><span class="hs-identifier hs-type">fun_ty</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2219"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973484"><span class="annot"><a href="#local-6989586621682973484"><span class="hs-identifier hs-var hs-var">bad_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; [Var]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="#local-6989586621682973485"><span class="hs-identifier hs-var">is_bad_bndr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973473"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-2220"></span><span>
</span><span id="line-2221"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682973484"><span class="hs-identifier hs-type">bad_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2222"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973483"><span class="hs-identifier hs-type">rule_doc</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;unbound&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973484"><span class="hs-identifier hs-type">bad_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2223"></span><span>            </span><span class="hs-comment">-- See Note [Linting rules]</span><span>
</span><span id="line-2224"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-2225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2226"></span><span>    </span><span id="local-6989586621682973483"><span class="annot"><span class="annottext">rule_doc :: SDoc
</span><a href="#local-6989586621682973483"><span class="hs-identifier hs-var hs-var">rule_doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rule&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#doubleQuotes"><span class="hs-identifier hs-var">doubleQuotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; SDoc
forall doc. IsLine doc =&gt; FastString -&gt; doc
</span><a href="GHC.Utils.Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682973471"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span>
</span><span id="line-2227"></span><span>
</span><span id="line-2228"></span><span>    </span><span id="local-6989586621682973488"><span class="annot"><span class="annottext">lhs_fvs :: IdSet
</span><a href="#local-6989586621682973488"><span class="hs-identifier hs-var hs-var">lhs_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; IdSet
</span><a href="GHC.Core.FVs.html#exprsFreeVars"><span class="hs-identifier hs-var">exprsFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682973475"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2229"></span><span>    </span><span id="local-6989586621682973490"><span class="annot"><span class="annottext">rhs_fvs :: IdSet
</span><a href="#local-6989586621682973490"><span class="hs-identifier hs-var hs-var">rhs_fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; IdSet
</span><a href="GHC.Core.FVs.html#exprFreeVars"><span class="hs-identifier hs-var">exprFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682973477"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2230"></span><span>
</span><span id="line-2231"></span><span>    </span><span class="annot"><a href="#local-6989586621682973485"><span class="hs-identifier hs-type">is_bad_bndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2232"></span><span>    </span><span class="hs-comment">-- See Note [Unbound RULE binders] in GHC.Core.Rules</span><span>
</span><span id="line-2233"></span><span>    </span><span id="local-6989586621682973485"><span class="annot"><span class="annottext">is_bad_bndr :: Var -&gt; Bool
</span><a href="#local-6989586621682973485"><span class="hs-identifier hs-var hs-var">is_bad_bndr</span></a></span></span><span> </span><span id="local-6989586621682973492"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973492"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973492"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; IdSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682973488"><span class="hs-identifier hs-var">lhs_fvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2234"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973492"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; IdSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682973490"><span class="hs-identifier hs-var">rhs_fvs</span></a></span><span>
</span><span id="line-2235"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Coercion -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Coercion
</span><a href="GHC.Core.Coercion.html#isReflCoVar_maybe"><span class="hs-identifier hs-var">isReflCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973492"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2236"></span><span>
</span><span id="line-2237"></span><span>
</span><span id="line-2238"></span><span class="hs-comment">{- Note [Linting rules]
~~~~~~~~~~~~~~~~~~~~~~~
It's very bad if simplifying a rule means that one of the template
variables (ru_bndrs) that /is/ mentioned on the RHS becomes
not-mentioned in the LHS (ru_args).  How can that happen?  Well, in #10602,
SpecConstr stupidly constructed a rule like

  forall x,c1,c2.
     f (x |&gt; c1 |&gt; c2) = ....

But simplExpr collapses those coercions into one.  (Indeed in #10602,
it collapsed to the identity and was removed altogether.)

We don't have a great story for what to do here, but at least
this check will nail it.

NB (#11643): it's possible that a variable listed in the
binders becomes not-mentioned on both LHS and RHS.  Here's a silly
example:
   RULE forall x y. f (g x y) = g (x+1) (y-1)
And suppose worker/wrapper decides that 'x' is Absent.  Then
we'll end up with
   RULE forall x y. f ($gw y) = $gw (x+1)
This seems sufficiently obscure that there isn't enough payoff to
try to trim the forall'd binder list.

Note [Rules for join points]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
A join point cannot be partially applied. However, the left-hand side of a rule
for a join point is effectively a *pattern*, not a piece of code, so there's an
argument to be made for allowing a situation like this:

  join $sj :: Int -&gt; Int -&gt; String
       $sj n m = ...
       j :: forall a. Eq a =&gt; a -&gt; a -&gt; String
       {-# RULES &quot;SPEC j&quot; jump j @ Int $dEq = jump $sj #-}
       j @a $dEq x y = ...

Applying this rule can't turn a well-typed program into an ill-typed one, so
conceivably we could allow it. But we can always eta-expand such an
&quot;undersaturated&quot; rule (see 'GHC.Core.Opt.Arity.etaExpandToJoinPointRule'), and in fact
the simplifier would have to in order to deal with the RHS. So we take a
conservative view and don't allow undersaturated rules for join points. See
Note [Join points and unfoldings/rules] in &quot;GHC.Core.Opt.OccurAnal&quot; for further discussion.
-}</span><span>
</span><span id="line-2283"></span><span>
</span><span id="line-2284"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
         Linting coercions
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2291"></span><span>
</span><span id="line-2292"></span><span class="hs-comment">{- Note [Asymptotic efficiency]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When linting coercions (and types actually) we return a linted
(substituted) coercion.  Then we often have to take the coercionKind of
that returned coercion. If we get long chains, that can be asymptotically
inefficient, notably in
* TransCo
* InstCo
* SelCo (cf #9233)
* LRCo

But the code is simple.  And this is only Lint.  Let's wait to see if
the bad perf bites us in practice.

A solution would be to return the kind and role of the coercion,
as well as the linted coercion.  Or perhaps even *only* the kind and role,
which is what used to happen.   But that proved tricky and error prone
(#17923), so now we return the coercion.
-}</span><span>
</span><span id="line-2311"></span><span>
</span><span id="line-2312"></span><span>
</span><span id="line-2313"></span><span class="hs-comment">-- lints a coercion, confirming that its lh kind and its rh kind are both *</span><span>
</span><span id="line-2314"></span><span class="hs-comment">-- also ensures that the role is Nominal</span><span>
</span><span id="line-2315"></span><span class="annot"><a href="GHC.Core.Lint.html#lintStarCoercion"><span class="hs-identifier hs-type">lintStarCoercion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#InCoercion"><span class="hs-identifier hs-type">InCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedCoercion"><span class="hs-identifier hs-type">LintedCoercion</span></a></span><span>
</span><span id="line-2316"></span><span id="lintStarCoercion"><span class="annot"><span class="annottext">lintStarCoercion :: Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintStarCoercion"><span class="hs-identifier hs-var hs-var">lintStarCoercion</span></a></span></span><span> </span><span id="local-6989586621682973496"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973496"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-2317"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973497"><span class="annot"><a href="#local-6989586621682973497"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973496"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-2318"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973498"><span class="annot"><a href="#local-6989586621682973498"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973499"><span class="annot"><a href="#local-6989586621682973499"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973497"><span class="hs-identifier hs-type">g'</span></a></span><span>
</span><span id="line-2319"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-type">checkValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973498"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;the kind of the left type in&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973496"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2320"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkValueType"><span class="hs-identifier hs-type">checkValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973499"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;the kind of the right type in&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973496"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2321"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973496"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973496"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2322"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682973497"><span class="hs-identifier hs-type">g'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2323"></span><span>
</span><span id="line-2324"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#InCoercion"><span class="hs-identifier hs-type">InCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedCoercion"><span class="hs-identifier hs-type">LintedCoercion</span></a></span><span>
</span><span id="line-2325"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-2326"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-2327"></span><span>
</span><span id="line-2328"></span><span id="lintCoercion"><span class="annot"><span class="annottext">lintCoercion :: Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var hs-var">lintCoercion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621682973504"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad CoVarCo:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2331"></span><span>                  </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;With offending type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2332"></span><span>
</span><span id="line-2333"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2334"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973505"><span class="annot"><a href="#local-6989586621682973505"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Subst
</span><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-var">getSubst</span></a></span><span>
</span><span id="line-2335"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupCoVar"><span class="hs-identifier hs-type">lookupCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973505"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973504"><span class="hs-identifier hs-type">cv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2336"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973507"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973507"><span class="hs-identifier hs-var">linted_co</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973507"><span class="hs-identifier hs-var">linted_co</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-2337"></span><span>           </span><span class="annot"><span class="annottext">Maybe Coercion
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCoVarInScope"><span class="hs-identifier hs-var">checkTyCoVarInScope</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973505"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-2338"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973504"><span class="hs-identifier hs-var">cv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2339"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-2340"></span><span>
</span><span id="line-2341"></span><span>
</span><span id="line-2342"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621682973509"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973509"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2343"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973510"><span class="annot"><a href="#local-6989586621682973510"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973509"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2344"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973510"><span class="hs-identifier hs-type">ty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2345"></span><span>
</span><span id="line-2346"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621682973512"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973512"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682973513"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973513"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2347"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973515"><span class="annot"><a href="#local-6989586621682973515"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973513"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2348"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973512"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973515"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-type">MRefl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2349"></span><span>
</span><span id="line-2350"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621682973516"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973516"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682973517"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973517"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621682973519"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973519"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2351"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973520"><span class="annot"><a href="#local-6989586621682973520"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973517"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-2352"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973521"><span class="annot"><a href="#local-6989586621682973521"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973519"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2353"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973522"><span class="annot"><a href="#local-6989586621682973522"><span class="hs-identifier hs-var hs-var">tk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973520"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-2354"></span><span>             </span><span id="local-6989586621682973523"><span class="annot"><a href="#local-6989586621682973523"><span class="hs-identifier hs-var hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; LintedType
Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973521"><span class="hs-identifier hs-var">co'</span></a></span><span>
</span><span id="line-2355"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973522"><span class="hs-identifier hs-type">tk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973523"><span class="hs-identifier hs-type">tl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2356"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;GRefl coercion kind mis-match:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973519"><span class="hs-identifier hs-type">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2357"></span><span>            </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973520"><span class="hs-identifier hs-type">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973522"><span class="hs-identifier hs-type">tk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973523"><span class="hs-identifier hs-type">tl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2358"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973521"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973521"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2359"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973516"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973520"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973521"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2360"></span><span>
</span><span id="line-2361"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973524"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973524"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621682973526"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973526"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682973527"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973527"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621682973528"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973528"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2362"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; TyCon -&gt; [Coercion] -&gt; Maybe Coercion
Role -&gt; TyCon -&gt; [Coercion] -&gt; Maybe Coercion
</span><a href="GHC.Core.Type.html#tyConAppFunCo_maybe"><span class="hs-identifier hs-var">tyConAppFunCo_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973526"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973527"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973528"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-2363"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Saturated application of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973527"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2364"></span><span>                  </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973524"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2365"></span><span>    </span><span class="hs-comment">-- All saturated TyConAppCos should be FunCos</span><span>
</span><span id="line-2366"></span><span>
</span><span id="line-2367"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Maybe ([Var], LintedType)
</span><a href="GHC.Core.TyCon.html#synTyConDefn_maybe"><span class="hs-identifier hs-var">synTyConDefn_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973527"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2368"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Synonym in TyConAppCo:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973524"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2369"></span><span>
</span><span id="line-2370"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2371"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkTyCon"><span class="hs-identifier hs-var">checkTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973527"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2372"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973531"><span class="annot"><a href="#local-6989586621682973531"><span class="hs-identifier hs-var">cos'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; LintM Coercion) -&gt; [Coercion] -&gt; LintM [Coercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973528"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-2373"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973532"><span class="annot"><a href="#local-6989586621682973532"><span class="hs-identifier hs-var">co_kinds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973533"><span class="annot"><a href="#local-6989586621682973533"><span class="hs-identifier hs-var">co_roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973531"><span class="hs-identifier hs-type">cos'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2374"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-type">lint_co_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973524"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973527"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#pFst"><span class="hs-identifier hs-var">pFst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973532"><span class="hs-identifier hs-type">co_kinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2375"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-type">lint_co_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973524"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973527"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#pSnd"><span class="hs-identifier hs-var">pSnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973532"><span class="hs-identifier hs-type">co_kinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2376"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">zipWithM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973524"><span class="hs-identifier hs-type">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#tyConRoleListX"><span class="hs-identifier hs-type">tyConRoleListX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973526"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973527"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973533"><span class="hs-identifier hs-type">co_roles</span></a></span><span>
</span><span id="line-2377"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973526"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973527"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973531"><span class="hs-identifier hs-type">cos'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2378"></span><span>
</span><span id="line-2379"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973538"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973538"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621682973540"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973540"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682973541"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973541"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2380"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973540"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2381"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TyConAppCo to the left of AppCo:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973538"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2382"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Maybe (LintedType, Role)
</span><a href="GHC.Core.Coercion.html#isReflCo_maybe"><span class="hs-identifier hs-var">isReflCo_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973540"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2383"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Refl (TyConApp ...) to the left of AppCo:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973538"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2384"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2385"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973543"><span class="annot"><a href="#local-6989586621682973543"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973540"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2386"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973544"><span class="annot"><a href="#local-6989586621682973544"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973541"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-2387"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973545"><span class="annot"><a href="#local-6989586621682973545"><span class="hs-identifier hs-var">lk1</span></a></span></span><span> </span><span id="local-6989586621682973546"><span class="annot"><a href="#local-6989586621682973546"><span class="hs-identifier hs-var">rk1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973547"><span class="annot"><a href="#local-6989586621682973547"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973543"><span class="hs-identifier hs-type">co1'</span></a></span><span>
</span><span id="line-2388"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973548"><span class="annot"><a href="#local-6989586621682973548"><span class="hs-identifier hs-var">lk2</span></a></span></span><span> </span><span id="local-6989586621682973549"><span class="annot"><a href="#local-6989586621682973549"><span class="hs-identifier hs-var">rk2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973550"><span class="annot"><a href="#local-6989586621682973550"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973544"><span class="hs-identifier hs-type">co2'</span></a></span><span>
</span><span id="line-2389"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-type">lint_co_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973538"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973545"><span class="hs-identifier hs-type">lk1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682973548"><span class="hs-identifier hs-type">lk2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2390"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_co_app"><span class="hs-identifier hs-type">lint_co_app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973538"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973546"><span class="hs-identifier hs-type">rk1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682973549"><span class="hs-identifier hs-type">rk2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2391"></span><span>
</span><span id="line-2392"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682973547"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-type">Phantom</span></a></span><span>
</span><span id="line-2393"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973550"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-type">Phantom</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682973550"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2394"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Second argument in AppCo cannot be R:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span>
</span><span id="line-2395"></span><span>                      </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973538"><span class="hs-identifier hs-type">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2396"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973538"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973550"><span class="hs-identifier hs-type">r2</span></a></span><span>
</span><span id="line-2397"></span><span>
</span><span id="line-2398"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973543"><span class="hs-identifier hs-type">co1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973544"><span class="hs-identifier hs-type">co2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2399"></span><span>
</span><span id="line-2400"></span><span class="hs-comment">----------</span><span>
</span><span id="line-2401"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973552"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973552"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_tcv :: Coercion -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973555"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973555"><span class="hs-identifier hs-var">tcv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visL :: Coercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visL"><span class="hs-identifier hs-var">fco_visL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973557"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682973557"><span class="hs-identifier hs-var">visL</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_visR :: Coercion -&gt; ForAllTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_visR"><span class="hs-identifier hs-var">fco_visR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973559"><span class="annot"><span class="annottext">ForAllTyFlag
</span><a href="#local-6989586621682973559"><span class="hs-identifier hs-var">visR</span></a></span></span><span>
</span><span id="line-2402"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_kind :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973561"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973561"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_body :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973563"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973563"><span class="hs-identifier hs-var">body_co</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2403"></span><span class="hs-comment">-- See Note [ForAllCo] in GHC.Core.TyCo.Rep,</span><span>
</span><span id="line-2404"></span><span class="hs-comment">-- including the typing rule for ForAllCo</span><span>
</span><span id="line-2405"></span><span>
</span><span id="line-2406"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973555"><span class="hs-identifier hs-var">tcv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2407"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non tyco binder in ForAllCo:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973552"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2408"></span><span>
</span><span id="line-2409"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2410"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973564"><span class="annot"><a href="#local-6989586621682973564"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintStarCoercion"><span class="hs-identifier hs-var">lintStarCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973561"><span class="hs-identifier hs-var">kind_co</span></a></span><span>
</span><span id="line-2411"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintTyCoBndr"><span class="hs-identifier hs-type">lintTyCoBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973555"><span class="hs-identifier hs-type">tcv</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973565"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973565"><span class="hs-identifier hs-var">tcv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2412"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973566"><span class="annot"><a href="#local-6989586621682973566"><span class="hs-identifier hs-var">body_co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973563"><span class="hs-identifier hs-var">body_co</span></a></span><span>
</span><span id="line-2413"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973565"><span class="hs-identifier hs-type">tcv'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-type">coercionLKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973564"><span class="hs-identifier hs-type">kind_co'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2414"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Kind mis-match in ForallCo&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973552"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2415"></span><span>
</span><span id="line-2416"></span><span>       </span><span class="hs-comment">-- Assuming kind_co :: k1 ~ k2</span><span>
</span><span id="line-2417"></span><span>       </span><span class="hs-comment">-- Need to check that</span><span>
</span><span id="line-2418"></span><span>       </span><span class="hs-comment">--    (forall (tcv:k1). lty) and</span><span>
</span><span id="line-2419"></span><span>       </span><span class="hs-comment">--    (forall (tcv:k2). rty[(tcv:k2) |&gt; sym kind_co/tcv])</span><span>
</span><span id="line-2420"></span><span>       </span><span class="hs-comment">-- are both well formed.  Easiest way is to call lintForAllBody</span><span>
</span><span id="line-2421"></span><span>       </span><span class="hs-comment">-- for each; there is actually no need to do the funky substitution</span><span>
</span><span id="line-2422"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973567"><span class="annot"><a href="#local-6989586621682973567"><span class="hs-identifier hs-var">lty</span></a></span></span><span> </span><span id="local-6989586621682973568"><span class="annot"><a href="#local-6989586621682973568"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973569"><span class="annot"><a href="#local-6989586621682973569"><span class="hs-identifier hs-var">body_role</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973566"><span class="hs-identifier hs-type">body_co'</span></a></span><span>
</span><span id="line-2423"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintForAllBody"><span class="hs-identifier hs-type">lintForAllBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973565"><span class="hs-identifier hs-type">tcv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973567"><span class="hs-identifier hs-type">lty</span></a></span><span>
</span><span id="line-2424"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintForAllBody"><span class="hs-identifier hs-type">lintForAllBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973565"><span class="hs-identifier hs-type">tcv'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973568"><span class="hs-identifier hs-type">rty</span></a></span><span>
</span><span id="line-2425"></span><span>
</span><span id="line-2426"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-type">isCoVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973555"><span class="hs-identifier hs-type">tcv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2427"></span><span>         </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973557"><span class="hs-identifier hs-type">visL</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#coreTyLamForAllTyFlag"><span class="hs-identifier hs-type">coreTyLamForAllTyFlag</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682973559"><span class="hs-identifier hs-type">visR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Specificity.html#coreTyLamForAllTyFlag"><span class="hs-identifier hs-type">coreTyLamForAllTyFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2428"></span><span>              </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Invalid visibility flags in CoVar ForAllCo&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973552"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2429"></span><span>              </span><span class="hs-comment">-- See (FC7) in Note [ForAllCo] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2430"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.FVs.html#almostDevoidCoVarOfCo"><span class="hs-identifier hs-type">almostDevoidCoVarOfCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973555"><span class="hs-identifier hs-type">tcv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973563"><span class="hs-identifier hs-type">body_co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2431"></span><span>              </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Covar can only appear in Refl and GRefl: &quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973552"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2432"></span><span>              </span><span class="hs-comment">-- See (FC6) in Note [ForAllCo] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2433"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-2434"></span><span>
</span><span id="line-2435"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973569"><span class="hs-identifier hs-type">body_role</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2436"></span><span>         </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973557"><span class="hs-identifier hs-type">visL</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqForAllVis"><span class="hs-operator hs-type">`eqForAllVis`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973559"><span class="hs-identifier hs-type">visR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2437"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Nominal ForAllCo has mismatched visibilities: &quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973552"><span class="hs-identifier hs-type">co</span></a></span><span>
</span><span id="line-2438"></span><span>
</span><span id="line-2439"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973552"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_tcv"><span class="hs-identifier hs-var">fco_tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973565"><span class="hs-identifier hs-type">tcv'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_kind"><span class="hs-identifier hs-var">fco_kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973564"><span class="hs-identifier hs-type">kind_co'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_body"><span class="hs-identifier hs-var">fco_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973566"><span class="hs-identifier hs-type">body_co'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2440"></span><span>
</span><span id="line-2441"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973572"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973572"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fco_role :: Coercion -&gt; Role
</span><a href="GHC.Core.TyCo.Rep.html#fco_role"><span class="hs-identifier hs-var">fco_role</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973575"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973575"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_afl :: Coercion -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_afl"><span class="hs-identifier hs-var">fco_afl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973577"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682973577"><span class="hs-identifier hs-var">afl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_afr :: Coercion -&gt; FunTyFlag
</span><a href="GHC.Core.TyCo.Rep.html#fco_afr"><span class="hs-identifier hs-var">fco_afr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973579"><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682973579"><span class="hs-identifier hs-var">afr</span></a></span></span><span>
</span><span id="line-2442"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_mult :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973581"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973581"><span class="hs-identifier hs-var">cow</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_arg :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973583"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973583"><span class="hs-identifier hs-var">co1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fco_res :: Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973585"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973585"><span class="hs-identifier hs-var">co2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2443"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973586"><span class="annot"><a href="#local-6989586621682973586"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973583"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2444"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973587"><span class="annot"><a href="#local-6989586621682973587"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973585"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-2445"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973588"><span class="annot"><a href="#local-6989586621682973588"><span class="hs-identifier hs-var">cow'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973581"><span class="hs-identifier hs-type">cow</span></a></span><span>
</span><span id="line-2446"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973589"><span class="annot"><a href="#local-6989586621682973589"><span class="hs-identifier hs-var">lt1</span></a></span></span><span> </span><span id="local-6989586621682973590"><span class="annot"><a href="#local-6989586621682973590"><span class="hs-identifier hs-var">rt1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973583"><span class="hs-identifier hs-type">co1</span></a></span><span>
</span><span id="line-2447"></span><span>             </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973591"><span class="annot"><a href="#local-6989586621682973591"><span class="hs-identifier hs-var">lt2</span></a></span></span><span> </span><span id="local-6989586621682973592"><span class="annot"><a href="#local-6989586621682973592"><span class="hs-identifier hs-var">rt2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973585"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-2448"></span><span>             </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973593"><span class="annot"><a href="#local-6989586621682973593"><span class="hs-identifier hs-var">ltw</span></a></span></span><span> </span><span id="local-6989586621682973594"><span class="annot"><a href="#local-6989586621682973594"><span class="hs-identifier hs-var">rtw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973581"><span class="hs-identifier hs-type">cow</span></a></span><span>
</span><span id="line-2449"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973577"><span class="hs-identifier hs-type">afl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-type">chooseFunTyFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973589"><span class="hs-identifier hs-type">lt1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973591"><span class="hs-identifier hs-type">lt2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;afl&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2450"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973579"><span class="hs-identifier hs-type">afr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#chooseFunTyFlag"><span class="hs-identifier hs-type">chooseFunTyFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973590"><span class="hs-identifier hs-type">rt1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973592"><span class="hs-identifier hs-type">rt2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;afr&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2451"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintArrow"><span class="hs-identifier hs-type">lintArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arrowl&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973589"><span class="hs-identifier hs-type">lt1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973591"><span class="hs-identifier hs-type">lt2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973593"><span class="hs-identifier hs-type">ltw</span></a></span><span>
</span><span id="line-2452"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintArrow"><span class="hs-identifier hs-type">lintArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arrowr&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973590"><span class="hs-identifier hs-type">rt1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973592"><span class="hs-identifier hs-type">rt2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973594"><span class="hs-identifier hs-type">rtw</span></a></span><span>
</span><span id="line-2453"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973583"><span class="hs-identifier hs-type">co1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973575"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973583"><span class="hs-identifier hs-type">co1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2454"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973585"><span class="hs-identifier hs-type">co2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973575"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973585"><span class="hs-identifier hs-type">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2455"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973593"><span class="hs-identifier hs-type">ltw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier hs-type">multiplicityTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mult-l&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2456"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973594"><span class="hs-identifier hs-type">rtw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier hs-type">multiplicityTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973595"><span class="hs-identifier hs-type">bad_co_msg</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;mult-r&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2457"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973596"><span class="annot"><a href="#local-6989586621682973596"><span class="hs-identifier hs-var hs-var">expected_mult_role</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973575"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2458"></span><span>                                    </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a></span><span>
</span><span id="line-2459"></span><span>                                    </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span>
</span><span id="line-2460"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973581"><span class="hs-identifier hs-type">cow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973596"><span class="hs-identifier hs-type">expected_mult_role</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973581"><span class="hs-identifier hs-type">cow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2461"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973572"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_mult"><span class="hs-identifier hs-var">fco_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973588"><span class="hs-identifier hs-type">cow'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_arg"><span class="hs-identifier hs-var">fco_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973586"><span class="hs-identifier hs-type">co1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#fco_res"><span class="hs-identifier hs-var">fco_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973587"><span class="hs-identifier hs-type">co2'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2462"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2463"></span><span>    </span><span id="local-6989586621682973595"><span class="annot"><span class="annottext">bad_co_msg :: String -&gt; SDoc
</span><a href="#local-6989586621682973595"><span class="hs-identifier hs-var hs-var">bad_co_msg</span></a></span></span><span> </span><span id="local-6989586621682973597"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973597"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad coercion&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973597"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2464"></span><span>                      </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;afl:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682973577"><span class="hs-identifier hs-var">afl</span></a></span><span>
</span><span id="line-2465"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;afr:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FunTyFlag
</span><a href="#local-6989586621682973579"><span class="hs-identifier hs-var">afr</span></a></span><span>
</span><span id="line-2466"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arg_co:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973583"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2467"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;res_co:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973585"><span class="hs-identifier hs-var">co2</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2468"></span><span>
</span><span id="line-2469"></span><span class="hs-comment">-- See Note [Bad unsafe coercion]</span><span>
</span><span id="line-2470"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973598"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973598"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uco_role :: Coercion -&gt; Role
</span><a href="GHC.Core.TyCo.Rep.html#uco_role"><span class="hs-identifier hs-var">uco_role</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973601"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973601"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_prov :: Coercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#uco_prov"><span class="hs-identifier hs-var">uco_prov</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973603"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621682973603"><span class="hs-identifier hs-var">prov</span></a></span></span><span>
</span><span id="line-2471"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_lty :: Coercion -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973605"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973605"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_rty :: Coercion -&gt; LintedType
</span><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973607"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973607"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uco_deps :: Coercion -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973609"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973609"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2472"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Check the role.  PhantomProv must have Phantom role, otherwise any role is fine</span><span>
</span><span id="line-2473"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621682973603"><span class="hs-identifier hs-var">prov</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2474"></span><span>            </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Role -&gt; Role -&gt; LintM ()
forall thing. Outputable thing =&gt; thing -&gt; Role -&gt; Role -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-var">lintRole</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973598"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973601"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2475"></span><span>            </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2476"></span><span>
</span><span id="line-2477"></span><span>       </span><span class="hs-comment">-- Check the to and from types</span><span>
</span><span id="line-2478"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973611"><span class="annot"><a href="#local-6989586621682973611"><span class="hs-identifier hs-var">ty1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973605"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2479"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973612"><span class="annot"><a href="#local-6989586621682973612"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973607"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-2480"></span><span>
</span><span id="line-2481"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973613"><span class="annot"><a href="#local-6989586621682973613"><span class="hs-identifier hs-var hs-var">k1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973611"><span class="hs-identifier hs-var">ty1'</span></a></span><span>
</span><span id="line-2482"></span><span>             </span><span id="local-6989586621682973614"><span class="annot"><a href="#local-6989586621682973614"><span class="hs-identifier hs-var hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973612"><span class="hs-identifier hs-var">ty2'</span></a></span><span>
</span><span id="line-2483"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973601"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Phantom"><span class="hs-identifier hs-type">Phantom</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-type">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973613"><span class="hs-identifier hs-type">k1</span></a></span><span>
</span><span id="line-2484"></span><span>                            </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isTYPEorCONSTRAINT"><span class="hs-identifier hs-type">isTYPEorCONSTRAINT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973614"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2485"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973615"><span class="hs-identifier hs-type">checkTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973605"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973607"><span class="hs-identifier hs-type">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2486"></span><span>
</span><span id="line-2487"></span><span>       </span><span class="hs-comment">-- Check the coercions on which this UnivCo depends</span><span>
</span><span id="line-2488"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973616"><span class="annot"><a href="#local-6989586621682973616"><span class="hs-identifier hs-var">deps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973609"><span class="hs-identifier hs-type">deps</span></a></span><span>
</span><span id="line-2489"></span><span>
</span><span id="line-2490"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973598"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_lty"><span class="hs-identifier hs-var">uco_lty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973611"><span class="hs-identifier hs-type">ty1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_rty"><span class="hs-identifier hs-var">uco_rty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973612"><span class="hs-identifier hs-type">ty2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#uco_deps"><span class="hs-identifier hs-var">uco_deps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682973616"><span class="hs-identifier hs-type">deps'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2491"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2492"></span><span>     </span><span id="local-6989586621682973617"><span class="annot"><span class="annottext">report :: String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span id="local-6989586621682973618"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973618"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SDoc) -&gt; String -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsafe coercion: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973618"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2493"></span><span>                     </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;From:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973605"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2494"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  To:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973607"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2495"></span><span>     </span><span class="annot"><a href="#local-6989586621682973619"><span class="hs-identifier hs-type">isUnBoxed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2496"></span><span>     </span><span id="local-6989586621682973619"><span class="annot"><span class="annottext">isUnBoxed :: PrimRep -&gt; Bool
</span><a href="#local-6989586621682973619"><span class="hs-identifier hs-var hs-var">isUnBoxed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (PrimRep -&gt; Bool) -&gt; PrimRep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isGcPtrRep"><span class="hs-identifier hs-var">isGcPtrRep</span></a></span><span>
</span><span id="line-2497"></span><span>
</span><span id="line-2498"></span><span>       </span><span class="hs-comment">-- see #9122 for discussion of these checks</span><span>
</span><span id="line-2499"></span><span>     </span><span id="local-6989586621682973615"><span class="annot"><span class="annottext">checkTypes :: LintedType -&gt; LintedType -&gt; LintM ()
</span><a href="#local-6989586621682973615"><span class="hs-identifier hs-var hs-var">checkTypes</span></a></span></span><span> </span><span id="local-6989586621682973621"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973621"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973622"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973622"><span class="hs-identifier hs-var">t2</span></a></span></span><span>
</span><span id="line-2500"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973624"><span class="hs-identifier hs-var">fixed_rep_1</span></a></span><span>
</span><span id="line-2501"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;left-hand type does not have a fixed runtime representation&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2502"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973625"><span class="hs-identifier hs-var">fixed_rep_2</span></a></span><span>
</span><span id="line-2503"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;right-hand type does not have a fixed runtime representation&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2504"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintM () -&gt; LintM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973624"><span class="hs-identifier hs-var">fixed_rep_1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682973625"><span class="hs-identifier hs-var">fixed_rep_2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2505"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682973626"><span class="hs-identifier hs-var">reps1</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep] -&gt; [PrimRep] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-var">`equalLength`</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682973628"><span class="hs-identifier hs-var">reps2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2506"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;between values with different # of reps&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2507"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(PrimRep -&gt; PrimRep -&gt; LintM ())
-&gt; [PrimRep] -&gt; [PrimRep] -&gt; LintM ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><span class="hs-identifier hs-var">zipWithM_</span></span><span> </span><span class="annot"><span class="annottext">PrimRep -&gt; PrimRep -&gt; LintM ()
</span><a href="#local-6989586621682973629"><span class="hs-identifier hs-var">validateCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682973626"><span class="hs-identifier hs-var">reps1</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimRep]
</span><a href="#local-6989586621682973628"><span class="hs-identifier hs-var">reps2</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-2508"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-2509"></span><span>         </span><span id="local-6989586621682973624"><span class="annot"><span class="annottext">fixed_rep_1 :: Bool
</span><a href="#local-6989586621682973624"><span class="hs-identifier hs-var hs-var">fixed_rep_1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; Bool
LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-var">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973621"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-2510"></span><span>         </span><span id="local-6989586621682973625"><span class="annot"><span class="annottext">fixed_rep_2 :: Bool
</span><a href="#local-6989586621682973625"><span class="hs-identifier hs-var hs-var">fixed_rep_2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; Bool
LintedType -&gt; Bool
</span><a href="GHC.Core.Type.html#typeHasFixedRuntimeRep"><span class="hs-identifier hs-var">typeHasFixedRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973622"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2511"></span><span>
</span><span id="line-2512"></span><span>         </span><span class="hs-comment">-- don't look at these unless lev_poly1/2 are False</span><span>
</span><span id="line-2513"></span><span>         </span><span class="hs-comment">-- Otherwise, we get #13458</span><span>
</span><span id="line-2514"></span><span>         </span><span id="local-6989586621682973626"><span class="annot"><span class="annottext">reps1 :: [PrimRep]
</span><a href="#local-6989586621682973626"><span class="hs-identifier hs-var hs-var">reps1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; [PrimRep]
LintedType -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973621"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-2515"></span><span>         </span><span id="local-6989586621682973628"><span class="annot"><span class="annottext">reps2 :: [PrimRep]
</span><a href="#local-6989586621682973628"><span class="hs-identifier hs-var hs-var">reps2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; [PrimRep]
LintedType -&gt; [PrimRep]
</span><a href="GHC.Types.RepType.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973622"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-2516"></span><span>
</span><span id="line-2517"></span><span>     </span><span class="annot"><a href="#local-6989586621682973629"><span class="hs-identifier hs-type">validateCoercion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2518"></span><span>     </span><span id="local-6989586621682973629"><span class="annot"><span class="annottext">validateCoercion :: PrimRep -&gt; PrimRep -&gt; LintM ()
</span><a href="#local-6989586621682973629"><span class="hs-identifier hs-var hs-var">validateCoercion</span></a></span></span><span> </span><span id="local-6989586621682973631"><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682973631"><span class="hs-identifier hs-var">rep1</span></a></span></span><span> </span><span id="local-6989586621682973632"><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682973632"><span class="hs-identifier hs-var">rep2</span></a></span></span><span>
</span><span id="line-2519"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973633"><span class="annot"><a href="#local-6989586621682973633"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Platform
</span><a href="GHC.Core.Lint.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2520"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-type">checkWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973619"><span class="hs-identifier hs-type">isUnBoxed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973631"><span class="hs-identifier hs-type">rep1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682973619"><span class="hs-identifier hs-type">isUnBoxed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973632"><span class="hs-identifier hs-type">rep2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2521"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973617"><span class="hs-identifier hs-type">report</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;between unboxed and boxed value&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2522"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-type">checkWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#primRepSizeB"><span class="hs-identifier hs-type">TyCon.primRepSizeB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973633"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973631"><span class="hs-identifier hs-type">rep1</span></a></span><span>
</span><span id="line-2523"></span><span>                           </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#primRepSizeB"><span class="hs-identifier hs-type">TyCon.primRepSizeB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973633"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973632"><span class="hs-identifier hs-type">rep2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2524"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973617"><span class="hs-identifier hs-type">report</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;between unboxed values of different size&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2525"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973636"><span class="annot"><a href="#local-6989586621682973636"><span class="hs-identifier hs-var hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool) -&gt; Maybe Bool -&gt; Maybe Bool -&gt; Maybe Bool
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Maybe Bool
</span><a href="GHC.Core.TyCon.html#primRepIsFloat"><span class="hs-identifier hs-var">TyCon.primRepIsFloat</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682973631"><span class="hs-identifier hs-var">rep1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2526"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimRep -&gt; Maybe Bool
</span><a href="GHC.Core.TyCon.html#primRepIsFloat"><span class="hs-identifier hs-var">TyCon.primRepIsFloat</span></a></span><span> </span><span class="annot"><span class="annottext">PrimRep
</span><a href="#local-6989586621682973632"><span class="hs-identifier hs-var">rep2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2527"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682973636"><span class="hs-identifier hs-type">fl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2528"></span><span>                </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;between vector types&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2529"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="#local-6989586621682973617"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;between float and integral values&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2530"></span><span>                </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2531"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-2532"></span><span>
</span><span id="line-2533"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621682973640"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973640"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2534"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973641"><span class="annot"><a href="#local-6989586621682973641"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973640"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2535"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973641"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2536"></span><span>
</span><span id="line-2537"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973642"><span class="annot"><span class="annottext">co :: Coercion
</span><a href="#local-6989586621682973642"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621682973644"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973644"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621682973645"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973645"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2538"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973646"><span class="annot"><a href="#local-6989586621682973646"><span class="hs-identifier hs-var">co1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973644"><span class="hs-identifier hs-var">co1</span></a></span><span>
</span><span id="line-2539"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973647"><span class="annot"><a href="#local-6989586621682973647"><span class="hs-identifier hs-var">co2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973645"><span class="hs-identifier hs-type">co2</span></a></span><span>
</span><span id="line-2540"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973648"><span class="annot"><a href="#local-6989586621682973648"><span class="hs-identifier hs-var hs-var">ty1b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; LintedType
Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionRKind"><span class="hs-identifier hs-var">coercionRKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973646"><span class="hs-identifier hs-var">co1'</span></a></span><span>
</span><span id="line-2541"></span><span>             </span><span id="local-6989586621682973650"><span class="annot"><a href="#local-6989586621682973650"><span class="hs-identifier hs-var hs-var">ty2a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; LintedType
Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973647"><span class="hs-identifier hs-var">co2'</span></a></span><span>
</span><span id="line-2542"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973648"><span class="hs-identifier hs-type">ty1b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973650"><span class="hs-identifier hs-type">ty2a</span></a></span><span>
</span><span id="line-2543"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Trans coercion mis-match:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973642"><span class="hs-identifier hs-type">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2544"></span><span>                   </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973646"><span class="hs-identifier hs-type">co1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973647"><span class="hs-identifier hs-type">co2'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2545"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973642"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973644"><span class="hs-identifier hs-type">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973645"><span class="hs-identifier hs-type">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2546"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973646"><span class="hs-identifier hs-type">co1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973647"><span class="hs-identifier hs-type">co2'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2547"></span><span>
</span><span id="line-2548"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973651"><span class="annot"><span class="annottext">the_co :: Coercion
</span><a href="#local-6989586621682973651"><span class="hs-identifier hs-var">the_co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span id="local-6989586621682973653"><span class="annot"><span class="annottext">CoSel
</span><a href="#local-6989586621682973653"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682973654"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973654"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2549"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973655"><span class="annot"><a href="#local-6989586621682973655"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973654"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2550"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973656"><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682973657"><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973658"><span class="annot"><a href="#local-6989586621682973658"><span class="hs-identifier hs-var">co_role</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKindRole"><span class="hs-identifier hs-type">coercionKindRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973655"><span class="hs-identifier hs-type">co'</span></a></span><span>
</span><span id="line-2551"></span><span>
</span><span id="line-2552"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-comment">-- forall (both TyVar and CoVar)</span><span>
</span><span id="line-2553"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-type">splitForAllTyCoVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2554"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVar_maybe"><span class="hs-identifier hs-type">splitForAllTyCoVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-2555"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelForAll"><span class="hs-identifier hs-type">SelForAll</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-2556"></span><span>            </span><span class="hs-special">,</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-type">isForAllTy_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_ty"><span class="hs-identifier hs-type">isForAllTy_ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2557"></span><span>             </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-type">isForAllTy_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isForAllTy_co"><span class="hs-identifier hs-type">isForAllTy_co</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2558"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973655"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2559"></span><span>
</span><span id="line-2560"></span><span>            </span><span class="hs-comment">-- function</span><span>
</span><span id="line-2561"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-type">isFunTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2562"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isFunTy"><span class="hs-identifier hs-type">isFunTy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-2563"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelFun"><span class="hs-identifier hs-type">SelFun</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-2564"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973655"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2565"></span><span>
</span><span id="line-2566"></span><span>            </span><span class="hs-comment">-- TyCon</span><span>
</span><span id="line-2567"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973665"><span class="annot"><a href="#local-6989586621682973665"><span class="hs-identifier hs-var">tc_s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973666"><span class="annot"><a href="#local-6989586621682973666"><span class="hs-identifier hs-var">tys_s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-type">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-2568"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973667"><span class="annot"><a href="#local-6989586621682973667"><span class="hs-identifier hs-var">tc_t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973668"><span class="annot"><a href="#local-6989586621682973668"><span class="hs-identifier hs-var">tys_t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-type">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-2569"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682973665"><span class="hs-identifier hs-type">tc_s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682973667"><span class="hs-identifier hs-type">tc_t</span></a></span><span>
</span><span id="line-2570"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelTyCon"><span class="hs-identifier hs-type">SelTyCon</span></a></span><span> </span><span id="local-6989586621682973670"><span class="annot"><a href="#local-6989586621682973670"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682973671"><span class="annot"><a href="#local-6989586621682973671"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-2571"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isInjectiveTyCon"><span class="hs-identifier hs-type">isInjectiveTyCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973665"><span class="hs-identifier hs-type">tc_s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973658"><span class="hs-identifier hs-type">co_role</span></a></span><span>
</span><span id="line-2572"></span><span>                </span><span class="hs-comment">-- see Note [SelCo and newtypes] in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-2573"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682973666"><span class="hs-identifier hs-type">tys_s</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-type">`equalLength`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973668"><span class="hs-identifier hs-type">tys_t</span></a></span><span>
</span><span id="line-2574"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682973666"><span class="hs-identifier hs-type">tys_s</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#lengthExceeds"><span class="hs-operator hs-type">`lengthExceeds`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973670"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-2575"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973651"><span class="hs-identifier hs-type">the_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#tyConRole"><span class="hs-identifier hs-type">tyConRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973658"><span class="hs-identifier hs-type">co_role</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973665"><span class="hs-identifier hs-type">tc_s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973670"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973671"><span class="hs-identifier hs-type">r0</span></a></span><span>
</span><span id="line-2576"></span><span>                  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SelCo"><span class="hs-identifier hs-type">SelCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973653"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973655"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2577"></span><span>
</span><span id="line-2578"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>
</span><span id="line-2579"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-type">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Bad SelCo:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2580"></span><span>                             </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973651"><span class="hs-identifier hs-type">the_co</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973657"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2581"></span><span>
</span><span id="line-2582"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973675"><span class="annot"><span class="annottext">the_co :: Coercion
</span><a href="#local-6989586621682973675"><span class="hs-identifier hs-var">the_co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621682973677"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682973677"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621682973678"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973678"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2583"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973679"><span class="annot"><a href="#local-6989586621682973679"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973678"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2584"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973680"><span class="annot"><a href="#local-6989586621682973680"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682973681"><span class="annot"><a href="#local-6989586621682973681"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973679"><span class="hs-identifier hs-type">co'</span></a></span><span>
</span><span id="line-2585"></span><span>             </span><span id="local-6989586621682973682"><span class="annot"><a href="#local-6989586621682973682"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Role
</span><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-var">coercionRole</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973679"><span class="hs-identifier hs-var">co'</span></a></span><span>
</span><span id="line-2586"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973678"><span class="hs-identifier hs-type">co</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973682"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-2587"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-type">splitAppTy_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973680"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitAppTy_maybe"><span class="hs-identifier hs-type">splitAppTy_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973681"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2588"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(LintedType, LintedType)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(LintedType, LintedType)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftOrRight -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621682973677"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973679"><span class="hs-identifier hs-var">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2589"></span><span>           </span><span class="annot"><span class="annottext">(Maybe (LintedType, LintedType), Maybe (LintedType, LintedType))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad LRCo:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2590"></span><span>                              </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973675"><span class="hs-identifier hs-var">the_co</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973680"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973681"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2591"></span><span>
</span><span id="line-2592"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621682973685"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973685"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682973686"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973686"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2593"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973687"><span class="annot"><a href="#local-6989586621682973687"><span class="hs-identifier hs-var">co'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973685"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2594"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973688"><span class="annot"><a href="#local-6989586621682973688"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-type">lintCoercion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973686"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-2595"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973689"><span class="annot"><a href="#local-6989586621682973689"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621682973690"><span class="annot"><a href="#local-6989586621682973690"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973687"><span class="hs-identifier hs-type">co'</span></a></span><span>
</span><span id="line-2596"></span><span>             </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973691"><span class="annot"><a href="#local-6989586621682973691"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621682973692"><span class="annot"><a href="#local-6989586621682973692"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973688"><span class="hs-identifier hs-type">arg'</span></a></span><span>
</span><span id="line-2597"></span><span>
</span><span id="line-2598"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973686"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973688"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2599"></span><span>
</span><span id="line-2600"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier hs-type">splitForAllTyVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973689"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyVar_maybe"><span class="hs-identifier hs-type">splitForAllTyVar_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973690"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2601"></span><span>         </span><span class="hs-comment">-- forall over tvar</span><span>
</span><span id="line-2602"></span><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973693"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973693"><span class="hs-identifier hs-var">tv1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973694"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973694"><span class="hs-identifier hs-var">tv2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2603"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973691"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973693"><span class="hs-identifier hs-var">tv1</span></a></span><span>
</span><span id="line-2604"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973692"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973694"><span class="hs-identifier hs-var">tv2</span></a></span><span>
</span><span id="line-2605"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973687"><span class="hs-identifier hs-var">co'</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973688"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2606"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2607"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Kind mis-match in inst coercion1&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973685"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2608"></span><span>
</span><span id="line-2609"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Maybe (Var, LintedType), Maybe (Var, LintedType))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (Var, LintedType)
</span><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier hs-var">splitForAllCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973689"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (Var, LintedType)
</span><a href="GHC.Core.Type.html#splitForAllCoVar_maybe"><span class="hs-identifier hs-var">splitForAllCoVar_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973690"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2610"></span><span>         </span><span class="hs-comment">-- forall over covar</span><span>
</span><span id="line-2611"></span><span>         </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973695"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973695"><span class="hs-identifier hs-var">cv1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973696"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973696"><span class="hs-identifier hs-var">cv2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2612"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973691"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973695"><span class="hs-identifier hs-var">cv1</span></a></span><span>
</span><span id="line-2613"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973692"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973696"><span class="hs-identifier hs-var">cv2</span></a></span><span>
</span><span id="line-2614"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973691"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-2615"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973692"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-2616"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973687"><span class="hs-identifier hs-var">co'</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973688"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2617"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2618"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Kind mis-match in inst coercion2&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973685"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2619"></span><span>
</span><span id="line-2620"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Maybe (Var, LintedType), Maybe (Var, LintedType))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM Coercion
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad argument of inst&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-2621"></span><span>
</span><span id="line-2622"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span id="local-6989586621682973697"><span class="annot"><span class="annottext">this_co :: Coercion
</span><a href="#local-6989586621682973697"><span class="hs-identifier hs-var">this_co</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span id="local-6989586621682973699"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682973699"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682973700"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973700"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2623"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973701"><span class="annot"><a href="#local-6989586621682973701"><span class="hs-identifier hs-var">cos'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Coercion -&gt; LintM Coercion) -&gt; [Coercion] -&gt; LintM [Coercion]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973700"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-2624"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973702"><span class="annot"><a href="#local-6989586621682973702"><span class="hs-identifier hs-var">arg_kinds</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier">Pair</span></span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-type">coercionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973701"><span class="hs-identifier hs-type">cos'</span></a></span><span>
</span><span id="line-2625"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621682973703"><span class="hs-identifier hs-type">lint_roles</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#coAxiomRuleArgRoles"><span class="hs-identifier hs-type">coAxiomRuleArgRoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973699"><span class="hs-identifier hs-type">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973701"><span class="hs-identifier hs-type">cos'</span></a></span><span>
</span><span id="line-2626"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="#local-6989586621682973705"><span class="hs-identifier hs-type">lint_ax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973699"><span class="hs-identifier hs-type">ax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973702"><span class="hs-identifier hs-type">arg_kinds</span></a></span><span>
</span><span id="line-2627"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomCo"><span class="hs-identifier hs-type">AxiomCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973699"><span class="hs-identifier hs-type">ax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973701"><span class="hs-identifier hs-type">cos'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2628"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2629"></span><span>    </span><span class="annot"><a href="#local-6989586621682973705"><span class="hs-identifier hs-type">lint_ax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiomRule"><span class="hs-identifier hs-type">CoAxiomRule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2630"></span><span>    </span><span id="local-6989586621682973705"><span class="annot"><span class="annottext">lint_ax :: CoAxiomRule -&gt; [Pair LintedType] -&gt; LintM ()
</span><a href="#local-6989586621682973705"><span class="hs-identifier hs-var hs-var">lint_ax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BuiltInFamRew"><span class="hs-identifier hs-type">BuiltInFamRew</span></a></span><span>  </span><span id="local-6989586621682973707"><span class="annot"><span class="annottext">BuiltInFamRewrite
</span><a href="#local-6989586621682973707"><span class="hs-identifier hs-var">bif</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973708"><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973708"><span class="hs-identifier hs-var">prs</span></a></span></span><span>
</span><span id="line-2631"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Pair LintedType) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltInFamRewrite -&gt; [Pair LintedType] -&gt; Maybe (Pair LintedType)
</span><a href="GHC.Core.Coercion.Axiom.html#bifrw_proves"><span class="hs-identifier hs-var">bifrw_proves</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltInFamRewrite
</span><a href="#local-6989586621682973707"><span class="hs-identifier hs-var">bif</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973708"><span class="hs-identifier hs-var">prs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973710"><span class="hs-identifier hs-var">bad_bif</span></a></span><span>
</span><span id="line-2632"></span><span>    </span><span class="annot"><a href="#local-6989586621682973705"><span class="hs-identifier hs-var">lint_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BuiltInFamInj"><span class="hs-identifier hs-type">BuiltInFamInj</span></a></span><span> </span><span id="local-6989586621682973712"><span class="annot"><span class="annottext">BuiltInFamInjectivity
</span><a href="#local-6989586621682973712"><span class="hs-identifier hs-var">bif</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973713"><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973713"><span class="hs-identifier hs-var">prs</span></a></span></span><span>
</span><span id="line-2633"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973713"><span class="hs-identifier hs-var">prs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2634"></span><span>                  </span><span class="hs-special">[</span><span id="local-6989586621682973714"><span class="annot"><span class="annottext">Pair LintedType
</span><a href="#local-6989586621682973714"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Pair LintedType) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltInFamInjectivity -&gt; Pair LintedType -&gt; Maybe (Pair LintedType)
</span><a href="GHC.Core.Coercion.Axiom.html#bifinj_proves"><span class="hs-identifier hs-var">bifinj_proves</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltInFamInjectivity
</span><a href="#local-6989586621682973712"><span class="hs-identifier hs-var">bif</span></a></span><span> </span><span class="annot"><span class="annottext">Pair LintedType
</span><a href="#local-6989586621682973714"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2635"></span><span>                  </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-2636"></span><span>               </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973710"><span class="hs-identifier hs-var">bad_bif</span></a></span><span>
</span><span id="line-2637"></span><span>    </span><span class="annot"><a href="#local-6989586621682973705"><span class="hs-identifier hs-var">lint_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#UnbranchedAxiom"><span class="hs-identifier hs-type">UnbranchedAxiom</span></a></span><span> </span><span id="local-6989586621682973717"><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682973717"><span class="hs-identifier hs-var">ax</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973718"><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973718"><span class="hs-identifier hs-var">prs</span></a></span></span><span>
</span><span id="line-2638"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; TyCon -&gt; CoAxBranch -&gt; [Pair LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintBranch"><span class="hs-identifier hs-var">lintBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973697"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Unbranched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682973717"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Unbranched -&gt; CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomSingleBranch"><span class="hs-identifier hs-var">coAxiomSingleBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Unbranched
</span><a href="#local-6989586621682973717"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973718"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-2639"></span><span>    </span><span class="annot"><a href="#local-6989586621682973705"><span class="hs-identifier hs-var">lint_ax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#BranchedAxiom"><span class="hs-identifier hs-type">BranchedAxiom</span></a></span><span> </span><span id="local-6989586621682973723"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973723"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621682973724"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973724"><span class="hs-identifier hs-var">ind</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682973725"><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973725"><span class="hs-identifier hs-var">prs</span></a></span></span><span>
</span><span id="line-2640"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973724"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973724"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Branches Branched -&gt; JoinArity
forall (br :: BranchFlag). Branches br -&gt; JoinArity
</span><a href="GHC.Core.Coercion.Axiom.html#numBranches"><span class="hs-identifier hs-var">numBranches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Branches Branched
forall (br :: BranchFlag). CoAxiom br -&gt; Branches br
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomBranches"><span class="hs-identifier hs-var">coAxiomBranches</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973723"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2641"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973697"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;index out of range&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2642"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; TyCon -&gt; CoAxBranch -&gt; [Pair LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintBranch"><span class="hs-identifier hs-var">lintBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973697"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973723"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; JoinArity -&gt; CoAxBranch
forall (br :: BranchFlag). CoAxiom br -&gt; JoinArity -&gt; CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973723"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973724"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973725"><span class="hs-identifier hs-var">prs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2643"></span><span>
</span><span id="line-2644"></span><span>    </span><span id="local-6989586621682973710"><span class="annot"><span class="annottext">bad_bif :: SDoc
</span><a href="#local-6989586621682973710"><span class="hs-identifier hs-var hs-var">bad_bif</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973697"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Proves returns Nothing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2645"></span><span>
</span><span id="line-2646"></span><span>    </span><span class="annot"><a href="#local-6989586621682973732"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682970566"><span class="annot"><a href="#local-6989586621682970566"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970566"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2647"></span><span>    </span><span id="local-6989586621682973732"><span class="annot"><span class="annottext">err :: forall a. String -&gt; [SDoc] -&gt; LintM a
</span><a href="#local-6989586621682973732"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621682973739"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973739"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682973740"><span class="annot"><span class="annottext">[SDoc]
</span><a href="#local-6989586621682973740"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM a
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM a) -&gt; SDoc -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2648"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682973739"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rule:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621682973699"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SDoc]
</span><a href="#local-6989586621682973740"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2649"></span><span>
</span><span id="line-2650"></span><span>    </span><span id="local-6989586621682973703"><span class="annot"><span class="annottext">lint_roles :: JoinArity -&gt; [Role] -&gt; [Coercion] -&gt; LintM ()
</span><a href="#local-6989586621682973703"><span class="hs-identifier hs-var hs-var">lint_roles</span></a></span></span><span> </span><span id="local-6989586621682973772"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973772"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973773"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973773"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682973774"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973774"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973775"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973775"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682973776"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973776"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2651"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973773"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Role
</span><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-var">coercionRole</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973775"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2652"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; [Role] -&gt; [Coercion] -&gt; LintM ()
</span><a href="#local-6989586621682973703"><span class="hs-identifier hs-var">lint_roles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973772"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973774"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973776"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-2653"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [SDoc] -&gt; LintM ()
forall a. String -&gt; [SDoc] -&gt; LintM a
</span><a href="#local-6989586621682973732"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Argument roles mismatch&quot;</span></span><span>
</span><span id="line-2654"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In argument:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973772"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-2655"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973773"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2656"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Found:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Role
</span><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-var">coercionRole</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973775"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2657"></span><span>    </span><span class="annot"><a href="#local-6989586621682973703"><span class="hs-identifier hs-var">lint_roles</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2658"></span><span>    </span><span class="annot"><a href="#local-6989586621682973703"><span class="hs-identifier hs-var">lint_roles</span></a></span><span> </span><span id="local-6989586621682973779"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973779"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621682973780"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973780"><span class="hs-identifier hs-var">rs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [SDoc] -&gt; LintM ()
forall a. String -&gt; [SDoc] -&gt; LintM a
</span><a href="#local-6989586621682973732"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Too many coercion arguments&quot;</span></span><span>
</span><span id="line-2659"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973779"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2660"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Provided:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973779"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Coercion] -&gt; JoinArity
forall a. [a] -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973780"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2661"></span><span>
</span><span id="line-2662"></span><span>    </span><span class="annot"><a href="#local-6989586621682973703"><span class="hs-identifier hs-var">lint_roles</span></a></span><span> </span><span id="local-6989586621682973781"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973781"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682973782"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973782"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [SDoc] -&gt; LintM ()
forall a. String -&gt; [SDoc] -&gt; LintM a
</span><a href="#local-6989586621682973732"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not enough coercion arguments&quot;</span></span><span>
</span><span id="line-2663"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973781"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Role] -&gt; JoinArity
forall a. [a] -&gt; JoinArity
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; JoinArity
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973782"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2664"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Provided:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682973781"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2665"></span><span>
</span><span id="line-2666"></span><span>
</span><span id="line-2667"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621682973784"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973784"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2668"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973785"><span class="annot"><a href="#local-6989586621682973785"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973784"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-2669"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973785"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2670"></span><span>
</span><span id="line-2671"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621682973787"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973787"><span class="hs-identifier hs-var">co'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2672"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682973788"><span class="annot"><a href="#local-6989586621682973788"><span class="hs-identifier hs-var">co'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973787"><span class="hs-identifier hs-var">co'</span></a></span><span>
</span><span id="line-2673"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973788"><span class="hs-identifier hs-type">co'</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-type">Nominal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.html#coercionRole"><span class="hs-identifier hs-type">coercionRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973788"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973788"><span class="hs-identifier hs-type">co'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2675"></span><span>
</span><span id="line-2676"></span><span class="annot"><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621682973790"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682973790"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2677"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unfilled coercion hole:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682973790"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-2678"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; LintM Coercion
</span><a href="GHC.Core.Lint.html#lintCoercion"><span class="hs-identifier hs-var">lintCoercion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#coHoleCoVar"><span class="hs-identifier hs-var">coHoleCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621682973790"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2679"></span><span>
</span><span id="line-2680"></span><span>
</span><span id="line-2681"></span><span class="hs-comment">{-
Note [Conflict checking for axiom applications]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider the following type family and axiom:

type family Equal (a :: k) (b :: k) :: Bool
type instance where
  Equal a a = True
  Equal a b = False
--
Equal :: forall k::*. k -&gt; k -&gt; Bool
axEqual :: { forall k::*. forall a::k. Equal k a a ~ True
           ; forall k::*. forall a::k. forall b::k. Equal k a b ~ False }

The coercion (axEqual[1] &lt;*&gt; &lt;Int&gt; &lt;Int) is ill-typed, and Lint should reject it.
(Recall that the index is 0-based, so this is the second branch of the axiom.)
The problem is that, on the surface, it seems that

  (axEqual[1] &lt;*&gt; &lt;Int&gt; &lt;Int&gt;) :: (Equal * Int Int ~ False)

and that all is OK. But, all is not OK: we want to use the first branch of the
axiom in this case, not the second. The problem is that the parameters of the
first branch can unify with the supplied coercions, thus meaning that the first
branch should be taken. See also Note [Apartness] in &quot;GHC.Core.FamInstEnv&quot;.

For more details, see the section &quot;Branched axiom conflict checking&quot; in
docs/core-spec, which defines the corresponding no_conflict function used by the
Co_AxiomInstCo rule in the section &quot;Coercion typing&quot;.
-}</span><span>
</span><span id="line-2710"></span><span>
</span><span id="line-2711"></span><span class="hs-comment">-- | Check to make sure that an axiom application is internally consistent.</span><span>
</span><span id="line-2712"></span><span class="hs-comment">-- Returns the conflicting branch, if it exists</span><span>
</span><span id="line-2713"></span><span class="hs-comment">-- Note [Conflict checking for axiom applications]</span><span>
</span><span id="line-2714"></span><span class="annot"><a href="GHC.Core.Lint.html#lintBranch"><span class="hs-identifier hs-type">lintBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2715"></span><span class="hs-comment">-- defined here to avoid dependencies in GHC.Core.Coercion</span><span>
</span><span id="line-2716"></span><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><span id="line-2717"></span><span class="hs-comment">-- See Note [GHC Formalism] in GHC.Core.Lint</span><span>
</span><span id="line-2718"></span><span id="lintBranch"><span class="annot"><span class="annottext">lintBranch :: Coercion -&gt; TyCon -&gt; CoAxBranch -&gt; [Pair LintedType] -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintBranch"><span class="hs-identifier hs-var hs-var">lintBranch</span></a></span></span><span> </span><span id="local-6989586621682973792"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span></span><span> </span><span id="local-6989586621682973793"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973793"><span class="hs-identifier hs-var">fam_tc</span></a></span></span><span> </span><span id="local-6989586621682973794"><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621682973795"><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973795"><span class="hs-identifier hs-var">arg_kinds</span></a></span></span><span>
</span><span id="line-2719"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973798"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973798"><span class="hs-identifier hs-var">ktvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_cvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_cvs"><span class="hs-identifier hs-var">cab_cvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973800"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973800"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-2720"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973795"><span class="hs-identifier hs-var">arg_kinds</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair LintedType] -&gt; [Var] -&gt; Bool
forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-var">`equalLength`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973798"><span class="hs-identifier hs-var">ktvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973800"><span class="hs-identifier hs-var">cvs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2721"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lengths&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2722"></span><span>
</span><span id="line-2723"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973801"><span class="annot"><a href="#local-6989586621682973801"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM Subst
</span><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-var">getSubst</span></a></span><span>
</span><span id="line-2724"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973802"><span class="annot"><a href="#local-6989586621682973802"><span class="hs-identifier hs-var hs-var">empty_subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zapSubst"><span class="hs-identifier hs-var">zapSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973801"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-2725"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldlM</span></span><span> </span><span class="annot"><a href="#local-6989586621682973805"><span class="hs-identifier hs-type">check_ki</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973802"><span class="hs-identifier hs-type">empty_subst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682973802"><span class="hs-identifier hs-type">empty_subst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2726"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973798"><span class="hs-identifier hs-type">ktvs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621682973800"><span class="hs-identifier hs-type">cvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682973795"><span class="hs-identifier hs-type">arg_kinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2727"></span><span>
</span><span id="line-2728"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682973806"><span class="hs-identifier hs-type">check_no_conflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973807"><span class="hs-identifier hs-type">flattened_target</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973808"><span class="hs-identifier hs-type">incomps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2729"></span><span>            </span><span class="annot"><span class="annottext">Maybe CoAxBranch
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2730"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973809"><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973809"><span class="hs-identifier hs-var">bad_branch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2731"></span><span>                               </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inconsistent with&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-2732"></span><span>                                 </span><span class="annot"><span class="annottext">TyCon -&gt; CoAxBranch -&gt; SDoc
</span><a href="GHC.Core.Coercion.html#pprCoAxBranch"><span class="hs-identifier hs-var">pprCoAxBranch</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973793"><span class="hs-identifier hs-var">fam_tc</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973809"><span class="hs-identifier hs-var">bad_branch</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2733"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2734"></span><span>    </span><span id="local-6989586621682973805"><span class="annot"><span class="annottext">check_ki :: (Subst, Subst) -&gt; (Var, Pair LintedType) -&gt; LintM (Subst, Subst)
</span><a href="#local-6989586621682973805"><span class="hs-identifier hs-var hs-var">check_ki</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973811"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973811"><span class="hs-identifier hs-var">subst_l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973812"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973812"><span class="hs-identifier hs-var">subst_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973813"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621682973814"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973814"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621682973815"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973815"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2735"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973816"><span class="annot"><span class="annottext">sk' :: LintedType
</span><a href="#local-6989586621682973816"><span class="hs-identifier hs-var hs-var hs-var">sk'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973814"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-2736"></span><span>                 </span><span id="local-6989586621682973817"><span class="annot"><span class="annottext">tk' :: LintedType
</span><a href="#local-6989586621682973817"><span class="hs-identifier hs-var hs-var hs-var">tk'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973815"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-2737"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973818"><span class="annot"><span class="annottext">ktv_kind_l :: LintedType
</span><a href="#local-6989586621682973818"><span class="hs-identifier hs-var hs-var hs-var">ktv_kind_l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; LintedType -&gt; LintedType
Subst -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973811"><span class="hs-identifier hs-var">subst_l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2738"></span><span>                 </span><span id="local-6989586621682973819"><span class="annot"><span class="annottext">ktv_kind_r :: LintedType
</span><a href="#local-6989586621682973819"><span class="hs-identifier hs-var hs-var hs-var">ktv_kind_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; LintedType -&gt; LintedType
Subst -&gt; LintedType -&gt; LintedType
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973812"><span class="hs-identifier hs-var">subst_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2739"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973816"><span class="hs-identifier hs-var">sk'</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973818"><span class="hs-identifier hs-var">ktv_kind_l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2740"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check_ki1&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973816"><span class="hs-identifier hs-var">sk'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973818"><span class="hs-identifier hs-var">ktv_kind_l</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2741"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973817"><span class="hs-identifier hs-var">tk'</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973819"><span class="hs-identifier hs-var">ktv_kind_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2742"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var">bad_ax</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check_ki2&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973792"><span class="hs-identifier hs-var">this_co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973817"><span class="hs-identifier hs-var">tk'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973819"><span class="hs-identifier hs-var">ktv_kind_r</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2743"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Subst, Subst) -&gt; LintM (Subst, Subst)
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; LintedType -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973811"><span class="hs-identifier hs-var">subst_l</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973814"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2744"></span><span>                     </span><span class="annot"><span class="annottext">Subst -&gt; Var -&gt; LintedType -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973812"><span class="hs-identifier hs-var">subst_r</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682973813"><span class="hs-identifier hs-var">ktv</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973815"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2745"></span><span>
</span><span id="line-2746"></span><span>    </span><span id="local-6989586621682973820"><span class="annot"><span class="annottext">tvs :: [Var]
</span><a href="#local-6989586621682973820"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchTyVars"><span class="hs-identifier hs-var">coAxBranchTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-2747"></span><span>    </span><span id="local-6989586621682973822"><span class="annot"><span class="annottext">cvs :: [Var]
</span><a href="#local-6989586621682973822"><span class="hs-identifier hs-var hs-var">cvs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchCoVars"><span class="hs-identifier hs-var">coAxBranchCoVars</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-2748"></span><span>    </span><span id="local-6989586621682973808"><span class="annot"><span class="annottext">incomps :: [CoAxBranch]
</span><a href="#local-6989586621682973808"><span class="hs-identifier hs-var hs-var">incomps</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; [CoAxBranch]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchIncomps"><span class="hs-identifier hs-var">coAxBranchIncomps</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-2749"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682973825"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973825"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973826"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973826"><span class="hs-identifier hs-var">cotys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [LintedType] -&gt; ([LintedType], [LintedType])
forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="GHC.Utils.Misc.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973820"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pair LintedType -&gt; LintedType)
-&gt; [Pair LintedType] -&gt; [LintedType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pair LintedType -&gt; LintedType
forall a. Pair a -&gt; a
</span><a href="GHC.Data.Pair.html#pFst"><span class="hs-identifier hs-var">pFst</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair LintedType]
</span><a href="#local-6989586621682973795"><span class="hs-identifier hs-var">arg_kinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2750"></span><span>    </span><span id="local-6989586621682973828"><span class="annot"><span class="annottext">co_args :: [Coercion]
</span><a href="#local-6989586621682973828"><span class="hs-identifier hs-var hs-var">co_args</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintedType -&gt; Coercion) -&gt; [LintedType] -&gt; [Coercion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Coercion
</span><a href="GHC.Core.Type.html#stripCoercionTy"><span class="hs-identifier hs-var">stripCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973826"><span class="hs-identifier hs-var">cotys</span></a></span><span>
</span><span id="line-2751"></span><span>    </span><span id="local-6989586621682973830"><span class="annot"><span class="annottext">subst :: Subst
</span><a href="#local-6989586621682973830"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [LintedType] -&gt; Subst
HasDebugCallStack =&gt; [Var] -&gt; [LintedType] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973820"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973825"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-operator hs-var">`composeTCvSubst`</span></a></span><span>
</span><span id="line-2752"></span><span>                   </span><span class="annot"><span class="annottext">[Var] -&gt; [Coercion] -&gt; Subst
HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier hs-var">zipCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973822"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621682973828"><span class="hs-identifier hs-var">co_args</span></a></span><span>
</span><span id="line-2753"></span><span>    </span><span id="local-6989586621682973834"><span class="annot"><span class="annottext">target :: [LintedType]
</span><a href="#local-6989586621682973834"><span class="hs-identifier hs-var hs-var">target</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Subst -&gt; [LintedType] -&gt; [LintedType]
Subst -&gt; [LintedType] -&gt; [LintedType]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">Type.substTys</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682973830"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973794"><span class="hs-identifier hs-var">branch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2754"></span><span>    </span><span id="local-6989586621682973837"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621682973837"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">(IdSet -&gt; InScopeSet) -&gt; IdSet -&gt; InScopeSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2755"></span><span>               </span><span class="annot"><span class="annottext">[IdSet] -&gt; IdSet
</span><a href="GHC.Types.Var.Set.html#unionVarSets"><span class="hs-identifier hs-var">unionVarSets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CoAxBranch -&gt; IdSet) -&gt; [CoAxBranch] -&gt; [IdSet]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LintedType] -&gt; IdSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">([LintedType] -&gt; IdSet)
-&gt; (CoAxBranch -&gt; [LintedType]) -&gt; CoAxBranch -&gt; IdSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973808"><span class="hs-identifier hs-var">incomps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2756"></span><span>    </span><span id="local-6989586621682973807"><span class="annot"><span class="annottext">flattened_target :: [LintedType]
</span><a href="#local-6989586621682973807"><span class="hs-identifier hs-var hs-var">flattened_target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; [LintedType] -&gt; [LintedType]
</span><a href="GHC.Core.Unify.html#flattenTys"><span class="hs-identifier hs-var">flattenTys</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682973837"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973834"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-2757"></span><span>
</span><span id="line-2758"></span><span>    </span><span class="annot"><a href="#local-6989586621682973806"><span class="hs-identifier hs-type">check_no_conflict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span>
</span><span id="line-2759"></span><span>    </span><span id="local-6989586621682973806"><span class="annot"><span class="annottext">check_no_conflict :: [LintedType] -&gt; [CoAxBranch] -&gt; Maybe CoAxBranch
</span><a href="#local-6989586621682973806"><span class="hs-identifier hs-var hs-var">check_no_conflict</span></a></span></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoAxBranch
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2760"></span><span>    </span><span class="annot"><a href="#local-6989586621682973806"><span class="hs-identifier hs-var">check_no_conflict</span></a></span><span> </span><span id="local-6989586621682973842"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973842"><span class="hs-identifier hs-var">flat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973843"><span class="annot"><span class="annottext">b :: CoAxBranch
</span><a href="#local-6989586621682973843"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_lhs :: CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973845"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973845"><span class="hs-identifier hs-var">lhs_incomp</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682973846"><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973846"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2761"></span><span>         </span><span class="hs-comment">-- See Note [Apartness] in GHC.Core.FamInstEnv</span><span>
</span><span id="line-2762"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UnifyResultM Subst
</span><a href="GHC.Core.Unify.html#SurelyApart"><span class="hs-identifier hs-var">SurelyApart</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BindFun -&gt; [LintedType] -&gt; [LintedType] -&gt; UnifyResultM Subst
</span><a href="GHC.Core.Unify.html#tcUnifyTysFG"><span class="hs-identifier hs-var">tcUnifyTysFG</span></a></span><span> </span><span class="annot"><span class="annottext">BindFun
</span><a href="GHC.Core.Unify.html#alwaysBindFun"><span class="hs-identifier hs-var">alwaysBindFun</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973842"><span class="hs-identifier hs-var">flat</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973845"><span class="hs-identifier hs-var">lhs_incomp</span></a></span><span>
</span><span id="line-2763"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LintedType] -&gt; [CoAxBranch] -&gt; Maybe CoAxBranch
</span><a href="#local-6989586621682973806"><span class="hs-identifier hs-var">check_no_conflict</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973842"><span class="hs-identifier hs-var">flat</span></a></span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973846"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2764"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2765"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; Maybe CoAxBranch
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973843"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2766"></span><span>
</span><span id="line-2767"></span><span class="annot"><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-type">bad_ax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2768"></span><span id="bad_ax"><span class="annot"><span class="annottext">bad_ax :: Coercion -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#bad_ax"><span class="hs-identifier hs-var hs-var">bad_ax</span></a></span></span><span> </span><span id="local-6989586621682973850"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973850"><span class="hs-identifier hs-var">this_co</span></a></span></span><span> </span><span id="local-6989586621682973851"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973851"><span class="hs-identifier hs-var">what</span></a></span></span><span>
</span><span id="line-2769"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad axiom application&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973851"><span class="hs-identifier hs-var">what</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682973850"><span class="hs-identifier hs-var">this_co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2770"></span><span>
</span><span id="line-2771"></span><span>
</span><span id="line-2772"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
              Axioms
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2779"></span><span>
</span><span id="line-2780"></span><span class="annot"><a href="GHC.Core.Lint.html#lintAxioms"><span class="hs-identifier hs-type">lintAxioms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-2781"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span>
</span><span id="line-2782"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The source of the linted axioms</span></span><span>
</span><span id="line-2783"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2784"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2785"></span><span id="lintAxioms"><span class="annot"><span class="annottext">lintAxioms :: Logger -&gt; LintConfig -&gt; SDoc -&gt; [CoAxiom Branched] -&gt; IO ()
</span><a href="GHC.Core.Lint.html#lintAxioms"><span class="hs-identifier hs-var hs-var">lintAxioms</span></a></span></span><span> </span><span id="local-6989586621682973852"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682973852"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621682973853"><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682973853"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682973854"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973854"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span id="local-6989586621682973855"><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973855"><span class="hs-identifier hs-var">axioms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2786"></span><span>  </span><span class="annot"><span class="annottext">Logger -&gt; Bool -&gt; SDoc -&gt; SDoc -&gt; WarnsAndErrs -&gt; IO ()
</span><a href="GHC.Core.Lint.html#displayLintResults"><span class="hs-identifier hs-var">displayLintResults</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621682973852"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682973854"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CoAxiom Branched -&gt; SDoc) -&gt; [CoAxiom Branched] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall (br :: BranchFlag). CoAxiom br -&gt; SDoc
</span><a href="GHC.Core.Coercion.html#pprCoAxiom"><span class="hs-identifier hs-var">pprCoAxiom</span></a></span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973855"><span class="hs-identifier hs-var">axioms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(WarnsAndErrs -&gt; IO ()) -&gt; WarnsAndErrs -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2787"></span><span>  </span><span class="annot"><span class="annottext">LintConfig -&gt; LintM () -&gt; WarnsAndErrs
forall a. LintConfig -&gt; LintM a -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-var">initL</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682973853"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; WarnsAndErrs) -&gt; LintM () -&gt; WarnsAndErrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2788"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(CoAxiom Branched -&gt; LintM ()) -&gt; [CoAxiom Branched] -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom"><span class="hs-identifier hs-var">lint_axiom</span></a></span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973855"><span class="hs-identifier hs-var">axioms</span></a></span><span>
</span><span id="line-2789"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973858"><span class="annot"><span class="annottext">axiom_groups :: [NonEmpty (CoAxiom Branched)]
</span><a href="#local-6989586621682973858"><span class="hs-identifier hs-var hs-var">axiom_groups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoAxiom Branched -&gt; TyCon)
-&gt; [CoAxiom Branched] -&gt; [NonEmpty (CoAxiom Branched)]
forall (f :: * -&gt; *) b a.
(Foldable f, Eq b) =&gt;
(a -&gt; b) -&gt; f a -&gt; [NonEmpty a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#groupWith"><span class="hs-identifier hs-var">groupWith</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973855"><span class="hs-identifier hs-var">axioms</span></a></span><span>
</span><span id="line-2790"></span><span>     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (CoAxiom Branched) -&gt; LintM ())
-&gt; [NonEmpty (CoAxiom Branched)] -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (CoAxiom Branched) -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom_group"><span class="hs-identifier hs-var">lint_axiom_group</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty (CoAxiom Branched)]
</span><a href="#local-6989586621682973858"><span class="hs-identifier hs-var">axiom_groups</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2791"></span><span>
</span><span id="line-2792"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_axiom"><span class="hs-identifier hs-type">lint_axiom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2793"></span><span id="lint_axiom"><span class="annot"><span class="annottext">lint_axiom :: CoAxiom Branched -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom"><span class="hs-identifier hs-var hs-var">lint_axiom</span></a></span></span><span> </span><span id="local-6989586621682973860"><span class="annot"><span class="annottext">ax :: CoAxiom Branched
</span><a href="#local-6989586621682973860"><span class="hs-identifier hs-var">ax</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">co_ax_tc :: forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#co_ax_tc"><span class="hs-identifier hs-var">co_ax_tc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973863"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">co_ax_branches :: forall (br :: BranchFlag). CoAxiom br -&gt; Branches br
</span><a href="GHC.Core.Coercion.Axiom.html#co_ax_branches"><span class="hs-identifier hs-var">co_ax_branches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973865"><span class="annot"><span class="annottext">Branches Branched
</span><a href="#local-6989586621682973865"><span class="hs-identifier hs-var">branches</span></a></span></span><span>
</span><span id="line-2794"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">co_ax_role :: forall (br :: BranchFlag). CoAxiom br -&gt; Role
</span><a href="GHC.Core.Coercion.Axiom.html#co_ax_role"><span class="hs-identifier hs-var">co_ax_role</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973867"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973867"><span class="hs-identifier hs-var">ax_role</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2795"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; LintM () -&gt; LintM ()
forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var">addLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; LintLocInfo
</span><a href="GHC.Core.Lint.html#InAxiom"><span class="hs-identifier hs-var">InAxiom</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973860"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LintM () -&gt; LintM ()) -&gt; LintM () -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2796"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(CoAxBranch -&gt; LintM ()) -&gt; [CoAxBranch] -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; CoAxBranch -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_branch"><span class="hs-identifier hs-var">lint_branch</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973870"><span class="hs-identifier hs-var">branch_list</span></a></span><span>
</span><span id="line-2797"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LintM ()
</span><a href="#local-6989586621682973871"><span class="hs-identifier hs-var">extra_checks</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2798"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2799"></span><span>    </span><span id="local-6989586621682973870"><span class="annot"><span class="annottext">branch_list :: [CoAxBranch]
</span><a href="#local-6989586621682973870"><span class="hs-identifier hs-var hs-var">branch_list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Branches Branched -&gt; [CoAxBranch]
forall (br :: BranchFlag). Branches br -&gt; [CoAxBranch]
</span><a href="GHC.Core.Coercion.Axiom.html#fromBranches"><span class="hs-identifier hs-var">fromBranches</span></a></span><span> </span><span class="annot"><span class="annottext">Branches Branched
</span><a href="#local-6989586621682973865"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-2800"></span><span>
</span><span id="line-2801"></span><span>    </span><span id="local-6989586621682973871"><span class="annot"><span class="annottext">extra_checks :: LintM ()
</span><a href="#local-6989586621682973871"><span class="hs-identifier hs-var hs-var">extra_checks</span></a></span></span><span>
</span><span id="line-2802"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2803"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973873"><span class="annot"><a href="#local-6989586621682973873"><span class="hs-identifier hs-var">ax_tvs</span></a></span></span><span>
</span><span id="line-2804"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#cab_eta_tvs"><span class="hs-identifier hs-var">cab_eta_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973875"><span class="annot"><a href="#local-6989586621682973875"><span class="hs-identifier hs-var">eta_tvs</span></a></span></span><span>
</span><span id="line-2805"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#cab_cvs"><span class="hs-identifier hs-var">cab_cvs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973876"><span class="annot"><a href="#local-6989586621682973876"><span class="hs-identifier hs-var">cvs</span></a></span></span><span>
</span><span id="line-2806"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#cab_roles"><span class="hs-identifier hs-var">cab_roles</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973878"><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-var">roles</span></a></span></span><span>
</span><span id="line-2807"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973879"><span class="annot"><a href="#local-6989586621682973879"><span class="hs-identifier hs-var">lhs_tys</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2808"></span><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973870"><span class="hs-identifier hs-var">branch_list</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2809"></span><span>               </span><span class="hs-special">[</span><span id="local-6989586621682973880"><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973880"><span class="hs-identifier hs-var">branch</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; LintM CoAxBranch
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973880"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-2810"></span><span>               </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM CoAxBranch
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;multi-branch axiom with newtype&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2811"></span><span>
</span><span id="line-2812"></span><span>           </span><span class="hs-comment">-- The LHS of the axiom is (N lhs_tys)</span><span>
</span><span id="line-2813"></span><span>           </span><span class="hs-comment">-- We expect it to be      (N ax_tvs)</span><span>
</span><span id="line-2814"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-type">mkTyVarTys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973873"><span class="hs-identifier hs-type">ax_tvs</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqTypes"><span class="hs-operator hs-type">`eqTypes`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973879"><span class="hs-identifier hs-type">lhs_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2815"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom LHS does not match newtype definition&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2816"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682973876"><span class="hs-identifier hs-type">cvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2817"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom binds coercion variables&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2818"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682973875"><span class="hs-identifier hs-type">eta_tvs</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [Eta reduction for data families]</span><span>
</span><span id="line-2819"></span><span>                                   </span><span class="hs-comment">-- which is not about newtype axioms</span><span>
</span><span id="line-2820"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom has eta-tvs&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2821"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973867"><span class="hs-identifier hs-type">ax_role</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-type">Representational</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2822"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom role not representational&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2823"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-type">roles</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-type">`equalLength`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973873"><span class="hs-identifier hs-type">ax_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2824"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom roles list is the wrong length.&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span>
</span><span id="line-2825"></span><span>                    </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;roles:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-type">roles</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2826"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-type">roles</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#takeList"><span class="hs-identifier hs-type">takeList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-type">roles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConRoles"><span class="hs-identifier hs-var">tyConRoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973863"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2827"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype axiom roles do not match newtype tycon's.&quot;</span></span><span>
</span><span id="line-2828"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;axiom roles:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973878"><span class="hs-identifier hs-type">roles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2829"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;tycon roles:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#tyConRoles"><span class="hs-identifier hs-var">tyConRoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973863"><span class="hs-identifier hs-type">tc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2830"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-2831"></span><span>
</span><span id="line-2832"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2833"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTypeFamilyTyCon"><span class="hs-identifier hs-var">isTypeFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2834"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973867"><span class="hs-identifier hs-var">ax_role</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2835"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type family axiom is not nominal&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2836"></span><span>
</span><span id="line-2837"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-2838"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682973867"><span class="hs-identifier hs-var">ax_role</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Representational"><span class="hs-identifier hs-var">Representational</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2839"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;data family axiom is not representational&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2840"></span><span>
</span><span id="line-2841"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2842"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A family TyCon is neither a type family nor a data family:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2843"></span><span>
</span><span id="line-2844"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(CoAxBranch -&gt; LintM ()) -&gt; [CoAxBranch] -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; CoAxBranch -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_family_branch"><span class="hs-identifier hs-var">lint_family_branch</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973863"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973870"><span class="hs-identifier hs-var">branch_list</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2845"></span><span>
</span><span id="line-2846"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2847"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Axiom tycon is neither a newtype nor a family.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2848"></span><span>
</span><span id="line-2849"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_branch"><span class="hs-identifier hs-type">lint_branch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2850"></span><span id="lint_branch"><span class="annot"><span class="annottext">lint_branch :: TyCon -&gt; CoAxBranch -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_branch"><span class="hs-identifier hs-var hs-var">lint_branch</span></a></span></span><span> </span><span id="local-6989586621682973887"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973887"><span class="hs-identifier hs-var">ax_tc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973888"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973888"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_cvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_cvs"><span class="hs-identifier hs-var">cab_cvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973889"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973889"><span class="hs-identifier hs-var">cvs</span></a></span></span><span>
</span><span id="line-2851"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_lhs :: CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973890"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973890"><span class="hs-identifier hs-var">lhs_args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_rhs :: CoAxBranch -&gt; LintedType
</span><a href="GHC.Core.Coercion.Axiom.html#cab_rhs"><span class="hs-identifier hs-var">cab_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973892"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973892"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2852"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM ()) -&gt; LintM ()
forall a. BindingSite -&gt; [Var] -&gt; ([Var] -&gt; LintM a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#lintBinders"><span class="hs-identifier hs-var">lintBinders</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LambdaBind"><span class="hs-identifier hs-var">LambdaBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973888"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973889"><span class="hs-identifier hs-var">cvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Var] -&gt; LintM ()) -&gt; LintM ())
-&gt; ([Var] -&gt; LintM ()) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2853"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973893"><span class="annot"><span class="annottext">lhs :: LintedType
</span><a href="#local-6989586621682973893"><span class="hs-identifier hs-var hs-var hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [LintedType] -&gt; LintedType
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973887"><span class="hs-identifier hs-var">ax_tc</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973890"><span class="hs-identifier hs-var">lhs_args</span></a></span><span>
</span><span id="line-2854"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973895"><span class="annot"><a href="#local-6989586621682973895"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintM LintedType
</span><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-var">lintType</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973893"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-2855"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682973896"><span class="annot"><a href="#local-6989586621682973896"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintType"><span class="hs-identifier hs-type">lintType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973892"><span class="hs-identifier hs-type">rhs</span></a></span><span>
</span><span id="line-2856"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973897"><span class="annot"><a href="#local-6989586621682973897"><span class="hs-identifier hs-var hs-var">lhs_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973895"><span class="hs-identifier hs-var">lhs'</span></a></span><span>
</span><span id="line-2857"></span><span>             </span><span id="local-6989586621682973898"><span class="annot"><a href="#local-6989586621682973898"><span class="hs-identifier hs-var hs-var">rhs_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973896"><span class="hs-identifier hs-var">rhs'</span></a></span><span>
</span><span id="line-2858"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682973897"><span class="hs-identifier hs-type">lhs_kind</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Unify.html#typesAreApart"><span class="hs-operator hs-type">`typesAreApart`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973898"><span class="hs-identifier hs-type">rhs_kind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2859"></span><span>         </span><span class="annot"><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-type">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Inhomogeneous axiom&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2860"></span><span>            </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;lhs:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973893"><span class="hs-identifier hs-type">lhs</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973897"><span class="hs-identifier hs-type">lhs_kind</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span>
</span><span id="line-2861"></span><span>               </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rhs:&quot;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973892"><span class="hs-identifier hs-type">rhs</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-type">dcolon</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973898"><span class="hs-identifier hs-type">rhs_kind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2862"></span><span>         </span><span class="hs-comment">-- Type and Constraint are not Apart, so this test allows</span><span>
</span><span id="line-2863"></span><span>         </span><span class="hs-comment">-- the newtype axiom for a single-method class.  Indeed the</span><span>
</span><span id="line-2864"></span><span>         </span><span class="hs-comment">-- whole reason Type and Constraint are not Apart is to allow</span><span>
</span><span id="line-2865"></span><span>         </span><span class="hs-comment">-- such axioms!</span><span>
</span><span id="line-2866"></span><span>
</span><span id="line-2867"></span><span class="hs-comment">-- these checks do not apply to newtype axioms</span><span>
</span><span id="line-2868"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_family_branch"><span class="hs-identifier hs-type">lint_family_branch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2869"></span><span id="lint_family_branch"><span class="annot"><span class="annottext">lint_family_branch :: TyCon -&gt; CoAxBranch -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_family_branch"><span class="hs-identifier hs-var hs-var">lint_family_branch</span></a></span></span><span> </span><span id="local-6989586621682973900"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973900"><span class="hs-identifier hs-var">fam_tc</span></a></span></span><span> </span><span id="local-6989586621682973901"><span class="annot"><span class="annottext">br :: CoAxBranch
</span><a href="#local-6989586621682973901"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973902"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973902"><span class="hs-identifier hs-var">tvs</span></a></span></span><span>
</span><span id="line-2870"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_eta_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_eta_tvs"><span class="hs-identifier hs-var">cab_eta_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973903"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973903"><span class="hs-identifier hs-var">eta_tvs</span></a></span></span><span>
</span><span id="line-2871"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_cvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_cvs"><span class="hs-identifier hs-var">cab_cvs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973904"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973904"><span class="hs-identifier hs-var">cvs</span></a></span></span><span>
</span><span id="line-2872"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_roles :: CoAxBranch -&gt; [Role]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_roles"><span class="hs-identifier hs-var">cab_roles</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973905"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973905"><span class="hs-identifier hs-var">roles</span></a></span></span><span>
</span><span id="line-2873"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_lhs :: CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973906"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973906"><span class="hs-identifier hs-var">lhs</span></a></span></span><span>
</span><span id="line-2874"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_incomps :: CoAxBranch -&gt; [CoAxBranch]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_incomps"><span class="hs-identifier hs-var">cab_incomps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973908"><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973908"><span class="hs-identifier hs-var">incomps</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-2875"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973900"><span class="hs-identifier hs-var">fam_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973903"><span class="hs-identifier hs-var">eta_tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2876"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type family axiom has eta-tvs&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2877"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; IdSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType] -&gt; IdSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973906"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973902"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2878"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Quantified variable in family axiom unused in LHS&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2879"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LintedType -&gt; Bool) -&gt; [LintedType] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isTyFamFree"><span class="hs-identifier hs-var">isTyFamFree</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973906"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2880"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type family application on LHS of family axiom&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2881"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Role -&gt; Bool) -&gt; [Role] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973905"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2882"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-nominal role in family axiom&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-2883"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;roles:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Role -&gt; SDoc) -&gt; [Role] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621682973905"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2884"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973904"><span class="hs-identifier hs-var">cvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2885"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Coercion variables bound in family axiom&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2886"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[CoAxBranch] -&gt; (CoAxBranch -&gt; LintM ()) -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[CoAxBranch]
</span><a href="#local-6989586621682973908"><span class="hs-identifier hs-var">incomps</span></a></span><span> </span><span class="annot"><span class="annottext">((CoAxBranch -&gt; LintM ()) -&gt; LintM ())
-&gt; (CoAxBranch -&gt; LintM ()) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682973909"><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973909"><span class="hs-identifier hs-var">br'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2887"></span><span>           </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxBranch -&gt; CoAxBranch -&gt; Bool
</span><a href="GHC.Core.FamInstEnv.html#compatibleBranches"><span class="hs-identifier hs-var">compatibleBranches</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973901"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973909"><span class="hs-identifier hs-var">br'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2888"></span><span>           </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect incompatible branches:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2889"></span><span>              </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Branch:&quot;</span></span><span>       </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973901"><span class="hs-identifier hs-var">br</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2890"></span><span>                       </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bogus incomp:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973909"><span class="hs-identifier hs-var">br'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2891"></span><span>
</span><span id="line-2892"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_axiom_group"><span class="hs-identifier hs-type">lint_axiom_group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2893"></span><span id="lint_axiom_group"><span class="annot"><span class="annottext">lint_axiom_group :: NonEmpty (CoAxiom Branched) -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom_group"><span class="hs-identifier hs-var hs-var">lint_axiom_group</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2894"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_axiom_group"><span class="hs-identifier hs-var">lint_axiom_group</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973911"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973911"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621682973912"><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973912"><span class="hs-identifier hs-var">axs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2895"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isOpenFamilyTyCon"><span class="hs-identifier hs-var">isOpenFamilyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973914"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2896"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-open-family with multiple axioms&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2897"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682973915"><span class="annot"><span class="annottext">all_pairs :: [(CoAxiom Branched, CoAxiom Branched)]
</span><a href="#local-6989586621682973915"><span class="hs-identifier hs-var hs-var">all_pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973916"><span class="hs-identifier hs-var">ax1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973917"><span class="hs-identifier hs-var">ax2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682973916"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973916"><span class="hs-identifier hs-var">ax1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973918"><span class="hs-identifier hs-var">all_axs</span></a></span><span>
</span><span id="line-2898"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973917"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973917"><span class="hs-identifier hs-var">ax2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973918"><span class="hs-identifier hs-var">all_axs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2899"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">((CoAxiom Branched, CoAxiom Branched) -&gt; LintM ())
-&gt; [(CoAxiom Branched, CoAxiom Branched)] -&gt; LintM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; (CoAxiom Branched, CoAxiom Branched) -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom_pair"><span class="hs-identifier hs-var">lint_axiom_pair</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973914"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CoAxiom Branched, CoAxiom Branched)]
</span><a href="#local-6989586621682973915"><span class="hs-identifier hs-var">all_pairs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2900"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2901"></span><span>    </span><span id="local-6989586621682973918"><span class="annot"><span class="annottext">all_axs :: [CoAxiom Branched]
</span><a href="#local-6989586621682973918"><span class="hs-identifier hs-var hs-var">all_axs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973911"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; [CoAxiom Branched] -&gt; [CoAxiom Branched]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[CoAxiom Branched]
</span><a href="#local-6989586621682973912"><span class="hs-identifier hs-var">axs</span></a></span><span>
</span><span id="line-2902"></span><span>    </span><span id="local-6989586621682973914"><span class="annot"><span class="annottext">tc :: TyCon
</span><a href="#local-6989586621682973914"><span class="hs-identifier hs-var hs-var">tc</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; TyCon
forall (br :: BranchFlag). CoAxiom br -&gt; TyCon
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973911"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-2903"></span><span>
</span><span id="line-2904"></span><span class="annot"><a href="GHC.Core.Lint.html#lint_axiom_pair"><span class="hs-identifier hs-type">lint_axiom_pair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2905"></span><span id="lint_axiom_pair"><span class="annot"><span class="annottext">lint_axiom_pair :: TyCon -&gt; (CoAxiom Branched, CoAxiom Branched) -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lint_axiom_pair"><span class="hs-identifier hs-var hs-var">lint_axiom_pair</span></a></span></span><span> </span><span id="local-6989586621682973920"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973920"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682973921"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973921"><span class="hs-identifier hs-var">ax1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973922"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973922"><span class="hs-identifier hs-var">ax2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2906"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973923"><span class="annot"><span class="annottext">br1 :: CoAxBranch
</span><a href="#local-6989586621682973923"><span class="hs-identifier hs-var">br1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973924"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973924"><span class="hs-identifier hs-var">tvs1</span></a></span></span><span>
</span><span id="line-2907"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_lhs :: CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973925"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973925"><span class="hs-identifier hs-var">lhs1</span></a></span></span><span>
</span><span id="line-2908"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_rhs :: CoAxBranch -&gt; LintedType
</span><a href="GHC.Core.Coercion.Axiom.html#cab_rhs"><span class="hs-identifier hs-var">cab_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973926"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973926"><span class="hs-identifier hs-var">rhs1</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Maybe CoAxBranch
forall (br :: BranchFlag). CoAxiom br -&gt; Maybe CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomSingleBranch_maybe"><span class="hs-identifier hs-var">coAxiomSingleBranch_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973921"><span class="hs-identifier hs-var">ax1</span></a></span><span>
</span><span id="line-2909"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973928"><span class="annot"><span class="annottext">br2 :: CoAxBranch
</span><a href="#local-6989586621682973928"><span class="hs-identifier hs-var">br2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxBranch"><span class="hs-identifier hs-type">CoAxBranch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cab_tvs :: CoAxBranch -&gt; [Var]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_tvs"><span class="hs-identifier hs-var">cab_tvs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973929"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973929"><span class="hs-identifier hs-var">tvs2</span></a></span></span><span>
</span><span id="line-2910"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_lhs :: CoAxBranch -&gt; [LintedType]
</span><a href="GHC.Core.Coercion.Axiom.html#cab_lhs"><span class="hs-identifier hs-var">cab_lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973930"><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973930"><span class="hs-identifier hs-var">lhs2</span></a></span></span><span>
</span><span id="line-2911"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cab_rhs :: CoAxBranch -&gt; LintedType
</span><a href="GHC.Core.Coercion.Axiom.html#cab_rhs"><span class="hs-identifier hs-var">cab_rhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682973931"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973931"><span class="hs-identifier hs-var">rhs2</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Maybe CoAxBranch
forall (br :: BranchFlag). CoAxiom br -&gt; Maybe CoAxBranch
</span><a href="GHC.Core.Coercion.Axiom.html#coAxiomSingleBranch_maybe"><span class="hs-identifier hs-var">coAxiomSingleBranch_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973922"><span class="hs-identifier hs-var">ax2</span></a></span><span>
</span><span id="line-2912"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxBranch -&gt; CoAxBranch -&gt; Bool
</span><a href="GHC.Core.FamInstEnv.html#compatibleBranches"><span class="hs-identifier hs-var">compatibleBranches</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973923"><span class="hs-identifier hs-var">br1</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxBranch
</span><a href="#local-6989586621682973928"><span class="hs-identifier hs-var">br2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2913"></span><span>    </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Axioms&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973921"><span class="hs-identifier hs-var">ax1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;and&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973922"><span class="hs-identifier hs-var">ax2</span></a></span><span>
</span><span id="line-2914"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;are incompatible&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2915"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tvs1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier hs-var">pprTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973924"><span class="hs-identifier hs-var">tvs1</span></a></span><span>
</span><span id="line-2916"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lhs1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [LintedType] -&gt; LintedType
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973920"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973925"><span class="hs-identifier hs-var">lhs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2917"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rhs1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973926"><span class="hs-identifier hs-var">rhs1</span></a></span><span>
</span><span id="line-2918"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tvs2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprTyVars"><span class="hs-identifier hs-var">pprTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682973929"><span class="hs-identifier hs-var">tvs2</span></a></span><span>
</span><span id="line-2919"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lhs2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [LintedType] -&gt; LintedType
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682973920"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[LintedType]
</span><a href="#local-6989586621682973930"><span class="hs-identifier hs-var">lhs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2920"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rhs2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682973931"><span class="hs-identifier hs-var">rhs2</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2921"></span><span>
</span><span id="line-2922"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-2923"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var">addErrL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Open type family axiom has more than one branch: either&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-2924"></span><span>             </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973921"><span class="hs-identifier hs-var">ax1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682973922"><span class="hs-identifier hs-var">ax2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2925"></span><span>
</span><span id="line-2926"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[lint-monad]{The Lint monad}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-2933"></span><span>
</span><span id="line-2934"></span><span class="hs-comment">-- If you edit this type, you may need to update the GHC formalism</span><span>
</span><span id="line-2935"></span><span class="hs-comment">-- See Note [GHC Formalism]</span><span>
</span><span id="line-2936"></span><span class="hs-keyword">data</span><span> </span><span id="LintEnv"><span class="annot"><a href="GHC.Core.Lint.html#LintEnv"><span class="hs-identifier hs-var">LintEnv</span></a></span></span><span>
</span><span id="line-2937"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LE"><span class="annot"><a href="GHC.Core.Lint.html#LE"><span class="hs-identifier hs-var">LE</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="le_flags"><span class="annot"><span class="annottext">LintEnv -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var hs-var">le_flags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a></span><span>       </span><span class="hs-comment">-- Linting the result of this pass</span><span>
</span><span id="line-2938"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_loc"><span class="annot"><span class="annottext">LintEnv -&gt; [LintLocInfo]
</span><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var hs-var">le_loc</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Lint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Locations</span><span>
</span><span id="line-2939"></span><span>
</span><span id="line-2940"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_subst"><span class="annot"><span class="annottext">LintEnv -&gt; Subst
</span><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var hs-var">le_subst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>  </span><span class="hs-comment">-- Current TyCo substitution</span><span>
</span><span id="line-2941"></span><span>                               </span><span class="hs-comment">--    See Note [Linting type lets]</span><span>
</span><span id="line-2942"></span><span>            </span><span class="hs-comment">-- /Only/ substitutes for type variables;</span><span>
</span><span id="line-2943"></span><span>            </span><span class="hs-comment">--        but might clone CoVars</span><span>
</span><span id="line-2944"></span><span>            </span><span class="hs-comment">-- We also use le_subst to keep track of</span><span>
</span><span id="line-2945"></span><span>            </span><span class="hs-comment">-- in-scope TyVars and CoVars (but not Ids)</span><span>
</span><span id="line-2946"></span><span>            </span><span class="hs-comment">-- Range of the Subst is LintedType/LintedCo</span><span>
</span><span id="line-2947"></span><span>
</span><span id="line-2948"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_ids"><span class="annot"><span class="annottext">LintEnv -&gt; VarEnv (Var, LintedType)
</span><a href="GHC.Core.Lint.html#le_ids"><span class="hs-identifier hs-var hs-var">le_ids</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- In-scope Ids</span><span>
</span><span id="line-2949"></span><span>            </span><span class="hs-comment">-- Used to check that occurrences have an enclosing binder.</span><span>
</span><span id="line-2950"></span><span>            </span><span class="hs-comment">-- The Id is /pre-substitution/, used to check that</span><span>
</span><span id="line-2951"></span><span>            </span><span class="hs-comment">-- the occurrence has an identical type to the binder</span><span>
</span><span id="line-2952"></span><span>            </span><span class="hs-comment">-- The LintedType is used to return the type of the occurrence,</span><span>
</span><span id="line-2953"></span><span>            </span><span class="hs-comment">-- without having to lint it again.</span><span>
</span><span id="line-2954"></span><span>
</span><span id="line-2955"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_joins"><span class="annot"><span class="annottext">LintEnv -&gt; IdSet
</span><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var hs-var">le_joins</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#IdSet"><span class="hs-identifier hs-type">IdSet</span></a></span><span>     </span><span class="hs-comment">-- Join points in scope that are valid</span><span>
</span><span id="line-2956"></span><span>                               </span><span class="hs-comment">-- A subset of the InScopeSet in le_subst</span><span>
</span><span id="line-2957"></span><span>                               </span><span class="hs-comment">-- See Note [Join points]</span><span>
</span><span id="line-2958"></span><span>
</span><span id="line-2959"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_ue_aliases"><span class="annot"><span class="annottext">LintEnv -&gt; NameEnv UsageEnv
</span><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var hs-var">le_ue_aliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span> </span><span class="hs-comment">-- Assigns usage environments to the</span><span>
</span><span id="line-2960"></span><span>                                           </span><span class="hs-comment">-- alias-like binders, as found in</span><span>
</span><span id="line-2961"></span><span>                                           </span><span class="hs-comment">-- non-recursive lets.</span><span>
</span><span id="line-2962"></span><span>
</span><span id="line-2963"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_platform"><span class="annot"><span class="annottext">LintEnv -&gt; Platform
</span><a href="GHC.Core.Lint.html#le_platform"><span class="hs-identifier hs-var hs-var">le_platform</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Target platform</span></span><span>
</span><span id="line-2964"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="le_diagOpts"><span class="annot"><span class="annottext">LintEnv -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#le_diagOpts"><span class="hs-identifier hs-var hs-var">le_diagOpts</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#DiagOpts"><span class="hs-identifier hs-type">DiagOpts</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Target platform</span></span><span>
</span><span id="line-2965"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-2966"></span><span>
</span><span id="line-2967"></span><span class="hs-keyword">data</span><span> </span><span id="LintFlags"><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-var">LintFlags</span></a></span></span><span>
</span><span id="line-2968"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LF"><span class="annot"><a href="GHC.Core.Lint.html#LF"><span class="hs-identifier hs-var">LF</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="lf_check_global_ids"><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_global_ids"><span class="hs-identifier hs-var hs-var">lf_check_global_ids</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- See Note [Checking for global Ids]</span><span>
</span><span id="line-2969"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="lf_check_inline_loop_breakers"><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_inline_loop_breakers"><span class="hs-identifier hs-var hs-var">lf_check_inline_loop_breakers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- See Note [Checking for INLINE loop breakers]</span><span>
</span><span id="line-2970"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="lf_check_static_ptrs"><span class="annot"><span class="annottext">LintFlags -&gt; StaticPtrCheck
</span><a href="GHC.Core.Lint.html#lf_check_static_ptrs"><span class="hs-identifier hs-var hs-var">lf_check_static_ptrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#StaticPtrCheck"><span class="hs-identifier hs-type">StaticPtrCheck</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ See Note [Checking StaticPtrs]</span></span><span>
</span><span id="line-2971"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="lf_report_unsat_syns"><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_report_unsat_syns"><span class="hs-identifier hs-var hs-var">lf_report_unsat_syns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ See Note [Linting type synonym applications]</span></span><span>
</span><span id="line-2972"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="lf_check_linearity"><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_linearity"><span class="hs-identifier hs-var hs-var">lf_check_linearity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ See Note [Linting linearity]</span></span><span>
</span><span id="line-2973"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="lf_check_fixed_rep"><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_fixed_rep"><span class="hs-identifier hs-var hs-var">lf_check_fixed_rep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- See Note [Checking for representation polymorphism]</span><span>
</span><span id="line-2974"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-2975"></span><span>
</span><span id="line-2976"></span><span class="hs-comment">-- See Note [Checking StaticPtrs]</span><span>
</span><span id="line-2977"></span><span class="hs-keyword">data</span><span> </span><span id="StaticPtrCheck"><span class="annot"><a href="GHC.Core.Lint.html#StaticPtrCheck"><span class="hs-identifier hs-var">StaticPtrCheck</span></a></span></span><span>
</span><span id="line-2978"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="AllowAnywhere"><span class="annot"><a href="GHC.Core.Lint.html#AllowAnywhere"><span class="hs-identifier hs-var">AllowAnywhere</span></a></span></span><span>
</span><span id="line-2979"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Allow 'makeStatic' to occur anywhere.</span></span><span>
</span><span id="line-2980"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AllowAtTopLevel"><span class="annot"><a href="GHC.Core.Lint.html#AllowAtTopLevel"><span class="hs-identifier hs-var">AllowAtTopLevel</span></a></span></span><span>
</span><span id="line-2981"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Allow 'makeStatic' calls at the top-level only.</span></span><span>
</span><span id="line-2982"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RejectEverywhere"><span class="annot"><a href="GHC.Core.Lint.html#RejectEverywhere"><span class="hs-identifier hs-var">RejectEverywhere</span></a></span></span><span>
</span><span id="line-2983"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Reject any 'makeStatic' occurrence.</span></span><span>
</span><span id="line-2984"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682973946"><span id="local-6989586621682973951"><span class="annot"><span class="annottext">StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool
(StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool)
-&gt; (StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool) -&gt; Eq StaticPtrCheck
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool
== :: StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool
$c/= :: StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool
/= :: StaticPtrCheck -&gt; StaticPtrCheck -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-2985"></span><span>
</span><span id="line-2986"></span><span class="hs-keyword">newtype</span><span> </span><span id="LintM"><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span></span><span> </span><span id="local-6989586621682970586"><span class="annot"><a href="#local-6989586621682970586"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2987"></span><span>   </span><span id="LintM%27"><span class="annot"><a href="GHC.Core.Lint.html#LintM%27"><span class="hs-identifier hs-var">LintM'</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unLintM"><span class="annot"><span class="annottext">forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var hs-var">unLintM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2988"></span><span>            </span><span class="annot"><a href="GHC.Core.Lint.html#LintEnv"><span class="hs-identifier hs-type">LintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2989"></span><span>            </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>           </span><span class="hs-comment">-- Warning and error messages so far</span><span>
</span><span id="line-2990"></span><span>            </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970586"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- Result and messages (if any)</span><span>
</span><span id="line-2991"></span><span>
</span><span id="line-2992"></span><span>
</span><span id="line-2993"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682970590"><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintEnv"><span class="hs-identifier hs-type">LintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970590"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970590"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2994"></span><span class="hs-comment">-- See Note [The one-shot state monad trick] in GHC.Utils.Monad</span><span>
</span><span id="line-2995"></span><span class="hs-keyword">pattern</span><span> </span><span id="LintM"><span id="%24mLintM"><span id="%24bLintM"><span class="annot"><span class="annottext">$mLintM :: forall {r} {a}.
LintM a
-&gt; ((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; r)
-&gt; ((# #) -&gt; r)
-&gt; r
$bLintM :: forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var hs-var hs-var">LintM</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682973959"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM%27"><span class="hs-identifier hs-type">LintM'</span></a></span><span> </span><span id="local-6989586621682973959"><span class="annot"><a href="#local-6989586621682973959"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-2996"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2997"></span><span>    </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span id="local-6989586621682973960"><span class="annot"><span class="annottext">LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="#local-6989586621682973960"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM%27"><span class="hs-identifier hs-var">LintM'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a)
-&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a)
 -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a)
-&gt; LintEnv
-&gt; WarnsAndErrs
-&gt; LResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973961"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682973961"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(WarnsAndErrs -&gt; LResult a) -&gt; WarnsAndErrs -&gt; LResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="annot"><span class="annottext">((WarnsAndErrs -&gt; LResult a) -&gt; WarnsAndErrs -&gt; LResult a)
-&gt; (WarnsAndErrs -&gt; LResult a) -&gt; WarnsAndErrs -&gt; LResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973962"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973962"><span class="hs-identifier hs-var">we</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="#local-6989586621682973960"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682973961"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973962"><span class="hs-identifier hs-var">we</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2998"></span><span>    </span><span class="hs-comment">-- LintM m = LintM' (oneShot $ oneShot m)</span><span>
</span><span id="line-2999"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-pragma hs-type">LintM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3000"></span><span>
</span><span id="line-3001"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682973965"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3002"></span><span>  </span><span id="local-6989586621682973968"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; LintM a -&gt; LintM b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621682973969"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682973969"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span id="local-6989586621682973970"><span class="annot"><span class="annottext">LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="#local-6989586621682973970"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult b) -&gt; LintM b
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult b) -&gt; LintM b)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult b) -&gt; LintM b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682973971"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682973971"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682973972"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973972"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; LResult a -&gt; LResult b
forall a1 a2. (a1 -&gt; a2) -&gt; LResult a1 -&gt; LResult a2
</span><a href="GHC.Core.Lint.html#mapLResult"><span class="hs-identifier hs-var">mapLResult</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621682973969"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="#local-6989586621682973970"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682973971"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973972"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3003"></span><span>
</span><span id="line-3004"></span><span class="hs-keyword">type</span><span> </span><span id="WarnsAndErrs"><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-var">WarnsAndErrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3005"></span><span>
</span><span id="line-3006"></span><span class="hs-comment">-- Using a unboxed tuple here reduced allocations for a lint heavy</span><span>
</span><span id="line-3007"></span><span class="hs-comment">-- file by ~6%. Using MaybeUB reduced them further by another ~12%.</span><span>
</span><span id="line-3008"></span><span class="hs-keyword">type</span><span> </span><span id="LResult"><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span></span><span> </span><span id="local-6989586621682973974"><span class="annot"><a href="#local-6989586621682973974"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="GHC.Data.Unboxed.html#MaybeUB"><span class="hs-identifier hs-type">MaybeUB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973974"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-3009"></span><span>
</span><span id="line-3010"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682970598"><span class="annot"><a href="GHC.Data.Unboxed.html#MaybeUB"><span class="hs-identifier hs-type">MaybeUB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970598"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3011"></span><span class="hs-keyword">pattern</span><span> </span><span id="LResult"><span id="%24mLResult"><span id="%24bLResult"><span class="annot"><span class="annottext">$mLResult :: forall {r} {a}.
LResult a -&gt; (MaybeUB a -&gt; WarnsAndErrs -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLResult :: forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var hs-var hs-var">LResult</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682973978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682973979"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621682973978"><span class="annot"><a href="#local-6989586621682973978"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973979"><span class="annot"><a href="#local-6989586621682973979"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-3012"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-pragma hs-type">LResult</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-3013"></span><span>
</span><span id="line-3014"></span><span id="local-6989586621682970595"><span id="local-6989586621682970596"><span class="annot"><a href="GHC.Core.Lint.html#mapLResult"><span class="hs-identifier hs-type">mapLResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682970595"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970596"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970595"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970596"><span class="hs-identifier hs-type">a2</span></a></span></span></span><span>
</span><span id="line-3015"></span><span id="mapLResult"><span class="annot"><span class="annottext">mapLResult :: forall a1 a2. (a1 -&gt; a2) -&gt; LResult a1 -&gt; LResult a2
</span><a href="GHC.Core.Lint.html#mapLResult"><span class="hs-identifier hs-var hs-var">mapLResult</span></a></span></span><span> </span><span id="local-6989586621682973980"><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621682973980"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span id="local-6989586621682973981"><span class="annot"><span class="annottext">MaybeUB a1
</span><a href="#local-6989586621682973981"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621682973982"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973982"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeUB a2 -&gt; WarnsAndErrs -&gt; LResult a2
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a1 -&gt; a2) -&gt; MaybeUB a1 -&gt; MaybeUB a2
forall a b. (a -&gt; b) -&gt; MaybeUB a -&gt; MaybeUB b
</span><a href="GHC.Data.Unboxed.html#fmapMaybeUB"><span class="hs-identifier hs-var">fmapMaybeUB</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621682973980"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeUB a1
</span><a href="#local-6989586621682973981"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973982"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-3016"></span><span>
</span><span id="line-3017"></span><span class="hs-comment">-- Just for testing.</span><span>
</span><span id="line-3018"></span><span id="local-6989586621682970606"><span class="annot"><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-type">fromBoxedLResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682970606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970606"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3019"></span><span id="fromBoxedLResult"><span class="annot"><span class="annottext">fromBoxedLResult :: forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var hs-var">fromBoxedLResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682973985"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682973985"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682973986"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973986"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; MaybeUB a
forall a. a -&gt; MaybeUB a
</span><a href="GHC.Data.Unboxed.html#JustUB"><span class="hs-identifier hs-var">JustUB</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682973985"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973986"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3020"></span><span class="annot"><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span id="local-6989586621682973988"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973988"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="annot"><span class="annottext">(# #) -&gt; forall a. MaybeUB a
forall a. MaybeUB a
</span><a href="GHC.Data.Unboxed.html#NothingUB"><span class="hs-identifier hs-var">NothingUB</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682973988"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3021"></span><span>
</span><span id="line-3022"></span><span class="hs-comment">{- Note [Checking for global Ids]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Before CoreTidy, all locally-bound Ids must be LocalIds, even
top-level ones. See Note [Exported LocalIds] and #9857.

Note [Checking StaticPtrs]
~~~~~~~~~~~~~~~~~~~~~~~~~~
See Note [Grand plan for static forms] in GHC.Iface.Tidy.StaticPtrTable for an overview.

Every occurrence of the function 'makeStatic' should be moved to the
top level by the FloatOut pass.  It's vital that we don't have nested
'makeStatic' occurrences after CorePrep, because we populate the Static
Pointer Table from the top-level bindings. See SimplCore Note [Grand
plan for static forms].

The linter checks that no occurrence is left behind, nested within an
expression. The check is enabled only after the FloatOut, CorePrep,
and CoreTidy passes and only if the module uses the StaticPointers
language extension. Checking more often doesn't help since the condition
doesn't hold until after the first FloatOut pass.

Note [Type substitution]
~~~~~~~~~~~~~~~~~~~~~~~~
Why do we need a type substitution?  Consider
        /\(a:*). \(x:a). /\(a:*). id a x
This is ill typed, because (renaming variables) it is really
        /\(a:*). \(x:a). /\(b:*). id b x
Hence, when checking an application, we can't naively compare x's type
(at its binding site) with its expected type (at a use site).  So we
rename type binders as we go, maintaining a substitution.

The same substitution also supports let-type, current expressed as
        (/\(a:*). body) ty
Here we substitute 'ty' for 'a' in 'body', on the fly.

Note [Linting type synonym applications]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When linting a type-synonym, or type-family, application
  S ty1 .. tyn
we behave as follows (#15057, #T15664):

* If lf_report_unsat_syns = True, and S has arity &lt; n,
  complain about an unsaturated type synonym or type family

* Switch off lf_report_unsat_syns, and lint ty1 .. tyn.

  Reason: catch out of scope variables or other ill-kinded gubbins,
  even if S discards that argument entirely. E.g. (#15012):
     type FakeOut a = Int
     type family TF a
     type instance TF Int = FakeOut a
  Here 'a' is out of scope; but if we expand FakeOut, we conceal
  that out-of-scope error.

  Reason for switching off lf_report_unsat_syns: with
  LiberalTypeSynonyms, GHC allows unsaturated synonyms provided they
  are saturated when the type is expanded. Example
     type T f = f Int
     type S a = a -&gt; a
     type Z = T S
  In Z's RHS, S appears unsaturated, but it is saturated when T is expanded.

* If lf_report_unsat_syns is on, expand the synonym application and
  lint the result.  Reason: want to check that synonyms are saturated
  when the type is expanded.

Note [Linting linearity]
~~~~~~~~~~~~~~~~~~~~~~~~
Lint ignores linearity unless `-dlinear-core-lint` is set.  For why, see below.

But first, &quot;ignore linearity&quot; specifically means two things. When ignoring linearity:
* In `ensureEqTypes`, use `eqTypeIgnoringMultiplicity`
* In `ensureSubMult`, do nothing

But why make `-dcore-lint` ignore linearity?  Because optimisation passes are
not (yet) guaranteed to maintain linearity.  They should do so semantically (GHC
is careful not to duplicate computation) but it is much harder to ensure that
the statically-checkable constraints of Linear Core are maintained. The current
Linear Core is described in the wiki at:
https://gitlab.haskell.org/ghc/ghc/-/wikis/linear-types/implementation.

Here are some examples of how the optimiser can break linearity checking.  Other
examples are documented in the linear-type implementation wiki page
[https://gitlab.haskell.org/ghc/ghc/-/wikis/linear-types/implementation#core-to-core-passes]

* EXAMPLE 1: the binder swap transformation
    Consider

      data T = MkT {-# UNPACK #-} !Int

    The wrapper for MkT is

      $wMkT :: Int %1 -&gt; T
      $wMkT n = case %1 n of
        I# n' -&gt; MkT n'

    This introduces, in particular, a `case %1` (this is not actual Haskell or
    Core syntax), where the `%1` means that the `case` expression consumes its
    scrutinee linearly.

    Now, `case %1` interacts with the binder swap optimisation in a non-trivial
    way. Take a slightly modified version of the code for $wMkT:

      case %1 x of z {
        I# n' -&gt; (x, n')
      }

    Binder-swap changes this to

      case %1 x of z {
        I# n' -&gt; let x = z in (x, n')
      }

    This is rejected by `-dlinear-core-lint` because 1/ n' must be used linearly
    2/ `-dlinear-core-lint` recognises a use of `z` as a use of `n'`. So it sees
    two uses of n' where there should be a single one.

* EXAMPLE 2: letrec
    Some optimisations can create a letrec which uses a variable
    linearly, e.g.

      letrec f True = f False
             f False = x
      in f True

    uses 'x' linearly, but this is not seen by the linter, which considers,
    conservatively, that a letrec always has multiplicity Many (in particular
    that every captured free variable must have multiplicity Many). This issue
    is discussed in ticket #18694.

* EXAMPLE 3: rewrite rules
    Ignoring linearity means in particular that `a -&gt; b` and `a %1 -&gt; b` must be
    treated the same by rewrite rules (see also Note [Rewrite rules ignore
    multiplicities in FunTy] in GHC.Core.Unify). Consider

      m :: Bool -&gt; A
      m' :: (Bool -&gt; Bool) -&gt; A
      {- RULES &quot;ex&quot; forall f. m (f True) = m' f -}

      f :: Bool %1 -&gt; A
      x = m (f True)

    The rule &quot;ex&quot; must match . So the linter must accept `m' f`.

* EXAMPLE 4: eta-reduction
   Eta-expansion can change linear functions into unrestricted functions

     f :: A %1 -&gt; B

     g :: A %Many -&gt; B
     g = \x -&gt; f x

   Eta-reduction undoes this and produces:

     g :: A %Many -&gt; B
     g = f

Historical note: In the original linear-types implementation, we had tried to
make every optimisation pass produce code that passes `-dlinear-core-lint`. It
had proved very difficult. We kept finding corner case after corner
case. Furthermore, to attempt to achieve that goal we ended up restricting
transformations when `-dlinear-core-lint` couldn't typecheck the result.

In the future, we may be able to lint the linearity of the output of
Core-to-Core passes (#19165). But this shouldn't be done at the expense of
producing efficient code. Therefore we lay the following principle.

PRINCIPLE: The type system bends to the optimisation, not the other way around.

There is a useful discussion at https://gitlab.haskell.org/ghc/ghc/-/issues/22123

Note [Linting representation-polymorphic builtins]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As described in Note [Representation-polymorphism checking built-ins], on
top of the two main representation-polymorphism invariants described in the
Note [Representation polymorphism invariants], we must perform additional
representation-polymorphism checks on builtin functions which don't have a
binding, for example to ensure that we don't run afoul of the
representation-polymorphism invariants when eta-expanding.

There are two situations:

  1. Builtins which have skolem type variables which must be instantiated to
     concrete types, such as the RuntimeRep type argument r to the catch# primop.

  2. Representation-polymorphic unlifted newtypes, which must always be instantiated
     at a fixed runtime representation.

For 1, consider for example 'coerce':

  coerce :: forall {r} (a :: TYPE r) (b :: TYPE r). Coercible a b =&gt; a -&gt; b

We store in the IdDetails of the coerce Id that the first binder, r, must always
be instantiated to a concrete type. We thus check this in Core Lint: whenever we
see an application of the form

  coerce @{rep1} ...

we ensure that 'rep1' is concrete. This is done in the function &quot;checkRepPolyBuiltinApp&quot;.
Moreover, not instantiating these type variables at all is also an error, as
we would again not be able to perform eta-expansion. (This is a bit more theoretical,
as in user programs the typechecker will insert these type applications when
instantiating, but it can still arise when constructing Core expressions).

For 2, whenever we have an unlifted newtype such as

  type RR :: Type -&gt; RuntimeRep
  type family RR a

  type F :: forall (a :: Type) -&gt; TYPE (RR a)
  type family F a

  type N :: forall (a :: Type) -&gt; TYPE (RR a)
  newtype N a = MkN (F a)

and an unsaturated occurrence

  MkN @ty -- NB: no value argument!

we check that the (instantiated) argument type has a fixed runtime representation.
This is done in the function &quot;checkRepPolyNewtypeApp&quot;.
-}</span><span>
</span><span id="line-3244"></span><span>
</span><span id="line-3245"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682973995"><span id="local-6989586621682973998"><span id="local-6989586621682974001"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3246"></span><span>      </span><span id="local-6989586621682974004"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; LintM a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621682974005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682974005"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682974006"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974006"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; MaybeUB a
forall a. a -&gt; MaybeUB a
</span><a href="GHC.Data.Unboxed.html#JustUB"><span class="hs-identifier hs-var">JustUB</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682974005"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974006"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3247"></span><span>                                   </span><span class="hs-comment">--(Just x, errs)</span><span>
</span><span id="line-3248"></span><span>      </span><span id="local-6989586621682974008"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. LintM (a -&gt; b) -&gt; LintM a -&gt; LintM b
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM (a -&gt; b) -&gt; LintM a -&gt; LintM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-3249"></span><span>
</span><span id="line-3250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682974014"><span id="local-6989586621682974017"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3251"></span><span>  </span><span id="local-6989586621682974020"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974020"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682974021"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. LintM a -&gt; (a -&gt; LintM b) -&gt; LintM b
</span><span class="hs-operator hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621682974022"><span class="annot"><span class="annottext">a -&gt; LintM b
</span><a href="#local-6989586621682974022"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult b) -&gt; LintM b
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974023"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974023"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974024"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974024"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3252"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974025"><span class="annot"><span class="annottext">res :: LResult a
</span><a href="#local-6989586621682974025"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974020"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974023"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974024"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-3253"></span><span>                         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LResult a
</span><a href="#local-6989586621682974025"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3254"></span><span>                           </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Unboxed.html#JustUB"><span class="hs-identifier hs-type">JustUB</span></a></span><span> </span><span id="local-6989586621682974026"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682974026"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682974027"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974027"><span class="hs-identifier hs-var">errs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintM b -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult b
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; LintM b
</span><a href="#local-6989586621682974022"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682974026"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974023"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974027"><span class="hs-identifier hs-var">errs'</span></a></span><span>
</span><span id="line-3255"></span><span>                           </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeUB a
</span><a href="GHC.Data.Unboxed.html#NothingUB"><span class="hs-identifier hs-var">NothingUB</span></a></span><span> </span><span id="local-6989586621682974028"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974028"><span class="hs-identifier hs-var">errs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaybeUB b -&gt; WarnsAndErrs -&gt; LResult b
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="annot"><span class="annottext">(# #) -&gt; forall a. MaybeUB a
forall a. MaybeUB a
</span><a href="GHC.Data.Unboxed.html#NothingUB"><span class="hs-identifier hs-var">NothingUB</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974028"><span class="hs-identifier hs-var">errs'</span></a></span><span>
</span><span id="line-3256"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-3257"></span><span>                          </span><span class="hs-comment">--  LError errs'-&gt; LError errs')</span><span>
</span><span id="line-3258"></span><span>                      </span><span class="hs-comment">--  let (res, errs') = unLintM m env errs in</span><span>
</span><span id="line-3259"></span><span>                          </span><span class="hs-comment">--  Just r -&gt; unLintM (k r) env errs'</span><span>
</span><span id="line-3260"></span><span>                          </span><span class="hs-comment">--  Nothing -&gt; (Nothing, errs'))</span><span>
</span><span id="line-3261"></span><span>
</span><span id="line-3262"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3263"></span><span>    </span><span id="local-6989586621682974035"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; LintM a
</span><span class="hs-identifier hs-var hs-var hs-var">fail</span></span></span><span> </span><span id="local-6989586621682974036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974036"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM a
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974036"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3264"></span><span>
</span><span id="line-3265"></span><span class="annot"><a href="GHC.Core.Lint.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-3266"></span><span id="getPlatform"><span class="annot"><span class="annottext">getPlatform :: LintM Platform
</span><a href="GHC.Core.Lint.html#getPlatform"><span class="hs-identifier hs-var hs-var">getPlatform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult Platform) -&gt; LintM Platform
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974037"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974037"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682974038"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974038"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeUB Platform -&gt; WarnsAndErrs -&gt; LResult Platform
forall a. MaybeUB a -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-var">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; MaybeUB Platform
forall a. a -&gt; MaybeUB a
</span><a href="GHC.Data.Unboxed.html#JustUB"><span class="hs-identifier hs-var">JustUB</span></a></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; MaybeUB Platform) -&gt; Platform -&gt; MaybeUB Platform
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintEnv -&gt; Platform
</span><a href="GHC.Core.Lint.html#le_platform"><span class="hs-identifier hs-var">le_platform</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974037"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974038"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3267"></span><span>
</span><span id="line-3268"></span><span class="hs-keyword">data</span><span> </span><span id="LintLocInfo"><span class="annot"><a href="GHC.Core.Lint.html#LintLocInfo"><span class="hs-identifier hs-var">LintLocInfo</span></a></span></span><span>
</span><span id="line-3269"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RhsOf"><span class="annot"><a href="GHC.Core.Lint.html#RhsOf"><span class="hs-identifier hs-var">RhsOf</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>            </span><span class="hs-comment">-- The variable bound</span><span>
</span><span id="line-3270"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OccOf"><span class="annot"><a href="GHC.Core.Lint.html#OccOf"><span class="hs-identifier hs-var">OccOf</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>            </span><span class="hs-comment">-- Occurrence of id</span><span>
</span><span id="line-3271"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LambdaBodyOf"><span class="annot"><a href="GHC.Core.Lint.html#LambdaBodyOf"><span class="hs-identifier hs-var">LambdaBodyOf</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>     </span><span class="hs-comment">-- The lambda-binder</span><span>
</span><span id="line-3272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RuleOf"><span class="annot"><a href="GHC.Core.Lint.html#RuleOf"><span class="hs-identifier hs-var">RuleOf</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>           </span><span class="hs-comment">-- Rules attached to a binder</span><span>
</span><span id="line-3273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnfoldingOf"><span class="annot"><a href="GHC.Core.Lint.html#UnfoldingOf"><span class="hs-identifier hs-var">UnfoldingOf</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>      </span><span class="hs-comment">-- Unfolding of a binder</span><span>
</span><span id="line-3274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BodyOfLet"><span class="annot"><a href="GHC.Core.Lint.html#BodyOfLet"><span class="hs-identifier hs-var">BodyOfLet</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>        </span><span class="hs-comment">-- The let-bound variable</span><span>
</span><span id="line-3275"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BodyOfLetRec"><span class="annot"><a href="GHC.Core.Lint.html#BodyOfLetRec"><span class="hs-identifier hs-var">BodyOfLetRec</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- The binders of the let</span><span>
</span><span id="line-3276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CaseAlt"><span class="annot"><a href="GHC.Core.Lint.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span>     </span><span class="hs-comment">-- Case alternative</span><span>
</span><span id="line-3277"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CasePat"><span class="annot"><a href="GHC.Core.Lint.html#CasePat"><span class="hs-identifier hs-var">CasePat</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span>     </span><span class="hs-comment">-- The *pattern* of the case alternative</span><span>
</span><span id="line-3278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CaseTy"><span class="annot"><a href="GHC.Core.Lint.html#CaseTy"><span class="hs-identifier hs-var">CaseTy</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="hs-comment">-- The type field of a case expression</span><span>
</span><span id="line-3279"></span><span>                        </span><span class="hs-comment">-- with this scrutinee</span><span>
</span><span id="line-3280"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IdTy"><span class="annot"><a href="GHC.Core.Lint.html#IdTy"><span class="hs-identifier hs-var">IdTy</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>             </span><span class="hs-comment">-- The type field of an Id binder</span><span>
</span><span id="line-3281"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AnExpr"><span class="annot"><a href="GHC.Core.Lint.html#AnExpr"><span class="hs-identifier hs-var">AnExpr</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>     </span><span class="hs-comment">-- Some expression</span><span>
</span><span id="line-3282"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ImportedUnfolding"><span class="annot"><a href="GHC.Core.Lint.html#ImportedUnfolding"><span class="hs-identifier hs-var">ImportedUnfolding</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a></span><span> </span><span class="hs-comment">-- Some imported unfolding (ToDo: say which)</span><span>
</span><span id="line-3283"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TopLevelBindings"><span class="annot"><a href="GHC.Core.Lint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a></span></span><span>
</span><span id="line-3284"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InType"><span class="annot"><a href="GHC.Core.Lint.html#InType"><span class="hs-identifier hs-var">InType</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>         </span><span class="hs-comment">-- Inside a type</span><span>
</span><span id="line-3285"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InCo"><span class="annot"><a href="GHC.Core.Lint.html#InCo"><span class="hs-identifier hs-var">InCo</span></a></span></span><span>   </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>     </span><span class="hs-comment">-- Inside a coercion</span><span>
</span><span id="line-3286"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InAxiom"><span class="annot"><a href="GHC.Core.Lint.html#InAxiom"><span class="hs-identifier hs-var">InAxiom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Coercion.Axiom.html#Branched"><span class="hs-identifier hs-type">Branched</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Inside a CoAxiom</span><span>
</span><span id="line-3287"></span><span>
</span><span id="line-3288"></span><span class="hs-keyword">data</span><span> </span><span id="LintConfig"><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-var">LintConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LintConfig"><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-var">LintConfig</span></a></span></span><span>
</span><span id="line-3289"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="l_diagOpts"><span class="annot"><span class="annottext">LintConfig -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#l_diagOpts"><span class="hs-identifier hs-var hs-var">l_diagOpts</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Error.html#DiagOpts"><span class="hs-identifier hs-type">DiagOpts</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Diagnostics opts</span></span><span>
</span><span id="line-3290"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="l_platform"><span class="annot"><span class="annottext">LintConfig -&gt; Platform
</span><a href="GHC.Core.Lint.html#l_platform"><span class="hs-identifier hs-var hs-var">l_platform</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Target platform</span></span><span>
</span><span id="line-3291"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="l_flags"><span class="annot"><span class="annottext">LintConfig -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#l_flags"><span class="hs-identifier hs-var hs-var">l_flags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Linting the result of this pass</span></span><span>
</span><span id="line-3292"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="l_vars"><span class="annot"><span class="annottext">LintConfig -&gt; [Var]
</span><a href="GHC.Core.Lint.html#l_vars"><span class="hs-identifier hs-var hs-var">l_vars</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>            </span><span class="annot"><span class="hs-comment">-- ^ 'Id's that should be treated as being in scope</span></span><span>
</span><span id="line-3293"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-3294"></span><span>
</span><span id="line-3295"></span><span id="local-6989586621682970373"><span class="annot"><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-type">initL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintConfig"><span class="hs-identifier hs-type">LintConfig</span></a></span><span>
</span><span id="line-3296"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970373"><span class="hs-identifier hs-type">a</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ Action to run</span></span><span>
</span><span id="line-3297"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#WarnsAndErrs"><span class="hs-identifier hs-type">WarnsAndErrs</span></a></span></span><span>
</span><span id="line-3298"></span><span id="initL"><span class="annot"><span class="annottext">initL :: forall a. LintConfig -&gt; LintM a -&gt; WarnsAndErrs
</span><a href="GHC.Core.Lint.html#initL"><span class="hs-identifier hs-var hs-var">initL</span></a></span></span><span> </span><span id="local-6989586621682974043"><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682974043"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621682974044"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974044"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974044"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974045"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bag SDoc
forall a. Bag a
</span><a href="GHC.Data.Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3300"></span><span>      </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Unboxed.html#JustUB"><span class="hs-identifier hs-type">JustUB</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682974047"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974047"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974047"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3301"></span><span>      </span><span class="annot"><a href="GHC.Core.Lint.html#LResult"><span class="hs-identifier hs-type">LResult</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeUB a
</span><a href="GHC.Data.Unboxed.html#NothingUB"><span class="hs-identifier hs-var">NothingUB</span></a></span><span> </span><span id="local-6989586621682974048"><span class="annot"><span class="annottext">errs :: WarnsAndErrs
</span><a href="#local-6989586621682974048"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682974049"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974049"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc -&gt; Bool
forall a. Bag a -&gt; Bool
</span><a href="GHC.Data.Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974049"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974048"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3302"></span><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; WarnsAndErrs
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bug in Lint: a failure occurred &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-3303"></span><span>                                                      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;without reporting an error message&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-3304"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3305"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682974051"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974051"><span class="hs-identifier hs-var">tcvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682974052"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974052"><span class="hs-identifier hs-var">ids</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; ([Var], [Var])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyCoVar"><span class="hs-identifier hs-var">isTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; ([Var], [Var])) -&gt; [Var] -&gt; ([Var], [Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; [Var]
</span><a href="GHC.Core.Lint.html#l_vars"><span class="hs-identifier hs-var">l_vars</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682974043"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3306"></span><span>    </span><span id="local-6989586621682974045"><span class="annot"><span class="annottext">env :: LintEnv
</span><a href="#local-6989586621682974045"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LE"><span class="hs-identifier hs-type">LE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">le_flags :: LintFlags
</span><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#l_flags"><span class="hs-identifier hs-var">l_flags</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682974043"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3307"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_subst :: Subst
</span><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Subst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptySubst"><span class="hs-identifier hs-var">mkEmptySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSetList"><span class="hs-identifier hs-var">mkInScopeSetList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974051"><span class="hs-identifier hs-var">tcvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3308"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_ids :: VarEnv (Var, LintedType)
</span><a href="GHC.Core.Lint.html#le_ids"><span class="hs-identifier hs-var">le_ids</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, (Var, LintedType))] -&gt; VarEnv (Var, LintedType)
forall a. [(Var, a)] -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974055"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974055"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974055"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682974055"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974055"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974052"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3309"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_joins :: IdSet
</span><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var">le_joins</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdSet
</span><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a></span><span>
</span><span id="line-3310"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_loc :: [LintLocInfo]
</span><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var">le_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3311"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_ue_aliases :: NameEnv UsageEnv
</span><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameEnv UsageEnv
forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span>
</span><span id="line-3312"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_platform :: Platform
</span><a href="GHC.Core.Lint.html#le_platform"><span class="hs-identifier hs-var">le_platform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; Platform
</span><a href="GHC.Core.Lint.html#l_platform"><span class="hs-identifier hs-var">l_platform</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682974043"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3313"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_diagOpts :: DiagOpts
</span><a href="GHC.Core.Lint.html#le_diagOpts"><span class="hs-identifier hs-var">le_diagOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintConfig -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#l_diagOpts"><span class="hs-identifier hs-var">l_diagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">LintConfig
</span><a href="#local-6989586621682974043"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-3314"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-3315"></span><span>
</span><span id="line-3316"></span><span id="local-6989586621682974058"><span class="annot"><a href="GHC.Core.Lint.html#setReportUnsat"><span class="hs-identifier hs-type">setReportUnsat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974058"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974058"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3317"></span><span class="hs-comment">-- Switch off lf_report_unsat_syns</span><span>
</span><span id="line-3318"></span><span id="setReportUnsat"><span class="annot"><span class="annottext">setReportUnsat :: forall a. Bool -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#setReportUnsat"><span class="hs-identifier hs-var hs-var">setReportUnsat</span></a></span></span><span> </span><span id="local-6989586621682974059"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682974059"><span class="hs-identifier hs-var">ru</span></a></span></span><span> </span><span id="local-6989586621682974060"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974060"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-3319"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974061"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974061"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974062"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974062"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3320"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974063"><span class="annot"><span class="annottext">env' :: LintEnv
</span><a href="#local-6989586621682974063"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974061"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974061"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lf_report_unsat_syns"><span class="hs-identifier hs-var">lf_report_unsat_syns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682974059"><span class="hs-identifier hs-type">ru</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3321"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974060"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974063"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974062"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3322"></span><span>
</span><span id="line-3323"></span><span class="hs-comment">-- See Note [Checking for representation polymorphism]</span><span>
</span><span id="line-3324"></span><span id="local-6989586621682970391"><span class="annot"><a href="GHC.Core.Lint.html#noFixedRuntimeRepChecks"><span class="hs-identifier hs-type">noFixedRuntimeRepChecks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970391"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3325"></span><span id="noFixedRuntimeRepChecks"><span class="annot"><span class="annottext">noFixedRuntimeRepChecks :: forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#noFixedRuntimeRepChecks"><span class="hs-identifier hs-var hs-var">noFixedRuntimeRepChecks</span></a></span></span><span> </span><span id="local-6989586621682974064"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974064"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-3326"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682974065"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974065"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974066"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974066"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3327"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974067"><span class="annot"><span class="annottext">env' :: LintEnv
</span><a href="#local-6989586621682974067"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974065"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974065"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_fixed_rep"><span class="hs-identifier hs-var">lf_check_fixed_rep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3328"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974064"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974067"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974066"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3329"></span><span>
</span><span id="line-3330"></span><span class="annot"><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-type">getLintFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a></span><span>
</span><span id="line-3331"></span><span id="getLintFlags"><span class="annot"><span class="annottext">getLintFlags :: LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var hs-var">getLintFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult LintFlags) -&gt; LintM LintFlags
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult LintFlags) -&gt; LintM LintFlags)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult LintFlags)
-&gt; LintM LintFlags
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974068"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974068"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974069"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974069"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe LintFlags, WarnsAndErrs) -&gt; LResult LintFlags
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintFlags -&gt; Maybe LintFlags
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; LintFlags
</span><a href="GHC.Core.Lint.html#le_flags"><span class="hs-identifier hs-var">le_flags</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974068"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974069"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3332"></span><span>
</span><span id="line-3333"></span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-type">checkL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3334"></span><span id="checkL"><span class="annot"><span class="annottext">checkL :: Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var hs-var">checkL</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3335"></span><span class="annot"><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621682974070"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974070"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var">failWithL</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974070"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-3336"></span><span>
</span><span id="line-3337"></span><span class="hs-comment">-- like checkL, but relevant to type checking</span><span>
</span><span id="line-3338"></span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3339"></span><span id="lintL"><span class="annot"><span class="annottext">lintL :: Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var hs-var">lintL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span>
</span><span id="line-3340"></span><span>
</span><span id="line-3341"></span><span class="annot"><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-type">checkWarnL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3342"></span><span id="checkWarnL"><span class="annot"><span class="annottext">checkWarnL :: Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-var hs-var">checkWarnL</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>   </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3343"></span><span class="annot"><a href="GHC.Core.Lint.html#checkWarnL"><span class="hs-identifier hs-var">checkWarnL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621682974071"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974071"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-var">addWarnL</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974071"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-3344"></span><span>
</span><span id="line-3345"></span><span id="local-6989586621682970426"><span class="annot"><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-type">failWithL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970426"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3346"></span><span id="failWithL"><span class="annot"><span class="annottext">failWithL :: forall a. SDoc -&gt; LintM a
</span><a href="GHC.Core.Lint.html#failWithL"><span class="hs-identifier hs-var hs-var">failWithL</span></a></span></span><span> </span><span id="local-6989586621682974072"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974072"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974073"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974073"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974074"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974074"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682974075"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974075"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3347"></span><span>                </span><span class="annot"><span class="annottext">(Maybe a, WarnsAndErrs) -&gt; LResult a
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974074"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintEnv -&gt; Bag SDoc -&gt; SDoc -&gt; Bag SDoc
</span><a href="GHC.Core.Lint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974073"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974075"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974072"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3348"></span><span>
</span><span id="line-3349"></span><span class="annot"><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-type">addErrL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3350"></span><span id="addErrL"><span class="annot"><span class="annottext">addErrL :: SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-var hs-var">addErrL</span></a></span></span><span> </span><span id="local-6989586621682974077"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974077"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ()
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ())
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974078"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974078"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974079"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974079"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682974080"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974080"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3351"></span><span>              </span><span class="annot"><span class="annottext">(Maybe (), WarnsAndErrs) -&gt; LResult ()
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974079"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LintEnv -&gt; Bag SDoc -&gt; SDoc -&gt; Bag SDoc
</span><a href="GHC.Core.Lint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974078"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974080"><span class="hs-identifier hs-var">errs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974077"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3352"></span><span>
</span><span id="line-3353"></span><span class="annot"><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-type">addWarnL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3354"></span><span id="addWarnL"><span class="annot"><span class="annottext">addWarnL :: SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#addWarnL"><span class="hs-identifier hs-var hs-var">addWarnL</span></a></span></span><span> </span><span id="local-6989586621682974081"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974081"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ()
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ())
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult ()) -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974082"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974082"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974083"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974083"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682974084"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974084"><span class="hs-identifier hs-var">errs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3355"></span><span>              </span><span class="annot"><span class="annottext">(Maybe (), WarnsAndErrs) -&gt; LResult ()
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; LintEnv -&gt; Bag SDoc -&gt; SDoc -&gt; Bag SDoc
</span><a href="GHC.Core.Lint.html#addMsg"><span class="hs-identifier hs-var">addMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974082"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974083"><span class="hs-identifier hs-var">warns</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974081"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974084"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3356"></span><span>
</span><span id="line-3357"></span><span class="annot"><a href="GHC.Core.Lint.html#addMsg"><span class="hs-identifier hs-type">addMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintEnv"><span class="hs-identifier hs-type">LintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3358"></span><span id="addMsg"><span class="annot"><span class="annottext">addMsg :: Bool -&gt; LintEnv -&gt; Bag SDoc -&gt; SDoc -&gt; Bag SDoc
</span><a href="GHC.Core.Lint.html#addMsg"><span class="hs-identifier hs-var hs-var">addMsg</span></a></span></span><span> </span><span id="local-6989586621682974085"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682974085"><span class="hs-identifier hs-var">is_error</span></a></span></span><span> </span><span id="local-6989586621682974086"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974086"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974087"><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974087"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span id="local-6989586621682974088"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974088"><span class="hs-identifier hs-var">msg</span></a></span></span><span>
</span><span id="line-3359"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; Bag SDoc -&gt; Bag SDoc
forall a. HasCallStack =&gt; Bool -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.html#assertPpr"><span class="hs-identifier hs-var">assertPpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(SrcLoc, SDoc)] -&gt; Bool
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; Bool
</span><a href="GHC.Utils.Misc.html#notNull"><span class="hs-identifier hs-var">notNull</span></a></span><span> </span><span class="annot"><span class="annottext">[(SrcLoc, SDoc)]
</span><a href="#local-6989586621682974090"><span class="hs-identifier hs-var">loc_msgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974088"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">(Bag SDoc -&gt; Bag SDoc) -&gt; Bag SDoc -&gt; Bag SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-3360"></span><span>    </span><span class="annot"><span class="annottext">Bag SDoc
</span><a href="#local-6989586621682974087"><span class="hs-identifier hs-var">msgs</span></a></span><span> </span><span class="annot"><span class="annottext">Bag SDoc -&gt; SDoc -&gt; Bag SDoc
forall a. Bag a -&gt; a -&gt; Bag a
</span><a href="GHC.Data.Bag.html#snocBag"><span class="hs-operator hs-var">`snocBag`</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="#local-6989586621682974092"><span class="hs-identifier hs-var">mk_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974088"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-3361"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3362"></span><span>   </span><span class="annot"><a href="#local-6989586621682974090"><span class="hs-identifier hs-type">loc_msgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Innermost first</span><span>
</span><span id="line-3363"></span><span>   </span><span id="local-6989586621682974090"><span class="annot"><span class="annottext">loc_msgs :: [(SrcLoc, SDoc)]
</span><a href="#local-6989586621682974090"><span class="hs-identifier hs-var hs-var">loc_msgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintLocInfo -&gt; (SrcLoc, SDoc))
-&gt; [LintLocInfo] -&gt; [(SrcLoc, SDoc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LintLocInfo -&gt; (SrcLoc, SDoc)
</span><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; [LintLocInfo]
</span><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var">le_loc</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974086"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3364"></span><span>
</span><span id="line-3365"></span><span>   </span><span id="local-6989586621682974094"><span class="annot"><span class="annottext">cxt_doc :: SDoc
</span><a href="#local-6989586621682974094"><span class="hs-identifier hs-var hs-var">cxt_doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; [SDoc]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; [SDoc]) -&gt; [SDoc] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((SrcLoc, SDoc) -&gt; SDoc) -&gt; [(SrcLoc, SDoc)] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(SrcLoc, SDoc) -&gt; SDoc
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(SrcLoc, SDoc)]
</span><a href="#local-6989586621682974090"><span class="hs-identifier hs-var">loc_msgs</span></a></span><span>
</span><span id="line-3366"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Substitution:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; Subst
</span><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974086"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3367"></span><span>   </span><span id="local-6989586621682974096"><span class="annot"><span class="annottext">context :: SDoc
</span><a href="#local-6989586621682974096"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682974085"><span class="hs-identifier hs-var">is_error</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974094"><span class="hs-identifier hs-var">cxt_doc</span></a></span><span>
</span><span id="line-3368"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsOutput doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#whenPprDebug"><span class="hs-identifier hs-var">whenPprDebug</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974094"><span class="hs-identifier hs-var">cxt_doc</span></a></span><span>
</span><span id="line-3369"></span><span>     </span><span class="hs-comment">-- Print voluminous info for Lint errors</span><span>
</span><span id="line-3370"></span><span>     </span><span class="hs-comment">-- but not for warnings</span><span>
</span><span id="line-3371"></span><span>
</span><span id="line-3372"></span><span>   </span><span id="local-6989586621682974098"><span class="annot"><span class="annottext">msg_span :: SrcSpan
</span><a href="#local-6989586621682974098"><span class="hs-identifier hs-var hs-var">msg_span</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682974099"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974100"><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682974100"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(SrcLoc, SDoc)]
</span><a href="#local-6989586621682974090"><span class="hs-identifier hs-var">loc_msgs</span></a></span><span>
</span><span id="line-3373"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974099"><span class="annot"><span class="annottext">span :: SrcSpan
</span><a href="#local-6989586621682974099"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; SrcSpan
</span><a href="GHC.Types.SrcLoc.html#srcLocSpan"><span class="hs-identifier hs-var">srcLocSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682974100"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-3374"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; Bool
</span><a href="GHC.Types.SrcLoc.html#isGoodSrcSpan"><span class="hs-identifier hs-var">isGoodSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682974099"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3375"></span><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-3376"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621682974103"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682974103"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[SrcSpan]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682974103"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-3377"></span><span>   </span><span class="hs-glyph">!</span><span id="local-6989586621682974104"><span class="annot"><span class="annottext">diag_opts :: DiagOpts
</span><a href="#local-6989586621682974104"><span class="hs-identifier hs-var hs-var">diag_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintEnv -&gt; DiagOpts
</span><a href="GHC.Core.Lint.html#le_diagOpts"><span class="hs-identifier hs-var">le_diagOpts</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974086"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-3378"></span><span>   </span><span id="local-6989586621682974092"><span class="annot"><span class="annottext">mk_msg :: SDoc -&gt; SDoc
</span><a href="#local-6989586621682974092"><span class="hs-identifier hs-var hs-var">mk_msg</span></a></span></span><span> </span><span id="local-6989586621682974105"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974105"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageClass -&gt; SrcSpan -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Types.Error.html#mkLocMessage"><span class="hs-identifier hs-var">mkLocMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiagOpts
-&gt; DiagnosticReason -&gt; Maybe DiagnosticCode -&gt; MessageClass
</span><a href="GHC.Utils.Error.html#mkMCDiagnostic"><span class="hs-identifier hs-var">mkMCDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">DiagOpts
</span><a href="#local-6989586621682974104"><span class="hs-identifier hs-var">diag_opts</span></a></span><span> </span><span class="annot"><span class="annottext">DiagnosticReason
</span><a href="GHC.Types.Error.html#WarningWithoutFlag"><span class="hs-identifier hs-var">WarningWithoutFlag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DiagnosticCode
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682974098"><span class="hs-identifier hs-var">msg_span</span></a></span><span>
</span><span id="line-3379"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974105"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974096"><span class="hs-identifier hs-var">context</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3380"></span><span>
</span><span id="line-3381"></span><span id="local-6989586621682970375"><span class="annot"><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-type">addLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970375"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3382"></span><span id="addLoc"><span class="annot"><span class="annottext">addLoc :: forall a. LintLocInfo -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addLoc"><span class="hs-identifier hs-var hs-var">addLoc</span></a></span></span><span> </span><span id="local-6989586621682974109"><span class="annot"><span class="annottext">LintLocInfo
</span><a href="#local-6989586621682974109"><span class="hs-identifier hs-var">extra_loc</span></a></span></span><span> </span><span id="local-6989586621682974110"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974110"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3383"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974111"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974111"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974112"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974112"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3384"></span><span>    </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974110"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974111"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var">le_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682974109"><span class="hs-identifier hs-type">extra_loc</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var">le_loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974111"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974112"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3385"></span><span>
</span><span id="line-3386"></span><span class="annot"><a href="GHC.Core.Lint.html#inCasePat"><span class="hs-identifier hs-type">inCasePat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>         </span><span class="hs-comment">-- A slight hack; see the unique call site</span><span>
</span><span id="line-3387"></span><span id="inCasePat"><span class="annot"><span class="annottext">inCasePat :: LintM Bool
</span><a href="GHC.Core.Lint.html#inCasePat"><span class="hs-identifier hs-var hs-var">inCasePat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult Bool) -&gt; LintM Bool
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult Bool) -&gt; LintM Bool)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult Bool) -&gt; LintM Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974113"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974113"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974114"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974114"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, WarnsAndErrs) -&gt; LResult Bool
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; Bool
</span><a href="#local-6989586621682974115"><span class="hs-identifier hs-var">is_case_pat</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974113"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974114"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3388"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3389"></span><span>    </span><span id="local-6989586621682974115"><span class="annot"><span class="annottext">is_case_pat :: LintEnv -&gt; Bool
</span><a href="#local-6989586621682974115"><span class="hs-identifier hs-var hs-var">is_case_pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LE"><span class="hs-identifier hs-type">LE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">le_loc :: LintEnv -&gt; [LintLocInfo]
</span><a href="GHC.Core.Lint.html#le_loc"><span class="hs-identifier hs-var">le_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#CasePat"><span class="hs-identifier hs-type">CasePat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LintLocInfo]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3390"></span><span>    </span><span class="annot"><a href="#local-6989586621682974115"><span class="hs-identifier hs-var">is_case_pat</span></a></span><span> </span><span id="local-6989586621682974116"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974116"><span class="hs-identifier hs-var">_other</span></a></span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-3391"></span><span>
</span><span id="line-3392"></span><span id="local-6989586621682974117"><span class="annot"><a href="GHC.Core.Lint.html#addInScopeId"><span class="hs-identifier hs-type">addInScopeId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974117"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974117"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3393"></span><span id="addInScopeId"><span class="annot"><span class="annottext">addInScopeId :: forall a. Var -&gt; LintedType -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addInScopeId"><span class="hs-identifier hs-var hs-var">addInScopeId</span></a></span></span><span> </span><span id="local-6989586621682974118"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974118"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682974119"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974119"><span class="hs-identifier hs-var">linted_ty</span></a></span></span><span> </span><span id="local-6989586621682974120"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974120"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3394"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974121"><span class="annot"><span class="annottext">env :: LintEnv
</span><a href="#local-6989586621682974121"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LE"><span class="hs-identifier hs-type">LE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">le_ids :: LintEnv -&gt; VarEnv (Var, LintedType)
</span><a href="GHC.Core.Lint.html#le_ids"><span class="hs-identifier hs-var">le_ids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682974122"><span class="annot"><span class="annottext">VarEnv (Var, LintedType)
</span><a href="#local-6989586621682974122"><span class="hs-identifier hs-var">id_set</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_joins :: LintEnv -&gt; IdSet
</span><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var">le_joins</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682974123"><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682974123"><span class="hs-identifier hs-var">join_set</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">le_ue_aliases :: LintEnv -&gt; NameEnv UsageEnv
</span><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682974124"><span class="annot"><span class="annottext">NameEnv UsageEnv
</span><a href="#local-6989586621682974124"><span class="hs-identifier hs-var">aliases</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682974125"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974125"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3395"></span><span>    </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974120"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974121"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_ids"><span class="hs-identifier hs-var">le_ids</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-type">extendVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974122"><span class="hs-identifier hs-type">id_set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974118"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682974118"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682974119"><span class="hs-identifier hs-type">linted_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3396"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var">le_joins</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682974127"><span class="hs-identifier hs-type">add_joins</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974123"><span class="hs-identifier hs-type">join_set</span></a></span><span>
</span><span id="line-3397"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#delFromNameEnv"><span class="hs-identifier hs-type">delFromNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974124"><span class="hs-identifier hs-type">aliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-type">idName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974118"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974125"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3398"></span><span>                   </span><span class="hs-comment">-- When shadowing an alias, we need to make sure the Id is no longer</span><span>
</span><span id="line-3399"></span><span>                   </span><span class="hs-comment">-- classified as such. E.g. in</span><span>
</span><span id="line-3400"></span><span>                   </span><span class="hs-comment">-- let x = &lt;e1&gt; in case x of x { _DEFAULT -&gt; &lt;e2&gt; }</span><span>
</span><span id="line-3401"></span><span>                   </span><span class="hs-comment">-- Occurrences of 'x' in e2 shouldn't count as occurrences of e1.</span><span>
</span><span id="line-3402"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3403"></span><span>    </span><span id="local-6989586621682974127"><span class="annot"><span class="annottext">add_joins :: IdSet -&gt; IdSet
</span><a href="#local-6989586621682974127"><span class="hs-identifier hs-var hs-var">add_joins</span></a></span></span><span> </span><span id="local-6989586621682974129"><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682974129"><span class="hs-identifier hs-var">join_set</span></a></span></span><span>
</span><span id="line-3404"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Id.html#isJoinId"><span class="hs-identifier hs-var">isJoinId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974118"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdSet -&gt; Var -&gt; IdSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682974129"><span class="hs-identifier hs-var">join_set</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974118"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-comment">-- Overwrite with new arity</span><span>
</span><span id="line-3405"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdSet -&gt; Var -&gt; IdSet
</span><a href="GHC.Types.Var.Set.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a></span><span>    </span><span class="annot"><span class="annottext">IdSet
</span><a href="#local-6989586621682974129"><span class="hs-identifier hs-var">join_set</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974118"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-comment">-- Remove any existing binding</span><span>
</span><span id="line-3406"></span><span>
</span><span id="line-3407"></span><span class="annot"><a href="GHC.Core.Lint.html#getInScopeIds"><span class="hs-identifier hs-type">getInScopeIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3408"></span><span id="getInScopeIds"><span class="annot"><span class="annottext">getInScopeIds :: LintM (VarEnv (Var, LintedType))
</span><a href="GHC.Core.Lint.html#getInScopeIds"><span class="hs-identifier hs-var hs-var">getInScopeIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult (VarEnv (Var, LintedType)))
-&gt; LintM (VarEnv (Var, LintedType))
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682974133"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974133"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974134"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974134"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe (VarEnv (Var, LintedType)), WarnsAndErrs)
-&gt; LResult (VarEnv (Var, LintedType))
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarEnv (Var, LintedType) -&gt; Maybe (VarEnv (Var, LintedType))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; VarEnv (Var, LintedType)
</span><a href="GHC.Core.Lint.html#le_ids"><span class="hs-identifier hs-var">le_ids</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974133"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974134"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3409"></span><span>
</span><span id="line-3410"></span><span id="local-6989586621682970442"><span class="annot"><a href="GHC.Core.Lint.html#extendTvSubstL"><span class="hs-identifier hs-type">extendTvSubstL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970442"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3411"></span><span id="extendTvSubstL"><span class="annot"><span class="annottext">extendTvSubstL :: forall a. Var -&gt; LintedType -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#extendTvSubstL"><span class="hs-identifier hs-var hs-var">extendTvSubstL</span></a></span></span><span> </span><span id="local-6989586621682974135"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974135"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621682974136"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974136"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682974137"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974137"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3412"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974138"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974138"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974139"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974139"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3413"></span><span>    </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974137"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974138"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-type">Type.extendTvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974138"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682974135"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974136"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974139"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3414"></span><span>
</span><span id="line-3415"></span><span id="local-6989586621682970521"><span class="annot"><a href="GHC.Core.Lint.html#updateSubst"><span class="hs-identifier hs-type">updateSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970521"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970521"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3416"></span><span id="updateSubst"><span class="annot"><span class="annottext">updateSubst :: forall a. Subst -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#updateSubst"><span class="hs-identifier hs-var hs-var">updateSubst</span></a></span></span><span> </span><span id="local-6989586621682974141"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682974141"><span class="hs-identifier hs-var">subst'</span></a></span></span><span> </span><span id="local-6989586621682974142"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974142"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3417"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974143"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974143"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974144"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974144"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974142"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974143"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682974141"><span class="hs-identifier hs-type">subst'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974144"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3418"></span><span>
</span><span id="line-3419"></span><span id="local-6989586621682974145"><span class="annot"><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-type">markAllJoinsBad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974145"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3420"></span><span id="markAllJoinsBad"><span class="annot"><span class="annottext">markAllJoinsBad :: forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var hs-var">markAllJoinsBad</span></a></span></span><span> </span><span id="local-6989586621682974146"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974146"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-3421"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974147"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974147"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974148"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974148"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974146"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974147"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var">le_joins</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#emptyVarSet"><span class="hs-identifier hs-type">emptyVarSet</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974148"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3422"></span><span>
</span><span id="line-3423"></span><span id="local-6989586621682970436"><span class="annot"><a href="GHC.Core.Lint.html#markAllJoinsBadIf"><span class="hs-identifier hs-type">markAllJoinsBadIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970436"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3424"></span><span id="markAllJoinsBadIf"><span class="annot"><span class="annottext">markAllJoinsBadIf :: forall a. Bool -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBadIf"><span class="hs-identifier hs-var hs-var">markAllJoinsBadIf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span id="local-6989586621682974149"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974149"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM a -&gt; LintM a
forall a. LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#markAllJoinsBad"><span class="hs-identifier hs-var">markAllJoinsBad</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974149"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-3425"></span><span class="annot"><a href="GHC.Core.Lint.html#markAllJoinsBadIf"><span class="hs-identifier hs-var">markAllJoinsBadIf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621682974150"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974150"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974150"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-3426"></span><span>
</span><span id="line-3427"></span><span class="annot"><a href="GHC.Core.Lint.html#getValidJoins"><span class="hs-identifier hs-type">getValidJoins</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#IdSet"><span class="hs-identifier hs-type">IdSet</span></a></span><span>
</span><span id="line-3428"></span><span id="getValidJoins"><span class="annot"><span class="annottext">getValidJoins :: LintM IdSet
</span><a href="GHC.Core.Lint.html#getValidJoins"><span class="hs-identifier hs-var hs-var">getValidJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult IdSet) -&gt; LintM IdSet
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974151"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974151"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974152"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974152"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe IdSet, WarnsAndErrs) -&gt; LResult IdSet
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdSet -&gt; Maybe IdSet
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; IdSet
</span><a href="GHC.Core.Lint.html#le_joins"><span class="hs-identifier hs-var">le_joins</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974151"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974152"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3429"></span><span>
</span><span id="line-3430"></span><span class="annot"><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-type">getSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>
</span><span id="line-3431"></span><span id="getSubst"><span class="annot"><span class="annottext">getSubst :: LintM Subst
</span><a href="GHC.Core.Lint.html#getSubst"><span class="hs-identifier hs-var hs-var">getSubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult Subst) -&gt; LintM Subst
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974153"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974153"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974154"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974154"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Subst, WarnsAndErrs) -&gt; LResult Subst
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Maybe Subst
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; Subst
</span><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974153"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974154"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3432"></span><span>
</span><span id="line-3433"></span><span class="annot"><a href="GHC.Core.Lint.html#getUEAliases"><span class="hs-identifier hs-type">getUEAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3434"></span><span id="getUEAliases"><span class="annot"><span class="annottext">getUEAliases :: LintM (NameEnv UsageEnv)
</span><a href="GHC.Core.Lint.html#getUEAliases"><span class="hs-identifier hs-var hs-var">getUEAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult (NameEnv UsageEnv))
-&gt; LintM (NameEnv UsageEnv)
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974156"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974156"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974157"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974157"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe (NameEnv UsageEnv), WarnsAndErrs)
-&gt; LResult (NameEnv UsageEnv)
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameEnv UsageEnv -&gt; Maybe (NameEnv UsageEnv)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; NameEnv UsageEnv
</span><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974156"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974157"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3435"></span><span>
</span><span id="line-3436"></span><span class="annot"><a href="GHC.Core.Lint.html#getInScope"><span class="hs-identifier hs-type">getInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span>
</span><span id="line-3437"></span><span id="getInScope"><span class="annot"><span class="annottext">getInScope :: LintM InScopeSet
</span><a href="GHC.Core.Lint.html#getInScope"><span class="hs-identifier hs-var hs-var">getInScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult InScopeSet) -&gt; LintM InScopeSet
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974158"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974158"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974159"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974159"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe InScopeSet, WarnsAndErrs) -&gt; LResult InScopeSet
forall a. (Maybe a, WarnsAndErrs) -&gt; LResult a
</span><a href="GHC.Core.Lint.html#fromBoxedLResult"><span class="hs-identifier hs-var">fromBoxedLResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; Maybe InScopeSet
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; InScopeSet
</span><a href="GHC.Core.TyCo.Subst.html#getSubstInScope"><span class="hs-identifier hs-var">getSubstInScope</span></a></span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; InScopeSet) -&gt; Subst -&gt; InScopeSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LintEnv -&gt; Subst
</span><a href="GHC.Core.Lint.html#le_subst"><span class="hs-identifier hs-var">le_subst</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974158"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974159"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3438"></span><span>
</span><span id="line-3439"></span><span class="annot"><a href="GHC.Core.Lint.html#lookupIdInScope"><span class="hs-identifier hs-type">lookupIdInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3440"></span><span id="lookupIdInScope"><span class="annot"><span class="annottext">lookupIdInScope :: Var -&gt; LintM (Var, LintedType)
</span><a href="GHC.Core.Lint.html#lookupIdInScope"><span class="hs-identifier hs-var hs-var">lookupIdInScope</span></a></span></span><span> </span><span id="local-6989586621682974160"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span></span><span>
</span><span id="line-3441"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682974161"><span class="annot"><a href="#local-6989586621682974161"><span class="hs-identifier hs-var">in_scope_ids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (VarEnv (Var, LintedType))
</span><a href="GHC.Core.Lint.html#getInScopeIds"><span class="hs-identifier hs-var">getInScopeIds</span></a></span><span>
</span><span id="line-3442"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-type">lookupVarEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974161"><span class="hs-identifier hs-type">in_scope_ids</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974160"><span class="hs-identifier hs-type">id_occ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3443"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974163"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974163"><span class="hs-identifier hs-var">id_bndr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682974164"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974164"><span class="hs-identifier hs-var">linted_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3444"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="#local-6989586621682974165"><span class="hs-identifier hs-var">bad_global</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974163"><span class="hs-identifier hs-var">id_bndr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; LintM ()) -&gt; SDoc -&gt; LintM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="#local-6989586621682974166"><span class="hs-identifier hs-var">global_in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974163"><span class="hs-identifier hs-var">id_bndr</span></a></span><span>
</span><span id="line-3445"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Var, LintedType) -&gt; LintM (Var, LintedType)
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974163"><span class="hs-identifier hs-var">id_bndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974164"><span class="hs-identifier hs-var">linted_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3446"></span><span>           </span><span class="annot"><span class="annottext">Maybe (Var, LintedType)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#checkL"><span class="hs-identifier hs-var">checkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682974167"><span class="hs-identifier hs-var">is_local</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974168"><span class="hs-identifier hs-var">local_out_of_scope</span></a></span><span>
</span><span id="line-3447"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Var, LintedType) -&gt; LintM (Var, LintedType)
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3448"></span><span>                      </span><span class="hs-comment">-- We don't bother to lint the type</span><span>
</span><span id="line-3449"></span><span>                      </span><span class="hs-comment">-- of global (i.e. imported) Ids</span><span>
</span><span id="line-3450"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3451"></span><span>    </span><span id="local-6989586621682974167"><span class="annot"><span class="annottext">is_local :: Bool
</span><a href="#local-6989586621682974167"><span class="hs-identifier hs-var hs-var">is_local</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#mustHaveLocalBinding"><span class="hs-identifier hs-var">mustHaveLocalBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span>
</span><span id="line-3452"></span><span>    </span><span id="local-6989586621682974168"><span class="annot"><span class="annottext">local_out_of_scope :: SDoc
</span><a href="#local-6989586621682974168"><span class="hs-identifier hs-var hs-var">local_out_of_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Out of scope:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; Var -&gt; SDoc
forall a. OutputableBndr a =&gt; BindingSite -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span>
</span><span id="line-3453"></span><span>    </span><span id="local-6989586621682974166"><span class="annot"><span class="annottext">global_in_scope :: Var -&gt; SDoc
</span><a href="#local-6989586621682974166"><span class="hs-identifier hs-var hs-var">global_in_scope</span></a></span></span><span> </span><span id="local-6989586621682974170"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974170"><span class="hs-identifier hs-var">id_bndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Occurrence is GlobalId, but binding is LocalId&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3454"></span><span>                                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;occurrence:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; Var -&gt; SDoc
forall a. OutputableBndr a =&gt; BindingSite -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span>
</span><span id="line-3455"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;binder    :&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BindingSite -&gt; Var -&gt; SDoc
forall a. OutputableBndr a =&gt; BindingSite -&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprBndr"><span class="hs-identifier hs-var">pprBndr</span></a></span><span> </span><span class="annot"><span class="annottext">BindingSite
</span><a href="GHC.Utils.Outputable.html#LetBind"><span class="hs-identifier hs-var">LetBind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974170"><span class="hs-identifier hs-var">id_bndr</span></a></span><span>
</span><span id="line-3456"></span><span>                                          </span><span class="hs-special">]</span><span>
</span><span id="line-3457"></span><span>    </span><span id="local-6989586621682974165"><span class="annot"><span class="annottext">bad_global :: Var -&gt; Bool
</span><a href="#local-6989586621682974165"><span class="hs-identifier hs-var hs-var">bad_global</span></a></span></span><span> </span><span id="local-6989586621682974171"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974171"><span class="hs-identifier hs-var">id_bnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isGlobalId"><span class="hs-identifier hs-var">isGlobalId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span>
</span><span id="line-3458"></span><span>                     </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isLocalId"><span class="hs-identifier hs-var">isLocalId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974171"><span class="hs-identifier hs-var">id_bnd</span></a></span><span>
</span><span id="line-3459"></span><span>                     </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Bool
forall thing. NamedThing thing =&gt; thing -&gt; Bool
</span><a href="GHC.Types.Name.html#isWiredIn"><span class="hs-identifier hs-var">isWiredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974160"><span class="hs-identifier hs-var">id_occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3460"></span><span>       </span><span class="hs-comment">-- 'bad_global' checks for the case where an /occurrence/ is</span><span>
</span><span id="line-3461"></span><span>       </span><span class="hs-comment">-- a GlobalId, but there is an enclosing binding fora a LocalId.</span><span>
</span><span id="line-3462"></span><span>       </span><span class="hs-comment">-- NB: the in-scope variables are mostly LocalIds, checked by lintIdBndr,</span><span>
</span><span id="line-3463"></span><span>       </span><span class="hs-comment">--     but GHCi adds GlobalIds from the interactive context.  These</span><span>
</span><span id="line-3464"></span><span>       </span><span class="hs-comment">--     are fine; hence the test (isLocalId id == isLocalId v)</span><span>
</span><span id="line-3465"></span><span>       </span><span class="hs-comment">-- NB: when compiling Control.Exception.Base, things like absentError</span><span>
</span><span id="line-3466"></span><span>       </span><span class="hs-comment">--     are defined locally, but appear in expressions as (global)</span><span>
</span><span id="line-3467"></span><span>       </span><span class="hs-comment">--     wired-in Ids after worker/wrapper</span><span>
</span><span id="line-3468"></span><span>       </span><span class="hs-comment">--     So we simply disable the test in this case</span><span>
</span><span id="line-3469"></span><span>
</span><span id="line-3470"></span><span class="annot"><a href="GHC.Core.Lint.html#lookupJoinId"><span class="hs-identifier hs-type">lookupJoinId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPointHood"><span class="hs-identifier hs-type">JoinPointHood</span></a></span><span>
</span><span id="line-3471"></span><span class="hs-comment">-- Look up an Id which should be a join point, valid here</span><span>
</span><span id="line-3472"></span><span class="hs-comment">-- If so, return its arity, if not return Nothing</span><span>
</span><span id="line-3473"></span><span id="lookupJoinId"><span class="annot"><span class="annottext">lookupJoinId :: Var -&gt; LintM JoinPointHood
</span><a href="GHC.Core.Lint.html#lookupJoinId"><span class="hs-identifier hs-var hs-var">lookupJoinId</span></a></span></span><span> </span><span id="local-6989586621682974174"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974174"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-3474"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682974175"><span class="annot"><a href="#local-6989586621682974175"><span class="hs-identifier hs-var">join_set</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM IdSet
</span><a href="GHC.Core.Lint.html#getValidJoins"><span class="hs-identifier hs-var">getValidJoins</span></a></span><span>
</span><span id="line-3475"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#lookupVarSet"><span class="hs-identifier hs-type">lookupVarSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974175"><span class="hs-identifier hs-type">join_set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974174"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3476"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682974177"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974177"><span class="hs-identifier hs-var">id'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JoinPointHood -&gt; LintM JoinPointHood
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; JoinPointHood
</span><a href="GHC.Types.Id.html#idJoinPointHood"><span class="hs-identifier hs-var">idJoinPointHood</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974177"><span class="hs-identifier hs-var">id'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3477"></span><span>            </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JoinPointHood -&gt; LintM JoinPointHood
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">JoinPointHood
</span><a href="GHC.Utils.Outputable.html#NotJoinPoint"><span class="hs-identifier hs-var">NotJoinPoint</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3478"></span><span>
</span><span id="line-3479"></span><span id="local-6989586621682970445"><span class="annot"><a href="GHC.Core.Lint.html#addAliasUE"><span class="hs-identifier hs-type">addAliasUE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970445"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-3480"></span><span id="addAliasUE"><span class="annot"><span class="annottext">addAliasUE :: forall a. Var -&gt; UsageEnv -&gt; LintM a -&gt; LintM a
</span><a href="GHC.Core.Lint.html#addAliasUE"><span class="hs-identifier hs-var hs-var">addAliasUE</span></a></span></span><span> </span><span id="local-6989586621682974179"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974179"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621682974180"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682974180"><span class="hs-identifier hs-var">ue</span></a></span></span><span> </span><span id="local-6989586621682974181"><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974181"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a. (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
</span><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-var">LintM</span></a></span><span> </span><span class="annot"><span class="annottext">((LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a)
-&gt; (LintEnv -&gt; WarnsAndErrs -&gt; LResult a) -&gt; LintM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621682974182"><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974182"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682974183"><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974183"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-3481"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974184"><span class="annot"><span class="annottext">new_ue_aliases :: NameEnv UsageEnv
</span><a href="#local-6989586621682974184"><span class="hs-identifier hs-var hs-var">new_ue_aliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3482"></span><span>        </span><span class="annot"><span class="annottext">NameEnv UsageEnv -&gt; Name -&gt; UsageEnv -&gt; NameEnv UsageEnv
forall a. NameEnv a -&gt; Name -&gt; a -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#extendNameEnv"><span class="hs-identifier hs-var">extendNameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv -&gt; NameEnv UsageEnv
</span><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974182"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974179"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682974180"><span class="hs-identifier hs-var">ue</span></a></span><span>
</span><span id="line-3483"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-3484"></span><span>    </span><span class="annot"><span class="annottext">LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
forall a. LintM a -&gt; LintEnv -&gt; WarnsAndErrs -&gt; LResult a
</span><a href="GHC.Core.Lint.html#unLintM"><span class="hs-identifier hs-var">unLintM</span></a></span><span> </span><span class="annot"><span class="annottext">LintM a
</span><a href="#local-6989586621682974181"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintEnv
</span><a href="#local-6989586621682974182"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#le_ue_aliases"><span class="hs-identifier hs-var">le_ue_aliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682974184"><span class="hs-identifier hs-type">new_ue_aliases</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WarnsAndErrs
</span><a href="#local-6989586621682974183"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-3485"></span><span>
</span><span id="line-3486"></span><span class="annot"><a href="GHC.Core.Lint.html#varCallSiteUsage"><span class="hs-identifier hs-type">varCallSiteUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#UsageEnv"><span class="hs-identifier hs-type">UsageEnv</span></a></span><span>
</span><span id="line-3487"></span><span id="varCallSiteUsage"><span class="annot"><span class="annottext">varCallSiteUsage :: Var -&gt; LintM UsageEnv
</span><a href="GHC.Core.Lint.html#varCallSiteUsage"><span class="hs-identifier hs-var hs-var">varCallSiteUsage</span></a></span></span><span> </span><span id="local-6989586621682974187"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974187"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-3488"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682974188"><span class="annot"><a href="#local-6989586621682974188"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM (NameEnv UsageEnv)
</span><a href="GHC.Core.Lint.html#getUEAliases"><span class="hs-identifier hs-var">getUEAliases</span></a></span><span>
</span><span id="line-3489"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-type">lookupNameEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-type">getName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974187"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3490"></span><span>         </span><span class="annot"><span class="annottext">Maybe UsageEnv
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#singleUsageUE"><span class="hs-identifier hs-var">singleUsageUE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974187"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-3491"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682974190"><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682974190"><span class="hs-identifier hs-var">id_ue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UsageEnv
</span><a href="#local-6989586621682974190"><span class="hs-identifier hs-var">id_ue</span></a></span><span>
</span><span id="line-3492"></span><span>
</span><span id="line-3493"></span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-type">ensureEqTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3494"></span><span class="hs-comment">-- check ty2 is subtype of ty1 (ie, has same structure but usage</span><span>
</span><span id="line-3495"></span><span class="hs-comment">-- annotations need only be consistent, not equal)</span><span>
</span><span id="line-3496"></span><span class="hs-comment">-- Assumes ty1,ty2 are have already had the substitution applied</span><span>
</span><span id="line-3497"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-pragma hs-type">ensureEqTys</span></a></span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [INLINE ensureEqTys]</span><span>
</span><span id="line-3498"></span><span id="ensureEqTys"><span class="annot"><span class="annottext">ensureEqTys :: LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureEqTys"><span class="hs-identifier hs-var hs-var">ensureEqTys</span></a></span></span><span> </span><span id="local-6989586621682974191"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974191"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682974192"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974192"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span id="local-6989586621682974193"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974193"><span class="hs-identifier hs-var">msg</span></a></span></span><span>
</span><span id="line-3499"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682974194"><span class="annot"><a href="#local-6989586621682974194"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-3500"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-type">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#eq_type"><span class="hs-identifier hs-type">eq_type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974194"><span class="hs-identifier hs-type">flags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974191"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974192"><span class="hs-identifier hs-type">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682974193"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3501"></span><span>
</span><span id="line-3502"></span><span class="annot"><a href="GHC.Core.Lint.html#eq_type"><span class="hs-identifier hs-type">eq_type</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintFlags"><span class="hs-identifier hs-type">LintFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3503"></span><span class="hs-comment">-- When `-dlinear-core-lint` is off, then consider `a -&gt; b` and `a %1 -&gt; b` to</span><span>
</span><span id="line-3504"></span><span class="hs-comment">-- be equal. See Note [Linting linearity].</span><span>
</span><span id="line-3505"></span><span id="eq_type"><span class="annot"><span class="annottext">eq_type :: LintFlags -&gt; LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.Lint.html#eq_type"><span class="hs-identifier hs-var hs-var">eq_type</span></a></span></span><span> </span><span id="local-6989586621682974196"><span class="annot"><span class="annottext">LintFlags
</span><a href="#local-6989586621682974196"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621682974197"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974197"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682974198"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974198"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LintFlags -&gt; Bool
</span><a href="GHC.Core.Lint.html#lf_check_linearity"><span class="hs-identifier hs-var">lf_check_linearity</span></a></span><span> </span><span class="annot"><span class="annottext">LintFlags
</span><a href="#local-6989586621682974196"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier hs-var">eqType</span></a></span><span>                     </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974197"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974198"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-3506"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqTypeIgnoringMultiplicity"><span class="hs-identifier hs-var">eqTypeIgnoringMultiplicity</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974197"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974198"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-3507"></span><span>
</span><span id="line-3508"></span><span class="hs-comment">{- Note [INLINE ensureEqTys]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
To make Lint fast, we want to avoid allocating a thunk for &lt;msg&gt; in
      ensureEqTypes ty1 ty2 &lt;msg&gt;
because the test almost always succeeds, and &lt;msg&gt; isn't needed.
So we INLINE `ensureEqTys`.  This actually make a difference of
1-2% when compiling programs with -dcore-lint.
-}</span><span>
</span><span id="line-3516"></span><span>
</span><span id="line-3517"></span><span class="annot"><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-type">ensureSubUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#Usage"><span class="hs-identifier hs-type">Usage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3518"></span><span id="ensureSubUsage"><span class="annot"><span class="annottext">ensureSubUsage :: Usage -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-var hs-var">ensureSubUsage</span></a></span></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="GHC.Core.UsageEnv.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span>     </span><span class="annot"><span class="annottext">LintedType
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; LintM ()
forall a. a -&gt; LintM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3519"></span><span class="annot"><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-var">ensureSubUsage</span></a></span><span> </span><span class="annot"><span class="annottext">Usage
</span><a href="GHC.Core.UsageEnv.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>       </span><span id="local-6989586621682974201"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974201"><span class="hs-identifier hs-var">described_mult</span></a></span></span><span> </span><span id="local-6989586621682974202"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974202"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubMult"><span class="hs-identifier hs-var">ensureSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="GHC.Core.Type.html#ManyTy"><span class="hs-identifier hs-var">ManyTy</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974201"><span class="hs-identifier hs-var">described_mult</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974202"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-3520"></span><span class="annot"><a href="GHC.Core.Lint.html#ensureSubUsage"><span class="hs-identifier hs-var">ensureSubUsage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.UsageEnv.html#MUsage"><span class="hs-identifier hs-type">MUsage</span></a></span><span> </span><span id="local-6989586621682974204"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974204"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682974205"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974205"><span class="hs-identifier hs-var">described_mult</span></a></span></span><span> </span><span id="local-6989586621682974206"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974206"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubMult"><span class="hs-identifier hs-var">ensureSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974204"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974205"><span class="hs-identifier hs-var">described_mult</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974206"><span class="hs-identifier hs-var">err_msg</span></a></span><span>
</span><span id="line-3521"></span><span>
</span><span id="line-3522"></span><span class="annot"><a href="GHC.Core.Lint.html#ensureSubMult"><span class="hs-identifier hs-type">ensureSubMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-3523"></span><span id="ensureSubMult"><span class="annot"><span class="annottext">ensureSubMult :: LintedType -&gt; LintedType -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#ensureSubMult"><span class="hs-identifier hs-var hs-var">ensureSubMult</span></a></span></span><span> </span><span id="local-6989586621682974207"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974207"><span class="hs-identifier hs-var">actual_mult</span></a></span></span><span> </span><span id="local-6989586621682974208"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974208"><span class="hs-identifier hs-var">described_mult</span></a></span></span><span> </span><span id="local-6989586621682974209"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974209"><span class="hs-identifier hs-var">err_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3524"></span><span>    </span><span id="local-6989586621682974210"><span class="annot"><a href="#local-6989586621682974210"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintM LintFlags
</span><a href="GHC.Core.Lint.html#getLintFlags"><span class="hs-identifier hs-var">getLintFlags</span></a></span><span>
</span><span id="line-3525"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#lf_check_linearity"><span class="hs-identifier hs-var">lf_check_linearity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974210"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3526"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682974211"><span class="hs-identifier hs-type">deepSubMult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974207"><span class="hs-identifier hs-type">actual_mult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974208"><span class="hs-identifier hs-type">described_mult</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3527"></span><span>        </span><span class="annot"><a href="GHC.Core.Lint.html#addErrL"><span class="hs-identifier hs-type">addErrL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974209"><span class="hs-identifier hs-type">err_msg</span></a></span><span>
</span><span id="line-3528"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3529"></span><span>    </span><span class="hs-comment">-- Check for submultiplicity using the following rules:</span><span>
</span><span id="line-3530"></span><span>    </span><span class="hs-comment">-- 1. x*y &lt;= z when x &lt;= z and y &lt;= z.</span><span>
</span><span id="line-3531"></span><span>    </span><span class="hs-comment">--    This rule follows from the fact that x*y = sup{x,y} for any</span><span>
</span><span id="line-3532"></span><span>    </span><span class="hs-comment">--    multiplicities x,y.</span><span>
</span><span id="line-3533"></span><span>    </span><span class="hs-comment">-- 2. x &lt;= y*z when x &lt;= y or x &lt;= z.</span><span>
</span><span id="line-3534"></span><span>    </span><span class="hs-comment">--    This rule is not complete: when x = y*z, we cannot</span><span>
</span><span id="line-3535"></span><span>    </span><span class="hs-comment">--    change y*z &lt;= y*z to y*z &lt;= y or y*z &lt;= z.</span><span>
</span><span id="line-3536"></span><span>    </span><span class="hs-comment">--    However, we eliminate products on the LHS in step 1.</span><span>
</span><span id="line-3537"></span><span>    </span><span class="hs-comment">-- 3. One &lt;= x and x &lt;= Many for any x, as checked by 'submult'.</span><span>
</span><span id="line-3538"></span><span>    </span><span class="hs-comment">-- 4. x &lt;= x.</span><span>
</span><span id="line-3539"></span><span>    </span><span class="hs-comment">-- Otherwise, we fail.</span><span>
</span><span id="line-3540"></span><span>    </span><span class="annot"><a href="#local-6989586621682974211"><span class="hs-identifier hs-type">deepSubMult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Mult"><span class="hs-identifier hs-type">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-3541"></span><span>    </span><span id="local-6989586621682974211"><span class="annot"><span class="annottext">deepSubMult :: LintedType -&gt; LintedType -&gt; Bool
</span><a href="#local-6989586621682974211"><span class="hs-identifier hs-var hs-var">deepSubMult</span></a></span></span><span> </span><span id="local-6989586621682974212"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682974213"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-3542"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974214"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974214"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682974215"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974215"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (LintedType, LintedType)
</span><a href="GHC.Core.Multiplicity.html#isMultMul"><span class="hs-identifier hs-var">isMultMul</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; Bool
</span><a href="#local-6989586621682974211"><span class="hs-identifier hs-var">deepSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974214"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; Bool
</span><a href="#local-6989586621682974211"><span class="hs-identifier hs-var">deepSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974215"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3543"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682974217"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974217"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682974218"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974218"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; Maybe (LintedType, LintedType)
</span><a href="GHC.Core.Multiplicity.html#isMultMul"><span class="hs-identifier hs-var">isMultMul</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; Bool
</span><a href="#local-6989586621682974211"><span class="hs-identifier hs-var">deepSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span><span>  </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974217"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; Bool
</span><a href="#local-6989586621682974211"><span class="hs-identifier hs-var">deepSubMult</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span><span>  </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974218"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-3544"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsSubmult
</span><a href="GHC.Core.Multiplicity.html#Submult"><span class="hs-identifier hs-var">Submult</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; LintedType -&gt; IsSubmult
</span><a href="GHC.Core.Multiplicity.html#submult"><span class="hs-operator hs-var">`submult`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-3545"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; LintedType -&gt; LintedType -&gt; Bool
LintedType -&gt; LintedType -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974213"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-3546"></span><span>
</span><span id="line-3547"></span><span id="local-6989586621682970430"><span class="annot"><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-type">lintRole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682970430"><span class="hs-identifier hs-type">thing</span></a></span><span>
</span><span id="line-3548"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682970430"><span class="hs-identifier hs-type">thing</span></a></span><span>     </span><span class="hs-comment">-- where the role appeared</span><span>
</span><span id="line-3549"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>      </span><span class="hs-comment">-- expected</span><span>
</span><span id="line-3550"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Basic.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>      </span><span class="hs-comment">-- actual</span><span>
</span><span id="line-3551"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintM"><span class="hs-identifier hs-type">LintM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-3552"></span><span id="lintRole"><span class="annot"><span class="annottext">lintRole :: forall thing. Outputable thing =&gt; thing -&gt; Role -&gt; Role -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintRole"><span class="hs-identifier hs-var hs-var">lintRole</span></a></span></span><span> </span><span id="local-6989586621682974236"><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621682974236"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682974237"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974237"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621682974238"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974238"><span class="hs-identifier hs-var">r2</span></a></span></span><span>
</span><span id="line-3553"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; LintM ()
</span><a href="GHC.Core.Lint.html#lintL"><span class="hs-identifier hs-var">lintL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974237"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974238"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3554"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Role incompatibility: expected&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974237"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-3555"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;got&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682974238"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-3556"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">thing -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">thing
</span><a href="#local-6989586621682974236"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3557"></span><span>
</span><span id="line-3558"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Error messages}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-3565"></span><span>
</span><span id="line-3566"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-type">dumpLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintLocInfo"><span class="hs-identifier hs-type">LintLocInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcLoc"><span class="hs-identifier hs-type">SrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3567"></span><span>
</span><span id="line-3568"></span><span id="dumpLoc"><span class="annot"><span class="annottext">dumpLoc :: LintLocInfo -&gt; (SrcLoc, SDoc)
</span><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var hs-var">dumpLoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#RhsOf"><span class="hs-identifier hs-type">RhsOf</span></a></span><span> </span><span id="local-6989586621682974240"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974240"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3569"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974240"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the RHS of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974240"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3570"></span><span>
</span><span id="line-3571"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#OccOf"><span class="hs-identifier hs-type">OccOf</span></a></span><span> </span><span id="local-6989586621682974243"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974243"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3572"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974243"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In an occurrence of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974243"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3573"></span><span>
</span><span id="line-3574"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#LambdaBodyOf"><span class="hs-identifier hs-type">LambdaBodyOf</span></a></span><span> </span><span id="local-6989586621682974245"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974245"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3575"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974245"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the body of lambda with binder&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974245"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3576"></span><span>
</span><span id="line-3577"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#RuleOf"><span class="hs-identifier hs-type">RuleOf</span></a></span><span> </span><span id="local-6989586621682974246"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974246"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3578"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974246"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In a rule attached to&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974246"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3579"></span><span>
</span><span id="line-3580"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#UnfoldingOf"><span class="hs-identifier hs-type">UnfoldingOf</span></a></span><span> </span><span id="local-6989586621682974247"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974247"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3581"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974247"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the unfolding of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974247"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3582"></span><span>
</span><span id="line-3583"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#BodyOfLet"><span class="hs-identifier hs-type">BodyOfLet</span></a></span><span> </span><span id="local-6989586621682974248"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974248"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3584"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the body of a let with binder&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974248"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3585"></span><span>
</span><span id="line-3586"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#BodyOfLetRec"><span class="hs-identifier hs-type">BodyOfLetRec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3587"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In body of a letrec with no binders&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3588"></span><span>
</span><span id="line-3589"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#BodyOfLetRec"><span class="hs-identifier hs-type">BodyOfLetRec</span></a></span><span> </span><span id="local-6989586621682974250"><span class="annot"><span class="annottext">bs :: [Var]
</span><a href="#local-6989586621682974250"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682974251"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974251"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3590"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974251"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the body of a letrec with binders&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974250"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3591"></span><span>
</span><span id="line-3592"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#AnExpr"><span class="hs-identifier hs-type">AnExpr</span></a></span><span> </span><span id="local-6989586621682974252"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974252"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3593"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the expression:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974252"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3594"></span><span>
</span><span id="line-3595"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#CaseAlt"><span class="hs-identifier hs-type">CaseAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span id="local-6989586621682974253"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682974253"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682974254"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974254"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3596"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In a case alternative:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682974253"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974254"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3597"></span><span>
</span><span id="line-3598"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#CasePat"><span class="hs-identifier hs-type">CasePat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span id="local-6989586621682974255"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682974255"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621682974256"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974256"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3599"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the pattern of a case alternative:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682974255"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-var">pp_binders</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974256"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3600"></span><span>
</span><span id="line-3601"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#CaseTy"><span class="hs-identifier hs-type">CaseTy</span></a></span><span> </span><span id="local-6989586621682974257"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974257"><span class="hs-identifier hs-var">scrut</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3602"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the result-type of a case with scrutinee:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3603"></span><span>                  </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974257"><span class="hs-identifier hs-var">scrut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3604"></span><span>
</span><span id="line-3605"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#IdTy"><span class="hs-identifier hs-type">IdTy</span></a></span><span> </span><span id="local-6989586621682974258"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974258"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3606"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974258"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the type of a binder:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974258"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3607"></span><span>
</span><span id="line-3608"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#ImportedUnfolding"><span class="hs-identifier hs-type">ImportedUnfolding</span></a></span><span> </span><span id="local-6989586621682974259"><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682974259"><span class="hs-identifier hs-var">locn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3609"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621682974259"><span class="hs-identifier hs-var">locn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In an imported unfolding&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3610"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LintLocInfo
</span><a href="GHC.Core.Lint.html#TopLevelBindings"><span class="hs-identifier hs-var">TopLevelBindings</span></a></span><span>
</span><span id="line-3611"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsOutput doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3612"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#InType"><span class="hs-identifier hs-type">InType</span></a></span><span> </span><span id="local-6989586621682974260"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974260"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3613"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974260"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3614"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#InCo"><span class="hs-identifier hs-type">InCo</span></a></span><span> </span><span id="local-6989586621682974261"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974261"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3615"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc
</span><a href="GHC.Types.SrcLoc.html#noSrcLoc"><span class="hs-identifier hs-var">noSrcLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the coercion&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974261"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3616"></span><span class="annot"><a href="GHC.Core.Lint.html#dumpLoc"><span class="hs-identifier hs-var">dumpLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Lint.html#InAxiom"><span class="hs-identifier hs-type">InAxiom</span></a></span><span> </span><span id="local-6989586621682974262"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682974262"><span class="hs-identifier hs-var">ax</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3617"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SrcLoc
forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682974262"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the coercion axiom&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3618"></span><span>                      </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; SDoc
forall (br :: BranchFlag). CoAxiom br -&gt; SDoc
</span><a href="GHC.Core.Coercion.html#pprCoAxiom"><span class="hs-identifier hs-var">pprCoAxiom</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621682974262"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3619"></span><span>
</span><span id="line-3620"></span><span class="annot"><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-type">pp_binders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3621"></span><span id="pp_binders"><span class="annot"><span class="annottext">pp_binders :: [Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binders"><span class="hs-identifier hs-var hs-var">pp_binders</span></a></span></span><span> </span><span id="local-6989586621682974263"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974263"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; [SDoc] -&gt; [SDoc]
forall doc. IsLine doc =&gt; doc -&gt; [doc] -&gt; [doc]
</span><a href="GHC.Utils.Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; SDoc) -&gt; [Var] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var">pp_binder</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974263"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3622"></span><span>
</span><span id="line-3623"></span><span class="annot"><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-type">pp_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3624"></span><span id="pp_binder"><span class="annot"><span class="annottext">pp_binder :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#pp_binder"><span class="hs-identifier hs-var hs-var">pp_binder</span></a></span></span><span> </span><span id="local-6989586621682974265"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isId"><span class="hs-identifier hs-var">isId</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3625"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974265"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3626"></span><span>
</span><span id="line-3627"></span><span class="hs-comment">------------------------------------------------------</span><span>
</span><span id="line-3628"></span><span class="hs-comment">--      Messages for case expressions</span><span>
</span><span id="line-3629"></span><span>
</span><span id="line-3630"></span><span class="annot"><a href="GHC.Core.Lint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-type">mkDefaultArgsMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3631"></span><span id="mkDefaultArgsMsg"><span class="annot"><span class="annottext">mkDefaultArgsMsg :: [Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkDefaultArgsMsg"><span class="hs-identifier hs-var hs-var">mkDefaultArgsMsg</span></a></span></span><span> </span><span id="local-6989586621682974266"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974266"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-3632"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DEFAULT case with binders&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3633"></span><span>         </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974266"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3634"></span><span>
</span><span id="line-3635"></span><span class="annot"><a href="GHC.Core.Lint.html#mkCaseAltMsg"><span class="hs-identifier hs-type">mkCaseAltMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3636"></span><span id="mkCaseAltMsg"><span class="annot"><span class="annottext">mkCaseAltMsg :: CoreExpr -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkCaseAltMsg"><span class="hs-identifier hs-var hs-var">mkCaseAltMsg</span></a></span></span><span> </span><span id="local-6989586621682974267"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974267"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682974268"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974268"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621682974269"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974269"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-3637"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type of case alternatives not the same as the annotation on case:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3638"></span><span>         </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Actual type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974268"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3639"></span><span>                   </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Annotation on case:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974269"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3640"></span><span>                   </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Alt Rhs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974267"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3641"></span><span>
</span><span id="line-3642"></span><span class="annot"><a href="GHC.Core.Lint.html#mkScrutMsg"><span class="hs-identifier hs-type">mkScrutMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3643"></span><span id="mkScrutMsg"><span class="annot"><span class="annottext">mkScrutMsg :: Var -&gt; LintedType -&gt; LintedType -&gt; Subst -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkScrutMsg"><span class="hs-identifier hs-var hs-var">mkScrutMsg</span></a></span></span><span> </span><span id="local-6989586621682974270"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974270"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682974271"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974271"><span class="hs-identifier hs-var">var_ty</span></a></span></span><span> </span><span id="local-6989586621682974272"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974272"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682974273"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682974273"><span class="hs-identifier hs-var">subst</span></a></span></span><span>
</span><span id="line-3644"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Result binder in case doesn't match scrutinee:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974270"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3645"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Result binder type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974271"><span class="hs-identifier hs-var">var_ty</span></a></span><span class="hs-special">,</span><span class="hs-comment">--(idType var),</span><span>
</span><span id="line-3646"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Scrutinee type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974272"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3647"></span><span>     </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Current TCv subst&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621682974273"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-3648"></span><span>
</span><span id="line-3649"></span><span class="annot"><a href="GHC.Core.Lint.html#mkNonDefltMsg"><span class="hs-identifier hs-type">mkNonDefltMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#mkNonIncreasingAltsMsg"><span class="hs-identifier hs-type">mkNonIncreasingAltsMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3650"></span><span id="mkNonDefltMsg"><span class="annot"><span class="annottext">mkNonDefltMsg :: CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonDefltMsg"><span class="hs-identifier hs-var hs-var">mkNonDefltMsg</span></a></span></span><span> </span><span id="local-6989586621682974274"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974274"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-3651"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Case expression with DEFAULT not at the beginning&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974274"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3652"></span><span id="mkNonIncreasingAltsMsg"><span class="annot"><span class="annottext">mkNonIncreasingAltsMsg :: CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonIncreasingAltsMsg"><span class="hs-identifier hs-var hs-var">mkNonIncreasingAltsMsg</span></a></span></span><span> </span><span id="local-6989586621682974275"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974275"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-3653"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Case expression with badly-ordered alternatives&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974275"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3654"></span><span>
</span><span id="line-3655"></span><span class="annot"><a href="GHC.Core.Lint.html#nonExhaustiveAltsMsg"><span class="hs-identifier hs-type">nonExhaustiveAltsMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3656"></span><span id="nonExhaustiveAltsMsg"><span class="annot"><span class="annottext">nonExhaustiveAltsMsg :: CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#nonExhaustiveAltsMsg"><span class="hs-identifier hs-var hs-var">nonExhaustiveAltsMsg</span></a></span></span><span> </span><span id="local-6989586621682974276"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974276"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-3657"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Case expression with non-exhaustive alternatives&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974276"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3658"></span><span>
</span><span id="line-3659"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadConMsg"><span class="hs-identifier hs-type">mkBadConMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3660"></span><span id="mkBadConMsg"><span class="annot"><span class="annottext">mkBadConMsg :: TyCon -&gt; DataCon -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadConMsg"><span class="hs-identifier hs-var hs-var">mkBadConMsg</span></a></span></span><span> </span><span id="local-6989586621682974277"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682974277"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621682974278"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682974278"><span class="hs-identifier hs-var">datacon</span></a></span></span><span>
</span><span id="line-3661"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3662"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In a case alternative, data constructor isn't in scrutinee type:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3663"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Scrutinee type constructor:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682974277"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3664"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data con:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682974278"><span class="hs-identifier hs-var">datacon</span></a></span><span>
</span><span id="line-3665"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-3666"></span><span>
</span><span id="line-3667"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadPatMsg"><span class="hs-identifier hs-type">mkBadPatMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3668"></span><span id="mkBadPatMsg"><span class="annot"><span class="annottext">mkBadPatMsg :: LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadPatMsg"><span class="hs-identifier hs-var hs-var">mkBadPatMsg</span></a></span></span><span> </span><span id="local-6989586621682974279"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974279"><span class="hs-identifier hs-var">con_result_ty</span></a></span></span><span> </span><span id="local-6989586621682974280"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974280"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span>
</span><span id="line-3669"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-3670"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In a case alternative, pattern result type doesn't match scrutinee type:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3671"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern result type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974279"><span class="hs-identifier hs-var">con_result_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3672"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Scrutinee type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974280"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span>
</span><span id="line-3673"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-3674"></span><span>
</span><span id="line-3675"></span><span class="annot"><a href="GHC.Core.Lint.html#integerScrutinisedMsg"><span class="hs-identifier hs-type">integerScrutinisedMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3676"></span><span id="integerScrutinisedMsg"><span class="annot"><span class="annottext">integerScrutinisedMsg :: SDoc
</span><a href="GHC.Core.Lint.html#integerScrutinisedMsg"><span class="hs-identifier hs-var hs-var">integerScrutinisedMsg</span></a></span></span><span>
</span><span id="line-3677"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In a LitAlt, the literal is lifted (probably Integer)&quot;</span></span><span>
</span><span id="line-3678"></span><span>
</span><span id="line-3679"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadAltMsg"><span class="hs-identifier hs-type">mkBadAltMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3680"></span><span id="mkBadAltMsg"><span class="annot"><span class="annottext">mkBadAltMsg :: LintedType -&gt; Alt Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadAltMsg"><span class="hs-identifier hs-var hs-var">mkBadAltMsg</span></a></span></span><span> </span><span id="local-6989586621682974281"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974281"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682974282"><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682974282"><span class="hs-identifier hs-var">alt</span></a></span></span><span>
</span><span id="line-3681"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data alternative when scrutinee is not a tycon application&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3682"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Scrutinee type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974281"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3683"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Alternative:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var -&gt; SDoc
forall a. OutputableBndr a =&gt; Alt a -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprCoreAlt"><span class="hs-identifier hs-var">pprCoreAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682974282"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3684"></span><span>
</span><span id="line-3685"></span><span class="annot"><a href="GHC.Core.Lint.html#mkNewTyDataConAltMsg"><span class="hs-identifier hs-type">mkNewTyDataConAltMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreAlt"><span class="hs-identifier hs-type">CoreAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3686"></span><span id="mkNewTyDataConAltMsg"><span class="annot"><span class="annottext">mkNewTyDataConAltMsg :: LintedType -&gt; Alt Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNewTyDataConAltMsg"><span class="hs-identifier hs-var hs-var">mkNewTyDataConAltMsg</span></a></span></span><span> </span><span id="local-6989586621682974284"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974284"><span class="hs-identifier hs-var">scrut_ty</span></a></span></span><span> </span><span id="local-6989586621682974285"><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682974285"><span class="hs-identifier hs-var">alt</span></a></span></span><span>
</span><span id="line-3687"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data alternative for newtype datacon&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3688"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Scrutinee type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974284"><span class="hs-identifier hs-var">scrut_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3689"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Alternative:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var -&gt; SDoc
forall a. OutputableBndr a =&gt; Alt a -&gt; SDoc
</span><a href="GHC.Core.Ppr.html#pprCoreAlt"><span class="hs-identifier hs-var">pprCoreAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Alt Var
</span><a href="#local-6989586621682974285"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3690"></span><span>
</span><span id="line-3691"></span><span>
</span><span id="line-3692"></span><span class="hs-comment">------------------------------------------------------</span><span>
</span><span id="line-3693"></span><span class="hs-comment">--      Other error messages</span><span>
</span><span id="line-3694"></span><span>
</span><span id="line-3695"></span><span class="annot"><a href="GHC.Core.Lint.html#mkAppMsg"><span class="hs-identifier hs-type">mkAppMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3696"></span><span id="mkAppMsg"><span class="annot"><span class="annottext">mkAppMsg :: LintedType -&gt; LintedType -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkAppMsg"><span class="hs-identifier hs-var hs-var">mkAppMsg</span></a></span></span><span> </span><span id="local-6989586621682974286"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974286"><span class="hs-identifier hs-var">expected_arg_ty</span></a></span></span><span> </span><span id="local-6989586621682974287"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974287"><span class="hs-identifier hs-var">actual_arg_ty</span></a></span></span><span> </span><span id="local-6989586621682974288"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974288"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-3697"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Argument value doesn't match argument type:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3698"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected arg type:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974286"><span class="hs-identifier hs-var">expected_arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3699"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Actual arg type:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974287"><span class="hs-identifier hs-var">actual_arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3700"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974288"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3701"></span><span>
</span><span id="line-3702"></span><span class="annot"><a href="GHC.Core.Lint.html#mkNonFunAppMsg"><span class="hs-identifier hs-type">mkNonFunAppMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3703"></span><span id="mkNonFunAppMsg"><span class="annot"><span class="annottext">mkNonFunAppMsg :: LintedType -&gt; LintedType -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonFunAppMsg"><span class="hs-identifier hs-var hs-var">mkNonFunAppMsg</span></a></span></span><span> </span><span id="local-6989586621682974289"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974289"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682974290"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974290"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span> </span><span id="local-6989586621682974291"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974291"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-3704"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-function type in function position&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3705"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fun type:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974289"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3706"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg type:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974290"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3707"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974291"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3708"></span><span>
</span><span id="line-3709"></span><span class="annot"><a href="GHC.Core.Lint.html#mkLetErr"><span class="hs-identifier hs-type">mkLetErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3710"></span><span id="mkLetErr"><span class="annot"><span class="annottext">mkLetErr :: Var -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkLetErr"><span class="hs-identifier hs-var hs-var">mkLetErr</span></a></span></span><span> </span><span id="local-6989586621682974292"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974292"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682974293"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974293"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-3711"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad `let' binding:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3712"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Variable:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3713"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974292"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974292"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3714"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rhs:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3715"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974293"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3716"></span><span>
</span><span id="line-3717"></span><span class="annot"><a href="GHC.Core.Lint.html#mkTyAppMsg"><span class="hs-identifier hs-type">mkTyAppMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3718"></span><span id="mkTyAppMsg"><span class="annot"><span class="annottext">mkTyAppMsg :: LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkTyAppMsg"><span class="hs-identifier hs-var hs-var">mkTyAppMsg</span></a></span></span><span> </span><span id="local-6989586621682974294"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974294"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621682974295"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974295"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-3719"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal type application:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3720"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function type:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3721"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974294"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974294"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3722"></span><span>              </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type argument:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3723"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974295"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974295"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3724"></span><span>
</span><span id="line-3725"></span><span class="annot"><a href="GHC.Core.Lint.html#mkCoAppMsg"><span class="hs-identifier hs-type">mkCoAppMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3726"></span><span id="mkCoAppMsg"><span class="annot"><span class="annottext">mkCoAppMsg :: LintedType -&gt; Coercion -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkCoAppMsg"><span class="hs-identifier hs-var hs-var">mkCoAppMsg</span></a></span></span><span> </span><span id="local-6989586621682974296"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974296"><span class="hs-identifier hs-var">fun_ty</span></a></span></span><span> </span><span id="local-6989586621682974297"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974297"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-3727"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal coercion application:&quot;</span></span><span>
</span><span id="line-3728"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function type:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3729"></span><span>              </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974296"><span class="hs-identifier hs-var">fun_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3730"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Coercion argument:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3731"></span><span>              </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974297"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; LintedType
</span><a href="GHC.Core.Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974297"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3732"></span><span>
</span><span id="line-3733"></span><span class="annot"><a href="GHC.Core.Lint.html#emptyRec"><span class="hs-identifier hs-type">emptyRec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3734"></span><span id="emptyRec"><span class="annot"><span class="annottext">emptyRec :: CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#emptyRec"><span class="hs-identifier hs-var hs-var">emptyRec</span></a></span></span><span> </span><span id="local-6989586621682974298"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974298"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty Rec binding:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974298"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3735"></span><span>
</span><span id="line-3736"></span><span class="annot"><a href="GHC.Core.Lint.html#mkRhsMsg"><span class="hs-identifier hs-type">mkRhsMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3737"></span><span id="mkRhsMsg"><span class="annot"><span class="annottext">mkRhsMsg :: Var -&gt; SDoc -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkRhsMsg"><span class="hs-identifier hs-var hs-var">mkRhsMsg</span></a></span></span><span> </span><span id="local-6989586621682974299"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974299"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621682974300"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974300"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span id="local-6989586621682974301"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974301"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3738"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-3739"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The type of this binder doesn't match the type of its&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974300"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3740"></span><span>            </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974299"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3741"></span><span>     </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binder's type:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974299"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-3742"></span><span>     </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rhs type:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974301"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-3743"></span><span>
</span><span id="line-3744"></span><span class="annot"><a href="GHC.Core.Lint.html#badBndrTyMsg"><span class="hs-identifier hs-type">badBndrTyMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3745"></span><span id="badBndrTyMsg"><span class="annot"><span class="annottext">badBndrTyMsg :: Var -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Core.Lint.html#badBndrTyMsg"><span class="hs-identifier hs-var hs-var">badBndrTyMsg</span></a></span></span><span> </span><span id="local-6989586621682974302"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974302"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621682974303"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974303"><span class="hs-identifier hs-var">what</span></a></span></span><span>
</span><span id="line-3746"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The type of this binder is&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974303"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974302"><span class="hs-identifier hs-var">binder</span></a></span><span>
</span><span id="line-3747"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binder's type:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974302"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3748"></span><span>
</span><span id="line-3749"></span><span class="annot"><a href="GHC.Core.Lint.html#mkNonTopExportedMsg"><span class="hs-identifier hs-type">mkNonTopExportedMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3750"></span><span id="mkNonTopExportedMsg"><span class="annot"><span class="annottext">mkNonTopExportedMsg :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonTopExportedMsg"><span class="hs-identifier hs-var hs-var">mkNonTopExportedMsg</span></a></span></span><span> </span><span id="local-6989586621682974304"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974304"><span class="hs-identifier hs-var">binder</span></a></span></span><span>
</span><span id="line-3751"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-top-level binder is marked as exported:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974304"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3752"></span><span>
</span><span id="line-3753"></span><span class="annot"><a href="GHC.Core.Lint.html#mkNonTopExternalNameMsg"><span class="hs-identifier hs-type">mkNonTopExternalNameMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3754"></span><span id="mkNonTopExternalNameMsg"><span class="annot"><span class="annottext">mkNonTopExternalNameMsg :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkNonTopExternalNameMsg"><span class="hs-identifier hs-var hs-var">mkNonTopExternalNameMsg</span></a></span></span><span> </span><span id="local-6989586621682974305"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974305"><span class="hs-identifier hs-var">binder</span></a></span></span><span>
</span><span id="line-3755"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-top-level binder has an external name:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974305"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3756"></span><span>
</span><span id="line-3757"></span><span class="annot"><a href="GHC.Core.Lint.html#mkTopNonLitStrMsg"><span class="hs-identifier hs-type">mkTopNonLitStrMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3758"></span><span id="mkTopNonLitStrMsg"><span class="annot"><span class="annottext">mkTopNonLitStrMsg :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkTopNonLitStrMsg"><span class="hs-identifier hs-var hs-var">mkTopNonLitStrMsg</span></a></span></span><span> </span><span id="local-6989586621682974306"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974306"><span class="hs-identifier hs-var">binder</span></a></span></span><span>
</span><span id="line-3759"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Top-level Addr# binder has a non-literal rhs:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974306"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3760"></span><span>
</span><span id="line-3761"></span><span class="annot"><a href="GHC.Core.Lint.html#mkKindErrMsg"><span class="hs-identifier hs-type">mkKindErrMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3762"></span><span id="mkKindErrMsg"><span class="annot"><span class="annottext">mkKindErrMsg :: Var -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkKindErrMsg"><span class="hs-identifier hs-var hs-var">mkKindErrMsg</span></a></span></span><span> </span><span id="local-6989586621682974307"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974307"><span class="hs-identifier hs-var">tyvar</span></a></span></span><span> </span><span id="local-6989586621682974308"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974308"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span>
</span><span id="line-3763"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Kinds don't match in type application:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3764"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type variable:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3765"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974307"><span class="hs-identifier hs-var">tyvar</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974307"><span class="hs-identifier hs-var">tyvar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3766"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arg type:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3767"></span><span>                 </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974308"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; LintedType -&gt; LintedType
LintedType -&gt; LintedType
</span><a href="GHC.Core.Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974308"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-3768"></span><span>
</span><span id="line-3769"></span><span class="annot"><a href="GHC.Core.Lint.html#mkCastErr"><span class="hs-identifier hs-type">mkCastErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3770"></span><span id="mkCastErr"><span class="annot"><span class="annottext">mkCastErr :: CoreExpr -&gt; Coercion -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkCastErr"><span class="hs-identifier hs-var hs-var">mkCastErr</span></a></span></span><span> </span><span id="local-6989586621682974309"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974309"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; SDoc -&gt; Coercion -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mk_cast_err"><span class="hs-identifier hs-var">mk_cast_err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expression&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974309"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3771"></span><span>
</span><span id="line-3772"></span><span class="annot"><a href="GHC.Core.Lint.html#mkCastTyErr"><span class="hs-identifier hs-type">mkCastTyErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3773"></span><span id="mkCastTyErr"><span class="annot"><span class="annottext">mkCastTyErr :: LintedType -&gt; Coercion -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkCastTyErr"><span class="hs-identifier hs-var hs-var">mkCastTyErr</span></a></span></span><span> </span><span id="local-6989586621682974311"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974311"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; SDoc -&gt; Coercion -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mk_cast_err"><span class="hs-identifier hs-var">mk_cast_err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kind&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974311"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3774"></span><span>
</span><span id="line-3775"></span><span class="annot"><a href="GHC.Core.Lint.html#mk_cast_err"><span class="hs-identifier hs-type">mk_cast_err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ What sort of casted thing this is</span><span>
</span><span id="line-3776"></span><span>                      </span><span class="hs-comment">--   (\&quot;expression\&quot; or \&quot;type\&quot;).</span><span>
</span><span id="line-3777"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ What sort of coercion is being used</span><span>
</span><span id="line-3778"></span><span>                      </span><span class="hs-comment">--   (\&quot;type\&quot; or \&quot;kind\&quot;).</span><span>
</span><span id="line-3779"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The thing being casted.</span></span><span>
</span><span id="line-3780"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3781"></span><span id="mk_cast_err"><span class="annot"><span class="annottext">mk_cast_err :: String
-&gt; String -&gt; SDoc -&gt; Coercion -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mk_cast_err"><span class="hs-identifier hs-var hs-var">mk_cast_err</span></a></span></span><span> </span><span id="local-6989586621682974312"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974312"><span class="hs-identifier hs-var">thing_str</span></a></span></span><span> </span><span id="local-6989586621682974313"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974313"><span class="hs-identifier hs-var">co_str</span></a></span></span><span> </span><span id="local-6989586621682974314"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974314"><span class="hs-identifier hs-var">pp_thing</span></a></span></span><span> </span><span id="local-6989586621682974315"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974315"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621682974316"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974316"><span class="hs-identifier hs-var">from_ty</span></a></span></span><span> </span><span id="local-6989586621682974317"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974317"><span class="hs-identifier hs-var">thing_ty</span></a></span></span><span>
</span><span id="line-3782"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974318"><span class="hs-identifier hs-var">from_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;of Cast differs from&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974319"><span class="hs-identifier hs-var">co_msg</span></a></span><span>
</span><span id="line-3783"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974320"><span class="hs-identifier hs-var">enclosed_msg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3784"></span><span>          </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974318"><span class="hs-identifier hs-var">from_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974316"><span class="hs-identifier hs-var">from_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3785"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="GHC.Utils.Misc.html#capitalise"><span class="hs-identifier hs-var">capitalise</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974313"><span class="hs-identifier hs-var">co_str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974320"><span class="hs-identifier hs-var">enclosed_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span>
</span><span id="line-3786"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974317"><span class="hs-identifier hs-var">thing_ty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3787"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Actual&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974320"><span class="hs-identifier hs-var">enclosed_msg</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974314"><span class="hs-identifier hs-var">pp_thing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3788"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Coercion used in cast:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621682974315"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-3789"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-3790"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3791"></span><span>    </span><span class="annot"><a href="#local-6989586621682974319"><span class="hs-identifier hs-type">co_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682974318"><span class="hs-identifier hs-type">from_msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682974320"><span class="hs-identifier hs-type">enclosed_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3792"></span><span>    </span><span id="local-6989586621682974319"><span class="annot"><span class="annottext">co_msg :: SDoc
</span><a href="#local-6989586621682974319"><span class="hs-identifier hs-var hs-var">co_msg</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974313"><span class="hs-identifier hs-var">co_str</span></a></span><span>
</span><span id="line-3793"></span><span>    </span><span id="local-6989586621682974318"><span class="annot"><span class="annottext">from_msg :: SDoc
</span><a href="#local-6989586621682974318"><span class="hs-identifier hs-var hs-var">from_msg</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;From-&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974319"><span class="hs-identifier hs-var">co_msg</span></a></span><span>
</span><span id="line-3794"></span><span>    </span><span id="local-6989586621682974320"><span class="annot"><span class="annottext">enclosed_msg :: SDoc
</span><a href="#local-6989586621682974320"><span class="hs-identifier hs-var hs-var">enclosed_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;enclosed&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682974312"><span class="hs-identifier hs-var">thing_str</span></a></span><span>
</span><span id="line-3795"></span><span>
</span><span id="line-3796"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadTyVarMsg"><span class="hs-identifier hs-type">mkBadTyVarMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3797"></span><span id="mkBadTyVarMsg"><span class="annot"><span class="annottext">mkBadTyVarMsg :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadTyVarMsg"><span class="hs-identifier hs-var hs-var">mkBadTyVarMsg</span></a></span></span><span> </span><span id="local-6989586621682974322"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974322"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-3798"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-tyvar used in TyVarTy:&quot;</span></span><span>
</span><span id="line-3799"></span><span>      </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974322"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974322"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3800"></span><span>
</span><span id="line-3801"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadJoinBindMsg"><span class="hs-identifier hs-type">mkBadJoinBindMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3802"></span><span id="mkBadJoinBindMsg"><span class="annot"><span class="annottext">mkBadJoinBindMsg :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJoinBindMsg"><span class="hs-identifier hs-var hs-var">mkBadJoinBindMsg</span></a></span></span><span> </span><span id="local-6989586621682974323"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974323"><span class="hs-identifier hs-var">var</span></a></span></span><span>
</span><span id="line-3803"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad join point binding:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974323"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-3804"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join points can be bound only by a non-top-level let&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3805"></span><span>
</span><span id="line-3806"></span><span class="annot"><a href="GHC.Core.Lint.html#mkInvalidJoinPointMsg"><span class="hs-identifier hs-type">mkInvalidJoinPointMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3807"></span><span id="mkInvalidJoinPointMsg"><span class="annot"><span class="annottext">mkInvalidJoinPointMsg :: Var -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkInvalidJoinPointMsg"><span class="hs-identifier hs-var hs-var">mkInvalidJoinPointMsg</span></a></span></span><span> </span><span id="local-6989586621682974324"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974324"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682974325"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974325"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-3808"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join point has invalid type:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3809"></span><span>        </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974324"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974325"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3810"></span><span>
</span><span id="line-3811"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadJoinArityMsg"><span class="hs-identifier hs-type">mkBadJoinArityMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3812"></span><span id="mkBadJoinArityMsg"><span class="annot"><span class="annottext">mkBadJoinArityMsg :: Var -&gt; JoinArity -&gt; JoinArity -&gt; CoreExpr -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJoinArityMsg"><span class="hs-identifier hs-var hs-var">mkBadJoinArityMsg</span></a></span></span><span> </span><span id="local-6989586621682974326"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974326"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682974327"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974327"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621682974328"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974328"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682974329"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974329"><span class="hs-identifier hs-var">rhs</span></a></span></span><span>
</span><span id="line-3813"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join point has too few lambdas&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3814"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join var:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974326"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3815"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join arity:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974327"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3816"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Number of lambdas:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974327"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; JoinArity -&gt; JoinArity
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974328"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3817"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rhs = &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974329"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-3818"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-3819"></span><span>
</span><span id="line-3820"></span><span class="annot"><a href="GHC.Core.Lint.html#invalidJoinOcc"><span class="hs-identifier hs-type">invalidJoinOcc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3821"></span><span id="invalidJoinOcc"><span class="annot"><span class="annottext">invalidJoinOcc :: Var -&gt; SDoc
</span><a href="GHC.Core.Lint.html#invalidJoinOcc"><span class="hs-identifier hs-var hs-var">invalidJoinOcc</span></a></span></span><span> </span><span id="local-6989586621682974330"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974330"><span class="hs-identifier hs-var">var</span></a></span></span><span>
</span><span id="line-3822"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid occurrence of a join variable:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974330"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-3823"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The binder is either not a join point, or not valid here&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3824"></span><span>
</span><span id="line-3825"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadJumpMsg"><span class="hs-identifier hs-type">mkBadJumpMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3826"></span><span id="mkBadJumpMsg"><span class="annot"><span class="annottext">mkBadJumpMsg :: Var -&gt; JoinArity -&gt; JoinArity -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJumpMsg"><span class="hs-identifier hs-var hs-var">mkBadJumpMsg</span></a></span></span><span> </span><span id="local-6989586621682974331"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974331"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682974332"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974332"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621682974333"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974333"><span class="hs-identifier hs-var">nargs</span></a></span></span><span>
</span><span id="line-3827"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join point invoked with wrong number of arguments&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3828"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join var:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974331"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3829"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join arity:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974332"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3830"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Number of arguments:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall doc. IsLine doc =&gt; JoinArity -&gt; doc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974333"><span class="hs-identifier hs-var">nargs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3831"></span><span>
</span><span id="line-3832"></span><span class="annot"><a href="GHC.Core.Lint.html#mkInconsistentRecMsg"><span class="hs-identifier hs-type">mkInconsistentRecMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3833"></span><span id="mkInconsistentRecMsg"><span class="annot"><span class="annottext">mkInconsistentRecMsg :: [Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkInconsistentRecMsg"><span class="hs-identifier hs-var hs-var">mkInconsistentRecMsg</span></a></span></span><span> </span><span id="local-6989586621682974334"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974334"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span>
</span><span id="line-3834"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Recursive let binders mix values and join points&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-3835"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binders:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsLine doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; SDoc) -&gt; [Var] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
</span><a href="#local-6989586621682974335"><span class="hs-identifier hs-var">ppr_with_details</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621682974334"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3836"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3837"></span><span>    </span><span id="local-6989586621682974335"><span class="annot"><span class="annottext">ppr_with_details :: Var -&gt; SDoc
</span><a href="#local-6989586621682974335"><span class="hs-identifier hs-var hs-var">ppr_with_details</span></a></span></span><span> </span><span id="local-6989586621682974340"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974340"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974340"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IdDetails -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; IdDetails
</span><a href="GHC.Types.Var.html#idDetails"><span class="hs-identifier hs-var">idDetails</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974340"><span class="hs-identifier hs-var">bndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3838"></span><span>
</span><span id="line-3839"></span><span class="annot"><a href="GHC.Core.Lint.html#mkJoinBndrOccMismatchMsg"><span class="hs-identifier hs-type">mkJoinBndrOccMismatchMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3840"></span><span id="mkJoinBndrOccMismatchMsg"><span class="annot"><span class="annottext">mkJoinBndrOccMismatchMsg :: Var -&gt; JoinArity -&gt; JoinArity -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkJoinBndrOccMismatchMsg"><span class="hs-identifier hs-var hs-var">mkJoinBndrOccMismatchMsg</span></a></span></span><span> </span><span id="local-6989586621682974341"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974341"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682974342"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974342"><span class="hs-identifier hs-var">join_arity_bndr</span></a></span></span><span> </span><span id="local-6989586621682974343"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974343"><span class="hs-identifier hs-var">join_arity_occ</span></a></span></span><span>
</span><span id="line-3841"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mismatch in join point arity between binder and occurrence&quot;</span></span><span>
</span><span id="line-3842"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Var:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974341"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-3843"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arity at binding site:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974342"><span class="hs-identifier hs-var">join_arity_bndr</span></a></span><span>
</span><span id="line-3844"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arity at occurrence:  &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974343"><span class="hs-identifier hs-var">join_arity_occ</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3845"></span><span>
</span><span id="line-3846"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBndrOccTypeMismatchMsg"><span class="hs-identifier hs-type">mkBndrOccTypeMismatchMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#LintedType"><span class="hs-identifier hs-type">LintedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3847"></span><span id="mkBndrOccTypeMismatchMsg"><span class="annot"><span class="annottext">mkBndrOccTypeMismatchMsg :: Var -&gt; Var -&gt; LintedType -&gt; LintedType -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBndrOccTypeMismatchMsg"><span class="hs-identifier hs-var hs-var">mkBndrOccTypeMismatchMsg</span></a></span></span><span> </span><span id="local-6989586621682974344"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974344"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682974345"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974345"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621682974346"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974346"><span class="hs-identifier hs-var">bndr_ty</span></a></span></span><span> </span><span id="local-6989586621682974347"><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974347"><span class="hs-identifier hs-var">var_ty</span></a></span></span><span>
</span><span id="line-3848"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mismatch in type between binder and occurrence&quot;</span></span><span>
</span><span id="line-3849"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binder:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974344"><span class="hs-identifier hs-var">bndr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974346"><span class="hs-identifier hs-var">bndr_ty</span></a></span><span>
</span><span id="line-3850"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Occurrence:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974345"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType
</span><a href="#local-6989586621682974347"><span class="hs-identifier hs-var">var_ty</span></a></span><span>
</span><span id="line-3851"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Before subst:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LintedType -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; LintedType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974345"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3852"></span><span>
</span><span id="line-3853"></span><span class="annot"><a href="GHC.Core.Lint.html#mkBadJoinPointRuleMsg"><span class="hs-identifier hs-type">mkBadJoinPointRuleMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#JoinId"><span class="hs-identifier hs-type">JoinId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3854"></span><span id="mkBadJoinPointRuleMsg"><span class="annot"><span class="annottext">mkBadJoinPointRuleMsg :: Var -&gt; JoinArity -&gt; CoreRule -&gt; SDoc
</span><a href="GHC.Core.Lint.html#mkBadJoinPointRuleMsg"><span class="hs-identifier hs-var hs-var">mkBadJoinPointRuleMsg</span></a></span></span><span> </span><span id="local-6989586621682974349"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974349"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682974350"><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974350"><span class="hs-identifier hs-var">join_arity</span></a></span></span><span> </span><span id="local-6989586621682974351"><span class="annot"><span class="annottext">CoreRule
</span><a href="#local-6989586621682974351"><span class="hs-identifier hs-var">rule</span></a></span></span><span>
</span><span id="line-3855"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join point has rule with wrong number of arguments&quot;</span></span><span>
</span><span id="line-3856"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Var:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974349"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-3857"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Join arity:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">JoinArity
</span><a href="#local-6989586621682974350"><span class="hs-identifier hs-var">join_arity</span></a></span><span>
</span><span id="line-3858"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rule:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CoreRule -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreRule
</span><a href="#local-6989586621682974351"><span class="hs-identifier hs-var">rule</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-3859"></span><span>
</span><span id="line-3860"></span><span class="annot"><a href="GHC.Core.Lint.html#dupVars"><span class="hs-identifier hs-type">dupVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3861"></span><span id="dupVars"><span class="annot"><span class="annottext">dupVars :: [NonEmpty Var] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#dupVars"><span class="hs-identifier hs-var hs-var">dupVars</span></a></span></span><span> </span><span id="local-6989586621682974352"><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682974352"><span class="hs-identifier hs-var">vars</span></a></span></span><span>
</span><span id="line-3862"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Duplicate variables brought into scope&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3863"></span><span>       </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Var]] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NonEmpty Var -&gt; [Var]) -&gt; [NonEmpty Var] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Var -&gt; [Var]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Var]
</span><a href="#local-6989586621682974352"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3864"></span><span>
</span><span id="line-3865"></span><span class="annot"><a href="GHC.Core.Lint.html#dupExtVars"><span class="hs-identifier hs-type">dupExtVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-3866"></span><span id="dupExtVars"><span class="annot"><span class="annottext">dupExtVars :: [NonEmpty Name] -&gt; SDoc
</span><a href="GHC.Core.Lint.html#dupExtVars"><span class="hs-identifier hs-var hs-var">dupExtVars</span></a></span></span><span> </span><span id="local-6989586621682974353"><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621682974353"><span class="hs-identifier hs-var">vars</span></a></span></span><span>
</span><span id="line-3867"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; JoinArity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Duplicate top-level variables with the same qualified name&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-3868"></span><span>       </span><span class="annot"><span class="annottext">JoinArity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Name]] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NonEmpty Name -&gt; [Name]) -&gt; [NonEmpty Name] -&gt; [[Name]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Name -&gt; [Name]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">[NonEmpty Name]
</span><a href="#local-6989586621682974353"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3869"></span><span>
</span><span id="line-3870"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Annotation Linting}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-3877"></span><span>
</span><span id="line-3878"></span><span class="hs-comment">-- | This checks whether a pass correctly looks through debug</span><span>
</span><span id="line-3879"></span><span class="hs-comment">-- annotations (@SourceNote@). This works a bit different from other</span><span>
</span><span id="line-3880"></span><span class="hs-comment">-- consistency checks: We check this by running the given task twice,</span><span>
</span><span id="line-3881"></span><span class="hs-comment">-- noting all differences between the results.</span><span>
</span><span id="line-3882"></span><span class="annot"><a href="GHC.Core.Lint.html#lintAnnots"><span class="hs-identifier hs-type">lintAnnots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span>
</span><span id="line-3883"></span><span id="lintAnnots"><span class="annot"><span class="annottext">lintAnnots :: SDoc -&gt; (ModGuts -&gt; CoreM ModGuts) -&gt; ModGuts -&gt; CoreM ModGuts
</span><a href="GHC.Core.Lint.html#lintAnnots"><span class="hs-identifier hs-var hs-var">lintAnnots</span></a></span></span><span> </span><span id="local-6989586621682974354"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682974354"><span class="hs-identifier hs-var">pname</span></a></span></span><span> </span><span id="local-6989586621682974355"><span class="annot"><span class="annottext">ModGuts -&gt; CoreM ModGuts
</span><a href="#local-6989586621682974355"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621682974356"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974356"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;lintAnnots&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3884"></span><span>  </span><span class="hs-comment">-- Run the pass as we normally would</span><span>
</span><span id="line-3885"></span><span>  </span><span id="local-6989586621682974357"><span class="annot"><a href="#local-6989586621682974357"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-3886"></span><span>  </span><span id="local-6989586621682974359"><span class="annot"><a href="#local-6989586621682974359"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#getLogger"><span class="hs-identifier hs-type">getLogger</span></a></span><span>
</span><span id="line-3887"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-type">gopt</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_DoAnnotationLinting"><span class="hs-identifier hs-type">Opt_DoAnnotationLinting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974357"><span class="hs-identifier hs-type">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-3888"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-type">Err.showPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974359"><span class="hs-identifier hs-type">logger</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Annotation linting - first run&quot;</span></span><span>
</span><span id="line-3889"></span><span>  </span><span class="hs-comment">-- If appropriate re-run it without debug annotations to make sure</span><span>
</span><span id="line-3890"></span><span>  </span><span class="hs-comment">-- that they made no difference.</span><span>
</span><span id="line-3891"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#gopt"><span class="hs-identifier hs-type">gopt</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Opt_DoAnnotationLinting"><span class="hs-identifier hs-type">Opt_DoAnnotationLinting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974357"><span class="hs-identifier hs-type">dflags</span></a></span><span>
</span><span id="line-3892"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3893"></span><span>      </span><span id="local-6989586621682974364"><span class="annot"><a href="#local-6989586621682974364"><span class="hs-identifier hs-var">nguts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682974355"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974356"><span class="hs-identifier hs-type">guts</span></a></span><span>
</span><span id="line-3894"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-type">Err.showPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974359"><span class="hs-identifier hs-type">logger</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Annotation linting - second run&quot;</span></span><span>
</span><span id="line-3895"></span><span>      </span><span id="local-6989586621682974365"><span class="annot"><a href="#local-6989586621682974365"><span class="hs-identifier hs-var">nguts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#withoutAnnots"><span class="hs-identifier hs-type">withoutAnnots</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974355"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974356"><span class="hs-identifier hs-type">guts</span></a></span><span>
</span><span id="line-3896"></span><span>      </span><span class="hs-comment">-- Finally compare the resulting bindings</span><span>
</span><span id="line-3897"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-type">Err.showPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974359"><span class="hs-identifier hs-type">logger</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Annotation linting - comparison&quot;</span></span><span>
</span><span id="line-3898"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974367"><span class="annot"><a href="#local-6989586621682974367"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreProgram -&gt; [(Var, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><a href="GHC.Core.html#flattenBinds"><span class="hs-identifier hs-var">flattenBinds</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreProgram -&gt; [(Var, CoreExpr)])
-&gt; CoreProgram -&gt; [(Var, CoreExpr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; CoreProgram
</span><a href="GHC.Unit.Module.ModGuts.html#mg_binds"><span class="hs-identifier hs-var">mg_binds</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974364"><span class="hs-identifier hs-var">nguts</span></a></span><span>
</span><span id="line-3899"></span><span>          </span><span id="local-6989586621682974369"><span class="annot"><a href="#local-6989586621682974369"><span class="hs-identifier hs-var hs-var">binds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreProgram -&gt; [(Var, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><a href="GHC.Core.html#flattenBinds"><span class="hs-identifier hs-var">flattenBinds</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreProgram -&gt; [(Var, CoreExpr)])
-&gt; CoreProgram -&gt; [(Var, CoreExpr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; CoreProgram
</span><a href="GHC.Unit.Module.ModGuts.html#mg_binds"><span class="hs-identifier hs-var">mg_binds</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974365"><span class="hs-identifier hs-var">nguts'</span></a></span><span>
</span><span id="line-3900"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682974370"><span class="annot"><a href="#local-6989586621682974370"><span class="hs-identifier hs-var">diffs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#diffBinds"><span class="hs-identifier hs-type">diffBinds</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.Env.html#mkRnEnv2"><span class="hs-identifier hs-type">mkRnEnv2</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#emptyInScopeSet"><span class="hs-identifier hs-type">emptyInScopeSet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682974367"><span class="hs-identifier hs-type">binds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974369"><span class="hs-identifier hs-type">binds'</span></a></span><span>
</span><span id="line-3901"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682974370"><span class="hs-identifier hs-type">diffs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#putMsg"><span class="hs-identifier hs-type">GHC.Core.Opt.Monad.putMsg</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span>
</span><span id="line-3902"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.Lint.html#lint_banner"><span class="hs-identifier hs-type">lint_banner</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;warning&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682974354"><span class="hs-identifier hs-type">pname</span></a></span><span>
</span><span id="line-3903"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Core changes with annotations:&quot;</span></span><span>
</span><span id="line-3904"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-type">withPprStyle</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#defaultDumpStyle"><span class="hs-identifier hs-type">defaultDumpStyle</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974370"><span class="hs-identifier hs-type">diffs</span></a></span><span>
</span><span id="line-3905"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-3906"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682974364"><span class="hs-identifier hs-type">nguts</span></a></span><span>
</span><span id="line-3907"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-3908"></span><span>      </span><span class="annot"><a href="#local-6989586621682974355"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974356"><span class="hs-identifier hs-type">guts</span></a></span><span>
</span><span id="line-3909"></span><span>
</span><span id="line-3910"></span><span class="hs-comment">-- | Run the given pass without annotations. This means that we both</span><span>
</span><span id="line-3911"></span><span class="hs-comment">-- set the debugLevel setting to 0 in the environment as well as all</span><span>
</span><span id="line-3912"></span><span class="hs-comment">-- annotations from incoming modules.</span><span>
</span><span id="line-3913"></span><span class="annot"><a href="GHC.Core.Lint.html#withoutAnnots"><span class="hs-identifier hs-type">withoutAnnots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.Monad.html#CoreM"><span class="hs-identifier hs-type">CoreM</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span>
</span><span id="line-3914"></span><span id="withoutAnnots"><span class="annot"><span class="annottext">withoutAnnots :: (ModGuts -&gt; CoreM ModGuts) -&gt; ModGuts -&gt; CoreM ModGuts
</span><a href="GHC.Core.Lint.html#withoutAnnots"><span class="hs-identifier hs-var hs-var">withoutAnnots</span></a></span></span><span> </span><span id="local-6989586621682974375"><span class="annot"><span class="annottext">ModGuts -&gt; CoreM ModGuts
</span><a href="#local-6989586621682974375"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621682974376"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974376"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-3915"></span><span>  </span><span class="hs-comment">-- Remove debug flag from environment.</span><span>
</span><span id="line-3916"></span><span>  </span><span class="hs-comment">-- TODO: supply tag here as well ?</span><span>
</span><span id="line-3917"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974377"><span class="annot"><span class="annottext">withoutFlag :: CoreM a -&gt; CoreM a
</span><a href="#local-6989586621682974377"><span class="hs-identifier hs-var hs-var hs-var">withoutFlag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; DynFlags) -&gt; CoreM a -&gt; CoreM a
forall a. (DynFlags -&gt; DynFlags) -&gt; CoreM a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#mapDynFlagsCoreM"><span class="hs-identifier hs-var">mapDynFlagsCoreM</span></a></span><span> </span><span class="annot"><span class="annottext">((DynFlags -&gt; DynFlags) -&gt; CoreM a -&gt; CoreM a)
-&gt; (DynFlags -&gt; DynFlags) -&gt; CoreM a -&gt; CoreM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682974379"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682974379"><span class="hs-identifier hs-var">dflags</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621682974379"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#debugLevel"><span class="hs-identifier hs-var">debugLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-3918"></span><span>  </span><span class="hs-comment">-- Nuke existing ticks in module.</span><span>
</span><span id="line-3919"></span><span>  </span><span class="hs-comment">-- TODO: Ticks in unfoldings. Maybe change unfolding so it removes</span><span>
</span><span id="line-3920"></span><span>  </span><span class="hs-comment">-- them in absence of debugLevel &gt; 0.</span><span>
</span><span id="line-3921"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682974381"><span class="annot"><span class="annottext">nukeTicks :: Expr b -&gt; Expr b
</span><a href="#local-6989586621682974381"><span class="hs-identifier hs-var hs-var">nukeTicks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreTickish -&gt; Bool) -&gt; Expr b -&gt; Expr b
forall b. (CoreTickish -&gt; Bool) -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.Utils.html#stripTicksE"><span class="hs-identifier hs-var">stripTicksE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (CoreTickish -&gt; Bool) -&gt; CoreTickish -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
forall (pass :: TickishPass). GenTickish pass -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishIsCode"><span class="hs-identifier hs-var">tickishIsCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3922"></span><span>      </span><span class="annot"><a href="#local-6989586621682974384"><span class="hs-identifier hs-type">nukeAnnotsBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span>
</span><span id="line-3923"></span><span>      </span><span id="local-6989586621682974384"><span class="annot"><span class="annottext">nukeAnnotsBind :: Bind Var -&gt; Bind Var
</span><a href="#local-6989586621682974384"><span class="hs-identifier hs-var hs-var">nukeAnnotsBind</span></a></span></span><span> </span><span id="local-6989586621682974386"><span class="annot"><span class="annottext">Bind Var
</span><a href="#local-6989586621682974386"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bind Var
</span><a href="#local-6989586621682974386"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3924"></span><span>        </span><span class="annot"><a href="GHC.Core.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span id="local-6989586621682974387"><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682974387"><span class="hs-identifier hs-var">bs</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)] -&gt; Bind Var
forall b. [(b, Expr b)] -&gt; Bind b
</span><a href="GHC.Core.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, CoreExpr)] -&gt; Bind Var) -&gt; [(Var, CoreExpr)] -&gt; Bind Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Var, CoreExpr) -&gt; (Var, CoreExpr))
-&gt; [(Var, CoreExpr)] -&gt; [(Var, CoreExpr)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682974388"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974388"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682974389"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974389"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974388"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b
</span><a href="#local-6989586621682974381"><span class="hs-identifier hs-var">nukeTicks</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974389"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, CoreExpr)]
</span><a href="#local-6989586621682974387"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-3925"></span><span>        </span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span id="local-6989586621682974390"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974390"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682974391"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974391"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; CoreExpr -&gt; Bind Var
forall b. b -&gt; Expr b -&gt; Bind b
</span><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621682974390"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bind Var) -&gt; CoreExpr -&gt; Bind Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b
</span><a href="#local-6989586621682974381"><span class="hs-identifier hs-var">nukeTicks</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682974391"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3926"></span><span>      </span><span id="local-6989586621682974392"><span class="annot"><span class="annottext">nukeAnnotsMod :: ModGuts -&gt; ModGuts
</span><a href="#local-6989586621682974392"><span class="hs-identifier hs-var hs-var">nukeAnnotsMod</span></a></span></span><span> </span><span id="local-6989586621682974393"><span class="annot"><span class="annottext">mg :: ModGuts
</span><a href="#local-6989586621682974393"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#ModGuts"><span class="hs-identifier hs-type">ModGuts</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">mg_binds :: ModGuts -&gt; CoreProgram
</span><a href="GHC.Unit.Module.ModGuts.html#mg_binds"><span class="hs-identifier hs-var">mg_binds</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621682974395"><span class="annot"><span class="annottext">CoreProgram
</span><a href="#local-6989586621682974395"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-3927"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974393"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">{</span><span class="annot"><a href="GHC.Unit.Module.ModGuts.html#mg_binds"><span class="hs-identifier hs-var">mg_binds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="#local-6989586621682974384"><span class="hs-identifier hs-type">nukeAnnotsBind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682974395"><span class="hs-identifier hs-type">binds</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-3928"></span><span>  </span><span class="hs-comment">-- Perform pass with all changes applied. Drop the simple count so it doesn't</span><span>
</span><span id="line-3929"></span><span>  </span><span class="hs-comment">-- effect the total also</span><span>
</span><span id="line-3930"></span><span>  </span><span class="annot"><span class="annottext">CoreM ModGuts -&gt; CoreM ModGuts
forall a. CoreM a -&gt; CoreM a
</span><a href="GHC.Core.Opt.Monad.html#dropSimplCount"><span class="hs-identifier hs-var">dropSimplCount</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreM ModGuts -&gt; CoreM ModGuts) -&gt; CoreM ModGuts -&gt; CoreM ModGuts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreM ModGuts -&gt; CoreM ModGuts
forall a. CoreM a -&gt; CoreM a
</span><a href="#local-6989586621682974377"><span class="hs-identifier hs-var">withoutFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreM ModGuts -&gt; CoreM ModGuts) -&gt; CoreM ModGuts -&gt; CoreM ModGuts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; CoreM ModGuts
</span><a href="#local-6989586621682974375"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; ModGuts
</span><a href="#local-6989586621682974392"><span class="hs-identifier hs-var">nukeAnnotsMod</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621682974376"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3931"></span></pre></body></html>