<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Parser.String.html"><span class="hs-identifier">GHC.Parser.String</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier">StringLexError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#lexString"><span class="hs-identifier">lexString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#lexMultilineString"><span class="hs-identifier">lexMultilineString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Unicode smart quote helpers</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#isDoubleSmartQuote"><span class="hs-identifier">isDoubleSmartQuote</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#isSingleSmartQuote"><span class="hs-identifier">isSingleSmartQuote</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;&gt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">chr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Foldable1.html"><span class="hs-identifier">Data.Foldable1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Foldable1</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">listToMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html"><span class="hs-identifier">GHC.Data.StringBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier">StringBuffer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html"><span class="hs-identifier">GHC.Data.StringBuffer</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">StringBuffer</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Parser.CharClass.html"><span class="hs-identifier">GHC.Parser.CharClass</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#hexDigit"><span class="hs-identifier">hexDigit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#is_decdigit"><span class="hs-identifier">is_decdigit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#is_hexdigit"><span class="hs-identifier">is_hexdigit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#is_octdigit"><span class="hs-identifier">is_octdigit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#is_space"><span class="hs-identifier">is_space</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="GHC.Parser.CharClass.html#octDecDigit"><span class="hs-identifier">octDecDigit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html"><span class="hs-identifier">GHC.Parser.Errors.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier">LexErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier">panic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">type</span><span> </span><span id="BufPos"><span class="annot"><a href="GHC.Parser.String.html#BufPos"><span class="hs-identifier hs-var">BufPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="StringLexError"><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-var">StringLexError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StringLexError"><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-var">StringLexError</span></a></span></span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#BufPos"><span class="hs-identifier hs-type">BufPos</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="GHC.Parser.String.html#lexString"><span class="hs-identifier hs-type">lexString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier hs-type">StringBuffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-type">StringLexError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="lexString"><span class="annot"><span class="annottext">lexString :: Int -&gt; StringBuffer -&gt; Either StringLexError String
</span><a href="GHC.Parser.String.html#lexString"><span class="hs-identifier hs-var hs-var">lexString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either (Char, LexErr) String)
-&gt; ([CharPos] -&gt; Either (CharPos, LexErr) [CharPos])
-&gt; Int
-&gt; StringBuffer
-&gt; Either StringLexError String
</span><a href="GHC.Parser.String.html#lexStringWith"><span class="hs-identifier hs-var">lexStringWith</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (Char, LexErr) String
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728445"><span class="hs-identifier hs-var">processChars</span></a></span><span> </span><span class="annot"><span class="annottext">[CharPos] -&gt; Either (CharPos, LexErr) [CharPos]
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728445"><span class="hs-identifier hs-var">processChars</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621682728322"><span class="annot"><a href="#local-6989586621682728445"><span class="hs-identifier hs-type">processChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728322"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728322"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682728322"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728322"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621682728445"><span class="annot"><span class="annottext">processChars :: forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728445"><span class="hs-identifier hs-var hs-var">processChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-45"></span><span>          </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="GHC.Parser.String.html#collapseGaps"><span class="hs-identifier hs-var">collapseGaps</span></a></span><span>
</span><span id="line-46"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Either (c, LexErr) [c]
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="GHC.Parser.String.html#resolveEscapes"><span class="hs-identifier hs-var">resolveEscapes</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- Lexing interface</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{-
Note [Lexing strings]
~~~~~~~~~~~~~~~~~~~~~

After verifying if a string is lexically valid with Alex, we still need to do
some post processing of the string, namely:
1. Collapse string gaps
2. Resolve escape characters

The problem: 'lexemeToString' is more performant than manually reading
characters from the StringBuffer. However, that completely erases the position
of each character, which we need in order to report the correct position for
error messages (e.g. when resolving escape characters).

So what we'll do is do two passes. The first pass is optimistic; just convert
to a plain String and process it. If this results in an error, we do a second
pass, this time where each character is annotated with its position. Now, the
error has all the information it needs.

Ideally, lexStringWith would take a single (forall c. HasChar c =&gt; ...) function,
but to help the specializer, we pass it in twice to concretize it for the two
types we actually use.
-}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">-- | See Note [Lexing strings]</span></span><span>
</span><span id="line-76"></span><span class="annot"><a href="GHC.Parser.String.html#lexStringWith"><span class="hs-identifier hs-type">lexStringWith</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.String.html#CharPos"><span class="hs-identifier hs-type">CharPos</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#CharPos"><span class="hs-identifier hs-type">CharPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.String.html#CharPos"><span class="hs-identifier hs-type">CharPos</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier hs-type">StringBuffer</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-type">StringLexError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-82"></span><span id="lexStringWith"><span class="annot"><span class="annottext">lexStringWith :: (String -&gt; Either (Char, LexErr) String)
-&gt; ([CharPos] -&gt; Either (CharPos, LexErr) [CharPos])
-&gt; Int
-&gt; StringBuffer
-&gt; Either StringLexError String
</span><a href="GHC.Parser.String.html#lexStringWith"><span class="hs-identifier hs-var hs-var">lexStringWith</span></a></span></span><span> </span><span id="local-6989586621682728453"><span class="annot"><span class="annottext">String -&gt; Either (Char, LexErr) String
</span><a href="#local-6989586621682728453"><span class="hs-identifier hs-var">processChars</span></a></span></span><span> </span><span id="local-6989586621682728454"><span class="annot"><span class="annottext">[CharPos] -&gt; Either (CharPos, LexErr) [CharPos]
</span><a href="#local-6989586621682728454"><span class="hs-identifier hs-var">processCharsPos</span></a></span></span><span> </span><span id="local-6989586621682728455"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728455"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621682728456"><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728456"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (Char, LexErr) String
</span><a href="#local-6989586621682728453"><span class="hs-identifier hs-var">processChars</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either (Char, LexErr) String)
-&gt; String -&gt; Either (Char, LexErr) String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; Int -&gt; String
</span><a href="GHC.Parser.String.html#bufferChars"><span class="hs-identifier hs-var">bufferChars</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728456"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728455"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682728458"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728458"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either StringLexError String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728458"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">(Char, LexErr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[CharPos] -&gt; Either (CharPos, LexErr) [CharPos]
</span><a href="#local-6989586621682728454"><span class="hs-identifier hs-var">processCharsPos</span></a></span><span> </span><span class="annot"><span class="annottext">([CharPos] -&gt; Either (CharPos, LexErr) [CharPos])
-&gt; [CharPos] -&gt; Either (CharPos, LexErr) [CharPos]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; Int -&gt; [CharPos]
</span><a href="GHC.Parser.String.html#bufferLocatedChars"><span class="hs-identifier hs-var">bufferLocatedChars</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728456"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728455"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">[CharPos]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either StringLexError String
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected lex error on second pass&quot;</span></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728460"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728460"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728461"><span class="annot"><span class="annottext">LexErr
</span><a href="#local-6989586621682728461"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StringLexError -&gt; Either StringLexError String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(StringLexError -&gt; Either StringLexError String)
-&gt; StringLexError -&gt; Either StringLexError String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LexErr -&gt; Int -&gt; StringLexError
</span><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-var">StringLexError</span></a></span><span> </span><span class="annot"><span class="annottext">LexErr
</span><a href="#local-6989586621682728461"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728460"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">class</span><span> </span><span id="HasChar"><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-var">HasChar</span></a></span></span><span> </span><span id="local-6989586621682728338"><span class="annot"><a href="#local-6989586621682728338"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="getChar"><span class="annot"><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-type">getChar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682728338"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-92"></span><span>  </span><span id="setChar"><span class="annot"><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-type">setChar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682728338"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682728338"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621682728467"><span class="annot"><span class="annottext">getChar :: Char -&gt; Char
</span><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-var hs-var hs-var">getChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621682728469"><span class="annot"><span class="annottext">setChar :: Char -&gt; Char -&gt; Char
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var hs-var hs-var">setChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Char
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682728318"><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682728318"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621682728473"><span class="annot"><span class="annottext">getChar :: (Char, x) -&gt; Char
</span><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-var hs-var hs-var">getChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char, x) -&gt; Char
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621682728475"><span class="annot"><span class="annottext">setChar :: Char -&gt; (Char, x) -&gt; (Char, x)
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var hs-var hs-var">setChar</span></a></span></span><span> </span><span id="local-6989586621682728476"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728476"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728477"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621682728477"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728476"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621682728477"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621682728313"><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728313"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682728313"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">pattern</span><span> </span><span id="Char"><span id="%24mChar"><span class="annot"><span class="annottext">$mChar :: forall {r} {c}. HasChar c =&gt; c -&gt; (Char -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-var hs-var">Char</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682728480"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-type">getChar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621682728480"><span class="annot"><a href="#local-6989586621682728480"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-pragma hs-type">Char</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="GHC.Parser.String.html#bufferChars"><span class="hs-identifier hs-type">bufferChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier hs-type">StringBuffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span id="bufferChars"><span class="annot"><span class="annottext">bufferChars :: StringBuffer -&gt; Int -&gt; String
</span><a href="GHC.Parser.String.html#bufferChars"><span class="hs-identifier hs-var hs-var">bufferChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; Int -&gt; String
</span><a href="GHC.Data.StringBuffer.html#lexemeToString"><span class="hs-identifier hs-var">StringBuffer.lexemeToString</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span id="CharPos"><span class="annot"><a href="GHC.Parser.String.html#CharPos"><span class="hs-identifier hs-var">CharPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#BufPos"><span class="hs-identifier hs-type">BufPos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="GHC.Parser.String.html#bufferLocatedChars"><span class="hs-identifier hs-type">bufferLocatedChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier hs-type">StringBuffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.String.html#CharPos"><span class="hs-identifier hs-type">CharPos</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span id="bufferLocatedChars"><span class="annot"><span class="annottext">bufferLocatedChars :: StringBuffer -&gt; Int -&gt; [CharPos]
</span><a href="GHC.Parser.String.html#bufferLocatedChars"><span class="hs-identifier hs-var hs-var">bufferLocatedChars</span></a></span></span><span> </span><span id="local-6989586621682728483"><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728483"><span class="hs-identifier hs-var">initialBuf</span></a></span></span><span> </span><span id="local-6989586621682728484"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728484"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; [CharPos]
</span><a href="#local-6989586621682728485"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728483"><span class="hs-identifier hs-var">initialBuf</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621682728485"><span class="annot"><span class="annottext">go :: StringBuffer -&gt; [CharPos]
</span><a href="#local-6989586621682728485"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682728486"><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728486"><span class="hs-identifier hs-var">buf</span></a></span></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; Bool
</span><a href="#local-6989586621682728487"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728486"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682728488"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728488"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728489"><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728489"><span class="hs-identifier hs-var">buf'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; (Char, StringBuffer)
</span><a href="GHC.Data.StringBuffer.html#nextChar"><span class="hs-identifier hs-var">StringBuffer.nextChar</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728486"><span class="hs-identifier hs-var">buf</span></a></span><span>
</span><span id="line-118"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728488"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; Int
</span><a href="GHC.Data.StringBuffer.html#cur"><span class="hs-identifier hs-var">StringBuffer.cur</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728486"><span class="hs-identifier hs-var">buf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CharPos -&gt; [CharPos] -&gt; [CharPos]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; [CharPos]
</span><a href="#local-6989586621682728485"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728489"><span class="hs-identifier hs-var">buf'</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621682728487"><span class="annot"><span class="annottext">atEnd :: StringBuffer -&gt; Bool
</span><a href="#local-6989586621682728487"><span class="hs-identifier hs-var hs-var">atEnd</span></a></span></span><span> </span><span id="local-6989586621682728492"><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728492"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringBuffer -&gt; StringBuffer -&gt; Int
</span><a href="GHC.Data.StringBuffer.html#byteDiff"><span class="hs-identifier hs-var">StringBuffer.byteDiff</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728483"><span class="hs-identifier hs-var">initialBuf</span></a></span><span> </span><span class="annot"><span class="annottext">StringBuffer
</span><a href="#local-6989586621682728492"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728484"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- Lexing phases</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621682728325"><span class="annot"><a href="GHC.Parser.String.html#collapseGaps"><span class="hs-identifier hs-type">collapseGaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728325"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728325"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728325"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-126"></span><span id="collapseGaps"><span class="annot"><span class="annottext">collapseGaps :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="GHC.Parser.String.html#collapseGaps"><span class="hs-identifier hs-var hs-var">collapseGaps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728497"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621682728497"><span class="annot"><span class="annottext">go :: [c] -&gt; [c]
</span><a href="#local-6989586621682728497"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621682728498"><span class="annot"><span class="annottext">c1 :: c
</span><a href="#local-6989586621682728498"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728499"><span class="annot"><span class="annottext">c2 :: c
</span><a href="#local-6989586621682728499"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728500"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728500"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728501"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728501"><span class="hs-identifier hs-var">cs</span></a></span></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_space"><span class="hs-identifier hs-var">is_space</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728500"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([c] -&gt; [c]) -&gt; [c] -&gt; [c]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728502"><span class="hs-identifier hs-var">dropGap</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728501"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728498"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728499"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728501"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span id="local-6989586621682728503"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728503"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728504"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728504"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728503"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728497"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728504"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621682728502"><span class="annot"><span class="annottext">dropGap :: [c] -&gt; [c]
</span><a href="#local-6989586621682728502"><span class="hs-identifier hs-var hs-var">dropGap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728508"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728508"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728508"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728509"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728509"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728502"><span class="hs-identifier hs-var">dropGap</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728509"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [c]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gap unexpectedly ended&quot;</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621682728510"><span class="annot"><a href="GHC.Parser.String.html#resolveEscapes"><span class="hs-identifier hs-type">resolveEscapes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728510"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728510"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682728510"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728510"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-141"></span><span id="resolveEscapes"><span class="annot"><span class="annottext">resolveEscapes :: forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="GHC.Parser.String.html#resolveEscapes"><span class="hs-identifier hs-var hs-var">resolveEscapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList c -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {a}. HasChar a =&gt; DList a -&gt; [a] -&gt; Either (a, LexErr) [a]
</span><a href="#local-6989586621682728513"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DList c
forall a. DList a
</span><a href="GHC.Parser.String.html#dlistEmpty"><span class="hs-identifier hs-var">dlistEmpty</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621682728513"><span class="annot"><span class="annottext">go :: DList a -&gt; [a] -&gt; Either (a, LexErr) [a]
</span><a href="#local-6989586621682728513"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682728523"><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621682728523"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Either (a, LexErr) [a]
forall a. a -&gt; Either (a, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Either (a, LexErr) [a]) -&gt; [a] -&gt; Either (a, LexErr) [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DList a -&gt; [a]
forall a. DList a -&gt; [a]
</span><a href="GHC.Parser.String.html#dlistToList"><span class="hs-identifier hs-var">dlistToList</span></a></span><span> </span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621682728523"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&amp;'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728525"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728525"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DList a -&gt; [a] -&gt; Either (a, LexErr) [a]
</span><a href="#local-6989586621682728513"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621682728523"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728525"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span id="local-6989586621682728526"><span class="annot"><span class="annottext">backslash :: a
</span><a href="#local-6989586621682728526"><span class="hs-identifier hs-var">backslash</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728527"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728527"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Either (a, LexErr) (Char, [a])
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) (Char, [c])
</span><a href="GHC.Parser.String.html#resolveEscapeChar"><span class="hs-identifier hs-var">resolveEscapeChar</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728527"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682728529"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728529"><span class="hs-identifier hs-var">esc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728530"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728530"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DList a -&gt; [a] -&gt; Either (a, LexErr) [a]
</span><a href="#local-6989586621682728513"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621682728523"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DList a -&gt; a -&gt; DList a
forall a. DList a -&gt; a -&gt; DList a
</span><a href="GHC.Parser.String.html#dlistSnoc"><span class="hs-operator hs-var">`dlistSnoc`</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; a -&gt; a
forall c. HasChar c =&gt; Char -&gt; c -&gt; c
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var">setChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728529"><span class="hs-identifier hs-var">esc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728526"><span class="hs-identifier hs-var">backslash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728530"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-149"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682728532"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728532"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728533"><span class="annot"><span class="annottext">LexErr
</span><a href="#local-6989586621682728533"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, LexErr) -&gt; Either (a, LexErr) [a]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728532"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LexErr
</span><a href="#local-6989586621682728533"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>      </span><span id="local-6989586621682728534"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728534"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728535"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728535"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DList a -&gt; [a] -&gt; Either (a, LexErr) [a]
</span><a href="#local-6989586621682728513"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621682728523"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DList a -&gt; a -&gt; DList a
forall a. DList a -&gt; a -&gt; DList a
</span><a href="GHC.Parser.String.html#dlistSnoc"><span class="hs-operator hs-var">`dlistSnoc`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728534"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728535"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- Escape characters</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Resolve a escape character, after having just lexed a backslash.</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Assumes escape character is valid.</span><span>
</span><span id="line-157"></span><span id="local-6989586621682728358"><span class="annot"><a href="GHC.Parser.String.html#resolveEscapeChar"><span class="hs-identifier hs-type">resolveEscapeChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728358"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728358"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682728358"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728358"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span id="resolveEscapeChar"><span class="annot"><span class="annottext">resolveEscapeChar :: forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) (Char, [c])
</span><a href="GHC.Parser.String.html#resolveEscapeChar"><span class="hs-identifier hs-var hs-var">resolveEscapeChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728577"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728577"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\a'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728577"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728578"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728578"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\b'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728578"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728579"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728579"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\f'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728579"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'n'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728580"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728580"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728580"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728581"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728581"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728581"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728582"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728582"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728582"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'v'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728583"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728583"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\v'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728583"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728584"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728584"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728584"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728585"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728585"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\&quot;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728585"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728586"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728586"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728586"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- escape codes</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728587"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728587"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [c] -&gt; Either (c, LexErr) (Char, [c])
forall {a}.
HasChar a =&gt;
(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728588"><span class="hs-identifier hs-var">parseNum</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_hexdigit"><span class="hs-identifier hs-var">is_hexdigit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Parser.CharClass.html#hexDigit"><span class="hs-identifier hs-var">hexDigit</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728587"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728589"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728589"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [c] -&gt; Either (c, LexErr) (Char, [c])
forall {a}.
HasChar a =&gt;
(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728588"><span class="hs-identifier hs-var">parseNum</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_octdigit"><span class="hs-identifier hs-var">is_octdigit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Parser.CharClass.html#octDecDigit"><span class="hs-identifier hs-var">octDecDigit</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728589"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621682728590"><span class="annot"><span class="annottext">cs :: [c]
</span><a href="#local-6989586621682728590"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728591"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728591"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_decdigit"><span class="hs-identifier hs-var">is_decdigit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728591"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [c] -&gt; Either (c, LexErr) (Char, [c])
forall {a}.
HasChar a =&gt;
(Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728588"><span class="hs-identifier hs-var">parseNum</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_decdigit"><span class="hs-identifier hs-var">is_decdigit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Parser.CharClass.html#octDecDigit"><span class="hs-identifier hs-var">octDecDigit</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728590"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-comment">-- control characters (e.g. '\^M')</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'^'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728592"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728592"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728593"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728593"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">chr</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; Int -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728592"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728593"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- long form escapes (e.g. '\NUL')</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621682728594"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728594"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682728595"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728595"><span class="hs-identifier hs-var">esc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728596"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728596"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Maybe (Char, [c])
forall c. HasChar c =&gt; [c] -&gt; Maybe (Char, [c])
</span><a href="GHC.Parser.String.html#parseLongEscape"><span class="hs-identifier hs-var">parseLongEscape</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728594"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Either (c, LexErr) (Char, [c])
forall a. a -&gt; Either (c, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728595"><span class="hs-identifier hs-var">esc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728596"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- shouldn't happen</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728598"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728598"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (c, LexErr) (Char, [c])
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either (c, LexErr) (Char, [c]))
-&gt; String -&gt; Either (c, LexErr) (Char, [c])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;found unexpected escape character: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728598"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (c, LexErr) (Char, [c])
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;escape character unexpectedly ended&quot;</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621682728588"><span class="annot"><span class="annottext">parseNum :: (Char -&gt; Bool)
-&gt; Int -&gt; (Char -&gt; Int) -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728588"><span class="hs-identifier hs-var hs-var">parseNum</span></a></span></span><span> </span><span id="local-6989586621682728611"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621682728611"><span class="hs-identifier hs-var">isDigit</span></a></span></span><span> </span><span id="local-6989586621682728612"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728612"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621682728613"><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="#local-6989586621682728613"><span class="hs-identifier hs-var">toDigit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728614"><span class="annot"><span class="annottext">go :: Int -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728614"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682728615"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-183"></span><span>            </span><span id="local-6989586621682728616"><span class="annot"><span class="annottext">ch :: a
</span><a href="#local-6989586621682728616"><span class="hs-identifier hs-var">ch</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728617"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728617"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728618"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728618"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621682728611"><span class="hs-identifier hs-var">isDigit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728617"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728619"><span class="annot"><span class="annottext">x' :: Int
</span><a href="#local-6989586621682728619"><span class="hs-identifier hs-var hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728612"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="#local-6989586621682728613"><span class="hs-identifier hs-var">toDigit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728617"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-185"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; Either (a, LexErr) () -&gt; Either (a, LexErr) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728619"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x10ffff</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either (a, LexErr) () -&gt; Either (a, LexErr) ())
-&gt; Either (a, LexErr) () -&gt; Either (a, LexErr) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, LexErr) -&gt; Either (a, LexErr) ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728616"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LexErr
</span><a href="GHC.Parser.Errors.Types.html#LexNumEscapeRange"><span class="hs-identifier hs-var">LexNumEscapeRange</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728614"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728619"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728618"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-187"></span><span>            </span><span id="local-6989586621682728624"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728624"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [a]) -&gt; Either (a, LexErr) (Char, [a])
forall a. a -&gt; Either (a, LexErr) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">chr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728615"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682728624"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; Either (a, LexErr) (Char, [a])
</span><a href="#local-6989586621682728614"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621682728363"><span class="annot"><a href="GHC.Parser.String.html#parseLongEscape"><span class="hs-identifier hs-type">parseLongEscape</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728363"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728363"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728363"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-191"></span><span id="parseLongEscape"><span class="annot"><span class="annottext">parseLongEscape :: forall c. HasChar c =&gt; [c] -&gt; Maybe (Char, [c])
</span><a href="GHC.Parser.String.html#parseLongEscape"><span class="hs-identifier hs-var hs-var">parseLongEscape</span></a></span></span><span> </span><span id="local-6989586621682728632"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728632"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Char, [c])] -&gt; Maybe (Char, [c])
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, Char) -&gt; Maybe (Char, [c]))
-&gt; [(String, Char)] -&gt; [(Char, [c])]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(String, Char) -&gt; Maybe (Char, [c])
</span><a href="#local-6989586621682728633"><span class="hs-identifier hs-var">tryParse</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, Char)]
</span><a href="#local-6989586621682728634"><span class="hs-identifier hs-var">longEscapeCodes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621682728633"><span class="annot"><span class="annottext">tryParse :: (String, Char) -&gt; Maybe (Char, [c])
</span><a href="#local-6989586621682728633"><span class="hs-identifier hs-var hs-var">tryParse</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682728635"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728635"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728636"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728636"><span class="hs-identifier hs-var">esc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [c] -&gt; ([c], [c])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728635"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728632"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682728639"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728639"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682728640"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728640"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(c -&gt; Char) -&gt; [c] -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Char
forall c. HasChar c =&gt; c -&gt; Char
</span><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-var">getChar</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728639"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728635"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Char, [c]) -&gt; Maybe (Char, [c])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728636"><span class="hs-identifier hs-var">esc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728640"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">([c], [c])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Char, [c])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621682728634"><span class="annot"><span class="annottext">longEscapeCodes :: [(String, Char)]
</span><a href="#local-6989586621682728634"><span class="hs-identifier hs-var hs-var">longEscapeCodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NUL&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\NUL'</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SOH&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SOH'</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;STX&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\STX'</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ETX&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ETX'</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EOT&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\EOT'</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ENQ&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ENQ'</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ACK&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ACK'</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BEL&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\BEL'</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BS&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\BS'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HT&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\HT'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LF&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\LF'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VT&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\VT'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FF&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\FF'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CR&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\CR'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SO&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SO'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SI&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SI'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DLE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DLE'</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DC1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DC1'</span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DC2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DC2'</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DC3&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DC3'</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DC4&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DC4'</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NAK&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\NAK'</span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SYN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SYN'</span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ETB&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ETB'</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CAN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\CAN'</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EM&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\EM'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SUB&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SUB'</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ESC&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ESC'</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FS&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\FS'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GS&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\GS'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RS&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\RS'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;US&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\US'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SP&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\SP'</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DEL&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\DEL'</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- Unicode Smart Quote detection (#21843)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="GHC.Parser.String.html#isDoubleSmartQuote"><span class="hs-identifier hs-type">isDoubleSmartQuote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-239"></span><span id="isDoubleSmartQuote"><span class="annot"><span class="annottext">isDoubleSmartQuote :: Char -&gt; Bool
</span><a href="GHC.Parser.String.html#isDoubleSmartQuote"><span class="hs-identifier hs-var hs-var">isDoubleSmartQuote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8220;'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8221;'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="GHC.Parser.String.html#isSingleSmartQuote"><span class="hs-identifier hs-type">isSingleSmartQuote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-245"></span><span id="isSingleSmartQuote"><span class="annot"><span class="annottext">isSingleSmartQuote :: Char -&gt; Bool
</span><a href="GHC.Parser.String.html#isSingleSmartQuote"><span class="hs-identifier hs-var hs-var">isSingleSmartQuote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8216;'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8217;'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Multiline strings</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | See Note [Multiline string literals]</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- Assumes string is lexically valid. Skips the steps about splitting</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- and rejoining lines, and instead manually find newline characters,</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- for performance.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="GHC.Parser.String.html#lexMultilineString"><span class="hs-identifier hs-type">lexMultilineString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.StringBuffer.html#StringBuffer"><span class="hs-identifier hs-type">StringBuffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="GHC.Parser.String.html#StringLexError"><span class="hs-identifier hs-type">StringLexError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-259"></span><span id="lexMultilineString"><span class="annot"><span class="annottext">lexMultilineString :: Int -&gt; StringBuffer -&gt; Either StringLexError String
</span><a href="GHC.Parser.String.html#lexMultilineString"><span class="hs-identifier hs-var hs-var">lexMultilineString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either (Char, LexErr) String)
-&gt; ([CharPos] -&gt; Either (CharPos, LexErr) [CharPos])
-&gt; Int
-&gt; StringBuffer
-&gt; Either StringLexError String
</span><a href="GHC.Parser.String.html#lexStringWith"><span class="hs-identifier hs-var">lexStringWith</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (Char, LexErr) String
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728641"><span class="hs-identifier hs-var">processChars</span></a></span><span> </span><span class="annot"><span class="annottext">[CharPos] -&gt; Either (CharPos, LexErr) [CharPos]
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728641"><span class="hs-identifier hs-var">processChars</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621682728642"><span class="annot"><a href="#local-6989586621682728641"><span class="hs-identifier hs-type">processChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728642"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728642"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682728642"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Errors.Types.html#LexErr"><span class="hs-identifier hs-type">LexErr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728642"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621682728641"><span class="annot"><span class="annottext">processChars :: forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="#local-6989586621682728641"><span class="hs-identifier hs-var hs-var">processChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>          </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="GHC.Parser.String.html#collapseGaps"><span class="hs-identifier hs-var">collapseGaps</span></a></span><span>             </span><span class="hs-comment">-- Step 1</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728659"><span class="hs-identifier hs-var">normalizeEOL</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728660"><span class="hs-identifier hs-var">expandLeadingTabs</span></a></span><span>        </span><span class="hs-comment">-- Step 3</span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728661"><span class="hs-identifier hs-var">rmCommonWhitespacePrefix</span></a></span><span> </span><span class="hs-comment">-- Step 4</span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728662"><span class="hs-identifier hs-var">collapseOnlyWsLines</span></a></span><span>      </span><span class="hs-comment">-- Step 5</span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728663"><span class="hs-identifier hs-var">rmFirstNewline</span></a></span><span>           </span><span class="hs-comment">-- Step 7a</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728664"><span class="hs-identifier hs-var">rmLastNewline</span></a></span><span>            </span><span class="hs-comment">-- Step 7b</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="annottext">([c] -&gt; [c])
-&gt; ([c] -&gt; Either (c, LexErr) [c]) -&gt; [c] -&gt; Either (c, LexErr) [c]
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Either (c, LexErr) [c]
forall c. HasChar c =&gt; [c] -&gt; Either (c, LexErr) [c]
</span><a href="GHC.Parser.String.html#resolveEscapes"><span class="hs-identifier hs-var">resolveEscapes</span></a></span><span>           </span><span class="hs-comment">-- Step 8</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- Normalize line endings to LF. The spec dictates that lines should be</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">-- split on newline characters and rejoined with ``\n``. But because we</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">-- aren't actually splitting/rejoining, we'll manually normalize here</span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621682728665"><span class="annot"><a href="#local-6989586621682728659"><span class="hs-identifier hs-type">normalizeEOL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728665"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728665"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728665"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621682728659"><span class="annot"><span class="annottext">normalizeEOL :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728659"><span class="hs-identifier hs-var hs-var">normalizeEOL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728673"><span class="annot"><span class="annottext">go :: [c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-278"></span><span>            </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728674"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728674"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728675"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728675"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728674"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728675"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-279"></span><span>            </span><span id="local-6989586621682728676"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728676"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728677"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728677"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; c -&gt; c
forall c. HasChar c =&gt; Char -&gt; c -&gt; c
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var">setChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728676"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728677"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-280"></span><span>            </span><span id="local-6989586621682728678"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728678"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\f'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728679"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728679"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; c -&gt; c
forall c. HasChar c =&gt; Char -&gt; c -&gt; c
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var">setChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728678"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728679"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-281"></span><span>            </span><span id="local-6989586621682728680"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728680"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728681"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728681"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728680"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728681"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728673"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-comment">-- expands all tabs, since the lexer will verify that tabs can only appear</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-comment">-- as leading indentation</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621682728682"><span class="annot"><a href="#local-6989586621682728660"><span class="hs-identifier hs-type">expandLeadingTabs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728682"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728682"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728682"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621682728660"><span class="annot"><span class="annottext">expandLeadingTabs :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728660"><span class="hs-identifier hs-var hs-var">expandLeadingTabs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728699"><span class="annot"><span class="annottext">go :: Int -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728699"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682728700"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728700"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-290"></span><span>            </span><span id="local-6989586621682728701"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728701"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728702"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728702"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728703"><span class="annot"><span class="annottext">fill :: Int
</span><a href="#local-6989586621682728703"><span class="hs-identifier hs-var hs-var">fill</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728700"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; c -&gt; [c]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728703"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; c -&gt; c
forall c. HasChar c =&gt; Char -&gt; c -&gt; c
</span><a href="GHC.Parser.String.html#setChar"><span class="hs-identifier hs-var">setChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728701"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c] -&gt; [c]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728700"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728703"><span class="hs-identifier hs-var">fill</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728702"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-293"></span><span>            </span><span id="local-6989586621682728706"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728706"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728707"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728707"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728706"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">c -&gt; Char
forall c. HasChar c =&gt; c -&gt; Char
</span><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-var">getChar</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728706"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728700"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728707"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-294"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [c] -&gt; [c]
forall {c}. HasChar c =&gt; Int -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621682728708"><span class="annot"><a href="#local-6989586621682728661"><span class="hs-identifier hs-type">rmCommonWhitespacePrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728708"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728708"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728708"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621682728661"><span class="annot"><span class="annottext">rmCommonWhitespacePrefix :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728661"><span class="hs-identifier hs-var hs-var">rmCommonWhitespacePrefix</span></a></span></span><span> </span><span id="local-6989586621682728715"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728715"><span class="hs-identifier hs-var">cs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728716"><span class="annot"><span class="annottext">commonWSPrefix :: Int
</span><a href="#local-6989586621682728716"><span class="hs-identifier hs-var hs-var">commonWSPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="GHC.Parser.String.html#getCommonWsPrefix"><span class="hs-identifier hs-var">getCommonWsPrefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(c -&gt; Char) -&gt; [c] -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Char
forall c. HasChar c =&gt; c -&gt; Char
</span><a href="GHC.Parser.String.html#getChar"><span class="hs-identifier hs-var">getChar</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728715"><span class="hs-identifier hs-var">cs0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>          </span><span id="local-6989586621682728718"><span class="annot"><span class="annottext">go :: [c] -&gt; [c]
</span><a href="#local-6989586621682728718"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-301"></span><span>            </span><span id="local-6989586621682728719"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728719"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728720"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728720"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728719"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728718"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [c] -&gt; [c]
forall {t} {c}. (Ord t, Num t, HasChar c) =&gt; t -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728721"><span class="hs-identifier hs-var">dropLine</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682728716"><span class="hs-identifier hs-var">commonWSPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728720"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>            </span><span id="local-6989586621682728722"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728722"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728723"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728723"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728722"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728718"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728723"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-comment">-- drop x characters from the string, or up to a newline, whichever</span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-comment">-- comes first</span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621682728721"><span class="annot"><span class="annottext">dropLine :: t -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728721"><span class="hs-identifier hs-var hs-var">dropLine</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682728735"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682728735"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-307"></span><span>            </span><span id="local-6989586621682728736"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728736"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682728735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728736"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621682728738"><span class="annot"><span class="annottext">cs :: [c]
</span><a href="#local-6989586621682728738"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728738"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-309"></span><span>            </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728739"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728739"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728721"><span class="hs-identifier hs-var">dropLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682728735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728739"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728718"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728715"><span class="hs-identifier hs-var">cs0</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621682728740"><span class="annot"><a href="#local-6989586621682728662"><span class="hs-identifier hs-type">collapseOnlyWsLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728740"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728740"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728740"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621682728662"><span class="annot"><span class="annottext">collapseOnlyWsLines :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728662"><span class="hs-identifier hs-var hs-var">collapseOnlyWsLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728743"><span class="annot"><span class="annottext">go :: [c] -&gt; [c]
</span><a href="#local-6989586621682728743"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-316"></span><span>            </span><span id="local-6989586621682728744"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621682728744"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728745"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728745"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682728746"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728746"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Maybe [c]
</span><a href="#local-6989586621682728747"><span class="hs-identifier hs-var">checkAllWs</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728745"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728744"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728743"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728746"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span id="local-6989586621682728748"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728748"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728749"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728749"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728748"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728743"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728749"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>          </span><span id="local-6989586621682728747"><span class="annot"><span class="annottext">checkAllWs :: [c] -&gt; Maybe [c]
</span><a href="#local-6989586621682728747"><span class="hs-identifier hs-var hs-var">checkAllWs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-comment">-- got all the way to a newline or the end of the string, return</span><span>
</span><span id="line-321"></span><span>            </span><span id="local-6989586621682728752"><span class="annot"><span class="annottext">cs :: [c]
</span><a href="#local-6989586621682728752"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Maybe [c]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728752"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-322"></span><span>            </span><span id="local-6989586621682728753"><span class="annot"><span class="annottext">cs :: [c]
</span><a href="#local-6989586621682728753"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Maybe [c]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728753"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-comment">-- found whitespace, continue</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621682728754"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728754"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728755"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728755"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_space"><span class="hs-identifier hs-var">is_space</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682728754"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; Maybe [c]
</span><a href="#local-6989586621682728747"><span class="hs-identifier hs-var">checkAllWs</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728755"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-comment">-- anything else, stop</span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [c]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-327"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728743"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621682728756"><span class="annot"><a href="#local-6989586621682728663"><span class="hs-identifier hs-type">rmFirstNewline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728756"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728756"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728756"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621682728663"><span class="annot"><span class="annottext">rmFirstNewline :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728663"><span class="hs-identifier hs-var hs-var">rmFirstNewline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728759"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728759"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728759"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-332"></span><span>      </span><span id="local-6989586621682728760"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728760"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728760"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621682728761"><span class="annot"><a href="#local-6989586621682728664"><span class="hs-identifier hs-type">rmLastNewline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#HasChar"><span class="hs-identifier hs-type">HasChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728761"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728761"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728761"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621682728664"><span class="annot"><span class="annottext">rmLastNewline :: forall c. HasChar c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621682728664"><span class="hs-identifier hs-var hs-var">rmLastNewline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682728764"><span class="annot"><span class="annottext">go :: [c] -&gt; [c]
</span><a href="#local-6989586621682728764"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.String.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>            </span><span id="local-6989586621682728765"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728765"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682728766"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728766"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682728765"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728764"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621682728766"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-340"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; [c]
</span><a href="#local-6989586621682728764"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | See step 4 in Note [Multiline string literals]</span><span>
</span><span id="line-343"></span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- Assumes tabs have already been expanded.</span><span>
</span><span id="line-345"></span><span class="annot"><a href="GHC.Parser.String.html#getCommonWsPrefix"><span class="hs-identifier hs-type">getCommonWsPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-346"></span><span id="getCommonWsPrefix"><span class="annot"><span class="annottext">getCommonWsPrefix :: String -&gt; Int
</span><a href="GHC.Parser.String.html#getCommonWsPrefix"><span class="hs-identifier hs-var hs-var">getCommonWsPrefix</span></a></span></span><span> </span><span id="local-6989586621682728767"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728767"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe (NonEmpty String)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621682728769"><span class="hs-identifier hs-var">includedLines</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NonEmpty String)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682728770"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621682728770"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty Int -&gt; Int
forall a. Ord a =&gt; NonEmpty a -&gt; a
forall (t :: * -&gt; *) a. (Foldable1 t, Ord a) =&gt; t a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.Foldable1.html#minimum"><span class="hs-identifier hs-var">Foldable1.minimum</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Int -&gt; Int) -&gt; NonEmpty Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; NonEmpty String -&gt; NonEmpty Int
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#map"><span class="hs-identifier hs-var">NonEmpty.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; (String -&gt; String) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_space"><span class="hs-identifier hs-var">is_space</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621682728770"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621682728769"><span class="annot"><span class="annottext">includedLines :: [String]
</span><a href="#local-6989586621682728769"><span class="hs-identifier hs-var hs-var">includedLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (String -&gt; Bool) -&gt; String -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="GHC.Parser.CharClass.html#is_space"><span class="hs-identifier hs-var">is_space</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ignore whitespace-only lines</span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; ([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>                      </span><span class="hs-comment">-- ignore first line in calculation</span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682728767"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">{-
Note [Multiline string literals]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Multiline string literals were added following the acceptance of the
proposal: https://github.com/ghc-proposals/ghc-proposals/pull/569

Multiline string literals are syntax sugar for normal string literals,
with an extra post processing step. This all happens in the Lexer; that
is, HsMultilineString will contain the post-processed string. This matches
the same behavior as HsString, which contains the normalized string
(see Note [Literal source text]).

The canonical steps for post processing a multiline string are:
1. Collapse string gaps
2. Split the string by newlines
3. Convert leading tabs into spaces
    * In each line, any tabs preceding non-whitespace characters are replaced with spaces up to the next tab stop
4. Remove common whitespace prefix in every line except the first (see below)
5. If a line contains only whitespace, remove all of the whitespace
6. Join the string back with `\n` delimiters
7a. If the first character of the string is a newline, remove it
7b. If the last character of the string is a newline, remove it
8. Interpret escaped characters

The common whitespace prefix can be informally defined as &quot;The longest
prefix of whitespace shared by all lines in the string, excluding the
first line and any whitespace-only lines&quot;.

It's more precisely defined with the following algorithm:

1. Take a list representing the lines in the string
2. Ignore the following elements in the list:
    * The first line (we want to ignore everything before the first newline)
    * Empty lines
    * Lines with only whitespace characters
3. Calculate the longest prefix of whitespace shared by all lines in the remaining list
-}</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- DList</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-keyword">newtype</span><span> </span><span id="DList"><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-var">DList</span></a></span></span><span> </span><span id="local-6989586621682728404"><span class="annot"><a href="#local-6989586621682728404"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DList"><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-var">DList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728404"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728404"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621682728353"><span class="annot"><a href="GHC.Parser.String.html#dlistEmpty"><span class="hs-identifier hs-type">dlistEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728353"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-401"></span><span id="dlistEmpty"><span class="annot"><span class="annottext">dlistEmpty :: forall a. DList a
</span><a href="GHC.Parser.String.html#dlistEmpty"><span class="hs-identifier hs-var hs-var">dlistEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; DList a
forall a. ([a] -&gt; [a]) -&gt; DList a
</span><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-var">DList</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621682728357"><span class="annot"><a href="GHC.Parser.String.html#dlistToList"><span class="hs-identifier hs-type">dlistToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728357"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682728357"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-404"></span><span id="dlistToList"><span class="annot"><span class="annottext">dlistToList :: forall a. DList a -&gt; [a]
</span><a href="GHC.Parser.String.html#dlistToList"><span class="hs-identifier hs-var hs-var">dlistToList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span id="local-6989586621682728780"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682728780"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682728780"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621682728359"><span class="annot"><a href="GHC.Parser.String.html#dlistSnoc"><span class="hs-identifier hs-type">dlistSnoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728359"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682728359"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728359"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-407"></span><span id="dlistSnoc"><span class="annot"><span class="annottext">dlistSnoc :: forall a. DList a -&gt; a -&gt; DList a
</span><a href="GHC.Parser.String.html#dlistSnoc"><span class="hs-identifier hs-var hs-var">dlistSnoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span id="local-6989586621682728781"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682728781"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682728782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728782"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; DList a
forall a. ([a] -&gt; [a]) -&gt; DList a
</span><a href="GHC.Parser.String.html#DList"><span class="hs-identifier hs-var">DList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621682728781"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682728782"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span></pre></body></html>