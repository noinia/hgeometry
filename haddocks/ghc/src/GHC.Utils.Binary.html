<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -O2 -funbox-strict-fields #-}</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- We always optimise this, otherwise performance of a non-optimised</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- compiler is severely affected</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- (c) The University of Glasgow 2002-2006</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Binary I/O library, with special tweaks for GHC</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Based on the nhc98 Binary library, which is copyright</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- (c) Malcolm Wallace and Colin Runciman, University of York, 1998.</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Under the terms of the license for that software, we must tell you</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- where you can obtain the original version of the Binary library, namely</span><span>
</span><span id="line-19"></span><span class="hs-comment">--     http://www.cs.york.ac.uk/fp/nhc98/</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html"><span class="hs-identifier">GHC.Utils.Binary</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-comment">{-type-}</span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier">Bin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier">RelBin</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getRelBin"><span class="hs-identifier">getRelBin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-comment">{-class-}</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier">Binary</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-comment">{-type-}</span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier">ReadBinHandle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier">WriteBinHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier">SymbolTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier">Dictionary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier">BinData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier">dataHandle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier">handleData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#unsafeUnpackBinBuffer"><span class="hs-identifier">unsafeUnpackBinBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier">openBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span class="hs-comment">--   closeBin,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinWriter"><span class="hs-identifier">seekBinWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier">seekBinReader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReaderRel"><span class="hs-identifier">seekBinReaderRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier">tellBinReader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier">tellBinWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier">castBin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier">withBinBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#freezeWriteHandle"><span class="hs-identifier">freezeWriteHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#shrinkBinBuffer"><span class="hs-identifier">shrinkBinBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#thawReadHandle"><span class="hs-identifier">thawReadHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#foldGet"><span class="hs-identifier">foldGet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#foldGet%27"><span class="hs-identifier">foldGet'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier">writeBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier">readBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMemN"><span class="hs-identifier">readBinMemN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier">putAt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier">getAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putAtRel"><span class="hs-identifier">putAtRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardPut"><span class="hs-identifier">forwardPut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardPut_"><span class="hs-identifier">forwardPut_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardGet"><span class="hs-identifier">forwardGet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardPutRel"><span class="hs-identifier">forwardPutRel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardPutRel_"><span class="hs-identifier">forwardPutRel_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#forwardGetRel"><span class="hs-identifier">forwardGetRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>   </span><span class="annot"><span class="hs-comment">-- * For writing instances</span></span><span>
</span><span id="line-56"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier">putByte</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier">getByte</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putByteString"><span class="hs-identifier">putByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getByteString"><span class="hs-identifier">getByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Variable length encodings</span></span><span>
</span><span id="line-62"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier">putULEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier">getULEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier">putSLEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier">getSLEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Fixed length encoding</span></span><span>
</span><span id="line-68"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier">FixedLengthEncoding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Lazy Binary I/O</span></span><span>
</span><span id="line-71"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier">lazyGet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier">lazyPut</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet%27"><span class="hs-identifier">lazyGet'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut%27"><span class="hs-identifier">lazyPut'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyGetMaybe"><span class="hs-identifier">lazyGetMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyPutMaybe"><span class="hs-identifier">lazyPutMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>   </span><span class="annot"><span class="hs-comment">-- * User data</span></span><span>
</span><span id="line-79"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier">ReaderUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getReaderUserData"><span class="hs-identifier">getReaderUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#setReaderUserData"><span class="hs-identifier">setReaderUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier">noReaderUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier">WriterUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getWriterUserData"><span class="hs-identifier">getWriterUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#setWriterUserData"><span class="hs-identifier">setWriterUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier">noWriterUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#mkWriterUserData"><span class="hs-identifier">mkWriterUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#mkReaderUserData"><span class="hs-identifier">mkReaderUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier">newReadState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier">newWriteState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#addReaderToUserData"><span class="hs-identifier">addReaderToUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#addWriterToUserData"><span class="hs-identifier">addWriterToUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#findUserDataReader"><span class="hs-identifier">findUserDataReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#findUserDataWriter"><span class="hs-identifier">findUserDataWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Binary Readers &amp; Writers</span></span><span>
</span><span id="line-86"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier">BinaryReader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier">BinaryWriter</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier">mkWriter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier">mkReader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier">SomeBinaryReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier">SomeBinaryWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier">mkSomeBinaryReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier">mkSomeBinaryWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Tables</span></span><span>
</span><span id="line-91"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderTable"><span class="hs-identifier">ReaderTable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterTable"><span class="hs-identifier">WriterTable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>   </span><span class="annot"><span class="hs-comment">-- * String table (&quot;dictionary&quot;)</span></span><span>
</span><span id="line-94"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#initFastStringReaderTable"><span class="hs-identifier">initFastStringReaderTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#initFastStringWriterTable"><span class="hs-identifier">initFastStringWriterTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier">putDictionary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier">getDictionary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier">putFS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier">FSTable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getDictFastString"><span class="hs-identifier">getDictFastString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putDictFastString"><span class="hs-identifier">putDictFastString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Generic deduplication table</span></span><span>
</span><span id="line-98"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier">GenericSymbolTable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#initGenericSymbolTable"><span class="hs-identifier">initGenericSymbolTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getGenericSymtab"><span class="hs-identifier">getGenericSymtab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymTab"><span class="hs-identifier">putGenericSymTab</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getGenericSymbolTable"><span class="hs-identifier">getGenericSymbolTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymbolTable"><span class="hs-identifier">putGenericSymbolTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Newtype wrappers</span></span><span>
</span><span id="line-103"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier">BinSpan</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier">BinSrcSpan</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier">BinLocated</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Newtypes for types that have canonically more than one valid encoding</span></span><span>
</span><span id="line-105"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier">BindingName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#simpleBindingNameWriter"><span class="hs-identifier">simpleBindingNameWriter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#simpleBindingNameReader"><span class="hs-identifier">simpleBindingNameReader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier">FullBinData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#freezeBinHandle"><span class="hs-identifier">freezeBinHandle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#thawBinHandle"><span class="hs-identifier">thawBinHandle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putFullBinData"><span class="hs-identifier">putFullBinData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier">BinArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html"><span class="hs-identifier">Language.Haskell.Syntax.Module.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier">ModuleName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html"><span class="hs-identifier">GHC.Data.TrieMap</span></a></span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html"><span class="hs-identifier">GHC.Data.FastMutInt</span></a></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Fingerprint.html"><span class="hs-identifier">GHC.Utils.Fingerprint</span></a></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Data.Strict.html"><span class="hs-identifier">GHC.Data.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPointHood"><span class="hs-identifier">JoinPointHood</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;$!&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.html"><span class="hs-identifier">Foreign</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setBit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearBit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftR</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.html"><span class="hs-identifier">Data.Array</span></a></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.IO.html"><span class="hs-identifier">Data.Array.IO</span></a></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Unsafe.html"><span class="hs-identifier">Data.Array.Unsafe</span></a></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#copy"><span class="hs-identifier">copy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Coerce.html"><span class="hs-identifier">Data.Coerce</span></a></span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Unsafe.html"><span class="hs-identifier">Data.ByteString.Unsafe</span></a></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.IORef.html"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">chr</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Proxy.html"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.html"><span class="hs-identifier">Data.Time</span></a></span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unfoldr</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unsafeInterleaveIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.Error.html"><span class="hs-identifier">System.IO.Error</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">mkIOError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">eofErrorType</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Type.Reflection.html"><span class="hs-identifier">Type.Reflection</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SomeTypeRep</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Type.Reflection.html"><span class="hs-identifier">Type.Reflection</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Refl</span></span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Real.html"><span class="hs-identifier">GHC.Real</span></a></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Ratio</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier">IntMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.html"><span class="hs-identifier">Data.IntMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-cpp">
#if MIN_VERSION_base(4,15,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ForeignPtr.html"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unsafeWithForeignPtr</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Unsafe.Coerce.html"><span class="hs-identifier">Unsafe.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">type</span><span> </span><span id="BinArray"><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-var">BinArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-cpp">

#if !MIN_VERSION_base(4,15,0)
</span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ForeignPtr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-167"></span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">withForeignPtr</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-170"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- BinData</span><span>
</span><span id="line-172"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">data</span><span> </span><span id="BinData"><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinData"><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621682484883"><span class="annot"><span class="annottext">rnf :: BinData -&gt; ()
</span><a href="#local-6989586621682484883"><span class="hs-identifier hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621682484885"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484885"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#rnf"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484885"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484888"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621682484895"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; BinData -&gt; IO ()
</span><a href="#local-6989586621682484895"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682484897"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682484897"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621682484898"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484898"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621682484899"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484899"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682484897"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484898"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682484897"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484898"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682484901"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484901"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">BinArray -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484899"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682484902"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484902"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484901"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484902"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484898"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621682484909"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO BinData
</span><a href="#local-6989586621682484909"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682484911"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682484911"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621682484912"><span class="annot"><a href="#local-6989586621682484912"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682484911"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621682484913"><span class="annot"><a href="#local-6989586621682484913"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mallocForeignPtrBytes</span></span><span> </span><span class="annot"><a href="#local-6989586621682484912"><span class="hs-identifier hs-type">sz</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-type">getPrim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484911"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484912"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682484916"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484916"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">BinArray -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484913"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682484917"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484917"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484917"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682484916"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484912"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484912"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484913"><span class="hs-identifier hs-type">dat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier hs-type">dataHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-195"></span><span id="dataHandle"><span class="annot"><span class="annottext">dataHandle :: BinData -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier hs-var hs-var">dataHandle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621682484918"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484918"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621682484919"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484919"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621682484920"><span class="annot"><a href="#local-6989586621682484920"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-type">noReaderUserData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484920"><span class="hs-identifier hs-type">ixr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484918"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484919"><span class="hs-identifier hs-type">bin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier hs-type">handleData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span>
</span><span id="line-200"></span><span id="handleData"><span class="annot"><span class="annottext">handleData :: WriteBinHandle -&gt; IO BinData
</span><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier hs-var hs-var">handleData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484924"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682484924"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484925"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682484925"><span class="hs-identifier hs-var">binr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BinArray -&gt; BinData
</span><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BinArray -&gt; BinData) -&gt; IO Int -&gt; IO (BinArray -&gt; BinData)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682484924"><span class="hs-identifier hs-var">ixr</span></a></span><span> </span><span class="annot"><span class="annottext">IO (BinArray -&gt; BinData) -&gt; IO BinArray -&gt; IO BinData
forall a b. IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray -&gt; IO BinArray
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682484925"><span class="hs-identifier hs-var">binr</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- FullBinData</span><span>
</span><span id="line-204"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | 'FullBinData' stores a slice to a 'BinArray'.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- It requires less memory than 'ReadBinHandle', and can be constructed from</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- a 'ReadBinHandle' via 'freezeBinHandle' and turned back into a</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- 'ReadBinHandle' using 'thawBinHandle'.</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- Additionally, the byte array slice can be put into a 'WriteBinHandle' without extra</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- conversions via 'putFullBinData'.</span><span>
</span><span id="line-213"></span><span class="hs-keyword">data</span><span> </span><span id="FullBinData"><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-var">FullBinData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FullBinData"><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-var">FullBinData</span></a></span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fbd_readerUserData"><span class="annot"><span class="annottext">FullBinData -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#fbd_readerUserData"><span class="hs-identifier hs-var hs-var">fbd_readerUserData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ 'ReaderUserData' that can be used to resume reading.</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fbd_off_s"><span class="annot"><span class="annottext">FullBinData -&gt; Int
</span><a href="GHC.Utils.Binary.html#fbd_off_s"><span class="hs-identifier hs-var hs-var">fbd_off_s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ start offset</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fbd_off_e"><span class="annot"><span class="annottext">FullBinData -&gt; Int
</span><a href="GHC.Utils.Binary.html#fbd_off_e"><span class="hs-identifier hs-var hs-var">fbd_off_e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ end offset</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fbd_size"><span class="annot"><span class="annottext">FullBinData -&gt; Int
</span><a href="GHC.Utils.Binary.html#fbd_size"><span class="hs-identifier hs-var hs-var">fbd_size</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ total buffer size</span></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fbd_buffer"><span class="annot"><span class="annottext">FullBinData -&gt; BinArray
</span><a href="GHC.Utils.Binary.html#fbd_buffer"><span class="hs-identifier hs-var hs-var">fbd_buffer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Equality and Ord assume that two distinct buffers are different, even if they compare the same things.</span><span>
</span><span id="line-226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484938"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484947"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484947"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682484948"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484948"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682484949"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484949"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682484950"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484950"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682484951"><span class="annot"><span class="annottext">== :: FullBinData -&gt; FullBinData -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484952"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484952"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621682484953"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484953"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621682484954"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484954"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621682484955"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484955"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484947"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484952"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484948"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484953"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484949"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484954"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484950"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray -&gt; BinArray -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484955"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484961"><span id="local-6989586621682484965"><span id="local-6989586621682484968"><span id="local-6989586621682484971"><span id="local-6989586621682484974"><span id="local-6989586621682484977"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621682484989"><span class="annot"><span class="annottext">compare :: FullBinData -&gt; FullBinData -&gt; Ordering
</span><a href="#local-6989586621682484989"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484991"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484991"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621682484992"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484992"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621682484993"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484993"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621682484994"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484994"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682484995"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484995"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621682484996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484996"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621682484997"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484997"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621682484998"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484998"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484991"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484995"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484992"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484996"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484993"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682484997"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">BinArray -&gt; BinArray -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484994"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682484998"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><span class="hs-comment">-- | Write the 'FullBinData' slice into the 'WriteBinHandle'.</span></span><span>
</span><span id="line-234"></span><span class="annot"><a href="GHC.Utils.Binary.html#putFullBinData"><span class="hs-identifier hs-type">putFullBinData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="putFullBinData"><span class="annot"><span class="annottext">putFullBinData :: WriteBinHandle -&gt; FullBinData -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putFullBinData"><span class="hs-identifier hs-var hs-var">putFullBinData</span></a></span></span><span> </span><span id="local-6989586621682484999"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682484999"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485000"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485000"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621682485001"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485001"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span id="local-6989586621682485002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485002"><span class="hs-identifier hs-var">_sz</span></a></span></span><span> </span><span id="local-6989586621682485003"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485003"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682485004"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621682485004"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485001"><span class="hs-identifier hs-var">o2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485000"><span class="hs-identifier hs-var">o1</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682484999"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485004"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485005"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485005"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">BinArray -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485003"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray -&gt; Int -&gt; BinArray
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485000"><span class="hs-identifier hs-var">o1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485007"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485007"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485005"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485007"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485004"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Freeze a 'ReadBinHandle' and a start index into a 'FullBinData'.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- 'FullBinData' stores a slice starting from the 'Bin a' location to the current</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- offset of the 'ReadBinHandle'.</span><span>
</span><span id="line-245"></span><span id="local-6989586621682483826"><span class="annot"><a href="GHC.Utils.Binary.html#freezeBinHandle"><span class="hs-identifier hs-type">freezeBinHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span></span><span>
</span><span id="line-246"></span><span id="freezeBinHandle"><span class="annot"><span class="annottext">freezeBinHandle :: forall {k} (a :: k). ReadBinHandle -&gt; Bin a -&gt; IO FullBinData
</span><a href="GHC.Utils.Binary.html#freezeBinHandle"><span class="hs-identifier hs-var hs-var">freezeBinHandle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span id="local-6989586621682485010"><span class="annot"><span class="annottext">ReaderUserData
</span><a href="#local-6989586621682485010"><span class="hs-identifier hs-var">user_data</span></a></span></span><span> </span><span id="local-6989586621682485011"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485011"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span id="local-6989586621682485012"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485012"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621682485013"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485013"><span class="hs-identifier hs-var">binr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span id="local-6989586621682485015"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485015"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621682485016"><span class="annot"><a href="#local-6989586621682485016"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485011"><span class="hs-identifier hs-var">ixr</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485010"><span class="hs-identifier hs-type">user_data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485015"><span class="hs-identifier hs-type">start</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485016"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485012"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485013"><span class="hs-identifier hs-type">binr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Turn the 'FullBinData' into a 'ReadBinHandle', setting the 'ReadBinHandle'</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- offset to the start of the 'FullBinData' and restore the 'ReaderUserData' that was</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- obtained from 'freezeBinHandle'.</span><span>
</span><span id="line-253"></span><span class="annot"><a href="GHC.Utils.Binary.html#thawBinHandle"><span class="hs-identifier hs-type">thawBinHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-254"></span><span id="thawBinHandle"><span class="annot"><span class="annottext">thawBinHandle :: FullBinData -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#thawBinHandle"><span class="hs-identifier hs-var hs-var">thawBinHandle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FullBinData"><span class="hs-identifier hs-type">FullBinData</span></a></span><span> </span><span id="local-6989586621682485017"><span class="annot"><span class="annottext">ReaderUserData
</span><a href="#local-6989586621682485017"><span class="hs-identifier hs-var">user_data</span></a></span></span><span> </span><span id="local-6989586621682485018"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485018"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621682485019"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485019"><span class="hs-identifier hs-var">_end</span></a></span></span><span> </span><span id="local-6989586621682485020"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485020"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621682485021"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485021"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621682485022"><span class="annot"><a href="#local-6989586621682485022"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485018"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485017"><span class="hs-identifier hs-type">user_data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485022"><span class="hs-identifier hs-type">ixr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485020"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485021"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- BinHandle</span><span>
</span><span id="line-260"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | A write-only handle that can be used to serialise binary data into a buffer.</span><span>
</span><span id="line-263"></span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- The buffer is an unboxed binary array.</span><span>
</span><span id="line-265"></span><span class="hs-keyword">data</span><span> </span><span id="WriteBinHandle"><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-var">WriteBinHandle</span></a></span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="WriteBinMem"><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-var">WriteBinMem</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-267"></span><span>     </span><span id="wbm_userData"><span class="annot"><span class="annottext">WriteBinHandle -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var hs-var">wbm_userData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>     </span><span class="hs-comment">-- ^ User data for writing binary outputs.</span><span>
</span><span id="line-269"></span><span>     </span><span class="hs-comment">-- Allows users to overwrite certain 'Binary' instances.</span><span>
</span><span id="line-270"></span><span>     </span><span class="hs-comment">-- This is helpful when a non-canonical 'Binary' instance is required,</span><span>
</span><span id="line-271"></span><span>     </span><span class="hs-comment">-- such as in the case of 'Name'.</span><span>
</span><span id="line-272"></span><span>     </span><span id="wbm_off_r"><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#wbm_off_r"><span class="hs-identifier hs-var hs-var">wbm_off_r</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ the current offset</span></span><span>
</span><span id="line-273"></span><span>     </span><span id="wbm_sz_r"><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#wbm_sz_r"><span class="hs-identifier hs-var hs-var">wbm_sz_r</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="hs-comment">-- ^ size of the array (cached)</span></span><span>
</span><span id="line-274"></span><span>     </span><span id="wbm_arr_r"><span class="annot"><span class="annottext">WriteBinHandle -&gt; IORef BinArray
</span><a href="GHC.Utils.Binary.html#wbm_arr_r"><span class="hs-identifier hs-var hs-var">wbm_arr_r</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ the array (bounds: (0,size-1))</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | A read-only handle that can be used to deserialise binary data from a buffer.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- The buffer is an unboxed binary array.</span><span>
</span><span id="line-280"></span><span class="hs-keyword">data</span><span> </span><span id="ReadBinHandle"><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-var">ReadBinHandle</span></a></span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ReadBinMem"><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-var">ReadBinMem</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-282"></span><span>     </span><span id="rbm_userData"><span class="annot"><span class="annottext">ReadBinHandle -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var hs-var">rbm_userData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>     </span><span class="hs-comment">-- ^ User data for reading binary inputs.</span><span>
</span><span id="line-284"></span><span>     </span><span class="hs-comment">-- Allows users to overwrite certain 'Binary' instances.</span><span>
</span><span id="line-285"></span><span>     </span><span class="hs-comment">-- This is helpful when a non-canonical 'Binary' instance is required,</span><span>
</span><span id="line-286"></span><span>     </span><span class="hs-comment">-- such as in the case of 'Name'.</span><span>
</span><span id="line-287"></span><span>     </span><span id="rbm_off_r"><span class="annot"><span class="annottext">ReadBinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#rbm_off_r"><span class="hs-identifier hs-var hs-var">rbm_off_r</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ the current offset</span></span><span>
</span><span id="line-288"></span><span>     </span><span id="rbm_sz_r"><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int
</span><a href="GHC.Utils.Binary.html#rbm_sz_r"><span class="hs-identifier hs-var hs-var">rbm_sz_r</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="hs-comment">-- ^ size of the array (cached)</span></span><span>
</span><span id="line-289"></span><span>     </span><span id="rbm_arr_r"><span class="annot"><span class="annottext">ReadBinHandle -&gt; BinArray
</span><a href="GHC.Utils.Binary.html#rbm_arr_r"><span class="hs-identifier hs-var hs-var">rbm_arr_r</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ the array (bounds: (0,size-1))</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="GHC.Utils.Binary.html#getReaderUserData"><span class="hs-identifier hs-type">getReaderUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-293"></span><span id="getReaderUserData"><span class="annot"><span class="annottext">getReaderUserData :: ReadBinHandle -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#getReaderUserData"><span class="hs-identifier hs-var hs-var">getReaderUserData</span></a></span></span><span> </span><span id="local-6989586621682485031"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485031"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485031"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWriterUserData"><span class="hs-identifier hs-type">getWriterUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span>
</span><span id="line-296"></span><span id="getWriterUserData"><span class="annot"><span class="annottext">getWriterUserData :: WriteBinHandle -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#getWriterUserData"><span class="hs-identifier hs-var hs-var">getWriterUserData</span></a></span></span><span> </span><span id="local-6989586621682485032"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485032"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485032"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><a href="GHC.Utils.Binary.html#setWriterUserData"><span class="hs-identifier hs-type">setWriterUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span>
</span><span id="line-299"></span><span id="setWriterUserData"><span class="annot"><span class="annottext">setWriterUserData :: WriteBinHandle -&gt; WriterUserData -&gt; WriteBinHandle
</span><a href="GHC.Utils.Binary.html#setWriterUserData"><span class="hs-identifier hs-var hs-var">setWriterUserData</span></a></span></span><span> </span><span id="local-6989586621682485033"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485033"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485034"><span class="annot"><span class="annottext">WriterUserData
</span><a href="#local-6989586621682485034"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485033"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485034"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="GHC.Utils.Binary.html#setReaderUserData"><span class="hs-identifier hs-type">setReaderUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-302"></span><span id="setReaderUserData"><span class="annot"><span class="annottext">setReaderUserData :: ReadBinHandle -&gt; ReaderUserData -&gt; ReadBinHandle
</span><a href="GHC.Utils.Binary.html#setReaderUserData"><span class="hs-identifier hs-var hs-var">setReaderUserData</span></a></span></span><span> </span><span id="local-6989586621682485035"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485035"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485036"><span class="annot"><span class="annottext">ReaderUserData
</span><a href="#local-6989586621682485036"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485035"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485036"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Add 'SomeBinaryReader' as a known binary decoder.</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- If a 'BinaryReader' for the associated type already exists in 'ReaderUserData',</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- it is overwritten.</span><span>
</span><span id="line-307"></span><span class="annot"><a href="GHC.Utils.Binary.html#addReaderToUserData"><span class="hs-identifier hs-type">addReaderToUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682483830"><span class="annot"><a href="#local-6989586621682483830"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682483830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-308"></span><span id="addReaderToUserData"><span class="annot"><span class="annottext">addReaderToUserData :: forall a.
Typeable a =&gt;
BinaryReader a -&gt; ReadBinHandle -&gt; ReadBinHandle
</span><a href="GHC.Utils.Binary.html#addReaderToUserData"><span class="hs-identifier hs-var hs-var">addReaderToUserData</span></a></span></span><span> </span><span id="local-6989586621682485042"><span class="annot"><span class="annottext">BinaryReader a
</span><a href="#local-6989586621682485042"><span class="hs-identifier hs-var">reader</span></a></span></span><span> </span><span id="local-6989586621682485043"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485043"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485043"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485043"><span class="hs-identifier hs-type">bh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var">ud_reader_data</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-312"></span><span>            </span><span id="local-6989586621682485045"><span class="annot"><a href="#local-6989586621682485045"><span class="hs-identifier hs-var hs-var">typRep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; TypeRep a
forall {k} (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">Refl.typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682483830"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-313"></span><span>          </span><span class="hs-keyword">in</span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#insert"><span class="hs-identifier hs-type">Map.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeTypeRep</span></span><span> </span><span class="annot"><a href="#local-6989586621682485045"><span class="hs-identifier hs-type">typRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485045"><span class="hs-identifier hs-type">typRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485042"><span class="hs-identifier hs-type">reader</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var">ud_reader_data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485043"><span class="hs-identifier hs-type">bh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Add 'SomeBinaryWriter' as a known binary encoder.</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- If a 'BinaryWriter' for the associated type already exists in 'WriterUserData',</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- it is overwritten.</span><span>
</span><span id="line-321"></span><span class="annot"><a href="GHC.Utils.Binary.html#addWriterToUserData"><span class="hs-identifier hs-type">addWriterToUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682483841"><span class="annot"><a href="#local-6989586621682483841"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682483841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span>
</span><span id="line-322"></span><span id="addWriterToUserData"><span class="annot"><span class="annottext">addWriterToUserData :: forall a.
Typeable a =&gt;
BinaryWriter a -&gt; WriteBinHandle -&gt; WriteBinHandle
</span><a href="GHC.Utils.Binary.html#addWriterToUserData"><span class="hs-identifier hs-var hs-var">addWriterToUserData</span></a></span></span><span> </span><span id="local-6989586621682485054"><span class="annot"><span class="annottext">BinaryWriter a
</span><a href="#local-6989586621682485054"><span class="hs-identifier hs-var">writer</span></a></span></span><span> </span><span id="local-6989586621682485055"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485055"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485055"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485055"><span class="hs-identifier hs-type">bh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var">ud_writer_data</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-326"></span><span>            </span><span id="local-6989586621682485057"><span class="annot"><a href="#local-6989586621682485057"><span class="hs-identifier hs-var hs-var">typRep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; TypeRep a
forall {k} (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">Refl.typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682483841"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-327"></span><span>          </span><span class="hs-keyword">in</span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#insert"><span class="hs-identifier hs-type">Map.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeTypeRep</span></span><span> </span><span class="annot"><a href="#local-6989586621682485057"><span class="hs-identifier hs-type">typRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485057"><span class="hs-identifier hs-type">typRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485054"><span class="hs-identifier hs-type">writer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var">ud_writer_data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485055"><span class="hs-identifier hs-type">bh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- | Get access to the underlying buffer.</span></span><span>
</span><span id="line-333"></span><span id="local-6989586621682483846"><span class="annot"><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier hs-type">withBinBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483846"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483846"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-334"></span><span id="withBinBuffer"><span class="annot"><span class="annottext">withBinBuffer :: forall a. WriteBinHandle -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier hs-var hs-var">withBinBuffer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485060"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485060"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485061"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682485061"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682485062"><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621682485062"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621682485063"><span class="annot"><a href="#local-6989586621682485063"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485060"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621682485064"><span class="annot"><a href="#local-6989586621682485064"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485061"><span class="hs-identifier hs-type">arr_r</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><a href="#local-6989586621682485062"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier hs-type">BS.fromForeignPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485064"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621682485063"><span class="hs-identifier hs-type">ix</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="GHC.Utils.Binary.html#unsafeUnpackBinBuffer"><span class="hs-identifier hs-type">unsafeUnpackBinBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-340"></span><span id="unsafeUnpackBinBuffer"><span class="annot"><span class="annottext">unsafeUnpackBinBuffer :: ByteString -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#unsafeUnpackBinBuffer"><span class="hs-identifier hs-var hs-var">unsafeUnpackBinBuffer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS.BS</span></a></span><span> </span><span id="local-6989586621682485067"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485067"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621682485068"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485068"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621682485069"><span class="annot"><a href="#local-6989586621682485069"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-type">noReaderUserData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485069"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485068"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485067"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- Bin</span><span>
</span><span id="line-346"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-keyword">newtype</span><span> </span><span id="Bin"><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span></span><span> </span><span id="local-6989586621682483916"><span class="annot"><a href="#local-6989586621682483916"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinPtr"><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682485071"><span id="local-6989586621682485075"><span class="annot"><span class="annottext">Bin a -&gt; Bin a -&gt; Bool
(Bin a -&gt; Bin a -&gt; Bool) -&gt; (Bin a -&gt; Bin a -&gt; Bool) -&gt; Eq (Bin a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
$c== :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
== :: Bin a -&gt; Bin a -&gt; Bool
$c/= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
/= :: Bin a -&gt; Bin a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485083"><span id="local-6989586621682485087"><span id="local-6989586621682485091"><span id="local-6989586621682485095"><span id="local-6989586621682485099"><span id="local-6989586621682485103"><span id="local-6989586621682485107"><span class="annot"><span class="annottext">Eq (Bin a)
Eq (Bin a) =&gt;
(Bin a -&gt; Bin a -&gt; Ordering)
-&gt; (Bin a -&gt; Bin a -&gt; Bool)
-&gt; (Bin a -&gt; Bin a -&gt; Bool)
-&gt; (Bin a -&gt; Bin a -&gt; Bool)
-&gt; (Bin a -&gt; Bin a -&gt; Bool)
-&gt; (Bin a -&gt; Bin a -&gt; Bin a)
-&gt; (Bin a -&gt; Bin a -&gt; Bin a)
-&gt; Ord (Bin a)
Bin a -&gt; Bin a -&gt; Bool
Bin a -&gt; Bin a -&gt; Ordering
Bin a -&gt; Bin a -&gt; Bin a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (a :: k). Eq (Bin a)
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
forall k (a :: k). Bin a -&gt; Bin a -&gt; Ordering
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
$ccompare :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Ordering
compare :: Bin a -&gt; Bin a -&gt; Ordering
$c&lt; :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&lt; :: Bin a -&gt; Bin a -&gt; Bool
$c&lt;= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&lt;= :: Bin a -&gt; Bin a -&gt; Bool
$c&gt; :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&gt; :: Bin a -&gt; Bin a -&gt; Bool
$c&gt;= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&gt;= :: Bin a -&gt; Bin a -&gt; Bool
$cmax :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
max :: Bin a -&gt; Bin a -&gt; Bin a
$cmin :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
min :: Bin a -&gt; Bin a -&gt; Bin a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485117"><span id="local-6989586621682485121"><span id="local-6989586621682485125"><span class="annot"><span class="annottext">Int -&gt; Bin a -&gt; ShowS
[Bin a] -&gt; ShowS
Bin a -&gt; String
(Int -&gt; Bin a -&gt; ShowS)
-&gt; (Bin a -&gt; String) -&gt; ([Bin a] -&gt; ShowS) -&gt; Show (Bin a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (a :: k). Int -&gt; Bin a -&gt; ShowS
forall k (a :: k). [Bin a] -&gt; ShowS
forall k (a :: k). Bin a -&gt; String
$cshowsPrec :: forall k (a :: k). Int -&gt; Bin a -&gt; ShowS
showsPrec :: Int -&gt; Bin a -&gt; ShowS
$cshow :: forall k (a :: k). Bin a -&gt; String
show :: Bin a -&gt; String
$cshowList :: forall k (a :: k). [Bin a] -&gt; ShowS
showList :: [Bin a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485130"><span id="local-6989586621682485135"><span class="annot"><span class="annottext">Bin a
Bin a -&gt; Bin a -&gt; Bounded (Bin a)
forall a. a -&gt; a -&gt; Bounded a
forall k (a :: k). Bin a
$cminBound :: forall k (a :: k). Bin a
minBound :: Bin a
$cmaxBound :: forall k (a :: k). Bin a
maxBound :: Bin a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Like a 'Bin' but is used to store relative offset pointers.</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- Relative offset pointers store a relative location, but also contain an</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- anchor that allow to obtain the absolute offset.</span><span>
</span><span id="line-354"></span><span class="hs-keyword">data</span><span> </span><span id="RelBin"><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-var">RelBin</span></a></span></span><span> </span><span id="local-6989586621682483868"><span class="annot"><a href="#local-6989586621682483868"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RelBin"><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-var">RelBin</span></a></span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="relBin_anchor"><span class="annot"><span class="annottext">forall {k} (a :: k). RelBin a -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#relBin_anchor"><span class="hs-identifier hs-var hs-var">relBin_anchor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483868"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Absolute position from where we read 'relBin_offset'.</span></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="relBin_offset"><span class="annot"><span class="annottext">forall {k} (a :: k). RelBin a -&gt; RelBinPtr a
</span><a href="GHC.Utils.Binary.html#relBin_offset"><span class="hs-identifier hs-var hs-var">relBin_offset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483868"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-comment">-- ^ Relative offset to 'relBin_anchor'.</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-comment">-- The absolute position of the 'RelBin' is @relBin_anchor + relBin_offset@</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682485146"><span id="local-6989586621682485151"><span class="annot"><span class="annottext">RelBin a -&gt; RelBin a -&gt; Bool
(RelBin a -&gt; RelBin a -&gt; Bool)
-&gt; (RelBin a -&gt; RelBin a -&gt; Bool) -&gt; Eq (RelBin a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
$c== :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
== :: RelBin a -&gt; RelBin a -&gt; Bool
$c/= :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
/= :: RelBin a -&gt; RelBin a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485157"><span id="local-6989586621682485162"><span id="local-6989586621682485166"><span id="local-6989586621682485170"><span id="local-6989586621682485173"><span id="local-6989586621682485176"><span id="local-6989586621682485179"><span class="annot"><span class="annottext">Eq (RelBin a)
Eq (RelBin a) =&gt;
(RelBin a -&gt; RelBin a -&gt; Ordering)
-&gt; (RelBin a -&gt; RelBin a -&gt; Bool)
-&gt; (RelBin a -&gt; RelBin a -&gt; Bool)
-&gt; (RelBin a -&gt; RelBin a -&gt; Bool)
-&gt; (RelBin a -&gt; RelBin a -&gt; Bool)
-&gt; (RelBin a -&gt; RelBin a -&gt; RelBin a)
-&gt; (RelBin a -&gt; RelBin a -&gt; RelBin a)
-&gt; Ord (RelBin a)
RelBin a -&gt; RelBin a -&gt; Bool
RelBin a -&gt; RelBin a -&gt; Ordering
RelBin a -&gt; RelBin a -&gt; RelBin a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (a :: k). Eq (RelBin a)
forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Ordering
forall k (a :: k). RelBin a -&gt; RelBin a -&gt; RelBin a
$ccompare :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Ordering
compare :: RelBin a -&gt; RelBin a -&gt; Ordering
$c&lt; :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
&lt; :: RelBin a -&gt; RelBin a -&gt; Bool
$c&lt;= :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
&lt;= :: RelBin a -&gt; RelBin a -&gt; Bool
$c&gt; :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
&gt; :: RelBin a -&gt; RelBin a -&gt; Bool
$c&gt;= :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; Bool
&gt;= :: RelBin a -&gt; RelBin a -&gt; Bool
$cmax :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; RelBin a
max :: RelBin a -&gt; RelBin a -&gt; RelBin a
$cmin :: forall k (a :: k). RelBin a -&gt; RelBin a -&gt; RelBin a
min :: RelBin a -&gt; RelBin a -&gt; RelBin a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485182"><span id="local-6989586621682485188"><span id="local-6989586621682485192"><span class="annot"><span class="annottext">Int -&gt; RelBin a -&gt; ShowS
[RelBin a] -&gt; ShowS
RelBin a -&gt; String
(Int -&gt; RelBin a -&gt; ShowS)
-&gt; (RelBin a -&gt; String) -&gt; ([RelBin a] -&gt; ShowS) -&gt; Show (RelBin a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (a :: k). Int -&gt; RelBin a -&gt; ShowS
forall k (a :: k). [RelBin a] -&gt; ShowS
forall k (a :: k). RelBin a -&gt; String
$cshowsPrec :: forall k (a :: k). Int -&gt; RelBin a -&gt; ShowS
showsPrec :: Int -&gt; RelBin a -&gt; ShowS
$cshow :: forall k (a :: k). RelBin a -&gt; String
show :: RelBin a -&gt; String
$cshowList :: forall k (a :: k). [RelBin a] -&gt; ShowS
showList :: [RelBin a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485195"><span id="local-6989586621682485200"><span class="annot"><span class="annottext">RelBin a
RelBin a -&gt; RelBin a -&gt; Bounded (RelBin a)
forall a. a -&gt; a -&gt; Bounded a
forall k (a :: k). RelBin a
$cminBound :: forall k (a :: k). RelBin a
minBound :: RelBin a
$cmaxBound :: forall k (a :: k). RelBin a
maxBound :: RelBin a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | A 'RelBinPtr' is like a 'Bin', but contains a relative offset pointer</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- instead of an absolute offset.</span><span>
</span><span id="line-365"></span><span class="hs-keyword">newtype</span><span> </span><span id="RelBinPtr"><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-var">RelBinPtr</span></a></span></span><span> </span><span id="local-6989586621682483934"><span class="annot"><a href="#local-6989586621682483934"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RelBinPtr"><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-var">RelBinPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483934"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682485206"><span id="local-6989586621682485210"><span class="annot"><span class="annottext">RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
(RelBinPtr a -&gt; RelBinPtr a -&gt; Bool)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; Bool) -&gt; Eq (RelBinPtr a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$c== :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
== :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$c/= :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
/= :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485216"><span id="local-6989586621682485220"><span id="local-6989586621682485224"><span id="local-6989586621682485228"><span id="local-6989586621682485232"><span id="local-6989586621682485236"><span id="local-6989586621682485240"><span class="annot"><span class="annottext">Eq (RelBinPtr a)
Eq (RelBinPtr a) =&gt;
(RelBinPtr a -&gt; RelBinPtr a -&gt; Ordering)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; Bool)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; Bool)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; Bool)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; Bool)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a)
-&gt; (RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a)
-&gt; Ord (RelBinPtr a)
RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
RelBinPtr a -&gt; RelBinPtr a -&gt; Ordering
RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (a :: k). Eq (RelBinPtr a)
forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Ordering
forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
$ccompare :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Ordering
compare :: RelBinPtr a -&gt; RelBinPtr a -&gt; Ordering
$c&lt; :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
&lt; :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$c&lt;= :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
&lt;= :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$c&gt; :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
&gt; :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$c&gt;= :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
&gt;= :: RelBinPtr a -&gt; RelBinPtr a -&gt; Bool
$cmax :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
max :: RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
$cmin :: forall k (a :: k). RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
min :: RelBinPtr a -&gt; RelBinPtr a -&gt; RelBinPtr a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485244"><span id="local-6989586621682485248"><span id="local-6989586621682485251"><span class="annot"><span class="annottext">Int -&gt; RelBinPtr a -&gt; ShowS
[RelBinPtr a] -&gt; ShowS
RelBinPtr a -&gt; String
(Int -&gt; RelBinPtr a -&gt; ShowS)
-&gt; (RelBinPtr a -&gt; String)
-&gt; ([RelBinPtr a] -&gt; ShowS)
-&gt; Show (RelBinPtr a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (a :: k). Int -&gt; RelBinPtr a -&gt; ShowS
forall k (a :: k). [RelBinPtr a] -&gt; ShowS
forall k (a :: k). RelBinPtr a -&gt; String
$cshowsPrec :: forall k (a :: k). Int -&gt; RelBinPtr a -&gt; ShowS
showsPrec :: Int -&gt; RelBinPtr a -&gt; ShowS
$cshow :: forall k (a :: k). RelBinPtr a -&gt; String
show :: RelBinPtr a -&gt; String
$cshowList :: forall k (a :: k). [RelBinPtr a] -&gt; ShowS
showList :: [RelBinPtr a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682485254"><span id="local-6989586621682485258"><span class="annot"><span class="annottext">RelBinPtr a
RelBinPtr a -&gt; RelBinPtr a -&gt; Bounded (RelBinPtr a)
forall a. a -&gt; a -&gt; Bounded a
forall k (a :: k). RelBinPtr a
$cminBound :: forall k (a :: k). RelBinPtr a
minBound :: RelBinPtr a
$cmaxBound :: forall k (a :: k). RelBinPtr a
maxBound :: RelBinPtr a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span id="local-6989586621682483909"><span id="local-6989586621682483910"><span class="annot"><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier hs-type">castBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483910"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-369"></span><span id="castBin"><span class="annot"><span class="annottext">castBin :: forall {k} {k} (a :: k) (b :: k). Bin a -&gt; Bin b
</span><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier hs-var hs-var">castBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span id="local-6989586621682485261"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485261"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bin b
forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485261"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Read a relative offset location and wrap it in 'RelBin'.</span><span>
</span><span id="line-372"></span><span class="hs-comment">--</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- The resulting 'RelBin' can be translated into an absolute offset location using</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- 'makeAbsoluteBin'</span><span>
</span><span id="line-375"></span><span id="local-6989586621682483918"><span class="annot"><a href="GHC.Utils.Binary.html#getRelBin"><span class="hs-identifier hs-type">getRelBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483918"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-376"></span><span id="getRelBin"><span class="annot"><span class="annottext">getRelBin :: forall {k} (a :: k). ReadBinHandle -&gt; IO (RelBin a)
</span><a href="GHC.Utils.Binary.html#getRelBin"><span class="hs-identifier hs-var hs-var">getRelBin</span></a></span></span><span> </span><span id="local-6989586621682485268"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485268"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621682485269"><span class="annot"><a href="#local-6989586621682485269"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (Bin a)
forall {k} (a :: k). ReadBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-var">tellBinReader</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485268"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621682485270"><span class="annot"><a href="#local-6989586621682485270"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485268"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485269"><span class="hs-identifier hs-type">start</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485270"><span class="hs-identifier hs-type">off</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span id="local-6989586621682485271"><span class="annot"><a href="GHC.Utils.Binary.html#makeAbsoluteBin"><span class="hs-identifier hs-type">makeAbsoluteBin</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485271"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485271"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-382"></span><span id="makeAbsoluteBin"><span class="annot"><span class="annottext">makeAbsoluteBin :: forall {k} (a :: k). RelBin a -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#makeAbsoluteBin"><span class="hs-identifier hs-var hs-var">makeAbsoluteBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485273"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485273"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485274"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485274"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Bin a
forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bin a) -&gt; Int -&gt; Bin a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485273"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485274"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span id="local-6989586621682485276"><span class="annot"><a href="GHC.Utils.Binary.html#makeRelativeBin"><span class="hs-identifier hs-type">makeRelativeBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485276"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485276"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-386"></span><span id="makeRelativeBin"><span class="annot"><span class="annottext">makeRelativeBin :: forall {k} (a :: k). RelBin a -&gt; RelBinPtr a
</span><a href="GHC.Utils.Binary.html#makeRelativeBin"><span class="hs-identifier hs-var hs-var">makeRelativeBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485278"><span class="annot"><span class="annottext">RelBinPtr a
</span><a href="#local-6989586621682485278"><span class="hs-identifier hs-var">offset</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelBinPtr a
</span><a href="#local-6989586621682485278"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621682483930"><span class="annot"><a href="GHC.Utils.Binary.html#toRelBin"><span class="hs-identifier hs-type">toRelBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483930"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-389"></span><span id="toRelBin"><span class="annot"><span class="annottext">toRelBin :: forall {k} (a :: k). Bin (RelBinPtr a) -&gt; Bin a -&gt; RelBin a
</span><a href="GHC.Utils.Binary.html#toRelBin"><span class="hs-identifier hs-var hs-var">toRelBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485281"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485281"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485282"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485282"><span class="hs-identifier hs-var">goal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">Bin a -&gt; RelBinPtr a -&gt; RelBin a
forall {k} (a :: k). Bin a -&gt; RelBinPtr a -&gt; RelBin a
</span><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-var">RelBin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bin a
forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485281"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bin a -&gt; RelBinPtr a
forall {k} (a :: k). Bin a -&gt; RelBinPtr a
</span><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-var">RelBinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Bin a -&gt; RelBinPtr a) -&gt; Bin a -&gt; RelBinPtr a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bin a
forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bin a) -&gt; Int -&gt; Bin a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485282"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485281"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- class Binary</span><span>
</span><span id="line-394"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- | Do not rely on instance sizes for general types,</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- we use variable length encoding for many of them.</span><span>
</span><span id="line-398"></span><span class="hs-keyword">class</span><span> </span><span id="Binary"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-var">Binary</span></a></span></span><span> </span><span id="local-6989586621682483792"><span class="annot"><a href="#local-6989586621682483792"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>    </span><span id="put_"><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span id="put"><span class="annot"><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-type">put</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span id="get"><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483792"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-comment">-- define one of put_, put.  Use of put_ is recommended because it</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-comment">-- is more likely that tail-calls can kick in, and we rarely need the</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-comment">-- position return value.</span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621682485285"><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var">put_</span></a></span><span> </span><span id="local-6989586621682485289"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485289"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485290"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485290"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO (Bin a)
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485289"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485290"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621682485291"><span class="annot"><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-var hs-var">put</span></a></span><span> </span><span id="local-6989586621682485296"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485296"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485297"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485298"><span class="annot"><a href="#local-6989586621682485298"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; IO (Bin a)
forall {k} (a :: k). WriteBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-var">tellBinWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485296"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485296"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485297"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682485298"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621682483937"><span class="annot"><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-type">putAt</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-410"></span><span id="putAt"><span class="annot"><span class="annottext">putAt :: forall a. Binary a =&gt; WriteBinHandle -&gt; Bin a -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-var hs-var">putAt</span></a></span></span><span> </span><span id="local-6989586621682485304"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485304"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485305"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485305"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682485306"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Bin a -&gt; IO ()
forall {k} (a :: k). WriteBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinWriter"><span class="hs-identifier hs-var">seekBinWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485304"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485305"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485304"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485306"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span id="local-6989586621682483942"><span class="annot"><a href="GHC.Utils.Binary.html#putAtRel"><span class="hs-identifier hs-type">putAtRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483942"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-413"></span><span id="putAtRel"><span class="annot"><span class="annottext">putAtRel :: forall {k} (a :: k).
WriteBinHandle -&gt; Bin (RelBinPtr a) -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putAtRel"><span class="hs-identifier hs-var hs-var">putAtRel</span></a></span></span><span> </span><span id="local-6989586621682485308"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485308"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485309"><span class="annot"><span class="annottext">Bin (RelBinPtr a)
</span><a href="#local-6989586621682485309"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621682485310"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485310"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Bin (RelBinPtr a) -&gt; RelBinPtr a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; Bin a -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-var">putAt</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485308"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin (RelBinPtr a)
</span><a href="#local-6989586621682485309"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelBin a -&gt; RelBinPtr a
forall {k} (a :: k). RelBin a -&gt; RelBinPtr a
</span><a href="GHC.Utils.Binary.html#makeRelativeBin"><span class="hs-identifier hs-var">makeRelativeBin</span></a></span><span> </span><span class="annot"><span class="annottext">(RelBin a -&gt; RelBinPtr a) -&gt; RelBin a -&gt; RelBinPtr a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bin (RelBinPtr a) -&gt; Bin a -&gt; RelBin a
forall {k} (a :: k). Bin (RelBinPtr a) -&gt; Bin a -&gt; RelBin a
</span><a href="GHC.Utils.Binary.html#toRelBin"><span class="hs-identifier hs-var">toRelBin</span></a></span><span> </span><span class="annot"><span class="annottext">Bin (RelBinPtr a)
</span><a href="#local-6989586621682485309"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485310"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621682483945"><span class="annot"><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier hs-type">getAt</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483945"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-416"></span><span id="getAt"><span class="annot"><span class="annottext">getAt :: forall a. Binary a =&gt; ReadBinHandle -&gt; Bin a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier hs-var hs-var">getAt</span></a></span></span><span> </span><span id="local-6989586621682485314"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485314"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485315"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485315"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Bin a -&gt; IO ()
forall {k} (a :: k). ReadBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-var">seekBinReader</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485314"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682485315"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485314"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="annot"><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier hs-type">openBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span>
</span><span id="line-419"></span><span id="openBinMem"><span class="annot"><span class="annottext">openBinMem :: Int -&gt; IO WriteBinHandle
</span><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier hs-var hs-var">openBinMem</span></a></span></span><span> </span><span id="local-6989586621682485316"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485316"><span class="hs-identifier hs-var">size</span></a></span></span><span>
</span><span id="line-420"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485316"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO WriteBinHandle
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.Utils.Binary.openBinMem: size must be &gt;= 0&quot;</span></span><span>
</span><span id="line-421"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>   </span><span id="local-6989586621682485318"><span class="annot"><a href="#local-6989586621682485318"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO BinArray
forall a. Int -&gt; IO (ForeignPtr a)
</span><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485316"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-423"></span><span>   </span><span id="local-6989586621682485319"><span class="annot"><a href="#local-6989586621682485319"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485318"><span class="hs-identifier hs-type">arr</span></a></span><span>
</span><span id="line-424"></span><span>   </span><span id="local-6989586621682485321"><span class="annot"><a href="#local-6989586621682485321"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-type">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-425"></span><span>   </span><span id="local-6989586621682485322"><span class="annot"><a href="#local-6989586621682485322"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-type">newFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485316"><span class="hs-identifier hs-type">size</span></a></span><span>
</span><span id="line-426"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier hs-type">noWriterUserData</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_off_r"><span class="hs-identifier hs-var">wbm_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485321"><span class="hs-identifier hs-type">ix_r</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_sz_r"><span class="hs-identifier hs-var">wbm_sz_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485322"><span class="hs-identifier hs-type">sz_r</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_arr_r"><span class="hs-identifier hs-var">wbm_arr_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485319"><span class="hs-identifier hs-type">arr_r</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- | Freeze the given 'WriteBinHandle' and turn it into an equivalent 'ReadBinHandle'.</span><span>
</span><span id="line-434"></span><span class="hs-comment">--</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- The current offset of the 'WriteBinHandle' is maintained in the new 'ReadBinHandle'.</span><span>
</span><span id="line-436"></span><span class="annot"><a href="GHC.Utils.Binary.html#freezeWriteHandle"><span class="hs-identifier hs-type">freezeWriteHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-437"></span><span id="freezeWriteHandle"><span class="annot"><span class="annottext">freezeWriteHandle :: WriteBinHandle -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#freezeWriteHandle"><span class="hs-identifier hs-var hs-var">freezeWriteHandle</span></a></span></span><span> </span><span id="local-6989586621682485323"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485323"><span class="hs-identifier hs-var">wbm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621682485324"><span class="annot"><a href="#local-6989586621682485324"><span class="hs-identifier hs-var">rbm_off_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO FastMutInt) -&gt; IO Int -&gt; IO FastMutInt
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#wbm_off_r"><span class="hs-identifier hs-var">wbm_off_r</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485323"><span class="hs-identifier hs-var">wbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621682485326"><span class="annot"><a href="#local-6989586621682485326"><span class="hs-identifier hs-var">rbm_sz_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-type">readFastMutInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_sz_r"><span class="hs-identifier hs-var">wbm_sz_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485323"><span class="hs-identifier hs-type">wbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621682485327"><span class="annot"><a href="#local-6989586621682485327"><span class="hs-identifier hs-var">rbm_arr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_arr_r"><span class="hs-identifier hs-var">wbm_arr_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485323"><span class="hs-identifier hs-type">wbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-type">noReaderUserData</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_off_r"><span class="hs-identifier hs-var">rbm_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485324"><span class="hs-identifier hs-type">rbm_off_r</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_sz_r"><span class="hs-identifier hs-var">rbm_sz_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485326"><span class="hs-identifier hs-type">rbm_sz_r</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_arr_r"><span class="hs-identifier hs-var">rbm_arr_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485327"><span class="hs-identifier hs-type">rbm_arr_r</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | Copy the BinBuffer to a new BinBuffer which is exactly the right size.</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- This performs a copy of the underlying buffer.</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- The buffer may be truncated if the offset is not at the end of the written</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- output.</span><span>
</span><span id="line-452"></span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- UserData is also discarded during the copy</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- You should just use this when translating a Put handle into a Get handle.</span><span>
</span><span id="line-455"></span><span class="annot"><a href="GHC.Utils.Binary.html#shrinkBinBuffer"><span class="hs-identifier hs-type">shrinkBinBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-456"></span><span id="shrinkBinBuffer"><span class="annot"><span class="annottext">shrinkBinBuffer :: WriteBinHandle -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#shrinkBinBuffer"><span class="hs-identifier hs-var hs-var">shrinkBinBuffer</span></a></span></span><span> </span><span id="local-6989586621682485328"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485328"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
-&gt; (ByteString -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle
forall a. WriteBinHandle -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier hs-var">withBinBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485328"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle)
-&gt; (ByteString -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485329"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682485329"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#unsafeUnpackBinBuffer"><span class="hs-identifier hs-var">unsafeUnpackBinBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682485329"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><a href="GHC.Utils.Binary.html#thawReadHandle"><span class="hs-identifier hs-type">thawReadHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span>
</span><span id="line-460"></span><span id="thawReadHandle"><span class="annot"><span class="annottext">thawReadHandle :: ReadBinHandle -&gt; IO WriteBinHandle
</span><a href="GHC.Utils.Binary.html#thawReadHandle"><span class="hs-identifier hs-var hs-var">thawReadHandle</span></a></span></span><span> </span><span id="local-6989586621682485330"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485330"><span class="hs-identifier hs-var">rbm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621682485331"><span class="annot"><a href="#local-6989586621682485331"><span class="hs-identifier hs-var">wbm_off_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO FastMutInt) -&gt; IO Int -&gt; IO FastMutInt
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadBinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#rbm_off_r"><span class="hs-identifier hs-var">rbm_off_r</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485330"><span class="hs-identifier hs-var">rbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span id="local-6989586621682485332"><span class="annot"><a href="#local-6989586621682485332"><span class="hs-identifier hs-var">wbm_sz_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-type">newFastMutInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_sz_r"><span class="hs-identifier hs-var">rbm_sz_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485330"><span class="hs-identifier hs-type">rbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621682485333"><span class="annot"><a href="#local-6989586621682485333"><span class="hs-identifier hs-var">wbm_arr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_arr_r"><span class="hs-identifier hs-var">rbm_arr_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485330"><span class="hs-identifier hs-type">rbm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_userData"><span class="hs-identifier hs-var">wbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier hs-type">noWriterUserData</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_off_r"><span class="hs-identifier hs-var">wbm_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485331"><span class="hs-identifier hs-type">wbm_off_r</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_sz_r"><span class="hs-identifier hs-var">wbm_sz_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485332"><span class="hs-identifier hs-type">wbm_sz_r</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#wbm_arr_r"><span class="hs-identifier hs-var">wbm_arr_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485333"><span class="hs-identifier hs-type">wbm_arr_r</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span id="local-6989586621682483936"><span class="annot"><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-type">tellBinWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-472"></span><span id="tellBinWriter"><span class="annot"><span class="annottext">tellBinWriter :: forall {k} (a :: k). WriteBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-var hs-var">tellBinWriter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485336"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485336"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485337"><span class="annot"><a href="#local-6989586621682485337"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485336"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485337"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span id="local-6989586621682483924"><span class="annot"><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-type">tellBinReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483924"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-475"></span><span id="tellBinReader"><span class="annot"><span class="annottext">tellBinReader :: forall {k} (a :: k). ReadBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-var hs-var">tellBinReader</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485340"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485340"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485341"><span class="annot"><a href="#local-6989586621682485341"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485340"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485341"><span class="hs-identifier hs-type">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span id="local-6989586621682483940"><span class="annot"><a href="GHC.Utils.Binary.html#seekBinWriter"><span class="hs-identifier hs-type">seekBinWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483940"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-478"></span><span id="seekBinWriter"><span class="annot"><span class="annottext">seekBinWriter :: forall {k} (a :: k). WriteBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinWriter"><span class="hs-identifier hs-var hs-var">seekBinWriter</span></a></span></span><span> </span><span id="local-6989586621682485345"><span class="annot"><span class="annottext">h :: WriteBinHandle
</span><a href="#local-6989586621682485345"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485346"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485346"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485347"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485347"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485348"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621682485349"><span class="annot"><a href="#local-6989586621682485349"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485347"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485348"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682485349"><span class="hs-identifier hs-type">sz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-type">expandBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485345"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485348"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485346"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485348"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-482"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485346"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485348"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="hs-comment">-- | 'seekBinNoExpandWriter' moves the index pointer to the location pointed to</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- by 'Bin a'.</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- This operation may 'panic', if the pointer location is out of bounds of the</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- buffer of 'BinHandle'.</span><span>
</span><span id="line-488"></span><span id="local-6989586621682485354"><span class="annot"><a href="GHC.Utils.Binary.html#seekBinNoExpandWriter"><span class="hs-identifier hs-type">seekBinNoExpandWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485354"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-489"></span><span id="seekBinNoExpandWriter"><span class="annot"><span class="annottext">seekBinNoExpandWriter :: forall {k} (a :: k). WriteBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinNoExpandWriter"><span class="hs-identifier hs-var hs-var">seekBinNoExpandWriter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485359"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485359"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485360"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485360"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485361"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485361"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621682485362"><span class="annot"><a href="#local-6989586621682485362"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485360"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485361"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682485362"><span class="hs-identifier hs-type">sz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-type">panic</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;seekBinNoExpandWriter: seek out of range&quot;</span></span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485359"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485361"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="annot"><span class="hs-comment">-- | SeekBin but without calling expandBin</span></span><span>
</span><span id="line-496"></span><span id="local-6989586621682483948"><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-497"></span><span id="seekBinReader"><span class="annot"><span class="annottext">seekBinReader :: forall {k} (a :: k). ReadBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-var hs-var">seekBinReader</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485366"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485366"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485367"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485367"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485368"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485368"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485368"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485367"><span class="hs-identifier hs-var">sz_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;seekBinReader: seek out of range&quot;</span></span><span>
</span><span id="line-500"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485366"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485368"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span id="local-6989586621682483967"><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReaderRel"><span class="hs-identifier hs-type">seekBinReaderRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#RelBin"><span class="hs-identifier hs-type">RelBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483967"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-503"></span><span id="seekBinReaderRel"><span class="annot"><span class="annottext">seekBinReaderRel :: forall {k} (a :: k). ReadBinHandle -&gt; RelBin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBinReaderRel"><span class="hs-identifier hs-var hs-var">seekBinReaderRel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485372"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485372"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485373"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485373"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682485374"><span class="annot"><span class="annottext">RelBin a
</span><a href="#local-6989586621682485374"><span class="hs-identifier hs-var">relBin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485375"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485375"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelBin a -&gt; Bin a
forall {k} (a :: k). RelBin a -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#makeAbsoluteBin"><span class="hs-identifier hs-var">makeAbsoluteBin</span></a></span><span> </span><span class="annot"><span class="annottext">RelBin a
</span><a href="#local-6989586621682485374"><span class="hs-identifier hs-var">relBin</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485375"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485373"><span class="hs-identifier hs-var">sz_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;seekBinReaderRel: seek out of range&quot;</span></span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485372"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485375"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="annot"><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier hs-type">writeBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span id="writeBinMem"><span class="annot"><span class="annottext">writeBinMem :: WriteBinHandle -&gt; String -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier hs-var hs-var">writeBinMem</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485377"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485377"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485378"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682485378"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682485379"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485379"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621682485380"><span class="annot"><a href="#local-6989586621682485380"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485379"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621682485383"><span class="annot"><a href="#local-6989586621682485383"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485378"><span class="hs-identifier hs-type">arr_r</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span id="local-6989586621682485384"><span class="annot"><a href="#local-6989586621682485384"><span class="hs-identifier hs-var">ix</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-type">readFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485377"><span class="hs-identifier hs-type">ix_r</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621682485383"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485385"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485385"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutBuf</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485380"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485385"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485384"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">hClose</span></span><span> </span><span class="annot"><a href="#local-6989586621682485380"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier hs-type">readBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-518"></span><span id="readBinMem"><span class="annot"><span class="annottext">readBinMem :: String -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier hs-var hs-var">readBinMem</span></a></span></span><span> </span><span id="local-6989586621682485388"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485388"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; IOMode -&gt; (Handle -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485388"><span class="hs-identifier hs-var">filename</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle)
-&gt; (Handle -&gt; IO ReadBinHandle) -&gt; IO ReadBinHandle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485391"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485391"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621682485392"><span class="annot"><a href="#local-6989586621682485392"><span class="hs-identifier hs-var">filesize'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Integer
</span><span class="hs-identifier hs-var">hFileSize</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485391"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682485394"><span class="annot"><a href="#local-6989586621682485394"><span class="hs-identifier hs-var hs-var">filesize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682485392"><span class="hs-identifier hs-var">filesize'</span></a></span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem_"><span class="hs-identifier hs-type">readBinMem_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485394"><span class="hs-identifier hs-type">filesize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485391"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMemN"><span class="hs-identifier hs-type">readBinMemN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span id="readBinMemN"><span class="annot"><span class="annottext">readBinMemN :: Int -&gt; String -&gt; IO (Maybe ReadBinHandle)
</span><a href="GHC.Utils.Binary.html#readBinMemN"><span class="hs-identifier hs-var hs-var">readBinMemN</span></a></span></span><span> </span><span id="local-6989586621682485396"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485396"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621682485397"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485397"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; IOMode
-&gt; (Handle -&gt; IO (Maybe ReadBinHandle))
-&gt; IO (Maybe ReadBinHandle)
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682485397"><span class="hs-identifier hs-var">filename</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO (Maybe ReadBinHandle)) -&gt; IO (Maybe ReadBinHandle))
-&gt; (Handle -&gt; IO (Maybe ReadBinHandle)) -&gt; IO (Maybe ReadBinHandle)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485398"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485398"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621682485399"><span class="annot"><a href="#local-6989586621682485399"><span class="hs-identifier hs-var">filesize'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Integer
</span><span class="hs-identifier hs-var">hFileSize</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485398"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682485400"><span class="annot"><a href="#local-6989586621682485400"><span class="hs-identifier hs-var hs-var">filesize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682485399"><span class="hs-identifier hs-var">filesize'</span></a></span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682485400"><span class="hs-identifier hs-type">filesize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682485396"><span class="hs-identifier hs-type">size</span></a></span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem_"><span class="hs-identifier hs-type">readBinMem_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485396"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485398"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem_"><span class="hs-identifier hs-type">readBinMem_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-534"></span><span id="readBinMem_"><span class="annot"><span class="annottext">readBinMem_ :: Int -&gt; Handle -&gt; IO ReadBinHandle
</span><a href="GHC.Utils.Binary.html#readBinMem_"><span class="hs-identifier hs-var hs-var">readBinMem_</span></a></span></span><span> </span><span id="local-6989586621682485401"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485401"><span class="hs-identifier hs-var">filesize</span></a></span></span><span> </span><span id="local-6989586621682485402"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485402"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621682485403"><span class="annot"><a href="#local-6989586621682485403"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO BinArray
forall a. Int -&gt; IO (ForeignPtr a)
</span><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485401"><span class="hs-identifier hs-var">filesize</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621682485404"><span class="annot"><a href="#local-6989586621682485404"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621682485403"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485405"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485405"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hGetBuf</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621682485402"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485405"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485401"><span class="hs-identifier hs-var">filesize</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485404"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="#local-6989586621682485401"><span class="hs-identifier hs-type">filesize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-538"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Binary.readBinMem: only read &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621682485404"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>  </span><span id="local-6989586621682485408"><span class="annot"><a href="#local-6989586621682485408"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-type">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_userData"><span class="hs-identifier hs-var">rbm_userData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-type">noReaderUserData</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_off_r"><span class="hs-identifier hs-var">rbm_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485408"><span class="hs-identifier hs-type">ix_r</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_sz_r"><span class="hs-identifier hs-var">rbm_sz_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485401"><span class="hs-identifier hs-type">filesize</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_arr_r"><span class="hs-identifier hs-var">rbm_arr_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682485403"><span class="hs-identifier hs-type">arr</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- expand the size of the array to include a specified offset</span><span>
</span><span id="line-548"></span><span class="annot"><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-type">expandBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span id="expandBin"><span class="annot"><span class="annottext">expandBin :: WriteBinHandle -&gt; Int -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-var hs-var">expandBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485409"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485409"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621682485410"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682485410"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485411"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485411"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>   </span><span class="hs-glyph">!</span><span id="local-6989586621682485412"><span class="annot"><a href="#local-6989586621682485412"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485409"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-551"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485413"><span class="annot"><a href="#local-6989586621682485413"><span class="hs-identifier hs-var hs-var">sz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621682485414"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485412"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-552"></span><span>   </span><span id="local-6989586621682485415"><span class="annot"><a href="#local-6989586621682485415"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485410"><span class="hs-identifier hs-type">arr_r</span></a></span><span>
</span><span id="line-553"></span><span>   </span><span id="local-6989586621682485416"><span class="annot"><a href="#local-6989586621682485416"><span class="hs-identifier hs-var">arr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mallocForeignPtrBytes</span></span><span> </span><span class="annot"><a href="#local-6989586621682485413"><span class="hs-identifier hs-type">sz'</span></a></span><span>
</span><span id="line-554"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">withForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621682485415"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485418"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485418"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-555"></span><span>     </span><span class="annot"><span class="annottext">BinArray -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485416"><span class="hs-identifier hs-var">arr'</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485419"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485419"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-556"></span><span>       </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485419"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485418"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485412"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-557"></span><span>   </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485409"><span class="hs-identifier hs-type">sz_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485413"><span class="hs-identifier hs-type">sz'</span></a></span><span>
</span><span id="line-558"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485410"><span class="hs-identifier hs-type">arr_r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485416"><span class="hs-identifier hs-type">arr'</span></a></span><span>
</span><span id="line-559"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="#local-6989586621682485414"><span class="hs-identifier hs-type">getSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621682485414"><span class="annot"><span class="annottext">getSize :: Int -&gt; Int
</span><a href="#local-6989586621682485414"><span class="hs-identifier hs-var hs-var">getSize</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485421"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485421"><span class="hs-identifier hs-var">sz</span></a></span></span><span>
</span><span id="line-562"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485421"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485411"><span class="hs-identifier hs-var">off</span></a></span><span>
</span><span id="line-563"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485421"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-565"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621682485414"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485421"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span id="local-6989586621682483980"><span id="local-6989586621682483981"><span class="annot"><a href="GHC.Utils.Binary.html#foldGet"><span class="hs-identifier hs-type">foldGet</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483980"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-comment">-- n elements</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483981"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-comment">-- initial accumulator</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483980"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483981"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483981"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483981"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-574"></span><span id="foldGet"><span class="annot"><span class="annottext">foldGet :: forall a b.
Binary a =&gt;
Word -&gt; ReadBinHandle -&gt; b -&gt; (Word -&gt; a -&gt; b -&gt; IO b) -&gt; IO b
</span><a href="GHC.Utils.Binary.html#foldGet"><span class="hs-identifier hs-var hs-var">foldGet</span></a></span></span><span> </span><span id="local-6989586621682485434"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485434"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682485435"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485435"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485436"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485436"><span class="hs-identifier hs-var">init_b</span></a></span></span><span> </span><span id="local-6989586621682485437"><span class="annot"><span class="annottext">Word -&gt; a -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485437"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485436"><span class="hs-identifier hs-var">init_b</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621682485438"><span class="annot"><span class="annottext">go :: Word -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485438"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485439"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485439"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621682485440"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485440"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485439"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485434"><span class="hs-identifier hs-var">n</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IO b
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485440"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-579"></span><span>          </span><span id="local-6989586621682485441"><span class="annot"><a href="#local-6989586621682485441"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485435"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-580"></span><span>          </span><span id="local-6989586621682485442"><span class="annot"><a href="#local-6989586621682485442"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682485437"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485439"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485441"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485440"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-581"></span><span>          </span><span class="annot"><a href="#local-6989586621682485438"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485439"><span class="hs-identifier hs-type">i</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682485442"><span class="hs-identifier hs-type">b'</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span id="local-6989586621682485443"><span id="local-6989586621682485444"><span class="annot"><a href="GHC.Utils.Binary.html#foldGet%27"><span class="hs-identifier hs-type">foldGet'</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485443"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-comment">-- n elements</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682485444"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-comment">-- initial accumulator</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682485443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682485444"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682485444"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682485444"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-590"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#foldGet%27"><span class="hs-pragma hs-type">foldGet'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-591"></span><span id="foldGet%27"><span class="annot"><span class="annottext">foldGet' :: forall a b.
Binary a =&gt;
Word -&gt; ReadBinHandle -&gt; b -&gt; (Word -&gt; a -&gt; b -&gt; IO b) -&gt; IO b
</span><a href="GHC.Utils.Binary.html#foldGet%27"><span class="hs-identifier hs-var hs-var">foldGet'</span></a></span></span><span> </span><span id="local-6989586621682485454"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485454"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682485455"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485455"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485456"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485456"><span class="hs-identifier hs-var">init_b</span></a></span></span><span> </span><span id="local-6989586621682485457"><span class="annot"><span class="annottext">Word -&gt; a -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485457"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485458"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485456"><span class="hs-identifier hs-var">init_b</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621682485458"><span class="annot"><span class="annottext">go :: Word -&gt; b -&gt; IO b
</span><a href="#local-6989586621682485458"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485459"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485459"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485460"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485460"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-594"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485459"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682485454"><span class="hs-identifier hs-var">n</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; IO b
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682485460"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-595"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-596"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621682485461"><span class="annot"><a href="#local-6989586621682485461"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485455"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-597"></span><span>          </span><span id="local-6989586621682485462"><span class="annot"><a href="#local-6989586621682485462"><span class="hs-identifier hs-var">b'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682485457"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485459"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485460"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-598"></span><span>          </span><span class="annot"><a href="#local-6989586621682485458"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485459"><span class="hs-identifier hs-type">i</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682485462"><span class="hs-identifier hs-type">b'</span></a></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- Low-level reading/writing of bytes</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-comment">-- | Takes a size and action writing up to @size@ bytes.</span><span>
</span><span id="line-605"></span><span class="hs-comment">--   After the action has run advance the index to the buffer</span><span>
</span><span id="line-606"></span><span class="hs-comment">--   by size bytes.</span><span>
</span><span id="line-607"></span><span class="annot"><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-type">putPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span id="putPrim"><span class="annot"><span class="annottext">putPrim :: WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var hs-var">putPrim</span></a></span></span><span> </span><span id="local-6989586621682485463"><span class="annot"><span class="annottext">h :: WriteBinHandle
</span><a href="#local-6989586621682485463"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinMem"><span class="hs-identifier hs-type">WriteBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485464"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485464"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485465"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485465"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621682485466"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621682485466"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682485467"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485467"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621682485468"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621682485468"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621682485469"><span class="annot"><a href="#local-6989586621682485469"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485464"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span id="local-6989586621682485470"><span class="annot"><a href="#local-6989586621682485470"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-type">readFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485465"><span class="hs-identifier hs-type">sz_r</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485469"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682485467"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682485470"><span class="hs-identifier hs-type">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-type">expandBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485463"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485469"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682485467"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>  </span><span id="local-6989586621682485471"><span class="annot"><a href="#local-6989586621682485471"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682485466"><span class="hs-identifier hs-type">arr_r</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621682485471"><span class="hs-identifier hs-type">arr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485472"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485472"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621682485468"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485472"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485469"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485464"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485469"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682485467"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- -- | Similar to putPrim but advances the index by the actual number of</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- -- bytes written.</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- putPrimMax :: BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO ()</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- putPrimMax h@(BinMem _ ix_r sz_r arr_r) size f = do</span><span>
</span><span id="line-621"></span><span class="hs-comment">--   ix &lt;- readFastMutInt ix_r</span><span>
</span><span id="line-622"></span><span class="hs-comment">--   sz &lt;- readFastMutInt sz_r</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   when (ix + size &gt; sz) $</span><span>
</span><span id="line-624"></span><span class="hs-comment">--     expandBin h (ix + size)</span><span>
</span><span id="line-625"></span><span class="hs-comment">--   arr &lt;- readIORef arr_r</span><span>
</span><span id="line-626"></span><span class="hs-comment">--   written &lt;- withForeignPtr arr $ \op -&gt; f (op `plusPtr` ix)</span><span>
</span><span id="line-627"></span><span class="hs-comment">--   writeFastMutInt ix_r (ix + written)</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span id="local-6989586621682483802"><span class="annot"><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-type">getPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682483802"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-630"></span><span id="getPrim"><span class="annot"><span class="annottext">getPrim :: forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var hs-var">getPrim</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinMem"><span class="hs-identifier hs-type">ReadBinMem</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682485485"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485485"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621682485486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485486"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621682485487"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621682485487"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682485488"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485488"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621682485489"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO a
</span><a href="#local-6989586621682485489"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-631"></span><span>  </span><span id="local-6989586621682485490"><span class="annot"><a href="#local-6989586621682485490"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682485485"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-632"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485490"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682485488"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682485486"><span class="hs-identifier hs-type">sz_r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-633"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">ioError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mkIOError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">eofErrorType</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Data.Binary.getPrim&quot;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>  </span><span id="local-6989586621682485492"><span class="annot"><a href="#local-6989586621682485492"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621682485487"><span class="hs-identifier hs-type">arr_r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682485493"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485493"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO a
</span><a href="#local-6989586621682485489"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485493"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485490"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-comment">-- This is safe WRT #17760 as we we guarantee that the above line doesn't</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- diverge</span><span>
</span><span id="line-637"></span><span>  </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485485"><span class="hs-identifier hs-type">ix_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485490"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621682485488"><span class="hs-identifier hs-type">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682485492"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-type">putWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span id="putWord8"><span class="annot"><span class="annottext">putWord8 :: WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var hs-var">putWord8</span></a></span></span><span> </span><span id="local-6989586621682485495"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485495"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485496"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485496"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485495"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485497"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485497"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">poke</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485497"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485496"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-type">getWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-644"></span><span id="getWord8"><span class="annot"><span class="annottext">getWord8 :: ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var hs-var">getWord8</span></a></span></span><span> </span><span id="local-6989586621682485500"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485500"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485500"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-type">putWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span id="putWord16"><span class="annot"><span class="annottext">putWord16 :: WriteBinHandle -&gt; Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-var hs-var">putWord16</span></a></span></span><span> </span><span id="local-6989586621682485503"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485503"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682485504"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682485504"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485503"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485505"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485505"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485505"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682485504"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int -&gt; Word16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485505"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682485504"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-type">getWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-653"></span><span id="getWord16"><span class="annot"><span class="annottext">getWord16 :: ReadBinHandle -&gt; IO Word16
</span><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-var hs-var">getWord16</span></a></span></span><span> </span><span id="local-6989586621682485510"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485510"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Word16) -&gt; IO Word16
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485510"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485511"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485511"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>  </span><span id="local-6989586621682485512"><span class="annot"><a href="#local-6989586621682485512"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word16) -&gt; IO Word8 -&gt; IO Word16
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485511"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-655"></span><span>  </span><span id="local-6989586621682485514"><span class="annot"><a href="#local-6989586621682485514"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485511"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621682485512"><span class="hs-identifier hs-type">w0</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span> </span><span class="annot"><a href="#local-6989586621682485514"><span class="hs-identifier hs-type">w1</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-type">putWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span id="putWord32"><span class="annot"><span class="annottext">putWord32 :: WriteBinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var hs-var">putWord32</span></a></span></span><span> </span><span id="local-6989586621682485519"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485519"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682485520"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485520"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485519"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485521"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485521"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485520"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485520"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485520"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485520"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-type">getWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-668"></span><span id="getWord32"><span class="annot"><span class="annottext">getWord32 :: ReadBinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var hs-var">getWord32</span></a></span></span><span> </span><span id="local-6989586621682485523"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485523"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Word32) -&gt; IO Word32
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485523"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485524"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485524"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-669"></span><span>  </span><span id="local-6989586621682485525"><span class="annot"><a href="#local-6989586621682485525"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word32) -&gt; IO Word8 -&gt; IO Word32
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485524"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-670"></span><span>  </span><span id="local-6989586621682485526"><span class="annot"><a href="#local-6989586621682485526"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485524"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-671"></span><span>  </span><span id="local-6989586621682485527"><span class="annot"><a href="#local-6989586621682485527"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485524"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-672"></span><span>  </span><span id="local-6989586621682485528"><span class="annot"><a href="#local-6989586621682485528"><span class="hs-identifier hs-var">w3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485524"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485525"><span class="hs-identifier hs-type">w0</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-675"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485526"><span class="hs-identifier hs-type">w1</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-676"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485527"><span class="hs-identifier hs-type">w2</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-677"></span><span>            </span><span class="annot"><a href="#local-6989586621682485528"><span class="hs-identifier hs-type">w3</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-type">putWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span id="putWord64"><span class="annot"><span class="annottext">putWord64 :: WriteBinHandle -&gt; Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-var hs-var">putWord64</span></a></span></span><span> </span><span id="local-6989586621682485530"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485530"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682485531"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485530"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485532"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-682"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485532"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485531"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-type">getWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-693"></span><span id="getWord64"><span class="annot"><span class="annottext">getWord64 :: ReadBinHandle -&gt; IO Word64
</span><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-var hs-var">getWord64</span></a></span></span><span> </span><span id="local-6989586621682485534"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485534"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Word64) -&gt; IO Word64
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485534"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682485535"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485535"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-694"></span><span>  </span><span id="local-6989586621682485536"><span class="annot"><a href="#local-6989586621682485536"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word64) -&gt; IO Word8 -&gt; IO Word64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682485535"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-695"></span><span>  </span><span id="local-6989586621682485537"><span class="annot"><a href="#local-6989586621682485537"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-696"></span><span>  </span><span id="local-6989586621682485538"><span class="annot"><a href="#local-6989586621682485538"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-697"></span><span>  </span><span id="local-6989586621682485539"><span class="annot"><a href="#local-6989586621682485539"><span class="hs-identifier hs-var">w3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-698"></span><span>  </span><span id="local-6989586621682485540"><span class="annot"><a href="#local-6989586621682485540"><span class="hs-identifier hs-var">w4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-699"></span><span>  </span><span id="local-6989586621682485541"><span class="annot"><a href="#local-6989586621682485541"><span class="hs-identifier hs-var">w5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-700"></span><span>  </span><span id="local-6989586621682485542"><span class="annot"><a href="#local-6989586621682485542"><span class="hs-identifier hs-var">w6</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span>
</span><span id="line-701"></span><span>  </span><span id="local-6989586621682485543"><span class="annot"><a href="#local-6989586621682485543"><span class="hs-identifier hs-var">w7</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621682485535"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-number">7</span></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485536"><span class="hs-identifier hs-type">w0</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">56</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-704"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485537"><span class="hs-identifier hs-type">w1</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">48</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-705"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485538"><span class="hs-identifier hs-type">w2</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">40</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-706"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485539"><span class="hs-identifier hs-type">w3</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-707"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485540"><span class="hs-identifier hs-type">w4</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-708"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485541"><span class="hs-identifier hs-type">w5</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485542"><span class="hs-identifier hs-type">w6</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-type">`shiftL`</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span>
</span><span id="line-710"></span><span>            </span><span class="annot"><a href="#local-6989586621682485543"><span class="hs-identifier hs-type">w7</span></a></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="annot"><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-type">putByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span id="putByte"><span class="annot"><span class="annottext">putByte :: WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var hs-var">putByte</span></a></span></span><span> </span><span id="local-6989586621682485544"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485544"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485545"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485545"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485544"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485545"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="annot"><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-type">getByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-717"></span><span id="getByte"><span class="annot"><span class="annottext">getByte :: ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var hs-var">getByte</span></a></span></span><span> </span><span id="local-6989586621682485546"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485546"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485546"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- Encode numbers in LEB128 encoding.</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- Requires one byte of space per 7 bits of data.</span><span>
</span><span id="line-722"></span><span class="hs-comment">--</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- There are signed and unsigned variants.</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- Do NOT use the unsigned one for signed values, at worst it will</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- result in wrong results, at best it will lead to bad performance</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- when coercing negative values to an unsigned type.</span><span>
</span><span id="line-727"></span><span class="hs-comment">--</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- We mark them as SPECIALIZE as it's extremely critical that they get specialized</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- to their specific types.</span><span>
</span><span id="line-730"></span><span class="hs-comment">--</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- TODO: Each use of putByte performs a bounds check,</span><span>
</span><span id="line-732"></span><span class="hs-comment">--       we should use putPrimMax here. However it's quite hard to return</span><span>
</span><span id="line-733"></span><span class="hs-comment">--       the number of bytes written into putPrimMax without allocating an</span><span>
</span><span id="line-734"></span><span class="hs-comment">--       Int for it, while the code below does not allocate at all.</span><span>
</span><span id="line-735"></span><span class="hs-comment">--       So we eat the cost of the bounds check instead of increasing allocations</span><span>
</span><span id="line-736"></span><span class="hs-comment">--       for now.</span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-comment">-- Unsigned numbers</span><span>
</span><span id="line-739"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-740"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word64</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-741"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word32</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-742"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word16</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-743"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-744"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int64</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-745"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int32</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-746"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int16</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-747"></span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-type">putULEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682483998"><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span id="putULEB128"><span class="annot"><span class="annottext">putULEB128 :: forall a.
(Integral a, FiniteBits a) =&gt;
WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var hs-var">putULEB128</span></a></span></span><span> </span><span id="local-6989586621682485568"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485568"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485569"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(DEBUG)
</span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-string">&quot;putULEB128: Signed number&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">id</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621682485570"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485569"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><a href="#local-6989586621682485570"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>    </span><span id="local-6989586621682485570"><span class="annot"><span class="annottext">go :: a -&gt; IO ()
</span><a href="#local-6989586621682485570"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485571"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485571"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485571"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">127</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682483998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485568"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485571"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-759"></span><span>        </span><span class="hs-comment">-- bit 7 (8th bit) indicates more to come.</span><span>
</span><span id="line-760"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485572"><span class="annot"><span class="annottext">byte :: Word8
</span><a href="#local-6989586621682485572"><span class="hs-identifier hs-var hs-var hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. (Num a, Bits a) =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#setBit"><span class="hs-identifier hs-var">setBit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485571"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-761"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485568"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485572"><span class="hs-identifier hs-var">byte</span></a></span><span>
</span><span id="line-762"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621682485570"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485571"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-765"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word64</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-766"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word32</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-767"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word16</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-768"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-769"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int64</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-770"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int32</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-771"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int16</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-772"></span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-type">getULEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484004"><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-773"></span><span id="getULEB128"><span class="annot"><span class="annottext">getULEB128 :: forall a. (Integral a, FiniteBits a) =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var hs-var">getULEB128</span></a></span></span><span> </span><span id="local-6989586621682485592"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485592"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO a
</span><a href="#local-6989586621682485593"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-776"></span><span>    </span><span class="annot"><a href="#local-6989586621682485593"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621682485593"><span class="annot"><span class="annottext">go :: Int -&gt; a -&gt; IO a
</span><a href="#local-6989586621682485593"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485594"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485594"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621682485595"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485595"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-778"></span><span>        </span><span id="local-6989586621682485596"><span class="annot"><a href="#local-6989586621682485596"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485592"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-779"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485597"><span class="annot"><a href="#local-6989586621682485597"><span class="hs-identifier hs-var hs-var">hasMore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485596"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-780"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485599"><span class="annot"><a href="#local-6989586621682485599"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485595"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. (Num a, Bits a) =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485596"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485594"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682484004"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-781"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682485597"><span class="hs-identifier hs-type">hasMore</span></a></span><span>
</span><span id="line-782"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>                </span><span class="annot"><a href="#local-6989586621682485593"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485594"><span class="hs-identifier hs-type">shift</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682485599"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-784"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-785"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621682485599"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span class="hs-comment">-- Signed numbers</span><span>
</span><span id="line-788"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-789"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word64</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-790"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word32</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-791"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word16</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-792"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-793"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int64</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-794"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int32</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-795"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-pragma hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int16</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-796"></span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-type">putSLEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484006"><span class="annot"><a href="#local-6989586621682484006"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682484006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621682484006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span id="putSLEB128"><span class="annot"><span class="annottext">putSLEB128 :: forall a. (Integral a, Bits a) =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var hs-var">putSLEB128</span></a></span></span><span> </span><span id="local-6989586621682485623"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485623"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485624"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485624"><span class="hs-identifier hs-var">initial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621682485625"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485624"><span class="hs-identifier hs-var">initial</span></a></span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-799"></span><span>    </span><span class="annot"><a href="#local-6989586621682485625"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682484006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621682485625"><span class="annot"><span class="annottext">go :: a -&gt; IO ()
</span><a href="#local-6989586621682485625"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485626"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485626"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-801"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485627"><span class="annot"><span class="annottext">byte :: Word8
</span><a href="#local-6989586621682485627"><span class="hs-identifier hs-var hs-var hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. (Num a, Bits a) =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485626"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-802"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485628"><span class="annot"><span class="annottext">val' :: a
</span><a href="#local-6989586621682485628"><span class="hs-identifier hs-var hs-var hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485626"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-803"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485629"><span class="annot"><span class="annottext">signBit :: Bool
</span><a href="#local-6989586621682485629"><span class="hs-identifier hs-var hs-var hs-var">signBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485627"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-804"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485630"><span class="annot"><span class="annottext">done :: Bool
</span><a href="#local-6989586621682485630"><span class="hs-identifier hs-var hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-805"></span><span>                </span><span class="hs-comment">-- Unsigned value, val' == 0 and last value can</span><span>
</span><span id="line-806"></span><span>                </span><span class="hs-comment">-- be discriminated from a negative number.</span><span>
</span><span id="line-807"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485628"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485629"><span class="hs-identifier hs-var">signBit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-808"></span><span>                </span><span class="hs-comment">-- Signed value,</span><span>
</span><span id="line-809"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485628"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485629"><span class="hs-identifier hs-var">signBit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485633"><span class="annot"><span class="annottext">byte' :: Word8
</span><a href="#local-6989586621682485633"><span class="hs-identifier hs-var hs-var hs-var">byte'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485630"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485627"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. (Num a, Bits a) =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#setBit"><span class="hs-identifier hs-var">setBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485627"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-812"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485623"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485633"><span class="hs-identifier hs-var">byte'</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485630"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621682485625"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485628"><span class="hs-identifier hs-var">val'</span></a></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-817"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word64</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-818"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word32</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-819"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word16</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-820"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-821"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int64</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-822"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int32</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-823"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-pragma hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int16</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-824"></span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-type">getSLEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484008"><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-825"></span><span id="getSLEB128"><span class="annot"><span class="annottext">getSLEB128 :: forall a.
(Show a, Integral a, FiniteBits a) =&gt;
ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var hs-var">getSLEB128</span></a></span></span><span> </span><span id="local-6989586621682485662"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485662"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682485663"><span class="annot"><a href="#local-6989586621682485663"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682485664"><span class="annot"><a href="#local-6989586621682485664"><span class="hs-identifier hs-var">shift</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682485665"><span class="annot"><a href="#local-6989586621682485665"><span class="hs-identifier hs-var">signed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO (a, Int, Bool)
</span><a href="#local-6989586621682485666"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682485665"><span class="hs-identifier hs-type">signed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485664"><span class="hs-identifier hs-type">shift</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">finiteBitSize</span></span><span> </span><span class="annot"><a href="#local-6989586621682485663"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">complement</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`unsafeShiftL`</span></span><span> </span><span class="annot"><a href="#local-6989586621682485664"><span class="hs-identifier hs-type">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.|.</span></span><span> </span><span class="annot"><a href="#local-6989586621682485663"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682485663"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-831"></span><span>        </span><span class="annot"><a href="#local-6989586621682485666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>        </span><span id="local-6989586621682485666"><span class="annot"><span class="annottext">go :: Int -&gt; a -&gt; IO (a, Int, Bool)
</span><a href="#local-6989586621682485666"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682485669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485669"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621682485670"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485670"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-833"></span><span>            </span><span id="local-6989586621682485671"><span class="annot"><a href="#local-6989586621682485671"><span class="hs-identifier hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485662"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-834"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485672"><span class="annot"><a href="#local-6989586621682485672"><span class="hs-identifier hs-var hs-var">byteVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. (Num a, Bits a) =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485671"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682484008"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-835"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485673"><span class="annot"><a href="#local-6989586621682485673"><span class="hs-identifier hs-var hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485670"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682485672"><span class="hs-identifier hs-var">byteVal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485669"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485674"><span class="annot"><a href="#local-6989586621682485674"><span class="hs-identifier hs-var hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485671"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-837"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485675"><span class="annot"><a href="#local-6989586621682485675"><span class="hs-identifier hs-var hs-var">shift'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485669"><span class="hs-identifier hs-var">shift</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-838"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682485674"><span class="hs-identifier hs-type">more</span></a></span><span>
</span><span id="line-839"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682485666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485675"><span class="hs-identifier hs-type">shift'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682485673"><span class="hs-identifier hs-type">val'</span></a></span><span>
</span><span id="line-840"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-841"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485676"><span class="annot"><a href="#local-6989586621682485676"><span class="hs-identifier hs-var hs-var">signed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485671"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-842"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485673"><span class="hs-identifier hs-type">val'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682485675"><span class="hs-identifier hs-type">shift'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682485676"><span class="hs-identifier hs-type">signed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- Fixed length encoding instances</span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="hs-comment">-- Sometimes words are used to represent a certain bit pattern instead</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- of a number. Using FixedLengthEncoding we will write the pattern as</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- is to the interface file without the variable length encoding we usually</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- apply.</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="hs-comment">-- | Encode the argument in its full length. This is different from many default</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- binary instances which make no guarantee about the actual encoding and</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- might do things using variable length encoding.</span><span>
</span><span id="line-855"></span><span class="hs-keyword">newtype</span><span> </span><span id="FixedLengthEncoding"><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span></span><span> </span><span id="local-6989586621682484010"><span class="annot"><a href="#local-6989586621682484010"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FixedLengthEncoding"><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFixedLength"><span class="annot"><span class="annottext">forall a. FixedLengthEncoding a -&gt; a
</span><a href="GHC.Utils.Binary.html#unFixedLength"><span class="hs-identifier hs-var hs-var">unFixedLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682484010"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682485681"><span id="local-6989586621682485685"><span class="annot"><span class="annottext">FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
(FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; (FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; Eq (FixedLengthEncoding a)
forall a.
Eq a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a.
Eq a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
== :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
$c/= :: forall a.
Eq a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
/= :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621682485694"><span id="local-6989586621682485698"><span id="local-6989586621682485702"><span id="local-6989586621682485706"><span id="local-6989586621682485710"><span id="local-6989586621682485714"><span id="local-6989586621682485718"><span class="annot"><span class="annottext">Eq (FixedLengthEncoding a)
Eq (FixedLengthEncoding a) =&gt;
(FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Ordering)
-&gt; (FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; (FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; (FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; (FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool)
-&gt; (FixedLengthEncoding a
    -&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a)
-&gt; (FixedLengthEncoding a
    -&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a)
-&gt; Ord (FixedLengthEncoding a)
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Ordering
FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (FixedLengthEncoding a)
forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Ordering
forall a.
Ord a =&gt;
FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
$ccompare :: forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Ordering
compare :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Ordering
$c&lt; :: forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
&lt; :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
$c&lt;= :: forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
&lt;= :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
$c&gt; :: forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
&gt; :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
$c&gt;= :: forall a.
Ord a =&gt;
FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
&gt;= :: FixedLengthEncoding a -&gt; FixedLengthEncoding a -&gt; Bool
$cmax :: forall a.
Ord a =&gt;
FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
max :: FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
$cmin :: forall a.
Ord a =&gt;
FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
min :: FixedLengthEncoding a
-&gt; FixedLengthEncoding a -&gt; FixedLengthEncoding a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621682485725"><span id="local-6989586621682485729"><span id="local-6989586621682485733"><span class="annot"><span class="annottext">Int -&gt; FixedLengthEncoding a -&gt; ShowS
[FixedLengthEncoding a] -&gt; ShowS
FixedLengthEncoding a -&gt; String
(Int -&gt; FixedLengthEncoding a -&gt; ShowS)
-&gt; (FixedLengthEncoding a -&gt; String)
-&gt; ([FixedLengthEncoding a] -&gt; ShowS)
-&gt; Show (FixedLengthEncoding a)
forall a. Show a =&gt; Int -&gt; FixedLengthEncoding a -&gt; ShowS
forall a. Show a =&gt; [FixedLengthEncoding a] -&gt; ShowS
forall a. Show a =&gt; FixedLengthEncoding a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FixedLengthEncoding a -&gt; ShowS
showsPrec :: Int -&gt; FixedLengthEncoding a -&gt; ShowS
$cshow :: forall a. Show a =&gt; FixedLengthEncoding a -&gt; String
show :: FixedLengthEncoding a -&gt; String
$cshowList :: forall a. Show a =&gt; [FixedLengthEncoding a] -&gt; ShowS
showList :: [FixedLengthEncoding a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485737"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-860"></span><span>  </span><span id="local-6989586621682485741"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; FixedLengthEncoding Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485742"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485742"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621682485743"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485743"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485742"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485743"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-861"></span><span>  </span><span id="local-6989586621682485745"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (FixedLengthEncoding Word8)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485746"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485746"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; FixedLengthEncoding Word8
forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; FixedLengthEncoding Word8)
-&gt; IO Word8 -&gt; IO (FixedLengthEncoding Word8)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485746"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485749"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-864"></span><span>  </span><span id="local-6989586621682485753"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; FixedLengthEncoding Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485754"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485754"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621682485755"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682485755"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485754"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682485755"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-865"></span><span>  </span><span id="local-6989586621682485757"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (FixedLengthEncoding Word16)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485758"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485758"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; FixedLengthEncoding Word16
forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; FixedLengthEncoding Word16)
-&gt; IO Word16 -&gt; IO (FixedLengthEncoding Word16)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word16
</span><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485758"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485761"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-868"></span><span>  </span><span id="local-6989586621682485765"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; FixedLengthEncoding Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485766"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485766"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621682485767"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485767"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var">putWord32</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485766"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682485767"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-869"></span><span>  </span><span id="local-6989586621682485769"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (FixedLengthEncoding Word32)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485770"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485770"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FixedLengthEncoding Word32
forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; FixedLengthEncoding Word32)
-&gt; IO Word32 -&gt; IO (FixedLengthEncoding Word32)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var">getWord32</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485770"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-870"></span><span>
</span><span id="line-871"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485773"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621682485777"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; FixedLengthEncoding Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485778"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485778"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621682485779"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485779"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-var">putWord64</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485778"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682485779"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-873"></span><span>  </span><span id="local-6989586621682485781"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (FixedLengthEncoding Word64)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485782"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485782"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FixedLengthEncoding Word64
forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; FixedLengthEncoding Word64)
-&gt; IO Word64 -&gt; IO (FixedLengthEncoding Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word64
</span><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-var">getWord64</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485782"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- Primitive Word writes</span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485785"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-879"></span><span>  </span><span id="local-6989586621682485789"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485790"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485790"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682485791"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485791"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485790"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682485791"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-880"></span><span>  </span><span id="local-6989586621682485792"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485795"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-883"></span><span>  </span><span id="local-6989586621682485801"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word16 -&gt; IO ()
forall a.
(Integral a, FiniteBits a) =&gt;
WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-884"></span><span>  </span><span id="local-6989586621682485804"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Word16
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word16
forall a. (Integral a, FiniteBits a) =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485807"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-887"></span><span>  </span><span id="local-6989586621682485812"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
forall a.
(Integral a, FiniteBits a) =&gt;
WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-888"></span><span>  </span><span id="local-6989586621682485815"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
forall a. (Integral a, FiniteBits a) =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485818"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-891"></span><span>  </span><span id="local-6989586621682485824"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word64 -&gt; IO ()
forall a.
(Integral a, FiniteBits a) =&gt;
WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-892"></span><span>  </span><span id="local-6989586621682485827"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Word64
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word64
forall a. (Integral a, FiniteBits a) =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- Primitive Int writes</span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485830"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-898"></span><span>  </span><span id="local-6989586621682485838"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Int8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485839"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485839"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682485840"><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621682485840"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485839"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int8 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621682485840"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>  </span><span id="local-6989586621682485847"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Int8
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485848"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485848"><span class="hs-identifier hs-var">h</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485849"><span class="annot"><a href="#local-6989586621682485849"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485848"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485849"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485852"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-902"></span><span>  </span><span id="local-6989586621682485858"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Int16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int16 -&gt; IO ()
forall a. (Integral a, Bits a) =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span>
</span><span id="line-903"></span><span>  </span><span id="local-6989586621682485862"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Int16
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int16
forall a.
(Show a, Integral a, FiniteBits a) =&gt;
ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485865"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-906"></span><span>  </span><span id="local-6989586621682485871"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Int32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int32 -&gt; IO ()
forall a. (Integral a, Bits a) =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621682485875"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Int32
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int32
forall a.
(Show a, Integral a, FiniteBits a) =&gt;
ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485878"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-910"></span><span>  </span><span id="local-6989586621682485884"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Int64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485885"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485885"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621682485886"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682485886"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int64 -&gt; IO ()
forall a. (Integral a, Bits a) =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485885"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621682485886"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-911"></span><span>  </span><span id="local-6989586621682485890"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Int64
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485891"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485891"><span class="hs-identifier hs-var">h</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int64
forall a.
(Show a, Integral a, FiniteBits a) =&gt;
ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485891"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- Instances for standard types</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485894"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-917"></span><span>    </span><span id="local-6989586621682485899"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; () -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>    </span><span id="local-6989586621682485901"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="annot"><span class="annottext">ReadBinHandle
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485904"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-921"></span><span>    </span><span id="local-6989586621682485912"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Bool -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485913"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485913"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485914"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485914"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485913"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682485914"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>    </span><span id="local-6989586621682485921"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Bool
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621682485922"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485922"><span class="hs-identifier hs-var">bh</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485923"><span class="annot"><a href="#local-6989586621682485923"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485922"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">toEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682485923"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485927"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-925"></span><span>    </span><span id="local-6989586621682485934"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Char -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span>  </span><span id="local-6989586621682485935"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485935"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485936"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682485936"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485935"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682485936"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>    </span><span id="local-6989586621682485942"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Char
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621682485943"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485943"><span class="hs-identifier hs-var">bh</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682485944"><span class="annot"><a href="#local-6989586621682485944"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485943"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">chr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485944"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682485947"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621682485954"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Int -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485955"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485955"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485956"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int64 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485955"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485956"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>    </span><span id="local-6989586621682485962"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Int
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621682485963"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485963"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>        </span><span id="local-6989586621682485964"><span class="annot"><a href="#local-6989586621682485964"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int64
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485963"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-932"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485964"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484021"><span id="local-6989586621682485968"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682484021"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621682485978"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; [a] -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682485979"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485979"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682485980"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682485980"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682485981"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621682485981"><span class="hs-identifier hs-var hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682485980"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-937"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485979"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485981"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-938"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; IO ()) -&gt; [a] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682485979"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682485980"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-939"></span><span>    </span><span id="local-6989586621682485995"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO [a]
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682485996"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485996"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-940"></span><span>        </span><span id="local-6989586621682485997"><span class="annot"><a href="#local-6989586621682485997"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485996"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Int is variable length encoded so only</span><span>
</span><span id="line-941"></span><span>                                </span><span class="hs-comment">-- one byte for small lists.</span><span>
</span><span id="line-942"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682485998"><span class="annot"><a href="#local-6989586621682485998"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; IO [a]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-943"></span><span>            </span><span class="annot"><a href="#local-6989586621682485998"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621682485999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682485999"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486000"><span class="annot"><a href="#local-6989586621682486000"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682485996"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682486001"><span class="annot"><a href="#local-6989586621682486001"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682485998"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682485999"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486000"><span class="hs-identifier hs-type">a</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621682486001"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>        </span><span class="annot"><a href="#local-6989586621682485998"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682485997"><span class="hs-identifier hs-type">len</span></a></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="hs-comment">-- | This instance doesn't rely on the determinism of the keys' 'Ord' instance,</span><span>
</span><span id="line-947"></span><span class="hs-comment">-- so it works e.g. for 'Name's too.</span><span>
</span><span id="line-948"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484030"><span id="local-6989586621682486006"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682484030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-949"></span><span>  </span><span id="local-6989586621682486011"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Set a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486012"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486012"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486013"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682486013"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; [a] -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486012"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a -&gt; [a]
forall a. Set a -&gt; [a]
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682486013"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>  </span><span id="local-6989586621682486018"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Set a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486019"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486019"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Set a
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Set a) -&gt; IO [a] -&gt; IO (Set a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO [a]
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486019"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484034"><span id="local-6989586621682486024"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621682484034"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-953"></span><span>    </span><span id="local-6989586621682486029"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; NonEmpty a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486030"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486030"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; [a] -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486030"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; IO ()) -&gt; (NonEmpty a -&gt; [a]) -&gt; NonEmpty a -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty a -&gt; [a]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#toList"><span class="hs-identifier hs-var">NonEmpty.toList</span></a></span><span>
</span><span id="line-954"></span><span>    </span><span id="local-6989586621682486037"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (NonEmpty a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486038"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486038"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; NonEmpty a
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#fromList"><span class="hs-identifier hs-var">NonEmpty.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; NonEmpty a) -&gt; IO [a] -&gt; IO (NonEmpty a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO [a]
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486038"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484042"><span id="local-6989586621682484043"><span id="local-6989586621682486045"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ix</span></span><span> </span><span class="annot"><a href="#local-6989586621682484042"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484042"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484043"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><a href="#local-6989586621682484042"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484043"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-957"></span><span>    </span><span id="local-6989586621682486053"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Array a b -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486054"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486054"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486055"><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621682486055"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-958"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; (a, a) -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486054"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; IO ()) -&gt; (a, a) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Array a b -&gt; (a, a)
forall i e. Array i e -&gt; (i, i)
</span><span class="hs-identifier hs-var">bounds</span></span><span> </span><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621682486055"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-959"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; [b] -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486054"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; IO ()) -&gt; [b] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Array a b -&gt; [b]
forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621682486055"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-960"></span><span>    </span><span id="local-6989586621682486064"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Array a b)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486065"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486065"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-961"></span><span>        </span><span id="local-6989586621682486066"><span class="annot"><a href="#local-6989586621682486066"><span class="hs-identifier hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (a, a)
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486065"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-962"></span><span>        </span><span id="local-6989586621682486067"><span class="annot"><a href="#local-6989586621682486067"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486065"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-963"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">listArray</span></span><span> </span><span class="annot"><a href="#local-6989586621682486066"><span class="hs-identifier hs-type">bounds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486067"><span class="hs-identifier hs-type">xs</span></a></span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484044"><span id="local-6989586621682484045"><span id="local-6989586621682486073"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484045"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484045"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-966"></span><span>    </span><span id="local-6989586621682486079"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486080"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486080"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486081"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486081"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486082"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486082"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486080"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486081"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486080"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486082"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-967"></span><span>    </span><span id="local-6989586621682486088"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486089"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486089"><span class="hs-identifier hs-var">bh</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486090"><span class="annot"><a href="#local-6989586621682486090"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486089"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-968"></span><span>                       </span><span id="local-6989586621682486091"><span class="annot"><a href="#local-6989586621682486091"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486089"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-969"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486091"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>
</span><span id="line-971"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484057"><span id="local-6989586621682484058"><span id="local-6989586621682484059"><span id="local-6989586621682486097"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484058"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484059"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484058"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484059"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-972"></span><span>    </span><span id="local-6989586621682486106"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b, c) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486107"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486107"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486108"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486108"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486109"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486109"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486110"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486110"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486107"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486108"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486107"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486109"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; c -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486107"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486110"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-973"></span><span>    </span><span id="local-6989586621682486118"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b, c)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486119"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486119"><span class="hs-identifier hs-var">bh</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486120"><span class="annot"><a href="#local-6989586621682486120"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486119"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-974"></span><span>                         </span><span id="local-6989586621682486121"><span class="annot"><a href="#local-6989586621682486121"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486119"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-975"></span><span>                         </span><span id="local-6989586621682486122"><span class="annot"><a href="#local-6989586621682486122"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486119"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-976"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486120"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486121"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486122"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484064"><span id="local-6989586621682484065"><span id="local-6989586621682484066"><span id="local-6989586621682484067"><span id="local-6989586621682486129"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484065"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484066"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484067"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484065"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484066"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484067"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-979"></span><span>    </span><span id="local-6989586621682486140"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b, c, d) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486141"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486141"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486142"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486142"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486143"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486143"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486144"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486144"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486145"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486145"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486141"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486142"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486141"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486143"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; c -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486141"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486144"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; d -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486141"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486145"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-980"></span><span>    </span><span id="local-6989586621682486155"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b, c, d)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486156"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486156"><span class="hs-identifier hs-var">bh</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486157"><span class="annot"><a href="#local-6989586621682486157"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-981"></span><span>                           </span><span id="local-6989586621682486158"><span class="annot"><a href="#local-6989586621682486158"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486156"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-982"></span><span>                           </span><span id="local-6989586621682486159"><span class="annot"><a href="#local-6989586621682486159"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486156"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-983"></span><span>                           </span><span id="local-6989586621682486160"><span class="annot"><a href="#local-6989586621682486160"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486156"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-984"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486157"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486158"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486159"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486160"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>
</span><span id="line-986"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484073"><span id="local-6989586621682484074"><span id="local-6989586621682484075"><span id="local-6989586621682484076"><span id="local-6989586621682484077"><span id="local-6989586621682486168"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484074"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484075"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484076"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484077"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484074"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484075"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484076"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682484077"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-987"></span><span>    </span><span id="local-6989586621682486181"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b, c, d, e) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486182"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486183"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486183"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486184"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486184"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486185"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486185"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486186"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486186"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682486187"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486187"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486183"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486184"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; c -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486185"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; d -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486186"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; e -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486182"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486187"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-988"></span><span>    </span><span id="local-6989586621682486199"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b, c, d, e)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486200"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486200"><span class="hs-identifier hs-var">bh</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486201"><span class="annot"><a href="#local-6989586621682486201"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486200"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-989"></span><span>                              </span><span id="local-6989586621682486202"><span class="annot"><a href="#local-6989586621682486202"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486200"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-990"></span><span>                              </span><span id="local-6989586621682486203"><span class="annot"><a href="#local-6989586621682486203"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486200"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-991"></span><span>                              </span><span id="local-6989586621682486204"><span class="annot"><a href="#local-6989586621682486204"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486200"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-992"></span><span>                              </span><span id="local-6989586621682486205"><span class="annot"><a href="#local-6989586621682486205"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486200"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-993"></span><span>                              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486202"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486203"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486204"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486205"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484084"><span id="local-6989586621682484085"><span id="local-6989586621682484086"><span id="local-6989586621682484087"><span id="local-6989586621682484088"><span id="local-6989586621682484089"><span id="local-6989586621682486214"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484084"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484085"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484086"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484087"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484088"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484089"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484084"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484085"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484086"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484087"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682484088"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682484089"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-996"></span><span>    </span><span id="local-6989586621682486229"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b, c, d, e, f) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486230"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486231"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486231"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486232"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486232"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486233"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486233"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486234"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486234"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682486235"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486235"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682486236"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621682486236"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486231"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486232"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; c -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486233"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; d -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486234"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; e -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486235"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; f -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486230"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621682486236"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-997"></span><span>    </span><span id="local-6989586621682486250"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b, c, d, e, f)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486251"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486251"><span class="hs-identifier hs-var">bh</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486252"><span class="annot"><a href="#local-6989586621682486252"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486251"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-998"></span><span>                                 </span><span id="local-6989586621682486253"><span class="annot"><a href="#local-6989586621682486253"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486251"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-999"></span><span>                                 </span><span id="local-6989586621682486254"><span class="annot"><a href="#local-6989586621682486254"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486251"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1000"></span><span>                                 </span><span id="local-6989586621682486255"><span class="annot"><a href="#local-6989586621682486255"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486251"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1001"></span><span>                                 </span><span id="local-6989586621682486256"><span class="annot"><a href="#local-6989586621682486256"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486251"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1002"></span><span>                                 </span><span id="local-6989586621682486257"><span class="annot"><a href="#local-6989586621682486257"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486251"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1003"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486252"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486253"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486254"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486255"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486256"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486257"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1004"></span><span>
</span><span id="line-1005"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484097"><span id="local-6989586621682484098"><span id="local-6989586621682484099"><span id="local-6989586621682484100"><span id="local-6989586621682484101"><span id="local-6989586621682484102"><span id="local-6989586621682484103"><span id="local-6989586621682486267"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484099"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484100"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484101"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484102"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484103"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484099"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484100"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484101"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484102"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484103"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1006"></span><span>    </span><span id="local-6989586621682486284"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; (a, b, c, d, e, f, g) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486285"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486286"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486286"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486287"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486287"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486288"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486288"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486289"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486289"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486290"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486290"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486291"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621682486291"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682486292"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621682486292"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486286"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486287"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; c -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621682486288"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; d -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621682486289"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; e -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682486290"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; f -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621682486291"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; g -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486285"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621682486292"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1007"></span><span>    </span><span id="local-6989586621682486308"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (a, b, c, d, e, f, g)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486309"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486309"><span class="hs-identifier hs-var">bh</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486310"><span class="annot"><a href="#local-6989586621682486310"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486309"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1008"></span><span>                                 </span><span id="local-6989586621682486311"><span class="annot"><a href="#local-6989586621682486311"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1009"></span><span>                                 </span><span id="local-6989586621682486312"><span class="annot"><a href="#local-6989586621682486312"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1010"></span><span>                                 </span><span id="local-6989586621682486313"><span class="annot"><a href="#local-6989586621682486313"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1011"></span><span>                                 </span><span id="local-6989586621682486314"><span class="annot"><a href="#local-6989586621682486314"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1012"></span><span>                                 </span><span id="local-6989586621682486315"><span class="annot"><a href="#local-6989586621682486315"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1013"></span><span>                                 </span><span id="local-6989586621682486316"><span class="annot"><a href="#local-6989586621682486316"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486309"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1014"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486310"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486311"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486312"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486313"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486314"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486315"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486316"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>
</span><span id="line-1016"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484105"><span id="local-6989586621682486320"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484105"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682484105"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1017"></span><span>    </span><span id="local-6989586621682486328"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Maybe a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486329"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486329"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486329"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1018"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621682486330"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486330"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682486331"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486331"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486330"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486330"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486331"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1019"></span><span>    </span><span id="local-6989586621682486340"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Maybe a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486341"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486341"><span class="hs-identifier hs-var">bh</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486342"><span class="annot"><a href="#local-6989586621682486342"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486341"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1020"></span><span>                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486342"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1021"></span><span>                            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1022"></span><span>                            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486343"><span class="annot"><a href="#local-6989586621682486343"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486341"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621682486343"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484108"><span id="local-6989586621682486347"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484108"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Strict.html#Maybe"><span class="hs-identifier hs-type">Strict.Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1025"></span><span>    </span><span id="local-6989586621682486355"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Maybe a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486356"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486356"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="GHC.Data.Strict.html#Nothing"><span class="hs-identifier hs-var">Strict.Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486356"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1026"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621682486358"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486358"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Strict.html#Just"><span class="hs-identifier hs-type">Strict.Just</span></a></span><span> </span><span id="local-6989586621682486360"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486360"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486358"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486358"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486360"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1027"></span><span>    </span><span id="local-6989586621682486368"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Maybe a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486369"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486369"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1028"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486370"><span class="annot"><a href="#local-6989586621682486370"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486369"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1029"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486370"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1030"></span><span>           </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="GHC.Data.Strict.html#Nothing"><span class="hs-identifier hs-var">Strict.Nothing</span></a></span><span>
</span><span id="line-1031"></span><span>           </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486371"><span class="annot"><a href="#local-6989586621682486371"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486369"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.Strict.html#Just"><span class="hs-identifier hs-type">Strict.Just</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486371"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484112"><span id="local-6989586621682484113"><span id="local-6989586621682486376"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484112"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484113"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621682484112"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484113"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1034"></span><span>    </span><span id="local-6989586621682486386"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Either a b -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486387"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486387"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621682486388"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486388"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486387"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486387"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486388"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1035"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621682486389"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486389"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682486390"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486390"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486389"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; b -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486389"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486390"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1036"></span><span>    </span><span id="local-6989586621682486400"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Either a b)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486401"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486401"><span class="hs-identifier hs-var">bh</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486402"><span class="annot"><a href="#local-6989586621682486402"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486401"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1037"></span><span>                           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486402"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1038"></span><span>                             </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486403"><span class="annot"><a href="#local-6989586621682486403"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486401"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><a href="#local-6989586621682486403"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>                             </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486404"><span class="annot"><a href="#local-6989586621682486404"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO b
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486401"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621682486404"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682486407"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1042"></span><span>    </span><span id="local-6989586621682486416"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; UTCTime -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486417"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486417"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486418"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682486418"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Day -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486417"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682486418"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>                   </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; DiffTime -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486417"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; DiffTime
</span><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#utctDayTime"><span class="hs-identifier hs-var">utctDayTime</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621682486418"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>    </span><span id="local-6989586621682486426"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO UTCTime
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486427"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486427"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486428"><span class="annot"><a href="#local-6989586621682486428"><span class="hs-identifier hs-var">day</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Day
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486427"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1045"></span><span>                </span><span id="local-6989586621682486429"><span class="annot"><a href="#local-6989586621682486429"><span class="hs-identifier hs-var">dayTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486427"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1046"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486428"><span class="hs-identifier hs-type">day</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.UTCTime.html#utctDayTime"><span class="hs-identifier hs-var">utctDayTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486429"><span class="hs-identifier hs-type">dayTime</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682486433"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Calendar.Days.html#Day"><span class="hs-identifier hs-type">Day</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1049"></span><span>    </span><span id="local-6989586621682486438"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Day -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486439"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486439"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486440"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621682486440"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Integer -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486439"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><a href="../../time-1.14-9bf8/src/Data.Time.Calendar.Days.html#toModifiedJulianDay"><span class="hs-identifier hs-var">toModifiedJulianDay</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621682486440"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span>    </span><span id="local-6989586621682486445"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Day
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486446"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486446"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486447"><span class="annot"><a href="#local-6989586621682486447"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Integer
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486446"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1051"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Calendar.Days.html#ModifiedJulianDay"><span class="hs-identifier hs-type">ModifiedJulianDay</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Calendar.Days.html#toModifiedJulianDay"><span class="hs-identifier hs-var">toModifiedJulianDay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486447"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682486451"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.14-9bf8/src/Data.Time.Clock.Internal.DiffTime.html#DiffTime"><span class="hs-identifier hs-type">DiffTime</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1054"></span><span>    </span><span id="local-6989586621682486459"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; DiffTime -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486460"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486460"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486461"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621682486461"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Rational -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486460"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiffTime -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621682486461"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>    </span><span id="local-6989586621682486468"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO DiffTime
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486469"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486469"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486470"><span class="annot"><a href="#local-6989586621682486470"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Rational
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486469"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1056"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromRational</span></span><span> </span><span class="annot"><a href="#local-6989586621682486470"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682486473"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPointHood"><span class="hs-identifier hs-type">JoinPointHood</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1059"></span><span>    </span><span id="local-6989586621682486481"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; JoinPointHood -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486482"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486482"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><span class="annottext">JoinPointHood
</span><a href="GHC.Utils.Outputable.html#NotJoinPoint"><span class="hs-identifier hs-var">NotJoinPoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486482"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1060"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621682486484"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486484"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span id="local-6989586621682486486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486486"><span class="hs-identifier hs-var">ar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1061"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486484"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1062"></span><span>        </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486484"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486486"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-1063"></span><span>    </span><span id="local-6989586621682486494"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO JoinPointHood
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486495"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486495"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1064"></span><span>        </span><span id="local-6989586621682486496"><span class="annot"><a href="#local-6989586621682486496"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486495"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1065"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486496"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1066"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JoinPointHood -&gt; IO JoinPointHood
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">JoinPointHood
</span><a href="GHC.Utils.Outputable.html#NotJoinPoint"><span class="hs-identifier hs-var">NotJoinPoint</span></a></span><span>
</span><span id="line-1067"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682486497"><span class="annot"><a href="#local-6989586621682486497"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486495"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#JoinPoint"><span class="hs-identifier hs-type">JoinPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486497"><span class="hs-identifier hs-type">ar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span class="hs-comment">{-
Finally - a reasonable portable Integer instance.

We used to encode values in the Int32 range as such,
falling back to a string of all things. In either case
we stored a tag byte to discriminate between the two cases.

This made some sense as it's highly portable but also not very
efficient.

However GHC stores a surprisingly large number of large Integer
values. In the examples looked at between 25% and 50% of Integers
serialized were outside of the Int32 range.

Consider a value like `2724268014499746065`, some sort of hash
actually generated by GHC.
In the old scheme this was encoded as a list of 19 chars. This
gave a size of 77 Bytes, one for the length of the list and 76
since we encode chars as Word32 as well.

We can easily do better. The new plan is:

* Start with a tag byte
  * 0 =&gt; Int64 (LEB128 encoded)
  * 1 =&gt; Negative large integer
  * 2 =&gt; Positive large integer
* Followed by the value:
  * Int64 is encoded as usual
  * Large integers are encoded as a list of bytes (Word8).
    We use Data.Bits which defines a bit order independent of the representation.
    Values are stored LSB first.

This means our example value `2724268014499746065` is now only 10 bytes large.
* One byte tag
* One byte for the length of the [Word8] list.
* 8 bytes for the actual date.

The new scheme also does not depend in any way on
architecture specific details.

We still use this scheme even with LEB128 available,
as it has less overhead for truly large numbers. (&gt; maxBound :: Int64)

The instance is used for in Binary Integer and Binary Rational in GHC.Types.Literal
-}</span><span>
</span><span id="line-1114"></span><span>
</span><span id="line-1115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682486500"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1116"></span><span>    </span><span id="local-6989586621682486519"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Integer -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486520"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486521"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1117"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486522"><span class="hs-identifier hs-var">lo64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486523"><span class="hs-identifier hs-var">hi64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1118"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1119"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int64 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-1120"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1121"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1122"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1123"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1124"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; [Word8] -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486520"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; [Word8]
</span><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-var">unroll</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; [Word8]) -&gt; Integer -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682486521"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1125"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1126"></span><span>        </span><span id="local-6989586621682486522"><span class="annot"><span class="annottext">lo64 :: Integer
</span><a href="#local-6989586621682486522"><span class="hs-identifier hs-var hs-var">lo64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>        </span><span id="local-6989586621682486523"><span class="annot"><span class="annottext">hi64 :: Integer
</span><a href="#local-6989586621682486523"><span class="hs-identifier hs-var hs-var">hi64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>    </span><span id="local-6989586621682486551"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Integer
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486552"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486552"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1129"></span><span>      </span><span id="local-6989586621682486553"><span class="annot"><a href="#local-6989586621682486553"><span class="hs-identifier hs-var">int_kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486552"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1130"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486553"><span class="hs-identifier hs-type">int_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1131"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Integer) -&gt; IO Int64 -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int64
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486552"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-1132"></span><span>        </span><span class="hs-comment">-- Large integer</span><span>
</span><span id="line-1133"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; IO Integer -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><a href="#local-6989586621682486554"><span class="hs-identifier hs-var">getInt</span></a></span><span>
</span><span id="line-1134"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><a href="#local-6989586621682486554"><span class="hs-identifier hs-var">getInt</span></a></span><span>
</span><span id="line-1135"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binary Integer - Invalid byte&quot;</span></span><span>
</span><span id="line-1136"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1137"></span><span>          </span><span class="annot"><a href="#local-6989586621682486554"><span class="hs-identifier hs-type">getInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1138"></span><span>          </span><span id="local-6989586621682486554"><span class="annot"><span class="annottext">getInt :: IO Integer
</span><a href="#local-6989586621682486554"><span class="hs-identifier hs-var hs-var">getInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Integer
</span><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-var">roll</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Integer) -&gt; IO [Word8] -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO [Word8]
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486552"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span class="annot"><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-type">unroll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-1141"></span><span id="unroll"><span class="annot"><span class="annottext">unroll :: Integer -&gt; [Word8]
</span><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-var hs-var">unroll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Maybe (Word8, Integer)) -&gt; Integer -&gt; [Word8]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe (Word8, Integer)
forall {b} {a}. (Integral b, Num a, Bits b) =&gt; b -&gt; Maybe (a, b)
</span><a href="#local-6989586621682486556"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-1142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1143"></span><span>    </span><span id="local-6989586621682486556"><span class="annot"><span class="annottext">step :: b -&gt; Maybe (a, b)
</span><a href="#local-6989586621682486556"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1144"></span><span>    </span><span class="annot"><a href="#local-6989586621682486556"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span id="local-6989586621682486577"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486577"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; Maybe (a, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486577"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682486577"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>
</span><span id="line-1146"></span><span class="annot"><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-type">roll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1147"></span><span id="roll"><span class="annot"><span class="annottext">roll :: [Word8] -&gt; Integer
</span><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-var hs-var">roll</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Word8 -&gt; Integer) -&gt; Integer -&gt; [Word8] -&gt; Integer
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word8 -&gt; Integer
forall {a} {a}. (Bits a, Integral a, Num a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621682486579"><span class="hs-identifier hs-var">unstep</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Integer) -&gt; ([Word8] -&gt; [Word8]) -&gt; [Word8] -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; [Word8]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-1148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1149"></span><span>    </span><span id="local-6989586621682486579"><span class="annot"><span class="annottext">unstep :: a -&gt; a -&gt; a
</span><a href="#local-6989586621682486579"><span class="hs-identifier hs-var hs-var">unstep</span></a></span></span><span> </span><span id="local-6989586621682486600"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486600"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682486601"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486601"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486600"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486601"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span>
</span><span id="line-1152"></span><span>    </span><span class="hs-comment">{-
    -- This code is currently commented out.
    -- See https://gitlab.haskell.org/ghc/ghc/issues/3379#note_104346 for
    -- discussion.

    put_ bh (S# i#) = do putByte bh 0; put_ bh (I# i#)
    put_ bh (J# s# a#) = do
        putByte bh 1
        put_ bh (I# s#)
        let sz# = sizeofByteArray# a#  -- in *bytes*
        put_ bh (I# sz#)  -- in *bytes*
        putByteArray bh a# sz#

    get bh = do
        b &lt;- getByte bh
        case b of
          0 -&gt; do (I# i#) &lt;- get bh
                  return (S# i#)
          _ -&gt; do (I# s#) &lt;- get bh
                  sz &lt;- get bh
                  (BA a#) &lt;- getByteArray bh sz
                  return (J# s# a#)

putByteArray :: BinHandle -&gt; ByteArray# -&gt; Int# -&gt; IO ()
putByteArray bh a s# = loop 0#
  where loop n#
           | n# ==# s# = return ()
           | otherwise = do
                putByte bh (indexByteArray a n#)
                loop (n# +# 1#)

getByteArray :: BinHandle -&gt; Int -&gt; IO ByteArray
getByteArray bh (I# sz) = do
  (MBA arr) &lt;- newByteArray sz
  let loop n
           | n ==# sz = return ()
           | otherwise = do
                w &lt;- getByte bh
                writeByteArray arr n w
                loop (n +# 1#)
  loop 0#
  freezeByteArray arr
    -}</span><span>
</span><span id="line-1195"></span><span>
</span><span id="line-1196"></span><span class="hs-comment">{-
data ByteArray = BA ByteArray#
data MBA = MBA (MutableByteArray# RealWorld)

newByteArray :: Int# -&gt; IO MBA
newByteArray sz = IO $ \s -&gt;
  case newByteArray# sz s of { (# s, arr #) -&gt;
  (# s, MBA arr #) }

freezeByteArray :: MutableByteArray# RealWorld -&gt; IO ByteArray
freezeByteArray arr = IO $ \s -&gt;
  case unsafeFreezeByteArray# arr s of { (# s, arr #) -&gt;
  (# s, BA arr #) }

writeByteArray :: MutableByteArray# RealWorld -&gt; Int# -&gt; Word8 -&gt; IO ()
writeByteArray arr i (W8# w) = IO $ \s -&gt;
  case writeWord8Array# arr i w s of { s -&gt;
  (# s, () #) }

indexByteArray :: ByteArray# -&gt; Int# -&gt; Word8
indexByteArray a# n# = W8# (indexWord8Array# a# n#)

-}</span><span>
</span><span id="line-1219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484119"><span id="local-6989586621682486605"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><a href="#local-6989586621682484119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1220"></span><span>    </span><span id="local-6989586621682486611"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Ratio a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486612"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486612"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486613"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486613"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span id="local-6989586621682486614"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486614"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486612"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486613"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486612"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486614"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1221"></span><span>    </span><span id="local-6989586621682486620"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Ratio a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486621"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486621"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486622"><span class="annot"><a href="#local-6989586621682486622"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486621"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682486623"><span class="annot"><a href="#local-6989586621682486623"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486621"><span class="hs-identifier hs-type">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span class="annot"><a href="#local-6989586621682486623"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span class="hs-comment">-- Instance uses fixed-width encoding to allow inserting</span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- Bin placeholders in the stream.</span><span>
</span><span id="line-1225"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484139"><span id="local-6989586621682486626"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484139"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1226"></span><span>  </span><span id="local-6989586621682486632"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486633"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486633"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span id="local-6989586621682486634"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486634"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var">putWord32</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486633"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486634"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>  </span><span id="local-6989586621682486639"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486640"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486640"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682486641"><span class="annot"><a href="#local-6989586621682486641"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var">getWord32</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486640"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486641"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>
</span><span id="line-1229"></span><span class="hs-comment">-- Instance uses fixed-width encoding to allow inserting</span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- Bin placeholders in the stream.</span><span>
</span><span id="line-1231"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682483922"><span id="local-6989586621682486644"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682483922"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1232"></span><span>  </span><span id="local-6989586621682486648"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; RelBinPtr a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682486649"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486649"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-type">RelBinPtr</span></a></span><span> </span><span id="local-6989586621682486650"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682486650"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Bin a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486649"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621682486650"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1233"></span><span>  </span><span id="local-6989586621682486653"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (RelBinPtr a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682486654"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486654"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bin a -&gt; RelBinPtr a
forall {k} (a :: k). Bin a -&gt; RelBinPtr a
</span><a href="GHC.Utils.Binary.html#RelBinPtr"><span class="hs-identifier hs-var">RelBinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Bin a -&gt; RelBinPtr a) -&gt; IO (Bin a) -&gt; IO (RelBinPtr a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (Bin a)
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486654"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1234"></span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- Forward reading/writing</span><span>
</span><span id="line-1237"></span><span>
</span><span id="line-1238"></span><span class="hs-comment">-- | @'forwardPut' put_A put_B@ outputs A after B but allows A to be read before B</span><span>
</span><span id="line-1239"></span><span class="hs-comment">-- by using a forward reference.</span><span>
</span><span id="line-1240"></span><span id="local-6989586621682484142"><span id="local-6989586621682484143"><span class="annot"><a href="GHC.Utils.Binary.html#forwardPut"><span class="hs-identifier hs-type">forwardPut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484142"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484142"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682484142"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1241"></span><span id="forwardPut"><span class="annot"><span class="annottext">forwardPut :: forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#forwardPut"><span class="hs-identifier hs-var hs-var">forwardPut</span></a></span></span><span> </span><span id="local-6989586621682486665"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486665"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486666"><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486666"><span class="hs-identifier hs-var">put_A</span></a></span></span><span> </span><span id="local-6989586621682486667"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486667"><span class="hs-identifier hs-var">put_B</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-comment">-- write placeholder pointer to A</span><span>
</span><span id="line-1243"></span><span>  </span><span id="local-6989586621682486668"><span class="annot"><a href="#local-6989586621682486668"><span class="hs-identifier hs-var">pre_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; IO (Bin (Bin (ZonkAny 5)))
forall {k} (a :: k). WriteBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-var">tellBinWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486665"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1244"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486665"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486668"><span class="hs-identifier hs-type">pre_a</span></a></span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span>  </span><span class="hs-comment">-- write B</span><span>
</span><span id="line-1247"></span><span>  </span><span id="local-6989586621682486669"><span class="annot"><a href="#local-6989586621682486669"><span class="hs-identifier hs-var">r_b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486667"><span class="hs-identifier hs-type">put_B</span></a></span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span>  </span><span class="hs-comment">-- update A's pointer</span><span>
</span><span id="line-1250"></span><span>  </span><span id="local-6989586621682486670"><span class="annot"><a href="#local-6989586621682486670"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-type">tellBinWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486665"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1251"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-type">putAt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486665"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486668"><span class="hs-identifier hs-type">pre_a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486670"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1252"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinNoExpandWriter"><span class="hs-identifier hs-type">seekBinNoExpandWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486665"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486670"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1253"></span><span>
</span><span id="line-1254"></span><span>  </span><span class="hs-comment">-- write A</span><span>
</span><span id="line-1255"></span><span>  </span><span id="local-6989586621682486671"><span class="annot"><a href="#local-6989586621682486671"><span class="hs-identifier hs-var">r_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486666"><span class="hs-identifier hs-type">put_A</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486669"><span class="hs-identifier hs-type">r_b</span></a></span><span>
</span><span id="line-1256"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486671"><span class="hs-identifier hs-type">r_a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486669"><span class="hs-identifier hs-type">r_b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span id="local-6989586621682484146"><span id="local-6989586621682484147"><span class="annot"><a href="GHC.Utils.Binary.html#forwardPut_"><span class="hs-identifier hs-type">forwardPut_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484146"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484146"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1259"></span><span id="forwardPut_"><span class="annot"><span class="annottext">forwardPut_ :: forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#forwardPut_"><span class="hs-identifier hs-var hs-var">forwardPut_</span></a></span></span><span> </span><span id="local-6989586621682486673"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486673"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486674"><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486674"><span class="hs-identifier hs-var">put_A</span></a></span></span><span> </span><span id="local-6989586621682486675"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486675"><span class="hs-identifier hs-var">put_B</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (a, b) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO (a, b) -&gt; IO ()) -&gt; IO (a, b) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#forwardPut"><span class="hs-identifier hs-var">forwardPut</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486673"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486674"><span class="hs-identifier hs-var">put_A</span></a></span><span> </span><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486675"><span class="hs-identifier hs-var">put_B</span></a></span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- | Read a value stored using a forward reference</span><span>
</span><span id="line-1262"></span><span class="hs-comment">--</span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- The forward reference is expected to be an absolute offset.</span><span>
</span><span id="line-1264"></span><span id="local-6989586621682484152"><span class="annot"><a href="GHC.Utils.Binary.html#forwardGet"><span class="hs-identifier hs-type">forwardGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484152"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1265"></span><span id="forwardGet"><span class="annot"><span class="annottext">forwardGet :: forall a. ReadBinHandle -&gt; IO a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#forwardGet"><span class="hs-identifier hs-var hs-var">forwardGet</span></a></span></span><span> </span><span id="local-6989586621682486683"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486683"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486684"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621682486684"><span class="hs-identifier hs-var">get_A</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1266"></span><span>    </span><span class="hs-comment">-- read forward reference</span><span>
</span><span id="line-1267"></span><span>    </span><span id="local-6989586621682486685"><span class="annot"><a href="#local-6989586621682486685"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (Bin (ZonkAny 1))
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486683"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-comment">-- a BinPtr</span><span>
</span><span id="line-1268"></span><span>    </span><span class="hs-comment">-- store current position</span><span>
</span><span id="line-1269"></span><span>    </span><span id="local-6989586621682486686"><span class="annot"><a href="#local-6989586621682486686"><span class="hs-identifier hs-var">p_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-type">tellBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486683"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1270"></span><span>    </span><span class="hs-comment">-- go read the forward value, then seek back</span><span>
</span><span id="line-1271"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486683"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486685"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-1272"></span><span>    </span><span id="local-6989586621682486687"><span class="annot"><a href="#local-6989586621682486687"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486684"><span class="hs-identifier hs-type">get_A</span></a></span><span>
</span><span id="line-1273"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486683"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486686"><span class="hs-identifier hs-type">p_a</span></a></span><span>
</span><span id="line-1274"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682486687"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1275"></span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- | @'forwardPutRel' put_A put_B@ outputs A after B but allows A to be read before B</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- by using a forward reference.</span><span>
</span><span id="line-1278"></span><span class="hs-comment">--</span><span>
</span><span id="line-1279"></span><span class="hs-comment">-- This forward reference is a relative offset that allows us to skip over the</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- result of 'put_A'.</span><span>
</span><span id="line-1281"></span><span id="local-6989586621682486688"><span id="local-6989586621682486689"><span class="annot"><a href="GHC.Utils.Binary.html#forwardPutRel"><span class="hs-identifier hs-type">forwardPutRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486688"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486688"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486688"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1282"></span><span id="forwardPutRel"><span class="annot"><span class="annottext">forwardPutRel :: forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#forwardPutRel"><span class="hs-identifier hs-var hs-var">forwardPutRel</span></a></span></span><span> </span><span id="local-6989586621682486699"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486699"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486700"><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486700"><span class="hs-identifier hs-var">put_A</span></a></span></span><span> </span><span id="local-6989586621682486701"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486701"><span class="hs-identifier hs-var">put_B</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1283"></span><span>  </span><span class="hs-comment">-- write placeholder pointer to A</span><span>
</span><span id="line-1284"></span><span>  </span><span id="local-6989586621682486702"><span class="annot"><a href="#local-6989586621682486702"><span class="hs-identifier hs-var">pre_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; IO (Bin (RelBinPtr (ZonkAny 7)))
forall {k} (a :: k). WriteBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-var">tellBinWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486699"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1285"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486699"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486702"><span class="hs-identifier hs-type">pre_a</span></a></span><span>
</span><span id="line-1286"></span><span>
</span><span id="line-1287"></span><span>  </span><span class="hs-comment">-- write B</span><span>
</span><span id="line-1288"></span><span>  </span><span id="local-6989586621682486703"><span class="annot"><a href="#local-6989586621682486703"><span class="hs-identifier hs-var">r_b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486701"><span class="hs-identifier hs-type">put_B</span></a></span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span>  </span><span class="hs-comment">-- update A's pointer</span><span>
</span><span id="line-1291"></span><span>  </span><span id="local-6989586621682486704"><span class="annot"><a href="#local-6989586621682486704"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-type">tellBinWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486699"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1292"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#putAtRel"><span class="hs-identifier hs-type">putAtRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486699"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486702"><span class="hs-identifier hs-type">pre_a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486704"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1293"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinNoExpandWriter"><span class="hs-identifier hs-type">seekBinNoExpandWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486699"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486704"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span>  </span><span class="hs-comment">-- write A</span><span>
</span><span id="line-1296"></span><span>  </span><span id="local-6989586621682486705"><span class="annot"><a href="#local-6989586621682486705"><span class="hs-identifier hs-var">r_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486700"><span class="hs-identifier hs-type">put_A</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486703"><span class="hs-identifier hs-type">r_b</span></a></span><span>
</span><span id="line-1297"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486705"><span class="hs-identifier hs-type">r_a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682486703"><span class="hs-identifier hs-type">r_b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span class="annot"><span class="hs-comment">-- | Like 'forwardGetRel', but discard the result.</span></span><span>
</span><span id="line-1300"></span><span id="local-6989586621682486706"><span id="local-6989586621682486707"><span class="annot"><a href="GHC.Utils.Binary.html#forwardPutRel_"><span class="hs-identifier hs-type">forwardPutRel_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486706"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486706"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1301"></span><span id="forwardPutRel_"><span class="annot"><span class="annottext">forwardPutRel_ :: forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#forwardPutRel_"><span class="hs-identifier hs-var hs-var">forwardPutRel_</span></a></span></span><span> </span><span id="local-6989586621682486709"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486709"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486710"><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486710"><span class="hs-identifier hs-var">put_A</span></a></span></span><span> </span><span id="local-6989586621682486711"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486711"><span class="hs-identifier hs-var">put_B</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (a, b) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO (a, b) -&gt; IO ()) -&gt; IO (a, b) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#forwardPutRel"><span class="hs-identifier hs-var">forwardPutRel</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486709"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; IO a
</span><a href="#local-6989586621682486710"><span class="hs-identifier hs-var">put_A</span></a></span><span> </span><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621682486711"><span class="hs-identifier hs-var">put_B</span></a></span><span>
</span><span id="line-1302"></span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- | Read a value stored using a forward reference.</span><span>
</span><span id="line-1304"></span><span class="hs-comment">--</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- The forward reference is expected to be a relative offset.</span><span>
</span><span id="line-1306"></span><span id="local-6989586621682486712"><span class="annot"><a href="GHC.Utils.Binary.html#forwardGetRel"><span class="hs-identifier hs-type">forwardGetRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486712"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486712"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1307"></span><span id="forwardGetRel"><span class="annot"><span class="annottext">forwardGetRel :: forall a. ReadBinHandle -&gt; IO a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#forwardGetRel"><span class="hs-identifier hs-var hs-var">forwardGetRel</span></a></span></span><span> </span><span id="local-6989586621682486719"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486719"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486720"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621682486720"><span class="hs-identifier hs-var">get_A</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1308"></span><span>    </span><span class="hs-comment">-- read forward reference</span><span>
</span><span id="line-1309"></span><span>    </span><span id="local-6989586621682486721"><span class="annot"><a href="#local-6989586621682486721"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (RelBin (ZonkAny 11))
forall {k} (a :: k). ReadBinHandle -&gt; IO (RelBin a)
</span><a href="GHC.Utils.Binary.html#getRelBin"><span class="hs-identifier hs-var">getRelBin</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486719"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1310"></span><span>    </span><span class="hs-comment">-- store current position</span><span>
</span><span id="line-1311"></span><span>    </span><span id="local-6989586621682486722"><span class="annot"><a href="#local-6989586621682486722"><span class="hs-identifier hs-var">p_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-type">tellBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486719"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1312"></span><span>    </span><span class="hs-comment">-- go read the forward value, then seek back</span><span>
</span><span id="line-1313"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486719"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#makeAbsoluteBin"><span class="hs-identifier hs-type">makeAbsoluteBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486721"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-1314"></span><span>    </span><span id="local-6989586621682486723"><span class="annot"><a href="#local-6989586621682486723"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621682486720"><span class="hs-identifier hs-type">get_A</span></a></span><span>
</span><span id="line-1315"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486719"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486722"><span class="hs-identifier hs-type">p_a</span></a></span><span>
</span><span id="line-1316"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682486723"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- Lazy reading/writing</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span id="local-6989586621682486724"><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier hs-type">lazyPut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486724"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682486724"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1322"></span><span id="lazyPut"><span class="annot"><span class="annottext">lazyPut :: forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier hs-var hs-var">lazyPut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WriteBinHandle -&gt; a -&gt; IO ()) -&gt; WriteBinHandle -&gt; a -&gt; IO ()
forall a.
(WriteBinHandle -&gt; a -&gt; IO ()) -&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPut%27"><span class="hs-identifier hs-var">lazyPut'</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span>
</span><span id="line-1323"></span><span>
</span><span id="line-1324"></span><span id="local-6989586621682486727"><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier hs-type">lazyGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486727"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682486727"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1325"></span><span id="lazyGet"><span class="annot"><span class="annottext">lazyGet :: forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier hs-var hs-var">lazyGet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ReadBinHandle -&gt; IO a) -&gt; ReadBinHandle -&gt; IO a
forall a. (ReadBinHandle -&gt; IO a) -&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#lazyGet%27"><span class="hs-identifier hs-var">lazyGet'</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1326"></span><span>
</span><span id="line-1327"></span><span id="local-6989586621682484160"><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut%27"><span class="hs-identifier hs-type">lazyPut'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1328"></span><span id="lazyPut%27"><span class="annot"><span class="annottext">lazyPut' :: forall a.
(WriteBinHandle -&gt; a -&gt; IO ()) -&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPut%27"><span class="hs-identifier hs-var hs-var">lazyPut'</span></a></span></span><span> </span><span id="local-6989586621682486736"><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="#local-6989586621682486736"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682486737"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486737"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486738"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486738"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1329"></span><span>    </span><span class="hs-comment">-- output the obj with a ptr to skip over it:</span><span>
</span><span id="line-1330"></span><span>    </span><span id="local-6989586621682486739"><span class="annot"><a href="#local-6989586621682486739"><span class="hs-identifier hs-var">pre_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; IO (Bin (RelBinPtr (ZonkAny 9)))
forall {k} (a :: k). WriteBinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-var">tellBinWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486737"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1331"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486737"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486739"><span class="hs-identifier hs-type">pre_a</span></a></span><span>       </span><span class="hs-comment">-- save a slot for the ptr</span><span>
</span><span id="line-1332"></span><span>    </span><span class="annot"><a href="#local-6989586621682486736"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486737"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486738"><span class="hs-identifier hs-type">a</span></a></span><span>           </span><span class="hs-comment">-- dump the object</span><span>
</span><span id="line-1333"></span><span>    </span><span id="local-6989586621682486740"><span class="annot"><a href="#local-6989586621682486740"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinWriter"><span class="hs-identifier hs-type">tellBinWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486737"><span class="hs-identifier hs-type">bh</span></a></span><span>     </span><span class="hs-comment">-- q = ptr to after object</span><span>
</span><span id="line-1334"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#putAtRel"><span class="hs-identifier hs-type">putAtRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486737"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486739"><span class="hs-identifier hs-type">pre_a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486740"><span class="hs-identifier hs-type">q</span></a></span><span>    </span><span class="hs-comment">-- fill in slot before a with ptr to q</span><span>
</span><span id="line-1335"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinWriter"><span class="hs-identifier hs-type">seekBinWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486737"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486740"><span class="hs-identifier hs-type">q</span></a></span><span>        </span><span class="hs-comment">-- finally carry on writing at q</span><span>
</span><span id="line-1336"></span><span>
</span><span id="line-1337"></span><span id="local-6989586621682484162"><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet%27"><span class="hs-identifier hs-type">lazyGet'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484162"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1338"></span><span id="lazyGet%27"><span class="annot"><span class="annottext">lazyGet' :: forall a. (ReadBinHandle -&gt; IO a) -&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#lazyGet%27"><span class="hs-identifier hs-var hs-var">lazyGet'</span></a></span></span><span> </span><span id="local-6989586621682486748"><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
</span><a href="#local-6989586621682486748"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682486749"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486749"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1339"></span><span>    </span><span id="local-6989586621682486750"><span class="annot"><a href="#local-6989586621682486750"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (RelBin (ZonkAny 15))
forall {k} (a :: k). ReadBinHandle -&gt; IO (RelBin a)
</span><a href="GHC.Utils.Binary.html#getRelBin"><span class="hs-identifier hs-var">getRelBin</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486749"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-comment">-- a BinPtr</span><span>
</span><span id="line-1340"></span><span>    </span><span id="local-6989586621682486751"><span class="annot"><a href="#local-6989586621682486751"><span class="hs-identifier hs-var">p_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBinReader"><span class="hs-identifier hs-type">tellBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486749"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-1341"></span><span>    </span><span id="local-6989586621682486752"><span class="annot"><a href="#local-6989586621682486752"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unsafeInterleaveIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1342"></span><span>        </span><span class="hs-comment">-- NB: Use a fresh rbm_off_r variable in the child thread, for thread</span><span>
</span><span id="line-1343"></span><span>        </span><span class="hs-comment">-- safety.</span><span>
</span><span id="line-1344"></span><span>        </span><span id="local-6989586621682486753"><span class="annot"><a href="#local-6989586621682486753"><span class="hs-identifier hs-var">off_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-type">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1345"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682486754"><span class="annot"><a href="#local-6989586621682486754"><span class="hs-identifier hs-var hs-var">bh'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486749"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#rbm_off_r"><span class="hs-identifier hs-var">rbm_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486753"><span class="hs-identifier hs-type">off_r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1346"></span><span>        </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486754"><span class="hs-identifier hs-type">bh'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486751"><span class="hs-identifier hs-type">p_a</span></a></span><span>
</span><span id="line-1347"></span><span>        </span><span class="annot"><a href="#local-6989586621682486748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486754"><span class="hs-identifier hs-type">bh'</span></a></span><span>
</span><span id="line-1348"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBinReader"><span class="hs-identifier hs-type">seekBinReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486749"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#makeAbsoluteBin"><span class="hs-identifier hs-type">makeAbsoluteBin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486750"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- skip over the object for now</span><span>
</span><span id="line-1349"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682486752"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span class="hs-comment">-- | Serialize the constructor strictly but lazily serialize a value inside a</span><span>
</span><span id="line-1352"></span><span class="hs-comment">-- 'Just'.</span><span>
</span><span id="line-1353"></span><span class="hs-comment">--</span><span>
</span><span id="line-1354"></span><span class="hs-comment">-- This way we can check for the presence of a value without deserializing the</span><span>
</span><span id="line-1355"></span><span class="hs-comment">-- value itself.</span><span>
</span><span id="line-1356"></span><span id="local-6989586621682486755"><span class="annot"><a href="GHC.Utils.Binary.html#lazyPutMaybe"><span class="hs-identifier hs-type">lazyPutMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682486755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1357"></span><span id="lazyPutMaybe"><span class="annot"><span class="annottext">lazyPutMaybe :: forall a. Binary a =&gt; WriteBinHandle -&gt; Maybe a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPutMaybe"><span class="hs-identifier hs-var hs-var">lazyPutMaybe</span></a></span></span><span> </span><span id="local-6989586621682486761"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486761"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486761"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1358"></span><span class="annot"><a href="GHC.Utils.Binary.html#lazyPutMaybe"><span class="hs-identifier hs-var">lazyPutMaybe</span></a></span><span> </span><span id="local-6989586621682486762"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486762"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682486763"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486763"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1359"></span><span>  </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486762"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1360"></span><span>  </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier hs-var">lazyPut</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486762"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682486763"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1361"></span><span>
</span><span id="line-1362"></span><span class="annot"><span class="hs-comment">-- | Deserialize a value serialized by 'lazyPutMaybe'.</span></span><span>
</span><span id="line-1363"></span><span id="local-6989586621682486764"><span class="annot"><a href="GHC.Utils.Binary.html#lazyGetMaybe"><span class="hs-identifier hs-type">lazyGetMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682486764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1364"></span><span id="lazyGetMaybe"><span class="annot"><span class="annottext">lazyGetMaybe :: forall a. Binary a =&gt; ReadBinHandle -&gt; IO (Maybe a)
</span><a href="GHC.Utils.Binary.html#lazyGetMaybe"><span class="hs-identifier hs-var hs-var">lazyGetMaybe</span></a></span></span><span> </span><span id="local-6989586621682486772"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486772"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1365"></span><span>  </span><span id="local-6989586621682486773"><span class="annot"><a href="#local-6989586621682486773"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486772"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1366"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486773"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1367"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1368"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; IO a -&gt; IO (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier hs-var">lazyGet</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486772"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1371"></span><span class="hs-comment">-- UserData</span><span>
</span><span id="line-1372"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1373"></span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- Note [Binary UserData]</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-1376"></span><span class="hs-comment">-- Information we keep around during interface file</span><span>
</span><span id="line-1377"></span><span class="hs-comment">-- serialization/deserialization. Namely we keep the functions for serializing</span><span>
</span><span id="line-1378"></span><span class="hs-comment">-- and deserializing 'Name's and 'FastString's. We do this because we actually</span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- use serialization in two distinct settings,</span><span>
</span><span id="line-1380"></span><span class="hs-comment">--</span><span>
</span><span id="line-1381"></span><span class="annot"><span class="hs-comment">-- * When serializing interface files themselves</span></span><span>
</span><span id="line-1382"></span><span class="hs-comment">--</span><span>
</span><span id="line-1383"></span><span class="annot"><span class="hs-comment">-- * When computing the fingerprint of an IfaceDecl (which we computing by</span></span><span>
</span><span id="line-1384"></span><span class="hs-comment">--   hashing its Binary serialization)</span><span>
</span><span id="line-1385"></span><span class="hs-comment">--</span><span>
</span><span id="line-1386"></span><span class="hs-comment">-- These two settings have different needs while serializing Names:</span><span>
</span><span id="line-1387"></span><span class="hs-comment">--</span><span>
</span><span id="line-1388"></span><span class="annot"><span class="hs-comment">-- * Names in interface files are serialized via a symbol table (see Note</span></span><span>
</span><span id="line-1389"></span><span class="hs-comment">--   [Symbol table representation of names] in &quot;GHC.Iface.Binary&quot;).</span><span>
</span><span id="line-1390"></span><span class="hs-comment">--</span><span>
</span><span id="line-1391"></span><span class="annot"><span class="hs-comment">-- * During fingerprinting a binding Name is serialized as the OccName and a</span></span><span>
</span><span id="line-1392"></span><span class="hs-comment">--   non-binding Name is serialized as the fingerprint of the thing they</span><span>
</span><span id="line-1393"></span><span class="hs-comment">--   represent. See Note [Fingerprinting IfaceDecls] for further discussion.</span><span>
</span><span id="line-1394"></span><span class="hs-comment">--</span><span>
</span><span id="line-1395"></span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- | Newtype to serialise binding names differently to non-binding 'Name'.</span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- See Note [Binary UserData]</span><span>
</span><span id="line-1398"></span><span class="hs-keyword">newtype</span><span> </span><span id="BindingName"><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier hs-var">BindingName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BindingName"><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier hs-var">BindingName</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getBindingName"><span class="annot"><span class="annottext">BindingName -&gt; Name
</span><a href="GHC.Utils.Binary.html#getBindingName"><span class="hs-identifier hs-var hs-var">getBindingName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1399"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682486777"><span id="local-6989586621682486782"><span class="annot"><span class="annottext">BindingName -&gt; BindingName -&gt; Bool
(BindingName -&gt; BindingName -&gt; Bool)
-&gt; (BindingName -&gt; BindingName -&gt; Bool) -&gt; Eq BindingName
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BindingName -&gt; BindingName -&gt; Bool
== :: BindingName -&gt; BindingName -&gt; Bool
$c/= :: BindingName -&gt; BindingName -&gt; Bool
/= :: BindingName -&gt; BindingName -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1400"></span><span>
</span><span id="line-1401"></span><span class="annot"><a href="GHC.Utils.Binary.html#simpleBindingNameWriter"><span class="hs-identifier hs-type">simpleBindingNameWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier hs-type">BindingName</span></a></span><span>
</span><span id="line-1402"></span><span id="simpleBindingNameWriter"><span class="annot"><span class="annottext">simpleBindingNameWriter :: BinaryWriter Name -&gt; BinaryWriter BindingName
</span><a href="GHC.Utils.Binary.html#simpleBindingNameWriter"><span class="hs-identifier hs-var hs-var">simpleBindingNameWriter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryWriter Name -&gt; BinaryWriter BindingName
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span class="annot"><a href="GHC.Utils.Binary.html#simpleBindingNameReader"><span class="hs-identifier hs-type">simpleBindingNameReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier hs-type">BindingName</span></a></span><span>
</span><span id="line-1405"></span><span id="simpleBindingNameReader"><span class="annot"><span class="annottext">simpleBindingNameReader :: BinaryReader Name -&gt; BinaryReader BindingName
</span><a href="GHC.Utils.Binary.html#simpleBindingNameReader"><span class="hs-identifier hs-var hs-var">simpleBindingNameReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryReader Name -&gt; BinaryReader BindingName
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="annot"><span class="hs-comment">-- | Existential for 'BinaryWriter' with a type witness.</span></span><span>
</span><span id="line-1408"></span><span class="hs-keyword">data</span><span> </span><span id="SomeBinaryWriter"><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-var">SomeBinaryWriter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682486786"><span class="annot"><a href="#local-6989586621682486786"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span id="SomeBinaryWriter"><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-var">SomeBinaryWriter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Refl.TypeRep</span></span><span> </span><span class="annot"><a href="#local-6989586621682486786"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486786"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1409"></span><span>
</span><span id="line-1410"></span><span class="annot"><span class="hs-comment">-- | Existential for 'BinaryReader' with a type witness.</span></span><span>
</span><span id="line-1411"></span><span class="hs-keyword">data</span><span> </span><span id="SomeBinaryReader"><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-var">SomeBinaryReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682486787"><span class="annot"><a href="#local-6989586621682486787"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span id="SomeBinaryReader"><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-var">SomeBinaryReader</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Refl.TypeRep</span></span><span> </span><span class="annot"><a href="#local-6989586621682486787"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486787"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span class="hs-comment">-- | UserData required to serialise symbols for interface files.</span><span>
</span><span id="line-1414"></span><span class="hs-comment">--</span><span>
</span><span id="line-1415"></span><span class="hs-comment">-- See Note [Binary UserData]</span><span>
</span><span id="line-1416"></span><span class="hs-keyword">data</span><span> </span><span id="WriterUserData"><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-var">WriterUserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1417"></span><span>   </span><span id="WriterUserData"><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-var">WriterUserData</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-1418"></span><span>      </span><span id="ud_writer_data"><span class="annot"><span class="annottext">WriterUserData -&gt; Map SomeTypeRep SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var hs-var">ud_writer_data</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeTypeRep</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span>
</span><span id="line-1419"></span><span>      </span><span class="hs-comment">-- ^ A mapping from a type witness to the 'Writer' for the associated type.</span><span>
</span><span id="line-1420"></span><span>      </span><span class="hs-comment">-- This is a 'Map' because microbenchmarks indicated this is more efficient</span><span>
</span><span id="line-1421"></span><span>      </span><span class="hs-comment">-- than other representations for less than ten elements.</span><span>
</span><span id="line-1422"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1423"></span><span>      </span><span class="hs-comment">-- Considered representations:</span><span>
</span><span id="line-1424"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1425"></span><span>      </span><span class="hs-comment">-- * [(TypeRep, SomeBinaryWriter)]</span><span>
</span><span id="line-1426"></span><span>      </span><span class="hs-comment">-- * bytehash (on hackage)</span><span>
</span><span id="line-1427"></span><span>      </span><span class="hs-comment">-- * Map TypeRep SomeBinaryWriter</span><span>
</span><span id="line-1428"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-1429"></span><span>
</span><span id="line-1430"></span><span class="hs-comment">-- | UserData required to deserialise symbols for interface files.</span><span>
</span><span id="line-1431"></span><span class="hs-comment">--</span><span>
</span><span id="line-1432"></span><span class="hs-comment">-- See Note [Binary UserData]</span><span>
</span><span id="line-1433"></span><span class="hs-keyword">data</span><span> </span><span id="ReaderUserData"><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-var">ReaderUserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1434"></span><span>   </span><span id="ReaderUserData"><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-var">ReaderUserData</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-1435"></span><span>      </span><span id="ud_reader_data"><span class="annot"><span class="annottext">ReaderUserData -&gt; Map SomeTypeRep SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var hs-var">ud_reader_data</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeTypeRep</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span>
</span><span id="line-1436"></span><span>      </span><span class="hs-comment">-- ^ A mapping from a type witness to the 'Reader' for the associated type.</span><span>
</span><span id="line-1437"></span><span>      </span><span class="hs-comment">-- This is a 'Map' because microbenchmarks indicated this is more efficient</span><span>
</span><span id="line-1438"></span><span>      </span><span class="hs-comment">-- than other representations for less than ten elements.</span><span>
</span><span id="line-1439"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1440"></span><span>      </span><span class="hs-comment">-- Considered representations:</span><span>
</span><span id="line-1441"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1442"></span><span>      </span><span class="hs-comment">-- * [(TypeRep, SomeBinaryReader)]</span><span>
</span><span id="line-1443"></span><span>      </span><span class="hs-comment">-- * bytehash (on hackage)</span><span>
</span><span id="line-1444"></span><span>      </span><span class="hs-comment">-- * Map TypeRep SomeBinaryReader</span><span>
</span><span id="line-1445"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-1446"></span><span>
</span><span id="line-1447"></span><span class="annot"><a href="GHC.Utils.Binary.html#mkWriterUserData"><span class="hs-identifier hs-type">mkWriterUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span>
</span><span id="line-1448"></span><span id="mkWriterUserData"><span class="annot"><span class="annottext">mkWriterUserData :: [SomeBinaryWriter] -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#mkWriterUserData"><span class="hs-identifier hs-var hs-var">mkWriterUserData</span></a></span></span><span> </span><span id="local-6989586621682486788"><span class="annot"><span class="annottext">[SomeBinaryWriter]
</span><a href="#local-6989586621682486788"><span class="hs-identifier hs-var">caches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterUserData
</span><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier hs-var">noWriterUserData</span></a></span><span>
</span><span id="line-1449"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var">ud_writer_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-type">Map.fromList</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486790"><span class="annot"><span class="annottext">cache :: SomeBinaryWriter
</span><a href="#local-6989586621682486790"><span class="hs-identifier hs-var">cache</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span> </span><span id="local-6989586621682486791"><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621682486791"><span class="hs-identifier hs-var">typRep</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinaryWriter a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep a -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621682486791"><span class="hs-identifier hs-var">typRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeBinaryWriter
</span><a href="#local-6989586621682486790"><span class="hs-identifier hs-var">cache</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682486788"><span class="hs-identifier hs-type">caches</span></a></span><span>
</span><span id="line-1450"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1451"></span><span>
</span><span id="line-1452"></span><span class="annot"><a href="GHC.Utils.Binary.html#mkReaderUserData"><span class="hs-identifier hs-type">mkReaderUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-1453"></span><span id="mkReaderUserData"><span class="annot"><span class="annottext">mkReaderUserData :: [SomeBinaryReader] -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#mkReaderUserData"><span class="hs-identifier hs-var hs-var">mkReaderUserData</span></a></span></span><span> </span><span id="local-6989586621682486792"><span class="annot"><span class="annottext">[SomeBinaryReader]
</span><a href="#local-6989586621682486792"><span class="hs-identifier hs-var">caches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderUserData
</span><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-var">noReaderUserData</span></a></span><span>
</span><span id="line-1454"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var">ud_reader_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-type">Map.fromList</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486793"><span class="annot"><span class="annottext">cache :: SomeBinaryReader
</span><a href="#local-6989586621682486793"><span class="hs-identifier hs-var">cache</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span> </span><span id="local-6989586621682486794"><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621682486794"><span class="hs-identifier hs-var">typRep</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinaryReader a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep a -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621682486794"><span class="hs-identifier hs-var">typRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeBinaryReader
</span><a href="#local-6989586621682486793"><span class="hs-identifier hs-var">cache</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682486792"><span class="hs-identifier hs-type">caches</span></a></span><span>
</span><span id="line-1455"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1456"></span><span>
</span><span id="line-1457"></span><span class="annot"><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier hs-type">mkSomeBinaryWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484174"><span class="annot"><a href="#local-6989586621682484174"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Refl.Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682484174"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484174"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span>
</span><span id="line-1458"></span><span id="mkSomeBinaryWriter"><span class="annot"><span class="annottext">mkSomeBinaryWriter :: forall a. Typeable a =&gt; BinaryWriter a -&gt; SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier hs-var hs-var">mkSomeBinaryWriter</span></a></span></span><span> </span><span id="local-6989586621682486797"><span class="annot"><span class="annottext">BinaryWriter a
</span><a href="#local-6989586621682486797"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; BinaryWriter a -&gt; SomeBinaryWriter
forall a. TypeRep a -&gt; BinaryWriter a -&gt; SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-var">SomeBinaryWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; TypeRep a
forall {k} (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">Refl.typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682484174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinaryWriter a
</span><a href="#local-6989586621682486797"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-1459"></span><span>
</span><span id="line-1460"></span><span class="annot"><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier hs-type">mkSomeBinaryReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484176"><span class="annot"><a href="#local-6989586621682484176"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Refl.Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682484176"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484176"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span>
</span><span id="line-1461"></span><span id="mkSomeBinaryReader"><span class="annot"><span class="annottext">mkSomeBinaryReader :: forall a. Typeable a =&gt; BinaryReader a -&gt; SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier hs-var hs-var">mkSomeBinaryReader</span></a></span></span><span> </span><span id="local-6989586621682486800"><span class="annot"><span class="annottext">BinaryReader a
</span><a href="#local-6989586621682486800"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; BinaryReader a -&gt; SomeBinaryReader
forall a. TypeRep a -&gt; BinaryReader a -&gt; SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-var">SomeBinaryReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Typeable a =&gt; TypeRep a
forall {k} (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">Refl.typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682484176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinaryReader a
</span><a href="#local-6989586621682486800"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-1462"></span><span>
</span><span id="line-1463"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinaryReader"><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-var">BinaryReader</span></a></span></span><span> </span><span id="local-6989586621682484178"><span class="annot"><a href="#local-6989586621682484178"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinaryReader"><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-var">BinaryReader</span></a></span></span><span>
</span><span id="line-1464"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getEntry"><span class="annot"><span class="annottext">forall s. BinaryReader s -&gt; ReadBinHandle -&gt; IO s
</span><a href="GHC.Utils.Binary.html#getEntry"><span class="hs-identifier hs-var hs-var">getEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484178"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-1465"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486803"><span id="local-6989586621682486806"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; BinaryReader a -&gt; BinaryReader b)
-&gt; (forall a b. a -&gt; BinaryReader b -&gt; BinaryReader a)
-&gt; Functor BinaryReader
forall a b. a -&gt; BinaryReader b -&gt; BinaryReader a
forall a b. (a -&gt; b) -&gt; BinaryReader a -&gt; BinaryReader b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; BinaryReader a -&gt; BinaryReader b
fmap :: forall a b. (a -&gt; b) -&gt; BinaryReader a -&gt; BinaryReader b
$c&lt;$ :: forall a b. a -&gt; BinaryReader b -&gt; BinaryReader a
&lt;$ :: forall a b. a -&gt; BinaryReader b -&gt; BinaryReader a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1466"></span><span>
</span><span id="line-1467"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinaryWriter"><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-var">BinaryWriter</span></a></span></span><span> </span><span id="local-6989586621682484185"><span class="annot"><a href="#local-6989586621682484185"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinaryWriter"><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-var">BinaryWriter</span></a></span></span><span>
</span><span id="line-1468"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="putEntry"><span class="annot"><span class="annottext">forall s. BinaryWriter s -&gt; WriteBinHandle -&gt; s -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putEntry"><span class="hs-identifier hs-var hs-var">putEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484185"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1469"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1470"></span><span>
</span><span id="line-1471"></span><span id="local-6989586621682484187"><span class="annot"><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-type">mkWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682484187"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484187"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-1472"></span><span id="mkWriter"><span class="annot"><span class="annottext">mkWriter :: forall s. (WriteBinHandle -&gt; s -&gt; IO ()) -&gt; BinaryWriter s
</span><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-var hs-var">mkWriter</span></a></span></span><span> </span><span id="local-6989586621682486812"><span class="annot"><span class="annottext">WriteBinHandle -&gt; s -&gt; IO ()
</span><a href="#local-6989586621682486812"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span>
</span><span id="line-1473"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">putEntry :: WriteBinHandle -&gt; s -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putEntry"><span class="hs-identifier hs-var">putEntry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; s -&gt; IO ()
</span><a href="#local-6989586621682486812"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1474"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1475"></span><span>
</span><span id="line-1476"></span><span id="local-6989586621682484189"><span class="annot"><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-type">mkReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484189"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484189"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-1477"></span><span id="mkReader"><span class="annot"><span class="annottext">mkReader :: forall s. (ReadBinHandle -&gt; IO s) -&gt; BinaryReader s
</span><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-var hs-var">mkReader</span></a></span></span><span> </span><span id="local-6989586621682486813"><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO s
</span><a href="#local-6989586621682486813"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span>
</span><span id="line-1478"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">getEntry :: ReadBinHandle -&gt; IO s
</span><a href="GHC.Utils.Binary.html#getEntry"><span class="hs-identifier hs-var">getEntry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO s
</span><a href="#local-6989586621682486813"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1479"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span class="hs-comment">-- | Find the 'BinaryReader' for the 'Binary' instance for the type identified by 'Proxy a'.</span><span>
</span><span id="line-1482"></span><span class="hs-comment">--</span><span>
</span><span id="line-1483"></span><span class="hs-comment">-- If no 'BinaryReader' has been configured before, this function will panic.</span><span>
</span><span id="line-1484"></span><span class="annot"><a href="GHC.Utils.Binary.html#findUserDataReader"><span class="hs-identifier hs-type">findUserDataReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484191"><span class="annot"><a href="#local-6989586621682484191"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Refl.Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682484191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621682484191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484191"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1485"></span><span id="findUserDataReader"><span class="annot"><span class="annottext">findUserDataReader :: forall a. Typeable a =&gt; Proxy a -&gt; ReadBinHandle -&gt; BinaryReader a
</span><a href="GHC.Utils.Binary.html#findUserDataReader"><span class="hs-identifier hs-var hs-var">findUserDataReader</span></a></span></span><span> </span><span id="local-6989586621682486822"><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486822"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621682486823"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486823"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1486"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeTypeRep
-&gt; Map SomeTypeRep SomeBinaryReader -&gt; Maybe SomeBinaryReader
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; SomeTypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">Refl.someTypeRep</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486822"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderUserData -&gt; Map SomeTypeRep SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var">ud_reader_data</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderUserData -&gt; Map SomeTypeRep SomeBinaryReader)
-&gt; ReaderUserData -&gt; Map SomeTypeRep SomeBinaryReader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#getReaderUserData"><span class="hs-identifier hs-var">getReaderUserData</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486823"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1487"></span><span>    </span><span class="annot"><span class="annottext">Maybe SomeBinaryReader
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; BinaryReader a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BinaryReader a) -&gt; String -&gt; BinaryReader a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to find BinaryReader for the key: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SomeTypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; SomeTypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">Refl.someTypeRep</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486822"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryReader"><span class="hs-identifier hs-type">SomeBinaryReader</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486826"><span id="local-6989586621682486827"><span class="annot"><span class="annottext">BinaryReader a
</span><a href="#local-6989586621682486827"><span class="hs-identifier hs-var">reader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486826"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1489"></span><span>      </span><span class="annot"><span class="annottext">forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486826"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinaryReader a
</span><a href="#local-6989586621682486827"><span class="hs-identifier hs-var">reader</span></a></span><span>
</span><span id="line-1490"></span><span>      </span><span class="hs-comment">-- This 'unsafeCoerce' could be written safely like this:</span><span>
</span><span id="line-1491"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1492"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1493"></span><span>      </span><span class="hs-comment">--   Just (SomeBinaryReader _ (reader :: BinaryReader x)) -&gt;</span><span>
</span><span id="line-1494"></span><span>      </span><span class="hs-comment">--     case testEquality (typeRep @a) tyRep of</span><span>
</span><span id="line-1495"></span><span>      </span><span class="hs-comment">--       Just Refl -&gt; coerce @(BinaryReader x) @(BinaryReader a) reader</span><span>
</span><span id="line-1496"></span><span>      </span><span class="hs-comment">--       Nothing -&gt; panic $ &quot;Invariant violated&quot;</span><span>
</span><span id="line-1497"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1498"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1499"></span><span>      </span><span class="hs-comment">-- But it comes at a slight performance cost and this function is used in</span><span>
</span><span id="line-1500"></span><span>      </span><span class="hs-comment">-- binary serialisation hot loops, thus, we prefer the small performance boost over</span><span>
</span><span id="line-1501"></span><span>      </span><span class="hs-comment">-- the additional type safety.</span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span class="hs-comment">-- | Find the 'BinaryWriter' for the 'Binary' instance for the type identified by 'Proxy a'.</span><span>
</span><span id="line-1504"></span><span class="hs-comment">--</span><span>
</span><span id="line-1505"></span><span class="hs-comment">-- If no 'BinaryWriter' has been configured before, this function will panic.</span><span>
</span><span id="line-1506"></span><span class="annot"><a href="GHC.Utils.Binary.html#findUserDataWriter"><span class="hs-identifier hs-type">findUserDataWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484202"><span class="annot"><a href="#local-6989586621682484202"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Refl.Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621682484202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621682484202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484202"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1507"></span><span id="findUserDataWriter"><span class="annot"><span class="annottext">findUserDataWriter :: forall a. Typeable a =&gt; Proxy a -&gt; WriteBinHandle -&gt; BinaryWriter a
</span><a href="GHC.Utils.Binary.html#findUserDataWriter"><span class="hs-identifier hs-var hs-var">findUserDataWriter</span></a></span></span><span> </span><span id="local-6989586621682486835"><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486835"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621682486836"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486836"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1508"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeTypeRep
-&gt; Map SomeTypeRep SomeBinaryWriter -&gt; Maybe SomeBinaryWriter
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; SomeTypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">Refl.someTypeRep</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486835"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriterUserData -&gt; Map SomeTypeRep SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var">ud_writer_data</span></a></span><span> </span><span class="annot"><span class="annottext">(WriterUserData -&gt; Map SomeTypeRep SomeBinaryWriter)
-&gt; WriterUserData -&gt; Map SomeTypeRep SomeBinaryWriter
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#getWriterUserData"><span class="hs-identifier hs-var">getWriterUserData</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486836"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1509"></span><span>    </span><span class="annot"><span class="annottext">Maybe SomeBinaryWriter
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; BinaryWriter a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BinaryWriter a) -&gt; String -&gt; BinaryWriter a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to find BinaryWriter for the key: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SomeTypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; SomeTypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">Refl.someTypeRep</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621682486835"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1510"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SomeBinaryWriter"><span class="hs-identifier hs-type">SomeBinaryWriter</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486837"><span id="local-6989586621682486838"><span class="annot"><span class="annottext">BinaryWriter a
</span><a href="#local-6989586621682486838"><span class="hs-identifier hs-var">writer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486837"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1511"></span><span>      </span><span class="annot"><span class="annottext">forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486837"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484202"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinaryWriter a
</span><a href="#local-6989586621682486838"><span class="hs-identifier hs-var">writer</span></a></span><span>
</span><span id="line-1512"></span><span>      </span><span class="hs-comment">-- This 'unsafeCoerce' could be written safely like this:</span><span>
</span><span id="line-1513"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1514"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1515"></span><span>      </span><span class="hs-comment">--   Just (SomeBinaryWriter tyRep (writer :: BinaryWriter x)) -&gt;</span><span>
</span><span id="line-1516"></span><span>      </span><span class="hs-comment">--     case testEquality (typeRep @a) tyRep of</span><span>
</span><span id="line-1517"></span><span>      </span><span class="hs-comment">--       Just Refl -&gt; coerce @(BinaryWriter x) @(BinaryWriter a) writer</span><span>
</span><span id="line-1518"></span><span>      </span><span class="hs-comment">--       Nothing -&gt; panic $ &quot;Invariant violated&quot;</span><span>
</span><span id="line-1519"></span><span>      </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1520"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1521"></span><span>      </span><span class="hs-comment">-- But it comes at a slight performance cost and this function is used in</span><span>
</span><span id="line-1522"></span><span>      </span><span class="hs-comment">-- binary serialisation hot loops, thus, we prefer the small performance boost over</span><span>
</span><span id="line-1523"></span><span>      </span><span class="hs-comment">-- the additional type safety.</span><span>
</span><span id="line-1524"></span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span class="annot"><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-type">noReaderUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-1527"></span><span id="noReaderUserData"><span class="annot"><span class="annottext">noReaderUserData :: ReaderUserData
</span><a href="GHC.Utils.Binary.html#noReaderUserData"><span class="hs-identifier hs-var hs-var">noReaderUserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-1528"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_reader_data :: Map SomeTypeRep SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#ud_reader_data"><span class="hs-identifier hs-var">ud_reader_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map SomeTypeRep SomeBinaryReader
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-1529"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1530"></span><span>
</span><span id="line-1531"></span><span class="annot"><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier hs-type">noWriterUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span>
</span><span id="line-1532"></span><span id="noWriterUserData"><span class="annot"><span class="annottext">noWriterUserData :: WriterUserData
</span><a href="GHC.Utils.Binary.html#noWriterUserData"><span class="hs-identifier hs-var hs-var">noWriterUserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span>
</span><span id="line-1533"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_writer_data :: Map SomeTypeRep SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#ud_writer_data"><span class="hs-identifier hs-var">ud_writer_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map SomeTypeRep SomeBinaryWriter
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-1534"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1535"></span><span>
</span><span id="line-1536"></span><span class="annot"><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier hs-type">newReadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ how to deserialize 'Name's</span></span><span>
</span><span id="line-1537"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderUserData"><span class="hs-identifier hs-type">ReaderUserData</span></a></span><span>
</span><span id="line-1539"></span><span id="newReadState"><span class="annot"><span class="annottext">newReadState :: (ReadBinHandle -&gt; IO Name)
-&gt; (ReadBinHandle -&gt; IO FastString) -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier hs-var hs-var">newReadState</span></a></span></span><span> </span><span id="local-6989586621682486840"><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Name
</span><a href="#local-6989586621682486840"><span class="hs-identifier hs-var">get_name</span></a></span></span><span> </span><span id="local-6989586621682486841"><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
</span><a href="#local-6989586621682486841"><span class="hs-identifier hs-var">get_fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1540"></span><span>  </span><span class="annot"><span class="annottext">[SomeBinaryReader] -&gt; ReaderUserData
</span><a href="GHC.Utils.Binary.html#mkReaderUserData"><span class="hs-identifier hs-var">mkReaderUserData</span></a></span><span>
</span><span id="line-1541"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BinaryReader Name -&gt; SomeBinaryReader
forall a. Typeable a =&gt; BinaryReader a -&gt; SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier hs-var">mkSomeBinaryReader</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryReader Name -&gt; SomeBinaryReader)
-&gt; BinaryReader Name -&gt; SomeBinaryReader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ReadBinHandle -&gt; IO Name) -&gt; BinaryReader Name
forall s. (ReadBinHandle -&gt; IO s) -&gt; BinaryReader s
</span><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-var">mkReader</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Name
</span><a href="#local-6989586621682486840"><span class="hs-identifier hs-var">get_name</span></a></span><span>
</span><span id="line-1542"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryReader BindingName -&gt; SomeBinaryReader
forall a. Typeable a =&gt; BinaryReader a -&gt; SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier hs-var">mkSomeBinaryReader</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryReader BindingName -&gt; SomeBinaryReader)
-&gt; BinaryReader BindingName -&gt; SomeBinaryReader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. (ReadBinHandle -&gt; IO s) -&gt; BinaryReader s
</span><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-var">mkReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Utils.Binary.html#BindingName"><span class="hs-identifier hs-type">BindingName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ReadBinHandle -&gt; IO Name) -&gt; ReadBinHandle -&gt; IO BindingName
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Name
</span><a href="#local-6989586621682486840"><span class="hs-identifier hs-var">get_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1543"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryReader FastString -&gt; SomeBinaryReader
forall a. Typeable a =&gt; BinaryReader a -&gt; SomeBinaryReader
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryReader"><span class="hs-identifier hs-var">mkSomeBinaryReader</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryReader FastString -&gt; SomeBinaryReader)
-&gt; BinaryReader FastString -&gt; SomeBinaryReader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ReadBinHandle -&gt; IO FastString) -&gt; BinaryReader FastString
forall s. (ReadBinHandle -&gt; IO s) -&gt; BinaryReader s
</span><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-var">mkReader</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
</span><a href="#local-6989586621682486841"><span class="hs-identifier hs-var">get_fs</span></a></span><span>
</span><span id="line-1544"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1545"></span><span>
</span><span id="line-1546"></span><span class="annot"><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier hs-type">newWriteState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1547"></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ how to serialize non-binding 'Name's</span></span><span>
</span><span id="line-1548"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ how to serialize binding 'Name's</span></span><span>
</span><span id="line-1550"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1551"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterUserData"><span class="hs-identifier hs-type">WriterUserData</span></a></span><span>
</span><span id="line-1552"></span><span id="newWriteState"><span class="annot"><span class="annottext">newWriteState :: (WriteBinHandle -&gt; Name -&gt; IO ())
-&gt; (WriteBinHandle -&gt; Name -&gt; IO ())
-&gt; (WriteBinHandle -&gt; FastString -&gt; IO ())
-&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier hs-var hs-var">newWriteState</span></a></span></span><span> </span><span id="local-6989586621682486842"><span class="annot"><span class="annottext">WriteBinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621682486842"><span class="hs-identifier hs-var">put_non_binding_name</span></a></span></span><span> </span><span id="local-6989586621682486843"><span class="annot"><span class="annottext">WriteBinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621682486843"><span class="hs-identifier hs-var">put_binding_name</span></a></span></span><span> </span><span id="local-6989586621682486844"><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621682486844"><span class="hs-identifier hs-var">put_fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1553"></span><span>  </span><span class="annot"><span class="annottext">[SomeBinaryWriter] -&gt; WriterUserData
</span><a href="GHC.Utils.Binary.html#mkWriterUserData"><span class="hs-identifier hs-var">mkWriterUserData</span></a></span><span>
</span><span id="line-1554"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BinaryWriter BindingName -&gt; SomeBinaryWriter
forall a. Typeable a =&gt; BinaryWriter a -&gt; SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier hs-var">mkSomeBinaryWriter</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryWriter BindingName -&gt; SomeBinaryWriter)
-&gt; BinaryWriter BindingName -&gt; SomeBinaryWriter
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WriteBinHandle -&gt; BindingName -&gt; IO ())
-&gt; BinaryWriter BindingName
forall s. (WriteBinHandle -&gt; s -&gt; IO ()) -&gt; BinaryWriter s
</span><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-var">mkWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486845"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486845"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486846"><span class="annot"><span class="annottext">BindingName
</span><a href="#local-6989586621682486846"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621682486843"><span class="hs-identifier hs-var">put_binding_name</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486845"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindingName -&gt; Name
</span><a href="GHC.Utils.Binary.html#getBindingName"><span class="hs-identifier hs-var">getBindingName</span></a></span><span> </span><span class="annot"><span class="annottext">BindingName
</span><a href="#local-6989586621682486846"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1555"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryWriter Name -&gt; SomeBinaryWriter
forall a. Typeable a =&gt; BinaryWriter a -&gt; SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier hs-var">mkSomeBinaryWriter</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryWriter Name -&gt; SomeBinaryWriter)
-&gt; BinaryWriter Name -&gt; SomeBinaryWriter
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WriteBinHandle -&gt; Name -&gt; IO ()) -&gt; BinaryWriter Name
forall s. (WriteBinHandle -&gt; s -&gt; IO ()) -&gt; BinaryWriter s
</span><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-var">mkWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621682486842"><span class="hs-identifier hs-var">put_non_binding_name</span></a></span><span>
</span><span id="line-1556"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryWriter FastString -&gt; SomeBinaryWriter
forall a. Typeable a =&gt; BinaryWriter a -&gt; SomeBinaryWriter
</span><a href="GHC.Utils.Binary.html#mkSomeBinaryWriter"><span class="hs-identifier hs-var">mkSomeBinaryWriter</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryWriter FastString -&gt; SomeBinaryWriter)
-&gt; BinaryWriter FastString -&gt; SomeBinaryWriter
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WriteBinHandle -&gt; FastString -&gt; IO ()) -&gt; BinaryWriter FastString
forall s. (WriteBinHandle -&gt; s -&gt; IO ()) -&gt; BinaryWriter s
</span><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-var">mkWriter</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621682486844"><span class="hs-identifier hs-var">put_fs</span></a></span><span>
</span><span id="line-1557"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1558"></span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- Types for lookup and deduplication tables.</span><span>
</span><span id="line-1561"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span class="hs-comment">-- | A 'ReaderTable' describes how to deserialise a table from disk,</span><span>
</span><span id="line-1564"></span><span class="hs-comment">-- and how to create a 'BinaryReader' that looks up values in the deduplication table.</span><span>
</span><span id="line-1565"></span><span class="hs-keyword">data</span><span> </span><span id="ReaderTable"><span class="annot"><a href="GHC.Utils.Binary.html#ReaderTable"><span class="hs-identifier hs-var">ReaderTable</span></a></span></span><span> </span><span id="local-6989586621682484207"><span class="annot"><a href="#local-6989586621682484207"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReaderTable"><span class="annot"><a href="GHC.Utils.Binary.html#ReaderTable"><span class="hs-identifier hs-var">ReaderTable</span></a></span></span><span>
</span><span id="line-1566"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getTable"><span class="annot"><span class="annottext">forall a. ReaderTable a -&gt; ReadBinHandle -&gt; IO (SymbolTable a)
</span><a href="GHC.Utils.Binary.html#getTable"><span class="hs-identifier hs-var hs-var">getTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484207"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1567"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Deserialise a list of elements into a 'SymbolTable'.</span></span><span>
</span><span id="line-1568"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mkReaderFromTable"><span class="annot"><span class="annottext">forall a. ReaderTable a -&gt; SymbolTable a -&gt; BinaryReader a
</span><a href="GHC.Utils.Binary.html#mkReaderFromTable"><span class="hs-identifier hs-var hs-var">mkReaderFromTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryReader"><span class="hs-identifier hs-type">BinaryReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484207"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1569"></span><span>  </span><span class="hs-comment">-- ^ Given the table from 'getTable', create a 'BinaryReader'</span><span>
</span><span id="line-1570"></span><span>  </span><span class="hs-comment">-- that reads values only from the 'SymbolTable'.</span><span>
</span><span id="line-1571"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1572"></span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- | A 'WriterTable' is an interface any deduplication table can implement to</span><span>
</span><span id="line-1574"></span><span class="hs-comment">-- describe how the table can be written to disk.</span><span>
</span><span id="line-1575"></span><span class="hs-keyword">newtype</span><span> </span><span id="WriterTable"><span class="annot"><a href="GHC.Utils.Binary.html#WriterTable"><span class="hs-identifier hs-var">WriterTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WriterTable"><span class="annot"><a href="GHC.Utils.Binary.html#WriterTable"><span class="hs-identifier hs-var">WriterTable</span></a></span></span><span>
</span><span id="line-1576"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="putTable"><span class="annot"><span class="annottext">WriterTable -&gt; WriteBinHandle -&gt; IO Int
</span><a href="GHC.Utils.Binary.html#putTable"><span class="hs-identifier hs-var hs-var">putTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1577"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Serialise a table to disk. Returns the number of written elements.</span></span><span>
</span><span id="line-1578"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- Common data structures for constructing and maintaining lookup tables for</span><span>
</span><span id="line-1582"></span><span class="hs-comment">-- binary serialisation and deserialisation.</span><span>
</span><span id="line-1583"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span class="hs-comment">-- | The 'GenericSymbolTable' stores a mapping from already seen elements to an index.</span><span>
</span><span id="line-1586"></span><span class="hs-comment">-- If an element wasn't seen before, it is added to the mapping together with a fresh</span><span>
</span><span id="line-1587"></span><span class="hs-comment">-- index.</span><span>
</span><span id="line-1588"></span><span class="hs-comment">--</span><span>
</span><span id="line-1589"></span><span class="hs-comment">-- 'GenericSymbolTable' is a variant of a 'BinSymbolTable' that is polymorphic in the table implementation.</span><span>
</span><span id="line-1590"></span><span class="hs-comment">-- As such it can be used with any container that implements the 'TrieMap' type class.</span><span>
</span><span id="line-1591"></span><span class="hs-comment">--</span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- While 'GenericSymbolTable' is similar to the 'BinSymbolTable', it supports storing tree-like</span><span>
</span><span id="line-1593"></span><span class="hs-comment">-- structures such as 'Type' and 'IfaceType' more efficiently.</span><span>
</span><span id="line-1594"></span><span class="hs-comment">--</span><span>
</span><span id="line-1595"></span><span class="hs-keyword">data</span><span> </span><span id="GenericSymbolTable"><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-var">GenericSymbolTable</span></a></span></span><span> </span><span id="local-6989586621682484213"><span class="annot"><a href="#local-6989586621682484213"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenericSymbolTable"><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-var">GenericSymbolTable</span></a></span></span><span>
</span><span id="line-1596"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gen_symtab_next"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). GenericSymbolTable m -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#gen_symtab_next"><span class="hs-identifier hs-var hs-var">gen_symtab_next</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span>
</span><span id="line-1597"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The next index to use.</span></span><span>
</span><span id="line-1598"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gen_symtab_map"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). GenericSymbolTable m -&gt; IORef (m Int)
</span><a href="GHC.Utils.Binary.html#gen_symtab_map"><span class="hs-identifier hs-var hs-var">gen_symtab_map</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682484213"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Given a symbol, find the symbol and return its index.</span></span><span>
</span><span id="line-1600"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gen_symtab_to_write"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). GenericSymbolTable m -&gt; IORef [Key m]
</span><a href="GHC.Utils.Binary.html#gen_symtab_to_write"><span class="hs-identifier hs-var hs-var">gen_symtab_to_write</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484213"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1601"></span><span>  </span><span class="hs-comment">-- ^ Reversed list of values to write into the buffer.</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-comment">-- This is an optimisation, as it allows us to write out quickly all</span><span>
</span><span id="line-1603"></span><span>  </span><span class="hs-comment">-- newly discovered values that are discovered when serialising 'Key m'</span><span>
</span><span id="line-1604"></span><span>  </span><span class="hs-comment">-- to disk.</span><span>
</span><span id="line-1605"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1606"></span><span>
</span><span id="line-1607"></span><span class="annot"><span class="hs-comment">-- | Initialise a 'GenericSymbolTable', initialising the index to '0'.</span></span><span>
</span><span id="line-1608"></span><span id="local-6989586621682484219"><span class="annot"><a href="GHC.Utils.Binary.html#initGenericSymbolTable"><span class="hs-identifier hs-type">initGenericSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484219"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-type">GenericSymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484219"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1609"></span><span id="initGenericSymbolTable"><span class="annot"><span class="annottext">initGenericSymbolTable :: forall (m :: * -&gt; *). TrieMap m =&gt; IO (GenericSymbolTable m)
</span><a href="GHC.Utils.Binary.html#initGenericSymbolTable"><span class="hs-identifier hs-var hs-var">initGenericSymbolTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1610"></span><span>  </span><span id="local-6989586621682486862"><span class="annot"><a href="#local-6989586621682486862"><span class="hs-identifier hs-var">symtab_next</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1611"></span><span>  </span><span id="local-6989586621682486863"><span class="annot"><a href="#local-6989586621682486863"><span class="hs-identifier hs-var">symtab_map</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#emptyTM"><span class="hs-identifier hs-type">emptyTM</span></a></span><span>
</span><span id="line-1612"></span><span>  </span><span id="local-6989586621682486865"><span class="annot"><a href="#local-6989586621682486865"><span class="hs-identifier hs-var">symtab_todo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1613"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-type">GenericSymbolTable</span></a></span><span>
</span><span id="line-1614"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#gen_symtab_next"><span class="hs-identifier hs-var">gen_symtab_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486862"><span class="hs-identifier hs-type">symtab_next</span></a></span><span>
</span><span id="line-1615"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#gen_symtab_map"><span class="hs-identifier hs-var">gen_symtab_map</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486863"><span class="hs-identifier hs-type">symtab_map</span></a></span><span>
</span><span id="line-1616"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#gen_symtab_to_write"><span class="hs-identifier hs-var">gen_symtab_to_write</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486865"><span class="hs-identifier hs-type">symtab_todo</span></a></span><span>
</span><span id="line-1617"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1618"></span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- | Serialise the 'GenericSymbolTable' to disk.</span><span>
</span><span id="line-1620"></span><span class="hs-comment">--</span><span>
</span><span id="line-1621"></span><span class="hs-comment">-- Since 'GenericSymbolTable' stores tree-like structures, such as 'IfaceType',</span><span>
</span><span id="line-1622"></span><span class="hs-comment">-- serialising an element can add new elements to the mapping.</span><span>
</span><span id="line-1623"></span><span class="hs-comment">-- Thus, 'putGenericSymbolTable' first serialises all values, and then checks whether any</span><span>
</span><span id="line-1624"></span><span class="hs-comment">-- new elements have been discovered. If so, repeat the loop.</span><span>
</span><span id="line-1625"></span><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymbolTable"><span class="hs-identifier hs-type">putGenericSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484224"><span class="annot"><a href="#local-6989586621682484224"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484224"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-type">GenericSymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1626"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymbolTable"><span class="hs-pragma hs-type">putGenericSymbolTable</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1627"></span><span id="putGenericSymbolTable"><span class="annot"><span class="annottext">putGenericSymbolTable :: forall (m :: * -&gt; *).
TrieMap m =&gt;
GenericSymbolTable m
-&gt; (WriteBinHandle -&gt; Key m -&gt; IO ()) -&gt; WriteBinHandle -&gt; IO Int
</span><a href="GHC.Utils.Binary.html#putGenericSymbolTable"><span class="hs-identifier hs-var hs-var">putGenericSymbolTable</span></a></span></span><span> </span><span id="local-6989586621682486874"><span class="annot"><span class="annottext">GenericSymbolTable m
</span><a href="#local-6989586621682486874"><span class="hs-identifier hs-var">gen_sym_tab</span></a></span></span><span> </span><span id="local-6989586621682486875"><span class="annot"><span class="annottext">WriteBinHandle -&gt; Key m -&gt; IO ()
</span><a href="#local-6989586621682486875"><span class="hs-identifier hs-var">serialiser</span></a></span></span><span> </span><span id="local-6989586621682486876"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486876"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1628"></span><span>  </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; IO Int
</span><a href="#local-6989586621682486877"><span class="hs-identifier hs-var">putGenericSymbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486876"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1629"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1630"></span><span>    </span><span id="local-6989586621682486878"><span class="annot"><span class="annottext">symtab_next :: FastMutInt
</span><a href="#local-6989586621682486878"><span class="hs-identifier hs-var hs-var">symtab_next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericSymbolTable m -&gt; FastMutInt
forall (m :: * -&gt; *). GenericSymbolTable m -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#gen_symtab_next"><span class="hs-identifier hs-var">gen_symtab_next</span></a></span><span> </span><span class="annot"><span class="annottext">GenericSymbolTable m
</span><a href="#local-6989586621682486874"><span class="hs-identifier hs-var">gen_sym_tab</span></a></span><span>
</span><span id="line-1631"></span><span>    </span><span id="local-6989586621682486879"><span class="annot"><span class="annottext">symtab_to_write :: IORef [Key m]
</span><a href="#local-6989586621682486879"><span class="hs-identifier hs-var hs-var">symtab_to_write</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericSymbolTable m -&gt; IORef [Key m]
forall (m :: * -&gt; *). GenericSymbolTable m -&gt; IORef [Key m]
</span><a href="GHC.Utils.Binary.html#gen_symtab_to_write"><span class="hs-identifier hs-var">gen_symtab_to_write</span></a></span><span> </span><span class="annot"><span class="annottext">GenericSymbolTable m
</span><a href="#local-6989586621682486874"><span class="hs-identifier hs-var">gen_sym_tab</span></a></span><span>
</span><span id="line-1632"></span><span>    </span><span class="annot"><a href="#local-6989586621682486877"><span class="hs-identifier hs-type">putGenericSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1633"></span><span>    </span><span id="local-6989586621682486877"><span class="annot"><span class="annottext">putGenericSymbolTable :: WriteBinHandle -&gt; IO Int
</span><a href="#local-6989586621682486877"><span class="hs-identifier hs-var hs-var">putGenericSymbolTable</span></a></span></span><span> </span><span id="local-6989586621682486880"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486880"><span class="hs-identifier hs-var">bh</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1634"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682486881"><span class="annot"><span class="annottext">loop :: IO Int
</span><a href="#local-6989586621682486881"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1635"></span><span>            </span><span id="local-6989586621682486882"><span class="annot"><a href="#local-6989586621682486882"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef [Key m] -&gt; ([Key m] -&gt; ([Key m], [Key m])) -&gt; IO [Key m]
forall a b. IORef a -&gt; (a -&gt; (a, b)) -&gt; IO b
</span><span class="hs-identifier hs-var">atomicModifyIORef'</span></span><span> </span><span class="annot"><span class="annottext">IORef [Key m]
</span><a href="#local-6989586621682486879"><span class="hs-identifier hs-var">symtab_to_write</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486884"><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486884"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486884"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682486882"><span class="hs-identifier hs-type">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1637"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486878"><span class="hs-identifier hs-var">symtab_next</span></a></span><span>
</span><span id="line-1638"></span><span>              </span><span id="local-6989586621682486885"><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486885"><span class="hs-identifier hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1639"></span><span>                </span><span class="annot"><span class="annottext">(Key m -&gt; IO ()) -&gt; [Key m] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486886"><span class="annot"><span class="annottext">Key m
</span><a href="#local-6989586621682486886"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Key m -&gt; IO ()
</span><a href="#local-6989586621682486875"><span class="hs-identifier hs-var">serialiser</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486880"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Key m
</span><a href="#local-6989586621682486886"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Key m] -&gt; [Key m]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486885"><span class="hs-identifier hs-var">todo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1640"></span><span>                </span><span class="annot"><span class="annottext">IO Int
</span><a href="#local-6989586621682486881"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-1641"></span><span>      </span><span class="annot"><span class="annottext">((), Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(((), Int) -&gt; Int) -&gt; IO ((), Int) -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1642"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriteBinHandle -&gt; (Int -&gt; IO ()) -&gt; IO Int -&gt; IO ((), Int)
forall b a. WriteBinHandle -&gt; (b -&gt; IO a) -&gt; IO b -&gt; IO (a, b)
</span><a href="GHC.Utils.Binary.html#forwardPutRel"><span class="hs-identifier hs-var">forwardPutRel</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486880"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; Int -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Int -&gt; IO ()) -&gt; IO () -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486878"><span class="hs-identifier hs-var">symtab_next</span></a></span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486880"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; IO ((), Int)) -&gt; IO Int -&gt; IO ((), Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1643"></span><span>          </span><span class="annot"><span class="annottext">IO Int
</span><a href="#local-6989586621682486881"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span>
</span><span id="line-1645"></span><span class="annot"><span class="hs-comment">-- | Read the elements of a 'GenericSymbolTable' from disk into a 'SymbolTable'.</span></span><span>
</span><span id="line-1646"></span><span class="annot"><a href="GHC.Utils.Binary.html#getGenericSymbolTable"><span class="hs-identifier hs-type">getGenericSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682484234"><span class="annot"><a href="#local-6989586621682484234"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484234"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484234"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span id="getGenericSymbolTable"><span class="annot"><span class="annottext">getGenericSymbolTable :: forall a.
(ReadBinHandle -&gt; IO a) -&gt; ReadBinHandle -&gt; IO (SymbolTable a)
</span><a href="GHC.Utils.Binary.html#getGenericSymbolTable"><span class="hs-identifier hs-var hs-var">getGenericSymbolTable</span></a></span></span><span> </span><span id="local-6989586621682486910"><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
</span><a href="#local-6989586621682486910"><span class="hs-identifier hs-var">deserialiser</span></a></span></span><span> </span><span id="local-6989586621682486911"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486911"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1648"></span><span>  </span><span id="local-6989586621682486912"><span class="annot"><a href="#local-6989586621682486912"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int -&gt; IO Int
forall a. ReadBinHandle -&gt; IO a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#forwardGetRel"><span class="hs-identifier hs-var">forwardGetRel</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486911"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486911"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1649"></span><span>  </span><span id="local-6989586621682486913"><span class="annot"><a href="#local-6989586621682486913"><span class="hs-identifier hs-var">mut_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#newArray_"><span class="hs-identifier hs-type">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682486912"><span class="hs-identifier hs-type">sz</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621682484234"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486912"><span class="hs-identifier hs-type">sz</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682486915"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486915"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1651"></span><span>    </span><span id="local-6989586621682486916"><span class="annot"><a href="#local-6989586621682486916"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO a
</span><a href="#local-6989586621682486910"><span class="hs-identifier hs-var">deserialiser</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486911"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1652"></span><span>    </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#writeArray"><span class="hs-identifier hs-type">writeArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486913"><span class="hs-identifier hs-type">mut_arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486915"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486916"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1653"></span><span>  </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-type">unsafeFreeze</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486913"><span class="hs-identifier hs-type">mut_arr</span></a></span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="hs-comment">-- | Write an element 'Key m' to the given 'WriteBinHandle'.</span><span>
</span><span id="line-1656"></span><span class="hs-comment">--</span><span>
</span><span id="line-1657"></span><span class="hs-comment">-- If the element was seen before, we simply write the index of that element to the</span><span>
</span><span id="line-1658"></span><span class="hs-comment">-- 'WriteBinHandle'. If we haven't seen it before, we add the element to</span><span>
</span><span id="line-1659"></span><span class="hs-comment">-- the 'GenericSymbolTable', increment the index, and return this new index.</span><span>
</span><span id="line-1660"></span><span id="local-6989586621682484253"><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymTab"><span class="hs-identifier hs-type">putGenericSymTab</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.TrieMap.html#TrieMap"><span class="hs-identifier hs-type">TrieMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484253"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-type">GenericSymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1661"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putGenericSymTab"><span class="hs-pragma hs-type">putGenericSymTab</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1662"></span><span id="putGenericSymTab"><span class="annot"><span class="annottext">putGenericSymTab :: forall (m :: * -&gt; *).
TrieMap m =&gt;
GenericSymbolTable m -&gt; WriteBinHandle -&gt; Key m -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putGenericSymTab"><span class="hs-identifier hs-var hs-var">putGenericSymTab</span></a></span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#GenericSymbolTable"><span class="hs-identifier hs-type">GenericSymbolTable</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-1663"></span><span>               </span><span class="annot"><span class="annottext">gen_symtab_map :: forall (m :: * -&gt; *). GenericSymbolTable m -&gt; IORef (m Int)
</span><a href="GHC.Utils.Binary.html#gen_symtab_map"><span class="hs-identifier hs-var">gen_symtab_map</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682486935"><span class="annot"><span class="annottext">IORef (m Int)
</span><a href="#local-6989586621682486935"><span class="hs-identifier hs-var">symtab_map_ref</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1664"></span><span>               </span><span class="annot"><span class="annottext">gen_symtab_next :: forall (m :: * -&gt; *). GenericSymbolTable m -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#gen_symtab_next"><span class="hs-identifier hs-var">gen_symtab_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682486936"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486936"><span class="hs-identifier hs-var">symtab_next</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-1665"></span><span>               </span><span class="annot"><span class="annottext">gen_symtab_to_write :: forall (m :: * -&gt; *). GenericSymbolTable m -&gt; IORef [Key m]
</span><a href="GHC.Utils.Binary.html#gen_symtab_to_write"><span class="hs-identifier hs-var">gen_symtab_to_write</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682486937"><span class="annot"><span class="annottext">IORef [Key m]
</span><a href="#local-6989586621682486937"><span class="hs-identifier hs-var">symtab_todo</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1666"></span><span>        </span><span id="local-6989586621682486938"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486938"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486939"><span class="annot"><span class="annottext">Key m
</span><a href="#local-6989586621682486939"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1667"></span><span>  </span><span id="local-6989586621682486940"><span class="annot"><a href="#local-6989586621682486940"><span class="hs-identifier hs-var">symtab_map</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (m Int) -&gt; IO (m Int)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (m Int)
</span><a href="#local-6989586621682486935"><span class="hs-identifier hs-var">symtab_map_ref</span></a></span><span>
</span><span id="line-1668"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#lookupTM"><span class="hs-identifier hs-type">lookupTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486939"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486940"><span class="hs-identifier hs-type">symtab_map</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1669"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682486942"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486942"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486938"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486942"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-1670"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1671"></span><span>      </span><span id="local-6989586621682486943"><span class="annot"><a href="#local-6989586621682486943"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486936"><span class="hs-identifier hs-var">symtab_next</span></a></span><span>
</span><span id="line-1672"></span><span>      </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486936"><span class="hs-identifier hs-type">symtab_next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486943"><span class="hs-identifier hs-type">off</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1673"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682486935"><span class="hs-identifier hs-type">symtab_map_ref</span></a></span><span>
</span><span id="line-1674"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.Data.TrieMap.html#insertTM"><span class="hs-identifier hs-type">insertTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486939"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486943"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486940"><span class="hs-identifier hs-type">symtab_map</span></a></span><span>
</span><span id="line-1675"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">atomicModifyIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682486937"><span class="hs-identifier hs-type">symtab_todo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682486946"><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486946"><span class="hs-identifier hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key m
</span><a href="#local-6989586621682486939"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Key m -&gt; [Key m] -&gt; [Key m]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Key m]
</span><a href="#local-6989586621682486946"><span class="hs-identifier hs-var">todo</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1676"></span><span>      </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486938"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682486943"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-1677"></span><span>
</span><span id="line-1678"></span><span class="annot"><span class="hs-comment">-- | Read a value from a 'SymbolTable'.</span></span><span>
</span><span id="line-1679"></span><span id="local-6989586621682484258"><span class="annot"><a href="GHC.Utils.Binary.html#getGenericSymtab"><span class="hs-identifier hs-type">getGenericSymtab</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484258"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484258"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621682484258"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1680"></span><span id="getGenericSymtab"><span class="annot"><span class="annottext">getGenericSymtab :: forall a. Binary a =&gt; SymbolTable a -&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getGenericSymtab"><span class="hs-identifier hs-var hs-var">getGenericSymtab</span></a></span></span><span> </span><span id="local-6989586621682486954"><span class="annot"><span class="annottext">SymbolTable a
</span><a href="#local-6989586621682486954"><span class="hs-identifier hs-var">symtab</span></a></span></span><span> </span><span id="local-6989586621682486955"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486955"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1681"></span><span>  </span><span id="local-6989586621682486956"><span class="annot"><a href="#local-6989586621682486956"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486955"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1682"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621682486954"><span class="hs-identifier hs-type">symtab</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">!</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682486956"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1683"></span><span>
</span><span id="line-1684"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1685"></span><span class="hs-comment">-- The Dictionary</span><span>
</span><span id="line-1686"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="annot"><span class="hs-comment">-- | A 'SymbolTable' of 'FastString's.</span></span><span>
</span><span id="line-1689"></span><span class="hs-keyword">type</span><span> </span><span id="Dictionary"><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier hs-var">Dictionary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1690"></span><span>
</span><span id="line-1691"></span><span class="annot"><a href="GHC.Utils.Binary.html#initFastStringReaderTable"><span class="hs-identifier hs-type">initFastStringReaderTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderTable"><span class="hs-identifier hs-type">ReaderTable</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1692"></span><span id="initFastStringReaderTable"><span class="annot"><span class="annottext">initFastStringReaderTable :: IO (ReaderTable FastString)
</span><a href="GHC.Utils.Binary.html#initFastStringReaderTable"><span class="hs-identifier hs-var hs-var">initFastStringReaderTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1693"></span><span>  </span><span class="annot"><span class="annottext">ReaderTable FastString -&gt; IO (ReaderTable FastString)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ReaderTable FastString -&gt; IO (ReaderTable FastString))
-&gt; ReaderTable FastString -&gt; IO (ReaderTable FastString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1694"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#ReaderTable"><span class="hs-identifier hs-type">ReaderTable</span></a></span><span>
</span><span id="line-1695"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">getTable :: ReadBinHandle -&gt; IO (SymbolTable FastString)
</span><a href="GHC.Utils.Binary.html#getTable"><span class="hs-identifier hs-var">getTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO (SymbolTable FastString)
</span><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier hs-var">getDictionary</span></a></span><span>
</span><span id="line-1696"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mkReaderFromTable :: SymbolTable FastString -&gt; BinaryReader FastString
</span><a href="GHC.Utils.Binary.html#mkReaderFromTable"><span class="hs-identifier hs-var">mkReaderFromTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682486959"><span class="annot"><span class="annottext">SymbolTable FastString
</span><a href="#local-6989586621682486959"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ReadBinHandle -&gt; IO FastString) -&gt; BinaryReader FastString
forall s. (ReadBinHandle -&gt; IO s) -&gt; BinaryReader s
</span><a href="GHC.Utils.Binary.html#mkReader"><span class="hs-identifier hs-var">mkReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable FastString -&gt; ReadBinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getDictFastString"><span class="hs-identifier hs-var">getDictFastString</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable FastString
</span><a href="#local-6989586621682486959"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-1698"></span><span>
</span><span id="line-1699"></span><span class="annot"><a href="GHC.Utils.Binary.html#initFastStringWriterTable"><span class="hs-identifier hs-type">initFastStringWriterTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#WriterTable"><span class="hs-identifier hs-type">WriterTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinaryWriter"><span class="hs-identifier hs-type">BinaryWriter</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1700"></span><span id="initFastStringWriterTable"><span class="annot"><span class="annottext">initFastStringWriterTable :: IO (WriterTable, BinaryWriter FastString)
</span><a href="GHC.Utils.Binary.html#initFastStringWriterTable"><span class="hs-identifier hs-var hs-var">initFastStringWriterTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1701"></span><span>  </span><span id="local-6989586621682486960"><span class="annot"><a href="#local-6989586621682486960"><span class="hs-identifier hs-var">dict_next_ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1702"></span><span>  </span><span id="local-6989586621682486961"><span class="annot"><a href="#local-6989586621682486961"><span class="hs-identifier hs-var">dict_map_ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIORef</span></span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#emptyUFM"><span class="hs-identifier hs-type">emptyUFM</span></a></span><span>
</span><span id="line-1703"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682486963"><span class="annot"><a href="#local-6989586621682486963"><span class="hs-identifier hs-var hs-var">bin_dict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1704"></span><span>        </span><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-type">FSTable</span></a></span><span>
</span><span id="line-1705"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fs_tab_next :: FastMutInt
</span><a href="GHC.Utils.Binary.html#fs_tab_next"><span class="hs-identifier hs-var">fs_tab_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486960"><span class="hs-identifier hs-var">dict_next_ref</span></a></span><span>
</span><span id="line-1706"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fs_tab_map :: IORef (UniqFM FastString (Int, FastString))
</span><a href="GHC.Utils.Binary.html#fs_tab_map"><span class="hs-identifier hs-var">fs_tab_map</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef (UniqFM FastString (Int, FastString))
</span><a href="#local-6989586621682486961"><span class="hs-identifier hs-var">dict_map_ref</span></a></span><span>
</span><span id="line-1707"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1708"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682486967"><span class="annot"><a href="#local-6989586621682486967"><span class="hs-identifier hs-var hs-var">put_dict</span></a></span></span><span> </span><span id="local-6989586621682486968"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486968"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1709"></span><span>        </span><span id="local-6989586621682486969"><span class="annot"><a href="#local-6989586621682486969"><span class="hs-identifier hs-var">fs_count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486960"><span class="hs-identifier hs-var">dict_next_ref</span></a></span><span>
</span><span id="line-1710"></span><span>        </span><span id="local-6989586621682486970"><span class="annot"><a href="#local-6989586621682486970"><span class="hs-identifier hs-var">dict_map</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682486961"><span class="hs-identifier hs-type">dict_map_ref</span></a></span><span>
</span><span id="line-1711"></span><span>        </span><span class="annot"><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier hs-type">putDictionary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486968"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486969"><span class="hs-identifier hs-type">fs_count</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486970"><span class="hs-identifier hs-type">dict_map</span></a></span><span>
</span><span id="line-1712"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682486969"><span class="hs-identifier hs-type">fs_count</span></a></span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>
</span><span id="line-1715"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriterTable"><span class="hs-identifier hs-type">WriterTable</span></a></span><span>
</span><span id="line-1716"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putTable"><span class="hs-identifier hs-var">putTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682486967"><span class="hs-identifier hs-type">put_dict</span></a></span><span>
</span><span id="line-1717"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1718"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#mkWriter"><span class="hs-identifier hs-type">mkWriter</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putDictFastString"><span class="hs-identifier hs-type">putDictFastString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486963"><span class="hs-identifier hs-type">bin_dict</span></a></span><span>
</span><span id="line-1719"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1720"></span><span>
</span><span id="line-1721"></span><span class="annot"><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier hs-type">putDictionary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1722"></span><span id="putDictionary"><span class="annot"><span class="annottext">putDictionary :: WriteBinHandle
-&gt; Int -&gt; UniqFM FastString (Int, FastString) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier hs-var hs-var">putDictionary</span></a></span></span><span> </span><span id="local-6989586621682486971"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486971"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486972"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486972"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621682486973"><span class="annot"><span class="annottext">UniqFM FastString (Int, FastString)
</span><a href="#local-6989586621682486973"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1723"></span><span>  </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486971"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486972"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-1724"></span><span>  </span><span class="annot"><span class="annottext">(FastString -&gt; IO ()) -&gt; [FastString] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-var">putFS</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486971"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable FastString -&gt; [FastString]
forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; [(Int, FastString)] -&gt; SymbolTable FastString
forall i e. Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e
</span><span class="hs-identifier hs-var">array</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486972"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqFM FastString (Int, FastString) -&gt; [(Int, FastString)]
forall {k} (key :: k) elt. UniqFM key elt -&gt; [elt]
</span><a href="GHC.Types.Unique.FM.html#nonDetEltsUFM"><span class="hs-identifier hs-var">nonDetEltsUFM</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM FastString (Int, FastString)
</span><a href="#local-6989586621682486973"><span class="hs-identifier hs-var">dict</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>    </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here because the elements have indices</span><span>
</span><span id="line-1726"></span><span>    </span><span class="hs-comment">-- that array uses to create order</span><span>
</span><span id="line-1727"></span><span>
</span><span id="line-1728"></span><span class="annot"><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier hs-type">getDictionary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier hs-type">Dictionary</span></a></span><span>
</span><span id="line-1729"></span><span id="getDictionary"><span class="annot"><span class="annottext">getDictionary :: ReadBinHandle -&gt; IO (SymbolTable FastString)
</span><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier hs-var hs-var">getDictionary</span></a></span></span><span> </span><span id="local-6989586621682486976"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486976"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1730"></span><span>  </span><span id="local-6989586621682486977"><span class="annot"><a href="#local-6989586621682486977"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486976"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1731"></span><span>  </span><span id="local-6989586621682486978"><span class="annot"><a href="#local-6989586621682486978"><span class="hs-identifier hs-var">mut_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#newArray_"><span class="hs-identifier hs-type">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682486977"><span class="hs-identifier hs-type">sz</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IOArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1732"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486977"><span class="hs-identifier hs-type">sz</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682486979"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486979"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1733"></span><span>    </span><span id="local-6989586621682486980"><span class="annot"><a href="#local-6989586621682486980"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-var">getFS</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486976"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1734"></span><span>    </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#writeArray"><span class="hs-identifier hs-type">writeArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486978"><span class="hs-identifier hs-type">mut_arr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486979"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486980"><span class="hs-identifier hs-type">fs</span></a></span><span>
</span><span id="line-1735"></span><span>  </span><span class="annot"><a href="../../array-0.5.8.0-9044/src/Data.Array.Base.html#unsafeFreeze"><span class="hs-identifier hs-type">unsafeFreeze</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486978"><span class="hs-identifier hs-type">mut_arr</span></a></span><span>
</span><span id="line-1736"></span><span>
</span><span id="line-1737"></span><span class="annot"><a href="GHC.Utils.Binary.html#getDictFastString"><span class="hs-identifier hs-type">getDictFastString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier hs-type">Dictionary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1738"></span><span id="getDictFastString"><span class="annot"><span class="annottext">getDictFastString :: SymbolTable FastString -&gt; ReadBinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getDictFastString"><span class="hs-identifier hs-var hs-var">getDictFastString</span></a></span></span><span> </span><span id="local-6989586621682486982"><span class="annot"><span class="annottext">SymbolTable FastString
</span><a href="#local-6989586621682486982"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span id="local-6989586621682486983"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486983"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1739"></span><span>    </span><span id="local-6989586621682486984"><span class="annot"><a href="#local-6989586621682486984"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word32
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682486983"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1740"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486982"><span class="hs-identifier hs-type">dict</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">!</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486984"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1741"></span><span>
</span><span id="line-1742"></span><span class="annot"><a href="GHC.Utils.Binary.html#putDictFastString"><span class="hs-identifier hs-type">putDictFastString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-type">FSTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span id="putDictFastString"><span class="annot"><span class="annottext">putDictFastString :: FSTable -&gt; WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putDictFastString"><span class="hs-identifier hs-var hs-var">putDictFastString</span></a></span></span><span> </span><span id="local-6989586621682486985"><span class="annot"><span class="annottext">FSTable
</span><a href="#local-6989586621682486985"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span id="local-6989586621682486986"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486986"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682486987"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682486987"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FSTable -&gt; FastString -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#allocateFastString"><span class="hs-identifier hs-var">allocateFastString</span></a></span><span> </span><span class="annot"><span class="annottext">FSTable
</span><a href="#local-6989586621682486985"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682486987"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">IO Word32 -&gt; (Word32 -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word32 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682486986"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1744"></span><span>
</span><span id="line-1745"></span><span class="annot"><a href="GHC.Utils.Binary.html#allocateFastString"><span class="hs-identifier hs-type">allocateFastString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-type">FSTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-1746"></span><span id="allocateFastString"><span class="annot"><span class="annottext">allocateFastString :: FSTable -&gt; FastString -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#allocateFastString"><span class="hs-identifier hs-var hs-var">allocateFastString</span></a></span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-type">FSTable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fs_tab_next :: FSTable -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#fs_tab_next"><span class="hs-identifier hs-var">fs_tab_next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682486989"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486989"><span class="hs-identifier hs-var">j_r</span></a></span></span><span>
</span><span id="line-1747"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fs_tab_map :: FSTable -&gt; IORef (UniqFM FastString (Int, FastString))
</span><a href="GHC.Utils.Binary.html#fs_tab_map"><span class="hs-identifier hs-var">fs_tab_map</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682486990"><span class="annot"><span class="annottext">IORef (UniqFM FastString (Int, FastString))
</span><a href="#local-6989586621682486990"><span class="hs-identifier hs-var">out_r</span></a></span></span><span>
</span><span id="line-1748"></span><span>                           </span><span class="hs-special">}</span><span> </span><span id="local-6989586621682486991"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682486991"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1749"></span><span>    </span><span id="local-6989586621682486992"><span class="annot"><a href="#local-6989586621682486992"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (UniqFM FastString (Int, FastString))
-&gt; IO (UniqFM FastString (Int, FastString))
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (UniqFM FastString (Int, FastString))
</span><a href="#local-6989586621682486990"><span class="hs-identifier hs-var">out_r</span></a></span><span>
</span><span id="line-1750"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682486993"><span class="annot"><a href="#local-6989586621682486993"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Unique
forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682486991"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1751"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#lookupUFM_Directly"><span class="hs-identifier hs-type">lookupUFM_Directly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486992"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486993"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1752"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682486996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486996"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; IO Word32
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682486996"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-1753"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Int, FastString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1754"></span><span>           </span><span id="local-6989586621682486997"><span class="annot"><a href="#local-6989586621682486997"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621682486989"><span class="hs-identifier hs-var">j_r</span></a></span><span>
</span><span id="line-1755"></span><span>           </span><span class="annot"><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-type">writeFastMutInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486989"><span class="hs-identifier hs-type">j_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486997"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1756"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621682486990"><span class="hs-identifier hs-type">out_r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#addToUFM_Directly"><span class="hs-identifier hs-type">addToUFM_Directly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486992"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682486993"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682486997"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682486991"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1757"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682486997"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-1758"></span><span>
</span><span id="line-1759"></span><span class="hs-comment">-- FSTable is an exact copy of Haddock.InterfaceFile.BinDictionary. We rename to</span><span>
</span><span id="line-1760"></span><span class="hs-comment">-- avoid a collision and copy to avoid a dependency.</span><span>
</span><span id="line-1761"></span><span class="hs-keyword">data</span><span> </span><span id="FSTable"><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-var">FSTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FSTable"><span class="annot"><a href="GHC.Utils.Binary.html#FSTable"><span class="hs-identifier hs-var">FSTable</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fs_tab_next"><span class="annot"><span class="annottext">FSTable -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#fs_tab_next"><span class="hs-identifier hs-var hs-var">fs_tab_next</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span> </span><span class="hs-comment">-- The next index to use</span><span>
</span><span id="line-1762"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="fs_tab_map"><span class="annot"><span class="annottext">FSTable -&gt; IORef (UniqFM FastString (Int, FastString))
</span><a href="GHC.Utils.Binary.html#fs_tab_map"><span class="hs-identifier hs-var hs-var">fs_tab_map</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.FM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1763"></span><span>                                </span><span class="hs-comment">-- indexed by FastString</span><span>
</span><span id="line-1764"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1765"></span><span>
</span><span id="line-1766"></span><span>
</span><span id="line-1767"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1768"></span><span class="hs-comment">-- The Symbol Table</span><span>
</span><span id="line-1769"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1770"></span><span>
</span><span id="line-1771"></span><span class="hs-comment">-- | Symbols that are read from disk.</span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- The 'SymbolTable' index starts on '0'.</span><span>
</span><span id="line-1773"></span><span class="hs-keyword">type</span><span> </span><span id="SymbolTable"><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span> </span><span id="local-6989586621682486999"><span class="annot"><a href="#local-6989586621682486999"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621682486999"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1774"></span><span>
</span><span id="line-1775"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1776"></span><span class="hs-comment">-- Reading and writing FastStrings</span><span>
</span><span id="line-1777"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-1778"></span><span>
</span><span id="line-1779"></span><span class="annot"><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-type">putFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1780"></span><span id="putFS"><span class="annot"><span class="annottext">putFS :: WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-var hs-var">putFS</span></a></span></span><span> </span><span id="local-6989586621682487000"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487000"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487001"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487001"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var">putBS</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487000"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; ByteString
</span><a href="GHC.Data.FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487001"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1781"></span><span>
</span><span id="line-1782"></span><span class="annot"><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-type">getFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1783"></span><span id="getFS"><span class="annot"><span class="annottext">getFS :: ReadBinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-var hs-var">getFS</span></a></span></span><span> </span><span id="local-6989586621682487004"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487004"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1784"></span><span>  </span><span id="local-6989586621682487005"><span class="annot"><a href="#local-6989586621682487005"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487004"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1785"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-type">getPrim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487004"><span class="hs-identifier hs-type">bh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487005"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682487006"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487006"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; IO FastString
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; IO FastString) -&gt; FastString -&gt; IO FastString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastStringBytes"><span class="hs-identifier hs-var">mkFastStringBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487006"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487005"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1786"></span><span>
</span><span id="line-1787"></span><span class="hs-comment">-- | Put a ByteString without its length (can't be read back without knowing the</span><span>
</span><span id="line-1788"></span><span class="hs-comment">-- length!)</span><span>
</span><span id="line-1789"></span><span class="annot"><a href="GHC.Utils.Binary.html#putByteString"><span class="hs-identifier hs-type">putByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1790"></span><span id="putByteString"><span class="annot"><span class="annottext">putByteString :: WriteBinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByteString"><span class="hs-identifier hs-var hs-var">putByteString</span></a></span></span><span> </span><span id="local-6989586621682487008"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487008"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487009"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487009"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1791"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; (CStringLen -&gt; IO ()) -&gt; IO ()
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Unsafe.html#unsafeUseAsCStringLen"><span class="hs-identifier hs-var">BS.unsafeUseAsCStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487009"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">((CStringLen -&gt; IO ()) -&gt; IO ()) -&gt; (CStringLen -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682487011"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621682487011"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682487012"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487012"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1792"></span><span>    </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487008"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487012"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682487013"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487013"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487013"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span><span class="hs-identifier hs-var">castPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621682487011"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487012"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1793"></span><span>
</span><span id="line-1794"></span><span class="annot"><span class="hs-comment">-- | Get a ByteString whose length is known</span></span><span>
</span><span id="line-1795"></span><span class="annot"><a href="GHC.Utils.Binary.html#getByteString"><span class="hs-identifier hs-type">getByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1796"></span><span id="getByteString"><span class="annot"><span class="annottext">getByteString :: ReadBinHandle -&gt; Int -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#getByteString"><span class="hs-identifier hs-var hs-var">getByteString</span></a></span></span><span> </span><span id="local-6989586621682487015"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487015"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487016"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487016"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1797"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#create"><span class="hs-identifier hs-var">BS.create</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487016"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682487018"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487018"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1798"></span><span>    </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487015"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487016"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682487019"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487019"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487018"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487019"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487016"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1799"></span><span>
</span><span id="line-1800"></span><span class="annot"><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-type">putBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#WriteBinHandle"><span class="hs-identifier hs-type">WriteBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1801"></span><span id="putBS"><span class="annot"><span class="annottext">putBS :: WriteBinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var hs-var">putBS</span></a></span></span><span> </span><span id="local-6989586621682487020"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487020"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487021"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487021"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1802"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; (CStringLen -&gt; IO ()) -&gt; IO ()
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Unsafe.html#unsafeUseAsCStringLen"><span class="hs-identifier hs-var">BS.unsafeUseAsCStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487021"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">((CStringLen -&gt; IO ()) -&gt; IO ()) -&gt; (CStringLen -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682487022"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621682487022"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682487023"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487023"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1803"></span><span>    </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487020"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487023"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1804"></span><span>    </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487020"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487023"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682487024"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487024"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487024"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span><span class="hs-identifier hs-var">castPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621682487022"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487023"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1805"></span><span>
</span><span id="line-1806"></span><span class="annot"><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-type">getBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#ReadBinHandle"><span class="hs-identifier hs-type">ReadBinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1807"></span><span id="getBS"><span class="annot"><span class="annottext">getBS :: ReadBinHandle -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-var hs-var">getBS</span></a></span></span><span> </span><span id="local-6989586621682487026"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487026"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1808"></span><span>  </span><span id="local-6989586621682487027"><span class="annot"><a href="#local-6989586621682487027"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Int
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487026"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1809"></span><span>  </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#create"><span class="hs-identifier hs-type">BS.create</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487027"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682487028"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487028"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1810"></span><span>    </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a. ReadBinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487026"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487027"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682487029"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487029"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487028"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621682487029"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682487027"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1811"></span><span>
</span><span id="line-1812"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487032"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1813"></span><span>  </span><span id="local-6989586621682487036"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487037"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487037"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487038"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487038"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var">putBS</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487037"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682487038"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1814"></span><span>  </span><span id="local-6989586621682487039"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487040"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487040"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-var">getBS</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487040"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1815"></span><span>
</span><span id="line-1816"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487043"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1817"></span><span>  </span><span id="local-6989586621682487048"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487049"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487049"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487050"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487050"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1818"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy FastString -&gt; WriteBinHandle -&gt; BinaryWriter FastString
forall a. Typeable a =&gt; Proxy a -&gt; WriteBinHandle -&gt; BinaryWriter a
</span><a href="GHC.Utils.Binary.html#findUserDataWriter"><span class="hs-identifier hs-var">findUserDataWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy FastString
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487049"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1819"></span><span>      </span><span id="local-6989586621682487052"><span class="annot"><span class="annottext">BinaryWriter FastString
</span><a href="#local-6989586621682487052"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinaryWriter FastString -&gt; WriteBinHandle -&gt; FastString -&gt; IO ()
forall s. BinaryWriter s -&gt; WriteBinHandle -&gt; s -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putEntry"><span class="hs-identifier hs-var">putEntry</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryWriter FastString
</span><a href="#local-6989586621682487052"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487049"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487050"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1820"></span><span>
</span><span id="line-1821"></span><span>  </span><span id="local-6989586621682487054"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487055"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487055"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1822"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy FastString -&gt; ReadBinHandle -&gt; BinaryReader FastString
forall a. Typeable a =&gt; Proxy a -&gt; ReadBinHandle -&gt; BinaryReader a
</span><a href="GHC.Utils.Binary.html#findUserDataReader"><span class="hs-identifier hs-var">findUserDataReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy FastString
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487055"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1823"></span><span>      </span><span id="local-6989586621682487056"><span class="annot"><span class="annottext">BinaryReader FastString
</span><a href="#local-6989586621682487056"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinaryReader FastString -&gt; ReadBinHandle -&gt; IO FastString
forall s. BinaryReader s -&gt; ReadBinHandle -&gt; IO s
</span><a href="GHC.Utils.Binary.html#getEntry"><span class="hs-identifier hs-var">getEntry</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryReader FastString
</span><a href="#local-6989586621682487056"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487055"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span id="local-6989586621682487058"><span id="local-6989586621682487062"><span id="local-6989586621682487066"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#NonDetFastString"><span class="hs-identifier hs-type">NonDetFastString</span></a></span></span></span></span><span>
</span><span id="line-1826"></span><span id="local-6989586621682487071"><span id="local-6989586621682487075"><span id="local-6989586621682487079"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier hs-type">LexicalFastString</span></a></span></span></span></span><span>
</span><span id="line-1827"></span><span>
</span><span id="line-1828"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487085"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fingerprint</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1829"></span><span>  </span><span id="local-6989586621682487092"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; Fingerprint -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487093"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487093"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fingerprint</span></span><span> </span><span id="local-6989586621682487094"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682487094"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621682487095"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682487095"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word64 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487093"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682487094"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word64 -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487093"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682487095"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-1830"></span><span>  </span><span id="local-6989586621682487101"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO Fingerprint
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621682487102"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487102"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682487103"><span class="annot"><a href="#local-6989586621682487103"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word64
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487102"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621682487104"><span class="annot"><a href="#local-6989586621682487104"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487102"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fingerprint</span></span><span> </span><span class="annot"><a href="#local-6989586621682487103"><span class="hs-identifier hs-type">w1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487104"><span class="hs-identifier hs-type">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1831"></span><span>
</span><span id="line-1832"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487107"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1833"></span><span>  </span><span id="local-6989586621682487112"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; ModuleName -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487113"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487113"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span id="local-6989586621682487115"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487115"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487113"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487115"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1834"></span><span>  </span><span id="local-6989586621682487119"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO ModuleName
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487120"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487120"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682487121"><span class="annot"><a href="#local-6989586621682487121"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487120"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487121"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1835"></span><span>
</span><span id="line-1836"></span><span class="hs-comment">-- instance Binary TupleSort where</span><span>
</span><span id="line-1837"></span><span class="hs-comment">--     put_ bh BoxedTuple      = putByte bh 0</span><span>
</span><span id="line-1838"></span><span class="hs-comment">--     put_ bh UnboxedTuple    = putByte bh 1</span><span>
</span><span id="line-1839"></span><span class="hs-comment">--     put_ bh ConstraintTuple = putByte bh 2</span><span>
</span><span id="line-1840"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1841"></span><span class="hs-comment">--       h &lt;- getByte bh</span><span>
</span><span id="line-1842"></span><span class="hs-comment">--       case h of</span><span>
</span><span id="line-1843"></span><span class="hs-comment">--         0 -&gt; do return BoxedTuple</span><span>
</span><span id="line-1844"></span><span class="hs-comment">--         1 -&gt; do return UnboxedTuple</span><span>
</span><span id="line-1845"></span><span class="hs-comment">--         _ -&gt; do return ConstraintTuple</span><span>
</span><span id="line-1846"></span><span>
</span><span id="line-1847"></span><span class="hs-comment">-- instance Binary Activation where</span><span>
</span><span id="line-1848"></span><span class="hs-comment">--     put_ bh NeverActive = do</span><span>
</span><span id="line-1849"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1850"></span><span class="hs-comment">--     put_ bh FinalActive = do</span><span>
</span><span id="line-1851"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1852"></span><span class="hs-comment">--     put_ bh AlwaysActive = do</span><span>
</span><span id="line-1853"></span><span class="hs-comment">--             putByte bh 2</span><span>
</span><span id="line-1854"></span><span class="hs-comment">--     put_ bh (ActiveBefore src aa) = do</span><span>
</span><span id="line-1855"></span><span class="hs-comment">--             putByte bh 3</span><span>
</span><span id="line-1856"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1857"></span><span class="hs-comment">--             put_ bh aa</span><span>
</span><span id="line-1858"></span><span class="hs-comment">--     put_ bh (ActiveAfter src ab) = do</span><span>
</span><span id="line-1859"></span><span class="hs-comment">--             putByte bh 4</span><span>
</span><span id="line-1860"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1861"></span><span class="hs-comment">--             put_ bh ab</span><span>
</span><span id="line-1862"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1863"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1864"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1865"></span><span class="hs-comment">--               0 -&gt; do return NeverActive</span><span>
</span><span id="line-1866"></span><span class="hs-comment">--               1 -&gt; do return FinalActive</span><span>
</span><span id="line-1867"></span><span class="hs-comment">--               2 -&gt; do return AlwaysActive</span><span>
</span><span id="line-1868"></span><span class="hs-comment">--               3 -&gt; do src &lt;- get bh</span><span>
</span><span id="line-1869"></span><span class="hs-comment">--                       aa &lt;- get bh</span><span>
</span><span id="line-1870"></span><span class="hs-comment">--                       return (ActiveBefore src aa)</span><span>
</span><span id="line-1871"></span><span class="hs-comment">--               _ -&gt; do src &lt;- get bh</span><span>
</span><span id="line-1872"></span><span class="hs-comment">--                       ab &lt;- get bh</span><span>
</span><span id="line-1873"></span><span class="hs-comment">--                       return (ActiveAfter src ab)</span><span>
</span><span id="line-1874"></span><span>
</span><span id="line-1875"></span><span class="hs-comment">-- instance Binary InlinePragma where</span><span>
</span><span id="line-1876"></span><span class="hs-comment">--     put_ bh (InlinePragma s a b c d) = do</span><span>
</span><span id="line-1877"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1878"></span><span class="hs-comment">--             put_ bh a</span><span>
</span><span id="line-1879"></span><span class="hs-comment">--             put_ bh b</span><span>
</span><span id="line-1880"></span><span class="hs-comment">--             put_ bh c</span><span>
</span><span id="line-1881"></span><span class="hs-comment">--             put_ bh d</span><span>
</span><span id="line-1882"></span><span>
</span><span id="line-1883"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1884"></span><span class="hs-comment">--            s &lt;- get bh</span><span>
</span><span id="line-1885"></span><span class="hs-comment">--            a &lt;- get bh</span><span>
</span><span id="line-1886"></span><span class="hs-comment">--            b &lt;- get bh</span><span>
</span><span id="line-1887"></span><span class="hs-comment">--            c &lt;- get bh</span><span>
</span><span id="line-1888"></span><span class="hs-comment">--            d &lt;- get bh</span><span>
</span><span id="line-1889"></span><span class="hs-comment">--            return (InlinePragma s a b c d)</span><span>
</span><span id="line-1890"></span><span>
</span><span id="line-1891"></span><span class="hs-comment">-- instance Binary RuleMatchInfo where</span><span>
</span><span id="line-1892"></span><span class="hs-comment">--     put_ bh FunLike = putByte bh 0</span><span>
</span><span id="line-1893"></span><span class="hs-comment">--     put_ bh ConLike = putByte bh 1</span><span>
</span><span id="line-1894"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1895"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1896"></span><span class="hs-comment">--             if h == 1 then return ConLike</span><span>
</span><span id="line-1897"></span><span class="hs-comment">--                       else return FunLike</span><span>
</span><span id="line-1898"></span><span>
</span><span id="line-1899"></span><span class="hs-comment">-- instance Binary InlineSpec where</span><span>
</span><span id="line-1900"></span><span class="hs-comment">--     put_ bh NoUserInlinePrag = putByte bh 0</span><span>
</span><span id="line-1901"></span><span class="hs-comment">--     put_ bh Inline           = putByte bh 1</span><span>
</span><span id="line-1902"></span><span class="hs-comment">--     put_ bh Inlinable        = putByte bh 2</span><span>
</span><span id="line-1903"></span><span class="hs-comment">--     put_ bh NoInline         = putByte bh 3</span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="hs-comment">--     get bh = do h &lt;- getByte bh</span><span>
</span><span id="line-1906"></span><span class="hs-comment">--                 case h of</span><span>
</span><span id="line-1907"></span><span class="hs-comment">--                   0 -&gt; return NoUserInlinePrag</span><span>
</span><span id="line-1908"></span><span class="hs-comment">--                   1 -&gt; return Inline</span><span>
</span><span id="line-1909"></span><span class="hs-comment">--                   2 -&gt; return Inlinable</span><span>
</span><span id="line-1910"></span><span class="hs-comment">--                   _ -&gt; return NoInline</span><span>
</span><span id="line-1911"></span><span>
</span><span id="line-1912"></span><span class="hs-comment">-- instance Binary RecFlag where</span><span>
</span><span id="line-1913"></span><span class="hs-comment">--     put_ bh Recursive = do</span><span>
</span><span id="line-1914"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1915"></span><span class="hs-comment">--     put_ bh NonRecursive = do</span><span>
</span><span id="line-1916"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1917"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1918"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1919"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1920"></span><span class="hs-comment">--               0 -&gt; do return Recursive</span><span>
</span><span id="line-1921"></span><span class="hs-comment">--               _ -&gt; do return NonRecursive</span><span>
</span><span id="line-1922"></span><span>
</span><span id="line-1923"></span><span class="hs-comment">-- instance Binary OverlapMode where</span><span>
</span><span id="line-1924"></span><span class="hs-comment">--     put_ bh (NoOverlap    s) = putByte bh 0 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1925"></span><span class="hs-comment">--     put_ bh (Overlaps     s) = putByte bh 1 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1926"></span><span class="hs-comment">--     put_ bh (Incoherent   s) = putByte bh 2 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1927"></span><span class="hs-comment">--     put_ bh (Overlapping  s) = putByte bh 3 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1928"></span><span class="hs-comment">--     put_ bh (Overlappable s) = putByte bh 4 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1929"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1930"></span><span class="hs-comment">--         h &lt;- getByte bh</span><span>
</span><span id="line-1931"></span><span class="hs-comment">--         case h of</span><span>
</span><span id="line-1932"></span><span class="hs-comment">--             0 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ NoOverlap s</span><span>
</span><span id="line-1933"></span><span class="hs-comment">--             1 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlaps s</span><span>
</span><span id="line-1934"></span><span class="hs-comment">--             2 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Incoherent s</span><span>
</span><span id="line-1935"></span><span class="hs-comment">--             3 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlapping s</span><span>
</span><span id="line-1936"></span><span class="hs-comment">--             4 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlappable s</span><span>
</span><span id="line-1937"></span><span class="hs-comment">--             _ -&gt; panic (&quot;get OverlapMode&quot; ++ show h)</span><span>
</span><span id="line-1938"></span><span>
</span><span id="line-1939"></span><span>
</span><span id="line-1940"></span><span class="hs-comment">-- instance Binary OverlapFlag where</span><span>
</span><span id="line-1941"></span><span class="hs-comment">--     put_ bh flag = do put_ bh (overlapMode flag)</span><span>
</span><span id="line-1942"></span><span class="hs-comment">--                       put_ bh (isSafeOverlap flag)</span><span>
</span><span id="line-1943"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1944"></span><span class="hs-comment">--         h &lt;- get bh</span><span>
</span><span id="line-1945"></span><span class="hs-comment">--         b &lt;- get bh</span><span>
</span><span id="line-1946"></span><span class="hs-comment">--         return OverlapFlag { overlapMode = h, isSafeOverlap = b }</span><span>
</span><span id="line-1947"></span><span>
</span><span id="line-1948"></span><span class="hs-comment">-- instance Binary FixityDirection where</span><span>
</span><span id="line-1949"></span><span class="hs-comment">--     put_ bh InfixL = do</span><span>
</span><span id="line-1950"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1951"></span><span class="hs-comment">--     put_ bh InfixR = do</span><span>
</span><span id="line-1952"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1953"></span><span class="hs-comment">--     put_ bh InfixN = do</span><span>
</span><span id="line-1954"></span><span class="hs-comment">--             putByte bh 2</span><span>
</span><span id="line-1955"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1956"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1957"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1958"></span><span class="hs-comment">--               0 -&gt; do return InfixL</span><span>
</span><span id="line-1959"></span><span class="hs-comment">--               1 -&gt; do return InfixR</span><span>
</span><span id="line-1960"></span><span class="hs-comment">--               _ -&gt; do return InfixN</span><span>
</span><span id="line-1961"></span><span>
</span><span id="line-1962"></span><span class="hs-comment">-- instance Binary Fixity where</span><span>
</span><span id="line-1963"></span><span class="hs-comment">--     put_ bh (Fixity src aa ab) = do</span><span>
</span><span id="line-1964"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1965"></span><span class="hs-comment">--             put_ bh aa</span><span>
</span><span id="line-1966"></span><span class="hs-comment">--             put_ bh ab</span><span>
</span><span id="line-1967"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1968"></span><span class="hs-comment">--           src &lt;- get bh</span><span>
</span><span id="line-1969"></span><span class="hs-comment">--           aa &lt;- get bh</span><span>
</span><span id="line-1970"></span><span class="hs-comment">--           ab &lt;- get bh</span><span>
</span><span id="line-1971"></span><span class="hs-comment">--           return (Fixity src aa ab)</span><span>
</span><span id="line-1972"></span><span>
</span><span id="line-1973"></span><span class="hs-comment">-- instance Binary WarningTxt where</span><span>
</span><span id="line-1974"></span><span class="hs-comment">--     put_ bh (WarningTxt s w) = do</span><span>
</span><span id="line-1975"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1976"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1977"></span><span class="hs-comment">--             put_ bh w</span><span>
</span><span id="line-1978"></span><span class="hs-comment">--     put_ bh (DeprecatedTxt s d) = do</span><span>
</span><span id="line-1979"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1980"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1981"></span><span class="hs-comment">--             put_ bh d</span><span>
</span><span id="line-1982"></span><span>
</span><span id="line-1983"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1984"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1985"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1986"></span><span class="hs-comment">--               0 -&gt; do s &lt;- get bh</span><span>
</span><span id="line-1987"></span><span class="hs-comment">--                       w &lt;- get bh</span><span>
</span><span id="line-1988"></span><span class="hs-comment">--                       return (WarningTxt s w)</span><span>
</span><span id="line-1989"></span><span class="hs-comment">--               _ -&gt; do s &lt;- get bh</span><span>
</span><span id="line-1990"></span><span class="hs-comment">--                       d &lt;- get bh</span><span>
</span><span id="line-1991"></span><span class="hs-comment">--                       return (DeprecatedTxt s d)</span><span>
</span><span id="line-1992"></span><span>
</span><span id="line-1993"></span><span class="hs-comment">-- instance Binary StringLiteral where</span><span>
</span><span id="line-1994"></span><span class="hs-comment">--   put_ bh (StringLiteral st fs _) = do</span><span>
</span><span id="line-1995"></span><span class="hs-comment">--             put_ bh st</span><span>
</span><span id="line-1996"></span><span class="hs-comment">--             put_ bh fs</span><span>
</span><span id="line-1997"></span><span class="hs-comment">--   get bh = do</span><span>
</span><span id="line-1998"></span><span class="hs-comment">--             st &lt;- get bh</span><span>
</span><span id="line-1999"></span><span class="hs-comment">--             fs &lt;- get bh</span><span>
</span><span id="line-2000"></span><span class="hs-comment">--             return (StringLiteral st fs Nothing)</span><span>
</span><span id="line-2001"></span><span>
</span><span id="line-2002"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinLocated"><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier hs-var">BinLocated</span></a></span></span><span> </span><span id="local-6989586621682484291"><span class="annot"><a href="#local-6989586621682484291"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinLocated"><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier hs-var">BinLocated</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unBinLocated"><span class="annot"><span class="annottext">forall a. BinLocated a -&gt; Located a
</span><a href="GHC.Utils.Binary.html#unBinLocated"><span class="hs-identifier hs-var hs-var">unBinLocated</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484291"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2003"></span><span>
</span><span id="line-2004"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484296"><span id="local-6989586621682487127"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484296"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier hs-type">BinLocated</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484296"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2005"></span><span>    </span><span id="local-6989586621682487135"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; BinLocated a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487136"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487136"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier hs-type">BinLocated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682487138"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682487138"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621682487139"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682487139"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2006"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; BinSrcSpan -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487136"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">(BinSrcSpan -&gt; IO ()) -&gt; BinSrcSpan -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; BinSrcSpan
</span><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-var">BinSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621682487138"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2007"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; a -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487136"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682487139"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-2008"></span><span>
</span><span id="line-2009"></span><span>    </span><span id="local-6989586621682487147"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (BinLocated a)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487148"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487148"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2010"></span><span>            </span><span id="local-6989586621682487149"><span class="annot"><a href="#local-6989586621682487149"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinSrcSpan -&gt; SrcSpan
</span><a href="GHC.Utils.Binary.html#unBinSrcSpan"><span class="hs-identifier hs-var">unBinSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">(BinSrcSpan -&gt; SrcSpan) -&gt; IO BinSrcSpan -&gt; IO SrcSpan
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO BinSrcSpan
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487148"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2011"></span><span>            </span><span id="local-6989586621682487151"><span class="annot"><a href="#local-6989586621682487151"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487148"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-2012"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinLocated"><span class="hs-identifier hs-type">BinLocated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487149"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487151"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span>
</span><span id="line-2014"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinSpan"><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-var">BinSpan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinSpan"><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-var">BinSpan</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unBinSpan"><span class="annot"><span class="annottext">BinSpan -&gt; RealSrcSpan
</span><a href="GHC.Utils.Binary.html#unBinSpan"><span class="hs-identifier hs-var hs-var">unBinSpan</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2015"></span><span>
</span><span id="line-2016"></span><span class="hs-comment">-- See Note [Source Location Wrappers]</span><span>
</span><span id="line-2017"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487156"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-type">BinSpan</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2018"></span><span>  </span><span id="local-6989586621682487169"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; BinSpan -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487170"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-type">BinSpan</span></a></span><span> </span><span id="local-6989586621682487171"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2019"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2021"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier hs-var">srcSpanStartCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2022"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanEndLine"><span class="hs-identifier hs-var">srcSpanEndLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2023"></span><span>            </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Int -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487170"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanEndCol"><span class="hs-identifier hs-var">srcSpanEndCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487171"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2024"></span><span>
</span><span id="line-2025"></span><span>  </span><span id="local-6989586621682487188"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO BinSpan
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487189"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487189"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2026"></span><span>            </span><span id="local-6989586621682487190"><span class="annot"><a href="#local-6989586621682487190"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487189"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2027"></span><span>            </span><span id="local-6989586621682487191"><span class="annot"><a href="#local-6989586621682487191"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487189"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-2028"></span><span>            </span><span id="local-6989586621682487192"><span class="annot"><a href="#local-6989586621682487192"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487189"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-2029"></span><span>            </span><span id="local-6989586621682487193"><span class="annot"><a href="#local-6989586621682487193"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487189"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-2030"></span><span>            </span><span id="local-6989586621682487194"><span class="annot"><a href="#local-6989586621682487194"><span class="hs-identifier hs-var">ec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487189"><span class="hs-identifier hs-type">bh</span></a></span><span>
</span><span id="line-2031"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-type">BinSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#mkRealSrcSpan"><span class="hs-identifier hs-type">mkRealSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#mkRealSrcLoc"><span class="hs-identifier hs-type">mkRealSrcLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487190"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487191"><span class="hs-identifier hs-type">sl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487192"><span class="hs-identifier hs-type">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2032"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#mkRealSrcLoc"><span class="hs-identifier hs-type">mkRealSrcLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487190"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487193"><span class="hs-identifier hs-type">el</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487194"><span class="hs-identifier hs-type">ec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2033"></span><span>
</span><span id="line-2034"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487199"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulSpanReason"><span class="hs-identifier hs-type">UnhelpfulSpanReason</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2035"></span><span>  </span><span id="local-6989586621682487210"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; UnhelpfulSpanReason -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487211"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487212"><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621682487212"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621682487212"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2036"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulNoLocationInfo"><span class="hs-identifier hs-var">UnhelpfulNoLocationInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2037"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulWiredIn"><span class="hs-identifier hs-var">UnhelpfulWiredIn</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2038"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulInteractive"><span class="hs-identifier hs-var">UnhelpfulInteractive</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2039"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulGenerated"><span class="hs-identifier hs-var">UnhelpfulGenerated</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span>
</span><span id="line-2040"></span><span>    </span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulOther"><span class="hs-identifier hs-type">UnhelpfulOther</span></a></span><span> </span><span id="local-6989586621682487218"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487218"><span class="hs-identifier hs-var">fs</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; FastString -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487211"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621682487218"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-2041"></span><span>
</span><span id="line-2042"></span><span>  </span><span id="local-6989586621682487234"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO UnhelpfulSpanReason
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487235"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487235"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2043"></span><span>    </span><span id="local-6989586621682487236"><span class="annot"><a href="#local-6989586621682487236"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487235"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2044"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682487236"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2045"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason -&gt; IO UnhelpfulSpanReason
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulNoLocationInfo"><span class="hs-identifier hs-var">UnhelpfulNoLocationInfo</span></a></span><span>
</span><span id="line-2046"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason -&gt; IO UnhelpfulSpanReason
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulWiredIn"><span class="hs-identifier hs-var">UnhelpfulWiredIn</span></a></span><span>
</span><span id="line-2047"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason -&gt; IO UnhelpfulSpanReason
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulInteractive"><span class="hs-identifier hs-var">UnhelpfulInteractive</span></a></span><span>
</span><span id="line-2048"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason -&gt; IO UnhelpfulSpanReason
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulGenerated"><span class="hs-identifier hs-var">UnhelpfulGenerated</span></a></span><span>
</span><span id="line-2049"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulOther"><span class="hs-identifier hs-var">UnhelpfulOther</span></a></span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; UnhelpfulSpanReason)
-&gt; IO FastString -&gt; IO UnhelpfulSpanReason
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO FastString
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487235"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2050"></span><span>
</span><span id="line-2051"></span><span class="hs-keyword">newtype</span><span> </span><span id="BinSrcSpan"><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-var">BinSrcSpan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinSrcSpan"><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-var">BinSrcSpan</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unBinSrcSpan"><span class="annot"><span class="annottext">BinSrcSpan -&gt; SrcSpan
</span><a href="GHC.Utils.Binary.html#unBinSrcSpan"><span class="hs-identifier hs-var hs-var">unBinSrcSpan</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2052"></span><span>
</span><span id="line-2053"></span><span class="hs-comment">-- See Note [Source Location Wrappers]</span><span>
</span><span id="line-2054"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682487239"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-type">BinSrcSpan</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2055"></span><span>  </span><span id="local-6989586621682487248"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; BinSrcSpan -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487249"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487249"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-type">BinSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span id="local-6989586621682487251"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487251"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621682487252"><span class="annot"><span class="annottext">Maybe BufSpan
</span><a href="#local-6989586621682487252"><span class="hs-identifier hs-var">_sb</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2056"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487249"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2057"></span><span>          </span><span class="hs-comment">-- BufSpan doesn't ever get serialised because the positions depend</span><span>
</span><span id="line-2058"></span><span>          </span><span class="hs-comment">-- on build location.</span><span>
</span><span id="line-2059"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; BinSpan -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487249"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">(BinSpan -&gt; IO ()) -&gt; BinSpan -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan -&gt; BinSpan
</span><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-var">BinSpan</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621682487251"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-2060"></span><span>
</span><span id="line-2061"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621682487253"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487253"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-type">BinSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulSpan"><span class="hs-identifier hs-type">UnhelpfulSpan</span></a></span><span> </span><span id="local-6989586621682487255"><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621682487255"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2062"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487253"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2063"></span><span>          </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; UnhelpfulSpanReason -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487253"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621682487255"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-2064"></span><span>
</span><span id="line-2065"></span><span>  </span><span id="local-6989586621682487265"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO BinSrcSpan
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487266"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487266"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2066"></span><span>          </span><span id="local-6989586621682487267"><span class="annot"><a href="#local-6989586621682487267"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487266"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2067"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682487267"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2068"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSpan"><span class="hs-identifier hs-type">BinSpan</span></a></span><span> </span><span id="local-6989586621682487268"><span class="annot"><a href="#local-6989586621682487268"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO BinSpan
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487266"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2069"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-type">BinSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487268"><span class="hs-identifier hs-type">ss</span></a></span><span> </span><span class="annot"><a href="GHC.Data.Strict.html#Nothing"><span class="hs-identifier hs-type">Strict.Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2070"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682487269"><span class="annot"><a href="#local-6989586621682487269"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO UnhelpfulSpanReason
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487266"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2071"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinSrcSpan"><span class="hs-identifier hs-type">BinSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulSpan"><span class="hs-identifier hs-type">UnhelpfulSpan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682487269"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2072"></span><span>
</span><span id="line-2073"></span><span>
</span><span id="line-2074"></span><span class="hs-comment">{-
Note [Source Location Wrappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Source locations are banned from interface files, to
prevent filepaths affecting interface hashes.

Unfortunately, we can't remove all binary instances,
as they're used to serialise .hie files, and we don't
want to break binary compatibility.

To this end, the Bin[Src]Span newtypes wrappers were
introduced to prevent accidentally serialising a
source location as part of a larger structure.
-}</span><span>
</span><span id="line-2089"></span><span>
</span><span id="line-2090"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2091"></span><span class="hs-comment">-- Instances for the containers package</span><span>
</span><span id="line-2092"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2093"></span><span>
</span><span id="line-2094"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682484311"><span id="local-6989586621682487273"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682484311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2095"></span><span>  </span><span id="local-6989586621682487279"><span class="annot"><span class="annottext">put_ :: WriteBinHandle -&gt; IntMap v -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621682487280"><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487280"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621682487281"><span class="annot"><span class="annottext">IntMap v
</span><a href="#local-6989586621682487281"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriteBinHandle -&gt; [(Int, v)] -&gt; IO ()
forall a. Binary a =&gt; WriteBinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">WriteBinHandle
</span><a href="#local-6989586621682487280"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap v -&gt; [(Int, v)]
forall a. IntMap a -&gt; [(Int, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#toList"><span class="hs-identifier hs-var">IntMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap v
</span><a href="#local-6989586621682487281"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2096"></span><span>  </span><span id="local-6989586621682487286"><span class="annot"><span class="annottext">get :: ReadBinHandle -&gt; IO (IntMap v)
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621682487287"><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487287"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, v)] -&gt; IntMap v
forall a. [(Int, a)] -&gt; IntMap a
</span><a href="../../containers-0.7-5a8f/src/Data.IntMap.Internal.html#fromList"><span class="hs-identifier hs-var">IntMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, v)] -&gt; IntMap v) -&gt; IO [(Int, v)] -&gt; IO (IntMap v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle -&gt; IO [(Int, v)]
forall a. Binary a =&gt; ReadBinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">ReadBinHandle
</span><a href="#local-6989586621682487287"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-2097"></span></pre></body></html>