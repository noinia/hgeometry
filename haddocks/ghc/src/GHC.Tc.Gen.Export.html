<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections     #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html"><span class="hs-identifier">GHC.Tc.Gen.Export</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#rnExports"><span class="hs-identifier">rnExports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#exports_from_avail"><span class="hs-identifier">exports_from_avail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#classifyGREs"><span class="hs-identifier">classifyGREs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html"><span class="hs-identifier">GHC.Tc.Errors.Types</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#TyThing"><span class="hs-identifier">TyThing</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AConLike"><span class="hs-identifier">AConLike</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier">AnId</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupGlobal"><span class="hs-identifier">tcLookupGlobal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier">tcLookupTyCon</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html"><span class="hs-identifier">GHC.Rename.Doc</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Module.html"><span class="hs-identifier">GHC.Rename.Module</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html"><span class="hs-identifier">GHC.Rename.Names</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html"><span class="hs-identifier">GHC.Rename.Env</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html"><span class="hs-identifier">GHC.Rename.Unbound</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Unbound.html#reportUnboundName"><span class="hs-identifier">reportUnboundName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Imported.html"><span class="hs-identifier">GHC.Unit.Module.Imported</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html"><span class="hs-identifier">GHC.Unit.Module.Warnings</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Misc.html#sndOf3"><span class="hs-identifier">sndOf3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#thdOf3"><span class="hs-identifier">thdOf3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html"><span class="hs-identifier">GHC.Core.ConLike</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html"><span class="hs-identifier">GHC.Core.PatSyn</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier">fsLit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Parser.PostProcess.html"><span class="hs-identifier">GHC.Parser.PostProcess</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Parser.PostProcess.html#setRdrNameSpace"><span class="hs-identifier">setRdrNameSpace</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.12.2-1a37/src/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Map.html"><span class="hs-identifier">GHC.Types.Unique.Map</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html"><span class="hs-identifier">GHC.Types.DefaultEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.DefaultEnv.html#ClassDefaults"><span class="hs-identifier">ClassDefaults</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.DefaultEnv.html#cd_class"><span class="hs-identifier">cd_class</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#DefaultEnv"><span class="hs-identifier">DefaultEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>                             </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#emptyDefaultEnv"><span class="hs-identifier">emptyDefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#filterDefaultEnv"><span class="hs-identifier">filterDefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#isEmptyDefaultEnv"><span class="hs-identifier">isEmptyDefaultEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html"><span class="hs-identifier">GHC.Types.Avail</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html"><span class="hs-identifier">GHC.Types.SourceFile</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Traversable.html"><span class="hs-identifier">Data.Traversable</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">for</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Export list processing}
*                                                                      *
************************************************************************

Processing the export list.

You might think that we should record things that appear in the export
list as ``occurrences'' (using @addOccurrenceName@), but you'd be
wrong.  We do check (here) that they are in scope, but there is no
need to slurp in their actual declaration (which is what
@addOccurrenceName@ forces).

Indeed, doing so would big trouble when compiling @PrelBase@, because
it re-exports @GHC@, which includes @takeMVar#@, whose type includes
@ConcBase.StateAndSynchVar#@, and so on...

Note [Exports of data families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose you see (#5306)
        module M where
          import X( F )
          data instance F Int = FInt
What does M export?  AvailTC F [FInt]
                  or AvailTC F [F,FInt]?
The former is strictly right because F isn't defined in this module.
But then you can never do an explicit import of M, thus
    import M( F( FInt ) )
because F isn't exported by M.  Nor can you import FInt alone from here
    import M( FInt )
because we don't have syntax to support that.  (It looks like an import of
the type FInt.)

At one point I implemented a compromise:
  * When constructing exports with no export list, or with module M(
    module M ), we add the parent to the exports as well.
  * But not when you see module M( f ), even if f is a
    class method with a parent.
  * Nor when you see module M( module N ), with N /= M.

But the compromise seemed too much of a hack, so we backed it out.
You just have to use an explicit export list:
    module M( F(..) ) where ...

Note [Avails of associated data families]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose you have (#16077)

    {-# LANGUAGE TypeFamilies #-}
    module A (module A) where

    class    C a  where { data T a }
    instance C () where { data T () = D }

Because @A@ is exported explicitly, GHC tries to produce an export list
from the @GlobalRdrEnv@. In this case, it pulls out the following:

    [ C defined at A.hs:4:1
    , T parent:C defined at A.hs:4:23
    , D parent:T defined at A.hs:5:35 ]

If map these directly into avails, (via 'availFromGRE'), we get
@[C{C;}, C{T;}, T{D;}]@, which eventually gets merged into @[C{C, T;}, T{D;}]@.
That's not right, because @T{D;}@ violates the AvailTC invariant: @T@ is
exported, but it isn't the first entry in the avail!

We work around this issue by expanding GREs where the parent and child
are both type constructors into two GRES.

    T parent:C defined at A.hs:4:23

      =&gt;

    [ T parent:C defined at A.hs:4:23
    , T defined at A.hs:4:23 ]

Then, we get  @[C{C;}, C{T;}, T{T;}, T{D;}]@, which eventually gets merged
into @[C{C, T;}, T{T, D;}]@ (which satisfies the AvailTC invariant).
-}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="ExportAccum"><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-var">ExportAccum</span></a></span></span><span>        </span><span class="hs-comment">-- The type of the accumulating parameter of</span><span>
</span><span id="line-143"></span><span>                        </span><span class="hs-comment">-- the main worker function in rnExports</span><span>
</span><span id="line-144"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="ExportAccum"><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-var">ExportAccum</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-145"></span><span>         </span><span id="expacc_exp_occs"><span class="annot"><span class="annottext">ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var hs-var">expacc_exp_occs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Tracks exported occurrence names</span></span><span>
</span><span id="line-147"></span><span>         </span><span id="expacc_mods"><span class="annot"><span class="annottext">ExportAccum -&gt; UniqMap ModuleName [Name]
</span><a href="GHC.Tc.Gen.Export.html#expacc_mods"><span class="hs-identifier hs-var hs-var">expacc_mods</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Map.html#UniqMap"><span class="hs-identifier hs-type">UniqMap</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>           </span><span class="hs-comment">-- ^ Tracks (re-)exported module names</span><span>
</span><span id="line-149"></span><span>           </span><span class="hs-comment">--   and the names they re-export</span><span>
</span><span id="line-150"></span><span>         </span><span id="expacc_warn_spans"><span class="annot"><span class="annottext">ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var hs-var">expacc_warn_spans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-type">ExportWarnSpanNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Information about warnings for names</span></span><span>
</span><span id="line-152"></span><span>         </span><span id="expacc_dont_warn"><span class="annot"><span class="annottext">ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var hs-var">expacc_dont_warn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span>
</span><span id="line-153"></span><span>           </span><span class="hs-comment">-- ^ What names not to export warnings for</span><span>
</span><span id="line-154"></span><span>           </span><span class="hs-comment">--   (because they are exported without a warning)</span><span>
</span><span id="line-155"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#emptyExportAccum"><span class="hs-identifier hs-type">emptyExportAccum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span>
</span><span id="line-159"></span><span id="emptyExportAccum"><span class="annot"><span class="annottext">emptyExportAccum :: ExportAccum
</span><a href="GHC.Tc.Gen.Export.html#emptyExportAccum"><span class="hs-identifier hs-var hs-var">emptyExportAccum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExportOccMap
-&gt; UniqMap ModuleName [Name]
-&gt; ExportWarnSpanNames
-&gt; DontWarnExportNames
-&gt; ExportAccum
</span><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-var">ExportAccum</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
forall a. OccEnv a
</span><a href="GHC.Types.Name.Occurrence.html#emptyOccEnv"><span class="hs-identifier hs-var">emptyOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">UniqMap ModuleName [Name]
forall k a. UniqMap k a
</span><a href="GHC.Types.Unique.Map.html#emptyUniqMap"><span class="hs-identifier hs-var">emptyUniqMap</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DontWarnExportNames
forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621683063558"><span id="local-6989586621683063559"><span class="annot"><a href="GHC.Tc.Gen.Export.html#accumExports"><span class="hs-identifier hs-type">accumExports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683063558"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621683063559"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683063558"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683063559"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-type">ExportWarnSpanNames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-164"></span><span id="accumExports"><span class="annot"><span class="annottext">accumExports :: forall x y.
(ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y))
-&gt; [x] -&gt; TcRn ([y], ExportWarnSpanNames, DontWarnExportNames)
</span><a href="GHC.Tc.Gen.Export.html#accumExports"><span class="hs-identifier hs-var hs-var">accumExports</span></a></span></span><span> </span><span id="local-6989586621683064088"><span class="annot"><span class="annottext">ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y)
</span><a href="#local-6989586621683064088"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621683064089"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621683064089"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064090"><span class="annot"><a href="#local-6989586621683064090"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span> </span><span id="local-6989586621683064091"><span class="annot"><a href="#local-6989586621683064091"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064092"><span class="annot"><a href="#local-6989586621683064092"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y))
-&gt; ExportAccum
-&gt; [x]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (ExportAccum, [Maybe y])
forall (m :: * -&gt; *) (t :: * -&gt; *) acc x y.
(Monad m, Traversable t) =&gt;
(acc -&gt; x -&gt; m (acc, y)) -&gt; acc -&gt; t x -&gt; m (acc, t y)
</span><a href="GHC.Utils.Monad.html#mapAccumLM"><span class="hs-identifier hs-var">mapAccumLM</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y)
</span><a href="#local-6989586621683064094"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
</span><a href="GHC.Tc.Gen.Export.html#emptyExportAccum"><span class="hs-identifier hs-var">emptyExportAccum</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621683064089"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">catMaybes</span></span><span> </span><span class="annot"><a href="#local-6989586621683064092"><span class="hs-identifier hs-type">ys</span></a></span><span>
</span><span id="line-168"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064090"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-169"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064091"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621683064094"><span class="annot"><span class="annottext">f' :: ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y)
</span><a href="#local-6989586621683064094"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621683064096"><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064096"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621683064097"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621683064097"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExportAccum, Maybe y)
-&gt; Maybe (ExportAccum, Maybe y) -&gt; (ExportAccum, Maybe y)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064096"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe y
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (ExportAccum, Maybe y) -&gt; (ExportAccum, Maybe y))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (ExportAccum, Maybe y))
-&gt; TcRn (ExportAccum, Maybe y)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TcRn (ExportAccum, Maybe y)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (ExportAccum, Maybe y))
forall r. TcRn r -&gt; TcRn (Maybe r)
</span><a href="GHC.Tc.Utils.Monad.html#attemptM"><span class="hs-identifier hs-var">attemptM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y)
</span><a href="#local-6989586621683064088"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064096"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621683064097"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">type</span><span> </span><span id="ExportOccMap"><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-var">ExportOccMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-comment">-- Tracks what a particular exported OccName</span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-comment">--   in an export list refers to, and which item</span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-comment">--   it came from.  It's illegal to export two distinct things</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-comment">--   that have the same occurrence name</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#rnExports"><span class="hs-identifier hs-type">rnExports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>       </span><span class="hs-comment">-- False =&gt; no 'module M(..) where' header at all</span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedLI"><span class="hs-identifier hs-type">LocatedLI</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Nothing =&gt; no explicit export list</span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-comment">-- Complains if two distinct exports have same OccName</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-comment">-- Warns about identical exports.</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-comment">-- Complains about exports items not in scope</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="rnExports"><span class="annot"><span class="annottext">rnExports :: Bool -&gt; Maybe (LocatedLI [LIE GhcPs]) -&gt; RnM TcGblEnv
</span><a href="GHC.Tc.Gen.Export.html#rnExports"><span class="hs-identifier hs-var hs-var">rnExports</span></a></span></span><span> </span><span id="local-6989586621683064101"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064101"><span class="hs-identifier hs-var">explicit_mod</span></a></span></span><span> </span><span id="local-6989586621683064102"><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><a href="#local-6989586621683064102"><span class="hs-identifier hs-var">exports</span></a></span></span><span>
</span><span id="line-188"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RnM TcGblEnv -&gt; RnM TcGblEnv
forall r. TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Monad.html#checkNoErrs"><span class="hs-identifier hs-var">checkNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">(RnM TcGblEnv -&gt; RnM TcGblEnv) -&gt; RnM TcGblEnv -&gt; RnM TcGblEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>   </span><span class="hs-comment">-- Fail if anything in rnExports finds</span><span>
</span><span id="line-189"></span><span>                   </span><span class="hs-comment">-- an error fails, to avoid error cascade</span><span>
</span><span id="line-190"></span><span>   </span><span class="hs-keyword">do</span><span>   </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064104"><span class="annot"><a href="#local-6989586621683064104"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRnIf TcGblEnv TcLclEnv HscEnv
forall gbl lcl. TcRnIf gbl lcl HscEnv
</span><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064106"><span class="annot"><a href="#local-6989586621683064106"><span class="hs-identifier hs-var">tcg_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#getGblEnv"><span class="hs-identifier hs-type">getGblEnv</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064108"><span class="annot"><a href="#local-6989586621683064108"><span class="hs-identifier hs-var hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; DynFlags
</span><a href="GHC.Driver.Env.Types.html#hsc_dflags"><span class="hs-identifier hs-var">hsc_dflags</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621683064104"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-193"></span><span>              </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_mod"><span class="hs-identifier hs-var">tcg_mod</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064112"><span class="annot"><a href="#local-6989586621683064112"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span>
</span><span id="line-194"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_rdr_env"><span class="hs-identifier hs-var">tcg_rdr_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064114"><span class="annot"><a href="#local-6989586621683064114"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span>
</span><span id="line-195"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_imports"><span class="hs-identifier hs-var">tcg_imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064116"><span class="annot"><a href="#local-6989586621683064116"><span class="hs-identifier hs-var">imports</span></a></span></span><span>
</span><span id="line-196"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_warns"><span class="hs-identifier hs-var">tcg_warns</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064118"><span class="annot"><a href="#local-6989586621683064118"><span class="hs-identifier hs-var">warns</span></a></span></span><span>
</span><span id="line-197"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_src"><span class="hs-identifier hs-var">tcg_src</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064120"><span class="annot"><a href="#local-6989586621683064120"><span class="hs-identifier hs-var">hsc_src</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064106"><span class="hs-identifier hs-type">tcg_env</span></a></span><span>
</span><span id="line-198"></span><span>              </span><span id="local-6989586621683064121"><span class="annot"><a href="#local-6989586621683064121"><span class="hs-identifier hs-var hs-var">default_main</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HomeUnitEnv -&gt; Module
</span><a href="GHC.Driver.Env.html#mainModIs"><span class="hs-identifier hs-var">mainModIs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; HomeUnitEnv
</span><a href="GHC.Driver.Env.html#hsc_HUE"><span class="hs-identifier hs-var">hsc_HUE</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621683064104"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module -&gt; Module -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064112"><span class="hs-identifier hs-var">this_mod</span></a></span><span>
</span><span id="line-199"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064124"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064124"><span class="hs-identifier hs-var">main_fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe String
</span><a href="GHC.Driver.DynFlags.html#mainFunIs"><span class="hs-identifier hs-var">mainFunIs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683064108"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-200"></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; FastString -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkUnqual"><span class="hs-identifier hs-var">mkUnqual</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064124"><span class="hs-identifier hs-var">main_fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-202"></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="GHC.Builtin.Names.html#main_RDR_Unqual"><span class="hs-identifier hs-var">main_RDR_Unqual</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064129"><span class="annot"><a href="#local-6989586621683064129"><span class="hs-identifier hs-var">has_main</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Rename.Env.html#lookupInfoOccRn"><span class="hs-identifier hs-type">lookupInfoOccRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064121"><span class="hs-identifier hs-type">default_main</span></a></span><span> </span><span class="hs-comment">-- #17832</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-comment">-- If a module has no explicit header, and it has one or more main</span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-comment">-- functions in scope, then add a header like</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-comment">-- &quot;module Main(main) where ...&quot;                               #13839</span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-comment">-- See Note [Modules without a module header]</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064134"><span class="annot"><a href="#local-6989586621683064134"><span class="hs-identifier hs-var hs-var">real_exports</span></a></span></span><span>
</span><span id="line-210"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064101"><span class="hs-identifier hs-var">explicit_mod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><a href="#local-6989586621683064102"><span class="hs-identifier hs-var">exports</span></a></span><span>
</span><span id="line-211"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064129"><span class="hs-identifier hs-var">has_main</span></a></span><span>
</span><span id="line-212"></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnLI [GenLocated SrcSpanAnnA (IE GhcPs)]
-&gt; Maybe
     (GenLocated SrcSpanAnnLI [GenLocated SrcSpanAnnA (IE GhcPs)])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcPs)]
-&gt; GenLocated SrcSpanAnnLI [GenLocated SrcSpanAnnA (IE GhcPs)]
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IE GhcPs -&gt; GenLocated SrcSpanAnnA (IE GhcPs)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XIEVar GhcPs
-&gt; LIEWrappedName GhcPs -&gt; Maybe (ExportDoc GhcPs) -&gt; IE GhcPs
forall pass.
XIEVar pass
-&gt; LIEWrappedName pass -&gt; Maybe (ExportDoc pass) -&gt; IE pass
</span><a href="Language.Haskell.Syntax.ImpExp.html#IEVar"><span class="hs-identifier hs-var">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
XIEVar GhcPs
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-213"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IEWrappedName GhcPs -&gt; GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XIEName GhcPs -&gt; LIdP GhcPs -&gt; IEWrappedName GhcPs
forall p. XIEName p -&gt; LIdP p -&gt; IEWrappedName p
</span><a href="Language.Haskell.Syntax.ImpExp.html#IEName"><span class="hs-identifier hs-var">IEName</span></a></span><span> </span><span class="annot"><span class="annottext">XIEName GhcPs
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">(LIdP GhcPs -&gt; IEWrappedName GhcPs)
-&gt; LIdP GhcPs -&gt; IEWrappedName GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; GenLocated SrcSpanAnnN RdrName
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064121"><span class="hs-identifier hs-var">default_main</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>                        </span><span class="hs-comment">-- ToDo: the 'noLoc' here is unhelpful if 'main'</span><span>
</span><span id="line-215"></span><span>                        </span><span class="hs-comment">--       turns out to be out of scope</span><span>
</span><span id="line-216"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
Maybe (GenLocated SrcSpanAnnLI [GenLocated SrcSpanAnnA (IE GhcPs)])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-comment">-- Rename the export list</span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064139"><span class="annot"><a href="#local-6989586621683064139"><span class="hs-identifier hs-var hs-var">do_it</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
-&gt; GlobalRdrEnv
-&gt; ImportAvails
-&gt; Module
-&gt; RnM
     (Maybe [(LIE GhcRn, DefaultEnv, [AvailInfo])], [AvailInfo],
      ExportWarnNames GhcRn)
</span><a href="GHC.Tc.Gen.Export.html#exports_from_avail"><span class="hs-identifier hs-var">exports_from_avail</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><a href="#local-6989586621683064134"><span class="hs-identifier hs-var">real_exports</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064114"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621683064116"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064112"><span class="hs-identifier hs-var">this_mod</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064140"><span class="annot"><a href="#local-6989586621683064140"><span class="hs-identifier hs-var">rn_exports</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064141"><span class="annot"><a href="#local-6989586621683064141"><span class="hs-identifier hs-var">final_avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064142"><span class="annot"><a href="#local-6989586621683064142"><span class="hs-identifier hs-var">new_export_warns</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621683064120"><span class="hs-identifier hs-type">hsc_src</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HsigFile"><span class="hs-identifier hs-type">HsigFile</span></a></span><span>
</span><span id="line-222"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064144"><span class="annot"><a href="#local-6989586621683064144"><span class="hs-identifier hs-var">mb_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064145"><span class="annot"><a href="#local-6989586621683064145"><span class="hs-identifier hs-var">msgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#tryTc"><span class="hs-identifier hs-type">tryTc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064139"><span class="hs-identifier hs-type">do_it</span></a></span><span>
</span><span id="line-223"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064144"><span class="hs-identifier hs-type">mb_r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-224"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064147"><span class="annot"><span class="annottext">(Maybe
   [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
 [AvailInfo], ExportWarnNames GhcRn)
</span><a href="#local-6989586621683064147"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe
   [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
 [AvailInfo], ExportWarnNames GhcRn)
-&gt; TcRn
     (Maybe
        [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
      [AvailInfo], ExportWarnNames GhcRn)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
 [AvailInfo], ExportWarnNames GhcRn)
</span><a href="#local-6989586621683064147"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-225"></span><span>                            </span><span class="annot"><span class="annottext">Maybe
  (Maybe
     [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
   [AvailInfo], ExportWarnNames GhcRn)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Messages TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addMessages"><span class="hs-identifier hs-var">addMessages</span></a></span><span> </span><span class="annot"><span class="annottext">Messages TcRnMessage
</span><a href="#local-6989586621683064145"><span class="hs-identifier hs-var">msgs</span></a></span><span> </span><span class="annot"><span class="annottext">TcRn ()
-&gt; TcRn
     (Maybe
        [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
      [AvailInfo], ExportWarnNames GhcRn)
-&gt; TcRn
     (Maybe
        [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
      [AvailInfo], ExportWarnNames GhcRn)
forall a b.
IOEnv (Env TcGblEnv TcLclEnv) a
-&gt; IOEnv (Env TcGblEnv TcLclEnv) b
-&gt; IOEnv (Env TcGblEnv TcLclEnv) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TcRn
  (Maybe
     [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
   [AvailInfo], ExportWarnNames GhcRn)
forall env a. IOEnv env a
</span><a href="GHC.Data.IOEnv.html#failM"><span class="hs-identifier hs-var">failM</span></a></span><span>
</span><span id="line-226"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#checkNoErrs"><span class="hs-identifier hs-type">checkNoErrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064139"><span class="hs-identifier hs-type">do_it</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-comment">-- Final processing</span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064150"><span class="annot"><a href="#local-6989586621683064150"><span class="hs-identifier hs-var hs-var">final_ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; NameSet
</span><a href="GHC.Types.Avail.html#availsToNameSet"><span class="hs-identifier hs-var">availsToNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621683064141"><span class="hs-identifier hs-var">final_avails</span></a></span><span>
</span><span id="line-230"></span><span>              </span><span id="local-6989586621683064152"><span class="annot"><a href="#local-6989586621683064152"><span class="hs-identifier hs-var hs-var">drop_defaults</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683064153"><span class="hs-identifier hs-var">spans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064154"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621683064154"><span class="hs-identifier hs-var">_defaults</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064155"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621683064155"><span class="hs-identifier hs-var">avails</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621683064153"><span class="hs-identifier hs-var">spans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621683064155"><span class="hs-identifier hs-var">avails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;rnExports: Exports:&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064141"><span class="hs-identifier hs-type">final_avails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064106"><span class="hs-identifier hs-type">tcg_env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_exports"><span class="hs-identifier hs-var">tcg_exports</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064141"><span class="hs-identifier hs-type">final_avails</span></a></span><span>
</span><span id="line-235"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_rn_exports"><span class="hs-identifier hs-var">tcg_rn_exports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_rn_exports"><span class="hs-identifier hs-var">tcg_rn_exports</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064106"><span class="hs-identifier hs-type">tcg_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-236"></span><span>                                                </span><span class="annot"><span class="annottext">Maybe [(LIE GhcRn, [AvailInfo])]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [(LIE GhcRn, [AvailInfo])]
Maybe [(GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo])]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-237"></span><span>                                                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">[(LIE GhcRn, [AvailInfo])]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
 -&gt; (GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo]))
-&gt; [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
-&gt; [(GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
-&gt; (GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo])
forall {a} {b} {b}. (a, b, b) -&gt; (a, b)
</span><a href="#local-6989586621683064152"><span class="hs-identifier hs-var">drop_defaults</span></a></span><span> </span><span class="annot"><span class="annottext">([(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
 -&gt; [(GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo])])
-&gt; Maybe
     [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
-&gt; Maybe [(GenLocated SrcSpanAnnA (IE GhcRn), [AvailInfo])]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
</span><a href="#local-6989586621683064140"><span class="hs-identifier hs-var">rn_exports</span></a></span><span>
</span><span id="line-238"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_default_exports"><span class="hs-identifier hs-var">tcg_default_exports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064102"><span class="hs-identifier hs-type">exports</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-239"></span><span>                              </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefaultEnv
</span><a href="GHC.Types.DefaultEnv.html#emptyDefaultEnv"><span class="hs-identifier hs-var">emptyDefaultEnv</span></a></span><span>
</span><span id="line-240"></span><span>                              </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
 -&gt; DefaultEnv)
-&gt; Maybe
     [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
-&gt; DefaultEnv
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Maybe a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
 -&gt; DefaultEnv)
-&gt; [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
-&gt; DefaultEnv
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
-&gt; DefaultEnv
forall a b c. (a, b, c) -&gt; b
</span><a href="GHC.Utils.Misc.html#sndOf3"><span class="hs-identifier hs-var">sndOf3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe
  [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
</span><a href="#local-6989586621683064140"><span class="hs-identifier hs-var">rn_exports</span></a></span><span>
</span><span id="line-241"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064106"><span class="hs-identifier hs-type">tcg_env</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#plusDU"><span class="hs-operator hs-type">`plusDU`</span></a></span><span>
</span><span id="line-242"></span><span>                                      </span><span class="annot"><a href="GHC.Types.Name.Set.html#usesOnly"><span class="hs-identifier hs-type">usesOnly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064150"><span class="hs-identifier hs-type">final_ns</span></a></span><span>
</span><span id="line-243"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#tcg_warns"><span class="hs-identifier hs-var">tcg_warns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#insertWarnExports"><span class="hs-identifier hs-type">insertWarnExports</span></a></span><span>
</span><span id="line-244"></span><span>                                        </span><span class="annot"><a href="#local-6989586621683064118"><span class="hs-identifier hs-type">warns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064142"><span class="hs-identifier hs-type">new_export_warns</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | List of names and the information about their warnings</span><span>
</span><span id="line-247"></span><span class="hs-comment">--   (warning, export list item span)</span><span>
</span><span id="line-248"></span><span class="hs-keyword">type</span><span> </span><span id="ExportWarnSpanNames"><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-var">ExportWarnSpanNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Map from names that should not have export warnings to</span><span>
</span><span id="line-251"></span><span class="hs-comment">--   the spans of export list items that are missing those warnings</span><span>
</span><span id="line-252"></span><span class="hs-keyword">type</span><span> </span><span id="DontWarnExportNames"><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-var">DontWarnExportNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">{- Note [Default exports]
~~~~~~~~~~~~~~~~~~~~~~~~~
Named default declarations (see Note [Named default declarations] in
GHC.Tc.Gen.Default) can be exported. A named default declaration is
exported only when it's specified in the export list, using the `default`
keyword and the class name.  For example:

    module TextWrap (Text, default IsString) where
      import Data.String (IsString)
      import Data.Text (Text)
      default IsString (Text, String)

A module with no explicit export list does not export any default
declarations, and neither does the re-export of a whole imported module.

The export item `default IsString` is parsed into the `IE` item

    IEThingAbs ext (L loc (IEDefault ext &quot;IsString&quot;)) doc

If exported, a default is imported automatically much like a class instance. For
example,

    import TextWrap ()

would import the above `default IsString (Text, String)` declaration into the
importing module.

The `cd_module` field of `ClassDefaults` tracks the module whence the default was
imported from, for the purpose of warning reports. The said warning report may be
triggered by `-Wtype-defaults` or by a user-defined `WARNING` pragma attached to
the default export. In the latter case the warning text is stored in the
`cd_warn` field. See test `testsuite/tests/default/ExportWarn.hs` for an example
of a user-defined warning on default.
-}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#exports_from_avail"><span class="hs-identifier hs-type">exports_from_avail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedLI"><span class="hs-identifier hs-type">LocatedLI</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>                         </span><span class="annot"><span class="hs-comment">-- ^ 'Nothing' means no explicit export list</span></span><span>
</span><span id="line-292"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span>
</span><span id="line-293"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Deps.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span>
</span><span id="line-294"></span><span>                         </span><span class="hs-comment">-- ^ Imported modules; this is used to test if a</span><span>
</span><span id="line-295"></span><span>                         </span><span class="hs-comment">-- @module Foo@ export is valid (it's not valid</span><span>
</span><span id="line-296"></span><span>                         </span><span class="hs-comment">-- if we didn't import @Foo@!)</span><span>
</span><span id="line-297"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-298"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#DefaultEnv"><span class="hs-identifier hs-type">DefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#Avails"><span class="hs-identifier hs-type">Avails</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#Avails"><span class="hs-identifier hs-type">Avails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#ExportWarnNames"><span class="hs-identifier hs-type">ExportWarnNames</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>                         </span><span class="hs-comment">-- (Nothing, _, _) &lt;=&gt; no explicit export list</span><span>
</span><span id="line-300"></span><span>                         </span><span class="hs-comment">-- if explicit export list is present it contains</span><span>
</span><span id="line-301"></span><span>                         </span><span class="hs-comment">-- each renamed export item together with its exported</span><span>
</span><span id="line-302"></span><span>                         </span><span class="hs-comment">-- names.</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="exports_from_avail"><span class="annot"><span class="annottext">exports_from_avail :: Maybe (LocatedLI [LIE GhcPs])
-&gt; GlobalRdrEnv
-&gt; ImportAvails
-&gt; Module
-&gt; RnM
     (Maybe [(LIE GhcRn, DefaultEnv, [AvailInfo])], [AvailInfo],
      ExportWarnNames GhcRn)
</span><a href="GHC.Tc.Gen.Export.html#exports_from_avail"><span class="hs-identifier hs-var hs-var">exports_from_avail</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (LocatedLI [LIE GhcPs])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621683064167"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064167"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683064168"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621683064168"><span class="hs-identifier hs-var">_imports</span></a></span></span><span> </span><span id="local-6989586621683064169"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064169"><span class="hs-identifier hs-var">_this_mod</span></a></span></span><span>
</span><span id="line-305"></span><span>   </span><span class="hs-comment">-- The same as (module M) where M is the current module name,</span><span>
</span><span id="line-306"></span><span>   </span><span class="hs-comment">-- so that's how we handle it, except we also export the data family</span><span>
</span><span id="line-307"></span><span>   </span><span class="hs-comment">-- when a data instance is exported.</span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addDiagnostic"><span class="hs-identifier hs-var">addDiagnostic</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnMissingExportList"><span class="hs-identifier hs-var">TcRnMissingExportList</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; TcRnMessage) -&gt; ModuleName -&gt; TcRnMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064169"><span class="hs-identifier hs-var">_this_mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064173"><span class="annot"><span class="annottext">avails :: [AvailInfo]
</span><a href="#local-6989586621683064173"><span class="hs-identifier hs-var hs-var">avails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>            </span><span class="annot"><span class="annottext">(AvailInfo -&gt; AvailInfo) -&gt; [AvailInfo] -&gt; [AvailInfo]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; AvailInfo
</span><a href="#local-6989586621683064174"><span class="hs-identifier hs-var">fix_faminst</span></a></span><span> </span><span class="annot"><span class="annottext">([AvailInfo] -&gt; [AvailInfo])
-&gt; (GlobalRdrEnv -&gt; [AvailInfo]) -&gt; GlobalRdrEnv -&gt; [AvailInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; [AvailInfo]
forall info. [GlobalRdrEltX info] -&gt; [AvailInfo]
</span><a href="GHC.Types.Name.Reader.html#gresToAvailInfo"><span class="hs-identifier hs-var">gresToAvailInfo</span></a></span><span>
</span><span id="line-313"></span><span>              </span><span class="annot"><span class="annottext">([GlobalRdrEltX GREInfo] -&gt; [AvailInfo])
-&gt; (GlobalRdrEnv -&gt; [GlobalRdrEltX GREInfo])
-&gt; GlobalRdrEnv
-&gt; [AvailInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo -&gt; Bool)
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Bool
forall info. GlobalRdrEltX info -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a></span><span> </span><span class="annot"><span class="annottext">([GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo])
-&gt; (GlobalRdrEnv -&gt; [GlobalRdrEltX GREInfo])
-&gt; GlobalRdrEnv
-&gt; [GlobalRdrEltX GREInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; [GlobalRdrEltX GREInfo]
forall info. GlobalRdrEnvX info -&gt; [GlobalRdrEltX info]
</span><a href="GHC.Types.Name.Reader.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a></span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEnv -&gt; [AvailInfo]) -&gt; GlobalRdrEnv -&gt; [AvailInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064167"><span class="hs-identifier hs-var">rdr_env</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Maybe
   [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
 [AvailInfo], ExportWarnNames GhcRn)
-&gt; TcRn
     (Maybe
        [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
      [AvailInfo], ExportWarnNames GhcRn)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe
  [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621683064173"><span class="hs-identifier hs-var">avails</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-comment">-- #11164: when we define a data instance</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-comment">-- but not data family, re-export the family</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-comment">-- Even though we don't check whether this is actually a data family</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- only data families can locally define subordinate things (`ns` here)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-comment">-- without locally defining (and instead importing) the parent (`n`)</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621683064174"><span class="annot"><span class="annottext">fix_faminst :: AvailInfo -&gt; AvailInfo
</span><a href="#local-6989586621683064174"><span class="hs-identifier hs-var hs-var">fix_faminst</span></a></span></span><span> </span><span id="local-6989586621683064178"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621683064178"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621683064180"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064180"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621683064181"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064181"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Bool
</span><a href="GHC.Types.Avail.html#availExportsDecl"><span class="hs-identifier hs-var">availExportsDecl</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064178"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064178"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-var">AvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064180"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064180"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064181"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="#local-6989586621683064174"><span class="hs-identifier hs-var">fix_faminst</span></a></span><span> </span><span id="local-6989586621683064183"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064183"><span class="hs-identifier hs-var">avail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064183"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#exports_from_avail"><span class="hs-identifier hs-var">exports_from_avail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnLI
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064185"><span class="annot"><span class="annottext">[LIE GhcPs]
</span><a href="#local-6989586621683064185"><span class="hs-identifier hs-var">rdr_items</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064186"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064186"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span id="local-6989586621683064187"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621683064187"><span class="hs-identifier hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621683064188"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064188"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064189"><span class="annot"><a href="#local-6989586621683064189"><span class="hs-identifier hs-var">ie_avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064190"><span class="annot"><a href="#local-6989586621683064190"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064191"><span class="annot"><a href="#local-6989586621683064191"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ExportAccum
 -&gt; GenLocated SrcSpanAnnA (IE GhcPs)
 -&gt; TcRn
      (ExportAccum,
       Maybe
         (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])))
-&gt; [GenLocated SrcSpanAnnA (IE GhcPs)]
-&gt; TcRn
     ([(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])],
      ExportWarnSpanNames, DontWarnExportNames)
forall x y.
(ExportAccum -&gt; x -&gt; TcRn (ExportAccum, Maybe y))
-&gt; [x] -&gt; TcRn ([y], ExportWarnSpanNames, DontWarnExportNames)
</span><a href="GHC.Tc.Gen.Export.html#accumExports"><span class="hs-identifier hs-var">accumExports</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (ExportAccum, Maybe (LIE GhcRn, DefaultEnv, [AvailInfo]))
ExportAccum
-&gt; GenLocated SrcSpanAnnA (IE GhcPs)
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
</span><a href="#local-6989586621683064192"><span class="hs-identifier hs-var">do_litem</span></a></span><span> </span><span class="annot"><span class="annottext">[LIE GhcPs]
[GenLocated SrcSpanAnnA (IE GhcPs)]
</span><a href="#local-6989586621683064185"><span class="hs-identifier hs-var">rdr_items</span></a></span><span>
</span><span id="line-332"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064193"><span class="annot"><a href="#local-6989586621683064193"><span class="hs-identifier hs-var hs-var">final_exports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; [AvailInfo]
</span><a href="GHC.Types.Avail.html#nubAvails"><span class="hs-identifier hs-var">nubAvails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
 -&gt; [AvailInfo])
-&gt; [(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
-&gt; [AvailInfo]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
-&gt; [AvailInfo]
forall a b c. (a, b, c) -&gt; c
</span><a href="GHC.Utils.Misc.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])]
</span><a href="#local-6989586621683064189"><span class="hs-identifier hs-var">ie_avails</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Combine families</span><span>
</span><span id="line-333"></span><span>       </span><span id="local-6989586621683064196"><span class="annot"><a href="#local-6989586621683064196"><span class="hs-identifier hs-var">export_warn_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683064197"><span class="hs-identifier hs-type">aggregate_warnings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064190"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064191"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-334"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683064189"><span class="hs-identifier hs-type">ie_avails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064193"><span class="hs-identifier hs-type">final_exports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064196"><span class="hs-identifier hs-type">export_warn_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><a href="#local-6989586621683064192"><span class="hs-identifier hs-type">do_litem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-337"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#DefaultEnv"><span class="hs-identifier hs-type">DefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#Avails"><span class="hs-identifier hs-type">Avails</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621683064192"><span class="annot"><span class="annottext">do_litem :: ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (ExportAccum, Maybe (LIE GhcRn, DefaultEnv, [AvailInfo]))
</span><a href="#local-6989586621683064192"><span class="hs-identifier hs-var hs-var">do_litem</span></a></span></span><span> </span><span id="local-6989586621683064198"><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064198"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621683064199"><span class="annot"><span class="annottext">LIE GhcPs
</span><a href="#local-6989586621683064199"><span class="hs-identifier hs-var">lie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcPs) -&gt; SrcSpan
forall a e. HasLoc a =&gt; GenLocated a e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
GenLocated SrcSpanAnnA (IE GhcPs)
</span><a href="#local-6989586621683064199"><span class="hs-identifier hs-var">lie</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (ExportAccum, Maybe (LIE GhcRn, DefaultEnv, [AvailInfo]))
</span><a href="#local-6989586621683064202"><span class="hs-identifier hs-var">exports_from_item</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064198"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
</span><a href="#local-6989586621683064199"><span class="hs-identifier hs-var">lie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-comment">-- Maps a parent to its in-scope children</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621683064203"><span class="hs-identifier hs-type">kids_env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621683064203"><span class="annot"><span class="annottext">kids_env :: NameEnv [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064203"><span class="hs-identifier hs-var hs-var">kids_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; NameEnv [GlobalRdrEltX GREInfo]
</span><a href="GHC.Rename.Names.html#mkChildEnv"><span class="hs-identifier hs-var">mkChildEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; [GlobalRdrEltX GREInfo]
forall info. GlobalRdrEnvX info -&gt; [GlobalRdrEltX info]
</span><a href="GHC.Types.Name.Reader.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064186"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- See Note [Avails of associated data families]</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="#local-6989586621683064206"><span class="hs-identifier hs-type">expand_tyty_gre</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621683064206"><span class="annot"><span class="annottext">expand_tyty_gre :: GlobalRdrEltX GREInfo -&gt; [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064206"><span class="hs-identifier hs-var hs-var">expand_tyty_gre</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064207"><span class="annot"><span class="annottext">gre :: GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064207"><span class="hs-identifier hs-var">gre</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GRE"><span class="hs-identifier hs-type">GRE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gre_par :: forall info. GlobalRdrEltX info -&gt; Parent
</span><a href="GHC.Types.Name.Reader.html#gre_par"><span class="hs-identifier hs-var">gre_par</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ParentIs"><span class="hs-identifier hs-type">ParentIs</span></a></span><span> </span><span id="local-6989586621683064211"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064211"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isTyConName"><span class="hs-identifier hs-var">isTyConName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064211"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isTyConName"><span class="hs-identifier hs-var">isTyConName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064207"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064207"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064207"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#gre_par"><span class="hs-identifier hs-var">gre_par</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-type">NoParent</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="#local-6989586621683064206"><span class="hs-identifier hs-var">expand_tyty_gre</span></a></span><span> </span><span id="local-6989586621683064215"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064215"><span class="hs-identifier hs-var">gre</span></a></span></span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064215"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621683064216"><span class="annot"><span class="annottext">imported_modules :: [ModuleName]
</span><a href="#local-6989586621683064216"><span class="hs-identifier hs-var hs-var">imported_modules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ImportedModsVal -&gt; ModuleName
</span><a href="GHC.Unit.Module.Imported.html#imv_name"><span class="hs-identifier hs-var">imv_name</span></a></span><span> </span><span class="annot"><span class="annottext">ImportedModsVal
</span><a href="#local-6989586621683064218"><span class="hs-identifier hs-var">imv</span></a></span><span>
</span><span id="line-354"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621683064219"><span class="annot"><span class="annottext">[ImportedBy]
</span><a href="#local-6989586621683064219"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Module [ImportedBy] -&gt; [[ImportedBy]]
forall k a. Map k a -&gt; [a]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Module [ImportedBy] -&gt; [[ImportedBy]])
-&gt; Map Module [ImportedBy] -&gt; [[ImportedBy]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImportAvails -&gt; Map Module [ImportedBy]
</span><a href="GHC.Unit.Module.Deps.html#imp_mods"><span class="hs-identifier hs-var">imp_mods</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621683064187"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-355"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064218"><span class="annot"><span class="annottext">ImportedModsVal
</span><a href="#local-6989586621683064218"><span class="hs-identifier hs-var">imv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImportedBy] -&gt; [ImportedModsVal]
</span><a href="GHC.Unit.Module.Imported.html#importedByUser"><span class="hs-identifier hs-var">importedByUser</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportedBy]
</span><a href="#local-6989586621683064219"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="#local-6989586621683064202"><span class="hs-identifier hs-type">exports_from_item</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-358"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#DefaultEnv"><span class="hs-identifier hs-type">DefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#Avails"><span class="hs-identifier hs-type">Avails</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621683064202"><span class="annot"><span class="annottext">exports_from_item :: ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (ExportAccum, Maybe (LIE GhcRn, DefaultEnv, [AvailInfo]))
</span><a href="#local-6989586621683064202"><span class="hs-identifier hs-var hs-var">exports_from_item</span></a></span></span><span> </span><span id="local-6989586621683064223"><span class="annot"><span class="annottext">expacc :: ExportAccum
</span><a href="#local-6989586621683064223"><span class="hs-identifier hs-var">expacc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-360"></span><span>                        </span><span class="annot"><span class="annottext">expacc_exp_occs :: ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064224"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064224"><span class="hs-identifier hs-var">occs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-361"></span><span>                        </span><span class="annot"><span class="annottext">expacc_mods :: ExportAccum -&gt; UniqMap ModuleName [Name]
</span><a href="GHC.Tc.Gen.Export.html#expacc_mods"><span class="hs-identifier hs-var">expacc_mods</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064225"><span class="annot"><span class="annottext">UniqMap ModuleName [Name]
</span><a href="#local-6989586621683064225"><span class="hs-identifier hs-var">earlier_mods</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-362"></span><span>                        </span><span class="annot"><span class="annottext">expacc_warn_spans :: ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064226"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064226"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-363"></span><span>                        </span><span class="annot"><span class="annottext">expacc_dont_warn :: ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064227"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064227"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-364"></span><span>                      </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064228"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064228"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683064229"><span class="annot"><span class="annottext">ie :: IE GhcPs
</span><a href="#local-6989586621683064229"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEModuleContents"><span class="hs-identifier hs-type">IEModuleContents</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064231"><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683064231"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EpToken &quot;module&quot;
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064232"><span class="annot"><span class="annottext">lmod :: XRec GhcPs ModuleName
</span><a href="#local-6989586621683064232"><span class="hs-identifier hs-var">lmod</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064233"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064234"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064234"><span class="hs-identifier hs-var">exported_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UniqMap ModuleName [Name] -&gt; ModuleName -&gt; Maybe [Name]
forall k a. Uniquable k =&gt; UniqMap k a -&gt; k -&gt; Maybe a
</span><a href="GHC.Types.Unique.Map.html#lookupUniqMap"><span class="hs-identifier hs-var">lookupUniqMap</span></a></span><span> </span><span class="annot"><span class="annottext">UniqMap ModuleName [Name]
</span><a href="#local-6989586621683064225"><span class="hs-identifier hs-var">earlier_mods</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span>  </span><span class="hs-comment">-- Duplicate export of M</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addDiagnostic"><span class="hs-identifier hs-var">addDiagnostic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDupeModuleExport"><span class="hs-identifier hs-var">TcRnDupeModuleExport</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064237"><span class="annot"><a href="#local-6989586621683064237"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064238"><span class="annot"><a href="#local-6989586621683064238"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-368"></span><span>                </span><span class="annot"><span class="annottext">ExportWarnSpanNames
-&gt; DontWarnExportNames
-&gt; [Name]
-&gt; Maybe (LWarningTxt GhcPs)
-&gt; SrcSpan
-&gt; RnM
     (ExportWarnSpanNames, DontWarnExportNames,
      Maybe (LWarningTxt GhcRn))
</span><a href="#local-6989586621683064239"><span class="hs-identifier hs-var">process_warning</span></a></span><span> </span><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064226"><span class="hs-identifier hs-var">export_warn_spans</span></a></span><span>
</span><span id="line-369"></span><span>                                </span><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064227"><span class="hs-identifier hs-var">dont_warn_export</span></a></span><span>
</span><span id="line-370"></span><span>                                </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064234"><span class="hs-identifier hs-var">exported_names</span></a></span><span>
</span><span id="line-371"></span><span>                                </span><span class="annot"><span class="annottext">Maybe (LWarningTxt GhcPs)
Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683064231"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span><span>
</span><span id="line-372"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; SrcSpan
forall a. HasLoc a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064228"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>                   </span><span class="hs-comment">-- Checks if all the names are exported with the same warning message</span><span>
</span><span id="line-374"></span><span>                   </span><span class="hs-comment">-- or if they should not be warned about</span><span>
</span><span id="line-375"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064223"><span class="hs-identifier hs-type">expacc</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064237"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-376"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064238"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064241"><span class="annot"><span class="annottext">exportValid :: Bool
</span><a href="#local-6989586621683064241"><span class="hs-identifier hs-var hs-var hs-var">exportValid</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [ModuleName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621683064216"><span class="hs-identifier hs-var">imported_modules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>                                  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621683064188"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064244"><span class="annot"><span class="annottext">gre_prs :: [(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
</span><a href="#local-6989586621683064244"><span class="hs-identifier hs-var hs-var hs-var">gre_prs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName
-&gt; [GlobalRdrEltX GREInfo]
-&gt; [(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
forall info.
ModuleName
-&gt; [GlobalRdrEltX info]
-&gt; [(GlobalRdrEltX info, GlobalRdrEltX info)]
</span><a href="GHC.Types.Name.Reader.html#pickGREsModExp"><span class="hs-identifier hs-var">pickGREsModExp</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; [GlobalRdrEltX GREInfo]
forall info. GlobalRdrEnvX info -&gt; [GlobalRdrEltX info]
</span><a href="GHC.Types.Name.Reader.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064186"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064246"><span class="annot"><span class="annottext">new_gres :: [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064246"><span class="hs-identifier hs-var hs-var hs-var">new_gres</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064247"><span class="hs-identifier hs-var">gre'</span></a></span><span>
</span><span id="line-384"></span><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064248"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064248"><span class="hs-identifier hs-var">gre</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
</span><a href="#local-6989586621683064244"><span class="hs-identifier hs-var">gre_prs</span></a></span><span>
</span><span id="line-385"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064247"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064247"><span class="hs-identifier hs-var">gre'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064206"><span class="hs-identifier hs-var">expand_tyty_gre</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064248"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-386"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064249"><span class="annot"><span class="annottext">new_exports :: [AvailInfo]
</span><a href="#local-6989586621683064249"><span class="hs-identifier hs-var hs-var hs-var">new_exports</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo -&gt; AvailInfo)
-&gt; [GlobalRdrEltX GREInfo] -&gt; [AvailInfo]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; AvailInfo
forall info. GlobalRdrEltX info -&gt; AvailInfo
</span><a href="GHC.Types.Name.Reader.html#availFromGRE"><span class="hs-identifier hs-var">availFromGRE</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064246"><span class="hs-identifier hs-var">new_gres</span></a></span><span>
</span><span id="line-387"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064251"><span class="annot"><span class="annottext">all_gres :: [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064251"><span class="hs-identifier hs-var hs-var hs-var">all_gres</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)
 -&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo])
-&gt; [GlobalRdrEltX GREInfo]
-&gt; [(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
-&gt; [GlobalRdrEltX GREInfo]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621683064253"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064253"><span class="hs-identifier hs-var">gre1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683064254"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064254"><span class="hs-identifier hs-var">gre2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064255"><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064255"><span class="hs-identifier hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064253"><span class="hs-identifier hs-var">gre1</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064254"><span class="hs-identifier hs-var">gre2</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064255"><span class="hs-identifier hs-var">gres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
</span><a href="#local-6989586621683064244"><span class="hs-identifier hs-var">gre_prs</span></a></span><span>
</span><span id="line-388"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064256"><span class="annot"><span class="annottext">exported_names :: [Name]
</span><a href="#local-6989586621683064256"><span class="hs-identifier hs-var hs-var hs-var">exported_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo -&gt; Name)
-&gt; [GlobalRdrEltX GREInfo] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064246"><span class="hs-identifier hs-var">new_gres</span></a></span><span>
</span><span id="line-389"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064257"><span class="annot"><span class="annottext">mods :: UniqMap ModuleName [Name]
</span><a href="#local-6989586621683064257"><span class="hs-identifier hs-var hs-var hs-var">mods</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqMap ModuleName [Name]
-&gt; ModuleName -&gt; [Name] -&gt; UniqMap ModuleName [Name]
forall k a. Uniquable k =&gt; UniqMap k a -&gt; k -&gt; a -&gt; UniqMap k a
</span><a href="GHC.Types.Unique.Map.html#addToUniqMap"><span class="hs-identifier hs-var">addToUniqMap</span></a></span><span> </span><span class="annot"><span class="annottext">UniqMap ModuleName [Name]
</span><a href="#local-6989586621683064225"><span class="hs-identifier hs-var">earlier_mods</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064256"><span class="hs-identifier hs-var">exported_names</span></a></span><span>
</span><span id="line-390"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#checkErr"><span class="hs-identifier hs-var">checkErr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064241"><span class="hs-identifier hs-var">exportValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnExportedModNotImported"><span class="hs-identifier hs-var">TcRnExportedModNotImported</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#warnIf"><span class="hs-identifier hs-var">warnIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064241"><span class="hs-identifier hs-var">exportValid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(GlobalRdrEltX GREInfo, GlobalRdrEltX GREInfo)]
</span><a href="#local-6989586621683064244"><span class="hs-identifier hs-var">gre_prs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnNullExportedModule"><span class="hs-identifier hs-var">TcRnNullExportedModule</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;efa&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621683064233"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064251"><span class="hs-identifier hs-var">all_gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">DeprecationWarnings -&gt; [GlobalRdrEltX GREInfo] -&gt; TcRn ()
</span><a href="GHC.Rename.Env.html#addUsedGREs"><span class="hs-identifier hs-var">addUsedGREs</span></a></span><span> </span><span class="annot"><span class="annottext">DeprecationWarnings
</span><a href="GHC.Rename.Utils.html#ExportDeprecationWarnings"><span class="hs-identifier hs-var">ExportDeprecationWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064251"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>            </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064267"><span class="annot"><a href="#local-6989586621683064267"><span class="hs-identifier hs-var">occs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportOccMap
-&gt; IE GhcPs -&gt; [GlobalRdrEltX GREInfo] -&gt; RnM ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-var">check_occs</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064224"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064229"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064246"><span class="hs-identifier hs-var">new_gres</span></a></span><span>
</span><span id="line-399"></span><span>                          </span><span class="hs-comment">-- This check_occs not only finds conflicts</span><span>
</span><span id="line-400"></span><span>                          </span><span class="hs-comment">-- between this item and others, but also</span><span>
</span><span id="line-401"></span><span>                          </span><span class="hs-comment">-- internally within this item.  That is, if</span><span>
</span><span id="line-402"></span><span>                          </span><span class="hs-comment">-- 'M.x' is in scope in several ways, we'll have</span><span>
</span><span id="line-403"></span><span>                          </span><span class="hs-comment">-- several members of mod_avails with the same</span><span>
</span><span id="line-404"></span><span>                          </span><span class="hs-comment">-- OccName.</span><span>
</span><span id="line-405"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064269"><span class="annot"><a href="#local-6989586621683064269"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064270"><span class="annot"><a href="#local-6989586621683064270"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064271"><span class="annot"><a href="#local-6989586621683064271"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-406"></span><span>                </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064226"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-407"></span><span>                                </span><span class="annot"><a href="#local-6989586621683064227"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-408"></span><span>                                </span><span class="annot"><a href="#local-6989586621683064256"><span class="hs-identifier hs-type">exported_names</span></a></span><span>
</span><span id="line-409"></span><span>                                </span><span class="annot"><a href="#local-6989586621683064231"><span class="hs-identifier hs-type">warn_txt_ps</span></a></span><span>
</span><span id="line-410"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064228"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;export_mod&quot;</span></span><span>
</span><span id="line-413"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064233"><span class="hs-identifier hs-type">mod</span></a></span><span>
</span><span id="line-414"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064249"><span class="hs-identifier hs-type">new_exports</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064267"><span class="hs-identifier hs-type">occs'</span></a></span><span>
</span><span id="line-416"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_mods"><span class="hs-identifier hs-var">expacc_mods</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064257"><span class="hs-identifier hs-type">mods</span></a></span><span>
</span><span id="line-417"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064269"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-418"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064270"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-419"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064228"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEModuleContents"><span class="hs-identifier hs-type">IEModuleContents</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064271"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064232"><span class="hs-identifier hs-type">lmod</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#emptyDefaultEnv"><span class="hs-identifier hs-type">emptyDefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064249"><span class="hs-identifier hs-type">new_exports</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="#local-6989586621683064202"><span class="hs-identifier hs-var">exports_from_item</span></a></span><span> </span><span id="local-6989586621683064273"><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064273"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621683064274"><span class="annot"><span class="annottext">LIE GhcPs
</span><a href="#local-6989586621683064274"><span class="hs-identifier hs-var">lie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621683064275"><span class="annot"><a href="#local-6989586621683064275"><span class="hs-identifier hs-var">m_doc_ie</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LIE GhcPs -&gt; RnM (Maybe (LIE GhcRn))
</span><a href="#local-6989586621683064276"><span class="hs-identifier hs-var">lookup_doc_ie</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
</span><a href="#local-6989586621683064274"><span class="hs-identifier hs-var">lie</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064275"><span class="hs-identifier hs-type">m_doc_ie</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-424"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064277"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcRn)
</span><a href="#local-6989586621683064277"><span class="hs-identifier hs-var">new_ie</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ExportAccum,
 Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064273"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
-&gt; Maybe
     (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcRn)
</span><a href="#local-6989586621683064277"><span class="hs-identifier hs-var">new_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultEnv
</span><a href="GHC.Types.DefaultEnv.html#emptyDefaultEnv"><span class="hs-identifier hs-var">emptyDefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>          </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (IE GhcRn))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>            </span><span id="local-6989586621683064278"><span class="annot"><a href="#local-6989586621683064278"><span class="hs-identifier hs-var">m_ie</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (Maybe (ExportAccum, LIE GhcRn, Either OccName AvailInfo))
</span><a href="#local-6989586621683064279"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064273"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
</span><a href="#local-6989586621683064274"><span class="hs-identifier hs-var">lie</span></a></span><span>
</span><span id="line-427"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064278"><span class="hs-identifier hs-type">m_ie</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-428"></span><span>              </span><span class="annot"><span class="annottext">Maybe
  (ExportAccum, GenLocated SrcSpanAnnA (IE GhcRn),
   Either OccName AvailInfo)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ExportAccum,
 Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064273"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064280"><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064280"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064281"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcRn)
</span><a href="#local-6989586621683064281"><span class="hs-identifier hs-var">new_ie</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621683064282"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064282"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>                </span><span id="local-6989586621683064283"><span class="annot"><a href="#local-6989586621683064283"><span class="hs-identifier hs-var">defaults</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; DefaultEnv
</span><a href="GHC.Tc.Types.html#tcg_default"><span class="hs-identifier hs-var">tcg_default</span></a></span><span> </span><span class="annot"><span class="annottext">(TcGblEnv -&gt; DefaultEnv)
-&gt; RnM TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) DefaultEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RnM TcGblEnv
forall gbl lcl. TcRnIf gbl lcl gbl
</span><a href="GHC.Tc.Utils.Monad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a></span><span>
</span><span id="line-431"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064285"><span class="annot"><a href="#local-6989586621683064285"><span class="hs-identifier hs-var hs-var">exported_default</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ClassDefaults -&gt; Bool) -&gt; DefaultEnv -&gt; DefaultEnv
</span><a href="GHC.Types.DefaultEnv.html#filterDefaultEnv"><span class="hs-identifier hs-var">filterDefaultEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064282"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OccName -&gt; Bool)
-&gt; (ClassDefaults -&gt; OccName) -&gt; ClassDefaults -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; OccName)
-&gt; (ClassDefaults -&gt; Name) -&gt; ClassDefaults -&gt; OccName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Name)
-&gt; (ClassDefaults -&gt; TyCon) -&gt; ClassDefaults -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ClassDefaults -&gt; TyCon
</span><a href="GHC.Types.DefaultEnv.html#cd_class"><span class="hs-identifier hs-var">cd_class</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DefaultEnv
</span><a href="#local-6989586621683064283"><span class="hs-identifier hs-var">defaults</span></a></span><span>
</span><span id="line-432"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064280"><span class="hs-identifier hs-type">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064281"><span class="hs-identifier hs-type">new_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064285"><span class="hs-identifier hs-type">exported_default</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064288"><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064288"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064289"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcRn)
</span><a href="#local-6989586621683064289"><span class="hs-identifier hs-var">new_ie</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621683064290"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064290"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ExportAccum,
 Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
-&gt; TcRn
     (ExportAccum,
      Maybe (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo]))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportAccum
</span><a href="#local-6989586621683064288"><span class="hs-identifier hs-var">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
-&gt; Maybe
     (GenLocated SrcSpanAnnA (IE GhcRn), DefaultEnv, [AvailInfo])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcRn)
</span><a href="#local-6989586621683064289"><span class="hs-identifier hs-var">new_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultEnv
</span><a href="GHC.Types.DefaultEnv.html#emptyDefaultEnv"><span class="hs-identifier hs-var">emptyDefaultEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064290"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-comment">-------------</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><a href="#local-6989586621683064279"><span class="hs-identifier hs-type">lookup_ie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621683064279"><span class="annot"><span class="annottext">lookup_ie :: ExportAccum
-&gt; LIE GhcPs
-&gt; RnM (Maybe (ExportAccum, LIE GhcRn, Either OccName AvailInfo))
</span><a href="#local-6989586621683064279"><span class="hs-identifier hs-var hs-var">lookup_ie</span></a></span></span><span> </span><span id="local-6989586621683064291"><span class="annot"><span class="annottext">expacc :: ExportAccum
</span><a href="#local-6989586621683064291"><span class="hs-identifier hs-var">expacc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-439"></span><span>            </span><span class="annot"><span class="annottext">expacc_exp_occs :: ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064292"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064292"><span class="hs-identifier hs-var">occs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-440"></span><span>            </span><span class="annot"><span class="annottext">expacc_warn_spans :: ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064293"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064293"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-441"></span><span>            </span><span class="annot"><span class="annottext">expacc_dont_warn :: ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064294"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064294"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-442"></span><span>          </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064295"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064295"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683064296"><span class="annot"><span class="annottext">ie :: IE GhcPs
</span><a href="#local-6989586621683064296"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEVar"><span class="hs-identifier hs-type">IEVar</span></a></span><span> </span><span id="local-6989586621683064297"><span class="annot"><span class="annottext">XIEVar GhcPs
</span><a href="#local-6989586621683064297"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span> </span><span id="local-6989586621683064298"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064298"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683064299"><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
</span><a href="#local-6989586621683064299"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683064300"><span class="annot"><a href="#local-6989586621683064300"><span class="hs-identifier hs-var">mb_gre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
</span><a href="GHC.Rename.Env.html#lookupGreAvailRn"><span class="hs-identifier hs-var">lookupGreAvailRn</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo)))
-&gt; RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). LIEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064298"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-444"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621683064300"><span class="hs-identifier hs-type">mb_gre</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683064303"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064303"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064304"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621683064304"><span class="hs-identifier hs-var hs-var hs-var">avail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; AvailInfo
forall info. GlobalRdrEltX info -&gt; AvailInfo
</span><a href="GHC.Types.Name.Reader.html#availFromGRE"><span class="hs-identifier hs-var">availFromGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064303"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-446"></span><span>                   </span><span id="local-6989586621683064305"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621683064305"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064303"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>               </span><span id="local-6989586621683064306"><span class="annot"><a href="#local-6989586621683064306"><span class="hs-identifier hs-var">occs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportOccMap
-&gt; IE GhcPs -&gt; [GlobalRdrEltX GREInfo] -&gt; RnM ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-var">check_occs</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064292"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064296"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064303"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683064307"><span class="annot"><a href="#local-6989586621683064307"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064308"><span class="annot"><a href="#local-6989586621683064308"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064309"><span class="annot"><a href="#local-6989586621683064309"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064293"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-451"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064294"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-452"></span><span>                                    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683064305"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064297"><span class="hs-identifier hs-type">warn_txt_ps</span></a></span><span>
</span><span id="line-454"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064295"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>               </span><span id="local-6989586621683064310"><span class="annot"><a href="#local-6989586621683064310"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064299"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-457"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064291"><span class="hs-identifier hs-type">expacc</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064306"><span class="hs-identifier hs-type">occs'</span></a></span><span>
</span><span id="line-458"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064307"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-459"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064308"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-460"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064295"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEVar"><span class="hs-identifier hs-type">IEVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064309"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#replaceLWrappedName"><span class="hs-identifier hs-type">replaceLWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064298"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064305"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064310"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621683064304"><span class="hs-identifier hs-type">avail</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><a href="#local-6989586621683064279"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span id="local-6989586621683064314"><span class="annot"><span class="annottext">expacc :: ExportAccum
</span><a href="#local-6989586621683064314"><span class="hs-identifier hs-var">expacc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-464"></span><span>            </span><span class="annot"><span class="annottext">expacc_exp_occs :: ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064315"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064315"><span class="hs-identifier hs-var">occs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-465"></span><span>            </span><span class="annot"><span class="annottext">expacc_warn_spans :: ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064316"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064316"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="annottext">expacc_dont_warn :: ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064317"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064317"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-467"></span><span>          </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064318"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064318"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683064319"><span class="annot"><span class="annottext">ie :: IE GhcPs
</span><a href="#local-6989586621683064319"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-type">IEThingAbs</span></a></span><span> </span><span id="local-6989586621683064321"><span class="annot"><span class="annottext">XIEThingAbs GhcPs
</span><a href="#local-6989586621683064321"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span> </span><span id="local-6989586621683064322"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064322"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683064323"><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
</span><a href="#local-6989586621683064323"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683064324"><span class="annot"><a href="#local-6989586621683064324"><span class="hs-identifier hs-var">mb_gre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
</span><a href="GHC.Rename.Env.html#lookupGreAvailRn"><span class="hs-identifier hs-var">lookupGreAvailRn</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo)))
-&gt; RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). LIEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064322"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-469"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621683064324"><span class="hs-identifier hs-type">mb_gre</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683064325"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064325"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064326"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621683064326"><span class="hs-identifier hs-var hs-var hs-var">avail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; AvailInfo
forall info. GlobalRdrEltX info -&gt; AvailInfo
</span><a href="GHC.Types.Name.Reader.html#availFromGRE"><span class="hs-identifier hs-var">availFromGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064325"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-471"></span><span>                   </span><span id="local-6989586621683064327"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621683064327"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064325"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>               </span><span id="local-6989586621683064328"><span class="annot"><a href="#local-6989586621683064328"><span class="hs-identifier hs-var">occs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportOccMap
-&gt; IE GhcPs -&gt; [GlobalRdrEltX GREInfo] -&gt; RnM ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-var">check_occs</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064315"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064319"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064325"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683064329"><span class="annot"><a href="#local-6989586621683064329"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064330"><span class="annot"><a href="#local-6989586621683064330"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064331"><span class="annot"><a href="#local-6989586621683064331"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064316"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-476"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064317"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-477"></span><span>                                    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683064327"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-478"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064321"><span class="hs-identifier hs-type">warn_txt_ps</span></a></span><span>
</span><span id="line-479"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064318"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>               </span><span id="local-6989586621683064332"><span class="annot"><a href="#local-6989586621683064332"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064323"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-482"></span><span>               </span><span id="local-6989586621683064333"><span class="annot"><a href="#local-6989586621683064333"><span class="hs-identifier hs-var">avail'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-type">unLoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064322"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-483"></span><span>                 </span><span class="hs-comment">-- see Note [Default exports]</span><span>
</span><span id="line-484"></span><span>                 </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEDefault"><span class="hs-identifier hs-type">IEDefault</span></a></span><span> </span><span class="annot"><span class="annottext">XIEDefault GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064336"><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621683064336"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064337"><span class="annot"><span class="annottext">defaultOccName :: ClassDefaults -&gt; OccName
</span><a href="#local-6989586621683064337"><span class="hs-identifier hs-var hs-var hs-var">defaultOccName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; OccName)
-&gt; (ClassDefaults -&gt; Name) -&gt; ClassDefaults -&gt; OccName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon -&gt; Name)
-&gt; (ClassDefaults -&gt; TyCon) -&gt; ClassDefaults -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ClassDefaults -&gt; TyCon
</span><a href="GHC.Types.DefaultEnv.html#cd_class"><span class="hs-identifier hs-var">cd_class</span></a></span><span>
</span><span id="line-486"></span><span>                       </span><span id="local-6989586621683064338"><span class="annot"><span class="annottext">occName :: OccName
</span><a href="#local-6989586621683064338"><span class="hs-identifier hs-var hs-var hs-var">occName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621683064336"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>                   </span><span id="local-6989586621683064340"><span class="annot"><a href="#local-6989586621683064340"><span class="hs-identifier hs-var">defaults</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; DefaultEnv
</span><a href="GHC.Tc.Types.html#tcg_default"><span class="hs-identifier hs-var">tcg_default</span></a></span><span> </span><span class="annot"><span class="annottext">(TcGblEnv -&gt; DefaultEnv)
-&gt; RnM TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) DefaultEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RnM TcGblEnv
forall gbl lcl. TcRnIf gbl lcl gbl
</span><a href="GHC.Tc.Utils.Monad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a></span><span>
</span><span id="line-488"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.DefaultEnv.html#isEmptyDefaultEnv"><span class="hs-identifier hs-type">isEmptyDefaultEnv</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.DefaultEnv.html#filterDefaultEnv"><span class="hs-identifier hs-type">filterDefaultEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">occName</span></span><span> </span><span class="annot"><span class="hs-operator">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621683064337"><span class="hs-identifier hs-type">defaultOccName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064340"><span class="hs-identifier hs-type">defaults</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnExportHiddenDefault"><span class="hs-identifier hs-type">TcRnExportHiddenDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064319"><span class="hs-identifier hs-type">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><a href="#local-6989586621683064338"><span class="hs-identifier hs-type">occName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>                 </span><span class="annot"><span class="annottext">IEWrappedName GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either OccName AvailInfo
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Either OccName AvailInfo)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AvailInfo -&gt; Either OccName AvailInfo
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621683064326"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064314"><span class="hs-identifier hs-type">expacc</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064328"><span class="hs-identifier hs-type">occs'</span></a></span><span>
</span><span id="line-493"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064329"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-494"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064330"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-495"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064318"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-type">IEThingAbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064331"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#replaceLWrappedName"><span class="hs-identifier hs-type">replaceLWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064322"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064327"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064332"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064333"><span class="hs-identifier hs-type">avail'</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="#local-6989586621683064279"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span id="local-6989586621683064343"><span class="annot"><span class="annottext">expacc :: ExportAccum
</span><a href="#local-6989586621683064343"><span class="hs-identifier hs-var">expacc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-499"></span><span>            </span><span class="annot"><span class="annottext">expacc_exp_occs :: ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064344"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064344"><span class="hs-identifier hs-var">occs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">expacc_warn_spans :: ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064345"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064345"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">expacc_dont_warn :: ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064346"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064346"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-502"></span><span>          </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064347"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064347"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683064348"><span class="annot"><span class="annottext">ie :: IE GhcPs
</span><a href="#local-6989586621683064348"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064350"><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683064350"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064351"><span class="annot"><span class="annottext">(EpToken &quot;(&quot;, EpToken &quot;..&quot;, EpToken &quot;)&quot;)
</span><a href="#local-6989586621683064351"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064352"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064352"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683064353"><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
</span><a href="#local-6989586621683064353"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683064354"><span class="annot"><a href="#local-6989586621683064354"><span class="hs-identifier hs-var">mb_gre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
</span><a href="GHC.Rename.Env.html#lookupGreAvailRn"><span class="hs-identifier hs-var">lookupGreAvailRn</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo)))
-&gt; RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). LIEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064352"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-504"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621683064354"><span class="hs-identifier hs-type">mb_gre</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683064355"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064355"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>               </span><span id="local-6989586621683064356"><span class="annot"><a href="#local-6989586621683064356"><span class="hs-identifier hs-var">all_kids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
-&gt; LIEWrappedName GhcPs
-&gt; GlobalRdrEltX GREInfo
-&gt; RnM [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064357"><span class="hs-identifier hs-var">lookup_ie_kids_all</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064348"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064352"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064355"><span class="hs-identifier hs-var">par</span></a></span><span>
</span><span id="line-506"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064358"><span class="annot"><a href="#local-6989586621683064358"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064355"><span class="hs-identifier hs-var">par</span></a></span><span>
</span><span id="line-507"></span><span>                   </span><span id="local-6989586621683064359"><span class="annot"><a href="#local-6989586621683064359"><span class="hs-identifier hs-var hs-var">all_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064355"><span class="hs-identifier hs-var">par</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064356"><span class="hs-identifier hs-var">all_kids</span></a></span><span>
</span><span id="line-508"></span><span>                   </span><span id="local-6989586621683064360"><span class="annot"><a href="#local-6989586621683064360"><span class="hs-identifier hs-var hs-var">all_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo -&gt; Name)
-&gt; [GlobalRdrEltX GREInfo] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064359"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>               </span><span id="local-6989586621683064361"><span class="annot"><a href="#local-6989586621683064361"><span class="hs-identifier hs-var">occs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-type">check_occs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064344"><span class="hs-identifier hs-type">occs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064348"><span class="hs-identifier hs-type">ie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064359"><span class="hs-identifier hs-type">all_gres</span></a></span><span>
</span><span id="line-511"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683064362"><span class="annot"><a href="#local-6989586621683064362"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064363"><span class="annot"><a href="#local-6989586621683064363"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064364"><span class="annot"><a href="#local-6989586621683064364"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064345"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-513"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064346"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-514"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064360"><span class="hs-identifier hs-type">all_names</span></a></span><span>
</span><span id="line-515"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064350"><span class="hs-identifier hs-type">warn_txt_ps</span></a></span><span>
</span><span id="line-516"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064347"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span>               </span><span id="local-6989586621683064365"><span class="annot"><a href="#local-6989586621683064365"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064353"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-519"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064343"><span class="hs-identifier hs-type">expacc</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064361"><span class="hs-identifier hs-type">occs'</span></a></span><span>
</span><span id="line-520"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064362"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-521"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064363"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-522"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064347"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064364"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064351"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#replaceLWrappedName"><span class="hs-identifier hs-type">replaceLWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064352"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064358"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064365"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064358"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064360"><span class="hs-identifier hs-type">all_names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><a href="#local-6989586621683064279"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span id="local-6989586621683064366"><span class="annot"><span class="annottext">expacc :: ExportAccum
</span><a href="#local-6989586621683064366"><span class="hs-identifier hs-var">expacc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportAccum"><span class="hs-identifier hs-type">ExportAccum</span></a></span><span class="hs-special">{</span><span>
</span><span id="line-526"></span><span>            </span><span class="annot"><span class="annottext">expacc_exp_occs :: ExportAccum -&gt; ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064367"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064367"><span class="hs-identifier hs-var">occs</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-527"></span><span>            </span><span class="annot"><span class="annottext">expacc_warn_spans :: ExportAccum -&gt; ExportWarnSpanNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064368"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064368"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-528"></span><span>            </span><span class="annot"><span class="annottext">expacc_dont_warn :: ExportAccum -&gt; DontWarnExportNames
</span><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064369"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064369"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-529"></span><span>          </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064370"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064370"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621683064371"><span class="annot"><span class="annottext">ie :: IE GhcPs
</span><a href="#local-6989586621683064371"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingWith"><span class="hs-identifier hs-type">IEThingWith</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064373"><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcPs))
</span><a href="#local-6989586621683064373"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064374"><span class="annot"><span class="annottext">IEThingWithAnns
</span><a href="#local-6989586621683064374"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064375"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064375"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621683064376"><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621683064376"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span id="local-6989586621683064377"><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
</span><a href="#local-6989586621683064377"><span class="hs-identifier hs-var">sub_rdrs</span></a></span></span><span> </span><span id="local-6989586621683064378"><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
</span><a href="#local-6989586621683064378"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621683064379"><span class="annot"><a href="#local-6989586621683064379"><span class="hs-identifier hs-var">mb_gre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
-&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
-&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall (p :: Pass) a.
OutputableBndrId p =&gt;
IE (GhcPass p) -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#addExportErrCtxt"><span class="hs-identifier hs-var">addExportErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064371"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-531"></span><span>                     </span><span class="annot"><span class="annottext">(RnM (Maybe (GlobalRdrEltX GREInfo))
 -&gt; RnM (Maybe (GlobalRdrEltX GREInfo)))
-&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
-&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
</span><a href="GHC.Rename.Env.html#lookupGreAvailRn"><span class="hs-identifier hs-var">lookupGreAvailRn</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo)))
-&gt; RdrName -&gt; RnM (Maybe (GlobalRdrEltX GREInfo))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). LIEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064375"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-532"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621683064379"><span class="hs-identifier hs-type">mb_gre</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621683064381"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064381"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-533"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683064382"><span class="annot"><a href="#local-6989586621683064382"><span class="hs-identifier hs-var">subs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064383"><span class="annot"><a href="#local-6989586621683064383"><span class="hs-identifier hs-var">with_kids</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
forall (p :: Pass) a.
OutputableBndrId p =&gt;
IE (GhcPass p) -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#addExportErrCtxt"><span class="hs-identifier hs-var">addExportErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064371"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-535"></span><span>                  </span><span class="annot"><span class="annottext">(TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
 -&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo]))
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; [LIEWrappedName GhcPs]
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
</span><a href="#local-6989586621683064384"><span class="hs-identifier hs-var">lookup_ie_kids_with</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064381"><span class="hs-identifier hs-var">par</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
</span><a href="#local-6989586621683064377"><span class="hs-identifier hs-var">sub_rdrs</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span>               </span><span id="local-6989586621683064385"><span class="annot"><a href="#local-6989586621683064385"><span class="hs-identifier hs-var">wc_kids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-538"></span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064376"><span class="hs-identifier hs-type">wc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-539"></span><span>                   </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="Language.Haskell.Syntax.ImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; RnM [GlobalRdrEltX GREInfo]
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-540"></span><span>                   </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEWildcard"><span class="hs-identifier hs-type">IEWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
-&gt; LIEWrappedName GhcPs
-&gt; GlobalRdrEltX GREInfo
-&gt; RnM [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064357"><span class="hs-identifier hs-var">lookup_ie_kids_all</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064371"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064375"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064381"><span class="hs-identifier hs-var">par</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064388"><span class="annot"><a href="#local-6989586621683064388"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064381"><span class="hs-identifier hs-var">par</span></a></span><span>
</span><span id="line-543"></span><span>                   </span><span id="local-6989586621683064389"><span class="annot"><a href="#local-6989586621683064389"><span class="hs-identifier hs-var hs-var">all_kids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064383"><span class="hs-identifier hs-var">with_kids</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064385"><span class="hs-identifier hs-var">wc_kids</span></a></span><span>
</span><span id="line-544"></span><span>                   </span><span id="local-6989586621683064390"><span class="annot"><a href="#local-6989586621683064390"><span class="hs-identifier hs-var hs-var">all_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064381"><span class="hs-identifier hs-var">par</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064389"><span class="hs-identifier hs-var">all_kids</span></a></span><span>
</span><span id="line-545"></span><span>                   </span><span id="local-6989586621683064391"><span class="annot"><a href="#local-6989586621683064391"><span class="hs-identifier hs-var hs-var">all_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo -&gt; Name)
-&gt; [GlobalRdrEltX GREInfo] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064390"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>               </span><span id="local-6989586621683064392"><span class="annot"><a href="#local-6989586621683064392"><span class="hs-identifier hs-var">occs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-type">check_occs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064367"><span class="hs-identifier hs-type">occs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064371"><span class="hs-identifier hs-type">ie</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064390"><span class="hs-identifier hs-type">all_gres</span></a></span><span>
</span><span id="line-548"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621683064393"><span class="annot"><a href="#local-6989586621683064393"><span class="hs-identifier hs-var">export_warn_spans'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064394"><span class="annot"><a href="#local-6989586621683064394"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064395"><span class="annot"><a href="#local-6989586621683064395"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064368"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-550"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064369"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-551"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064391"><span class="hs-identifier hs-type">all_names</span></a></span><span>
</span><span id="line-552"></span><span>                                    </span><span class="annot"><a href="#local-6989586621683064373"><span class="hs-identifier hs-type">warn_txt_ps</span></a></span><span>
</span><span id="line-553"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-type">locA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064370"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>               </span><span id="local-6989586621683064396"><span class="annot"><a href="#local-6989586621683064396"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-type">rnLHsDoc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064378"><span class="hs-identifier hs-type">doc</span></a></span><span>
</span><span id="line-556"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064366"><span class="hs-identifier hs-type">expacc</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_exp_occs"><span class="hs-identifier hs-var">expacc_exp_occs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064392"><span class="hs-identifier hs-type">occs'</span></a></span><span>
</span><span id="line-557"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_warn_spans"><span class="hs-identifier hs-var">expacc_warn_spans</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064393"><span class="hs-identifier hs-type">export_warn_spans'</span></a></span><span>
</span><span id="line-558"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#expacc_dont_warn"><span class="hs-identifier hs-var">expacc_dont_warn</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621683064394"><span class="hs-identifier hs-type">dont_warn_export'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-559"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064370"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingWith"><span class="hs-identifier hs-type">IEThingWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064395"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064374"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#replaceLWrappedName"><span class="hs-identifier hs-type">replaceLWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064375"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064388"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064376"><span class="hs-identifier hs-type">wc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064382"><span class="hs-identifier hs-type">subs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064396"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064388"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064391"><span class="hs-identifier hs-type">all_names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><a href="#local-6989586621683064279"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span class="annot"><span class="annottext">ExportAccum
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (Maybe
        (ExportAccum, GenLocated SrcSpanAnnA (IE GhcRn),
         Either OccName AvailInfo))
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lookup_ie&quot;</span></span><span>    </span><span class="hs-comment">-- Other cases covered earlier</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="#local-6989586621683064384"><span class="hs-identifier hs-type">lookup_ie_kids_with</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-566"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621683064384"><span class="annot"><span class="annottext">lookup_ie_kids_with :: GlobalRdrEltX GREInfo
-&gt; [LIEWrappedName GhcPs]
-&gt; TcM ([LIEWrappedName GhcRn], [GlobalRdrEltX GREInfo])
</span><a href="#local-6989586621683064384"><span class="hs-identifier hs-var hs-var">lookup_ie_kids_with</span></a></span></span><span> </span><span id="local-6989586621683064398"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064398"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span id="local-6989586621683064399"><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
</span><a href="#local-6989586621683064399"><span class="hs-identifier hs-var">sub_rdrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064400"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621683064400"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064398"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-569"></span><span>         </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064401"><span class="annot"><a href="#local-6989586621683064401"><span class="hs-identifier hs-var">kids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [LIEWrappedName GhcPs]
-&gt; RnM [(LIEWrappedName GhcRn, GlobalRdrEltX GREInfo)]
</span><a href="GHC.Tc.Gen.Export.html#lookupChildrenExport"><span class="hs-identifier hs-var">lookupChildrenExport</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064400"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
</span><a href="#local-6989586621683064399"><span class="hs-identifier hs-var">sub_rdrs</span></a></span><span>
</span><span id="line-570"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621683064401"><span class="hs-identifier hs-type">kids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621683064401"><span class="hs-identifier hs-type">kids</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="#local-6989586621683064357"><span class="hs-identifier hs-type">lookup_ie_kids_all</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span>
</span><span id="line-573"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621683064357"><span class="annot"><span class="annottext">lookup_ie_kids_all :: IE GhcPs
-&gt; LIEWrappedName GhcPs
-&gt; GlobalRdrEltX GREInfo
-&gt; RnM [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064357"><span class="hs-identifier hs-var hs-var">lookup_ie_kids_all</span></a></span></span><span> </span><span id="local-6989586621683064405"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064405"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064406"><span class="annot"><span class="annottext">IEWrappedName GhcPs
</span><a href="#local-6989586621683064406"><span class="hs-identifier hs-var">rdr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064407"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064407"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064408"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621683064408"><span class="hs-identifier hs-var hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064407"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-576"></span><span>               </span><span id="local-6989586621683064409"><span class="annot"><span class="annottext">gres :: [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064409"><span class="hs-identifier hs-var hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameEnv [GlobalRdrEltX GREInfo] -&gt; Name -&gt; [GlobalRdrEltX GREInfo]
forall a. NameEnv [a] -&gt; Name -&gt; [a]
</span><a href="GHC.Rename.Names.html#findChildren"><span class="hs-identifier hs-var">findChildren</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064203"><span class="hs-identifier hs-var">kids_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064408"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-577"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [GlobalRdrEltX GREInfo] -&gt; TcRn ()
</span><a href="#local-6989586621683064411"><span class="hs-identifier hs-var">addUsedKids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). IEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName GhcPs
</span><a href="#local-6989586621683064406"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064409"><span class="hs-identifier hs-var">gres</span></a></span><span>
</span><span id="line-578"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRn () -&gt; TcRn ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064409"><span class="hs-identifier hs-var">gres</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-579"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isTyConName"><span class="hs-identifier hs-var">isTyConName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064408"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-580"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addTcRnDiagnostic"><span class="hs-identifier hs-var">addTcRnDiagnostic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDodgyExports"><span class="hs-identifier hs-var">TcRnDodgyExports</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064407"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- This occurs when you export T(..), but</span><span>
</span><span id="line-582"></span><span>                 </span><span class="hs-comment">-- only import T abstractly, or T is a synonym.</span><span>
</span><span id="line-583"></span><span>                 </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnExportHiddenComponents"><span class="hs-identifier hs-var">TcRnExportHiddenComponents</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064405"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo] -&gt; RnM [GlobalRdrEltX GREInfo]
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064409"><span class="hs-identifier hs-var">gres</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-comment">-------------</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-comment">-- Runs for every Name</span><span>
</span><span id="line-589"></span><span>    </span><span class="hs-comment">-- - If there is no new warning, flags that the old warning should not be</span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-comment">--     included (since a warning should only be emitted if all</span><span>
</span><span id="line-591"></span><span>    </span><span class="hs-comment">--     of the export statements have a warning)</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-comment">-- - If the Name already has a warning, adds it</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-type">process_warning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-type">ExportWarnSpanNames</span></a></span><span>       </span><span class="hs-comment">-- Old aggregate data about warnins</span><span>
</span><span id="line-594"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span>       </span><span class="hs-comment">-- Old names not to warn about</span><span>
</span><span id="line-595"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>                              </span><span class="hs-comment">-- Names to warn about</span><span>
</span><span id="line-596"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#LWarningTxt"><span class="hs-identifier hs-type">LWarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Warning</span><span>
</span><span id="line-597"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>                             </span><span class="hs-comment">-- Span of the export list item</span><span>
</span><span id="line-598"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-type">ExportWarnSpanNames</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Aggregate data about the warnings</span><span>
</span><span id="line-599"></span><span>                            </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Names not to warn about in the end</span><span>
</span><span id="line-600"></span><span>                                                 </span><span class="hs-comment">-- (when there was a non-warned export)</span><span>
</span><span id="line-601"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#LWarningTxt"><span class="hs-identifier hs-type">LWarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Renamed warning</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621683064239"><span class="annot"><span class="annottext">process_warning :: ExportWarnSpanNames
-&gt; DontWarnExportNames
-&gt; [Name]
-&gt; Maybe (LWarningTxt GhcPs)
-&gt; SrcSpan
-&gt; RnM
     (ExportWarnSpanNames, DontWarnExportNames,
      Maybe (LWarningTxt GhcRn))
</span><a href="#local-6989586621683064239"><span class="hs-identifier hs-var hs-var">process_warning</span></a></span></span><span> </span><span id="local-6989586621683064416"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064416"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span>
</span><span id="line-603"></span><span>                    </span><span id="local-6989586621683064417"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064417"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-604"></span><span>                    </span><span id="local-6989586621683064418"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064418"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (LWarningTxt GhcPs)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621683064419"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064419"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExportWarnSpanNames, DontWarnExportNames,
 Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcRn)))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     (ExportWarnSpanNames, DontWarnExportNames,
      Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcRn)))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064416"><span class="hs-identifier hs-var">export_warn_spans</span></a></span><span>
</span><span id="line-606"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DontWarnExportNames -&gt; DontWarnExportNames)
-&gt; DontWarnExportNames -&gt; [Name] -&gt; DontWarnExportNames
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DontWarnExportNames -&gt; DontWarnExportNames
</span><a href="#local-6989586621683064420"><span class="hs-identifier hs-var">update_dont_warn_export</span></a></span><span>
</span><span id="line-607"></span><span>                       </span><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064417"><span class="hs-identifier hs-var">dont_warn_export</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064418"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-608"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnP (WarningTxt GhcRn))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-610"></span><span>        </span><span class="annot"><a href="#local-6989586621683064420"><span class="hs-identifier hs-type">update_dont_warn_export</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span id="local-6989586621683064420"><span class="annot"><span class="annottext">update_dont_warn_export :: Name -&gt; DontWarnExportNames -&gt; DontWarnExportNames
</span><a href="#local-6989586621683064420"><span class="hs-identifier hs-var hs-var">update_dont_warn_export</span></a></span></span><span> </span><span id="local-6989586621683064421"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064421"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621683064422"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064422"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span></span><span>
</span><span id="line-612"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SrcSpan -&gt; NonEmpty SrcSpan -&gt; NonEmpty SrcSpan)
-&gt; (SrcSpan -&gt; NonEmpty SrcSpan)
-&gt; DontWarnExportNames
-&gt; Name
-&gt; SrcSpan
-&gt; DontWarnExportNames
forall a b.
(a -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt; NameEnv b -&gt; Name -&gt; a -&gt; NameEnv b
</span><a href="GHC.Types.Name.Env.html#extendNameEnv_Acc"><span class="hs-identifier hs-var">extendNameEnv_Acc</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; NonEmpty SrcSpan -&gt; NonEmpty SrcSpan
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#%3C%7C"><span class="hs-operator hs-var">(NE.&lt;|)</span></a></span><span>
</span><span id="line-613"></span><span>                              </span><span class="annot"><span class="annottext">SrcSpan -&gt; NonEmpty SrcSpan
forall a. a -&gt; NonEmpty a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#singleton"><span class="hs-identifier hs-var">NE.singleton</span></a></span><span>
</span><span id="line-614"></span><span>                              </span><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064422"><span class="hs-identifier hs-var">dont_warn_export'</span></a></span><span>
</span><span id="line-615"></span><span>                              </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064421"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-616"></span><span>                              </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064419"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="#local-6989586621683064239"><span class="hs-identifier hs-var">process_warning</span></a></span><span> </span><span id="local-6989586621683064426"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064426"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span>
</span><span id="line-619"></span><span>                    </span><span id="local-6989586621683064427"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064427"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-620"></span><span>                    </span><span id="local-6989586621683064428"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064428"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064429"><span class="annot"><span class="annottext">LWarningTxt GhcPs
</span><a href="#local-6989586621683064429"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683064430"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064430"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-622"></span><span>          </span><span id="local-6989586621683064431"><span class="annot"><a href="#local-6989586621683064431"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LWarningTxt GhcPs -&gt; RnM (LWarningTxt GhcRn)
</span><a href="GHC.Rename.Module.html#rnLWarningTxt"><span class="hs-identifier hs-var">rnLWarningTxt</span></a></span><span> </span><span class="annot"><span class="annottext">LWarningTxt GhcPs
</span><a href="#local-6989586621683064429"><span class="hs-identifier hs-var">warn_txt_ps</span></a></span><span>
</span><span id="line-623"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064433"><span class="annot"><a href="#local-6989586621683064433"><span class="hs-identifier hs-var hs-var">new_export_warn_spans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; (Name, WarningTxt GhcRn, SrcSpan))
-&gt; [Name] -&gt; ExportWarnSpanNames
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnP (WarningTxt GhcRn) -&gt; WarningTxt GhcRn
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnP (WarningTxt GhcRn)
</span><a href="#local-6989586621683064431"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064430"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064428"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-624"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621683064433"><span class="hs-identifier hs-type">new_export_warn_spans</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621683064426"><span class="hs-identifier hs-type">export_warn_spans</span></a></span><span>
</span><span id="line-625"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064427"><span class="hs-identifier hs-type">dont_warn_export</span></a></span><span>
</span><span id="line-626"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621683064431"><span class="hs-identifier hs-type">warn_txt_rn</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-comment">-- For each name exported with any warnings throws an error</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-comment">--   if there are any exports of that name with a different warning</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="#local-6989586621683064197"><span class="hs-identifier hs-type">aggregate_warnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportWarnSpanNames"><span class="hs-identifier hs-type">ExportWarnSpanNames</span></a></span><span>
</span><span id="line-631"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#DontWarnExportNames"><span class="hs-identifier hs-type">DontWarnExportNames</span></a></span><span>
</span><span id="line-632"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#ExportWarnNames"><span class="hs-identifier hs-type">ExportWarnNames</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621683064197"><span class="annot"><span class="annottext">aggregate_warnings :: ExportWarnSpanNames
-&gt; DontWarnExportNames -&gt; RnM (ExportWarnNames GhcRn)
</span><a href="#local-6989586621683064197"><span class="hs-identifier hs-var hs-var">aggregate_warnings</span></a></span></span><span> </span><span id="local-6989586621683064434"><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064434"><span class="hs-identifier hs-var">export_warn_spans</span></a></span></span><span> </span><span id="local-6989586621683064435"><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064435"><span class="hs-identifier hs-var">dont_warn_export</span></a></span></span><span>
</span><span id="line-634"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Maybe (Name, WarningTxt GhcRn)] -&gt; ExportWarnNames GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)]
-&gt; RnM (ExportWarnNames GhcRn)
forall a b.
(a -&gt; b)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) a
-&gt; IOEnv (Env TcGblEnv TcLclEnv) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Name, WarningTxt GhcRn)] -&gt; ExportWarnNames GhcRn
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-635"></span><span>      </span><span class="annot"><span class="annottext">(IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)]
 -&gt; RnM (ExportWarnNames GhcRn))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)]
-&gt; RnM (ExportWarnNames GhcRn)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn)))
-&gt; [NonEmpty (Name, WarningTxt GhcRn, SrcSpan)]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, NonEmpty (WarningTxt GhcRn, SrcSpan))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
</span><a href="#local-6989586621683064437"><span class="hs-identifier hs-var">aggregate_single</span></a></span><span> </span><span class="annot"><span class="annottext">((Name, NonEmpty (WarningTxt GhcRn, SrcSpan))
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn)))
-&gt; (NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
    -&gt; (Name, NonEmpty (WarningTxt GhcRn, SrcSpan)))
-&gt; NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
-&gt; (Name, NonEmpty (WarningTxt GhcRn, SrcSpan))
</span><a href="#local-6989586621683064438"><span class="hs-identifier hs-var">extract_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>      </span><span class="annot"><span class="annottext">([NonEmpty (Name, WarningTxt GhcRn, SrcSpan)]
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)])
-&gt; [NonEmpty (Name, WarningTxt GhcRn, SrcSpan)]
-&gt; IOEnv (Env TcGblEnv TcLclEnv) [Maybe (Name, WarningTxt GhcRn)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, WarningTxt GhcRn, SrcSpan)
 -&gt; (Name, WarningTxt GhcRn, SrcSpan) -&gt; Bool)
-&gt; ExportWarnSpanNames
-&gt; [NonEmpty (Name, WarningTxt GhcRn, SrcSpan)]
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; Bool) -&gt; f a -&gt; [NonEmpty a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#groupBy"><span class="hs-identifier hs-var">NE.groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621683064440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064440"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064441"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064441"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064440"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064441"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>      </span><span class="annot"><span class="annottext">(ExportWarnSpanNames
 -&gt; [NonEmpty (Name, WarningTxt GhcRn, SrcSpan)])
-&gt; ExportWarnSpanNames
-&gt; [NonEmpty (Name, WarningTxt GhcRn, SrcSpan)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, WarningTxt GhcRn, SrcSpan)
 -&gt; (Name, WarningTxt GhcRn, SrcSpan) -&gt; Ordering)
-&gt; ExportWarnSpanNames -&gt; ExportWarnSpanNames
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621683064442"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064442"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064443"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064443"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064442"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064443"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><a href="#local-6989586621683064434"><span class="hs-identifier hs-var">export_warn_spans</span></a></span><span>
</span><span id="line-638"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>        </span><span class="annot"><a href="#local-6989586621683064438"><span class="hs-identifier hs-type">extract_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>        </span><span id="local-6989586621683064438"><span class="annot"><span class="annottext">extract_name :: NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
-&gt; (Name, NonEmpty (WarningTxt GhcRn, SrcSpan))
</span><a href="#local-6989586621683064438"><span class="hs-identifier hs-var hs-var">extract_name</span></a></span></span><span> </span><span id="local-6989586621683064445"><span class="annot"><span class="annottext">l :: NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
</span><a href="#local-6989586621683064445"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621683064446"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064446"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">NE.:|</span></span><span> </span><span class="annot"><span class="annottext">ExportWarnSpanNames
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064446"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((Name, WarningTxt GhcRn, SrcSpan) -&gt; (WarningTxt GhcRn, SrcSpan))
-&gt; NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
-&gt; NonEmpty (WarningTxt GhcRn, SrcSpan)
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#map"><span class="hs-identifier hs-var">NE.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064449"><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><a href="#local-6989586621683064449"><span class="hs-identifier hs-var">warn_txt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064450"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064450"><span class="hs-identifier hs-var">span</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><a href="#local-6989586621683064449"><span class="hs-identifier hs-var">warn_txt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064450"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Name, WarningTxt GhcRn, SrcSpan)
</span><a href="#local-6989586621683064445"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><a href="#local-6989586621683064437"><span class="hs-identifier hs-type">aggregate_single</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>        </span><span id="local-6989586621683064437"><span class="annot"><span class="annottext">aggregate_single :: (Name, NonEmpty (WarningTxt GhcRn, SrcSpan))
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
</span><a href="#local-6989586621683064437"><span class="hs-identifier hs-var hs-var">aggregate_single</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064451"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064451"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064452"><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><a href="#local-6989586621683064452"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064453"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064453"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">NE.:|</span></span><span> </span><span id="local-6989586621683064454"><span class="annot"><span class="annottext">[(WarningTxt GhcRn, SrcSpan)]
</span><a href="#local-6989586621683064454"><span class="hs-identifier hs-var">warn_spans</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-648"></span><span>              </span><span class="hs-comment">-- Emit an error if the warnings differ</span><span>
</span><span id="line-649"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[SrcSpan] -&gt; Maybe (NonEmpty SrcSpan)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[SrcSpan]
</span><a href="#local-6989586621683064456"><span class="hs-identifier hs-var">spans_different</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-650"></span><span>                </span><span class="annot"><span class="annottext">Maybe (NonEmpty SrcSpan)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064457"><span class="annot"><span class="annottext">NonEmpty SrcSpan
</span><a href="#local-6989586621683064457"><span class="hs-identifier hs-var">spans_different</span></a></span></span><span>
</span><span id="line-652"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064453"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NonEmpty SrcSpan -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDifferentExportWarnings"><span class="hs-identifier hs-var">TcRnDifferentExportWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064451"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty SrcSpan
</span><a href="#local-6989586621683064457"><span class="hs-identifier hs-var">spans_different</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-comment">-- Emit a warning if some export list items do not have a warning</span><span>
</span><span id="line-654"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DontWarnExportNames -&gt; Name -&gt; Maybe (NonEmpty SrcSpan)
forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DontWarnExportNames
</span><a href="#local-6989586621683064435"><span class="hs-identifier hs-var">dont_warn_export</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064451"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-655"></span><span>                </span><span class="annot"><span class="annottext">Maybe (NonEmpty SrcSpan)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, WarningTxt GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Name, WarningTxt GhcRn)
 -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn)))
-&gt; Maybe (Name, WarningTxt GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name, WarningTxt GhcRn) -&gt; Maybe (Name, WarningTxt GhcRn)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064451"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><a href="#local-6989586621683064452"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064461"><span class="annot"><span class="annottext">NonEmpty SrcSpan
</span><a href="#local-6989586621683064461"><span class="hs-identifier hs-var">not_warned_spans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-657"></span><span>                  </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addDiagnosticAt"><span class="hs-identifier hs-var">addDiagnosticAt</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621683064453"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NonEmpty SrcSpan -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnIncompleteExportWarnings"><span class="hs-identifier hs-var">TcRnIncompleteExportWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064451"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty SrcSpan
</span><a href="#local-6989586621683064461"><span class="hs-identifier hs-var">not_warned_spans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (Name, WarningTxt GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe (Name, WarningTxt GhcRn))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Name, WarningTxt GhcRn)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-659"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-660"></span><span>            </span><span id="local-6989586621683064456"><span class="annot"><span class="annottext">spans_different :: [SrcSpan]
</span><a href="#local-6989586621683064456"><span class="hs-identifier hs-var hs-var">spans_different</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((WarningTxt GhcRn, SrcSpan) -&gt; SrcSpan)
-&gt; [(WarningTxt GhcRn, SrcSpan)] -&gt; [SrcSpan]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(WarningTxt GhcRn, SrcSpan) -&gt; SrcSpan
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(WarningTxt GhcRn, SrcSpan)] -&gt; [SrcSpan])
-&gt; [(WarningTxt GhcRn, SrcSpan)] -&gt; [SrcSpan]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((WarningTxt GhcRn, SrcSpan) -&gt; Bool)
-&gt; [(WarningTxt GhcRn, SrcSpan)] -&gt; [(WarningTxt GhcRn, SrcSpan)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((WarningTxt GhcRn, SrcSpan) -&gt; Bool)
-&gt; (WarningTxt GhcRn, SrcSpan)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn -&gt; WarningTxt GhcRn -&gt; Bool
forall p1 p2. WarningTxt p1 -&gt; WarningTxt p2 -&gt; Bool
</span><a href="GHC.Unit.Module.Warnings.html#warningTxtSame"><span class="hs-identifier hs-var">warningTxtSame</span></a></span><span> </span><span class="annot"><span class="annottext">WarningTxt GhcRn
</span><a href="#local-6989586621683064452"><span class="hs-identifier hs-var">warn_txt_rn</span></a></span><span> </span><span class="annot"><span class="annottext">(WarningTxt GhcRn -&gt; Bool)
-&gt; ((WarningTxt GhcRn, SrcSpan) -&gt; WarningTxt GhcRn)
-&gt; (WarningTxt GhcRn, SrcSpan)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WarningTxt GhcRn, SrcSpan) -&gt; WarningTxt GhcRn
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(WarningTxt GhcRn, SrcSpan)]
</span><a href="#local-6989586621683064454"><span class="hs-identifier hs-var">warn_spans</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-comment">-------------</span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><a href="#local-6989586621683064276"><span class="hs-identifier hs-type">lookup_doc_ie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621683064276"><span class="annot"><span class="annottext">lookup_doc_ie :: LIE GhcPs -&gt; RnM (Maybe (LIE GhcRn))
</span><a href="#local-6989586621683064276"><span class="hs-identifier hs-var hs-var">lookup_doc_ie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064465"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064465"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEGroup"><span class="hs-identifier hs-type">IEGroup</span></a></span><span> </span><span class="annot"><span class="annottext">XIEGroup GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064467"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621683064467"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span id="local-6989586621683064468"><span class="annot"><span class="annottext">ExportDoc GhcPs
</span><a href="#local-6989586621683064468"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-665"></span><span>      </span><span id="local-6989586621683064469"><span class="annot"><a href="#local-6989586621683064469"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportDoc GhcPs -&gt; IOEnv (Env TcGblEnv TcLclEnv) (LHsDoc GhcRn)
</span><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ExportDoc GhcPs
</span><a href="#local-6989586621683064468"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064465"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEGroup"><span class="hs-identifier hs-type">IEGroup</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064467"><span class="hs-identifier hs-type">lev</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064469"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>    </span><span class="annot"><a href="#local-6989586621683064276"><span class="hs-identifier hs-var">lookup_doc_ie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064470"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064470"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEDoc"><span class="hs-identifier hs-type">IEDoc</span></a></span><span> </span><span class="annot"><span class="annottext">XIEDoc GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064472"><span class="annot"><span class="annottext">ExportDoc GhcPs
</span><a href="#local-6989586621683064472"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-668"></span><span>      </span><span id="local-6989586621683064473"><span class="annot"><a href="#local-6989586621683064473"><span class="hs-identifier hs-var">doc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExportDoc GhcPs -&gt; IOEnv (Env TcGblEnv TcLclEnv) (LHsDoc GhcRn)
</span><a href="GHC.Rename.Doc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ExportDoc GhcPs
</span><a href="#local-6989586621683064472"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064470"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEDoc"><span class="hs-identifier hs-type">IEDoc</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064473"><span class="hs-identifier hs-type">doc'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><a href="#local-6989586621683064276"><span class="hs-identifier hs-var">lookup_doc_ie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621683064474"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064474"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEDocNamed"><span class="hs-identifier hs-type">IEDocNamed</span></a></span><span> </span><span class="annot"><span class="annottext">XIEDocNamed GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064476"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064476"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LIE GhcRn) -&gt; RnM (Maybe (LIE GhcRn))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (LIE GhcRn) -&gt; RnM (Maybe (LIE GhcRn)))
-&gt; Maybe (LIE GhcRn) -&gt; RnM (Maybe (LIE GhcRn))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LIE GhcRn -&gt; Maybe (LIE GhcRn)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; IE GhcRn -&gt; GenLocated SrcSpanAnnA (IE GhcRn)
forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621683064474"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XIEDocNamed GhcRn -&gt; String -&gt; IE GhcRn
forall pass. XIEDocNamed pass -&gt; String -&gt; IE pass
</span><a href="Language.Haskell.Syntax.ImpExp.html#IEDocNamed"><span class="hs-identifier hs-var">IEDocNamed</span></a></span><span> </span><span class="annot"><span class="annottext">XIEDocNamed GhcRn
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064476"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><a href="#local-6989586621683064276"><span class="hs-identifier hs-var">lookup_doc_ie</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (IE GhcRn))
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (Maybe (GenLocated SrcSpanAnnA (IE GhcRn)))
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (GenLocated SrcSpanAnnA (IE GhcRn))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-comment">-- In an export item M.T(A,B,C), we want to treat the uses of</span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-comment">-- A,B,C as if they were M.A, M.B, M.C</span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-comment">-- Happily pickGREs does just the right thing</span><span>
</span><span id="line-677"></span><span>    </span><span class="annot"><a href="#local-6989586621683064411"><span class="hs-identifier hs-type">addUsedKids</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621683064411"><span class="annot"><span class="annottext">addUsedKids :: RdrName -&gt; [GlobalRdrEltX GREInfo] -&gt; TcRn ()
</span><a href="#local-6989586621683064411"><span class="hs-identifier hs-var hs-var">addUsedKids</span></a></span></span><span> </span><span id="local-6989586621683064477"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064477"><span class="hs-identifier hs-var">parent_rdr</span></a></span></span><span> </span><span id="local-6989586621683064478"><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064478"><span class="hs-identifier hs-var">kid_gres</span></a></span></span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeprecationWarnings -&gt; [GlobalRdrEltX GREInfo] -&gt; TcRn ()
</span><a href="GHC.Rename.Env.html#addUsedGREs"><span class="hs-identifier hs-var">addUsedGREs</span></a></span><span> </span><span class="annot"><span class="annottext">DeprecationWarnings
</span><a href="GHC.Rename.Utils.html#ExportDeprecationWarnings"><span class="hs-identifier hs-var">ExportDeprecationWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; [GlobalRdrEltX GREInfo] -&gt; [GlobalRdrEltX GREInfo]
forall info.
RdrName -&gt; [GlobalRdrEltX info] -&gt; [GlobalRdrEltX info]
</span><a href="GHC.Types.Name.Reader.html#pickGREs"><span class="hs-identifier hs-var">pickGREs</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064477"><span class="hs-identifier hs-var">parent_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064478"><span class="hs-identifier hs-var">kid_gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-comment">-- Renaming and typechecking of exports happens after everything else has</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- been typechecked.</span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span class="hs-comment">{-
Note [Modules without a module header]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The Haskell 2010 report says in section 5.1:

&gt;&gt; An abbreviated form of module, consisting only of the module body, is
&gt;&gt; permitted. If this is used, the header is assumed to be
&gt;&gt; &#8216;module Main(main) where&#8217;.

For modules without a module header, this is implemented the
following way:

If the module has a main function in scope:
   Then create a module header and export the main function,
   as if a module header like &#8216;module Main(main) where...&#8217; would exist.
   This has the effect to mark the main function and all top level
   functions called directly or indirectly via main as 'used',
   and later on, unused top-level functions can be reported correctly.
   There is no distinction between GHC and GHCi.
If the module has several main functions in scope:
   Then generate a header as above. The ambiguity is reported later in
   module  `GHC.Tc.Module` function `check_main`.
If the module has NO main function:
   Then export all top-level functions. This marks all top level
   functions as 'used'.
   In GHCi this has the effect, that we don't get any 'non-used' warnings.
   In GHC, however, the 'has-main-module' check in GHC.Tc.Module.checkMain
   fires, and we get the error:
      The IO action &#8216;main&#8217; is not defined in module &#8216;Main&#8217;
-}</span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">-- Renaming exports lists is a minefield. Five different things can appear in</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- children export lists ( T(A, B, C) ).</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- 1. Record selectors</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- 2. Type constructors</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- 3. Data constructors</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- 4. Pattern Synonyms</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- 5. Pattern Synonym Selectors</span><span>
</span><span id="line-723"></span><span class="hs-comment">--</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- However, things get put into weird name spaces.</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- 1. Some type constructors are parsed as variables (-.-&gt;) for example.</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- 2. All data constructors are parsed as type constructors</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- 3. When there is ambiguity, we default type constructors to data</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- constructors and require the explicit `type` keyword for type</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-730"></span><span class="hs-comment">--</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- This function first establishes the possible namespaces that an</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- identifier might be in (`choosePossibleNameSpaces`).</span><span>
</span><span id="line-733"></span><span class="hs-comment">--</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- Then for each namespace in turn, tries to find the correct identifier</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- there returning the first positive result or the first terminating</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- error.</span><span>
</span><span id="line-737"></span><span class="hs-comment">--</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#lookupChildrenExport"><span class="hs-identifier hs-type">lookupChildrenExport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-742"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span id="lookupChildrenExport"><span class="annot"><span class="annottext">lookupChildrenExport :: Name
-&gt; [LIEWrappedName GhcPs]
-&gt; RnM [(LIEWrappedName GhcRn, GlobalRdrEltX GREInfo)]
</span><a href="GHC.Tc.Gen.Export.html#lookupChildrenExport"><span class="hs-identifier hs-var hs-var">lookupChildrenExport</span></a></span></span><span> </span><span id="local-6989586621683064480"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064480"><span class="hs-identifier hs-var">spec_parent</span></a></span></span><span> </span><span id="local-6989586621683064481"><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
</span><a href="#local-6989586621683064481"><span class="hs-identifier hs-var">rdr_items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
 -&gt; TcRn
      (GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
       GlobalRdrEltX GREInfo))
-&gt; [GenLocated SrcSpanAnnA (IEWrappedName GhcPs)]
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv)
     [(GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
       GlobalRdrEltX GREInfo)]
forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndReportM"><span class="hs-identifier hs-var">mapAndReportM</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
-&gt; RnM (LIEWrappedName GhcRn, GlobalRdrEltX GREInfo)
GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
-&gt; TcRn
     (GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
      GlobalRdrEltX GREInfo)
</span><a href="#local-6989586621683064483"><span class="hs-identifier hs-var">doOne</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName GhcPs]
[GenLocated SrcSpanAnnA (IEWrappedName GhcPs)]
</span><a href="#local-6989586621683064481"><span class="hs-identifier hs-var">rdr_items</span></a></span><span>
</span><span id="line-744"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-745"></span><span>        </span><span class="hs-comment">-- Process an individual child</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><a href="#local-6989586621683064483"><span class="hs-identifier hs-type">doOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-747"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>        </span><span id="local-6989586621683064483"><span class="annot"><span class="annottext">doOne :: LIEWrappedName GhcPs
-&gt; RnM (LIEWrappedName GhcRn, GlobalRdrEltX GREInfo)
</span><a href="#local-6989586621683064483"><span class="hs-identifier hs-var hs-var">doOne</span></a></span></span><span> </span><span id="local-6989586621683064484"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064484"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064485"><span class="annot"><span class="annottext">bareName :: RdrName
</span><a href="#local-6989586621683064485"><span class="hs-identifier hs-var hs-var hs-var">bareName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IEWrappedName GhcPs -&gt; IdP GhcPs
IEWrappedName GhcPs -&gt; RdrName
forall (p :: Pass). IEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">(IEWrappedName GhcPs -&gt; RdrName)
-&gt; (GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
    -&gt; IEWrappedName GhcPs)
-&gt; GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
-&gt; RdrName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IEWrappedName GhcPs) -&gt; IEWrappedName GhcPs
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
</span><a href="#local-6989586621683064484"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-751"></span><span>              </span><span class="annot"><a href="#local-6989586621683064486"><span class="hs-identifier hs-type">what_lkup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LookupChild"><span class="hs-identifier hs-type">LookupChild</span></a></span><span>
</span><span id="line-752"></span><span>              </span><span id="local-6989586621683064486"><span class="annot"><span class="annottext">what_lkup :: LookupChild
</span><a href="#local-6989586621683064486"><span class="hs-identifier hs-var hs-var hs-var">what_lkup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-753"></span><span>                </span><span class="annot"><a href="GHC.Types.Name.Reader.html#LookupChild"><span class="hs-identifier hs-type">LookupChild</span></a></span><span>
</span><span id="line-754"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wantedParent :: Name
</span><a href="GHC.Types.Name.Reader.html#wantedParent"><span class="hs-identifier hs-var">wantedParent</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064480"><span class="hs-identifier hs-var">spec_parent</span></a></span><span>
</span><span id="line-755"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lookupDataConFirst :: Bool
</span><a href="GHC.Types.Name.Reader.html#lookupDataConFirst"><span class="hs-identifier hs-var">lookupDataConFirst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-756"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prioritiseParent :: Bool
</span><a href="GHC.Types.Name.Reader.html#prioritiseParent"><span class="hs-identifier hs-var">prioritiseParent</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- See T11970.</span><span>
</span><span id="line-757"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span>                </span><span class="hs-comment">-- Do not report export list declaration deprecations</span><span>
</span><span id="line-760"></span><span>          </span><span id="local-6989586621683064491"><span class="annot"><a href="#local-6989586621683064491"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; DeprecationWarnings
-&gt; Name
-&gt; RdrName
-&gt; LookupChild
-&gt; RnM ChildLookupResult
</span><a href="GHC.Rename.Env.html#lookupSubBndrOcc_helper"><span class="hs-identifier hs-var">lookupSubBndrOcc_helper</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">DeprecationWarnings
</span><a href="GHC.Rename.Utils.html#ExportDeprecationWarnings"><span class="hs-identifier hs-var">ExportDeprecationWarnings</span></a></span><span>
</span><span id="line-761"></span><span>                        </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064480"><span class="hs-identifier hs-var">spec_parent</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064485"><span class="hs-identifier hs-var">bareName</span></a></span><span> </span><span class="annot"><span class="annottext">LookupChild
</span><a href="#local-6989586621683064486"><span class="hs-identifier hs-var">what_lkup</span></a></span><span>
</span><span id="line-762"></span><span>          </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-type">traceRn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;lookupChildrenExport&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-type">ppr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064491"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>          </span><span class="hs-comment">-- Default to data constructors for slightly better error</span><span>
</span><span id="line-764"></span><span>          </span><span class="hs-comment">-- messages</span><span>
</span><span id="line-765"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621683064493"><span class="hs-identifier hs-type">unboundName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-766"></span><span>              </span><span id="local-6989586621683064493"><span class="annot"><a href="#local-6989586621683064493"><span class="hs-identifier hs-var hs-var">unboundName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; NameSpace
</span><a href="GHC.Types.Name.Reader.html#rdrNameSpace"><span class="hs-identifier hs-var">rdrNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064485"><span class="hs-identifier hs-var">bareName</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; NameSpace -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-767"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064485"><span class="hs-identifier hs-var">bareName</span></a></span><span>
</span><span id="line-768"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; NameSpace -&gt; RdrName
</span><a href="GHC.Parser.PostProcess.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064485"><span class="hs-identifier hs-var">bareName</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#dataName"><span class="hs-identifier hs-var">dataName</span></a></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064491"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-771"></span><span>            </span><span class="annot"><span class="annottext">ChildLookupResult
</span><a href="GHC.Rename.Env.html#NameNotFound"><span class="hs-identifier hs-var">NameNotFound</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-772"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064497"><span class="annot"><a href="#local-6989586621683064497"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Unbound.html#reportUnboundName"><span class="hs-identifier hs-var">reportUnboundName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621683064493"><span class="hs-identifier hs-var">unboundName</span></a></span><span>
</span><span id="line-773"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064498"><span class="annot"><a href="#local-6989586621683064498"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IEWrappedName GhcPs) -&gt; SrcSpanAnnA
forall l e. GenLocated l e -&gt; l
</span><a href="GHC.Types.SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
</span><a href="#local-6989586621683064484"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-774"></span><span>                       </span><span id="local-6989586621683064500"><span class="annot"><a href="#local-6989586621683064500"><span class="hs-identifier hs-var hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GREInfo -&gt; Parent -&gt; Name -&gt; GlobalRdrEltX GREInfo
</span><a href="GHC.Types.Name.Reader.html#mkLocalGRE"><span class="hs-identifier hs-var">mkLocalGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GREInfo
</span><a href="GHC.Types.GREInfo.html#UnboundGRE"><span class="hs-identifier hs-var">UnboundGRE</span></a></span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064497"><span class="hs-identifier hs-var">ub</span></a></span><span>
</span><span id="line-775"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064498"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEName"><span class="hs-identifier hs-type">IEName</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-type">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-type">l2l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064498"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064497"><span class="hs-identifier hs-type">ub</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683064500"><span class="hs-identifier hs-type">gre</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-776"></span><span>            </span><span class="annot"><a href="GHC.Rename.Env.html#FoundChild"><span class="hs-identifier hs-type">FoundChild</span></a></span><span> </span><span id="local-6989586621683064505"><span class="annot"><span class="annottext">child :: GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064505"><span class="hs-identifier hs-var">child</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GRE"><span class="hs-identifier hs-type">GRE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gre_name :: forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#gre_name"><span class="hs-identifier hs-var">gre_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064507"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064507"><span class="hs-identifier hs-var">child_nm</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gre_par :: forall info. GlobalRdrEltX info -&gt; Parent
</span><a href="GHC.Types.Name.Reader.html#gre_par"><span class="hs-identifier hs-var">gre_par</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683064508"><span class="annot"><span class="annottext">Parent
</span><a href="#local-6989586621683064508"><span class="hs-identifier hs-var">par</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-777"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Parent -&gt; Name -&gt; TcRn ()
</span><a href="GHC.Tc.Gen.Export.html#checkPatSynParent"><span class="hs-identifier hs-var">checkPatSynParent</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064480"><span class="hs-identifier hs-var">spec_parent</span></a></span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="#local-6989586621683064508"><span class="hs-identifier hs-var">par</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064507"><span class="hs-identifier hs-var">child_nm</span></a></span><span>
</span><span id="line-778"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
 GlobalRdrEltX GREInfo)
-&gt; TcRn
     (GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
      GlobalRdrEltX GREInfo)
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LIEWrappedName GhcPs -&gt; IdP GhcRn -&gt; LIEWrappedName GhcRn
</span><a href="GHC.Hs.ImpExp.html#replaceLWrappedName"><span class="hs-identifier hs-var">replaceLWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064484"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcRn
Name
</span><a href="#local-6989586621683064507"><span class="hs-identifier hs-var">child_nm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064505"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-780"></span><span>            </span><span class="annot"><a href="GHC.Rename.Env.html#IncorrectParent"><span class="hs-identifier hs-type">IncorrectParent</span></a></span><span> </span><span id="local-6989586621683064511"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064511"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621683064512"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064512"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621683064513"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064513"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; [Name]
-&gt; TcRn
     (GenLocated SrcSpanAnnA (IEWrappedName GhcRn),
      GlobalRdrEltX GREInfo)
forall a. Name -&gt; Name -&gt; [Name] -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#failWithDcErr"><span class="hs-identifier hs-var">failWithDcErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064511"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064512"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064513"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- Note [Typing Pattern Synonym Exports]</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- It proved quite a challenge to precisely specify which pattern synonyms</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- should be allowed to be bundled with which type constructors.</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- In the end it was decided to be quite liberal in what we allow. Below is</span><span>
</span><span id="line-788"></span><span class="hs-comment">-- how Simon described the implementation.</span><span>
</span><span id="line-789"></span><span class="hs-comment">--</span><span>
</span><span id="line-790"></span><span class="hs-comment">-- &quot;Personally I think we should Keep It Simple.  All this talk of</span><span>
</span><span id="line-791"></span><span class="hs-comment">--  satisfiability makes me shiver.  I suggest this: allow T( P ) in all</span><span>
</span><span id="line-792"></span><span class="hs-comment">--   situations except where `P`'s type is ''visibly incompatible'' with</span><span>
</span><span id="line-793"></span><span class="hs-comment">--   `T`.</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span class="hs-comment">--    What does &quot;visibly incompatible&quot; mean?  `P` is visibly incompatible</span><span>
</span><span id="line-796"></span><span class="hs-comment">--    with</span><span>
</span><span id="line-797"></span><span class="hs-comment">--     `T` if</span><span>
</span><span id="line-798"></span><span class="hs-comment">--       * `P`'s type is of form `... -&gt; S t1 t2`</span><span>
</span><span id="line-799"></span><span class="hs-comment">--       * `S` is a data/newtype constructor distinct from `T`</span><span>
</span><span id="line-800"></span><span class="hs-comment">--</span><span>
</span><span id="line-801"></span><span class="hs-comment">--  Nothing harmful happens if we allow `P` to be exported with</span><span>
</span><span id="line-802"></span><span class="hs-comment">--  a type it can't possibly be useful for, but specifying a tighter</span><span>
</span><span id="line-803"></span><span class="hs-comment">--  relationship is very awkward as you have discovered.&quot;</span><span>
</span><span id="line-804"></span><span class="hs-comment">--</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- Note that this allows *any* pattern synonym to be bundled with any</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- datatype type constructor. For example, the following pattern `P` can be</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- bundled with any type.</span><span>
</span><span id="line-808"></span><span class="hs-comment">--</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- ```</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- pattern P :: (A ~ f) =&gt; f</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- ```</span><span>
</span><span id="line-812"></span><span class="hs-comment">--</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- So we provide basic type checking in order to help the user out, most</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- pattern synonyms are defined with definite type constructors, but don't</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- actually prevent a library author completely confusing their users if</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- they want to.</span><span>
</span><span id="line-817"></span><span class="hs-comment">--</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- So, we check for exactly four things</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- 1. The name arises from a pattern synonym definition. (Either a pattern</span><span>
</span><span id="line-820"></span><span class="hs-comment">--    synonym constructor or a pattern synonym selector)</span><span>
</span><span id="line-821"></span><span class="hs-comment">-- 2. The pattern synonym is only bundled with a datatype or newtype.</span><span>
</span><span id="line-822"></span><span class="hs-comment">-- 3. Check that the head of the result type constructor is an actual type</span><span>
</span><span id="line-823"></span><span class="hs-comment">--    constructor and not a type variable. (See above example)</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- 4. Is so, check that this type constructor is the same as the parent</span><span>
</span><span id="line-825"></span><span class="hs-comment">--    type constructor.</span><span>
</span><span id="line-826"></span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span class="hs-comment">--</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- Note [Types of TyCon]</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- This check appears to be overly complicated, Richard asked why it</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- is not simply just `isAlgTyCon`. The answer for this is that</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- a classTyCon is also an `AlgTyCon` which we explicitly want to disallow.</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- (It is either a newtype or data depending on the number of methods)</span><span>
</span><span id="line-834"></span><span class="hs-comment">--</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="hs-comment">-- | Given a resolved name in the children export list and a parent. Decide</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- whether we are allowed to export the child with the parent.</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- Invariant: gre_par == NoParent</span><span>
</span><span id="line-839"></span><span class="hs-comment">-- See Note [Typing Pattern Synonym Exports]</span><span>
</span><span id="line-840"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#checkPatSynParent"><span class="hs-identifier hs-type">checkPatSynParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>    </span><span class="hs-comment">-- ^ Alleged parent type constructor</span><span>
</span><span id="line-841"></span><span>                             </span><span class="hs-comment">-- User wrote T( P, Q )</span><span>
</span><span id="line-842"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#Parent"><span class="hs-identifier hs-type">Parent</span></a></span><span>  </span><span class="hs-comment">-- The parent of P we discovered</span><span>
</span><span id="line-843"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-844"></span><span>                       </span><span class="hs-comment">-- ^ Either a</span><span>
</span><span id="line-845"></span><span>                       </span><span class="hs-comment">--   a) Pattern Synonym Constructor</span><span>
</span><span id="line-846"></span><span>                       </span><span class="hs-comment">--   b) A pattern synonym selector</span><span>
</span><span id="line-847"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Fails if wrong parent</span><span>
</span><span id="line-848"></span><span id="checkPatSynParent"><span class="annot"><span class="annottext">checkPatSynParent :: Name -&gt; Parent -&gt; Name -&gt; TcRn ()
</span><a href="GHC.Tc.Gen.Export.html#checkPatSynParent"><span class="hs-identifier hs-var hs-var">checkPatSynParent</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#ParentIs"><span class="hs-identifier hs-type">ParentIs</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#checkPatSynParent"><span class="hs-identifier hs-var">checkPatSynParent</span></a></span><span> </span><span id="local-6989586621683064515"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064515"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span> </span><span id="local-6989586621683064516"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064516"><span class="hs-identifier hs-var">nm</span></a></span></span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Builtin.Names.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064515"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-comment">-- Avoid an error cascade</span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064518"><span class="annot"><a href="#local-6989586621683064518"><span class="hs-identifier hs-var">parent_ty_con</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TyCon
</span><a href="GHC.Tc.Utils.Env.html#tcLookupTyCon"><span class="hs-identifier hs-var">tcLookupTyCon</span></a></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064515"><span class="hs-identifier hs-var">parent</span></a></span><span>
</span><span id="line-857"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064519"><span class="annot"><a href="#local-6989586621683064519"><span class="hs-identifier hs-var">mpat_syn_thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupGlobal"><span class="hs-identifier hs-type">tcLookupGlobal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064516"><span class="hs-identifier hs-type">nm</span></a></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>        </span><span class="hs-comment">-- 1. Check that the Id was actually from a thing associated with patsyns</span><span>
</span><span id="line-860"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683064519"><span class="hs-identifier hs-type">mpat_syn_thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-861"></span><span>            </span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier hs-type">AnId</span></a></span><span> </span><span id="local-6989586621683064520"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683064520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Var.html#isId"><span class="hs-identifier hs-var">isId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683064520"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-862"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelId"><span class="hs-identifier hs-type">RecSelId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sel_tycon :: IdDetails -&gt; RecSelParent
</span><a href="GHC.Types.Id.Info.html#sel_tycon"><span class="hs-identifier hs-var">sel_tycon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelPatSyn"><span class="hs-identifier hs-type">RecSelPatSyn</span></a></span><span> </span><span id="local-6989586621683064525"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064525"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; IdDetails
</span><a href="GHC.Types.Var.html#idDetails"><span class="hs-identifier hs-var">idDetails</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683064520"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-863"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TyCon -&gt; PatSyn -&gt; TcRn ()
</span><a href="#local-6989586621683064527"><span class="hs-identifier hs-var">handle_pat_syn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="#local-6989586621683064528"><span class="hs-identifier hs-var">selErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064516"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064518"><span class="hs-identifier hs-var">parent_ty_con</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064525"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span>            </span><span class="annot"><a href="GHC.Types.TyThing.html#AConLike"><span class="hs-identifier hs-type">AConLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621683064530"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064530"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TyCon -&gt; PatSyn -&gt; TcRn ()
</span><a href="#local-6989586621683064527"><span class="hs-identifier hs-var">handle_pat_syn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatSyn -&gt; SDoc
</span><a href="#local-6989586621683064531"><span class="hs-identifier hs-var">psErr</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064530"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064518"><span class="hs-identifier hs-var">parent_ty_con</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064530"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span>            </span><span class="annot"><span class="annottext">TyThing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; [Name] -&gt; TcRn ()
forall a. Name -&gt; Name -&gt; [Name] -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#failWithDcErr"><span class="hs-identifier hs-var">failWithDcErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064515"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064516"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-869"></span><span>    </span><span id="local-6989586621683064531"><span class="annot"><span class="annottext">psErr :: PatSyn -&gt; SDoc
</span><a href="#local-6989586621683064531"><span class="hs-identifier hs-var hs-var">psErr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PatSyn -&gt; SDoc
forall o. Outputable o =&gt; String -&gt; o -&gt; SDoc
</span><a href="GHC.Tc.Gen.Export.html#exportErrCtxt"><span class="hs-identifier hs-var">exportErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pattern synonym&quot;</span></span><span>
</span><span id="line-870"></span><span>    </span><span id="local-6989586621683064528"><span class="annot"><span class="annottext">selErr :: Name -&gt; SDoc
</span><a href="#local-6989586621683064528"><span class="hs-identifier hs-var hs-var">selErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; SDoc
forall o. Outputable o =&gt; String -&gt; o -&gt; SDoc
</span><a href="GHC.Tc.Gen.Export.html#exportErrCtxt"><span class="hs-identifier hs-var">exportErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pattern synonym record selector&quot;</span></span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span>    </span><span class="annot"><a href="#local-6989586621683064527"><span class="hs-identifier hs-type">handle_pat_syn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-873"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>      </span><span class="hs-comment">-- Parent TyCon</span><span>
</span><span id="line-874"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a></span><span>     </span><span class="hs-comment">-- Corresponding bundled PatSyn</span><span>
</span><span id="line-875"></span><span>                                 </span><span class="hs-comment">-- and pretty printed origin</span><span>
</span><span id="line-876"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>    </span><span id="local-6989586621683064527"><span class="annot"><span class="annottext">handle_pat_syn :: SDoc -&gt; TyCon -&gt; PatSyn -&gt; TcRn ()
</span><a href="#local-6989586621683064527"><span class="hs-identifier hs-var hs-var">handle_pat_syn</span></a></span></span><span> </span><span id="local-6989586621683064536"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683064536"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621683064537"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064537"><span class="hs-identifier hs-var">ty_con</span></a></span></span><span> </span><span id="local-6989586621683064538"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064538"><span class="hs-identifier hs-var">pat_syn</span></a></span></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span>      </span><span class="hs-comment">-- 2. See Note [Types of TyCon]</span><span>
</span><span id="line-880"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isTyConWithSrcDataCons"><span class="hs-identifier hs-var">isTyConWithSrcDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064537"><span class="hs-identifier hs-var">ty_con</span></a></span><span>
</span><span id="line-881"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TcRn () -&gt; TcRn ()
forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683064536"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnPatSynBundledWithNonDataCon"><span class="hs-identifier hs-var">TcRnPatSynBundledWithNonDataCon</span></a></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span>      </span><span class="hs-comment">-- 3. Is the head a type variable?</span><span>
</span><span id="line-884"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683064543"><span class="hs-identifier hs-var">mtycon</span></a></span><span>
</span><span id="line-885"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>      </span><span class="hs-comment">-- 4. Ok. Check they are actually the same type constructor.</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064544"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064544"><span class="hs-identifier hs-var">p_ty_con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="#local-6989586621683064543"><span class="hs-identifier hs-var">mtycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064544"><span class="hs-identifier hs-var">p_ty_con</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; TyCon -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064537"><span class="hs-identifier hs-var">ty_con</span></a></span><span>
</span><span id="line-889"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TcRn () -&gt; TcRn ()
forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683064536"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">(TcRn () -&gt; TcRn ()) -&gt; TcRn () -&gt; TcRn ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TcRnMessage -&gt; TcRn ()
forall a. TcRnMessage -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span>
</span><span id="line-890"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnPatSynBundledWithWrongType"><span class="hs-identifier hs-var">TcRnPatSynBundledWithWrongType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683064547"><span class="hs-identifier hs-var">expected_res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683064548"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span>      </span><span class="hs-comment">-- 5. We passed!</span><span>
</span><span id="line-893"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-894"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TcRn ()
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-897"></span><span>        </span><span id="local-6989586621683064547"><span class="annot"><span class="annottext">expected_res_ty :: Type
</span><a href="#local-6989586621683064547"><span class="hs-identifier hs-var hs-var">expected_res_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064537"><span class="hs-identifier hs-var">ty_con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Id]
</span><a href="GHC.Core.TyCon.html#tyConTyVars"><span class="hs-identifier hs-var">tyConTyVars</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683064537"><span class="hs-identifier hs-var">ty_con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064548"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683064548"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; ([Id], [Type], [Id], [Type], [Scaled Type], Type)
</span><a href="GHC.Core.PatSyn.html#patSynSig"><span class="hs-identifier hs-var">patSynSig</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621683064538"><span class="hs-identifier hs-var">pat_syn</span></a></span><span>
</span><span id="line-899"></span><span>        </span><span id="local-6989586621683064543"><span class="annot"><span class="annottext">mtycon :: Maybe TyCon
</span><a href="#local-6989586621683064543"><span class="hs-identifier hs-var hs-var">mtycon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; TyCon
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((TyCon, [Type]) -&gt; TyCon) -&gt; Maybe (TyCon, [Type]) -&gt; Maybe TyCon
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683064548"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span class="hs-comment">{-===========================================================================-}</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span class="hs-comment">-- | Insert the given 'GlobalRdrElt's into the 'ExportOccMap', checking that</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- each of the given 'GlobalRdrElt's does not appear multiple times in</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- the 'ExportOccMap', as per Note [Exporting duplicate declarations].</span><span>
</span><span id="line-907"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-type">check_occs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span>
</span><span id="line-908"></span><span id="check_occs"><span class="annot"><span class="annottext">check_occs :: ExportOccMap
-&gt; IE GhcPs -&gt; [GlobalRdrEltX GREInfo] -&gt; RnM ExportOccMap
</span><a href="GHC.Tc.Gen.Export.html#check_occs"><span class="hs-identifier hs-var hs-var">check_occs</span></a></span></span><span> </span><span id="local-6989586621683064554"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064554"><span class="hs-identifier hs-var">occs</span></a></span></span><span> </span><span id="local-6989586621683064555"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span id="local-6989586621683064556"><span class="annot"><span class="annottext">[GlobalRdrEltX GREInfo]
</span><a href="#local-6989586621683064556"><span class="hs-identifier hs-var">gres</span></a></span></span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-comment">-- 'gres' are the entities specified by 'ie'</span><span>
</span><span id="line-910"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064557"><span class="annot"><a href="#local-6989586621683064557"><span class="hs-identifier hs-var">drf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Extension -&gt; IOEnv (Env TcGblEnv TcLclEnv) Bool
forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.DuplicateRecordFields</span></span><span>
</span><span id="line-911"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldlM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683064561"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064557"><span class="hs-identifier hs-type">drf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683064554"><span class="hs-identifier hs-type">occs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064556"><span class="hs-identifier hs-type">gres</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-912"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-comment">-- Check for distinct children exported with the same OccName (an error) or</span><span>
</span><span id="line-915"></span><span>    </span><span class="hs-comment">-- for duplicate exports of the same child (a warning).</span><span>
</span><span id="line-916"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-917"></span><span>    </span><span class="hs-comment">-- See Note [Exporting duplicate declarations].</span><span>
</span><span id="line-918"></span><span>    </span><span class="annot"><a href="#local-6989586621683064561"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span>
</span><span id="line-919"></span><span>    </span><span id="local-6989586621683064561"><span class="annot"><span class="annottext">check :: Bool -&gt; ExportOccMap -&gt; GlobalRdrEltX GREInfo -&gt; RnM ExportOccMap
</span><a href="#local-6989586621683064561"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621683064562"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064562"><span class="hs-identifier hs-var">drf_enabled</span></a></span></span><span> </span><span id="local-6989586621683064563"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064563"><span class="hs-identifier hs-var">occs</span></a></span></span><span> </span><span id="local-6989586621683064564"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064564"><span class="hs-identifier hs-var">gre</span></a></span></span><span>
</span><span id="line-920"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExportOccMap
-&gt; GlobalRdrEltX GREInfo -&gt; Either (Name, IE GhcPs) ExportOccMap
</span><a href="#local-6989586621683064565"><span class="hs-identifier hs-var">try_insert</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064563"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064564"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-921"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621683064566"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064566"><span class="hs-identifier hs-var">occs'</span></a></span></span><span>
</span><span id="line-922"></span><span>            </span><span class="hs-comment">-- If DuplicateRecordFields is not enabled, also make sure</span><span>
</span><span id="line-923"></span><span>            </span><span class="hs-comment">-- that we are not exporting two fields with the same occNameFS</span><span>
</span><span id="line-924"></span><span>            </span><span class="hs-comment">-- under different namespaces.</span><span>
</span><span id="line-925"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-926"></span><span>            </span><span class="hs-comment">-- See Note [Exporting duplicate record fields].</span><span>
</span><span id="line-927"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683064562"><span class="hs-identifier hs-var">drf_enabled</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; Bool
</span><a href="GHC.Types.Name.Occurrence.html#isFieldOcc"><span class="hs-identifier hs-var">isFieldOcc</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064568"><span class="hs-identifier hs-var">child_occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; RnM ExportOccMap
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064566"><span class="hs-identifier hs-var">occs'</span></a></span><span>
</span><span id="line-929"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-930"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064569"><span class="annot"><span class="annottext">flds :: [(Name, IE GhcPs)]
</span><a href="#local-6989586621683064569"><span class="hs-identifier hs-var hs-var">flds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, IE GhcPs) -&gt; Bool)
-&gt; [(Name, IE GhcPs)] -&gt; [(Name, IE GhcPs)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621683064570"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064570"><span class="hs-identifier hs-var">ie'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; IE GhcPs -&gt; Bool
</span><a href="GHC.Tc.Gen.Export.html#dupFieldExport_ok"><span class="hs-identifier hs-var">dupFieldExport_ok</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064570"><span class="hs-identifier hs-var">ie'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>                             </span><span class="annot"><span class="annottext">([(Name, IE GhcPs)] -&gt; [(Name, IE GhcPs)])
-&gt; [(Name, IE GhcPs)] -&gt; [(Name, IE GhcPs)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; FastString -&gt; [(Name, IE GhcPs)]
forall a. OccEnv a -&gt; FastString -&gt; [a]
</span><a href="GHC.Types.Name.Occurrence.html#lookupFieldsOccEnv"><span class="hs-identifier hs-var">lookupFieldsOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064563"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064568"><span class="hs-identifier hs-var">child_occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>                  </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Name, IE GhcPs)]
</span><a href="#local-6989586621683064569"><span class="hs-identifier hs-var">flds</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; RnM ExportOccMap
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064566"><span class="hs-identifier hs-var">occs'</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621683064574"><span class="annot"><span class="annottext">(Name, IE GhcPs)
</span><a href="#local-6989586621683064574"><span class="hs-identifier hs-var">clash1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621683064575"><span class="annot"><span class="annottext">[(Name, IE GhcPs)]
</span><a href="#local-6989586621683064575"><span class="hs-identifier hs-var">clashes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-933"></span><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo, IE GhcPs)
-&gt; NonEmpty (Name, IE GhcPs) -&gt; TcRn ()
</span><a href="GHC.Tc.Gen.Export.html#addDuplicateFieldExportErr"><span class="hs-identifier hs-var">addDuplicateFieldExportErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064564"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, IE GhcPs)
</span><a href="#local-6989586621683064574"><span class="hs-identifier hs-var">clash1</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, IE GhcPs) -&gt; [(Name, IE GhcPs)] -&gt; NonEmpty (Name, IE GhcPs)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span> </span><span class="annot"><span class="annottext">[(Name, IE GhcPs)]
</span><a href="#local-6989586621683064575"><span class="hs-identifier hs-var">clashes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>                  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; RnM ExportOccMap
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064563"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683064577"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064577"><span class="hs-identifier hs-var">child'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064578"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064578"><span class="hs-identifier hs-var">ie'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064579"><span class="hs-identifier hs-var">child</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064577"><span class="hs-identifier hs-var">child'</span></a></span><span> </span><span class="hs-comment">-- Duplicate export of a single Name: a warning.</span><span>
</span><span id="line-938"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcRnMessage -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#warnIf"><span class="hs-identifier hs-var">warnIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; IE GhcPs -&gt; IE GhcPs -&gt; Bool
</span><a href="GHC.Tc.Gen.Export.html#dupExport_ok"><span class="hs-identifier hs-var">dupExport_ok</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064579"><span class="hs-identifier hs-var">child</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064578"><span class="hs-identifier hs-var">ie'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; IE GhcPs -&gt; IE GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnDuplicateExport"><span class="hs-identifier hs-var">TcRnDuplicateExport</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064564"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064578"><span class="hs-identifier hs-var">ie'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>                  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; RnM ExportOccMap
forall a. a -&gt; IOEnv (Env TcGblEnv TcLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064563"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-comment">-- Same OccName but different Name: an error.</span><span>
</span><span id="line-942"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064582"><span class="annot"><a href="#local-6989586621683064582"><span class="hs-identifier hs-var">global_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-943"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Export.html#exportClashErr"><span class="hs-identifier hs-type">exportClashErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064582"><span class="hs-identifier hs-type">global_env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064577"><span class="hs-identifier hs-type">child'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064579"><span class="hs-identifier hs-type">child</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064578"><span class="hs-identifier hs-type">ie'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064555"><span class="hs-identifier hs-type">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621683064563"><span class="hs-identifier hs-type">occs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-945"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-946"></span><span>        </span><span id="local-6989586621683064579"><span class="annot"><span class="annottext">child :: Name
</span><a href="#local-6989586621683064579"><span class="hs-identifier hs-var hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064564"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-947"></span><span>        </span><span id="local-6989586621683064568"><span class="annot"><span class="annottext">child_occ :: OccName
</span><a href="#local-6989586621683064568"><span class="hs-identifier hs-var hs-var">child_occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064579"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span>    </span><span class="hs-comment">-- Try to insert a child into the map, returning Left if there is something</span><span>
</span><span id="line-950"></span><span>    </span><span class="hs-comment">-- already exported with the same OccName.</span><span>
</span><span id="line-951"></span><span>    </span><span class="annot"><a href="#local-6989586621683064565"><span class="hs-identifier hs-type">try_insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Export.html#ExportOccMap"><span class="hs-identifier hs-type">ExportOccMap</span></a></span><span>
</span><span id="line-952"></span><span>    </span><span id="local-6989586621683064565"><span class="annot"><span class="annottext">try_insert :: ExportOccMap
-&gt; GlobalRdrEltX GREInfo -&gt; Either (Name, IE GhcPs) ExportOccMap
</span><a href="#local-6989586621683064565"><span class="hs-identifier hs-var hs-var">try_insert</span></a></span></span><span> </span><span id="local-6989586621683064586"><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064586"><span class="hs-identifier hs-var">occs</span></a></span></span><span> </span><span id="local-6989586621683064587"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064587"><span class="hs-identifier hs-var">child</span></a></span></span><span>
</span><span id="line-953"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; OccName -&gt; Maybe (Name, IE GhcPs)
forall a. OccEnv a -&gt; OccName -&gt; Maybe a
</span><a href="GHC.Types.Name.Occurrence.html#lookupOccEnv"><span class="hs-identifier hs-var">lookupOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064586"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064589"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-954"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Name, IE GhcPs)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExportOccMap -&gt; Either (Name, IE GhcPs) ExportOccMap
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExportOccMap -&gt; OccName -&gt; (Name, IE GhcPs) -&gt; ExportOccMap
forall a. OccEnv a -&gt; OccName -&gt; a -&gt; OccEnv a
</span><a href="GHC.Types.Name.Occurrence.html#extendOccEnv"><span class="hs-identifier hs-var">extendOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ExportOccMap
</span><a href="#local-6989586621683064586"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064589"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; Name
forall info. GlobalRdrEltX info -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greName"><span class="hs-identifier hs-var">greName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064587"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064555"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683064591"><span class="annot"><span class="annottext">(Name, IE GhcPs)
</span><a href="#local-6989586621683064591"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Name, IE GhcPs) -&gt; Either (Name, IE GhcPs) ExportOccMap
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Name, IE GhcPs)
</span><a href="#local-6989586621683064591"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-956"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-957"></span><span>        </span><span id="local-6989586621683064589"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621683064589"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; OccName
forall info. GlobalRdrEltX info -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064587"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="hs-comment">-- | Is it OK for the given name to be exported by both export items?</span><span>
</span><span id="line-960"></span><span class="hs-comment">--</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- See Note [Exporting duplicate declarations].</span><span>
</span><span id="line-962"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#dupExport_ok"><span class="hs-identifier hs-type">dupExport_ok</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-963"></span><span id="dupExport_ok"><span class="annot"><span class="annottext">dupExport_ok :: Name -&gt; IE GhcPs -&gt; IE GhcPs -&gt; Bool
</span><a href="GHC.Tc.Gen.Export.html#dupExport_ok"><span class="hs-identifier hs-var hs-var">dupExport_ok</span></a></span></span><span> </span><span id="local-6989586621683064593"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064593"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span id="local-6989586621683064594"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064594"><span class="hs-identifier hs-var">ie1</span></a></span></span><span> </span><span id="local-6989586621683064595"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064595"><span class="hs-identifier hs-var">ie2</span></a></span></span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span>  </span><span class="annot"><span class="annottext">IE GhcPs -&gt; Bool
forall {pass}. IE pass -&gt; Bool
</span><a href="#local-6989586621683064596"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064594"><span class="hs-identifier hs-var">ie1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; Bool
forall {pass}. IE pass -&gt; Bool
</span><a href="#local-6989586621683064596"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064595"><span class="hs-identifier hs-var">ie2</span></a></span><span>
</span><span id="line-965"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; Bool
</span><a href="#local-6989586621683064597"><span class="hs-identifier hs-var">explicit_in</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064594"><span class="hs-identifier hs-var">ie1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; Bool
</span><a href="#local-6989586621683064597"><span class="hs-identifier hs-var">explicit_in</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064595"><span class="hs-identifier hs-var">ie2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-967"></span><span>    </span><span id="local-6989586621683064597"><span class="annot"><span class="annottext">explicit_in :: IE GhcPs -&gt; Bool
</span><a href="#local-6989586621683064597"><span class="hs-identifier hs-var hs-var">explicit_in</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEModuleContents"><span class="hs-identifier hs-type">IEModuleContents</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>                   </span><span class="hs-comment">-- module M</span><span>
</span><span id="line-968"></span><span>    </span><span class="annot"><a href="#local-6989586621683064597"><span class="hs-identifier hs-var">explicit_in</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAll GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683064598"><span class="annot"><span class="annottext">LIEWrappedName GhcPs
</span><a href="#local-6989586621683064598"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (ExportDoc GhcPs)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064593"><span class="hs-identifier hs-var">child</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; OccName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IEWrappedName GhcPs -&gt; IdP GhcPs
forall (p :: Pass). IEWrappedName (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">(IEWrappedName GhcPs -&gt; IdP GhcPs)
-&gt; IEWrappedName GhcPs -&gt; IdP GhcPs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IEWrappedName GhcPs) -&gt; IEWrappedName GhcPs
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName GhcPs
GenLocated SrcSpanAnnA (IEWrappedName GhcPs)
</span><a href="#local-6989586621683064598"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- T(..)</span><span>
</span><span id="line-970"></span><span>    </span><span class="annot"><a href="#local-6989586621683064597"><span class="hs-identifier hs-var">explicit_in</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-971"></span><span>
</span><span id="line-972"></span><span>    </span><span id="local-6989586621683064596"><span class="annot"><span class="annottext">single :: IE pass -&gt; Bool
</span><a href="#local-6989586621683064596"><span class="hs-identifier hs-var hs-var">single</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEVar"><span class="hs-identifier hs-type">IEVar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-973"></span><span>    </span><span class="annot"><a href="#local-6989586621683064596"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-type">IEThingAbs</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-974"></span><span>    </span><span class="annot"><a href="#local-6989586621683064596"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><span class="annottext">IE pass
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-975"></span><span>
</span><span id="line-976"></span><span id="local-6989586621683063755"><span class="annot"><a href="GHC.Tc.Gen.Export.html#exportErrCtxt"><span class="hs-identifier hs-type">exportErrCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063755"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683063755"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span><span>
</span><span id="line-977"></span><span id="exportErrCtxt"><span class="annot"><span class="annottext">exportErrCtxt :: forall o. Outputable o =&gt; String -&gt; o -&gt; SDoc
</span><a href="GHC.Tc.Gen.Export.html#exportErrCtxt"><span class="hs-identifier hs-var hs-var">exportErrCtxt</span></a></span></span><span> </span><span id="local-6989586621683064609"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064609"><span class="hs-identifier hs-var">herald</span></a></span></span><span> </span><span id="local-6989586621683064610"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621683064610"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-978"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683064609"><span class="hs-identifier hs-var">herald</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621683064610"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-979"></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span id="local-6989586621683063707"><span id="local-6989586621683063708"><span class="annot"><a href="GHC.Tc.Gen.Export.html#addExportErrCtxt"><span class="hs-identifier hs-type">addExportErrCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#OutputableBndrId"><span class="hs-identifier hs-type">OutputableBndrId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063707"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063707"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063708"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-983"></span><span id="addExportErrCtxt"><span class="annot"><span class="annottext">addExportErrCtxt :: forall (p :: Pass) a.
OutputableBndrId p =&gt;
IE (GhcPass p) -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#addExportErrCtxt"><span class="hs-identifier hs-var hs-var">addExportErrCtxt</span></a></span></span><span> </span><span id="local-6989586621683064618"><span class="annot"><span class="annottext">IE (GhcPass p)
</span><a href="#local-6989586621683064618"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; TcM a -&gt; TcM a
forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621683064619"><span class="hs-identifier hs-var">exportCtxt</span></a></span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-985"></span><span>    </span><span id="local-6989586621683064619"><span class="annot"><span class="annottext">exportCtxt :: SDoc
</span><a href="#local-6989586621683064619"><span class="hs-identifier hs-var hs-var">exportCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the export:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IE (GhcPass p) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">IE (GhcPass p)
</span><a href="#local-6989586621683064618"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span id="local-6989586621683063748"><span class="annot"><a href="GHC.Tc.Gen.Export.html#failWithDcErr"><span class="hs-identifier hs-type">failWithDcErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683063748"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-989"></span><span id="failWithDcErr"><span class="annot"><span class="annottext">failWithDcErr :: forall a. Name -&gt; Name -&gt; [Name] -&gt; TcM a
</span><a href="GHC.Tc.Gen.Export.html#failWithDcErr"><span class="hs-identifier hs-var hs-var">failWithDcErr</span></a></span></span><span> </span><span id="local-6989586621683064621"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064621"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span id="local-6989586621683064622"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064622"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span id="local-6989586621683064623"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621683064623"><span class="hs-identifier hs-var">parents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-990"></span><span>  </span><span id="local-6989586621683064624"><span class="annot"><a href="#local-6989586621683064624"><span class="hs-identifier hs-var">ty_thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TyThing
</span><a href="GHC.Tc.Utils.Env.html#tcLookupGlobal"><span class="hs-identifier hs-var">tcLookupGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064622"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-991"></span><span>  </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-type">failWithTc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnExportedParentChildMismatch"><span class="hs-identifier hs-type">TcRnExportedParentChildMismatch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064621"><span class="hs-identifier hs-type">parent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064624"><span class="hs-identifier hs-type">ty_thing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064622"><span class="hs-identifier hs-type">child</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064623"><span class="hs-identifier hs-type">parents</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#exportClashErr"><span class="hs-identifier hs-type">exportClashErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span>
</span><span id="line-995"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-996"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-997"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnMessage"><span class="hs-identifier hs-type">TcRnMessage</span></a></span><span>
</span><span id="line-998"></span><span id="exportClashErr"><span class="annot"><span class="annottext">exportClashErr :: GlobalRdrEnv -&gt; Name -&gt; Name -&gt; IE GhcPs -&gt; IE GhcPs -&gt; TcRnMessage
</span><a href="GHC.Tc.Gen.Export.html#exportClashErr"><span class="hs-identifier hs-var hs-var">exportClashErr</span></a></span></span><span> </span><span id="local-6989586621683064626"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064626"><span class="hs-identifier hs-var">global_env</span></a></span></span><span> </span><span id="local-6989586621683064627"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064627"><span class="hs-identifier hs-var">child1</span></a></span></span><span> </span><span id="local-6989586621683064628"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064628"><span class="hs-identifier hs-var">child2</span></a></span></span><span> </span><span id="local-6989586621683064629"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064629"><span class="hs-identifier hs-var">ie1</span></a></span></span><span> </span><span id="local-6989586621683064630"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064630"><span class="hs-identifier hs-var">ie2</span></a></span></span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName
-&gt; GlobalRdrEltX GREInfo
-&gt; IE GhcPs
-&gt; GlobalRdrEltX GREInfo
-&gt; IE GhcPs
-&gt; TcRnMessage
</span><a href="GHC.Tc.Errors.Types.html#TcRnConflictingExports"><span class="hs-identifier hs-var">TcRnConflictingExports</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621683064632"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064633"><span class="hs-identifier hs-var">gre1'</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064634"><span class="hs-identifier hs-var">ie1'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064635"><span class="hs-identifier hs-var">gre2'</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064636"><span class="hs-identifier hs-var">ie2'</span></a></span><span>
</span><span id="line-1000"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1001"></span><span>    </span><span id="local-6989586621683064632"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621683064632"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064627"><span class="hs-identifier hs-var">child1</span></a></span><span>
</span><span id="line-1002"></span><span>    </span><span class="hs-comment">-- get_gre finds a GRE for the Name, so that we can show its provenance</span><span>
</span><span id="line-1003"></span><span>    </span><span id="local-6989586621683064637"><span class="annot"><span class="annottext">gre1 :: GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064637"><span class="hs-identifier hs-var hs-var">gre1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064638"><span class="hs-identifier hs-var">get_gre</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064627"><span class="hs-identifier hs-var">child1</span></a></span><span>
</span><span id="line-1004"></span><span>    </span><span id="local-6989586621683064639"><span class="annot"><span class="annottext">gre2 :: GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064639"><span class="hs-identifier hs-var hs-var">gre2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064638"><span class="hs-identifier hs-var">get_gre</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064628"><span class="hs-identifier hs-var">child2</span></a></span><span>
</span><span id="line-1005"></span><span>    </span><span id="local-6989586621683064638"><span class="annot"><span class="annottext">get_gre :: Name -&gt; GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064638"><span class="hs-identifier hs-var hs-var">get_gre</span></a></span></span><span> </span><span id="local-6989586621683064640"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064640"><span class="hs-identifier hs-var">child</span></a></span></span><span>
</span><span id="line-1006"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
-&gt; Maybe (GlobalRdrEltX GREInfo) -&gt; GlobalRdrEltX GREInfo
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; GlobalRdrEltX GREInfo
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exportClashErr&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064640"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe (GlobalRdrEltX GREInfo)
forall info.
Outputable info =&gt;
GlobalRdrEnvX info -&gt; Name -&gt; Maybe (GlobalRdrEltX info)
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064626"><span class="hs-identifier hs-var">global_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683064640"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683064633"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064633"><span class="hs-identifier hs-var">gre1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064634"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064634"><span class="hs-identifier hs-var">ie1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064635"><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064635"><span class="hs-identifier hs-var">gre2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683064636"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064636"><span class="hs-identifier hs-var">ie2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1009"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpan -&gt; Ordering
</span><a href="GHC.Types.SrcLoc.html#leftmost_smallest"><span class="hs-identifier hs-var">SrcLoc.leftmost_smallest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; SrcSpan
forall info. Outputable info =&gt; GlobalRdrEltX info -&gt; SrcSpan
</span><a href="GHC.Types.Name.Reader.html#greSrcSpan"><span class="hs-identifier hs-var">greSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064637"><span class="hs-identifier hs-var">gre1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo -&gt; SrcSpan
forall info. Outputable info =&gt; GlobalRdrEltX info -&gt; SrcSpan
</span><a href="GHC.Types.Name.Reader.html#greSrcSpan"><span class="hs-identifier hs-var">greSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064639"><span class="hs-identifier hs-var">gre2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1010"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064637"><span class="hs-identifier hs-var">gre1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064629"><span class="hs-identifier hs-var">ie1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064639"><span class="hs-identifier hs-var">gre2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064630"><span class="hs-identifier hs-var">ie2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064639"><span class="hs-identifier hs-var">gre2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064630"><span class="hs-identifier hs-var">ie2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064637"><span class="hs-identifier hs-var">gre1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064629"><span class="hs-identifier hs-var">ie1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span>        </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (GlobalRdrEltX GREInfo, IE GhcPs, GlobalRdrEltX GREInfo,
    IE GhcPs)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exportClashErr: clashing exports have identical location&quot;</span></span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#addDuplicateFieldExportErr"><span class="hs-identifier hs-type">addDuplicateFieldExportErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1017"></span><span id="addDuplicateFieldExportErr"><span class="annot"><span class="annottext">addDuplicateFieldExportErr :: (GlobalRdrEltX GREInfo, IE GhcPs)
-&gt; NonEmpty (Name, IE GhcPs) -&gt; TcRn ()
</span><a href="GHC.Tc.Gen.Export.html#addDuplicateFieldExportErr"><span class="hs-identifier hs-var hs-var">addDuplicateFieldExportErr</span></a></span></span><span> </span><span id="local-6989586621683064645"><span class="annot"><span class="annottext">(GlobalRdrEltX GREInfo, IE GhcPs)
</span><a href="#local-6989586621683064645"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span id="local-6989586621683064646"><span class="annot"><span class="annottext">NonEmpty (Name, IE GhcPs)
</span><a href="#local-6989586621683064646"><span class="hs-identifier hs-var">others</span></a></span></span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683064647"><span class="annot"><a href="#local-6989586621683064647"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-1019"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683064648"><span class="annot"><a href="#local-6989586621683064648"><span class="hs-identifier hs-var hs-var">lkup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (GlobalRdrEltX GREInfo) -&gt; GlobalRdrEltX GREInfo
forall a. HasDebugCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addDuplicateFieldExportErr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (GlobalRdrEltX GREInfo) -&gt; GlobalRdrEltX GREInfo)
-&gt; (Name -&gt; Maybe (GlobalRdrEltX GREInfo))
-&gt; Name
-&gt; GlobalRdrEltX GREInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe (GlobalRdrEltX GREInfo)
forall info.
Outputable info =&gt;
GlobalRdrEnvX info -&gt; Name -&gt; Maybe (GlobalRdrEltX info)
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621683064647"><span class="hs-identifier hs-var">rdr_env</span></a></span><span>
</span><span id="line-1020"></span><span>             </span><span id="local-6989586621683064650"><span class="annot"><a href="#local-6989586621683064650"><span class="hs-identifier hs-var hs-var">other_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, IE GhcPs) -&gt; (GlobalRdrEltX GREInfo, IE GhcPs))
-&gt; NonEmpty (Name, IE GhcPs)
-&gt; NonEmpty (GlobalRdrEltX GREInfo, IE GhcPs)
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; GlobalRdrEltX GREInfo)
-&gt; (Name, IE GhcPs) -&gt; (GlobalRdrEltX GREInfo, IE GhcPs)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; GlobalRdrEltX GREInfo
</span><a href="#local-6989586621683064648"><span class="hs-identifier hs-var">lkup</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Name, IE GhcPs)
</span><a href="#local-6989586621683064646"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-1021"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-type">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Errors.Types.html#TcRnDuplicateFieldExport"><span class="hs-identifier hs-type">TcRnDuplicateFieldExport</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064645"><span class="hs-identifier hs-type">gre</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683064650"><span class="hs-identifier hs-type">other_gres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- | Is it OK to export two clashing duplicate record fields coming from the</span><span>
</span><span id="line-1024"></span><span class="hs-comment">-- given export items, with @-XDisambiguateRecordFields@ disabled?</span><span>
</span><span id="line-1025"></span><span class="hs-comment">--</span><span>
</span><span id="line-1026"></span><span class="hs-comment">-- See Note [Exporting duplicate record fields].</span><span>
</span><span id="line-1027"></span><span class="annot"><a href="GHC.Tc.Gen.Export.html#dupFieldExport_ok"><span class="hs-identifier hs-type">dupFieldExport_ok</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1028"></span><span id="dupFieldExport_ok"><span class="annot"><span class="annottext">dupFieldExport_ok :: IE GhcPs -&gt; IE GhcPs -&gt; Bool
</span><a href="GHC.Tc.Gen.Export.html#dupFieldExport_ok"><span class="hs-identifier hs-var hs-var">dupFieldExport_ok</span></a></span></span><span> </span><span id="local-6989586621683064652"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064652"><span class="hs-identifier hs-var">ie1</span></a></span></span><span> </span><span id="local-6989586621683064653"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064653"><span class="hs-identifier hs-var">ie2</span></a></span></span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.ImpExp.html#IEModuleContents"><span class="hs-identifier hs-type">IEModuleContents</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064652"><span class="hs-identifier hs-var">ie1</span></a></span><span>
</span><span id="line-1030"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064653"><span class="hs-identifier hs-var">ie2</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; IE GhcPs -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621683064652"><span class="hs-identifier hs-var">ie1</span></a></span><span>
</span><span id="line-1031"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1033"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="hs-comment">{- Note [Exporting duplicate declarations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We want to check that two different export items don't have both attempt to export
the same thing. What do we mean precisely? There are three main situations to consider:

  1. We export two distinct Names with identical OccNames. This is an error.
  2. We export the same Name in two different export items. This is usually
     a warning, but see below.
  3. We export a duplicate record field, and DuplicateRecordFields is not enabled.
     See Note [Exporting duplicate record fields].

Concerning (2), we sometimes want to allow a duplicate export of a given Name,
as #4478 points out. The logic, as implemented in dupExport_ok, is that we
do not allow a given Name to be exported by two IEs iff either:

  - the Name is mentioned explicitly in both IEs, or
  - one of the IEs mentions the name *alone*.

Examples:

  NOT OK: module M( f, f )

    f is mentioned explicitly in both

  NOT OK: module M( fmap, Functor(..) )
  NOT OK: module M( module Data.Functor, fmap )

    One of the import items mentions fmap alone, which is also
    exported by the other export item.

  OK:
    module M( module A, module B ) where
      import A( f )
      import B( f )

  OK: (#2436)
    module M( C(..), T(..) ) where
      class C a where { data T a }
      instance C Int where { data T Int = TInt }

  OK: (#2436)
    module Foo ( T ) where
      data family T a
    module Bar ( T(..), module Foo ) where
      import Foo
      data instance T Int = TInt

Note [Exporting duplicate record fields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Record fields belonging to different datatypes belong to different namespaces,
as explained in Note [Record field namespacing] in GHC.Types.Name.Occurrence.
However, when the DuplicateRecordFields extension is NOT enabled, we want to
prevent users from exporting record fields that share the same underlying occNameFS.

To enforce this, in check_occs, when inserting a new record field into the ExportOccMap
and DuplicateRecordFields is not enabled, we also look up any clashing record fields,
and report an error.

Note however that the clash check has an extra wrinkle, similar to dupExport_ok,
as we want to allow the following:

  {-# LANGUAGE DuplicateRecordFields #-}
  module M1 where
    data D1 = MkD1 { foo :: Int }
    data D2 = MkD2 { foo :: Bool }

  ---------------------------------------------

   module M2 ( module M1 ) where
     import M1

That is, we should be allowed to re-export the whole module M1, without reporting
any nameclashes, even though M1 exports duplicate record fields and we have not
enabled -XDuplicateRecordFields in M2. This logic is implemented in
dupFieldExport_ok. See test case NoDRFModuleExport.

Note that this logic only applies to whole-module imports, as we don't want
to allow the following:

  module N0 where
    data family D a
  module N1 where
    import N0
    data instance D Int = MkDInt { foo :: Int }
  module N2 where
    import N0
    data instance D Bool = MkDBool { foo :: Int }

  module N (D(..)) where
    import N1
    import N2

Here, the single export item D(..) of N exports both record fields,
`$fld:MkDInt:foo` and `$fld:MkDBool:foo`, so we have to reject the program.
See test overloadedrecfldsfail10.
-}</span><span>
</span><span id="line-1131"></span></pre></body></html>