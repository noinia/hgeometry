<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.Text.Internal.Validate</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">text-2.1.2: An efficient packed Unicode text type.</span><ul class="links" id="page-menu"><li><a href="src/Data.Text.Internal.Validate.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.Text.Internal.Validate</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">ByteString</a></li><li><a href="#g:2">ByteArray</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Test whether or not a sequence of bytes is a valid UTF-8 byte sequence.
 In the GHC Haskell ecosystem, there are several representations of byte
 sequences. The only one that the stable <code class="inline-code">text</code> API concerns itself with is
 <code><a href="../bytestring-0.12.2.0-7dd0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code>. Part of bytestring-to-text decoding is <code><a href="Data-Text-Internal-Validate.html#v:isValidUtf8ByteString" title="Data.Text.Internal.Validate">isValidUtf8ByteString</a></code>,
 a high-performance UTF-8 validation routine written in C++ with fallbacks
 for various platforms. The C++ code backing this routine is nontrivial,
 so in the interest of reuse, this module additionally exports functions
 for working with the GC-managed <code class="inline-code">ByteArray</code> type. These <code class="inline-code">ByteArray</code>
 functions are not used anywhere else in <code class="inline-code">text</code>. They are for the benefit
 of library and application authors who do not use <code><a href="../bytestring-0.12.2.0-7dd0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code> but still
 need to interoperate with <code class="inline-code">text</code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:isValidUtf8ByteString">isValidUtf8ByteString</a> :: <a href="../bytestring-0.12.2.0-7dd0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:isValidUtf8ByteArray">isValidUtf8ByteArray</a> :: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:isValidUtf8ByteArrayUnpinned">isValidUtf8ByteArrayUnpinned</a> :: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:isValidUtf8ByteArrayPinned">isValidUtf8ByteArrayPinned</a> :: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>ByteString</h1></a><div class="top"><p class="src"><a id="v:isValidUtf8ByteString" class="def">isValidUtf8ByteString</a> :: <a href="../bytestring-0.12.2.0-7dd0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Data.Text.Internal.Validate.html#isValidUtf8ByteString" class="link">Source</a> <a href="#v:isValidUtf8ByteString" class="selflink">#</a></p><div class="doc"><p>Is the ByteString a valid UTF-8 byte sequence?</p></div></div><a href="#g:2" id="g:2"><h1>ByteArray</h1></a><div class="doc"><p>Is the slice of a byte array a valid UTF-8 byte sequence? These
 functions all accept an offset and a length.</p></div><div class="top"><p class="src"><a id="v:isValidUtf8ByteArray" class="def">isValidUtf8ByteArray</a> <a href="src/Data.Text.Internal.Validate.html#isValidUtf8ByteArray" class="link">Source</a> <a href="#v:isValidUtf8ByteArray" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a></td><td class="doc"><p>Bytes</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Offset</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Length</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>For pinned byte arrays larger than 128KiB, this switches to the safe FFI
 so that it does not prevent GC. This threshold (128KiB) was chosen
 somewhat arbitrarily and may change in the future.</p></div></div><div class="top"><p class="src"><a id="v:isValidUtf8ByteArrayUnpinned" class="def">isValidUtf8ByteArrayUnpinned</a> <a href="src/Data.Text.Internal.Validate.html#isValidUtf8ByteArrayUnpinned" class="link">Source</a> <a href="#v:isValidUtf8ByteArrayUnpinned" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a></td><td class="doc"><p>Bytes</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Offset</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Length</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This uses the <code class="inline-code">unsafe</code> FFI. GC waits for all <code class="inline-code">unsafe</code> FFI calls
 to complete before starting. Consequently, an <code class="inline-code">unsafe</code> FFI call does not
 run concurrently with GC and is not interrupted by GC. Since relocation
 cannot happen concurrently with an <code class="inline-code">unsafe</code> FFI call, it is safe
 to call this function with an unpinned byte array argument.
 It is also safe to call this with a pinned <code class="inline-code">ByteArray</code> argument.</p></div></div><div class="top"><p class="src"><a id="v:isValidUtf8ByteArrayPinned" class="def">isValidUtf8ByteArrayPinned</a> <a href="src/Data.Text.Internal.Validate.html#isValidUtf8ByteArrayPinned" class="link">Source</a> <a href="#v:isValidUtf8ByteArrayPinned" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.21.0.0-ae91/Data-Array-Byte.html#t:ByteArray" title="Data.Array.Byte">ByteArray</a></td><td class="doc"><p>Bytes</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Offset</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Length</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.21.0.0-ae91/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This uses the <code class="inline-code">safe</code> FFI. GC may run concurrently with <code class="inline-code">safe</code>
 FFI calls. Consequently, unpinned objects may be relocated while a
 <code class="inline-code">safe</code> FFI call is executing. The byte array argument <em>must</em> be pinned,
 and the calling context is responsible for enforcing this. If the
 byte array is not pinned, this function's behavior is undefined.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.30.0</p></div></body></html>