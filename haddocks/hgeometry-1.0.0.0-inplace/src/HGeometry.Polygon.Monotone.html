<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Monotone</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) 1ndy</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- A polygon is monotone in a certain direction if rays orthogonal to that</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- direction intersects the polygon at most twice. See</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &lt;https://en.wikipedia.org/wiki/Monotone_polygon&gt;</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HGeometry.Polygon.Monotone</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier">MonotonePolygon</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier">MonotonePolygonF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#monotoneDirection"><span class="hs-identifier">monotoneDirection</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#toSimplePolygon"><span class="hs-identifier">toSimplePolygon</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#asMonotonePolygon"><span class="hs-identifier">asMonotonePolygon</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#uncheckedMontonePolygon"><span class="hs-identifier">uncheckedMontonePolygon</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomMonotone"><span class="hs-identifier">randomMonotone</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomMonotoneDirected"><span class="hs-identifier">randomMonotoneDirected</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#isMonotone"><span class="hs-identifier">isMonotone</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-comment">-- , monotoneFrom</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomNonZeroVector"><span class="hs-identifier">randomNonZeroVector</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-0f3fd035821e0d3b71cdf91e4e4c32d86cdf43691417829ea65cfd226a1390e0/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Intersection.html"><span class="hs-identifier">HGeometry.Intersection</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Line.PointAndVector.html"><span class="hs-identifier">HGeometry.Line.PointAndVector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier">LinePV</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.html"><span class="hs-identifier">HGeometry.LineSegment</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html"><span class="hs-identifier">HGeometry.Point</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Class.html"><span class="hs-identifier">HGeometry.Polygon.Class</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Simple.html"><span class="hs-identifier">HGeometry.Polygon.Simple</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html"><span class="hs-identifier">HGeometry.Properties</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.html"><span class="hs-identifier">HGeometry.Vector</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Stateful.html"><span class="hs-identifier">System.Random.Stateful</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- | A type representing montone polygons</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-type">MonotonePolygon</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">type</span><span> </span><span id="MonotonePolygon"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-var">MonotonePolygon</span></a></span></span><span> </span><span id="local-6989586621679407157"><span class="annot"><a href="#local-6989586621679407157"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-type">MonotonePolygonF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407157"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Monotone polygons. A polygon is monotone in direction d if any</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- line perpendicular to direction d intersects the polygon in a</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- single interval.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-keyword">data</span><span> </span><span id="MonotonePolygonF"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-var">MonotonePolygonF</span></a></span></span><span> </span><span id="local-6989586621679406901"><span class="annot"><a href="#local-6989586621679406901"><span class="hs-identifier hs-type">simplePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>  </span><span id="MonotonePolygon"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-var">MonotonePolygon</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="monotoneDirection"><span class="annot"><span class="annottext">forall simplePolygon.
MonotonePolygonF simplePolygon -&gt; Vector 2 (NumType simplePolygon)
</span><a href="HGeometry.Polygon.Monotone.html#monotoneDirection"><span class="hs-identifier hs-var hs-var">monotoneDirection</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406901"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ the direction in which we are monotone</span></span><span>
</span><span id="line-58"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="toSimplePolygon"><span class="annot"><span class="annottext">forall simplePolygon.
MonotonePolygonF simplePolygon -&gt; simplePolygon
</span><a href="HGeometry.Polygon.Monotone.html#toSimplePolygon"><span class="hs-identifier hs-var hs-var">toSimplePolygon</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679406901"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span>
</span><span id="line-59"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Convert to a simple polygon, i.e. forget the polygon is monotone</span></span><span>
</span><span id="line-60"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- deriving (NFData, Eq)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Given a direction v, and a simple polygon that is monotone in</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- direction v, creates a Monotone polygon out of it. All of this is unchecked.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- running time: O(1)</span><span>
</span><span id="line-67"></span><span id="local-6989586621679406907"><span id="local-6989586621679406908"><span id="local-6989586621679406909"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#uncheckedMontonePolygon"><span class="hs-identifier hs-type">uncheckedMontonePolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406907"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406908"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406909"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-68"></span><span>                           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679406909"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679406907"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-type">MonotonePolygonF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406907"><span class="hs-identifier hs-type">simplePolygon</span></a></span></span></span></span><span>
</span><span id="line-69"></span><span id="uncheckedMontonePolygon"><span class="annot"><span class="annottext">uncheckedMontonePolygon :: forall simplePolygon point r.
SimplePolygon_ simplePolygon point r =&gt;
Vector 2 r -&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
</span><a href="HGeometry.Polygon.Monotone.html#uncheckedMontonePolygon"><span class="hs-identifier hs-var hs-var">uncheckedMontonePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
Vector 2 (NumType simplePolygon)
-&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
forall simplePolygon.
Vector 2 (NumType simplePolygon)
-&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
</span><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-var">MonotonePolygon</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span id="local-6989586621679407167"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-type">MonotonePolygonF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407167"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span id="local-6989586621679407168"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-type">MonotonePolygonF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407168"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407168"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Try to establish that the given simple polygon is monotone with</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- respect to the given direction.</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- \( O(n \log n) \)</span><span>
</span><span id="line-81"></span><span id="local-6989586621679406924"><span id="local-6989586621679406925"><span id="local-6989586621679406926"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#asMonotonePolygon"><span class="hs-identifier hs-type">asMonotonePolygon</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406924"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406925"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406926"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679406926"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679406926"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-82"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679406926"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-84"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679406924"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span>
</span><span id="line-85"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygonF"><span class="hs-identifier hs-type">MonotonePolygonF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406924"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-86"></span><span id="asMonotonePolygon"><span class="annot"><span class="annottext">asMonotonePolygon :: forall simplePolygon point r.
(SimplePolygon_ simplePolygon point r, Num r, Ord r) =&gt;
Vector 2 r
-&gt; simplePolygon -&gt; Maybe (MonotonePolygonF simplePolygon)
</span><a href="HGeometry.Polygon.Monotone.html#asMonotonePolygon"><span class="hs-identifier hs-var hs-var">asMonotonePolygon</span></a></span></span><span> </span><span id="local-6989586621679407307"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407307"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679407308"><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407308"><span class="hs-identifier hs-var">pg</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; simplePolygon -&gt; Bool
forall simplePolygon point r.
(SimplePolygon_ simplePolygon point r, Num r, Ord r) =&gt;
Vector 2 r -&gt; simplePolygon -&gt; Bool
</span><a href="HGeometry.Polygon.Monotone.html#isMonotone"><span class="hs-identifier hs-var">isMonotone</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407307"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407308"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonotonePolygonF simplePolygon
-&gt; Maybe (MonotonePolygonF simplePolygon)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MonotonePolygonF simplePolygon
 -&gt; Maybe (MonotonePolygonF simplePolygon))
-&gt; MonotonePolygonF simplePolygon
-&gt; Maybe (MonotonePolygonF simplePolygon)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 (NumType simplePolygon)
-&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
forall simplePolygon.
Vector 2 (NumType simplePolygon)
-&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
</span><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-var">MonotonePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector 2 (NumType simplePolygon)
</span><a href="#local-6989586621679407307"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407308"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MonotonePolygonF simplePolygon)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | A polygon is monotone if a straight line in a given direction</span><span>
</span><span id="line-92"></span><span class="hs-comment">--   cannot have more than two intersections.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- \( O(n \log n) \)</span><span>
</span><span id="line-95"></span><span id="local-6989586621679406964"><span id="local-6989586621679406965"><span id="local-6989586621679406966"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#isMonotone"><span class="hs-identifier hs-type">isMonotone</span></a></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406964"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406965"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679406966"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-96"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679406966"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679406966"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-97"></span><span>                           </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679406966"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679406964"><span class="hs-identifier hs-type">simplePolygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-99"></span><span id="isMonotone"><span class="annot"><span class="annottext">isMonotone :: forall simplePolygon point r.
(SimplePolygon_ simplePolygon point r, Num r, Ord r) =&gt;
Vector 2 r -&gt; simplePolygon -&gt; Bool
</span><a href="HGeometry.Polygon.Monotone.html#isMonotone"><span class="hs-identifier hs-var hs-var">isMonotone</span></a></span></span><span> </span><span id="local-6989586621679407422"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407422"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span id="local-6989586621679407423"><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407423"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; Bool) -&gt; [point] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">point -&gt; Bool
</span><a href="#local-6989586621679407425"><span class="hs-identifier hs-var">isMonotoneAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407423"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">simplePolygon
-&gt; Getting (Endo [point]) simplePolygon point -&gt; [point]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-0f3fd035821e0d3b71cdf91e4e4c32d86cdf43691417829ea65cfd226a1390e0/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Getting (Endo [point]) simplePolygon point
(Vertex simplePolygon
 -&gt; Const (Endo [point]) (Vertex simplePolygon))
-&gt; simplePolygon -&gt; Const (Endo [point]) simplePolygon
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx simplePolygon)
  simplePolygon
  simplePolygon
  (Vertex simplePolygon)
  (Vertex simplePolygon)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- Check for each vertex that the number of intersections with the</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- line starting at the vertex and going out in the given direction</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- intersects with the edges of the polygon no more than 2 times.</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679407425"><span class="annot"><span class="annottext">isMonotoneAt :: point -&gt; Bool
</span><a href="#local-6989586621679407425"><span class="hs-identifier hs-var hs-var">isMonotoneAt</span></a></span></span><span> </span><span id="local-6989586621679407428"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407428"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ClosedLineSegment point -&gt; Integer)
-&gt; [ClosedLineSegment point] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; ClosedLineSegment point -&gt; Integer
</span><a href="#local-6989586621679407430"><span class="hs-identifier hs-var">intersectionsThrough</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407428"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">simplePolygon
</span><a href="#local-6989586621679407423"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">simplePolygon
-&gt; Getting
     (Endo [ClosedLineSegment point])
     simplePolygon
     (ClosedLineSegment point)
-&gt; [ClosedLineSegment point]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-0f3fd035821e0d3b71cdf91e4e4c32d86cdf43691417829ea65cfd226a1390e0/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Getting
  (Endo [ClosedLineSegment point])
  simplePolygon
  (ClosedLineSegment point)
forall polygon point r.
(HasOuterBoundary polygon, Vertex polygon ~ point,
 Point_ point 2 r) =&gt;
IndexedFold1 (VertexIx polygon) polygon (ClosedLineSegment point)
IndexedFold1
  (VertexIx simplePolygon) simplePolygon (ClosedLineSegment point)
</span><a href="HGeometry.Polygon.Class.html#outerBoundaryEdgeSegments"><span class="hs-identifier hs-var">outerBoundaryEdgeSegments</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679407430"><span class="annot"><span class="annottext">intersectionsThrough :: point -&gt; ClosedLineSegment point -&gt; Integer
</span><a href="#local-6989586621679407430"><span class="hs-identifier hs-var hs-var">intersectionsThrough</span></a></span></span><span> </span><span id="local-6989586621679407433"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407433"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span id="local-6989586621679407434"><span class="annot"><span class="annottext">ClosedLineSegment point
</span><a href="#local-6989586621679407434"><span class="hs-identifier hs-var">edge</span></a></span></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679407435"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; ClosedLineSegment point -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Intersection.html#intersects"><span class="hs-operator hs-var">`intersects`</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point
</span><a href="#local-6989586621679407434"><span class="hs-identifier hs-var">edge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- note that if the line is the supporting line of the edge this counts as one intersection</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>        </span><span id="local-6989586621679407435"><span class="annot"><span class="annottext">line :: LinePV 2 r
</span><a href="#local-6989586621679407435"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407433"><span class="hs-identifier hs-var">pt</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-0f3fd035821e0d3b71cdf91e4e4c32d86cdf43691417829ea65cfd226a1390e0/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#asPoint"><span class="hs-identifier hs-var">asPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall {r}. Num r =&gt; Vector 2 r -&gt; Vector 2 r
</span><a href="#local-6989586621679407440"><span class="hs-identifier hs-var">rot90</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407422"><span class="hs-identifier hs-var">direction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621679407440"><span class="annot"><span class="annottext">rot90 :: Vector 2 r -&gt; Vector 2 r
</span><a href="#local-6989586621679407440"><span class="hs-identifier hs-var hs-var">rot90</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector2"><span class="hs-identifier hs-type">Vector2</span></a></span><span> </span><span id="local-6989586621679407444"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679407444"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679407445"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679407445"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector2"><span class="hs-identifier hs-var">Vector2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679407445"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679407444"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Generate a random N-sided polygon that is monotone in a random direction.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- -- pre: n &gt;= 3</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- \( O(n \log n) \)</span><span>
</span><span id="line-120"></span><span id="local-6989586621679407022"><span id="local-6989586621679407023"><span id="local-6989586621679407026"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomMonotone"><span class="hs-identifier hs-type">randomMonotone</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="#local-6989586621679407022"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407023"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407022"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679407026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679407026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-type">MonotonePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-122"></span><span id="randomMonotone"><span class="annot"><span class="annottext">randomMonotone :: forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Ord r, Num r) =&gt;
Int -&gt; m (MonotonePolygon (Point 2 r))
</span><a href="HGeometry.Polygon.Monotone.html#randomMonotone"><span class="hs-identifier hs-var hs-var">randomMonotone</span></a></span></span><span> </span><span id="local-6989586621679407466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679407466"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector 2 r -&gt; m (MonotonePolygon (Point 2 r))
forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Ord r, Num r) =&gt;
Int -&gt; Vector 2 r -&gt; m (MonotonePolygon (Point 2 r))
</span><a href="HGeometry.Polygon.Monotone.html#randomMonotoneDirected"><span class="hs-identifier hs-var">randomMonotoneDirected</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679407466"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 r -&gt; m (MonotonePolygon (Point 2 r)))
-&gt; m (Vector 2 r) -&gt; m (MonotonePolygon (Point 2 r))
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m (Vector 2 r)
forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Eq r, Num r) =&gt;
m (Vector 2 r)
</span><a href="HGeometry.Polygon.Monotone.html#randomNonZeroVector"><span class="hs-identifier hs-var">randomNonZeroVector</span></a></span><span>
</span><span id="line-123"></span><span class="hs-comment">{- Algorithm overview:

  1. Create N `Point 2 Rational` (N &gt;= 3)
  2. Create a random `Vector 2 Rational`
  3. Find the extremes (min and max) of the points when sorted in the direction of the vector.
      We already have code for this. See `maximumBy (cmpExtreme vector)` and
      `minimumBy (cmpExtreme vector)`.
  4. Take out the two extremal points from the set.
  5. Partition the remaining points according to whether they're on the left side or right side
    of the imaginary line between the two extremal points.
  6. Sort the two partitioned sets, one in the direction of the vector and one in the opposite
    direction.
  7. Connect the points, starting from the minimal extreme point, going through the set of points
    that are increasing in the direction of the vector, then to the maximal point, and finally
    down through the points that are decreasing in the direction of the vector.
-}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   Generate a random n-sided polygon that is monotone in the given direction.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- pre: n &gt;= 3</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- \( O(n \log n) \)</span><span>
</span><span id="line-146"></span><span id="local-6989586621679407034"><span id="local-6989586621679407035"><span id="local-6989586621679407036"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomMonotoneDirected"><span class="hs-identifier hs-type">randomMonotoneDirected</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="#local-6989586621679407034"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407035"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407034"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407036"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679407036"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679407036"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407036"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-148"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407035"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-type">MonotonePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407036"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-149"></span><span id="randomMonotoneDirected"><span class="annot"><span class="annottext">randomMonotoneDirected :: forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Ord r, Num r) =&gt;
Int -&gt; Vector 2 r -&gt; m (MonotonePolygon (Point 2 r))
</span><a href="HGeometry.Polygon.Monotone.html#randomMonotoneDirected"><span class="hs-identifier hs-var hs-var">randomMonotoneDirected</span></a></span></span><span> </span><span id="local-6989586621679407513"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679407513"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679407514"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407514"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679407515"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679407515"><span class="hs-identifier hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateGenM g -&gt; m (Point 2 r)
forall a g (m :: * -&gt; *). (Uniform a, StatefulGen g m) =&gt; g -&gt; m a
forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m (Point 2 r)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#uniformM"><span class="hs-identifier hs-var">uniformM</span></a></span><span> </span><span class="annot"><span class="annottext">StateGenM g
forall g. StateGenM g
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#StateGenM"><span class="hs-identifier hs-var">StateGenM</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679407518"><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621679407518"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m (Point 2 r) -&gt; m [Point 2 r]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679407513"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateGenM g -&gt; m (Point 2 r)
forall a g (m :: * -&gt; *). (Uniform a, StatefulGen g m) =&gt; g -&gt; m a
forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m (Point 2 r)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#uniformM"><span class="hs-identifier hs-var">uniformM</span></a></span><span> </span><span class="annot"><span class="annottext">StateGenM g
forall g. StateGenM g
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#StateGenM"><span class="hs-identifier hs-var">StateGenM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; NonEmpty (Point 2 r) -&gt; Maybe (MonotonePolygon (Point 2 r))
forall r (f :: * -&gt; *) point.
(Ord r, Num r, Foldable1 f, Point_ point 2 r, Eq point) =&gt;
Vector 2 r -&gt; f point -&gt; Maybe (MonotonePolygon point)
</span><a href="HGeometry.Polygon.Monotone.html#monotoneFrom"><span class="hs-identifier hs-var">monotoneFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407514"><span class="hs-identifier hs-var">direction</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Point 2 r) -&gt; Maybe (MonotonePolygon (Point 2 r)))
-&gt; NonEmpty (Point 2 r) -&gt; Maybe (MonotonePolygon (Point 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679407515"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; [Point 2 r] -&gt; NonEmpty (Point 2 r)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621679407518"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679407521"><span class="annot"><span class="annottext">MonotonePolygon (Point 2 r)
</span><a href="#local-6989586621679407521"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MonotonePolygon (Point 2 r) -&gt; m (MonotonePolygon (Point 2 r))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">MonotonePolygon (Point 2 r)
</span><a href="#local-6989586621679407521"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">Maybe (MonotonePolygon (Point 2 r))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (MonotonePolygon (Point 2 r))
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;randomMonotoneDirected: Absurd. fromPolygon failed&quot;</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- Pick a random vector and then call 'randomMonotone'.</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Assemble a given set of points in a polygon that is monotone in the given direction.</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- pre: at least 3 points are given</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- \( O(n \log n) \)</span><span>
</span><span id="line-162"></span><span id="local-6989586621679407071"><span id="local-6989586621679407072"><span id="local-6989586621679407073"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#monotoneFrom"><span class="hs-identifier hs-type">monotoneFrom</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679407071"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679407071"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679407072"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#Point_"><span class="hs-identifier hs-type">Point_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407073"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407071"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679407073"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407071"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407072"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407073"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-type">MonotonePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407073"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-164"></span><span id="monotoneFrom"><span class="annot"><span class="annottext">monotoneFrom :: forall r (f :: * -&gt; *) point.
(Ord r, Num r, Foldable1 f, Point_ point 2 r, Eq point) =&gt;
Vector 2 r -&gt; f point -&gt; Maybe (MonotonePolygon point)
</span><a href="HGeometry.Polygon.Monotone.html#monotoneFrom"><span class="hs-identifier hs-var hs-var">monotoneFrom</span></a></span></span><span> </span><span id="local-6989586621679407681"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span id="local-6989586621679407682"><span class="annot"><span class="annottext">f point
</span><a href="#local-6989586621679407682"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 (NumType (SimplePolygon point))
-&gt; SimplePolygon point -&gt; MonotonePolygonF (SimplePolygon point)
forall simplePolygon.
Vector 2 (NumType simplePolygon)
-&gt; simplePolygon -&gt; MonotonePolygonF simplePolygon
</span><a href="HGeometry.Polygon.Monotone.html#MonotonePolygon"><span class="hs-identifier hs-var">MonotonePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector 2 (NumType (SimplePolygon point))
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon point -&gt; MonotonePolygonF (SimplePolygon point))
-&gt; Maybe (SimplePolygon point)
-&gt; Maybe (MonotonePolygonF (SimplePolygon point))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SimplePolygon point)
</span><a href="#local-6989586621679407684"><span class="hs-identifier hs-var">thePolygon</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679407684"><span class="annot"><span class="annottext">thePolygon :: Maybe (SimplePolygon point)
</span><a href="#local-6989586621679407684"><span class="hs-identifier hs-var hs-var">thePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[point] -&gt; Maybe (SimplePolygon point)
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable f,
 ConstructableSimplePolygon simplePolygon point r) =&gt;
f point -&gt; Maybe simplePolygon
forall (f :: * -&gt; *).
(Foldable f,
 ConstructableSimplePolygon (SimplePolygon point) point r) =&gt;
f point -&gt; Maybe (SimplePolygon point)
</span><a href="HGeometry.Polygon.Simple.Class.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407686"><span class="hs-identifier hs-var">minP</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[point] -&gt; [point] -&gt; [point]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407687"><span class="hs-identifier hs-var">rightHalf</span></a></span><span> </span><span class="annot"><span class="annottext">[point] -&gt; [point] -&gt; [point]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407688"><span class="hs-identifier hs-var">maxP</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[point] -&gt; [point] -&gt; [point]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407689"><span class="hs-identifier hs-var">leftHalf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679407686"><span class="annot"><span class="annottext">minP :: point
</span><a href="#local-6989586621679407686"><span class="hs-identifier hs-var hs-var">minP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering) -&gt; f point -&gt; point
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; point -&gt; point -&gt; Ordering
forall r point.
(Num r, Ord r, Point_ point 2 r) =&gt;
Vector 2 r -&gt; point -&gt; point -&gt; Ordering
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.html#cmpInDirection"><span class="hs-identifier hs-var">cmpInDirection</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f point
</span><a href="#local-6989586621679407682"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679407688"><span class="annot"><span class="annottext">maxP :: point
</span><a href="#local-6989586621679407688"><span class="hs-identifier hs-var hs-var">maxP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering) -&gt; f point -&gt; point
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; point -&gt; point -&gt; Ordering
forall r point.
(Num r, Ord r, Point_ point 2 r) =&gt;
Vector 2 r -&gt; point -&gt; point -&gt; Ordering
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.html#cmpInDirection"><span class="hs-identifier hs-var">cmpInDirection</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f point
</span><a href="#local-6989586621679407682"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- 4</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679407693"><span class="annot"><span class="annottext">pointsWithoutExtremes :: [point]
</span><a href="#local-6989586621679407693"><span class="hs-identifier hs-var hs-var">pointsWithoutExtremes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; Bool) -&gt; NonEmpty point -&gt; [point]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679407695"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407695"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407695"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407686"><span class="hs-identifier hs-var">minP</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407695"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407688"><span class="hs-identifier hs-var">maxP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NonEmpty point -&gt; [point]) -&gt; NonEmpty point -&gt; [point]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f point -&gt; NonEmpty point
forall a. f a -&gt; NonEmpty a
forall (t :: * -&gt; *) a. Foldable1 t =&gt; t a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">toNonEmpty</span></span><span> </span><span class="annot"><span class="annottext">f point
</span><a href="#local-6989586621679407682"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- 5, 6</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679407699"><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407699"><span class="hs-identifier hs-var">leftHalfUnsorted</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679407700"><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407700"><span class="hs-identifier hs-var">rightHalfUnsorted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; Bool) -&gt; [point] -&gt; ([point], [point])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">List.partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; Bool
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
point -&gt; point -&gt; point -&gt; Bool
</span><a href="HGeometry.Polygon.Monotone.html#toTheLeft"><span class="hs-identifier hs-var">toTheLeft</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407686"><span class="hs-identifier hs-var">minP</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407688"><span class="hs-identifier hs-var">maxP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407693"><span class="hs-identifier hs-var">pointsWithoutExtremes</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679407689"><span class="annot"><span class="annottext">leftHalf :: [point]
</span><a href="#local-6989586621679407689"><span class="hs-identifier hs-var hs-var">leftHalf</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering) -&gt; [point] -&gt; [point]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering) -&gt; point -&gt; point -&gt; Ordering
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((point -&gt; point -&gt; Ordering) -&gt; point -&gt; point -&gt; Ordering)
-&gt; (point -&gt; point -&gt; Ordering) -&gt; point -&gt; point -&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; point -&gt; point -&gt; Ordering
forall r point.
(Num r, Ord r, Point_ point 2 r) =&gt;
Vector 2 r -&gt; point -&gt; point -&gt; Ordering
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.html#cmpInDirection"><span class="hs-identifier hs-var">cmpInDirection</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407699"><span class="hs-identifier hs-var">leftHalfUnsorted</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679407687"><span class="annot"><span class="annottext">rightHalf :: [point]
</span><a href="#local-6989586621679407687"><span class="hs-identifier hs-var hs-var">rightHalf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering) -&gt; [point] -&gt; [point]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; point -&gt; point -&gt; Ordering
forall r point.
(Num r, Ord r, Point_ point 2 r) =&gt;
Vector 2 r -&gt; point -&gt; point -&gt; Ordering
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.html#cmpInDirection"><span class="hs-identifier hs-var">cmpInDirection</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407681"><span class="hs-identifier hs-var">direction</span></a></span><span class="hs-special">)</span><span>        </span><span class="annot"><span class="annottext">[point]
</span><a href="#local-6989586621679407700"><span class="hs-identifier hs-var">rightHalfUnsorted</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- helper functions</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- for partitioning points</span><span>
</span><span id="line-181"></span><span id="local-6989586621679407124"><span id="local-6989586621679407125"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#toTheLeft"><span class="hs-identifier hs-type">toTheLeft</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#Point_"><span class="hs-identifier hs-type">Point_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407124"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407125"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679407125"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679407125"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407124"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407124"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407124"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-182"></span><span id="toTheLeft"><span class="annot"><span class="annottext">toTheLeft :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
point -&gt; point -&gt; point -&gt; Bool
</span><a href="HGeometry.Polygon.Monotone.html#toTheLeft"><span class="hs-identifier hs-var hs-var">toTheLeft</span></a></span></span><span> </span><span id="local-6989586621679407768"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407768"><span class="hs-identifier hs-var">minP</span></a></span></span><span> </span><span id="local-6989586621679407769"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407769"><span class="hs-identifier hs-var">maxP</span></a></span></span><span> </span><span id="local-6989586621679407770"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407770"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; CCW
forall point r.
(Point_ point 2 r, Num r, Ord r) =&gt;
point -&gt; point -&gt; point -&gt; CCW
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.Degenerate.html#ccw"><span class="hs-identifier hs-var">ccw</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407768"><span class="hs-identifier hs-var">minP</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407769"><span class="hs-identifier hs-var">maxP</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679407770"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Orientation.Degenerate.html#CCW"><span class="hs-identifier hs-var">CCW</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | \( O(1) \)</span><span>
</span><span id="line-185"></span><span class="hs-comment">--   Create a random 2D vector which has a non-zero magnitude.</span><span>
</span><span id="line-186"></span><span id="local-6989586621679407040"><span id="local-6989586621679407041"><span id="local-6989586621679407042"><span class="annot"><a href="HGeometry.Polygon.Monotone.html#randomNonZeroVector"><span class="hs-identifier hs-type">randomNonZeroVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="#local-6989586621679407040"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407041"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407040"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679407042"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679407042"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679407042"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679407041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679407042"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-188"></span><span id="randomNonZeroVector"><span class="annot"><span class="annottext">randomNonZeroVector :: forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Eq r, Num r) =&gt;
m (Vector 2 r)
</span><a href="HGeometry.Polygon.Monotone.html#randomNonZeroVector"><span class="hs-identifier hs-var hs-var">randomNonZeroVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679407812"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407812"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateGenM g -&gt; m (Vector 2 r)
forall a g (m :: * -&gt; *). (Uniform a, StatefulGen g m) =&gt; g -&gt; m a
forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m (Vector 2 r)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#uniformM"><span class="hs-identifier hs-var">uniformM</span></a></span><span> </span><span class="annot"><span class="annottext">StateGenM g
forall g. StateGenM g
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-12859ef6852b813423b1898d6ceb003f82f1649ae0d1adff88274b3e5745027c/share/doc/html/src/System.Random.Internal.html#StateGenM"><span class="hs-identifier hs-var">StateGenM</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Vector.Class.html#quadrance"><span class="hs-identifier hs-var">quadrance</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407812"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m (Vector 2 r)
forall g (m :: * -&gt; *) r.
(MonadState g m, RandomGen g, Uniform r, Eq r, Num r) =&gt;
m (Vector 2 r)
</span><a href="HGeometry.Polygon.Monotone.html#randomNonZeroVector"><span class="hs-identifier hs-var">randomNonZeroVector</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; m (Vector 2 r)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679407812"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-193"></span></pre></body></html>